(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))h(m);new MutationObserver(m=>{for(const z of m)if(z.type==="childList")for(const u of z.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&h(u)}).observe(document,{childList:!0,subtree:!0});function a(m){const z={};return m.integrity&&(z.integrity=m.integrity),m.referrerPolicy&&(z.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?z.credentials="include":m.crossOrigin==="anonymous"?z.credentials="omit":z.credentials="same-origin",z}function h(m){if(m.ep)return;m.ep=!0;const z=a(m);fetch(m.href,z)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var i=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),z=Symbol.for("react.provider"),u=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),b=Symbol.iterator;function I(fe){return fe===null||typeof fe!="object"?null:(fe=b&&fe[b]||fe["@@iterator"],typeof fe=="function"?fe:null)}var O={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,L={};function Q(fe,De,We){this.props=fe,this.context=De,this.refs=L,this.updater=We||O}Q.prototype.isReactComponent={},Q.prototype.setState=function(fe,De){if(typeof fe!="object"&&typeof fe!="function"&&fe!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,fe,De,"setState")},Q.prototype.forceUpdate=function(fe){this.updater.enqueueForceUpdate(this,fe,"forceUpdate")};function ne(){}ne.prototype=Q.prototype;function Z(fe,De,We){this.props=fe,this.context=De,this.refs=L,this.updater=We||O}var _=Z.prototype=new ne;_.constructor=Z,T(_,Q.prototype),_.isPureReactComponent=!0;var F=Array.isArray,j=Object.prototype.hasOwnProperty,G={current:null},q={key:!0,ref:!0,__self:!0,__source:!0};function N(fe,De,We){var oe,Ae={},He=null,Ue=null;if(De!=null)for(oe in De.ref!==void 0&&(Ue=De.ref),De.key!==void 0&&(He=""+De.key),De)j.call(De,oe)&&!q.hasOwnProperty(oe)&&(Ae[oe]=De[oe]);var Ie=arguments.length-2;if(Ie===1)Ae.children=We;else if(1<Ie){for(var rt=Array(Ie),st=0;st<Ie;st++)rt[st]=arguments[st+2];Ae.children=rt}if(fe&&fe.defaultProps)for(oe in Ie=fe.defaultProps,Ie)Ae[oe]===void 0&&(Ae[oe]=Ie[oe]);return{$$typeof:i,type:fe,key:He,ref:Ue,props:Ae,_owner:G.current}}function ee(fe,De){return{$$typeof:i,type:fe.type,key:De,ref:fe.ref,props:fe.props,_owner:fe._owner}}function Ce(fe){return typeof fe=="object"&&fe!==null&&fe.$$typeof===i}function he(fe){var De={"=":"=0",":":"=2"};return"$"+fe.replace(/[=:]/g,function(We){return De[We]})}var ge=/\/+/g;function me(fe,De){return typeof fe=="object"&&fe!==null&&fe.key!=null?he(""+fe.key):De.toString(36)}function Me(fe,De,We,oe,Ae){var He=typeof fe;(He==="undefined"||He==="boolean")&&(fe=null);var Ue=!1;if(fe===null)Ue=!0;else switch(He){case"string":case"number":Ue=!0;break;case"object":switch(fe.$$typeof){case i:case n:Ue=!0}}if(Ue)return Ue=fe,Ae=Ae(Ue),fe=oe===""?"."+me(Ue,0):oe,F(Ae)?(We="",fe!=null&&(We=fe.replace(ge,"$&/")+"/"),Me(Ae,De,We,"",function(st){return st})):Ae!=null&&(Ce(Ae)&&(Ae=ee(Ae,We+(!Ae.key||Ue&&Ue.key===Ae.key?"":(""+Ae.key).replace(ge,"$&/")+"/")+fe)),De.push(Ae)),1;if(Ue=0,oe=oe===""?".":oe+":",F(fe))for(var Ie=0;Ie<fe.length;Ie++){He=fe[Ie];var rt=oe+me(He,Ie);Ue+=Me(He,De,We,rt,Ae)}else if(rt=I(fe),typeof rt=="function")for(fe=rt.call(fe),Ie=0;!(He=fe.next()).done;)He=He.value,rt=oe+me(He,Ie++),Ue+=Me(He,De,We,rt,Ae);else if(He==="object")throw De=String(fe),Error("Objects are not valid as a React child (found: "+(De==="[object Object]"?"object with keys {"+Object.keys(fe).join(", ")+"}":De)+"). If you meant to render a collection of children, use an array instead.");return Ue}function ue(fe,De,We){if(fe==null)return fe;var oe=[],Ae=0;return Me(fe,oe,"","",function(He){return De.call(We,He,Ae++)}),oe}function P(fe){if(fe._status===-1){var De=fe._result;De=De(),De.then(function(We){(fe._status===0||fe._status===-1)&&(fe._status=1,fe._result=We)},function(We){(fe._status===0||fe._status===-1)&&(fe._status=2,fe._result=We)}),fe._status===-1&&(fe._status=0,fe._result=De)}if(fe._status===1)return fe._result.default;throw fe._result}var ce={current:null},se={transition:null},X={ReactCurrentDispatcher:ce,ReactCurrentBatchConfig:se,ReactCurrentOwner:G};function Re(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:ue,forEach:function(fe,De,We){ue(fe,function(){De.apply(this,arguments)},We)},count:function(fe){var De=0;return ue(fe,function(){De++}),De},toArray:function(fe){return ue(fe,function(De){return De})||[]},only:function(fe){if(!Ce(fe))throw Error("React.Children.only expected to receive a single React element child.");return fe}},react_production_min.Component=Q,react_production_min.Fragment=a,react_production_min.Profiler=m,react_production_min.PureComponent=Z,react_production_min.StrictMode=h,react_production_min.Suspense=p,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,react_production_min.act=Re,react_production_min.cloneElement=function(fe,De,We){if(fe==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+fe+".");var oe=T({},fe.props),Ae=fe.key,He=fe.ref,Ue=fe._owner;if(De!=null){if(De.ref!==void 0&&(He=De.ref,Ue=G.current),De.key!==void 0&&(Ae=""+De.key),fe.type&&fe.type.defaultProps)var Ie=fe.type.defaultProps;for(rt in De)j.call(De,rt)&&!q.hasOwnProperty(rt)&&(oe[rt]=De[rt]===void 0&&Ie!==void 0?Ie[rt]:De[rt])}var rt=arguments.length-2;if(rt===1)oe.children=We;else if(1<rt){Ie=Array(rt);for(var st=0;st<rt;st++)Ie[st]=arguments[st+2];oe.children=Ie}return{$$typeof:i,type:fe.type,key:Ae,ref:He,props:oe,_owner:Ue}},react_production_min.createContext=function(fe){return fe={$$typeof:u,_currentValue:fe,_currentValue2:fe,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},fe.Provider={$$typeof:z,_context:fe},fe.Consumer=fe},react_production_min.createElement=N,react_production_min.createFactory=function(fe){var De=N.bind(null,fe);return De.type=fe,De},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(fe){return{$$typeof:y,render:fe}},react_production_min.isValidElement=Ce,react_production_min.lazy=function(fe){return{$$typeof:M,_payload:{_status:-1,_result:fe},_init:P}},react_production_min.memo=function(fe,De){return{$$typeof:w,type:fe,compare:De===void 0?null:De}},react_production_min.startTransition=function(fe){var De=se.transition;se.transition={};try{fe()}finally{se.transition=De}},react_production_min.unstable_act=Re,react_production_min.useCallback=function(fe,De){return ce.current.useCallback(fe,De)},react_production_min.useContext=function(fe){return ce.current.useContext(fe)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(fe){return ce.current.useDeferredValue(fe)},react_production_min.useEffect=function(fe,De){return ce.current.useEffect(fe,De)},react_production_min.useId=function(){return ce.current.useId()},react_production_min.useImperativeHandle=function(fe,De,We){return ce.current.useImperativeHandle(fe,De,We)},react_production_min.useInsertionEffect=function(fe,De){return ce.current.useInsertionEffect(fe,De)},react_production_min.useLayoutEffect=function(fe,De){return ce.current.useLayoutEffect(fe,De)},react_production_min.useMemo=function(fe,De){return ce.current.useMemo(fe,De)},react_production_min.useReducer=function(fe,De,We){return ce.current.useReducer(fe,De,We)},react_production_min.useRef=function(fe){return ce.current.useRef(fe)},react_production_min.useState=function(fe){return ce.current.useState(fe)},react_production_min.useSyncExternalStore=function(fe,De,We){return ce.current.useSyncExternalStore(fe,De,We)},react_production_min.useTransition=function(){return ce.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var i=requireReact(),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),h=Object.prototype.hasOwnProperty,m=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,z={key:!0,ref:!0,__self:!0,__source:!0};function u(y,p,w){var M,b={},I=null,O=null;w!==void 0&&(I=""+w),p.key!==void 0&&(I=""+p.key),p.ref!==void 0&&(O=p.ref);for(M in p)h.call(p,M)&&!z.hasOwnProperty(M)&&(b[M]=p[M]);if(y&&y.defaultProps)for(M in p=y.defaultProps,p)b[M]===void 0&&(b[M]=p[M]);return{$$typeof:n,type:y,key:I,ref:O,props:b,_owner:m.current}}return reactJsxRuntime_production_min.Fragment=a,reactJsxRuntime_production_min.jsx=u,reactJsxRuntime_production_min.jsxs=u,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(i){function n(se,X){var Re=se.length;se.push(X);e:for(;0<Re;){var fe=Re-1>>>1,De=se[fe];if(0<m(De,X))se[fe]=X,se[Re]=De,Re=fe;else break e}}function a(se){return se.length===0?null:se[0]}function h(se){if(se.length===0)return null;var X=se[0],Re=se.pop();if(Re!==X){se[0]=Re;e:for(var fe=0,De=se.length,We=De>>>1;fe<We;){var oe=2*(fe+1)-1,Ae=se[oe],He=oe+1,Ue=se[He];if(0>m(Ae,Re))He<De&&0>m(Ue,Ae)?(se[fe]=Ue,se[He]=Re,fe=He):(se[fe]=Ae,se[oe]=Re,fe=oe);else if(He<De&&0>m(Ue,Re))se[fe]=Ue,se[He]=Re,fe=He;else break e}}return X}function m(se,X){var Re=se.sortIndex-X.sortIndex;return Re!==0?Re:se.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var z=performance;i.unstable_now=function(){return z.now()}}else{var u=Date,y=u.now();i.unstable_now=function(){return u.now()-y}}var p=[],w=[],M=1,b=null,I=3,O=!1,T=!1,L=!1,Q=typeof setTimeout=="function"?setTimeout:null,ne=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(se){for(var X=a(w);X!==null;){if(X.callback===null)h(w);else if(X.startTime<=se)h(w),X.sortIndex=X.expirationTime,n(p,X);else break;X=a(w)}}function F(se){if(L=!1,_(se),!T)if(a(p)!==null)T=!0,P(j);else{var X=a(w);X!==null&&ce(F,X.startTime-se)}}function j(se,X){T=!1,L&&(L=!1,ne(N),N=-1),O=!0;var Re=I;try{for(_(X),b=a(p);b!==null&&(!(b.expirationTime>X)||se&&!he());){var fe=b.callback;if(typeof fe=="function"){b.callback=null,I=b.priorityLevel;var De=fe(b.expirationTime<=X);X=i.unstable_now(),typeof De=="function"?b.callback=De:b===a(p)&&h(p),_(X)}else h(p);b=a(p)}if(b!==null)var We=!0;else{var oe=a(w);oe!==null&&ce(F,oe.startTime-X),We=!1}return We}finally{b=null,I=Re,O=!1}}var G=!1,q=null,N=-1,ee=5,Ce=-1;function he(){return!(i.unstable_now()-Ce<ee)}function ge(){if(q!==null){var se=i.unstable_now();Ce=se;var X=!0;try{X=q(!0,se)}finally{X?me():(G=!1,q=null)}}else G=!1}var me;if(typeof Z=="function")me=function(){Z(ge)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,ue=Me.port2;Me.port1.onmessage=ge,me=function(){ue.postMessage(null)}}else me=function(){Q(ge,0)};function P(se){q=se,G||(G=!0,me())}function ce(se,X){N=Q(function(){se(i.unstable_now())},X)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(se){se.callback=null},i.unstable_continueExecution=function(){T||O||(T=!0,P(j))},i.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<se?Math.floor(1e3/se):5},i.unstable_getCurrentPriorityLevel=function(){return I},i.unstable_getFirstCallbackNode=function(){return a(p)},i.unstable_next=function(se){switch(I){case 1:case 2:case 3:var X=3;break;default:X=I}var Re=I;I=X;try{return se()}finally{I=Re}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(se,X){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var Re=I;I=se;try{return X()}finally{I=Re}},i.unstable_scheduleCallback=function(se,X,Re){var fe=i.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?fe+Re:fe):Re=fe,se){case 1:var De=-1;break;case 2:De=250;break;case 5:De=1073741823;break;case 4:De=1e4;break;default:De=5e3}return De=Re+De,se={id:M++,callback:X,priorityLevel:se,startTime:Re,expirationTime:De,sortIndex:-1},Re>fe?(se.sortIndex=Re,n(w,se),a(p)===null&&se===a(w)&&(L?(ne(N),N=-1):L=!0,ce(F,Re-fe))):(se.sortIndex=De,n(p,se),T||O||(T=!0,P(j))),se},i.unstable_shouldYield=he,i.unstable_wrapCallback=function(se){var X=I;return function(){var Re=I;I=X;try{return se.apply(this,arguments)}finally{I=Re}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var i=requireReact(),n=requireScheduler();function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)t+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var h=new Set,m={};function z(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(m[e]=t,e=0;e<t.length;e++)h.add(t[e])}var y=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,w=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,M={},b={};function I(e){return p.call(b,e)?!0:p.call(M,e)?!1:w.test(e)?b[e]=!0:(M[e]=!0,!1)}function O(e,t,o,d){if(o!==null&&o.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return d?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function T(e,t,o,d){if(t===null||typeof t>"u"||O(e,t,o,d))return!0;if(d)return!1;if(o!==null)switch(o.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function L(e,t,o,d,R,B,re){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=d,this.attributeNamespace=R,this.mustUseProperty=o,this.propertyName=e,this.type=t,this.sanitizeURL=B,this.removeEmptyString=re}var Q={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Q[e]=new L(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Q[t]=new L(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){Q[e]=new L(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Q[e]=new L(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Q[e]=new L(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){Q[e]=new L(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){Q[e]=new L(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){Q[e]=new L(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){Q[e]=new L(e,5,!1,e.toLowerCase(),null,!1,!1)});var ne=/[\-:]([a-z])/g;function Z(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ne,Z);Q[t]=new L(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ne,Z);Q[t]=new L(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ne,Z);Q[t]=new L(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){Q[e]=new L(e,1,!1,e.toLowerCase(),null,!1,!1)}),Q.xlinkHref=new L("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){Q[e]=new L(e,1,!1,e.toLowerCase(),null,!0,!0)});function _(e,t,o,d){var R=Q.hasOwnProperty(t)?Q[t]:null;(R!==null?R.type!==0:d||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(T(t,o,R,d)&&(o=null),d||R===null?I(t)&&(o===null?e.removeAttribute(t):e.setAttribute(t,""+o)):R.mustUseProperty?e[R.propertyName]=o===null?R.type===3?!1:"":o:(t=R.attributeName,d=R.attributeNamespace,o===null?e.removeAttribute(t):(R=R.type,o=R===3||R===4&&o===!0?"":""+o,d?e.setAttributeNS(d,t,o):e.setAttribute(t,o))))}var F=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),G=Symbol.for("react.portal"),q=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),Ce=Symbol.for("react.provider"),he=Symbol.for("react.context"),ge=Symbol.for("react.forward_ref"),me=Symbol.for("react.suspense"),Me=Symbol.for("react.suspense_list"),ue=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),ce=Symbol.for("react.offscreen"),se=Symbol.iterator;function X(e){return e===null||typeof e!="object"?null:(e=se&&e[se]||e["@@iterator"],typeof e=="function"?e:null)}var Re=Object.assign,fe;function De(e){if(fe===void 0)try{throw Error()}catch(o){var t=o.stack.trim().match(/\n( *(at )?)/);fe=t&&t[1]||""}return`
`+fe+e}var We=!1;function oe(e,t){if(!e||We)return"";We=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(qe){var d=qe}Reflect.construct(e,[],t)}else{try{t.call()}catch(qe){d=qe}e.call(t.prototype)}else{try{throw Error()}catch(qe){d=qe}e()}}catch(qe){if(qe&&d&&typeof qe.stack=="string"){for(var R=qe.stack.split(`
`),B=d.stack.split(`
`),re=R.length-1,Ee=B.length-1;1<=re&&0<=Ee&&R[re]!==B[Ee];)Ee--;for(;1<=re&&0<=Ee;re--,Ee--)if(R[re]!==B[Ee]){if(re!==1||Ee!==1)do if(re--,Ee--,0>Ee||R[re]!==B[Ee]){var Fe=`
`+R[re].replace(" at new "," at ");return e.displayName&&Fe.includes("<anonymous>")&&(Fe=Fe.replace("<anonymous>",e.displayName)),Fe}while(1<=re&&0<=Ee);break}}}finally{We=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?De(e):""}function Ae(e){switch(e.tag){case 5:return De(e.type);case 16:return De("Lazy");case 13:return De("Suspense");case 19:return De("SuspenseList");case 0:case 2:case 15:return e=oe(e.type,!1),e;case 11:return e=oe(e.type.render,!1),e;case 1:return e=oe(e.type,!0),e;default:return""}}function He(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case q:return"Fragment";case G:return"Portal";case ee:return"Profiler";case N:return"StrictMode";case me:return"Suspense";case Me:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case he:return(e.displayName||"Context")+".Consumer";case Ce:return(e._context.displayName||"Context")+".Provider";case ge:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ue:return t=e.displayName||null,t!==null?t:He(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return He(e(t))}catch{}}return null}function Ue(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return He(t);case 8:return t===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ie(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function rt(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function st(e){var t=rt(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),d=""+e[t];if(!e.hasOwnProperty(t)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var R=o.get,B=o.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return R.call(this)},set:function(re){d=""+re,B.call(this,re)}}),Object.defineProperty(e,t,{enumerable:o.enumerable}),{getValue:function(){return d},setValue:function(re){d=""+re},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function at(e){e._valueTracker||(e._valueTracker=st(e))}function Ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var o=t.getValue(),d="";return e&&(d=rt(e)?e.checked?"true":"false":e.value),e=d,e!==o?(t.setValue(e),!0):!1}function Ct(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function or(e,t){var o=t.checked;return Re({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function ar(e,t){var o=t.defaultValue==null?"":t.defaultValue,d=t.checked!=null?t.checked:t.defaultChecked;o=Ie(t.value!=null?t.value:o),e._wrapperState={initialChecked:d,initialValue:o,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function kr(e,t){t=t.checked,t!=null&&_(e,"checked",t,!1)}function Ar(e,t){kr(e,t);var o=Ie(t.value),d=t.type;if(o!=null)d==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(d==="submit"||d==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?vr(e,t.type,o):t.hasOwnProperty("defaultValue")&&vr(e,t.type,Ie(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function pr(e,t,o){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var d=t.type;if(!(d!=="submit"&&d!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,o||t===e.value||(e.value=t),e.defaultValue=t}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function vr(e,t,o){(t!=="number"||Ct(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var xr=Array.isArray;function fi(e,t,o,d){if(e=e.options,t){t={};for(var R=0;R<o.length;R++)t["$"+o[R]]=!0;for(o=0;o<e.length;o++)R=t.hasOwnProperty("$"+e[o].value),e[o].selected!==R&&(e[o].selected=R),R&&d&&(e[o].defaultSelected=!0)}else{for(o=""+Ie(o),t=null,R=0;R<e.length;R++){if(e[R].value===o){e[R].selected=!0,d&&(e[R].defaultSelected=!0);return}t!==null||e[R].disabled||(t=e[R])}t!==null&&(t.selected=!0)}}function Rr(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(a(91));return Re({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ir(e,t){var o=t.value;if(o==null){if(o=t.children,t=t.defaultValue,o!=null){if(t!=null)throw Error(a(92));if(xr(o)){if(1<o.length)throw Error(a(93));o=o[0]}t=o}t==null&&(t=""),o=t}e._wrapperState={initialValue:Ie(o)}}function Di(e,t){var o=Ie(t.value),d=Ie(t.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),t.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),d!=null&&(e.defaultValue=""+d)}function bi(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Hi(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pe(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Hi(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Se,Le=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,o,d,R){MSApp.execUnsafeLocalFunction(function(){return e(t,o,d,R)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Se=Se||document.createElement("div"),Se.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Se.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function dt(e,t){if(t){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=t;return}}e.textContent=t}var nt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zt=["Webkit","ms","Moz","O"];Object.keys(nt).forEach(function(e){zt.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),nt[t]=nt[e]})});function ht(e,t,o){return t==null||typeof t=="boolean"||t===""?"":o||typeof t!="number"||t===0||nt.hasOwnProperty(e)&&nt[e]?(""+t).trim():t+"px"}function Lt(e,t){e=e.style;for(var o in t)if(t.hasOwnProperty(o)){var d=o.indexOf("--")===0,R=ht(o,t[o],d);o==="float"&&(o="cssFloat"),d?e.setProperty(o,R):e[o]=R}}var Ut=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function It(e,t){if(t){if(Ut[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(a(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(a(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(t.style!=null&&typeof t.style!="object")throw Error(a(62))}}function mr(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var li=null;function Ci(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ui=null,gi=null,jr=null;function Lr(e){if(e=Is(e)){if(typeof ui!="function")throw Error(a(280));var t=e.stateNode;t&&(t=ro(t),ui(e.stateNode,e.type,t))}}function Dr(e){gi?jr?jr.push(e):jr=[e]:gi=e}function rr(){if(gi){var e=gi,t=jr;if(jr=gi=null,Lr(e),t)for(e=0;e<t.length;e++)Lr(t[e])}}function vi(e,t){return e(t)}function wi(){}var Ki=!1;function Ei(e,t,o){if(Ki)return e(t,o);Ki=!0;try{return vi(e,t,o)}finally{Ki=!1,(gi!==null||jr!==null)&&(wi(),rr())}}function Ni(e,t){var o=e.stateNode;if(o===null)return null;var d=ro(o);if(d===null)return null;o=d[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(e=e.type,d=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!d;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(a(231,t,typeof o));return o}var Ti=!1;if(y)try{var pi={};Object.defineProperty(pi,"passive",{get:function(){Ti=!0}}),window.addEventListener("test",pi,pi),window.removeEventListener("test",pi,pi)}catch{Ti=!1}function Br(e,t,o,d,R,B,re,Ee,Fe){var qe=Array.prototype.slice.call(arguments,3);try{t.apply(o,qe)}catch(xt){this.onError(xt)}}var Yr=!1,Vi=null,yi=!1,Wi=null,tn={onError:function(e){Yr=!0,Vi=e}};function on(e,t,o,d,R,B,re,Ee,Fe){Yr=!1,Vi=null,Br.apply(tn,arguments)}function ur(e,t,o,d,R,B,re,Ee,Fe){if(on.apply(this,arguments),Yr){if(Yr){var qe=Vi;Yr=!1,Vi=null}else throw Error(a(198));yi||(yi=!0,Wi=qe)}}function Gr(e){var t=e,o=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(o=t.return),e=t.return;while(e)}return t.tag===3?o:null}function Kr(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Zi(e){if(Gr(e)!==e)throw Error(a(188))}function Bt(e){var t=e.alternate;if(!t){if(t=Gr(e),t===null)throw Error(a(188));return t!==e?null:e}for(var o=e,d=t;;){var R=o.return;if(R===null)break;var B=R.alternate;if(B===null){if(d=R.return,d!==null){o=d;continue}break}if(R.child===B.child){for(B=R.child;B;){if(B===o)return Zi(R),e;if(B===d)return Zi(R),t;B=B.sibling}throw Error(a(188))}if(o.return!==d.return)o=R,d=B;else{for(var re=!1,Ee=R.child;Ee;){if(Ee===o){re=!0,o=R,d=B;break}if(Ee===d){re=!0,d=R,o=B;break}Ee=Ee.sibling}if(!re){for(Ee=B.child;Ee;){if(Ee===o){re=!0,o=B,d=R;break}if(Ee===d){re=!0,d=B,o=R;break}Ee=Ee.sibling}if(!re)throw Error(a(189))}}if(o.alternate!==d)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?e:t}function x(e){return e=Bt(e),e!==null?ie(e):null}function ie(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ie(e);if(t!==null)return t;e=e.sibling}return null}var xe=n.unstable_scheduleCallback,Ve=n.unstable_cancelCallback,Oe=n.unstable_shouldYield,yt=n.unstable_requestPaint,lt=n.unstable_now,mt=n.unstable_getCurrentPriorityLevel,Mt=n.unstable_ImmediatePriority,Pt=n.unstable_UserBlockingPriority,Ot=n.unstable_NormalPriority,gr=n.unstable_LowPriority,Yt=n.unstable_IdlePriority,Cr=null,Er=null;function Ur(e){if(Er&&typeof Er.onCommitFiberRoot=="function")try{Er.onCommitFiberRoot(Cr,e,void 0,(e.current.flags&128)===128)}catch{}}var _r=Math.clz32?Math.clz32:Mi,Or=Math.log,br=Math.LN2;function Mi(e){return e>>>=0,e===0?32:31-(Or(e)/br|0)|0}var Qt=64,ri=4194304;function ae(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function r(e,t){var o=e.pendingLanes;if(o===0)return 0;var d=0,R=e.suspendedLanes,B=e.pingedLanes,re=o&268435455;if(re!==0){var Ee=re&~R;Ee!==0?d=ae(Ee):(B&=re,B!==0&&(d=ae(B)))}else re=o&~R,re!==0?d=ae(re):B!==0&&(d=ae(B));if(d===0)return 0;if(t!==0&&t!==d&&(t&R)===0&&(R=d&-d,B=t&-t,R>=B||R===16&&(B&4194240)!==0))return t;if((d&4)!==0&&(d|=o&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=d;0<t;)o=31-_r(t),R=1<<o,d|=e[o],t&=~R;return d}function s(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function l(e,t){for(var o=e.suspendedLanes,d=e.pingedLanes,R=e.expirationTimes,B=e.pendingLanes;0<B;){var re=31-_r(B),Ee=1<<re,Fe=R[re];Fe===-1?((Ee&o)===0||(Ee&d)!==0)&&(R[re]=s(Ee,t)):Fe<=t&&(e.expiredLanes|=Ee),B&=~Ee}}function c(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function A(){var e=Qt;return Qt<<=1,(Qt&4194240)===0&&(Qt=64),e}function g(e){for(var t=[],o=0;31>o;o++)t.push(e);return t}function C(e,t,o){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-_r(t),e[t]=o}function E(e,t){var o=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var d=e.eventTimes;for(e=e.expirationTimes;0<o;){var R=31-_r(o),B=1<<R;t[R]=0,d[R]=-1,e[R]=-1,o&=~B}}function S(e,t){var o=e.entangledLanes|=t;for(e=e.entanglements;o;){var d=31-_r(o),R=1<<d;R&t|e[d]&t&&(e[d]|=t),o&=~R}}var k=0;function D(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var $,U,V,W,H,Y=!1,J=[],te=null,de=null,le=null,ye=new Map,Pe=new Map,Te=[],ke="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function be(e,t){switch(e){case"focusin":case"focusout":te=null;break;case"dragenter":case"dragleave":de=null;break;case"mouseover":case"mouseout":le=null;break;case"pointerover":case"pointerout":ye.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pe.delete(t.pointerId)}}function Ge(e,t,o,d,R,B){return e===null||e.nativeEvent!==B?(e={blockedOn:t,domEventName:o,eventSystemFlags:d,nativeEvent:B,targetContainers:[R]},t!==null&&(t=Is(t),t!==null&&U(t)),e):(e.eventSystemFlags|=d,t=e.targetContainers,R!==null&&t.indexOf(R)===-1&&t.push(R),e)}function Je(e,t,o,d,R){switch(t){case"focusin":return te=Ge(te,e,t,o,d,R),!0;case"dragenter":return de=Ge(de,e,t,o,d,R),!0;case"mouseover":return le=Ge(le,e,t,o,d,R),!0;case"pointerover":var B=R.pointerId;return ye.set(B,Ge(ye.get(B)||null,e,t,o,d,R)),!0;case"gotpointercapture":return B=R.pointerId,Pe.set(B,Ge(Pe.get(B)||null,e,t,o,d,R)),!0}return!1}function tt(e){var t=Kn(e.target);if(t!==null){var o=Gr(t);if(o!==null){if(t=o.tag,t===13){if(t=Kr(o),t!==null){e.blockedOn=t,H(e.priority,function(){V(o)});return}}else if(t===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ye(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var o=it(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var d=new o.constructor(o.type,o);li=d,o.target.dispatchEvent(d),li=null}else return t=Is(o),t!==null&&U(t),e.blockedOn=o,!1;t.shift()}return!0}function ut(e,t,o){Ye(e)&&o.delete(t)}function ft(){Y=!1,te!==null&&Ye(te)&&(te=null),de!==null&&Ye(de)&&(de=null),le!==null&&Ye(le)&&(le=null),ye.forEach(ut),Pe.forEach(ut)}function Qe(e,t){e.blockedOn===t&&(e.blockedOn=null,Y||(Y=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,ft)))}function pt(e){function t(R){return Qe(R,e)}if(0<J.length){Qe(J[0],e);for(var o=1;o<J.length;o++){var d=J[o];d.blockedOn===e&&(d.blockedOn=null)}}for(te!==null&&Qe(te,e),de!==null&&Qe(de,e),le!==null&&Qe(le,e),ye.forEach(t),Pe.forEach(t),o=0;o<Te.length;o++)d=Te[o],d.blockedOn===e&&(d.blockedOn=null);for(;0<Te.length&&(o=Te[0],o.blockedOn===null);)tt(o),o.blockedOn===null&&Te.shift()}var Be=F.ReactCurrentBatchConfig,et=!0;function St(e,t,o,d){var R=k,B=Be.transition;Be.transition=null;try{k=1,bt(e,t,o,d)}finally{k=R,Be.transition=B}}function ot(e,t,o,d){var R=k,B=Be.transition;Be.transition=null;try{k=4,bt(e,t,o,d)}finally{k=R,Be.transition=B}}function bt(e,t,o,d){if(et){var R=it(e,t,o,d);if(R===null)Yo(e,t,d,At,o),be(e,d);else if(Je(R,e,t,o,d))d.stopPropagation();else if(be(e,d),t&4&&-1<ke.indexOf(e)){for(;R!==null;){var B=Is(R);if(B!==null&&$(B),B=it(e,t,o,d),B===null&&Yo(e,t,d,At,o),B===R)break;R=B}R!==null&&d.stopPropagation()}else Yo(e,t,d,null,o)}}var At=null;function it(e,t,o,d){if(At=null,e=Ci(d),e=Kn(e),e!==null)if(t=Gr(e),t===null)e=null;else if(o=t.tag,o===13){if(e=Kr(t),e!==null)return e;e=null}else if(o===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return At=e,null}function Rt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mt()){case Mt:return 1;case Pt:return 4;case Ot:case gr:return 16;case Yt:return 536870912;default:return 16}default:return 16}}var Ht=null,kt=null,ct=null;function Jt(){if(ct)return ct;var e,t=kt,o=t.length,d,R="value"in Ht?Ht.value:Ht.textContent,B=R.length;for(e=0;e<o&&t[e]===R[e];e++);var re=o-e;for(d=1;d<=re&&t[o-d]===R[B-d];d++);return ct=R.slice(e,1<d?1-d:void 0)}function Nt(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Zt(){return!0}function Vt(){return!1}function Xt(e){function t(o,d,R,B,re){this._reactName=o,this._targetInst=R,this.type=d,this.nativeEvent=B,this.target=re,this.currentTarget=null;for(var Ee in e)e.hasOwnProperty(Ee)&&(o=e[Ee],this[Ee]=o?o(B):B[Ee]);return this.isDefaultPrevented=(B.defaultPrevented!=null?B.defaultPrevented:B.returnValue===!1)?Zt:Vt,this.isPropagationStopped=Vt,this}return Re(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Zt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Zt)},persist:function(){},isPersistent:Zt}),t}var yr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fr=Xt(yr),Tr=Re({},yr,{view:0,detail:0}),ii=Xt(Tr),Wr,wr,$r,ci=Re({},Tr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xe,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$r&&($r&&e.type==="mousemove"?(Wr=e.screenX-$r.screenX,wr=e.screenY-$r.screenY):wr=Wr=0,$r=e),Wr)},movementY:function(e){return"movementY"in e?e.movementY:wr}}),ni=Xt(ci),hi=Re({},ci,{dataTransfer:0}),zi=Xt(hi),xi=Re({},Tr,{relatedTarget:0}),Ii=Xt(xi),Hr=Re({},yr,{animationName:0,elapsedTime:0,pseudoElement:0}),Xr=Xt(Hr),Zr=Re({},yr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ei=Xt(Zr),f=Re({},yr,{data:0}),K=Xt(f),v={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},we={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_e={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ve(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_e[e])?!!t[e]:!1}function Xe(){return ve}var ze=Re({},Tr,{key:function(e){if(e.key){var t=v[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Nt(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?we[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xe,charCode:function(e){return e.type==="keypress"?Nt(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Nt(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),gt=Xt(ze),Ne=Re({},ci,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ke=Xt(Ne),dr=Re({},Tr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xe}),Wt=Xt(dr),_t=Re({},yr,{propertyName:0,elapsedTime:0,pseudoElement:0}),si=Xt(_t),Mr=Re({},ci,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),er=Xt(Mr),zr=[9,13,27,32],lr=y&&"CompositionEvent"in window,Et=null;y&&"documentMode"in document&&(Et=document.documentMode);var sr=y&&"TextEvent"in window&&!Et,Pr=y&&(!lr||Et&&8<Et&&11>=Et),Dt=" ",Sr=!1;function cr(e,t){switch(e){case"keyup":return zr.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tr(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var fr=!1;function Li(e,t){switch(e){case"compositionend":return tr(t);case"keypress":return t.which!==32?null:(Sr=!0,Dt);case"textInput":return e=t.data,e===Dt&&Sr?null:e;default:return null}}function Wn(e,t){if(fr)return e==="compositionend"||!lr&&cr(e,t)?(e=Jt(),ct=kt=Ht=null,fr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pr&&t.locale!=="ko"?null:t.data;default:return null}}var os={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $n(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!os[e.type]:t==="textarea"}function Xn(e,t,o,d){Dr(d),t=Js(t,"onChange"),0<t.length&&(o=new Fr("onChange","change",null,o,d),e.push({event:o,listeners:t}))}var Es=null,Ts=null;function lc(e){Al(e,0)}function Zs(e){var t=hs(e);if(Ft(t))return e}function uc(e,t){if(e==="change")return t}var al=!1;if(y){var Uo;if(y){var Go="oninput"in document;if(!Go){var ll=document.createElement("div");ll.setAttribute("oninput","return;"),Go=typeof ll.oninput=="function"}Uo=Go}else Uo=!1;al=Uo&&(!document.documentMode||9<document.documentMode)}function ul(){Es&&(Es.detachEvent("onpropertychange",cl),Ts=Es=null)}function cl(e){if(e.propertyName==="value"&&Zs(Ts)){var t=[];Xn(t,Ts,e,Ci(e)),Ei(lc,t)}}function cc(e,t,o){e==="focusin"?(ul(),Es=t,Ts=o,Es.attachEvent("onpropertychange",cl)):e==="focusout"&&ul()}function hc(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Zs(Ts)}function dc(e,t){if(e==="click")return Zs(t)}function fc(e,t){if(e==="input"||e==="change")return Zs(t)}function pc(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fn=typeof Object.is=="function"?Object.is:pc;function Ms(e,t){if(fn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var o=Object.keys(e),d=Object.keys(t);if(o.length!==d.length)return!1;for(d=0;d<o.length;d++){var R=o[d];if(!p.call(t,R)||!fn(e[R],t[R]))return!1}return!0}function hl(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dl(e,t){var o=hl(e);e=0;for(var d;o;){if(o.nodeType===3){if(d=e+o.textContent.length,e<=t&&d>=t)return{node:o,offset:t-e};e=d}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=hl(o)}}function fl(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?fl(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function pl(){for(var e=window,t=Ct();t instanceof e.HTMLIFrameElement;){try{var o=typeof t.contentWindow.location.href=="string"}catch{o=!1}if(o)e=t.contentWindow;else break;t=Ct(e.document)}return t}function Ho(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function mc(e){var t=pl(),o=e.focusedElem,d=e.selectionRange;if(t!==o&&o&&o.ownerDocument&&fl(o.ownerDocument.documentElement,o)){if(d!==null&&Ho(o)){if(t=d.start,e=d.end,e===void 0&&(e=t),"selectionStart"in o)o.selectionStart=t,o.selectionEnd=Math.min(e,o.value.length);else if(e=(t=o.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var R=o.textContent.length,B=Math.min(d.start,R);d=d.end===void 0?B:Math.min(d.end,R),!e.extend&&B>d&&(R=d,d=B,B=R),R=dl(o,B);var re=dl(o,d);R&&re&&(e.rangeCount!==1||e.anchorNode!==R.node||e.anchorOffset!==R.offset||e.focusNode!==re.node||e.focusOffset!==re.offset)&&(t=t.createRange(),t.setStart(R.node,R.offset),e.removeAllRanges(),B>d?(e.addRange(t),e.extend(re.node,re.offset)):(t.setEnd(re.node,re.offset),e.addRange(t)))}}for(t=[],e=o;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<t.length;o++)e=t[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gc=y&&"documentMode"in document&&11>=document.documentMode,as=null,Wo=null,ks=null,$o=!1;function ml(e,t,o){var d=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;$o||as==null||as!==Ct(d)||(d=as,"selectionStart"in d&&Ho(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),ks&&Ms(ks,d)||(ks=d,d=Js(Wo,"onSelect"),0<d.length&&(t=new Fr("onSelect","select",null,t,o),e.push({event:t,listeners:d}),t.target=as)))}function qs(e,t){var o={};return o[e.toLowerCase()]=t.toLowerCase(),o["Webkit"+e]="webkit"+t,o["Moz"+e]="moz"+t,o}var ls={animationend:qs("Animation","AnimationEnd"),animationiteration:qs("Animation","AnimationIteration"),animationstart:qs("Animation","AnimationStart"),transitionend:qs("Transition","TransitionEnd")},Xo={},gl={};y&&(gl=document.createElement("div").style,"AnimationEvent"in window||(delete ls.animationend.animation,delete ls.animationiteration.animation,delete ls.animationstart.animation),"TransitionEvent"in window||delete ls.transitionend.transition);function Ys(e){if(Xo[e])return Xo[e];if(!ls[e])return e;var t=ls[e],o;for(o in t)if(t.hasOwnProperty(o)&&o in gl)return Xo[e]=t[o];return e}var vl=Ys("animationend"),yl=Ys("animationiteration"),xl=Ys("animationstart"),_l=Ys("transitionend"),bl=new Map,wl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pn(e,t){bl.set(e,t),z(t,[e])}for(var Ko=0;Ko<wl.length;Ko++){var Zo=wl[Ko],vc=Zo.toLowerCase(),yc=Zo[0].toUpperCase()+Zo.slice(1);Pn(vc,"on"+yc)}Pn(vl,"onAnimationEnd"),Pn(yl,"onAnimationIteration"),Pn(xl,"onAnimationStart"),Pn("dblclick","onDoubleClick"),Pn("focusin","onFocus"),Pn("focusout","onBlur"),Pn(_l,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),z("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),z("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),z("onBeforeInput",["compositionend","keypress","textInput","paste"]),z("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),z("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),z("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xc=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rs));function Sl(e,t,o){var d=e.type||"unknown-event";e.currentTarget=o,ur(d,t,void 0,e),e.currentTarget=null}function Al(e,t){t=(t&4)!==0;for(var o=0;o<e.length;o++){var d=e[o],R=d.event;d=d.listeners;e:{var B=void 0;if(t)for(var re=d.length-1;0<=re;re--){var Ee=d[re],Fe=Ee.instance,qe=Ee.currentTarget;if(Ee=Ee.listener,Fe!==B&&R.isPropagationStopped())break e;Sl(R,Ee,qe),B=Fe}else for(re=0;re<d.length;re++){if(Ee=d[re],Fe=Ee.instance,qe=Ee.currentTarget,Ee=Ee.listener,Fe!==B&&R.isPropagationStopped())break e;Sl(R,Ee,qe),B=Fe}}}if(yi)throw e=Wi,yi=!1,Wi=null,e}function Qr(e,t){var o=t[ia];o===void 0&&(o=t[ia]=new Set);var d=e+"__bubble";o.has(d)||(Cl(t,e,2,!1),o.add(d))}function qo(e,t,o){var d=0;t&&(d|=4),Cl(o,e,d,t)}var Qs="_reactListening"+Math.random().toString(36).slice(2);function Ps(e){if(!e[Qs]){e[Qs]=!0,h.forEach(function(o){o!=="selectionchange"&&(xc.has(o)||qo(o,!1,e),qo(o,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Qs]||(t[Qs]=!0,qo("selectionchange",!1,t))}}function Cl(e,t,o,d){switch(Rt(t)){case 1:var R=St;break;case 4:R=ot;break;default:R=bt}o=R.bind(null,t,o,e),R=void 0,!Ti||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(R=!0),d?R!==void 0?e.addEventListener(t,o,{capture:!0,passive:R}):e.addEventListener(t,o,!0):R!==void 0?e.addEventListener(t,o,{passive:R}):e.addEventListener(t,o,!1)}function Yo(e,t,o,d,R){var B=d;if((t&1)===0&&(t&2)===0&&d!==null)e:for(;;){if(d===null)return;var re=d.tag;if(re===3||re===4){var Ee=d.stateNode.containerInfo;if(Ee===R||Ee.nodeType===8&&Ee.parentNode===R)break;if(re===4)for(re=d.return;re!==null;){var Fe=re.tag;if((Fe===3||Fe===4)&&(Fe=re.stateNode.containerInfo,Fe===R||Fe.nodeType===8&&Fe.parentNode===R))return;re=re.return}for(;Ee!==null;){if(re=Kn(Ee),re===null)return;if(Fe=re.tag,Fe===5||Fe===6){d=B=re;continue e}Ee=Ee.parentNode}}d=d.return}Ei(function(){var qe=B,xt=Ci(o),wt=[];e:{var vt=bl.get(e);if(vt!==void 0){var jt=Fr,$t=e;switch(e){case"keypress":if(Nt(o)===0)break e;case"keydown":case"keyup":jt=gt;break;case"focusin":$t="focus",jt=Ii;break;case"focusout":$t="blur",jt=Ii;break;case"beforeblur":case"afterblur":jt=Ii;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":jt=ni;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":jt=zi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":jt=Wt;break;case vl:case yl:case xl:jt=Xr;break;case _l:jt=si;break;case"scroll":jt=ii;break;case"wheel":jt=er;break;case"copy":case"cut":case"paste":jt=ei;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":jt=Ke}var Kt=(t&4)!==0,mi=!Kt&&e==="scroll",$e=Kt?vt!==null?vt+"Capture":null:vt;Kt=[];for(var je=qe,Ze;je!==null;){Ze=je;var Tt=Ze.stateNode;if(Ze.tag===5&&Tt!==null&&(Ze=Tt,$e!==null&&(Tt=Ni(je,$e),Tt!=null&&Kt.push(Ds(je,Tt,Ze)))),mi)break;je=je.return}0<Kt.length&&(vt=new jt(vt,$t,null,o,xt),wt.push({event:vt,listeners:Kt}))}}if((t&7)===0){e:{if(vt=e==="mouseover"||e==="pointerover",jt=e==="mouseout"||e==="pointerout",vt&&o!==li&&($t=o.relatedTarget||o.fromElement)&&(Kn($t)||$t[Sn]))break e;if((jt||vt)&&(vt=xt.window===xt?xt:(vt=xt.ownerDocument)?vt.defaultView||vt.parentWindow:window,jt?($t=o.relatedTarget||o.toElement,jt=qe,$t=$t?Kn($t):null,$t!==null&&(mi=Gr($t),$t!==mi||$t.tag!==5&&$t.tag!==6)&&($t=null)):(jt=null,$t=qe),jt!==$t)){if(Kt=ni,Tt="onMouseLeave",$e="onMouseEnter",je="mouse",(e==="pointerout"||e==="pointerover")&&(Kt=Ke,Tt="onPointerLeave",$e="onPointerEnter",je="pointer"),mi=jt==null?vt:hs(jt),Ze=$t==null?vt:hs($t),vt=new Kt(Tt,je+"leave",jt,o,xt),vt.target=mi,vt.relatedTarget=Ze,Tt=null,Kn(xt)===qe&&(Kt=new Kt($e,je+"enter",$t,o,xt),Kt.target=Ze,Kt.relatedTarget=mi,Tt=Kt),mi=Tt,jt&&$t)t:{for(Kt=jt,$e=$t,je=0,Ze=Kt;Ze;Ze=us(Ze))je++;for(Ze=0,Tt=$e;Tt;Tt=us(Tt))Ze++;for(;0<je-Ze;)Kt=us(Kt),je--;for(;0<Ze-je;)$e=us($e),Ze--;for(;je--;){if(Kt===$e||$e!==null&&Kt===$e.alternate)break t;Kt=us(Kt),$e=us($e)}Kt=null}else Kt=null;jt!==null&&El(wt,vt,jt,Kt,!1),$t!==null&&mi!==null&&El(wt,mi,$t,Kt,!0)}}e:{if(vt=qe?hs(qe):window,jt=vt.nodeName&&vt.nodeName.toLowerCase(),jt==="select"||jt==="input"&&vt.type==="file")var qt=uc;else if($n(vt))if(al)qt=fc;else{qt=hc;var ir=cc}else(jt=vt.nodeName)&&jt.toLowerCase()==="input"&&(vt.type==="checkbox"||vt.type==="radio")&&(qt=dc);if(qt&&(qt=qt(e,qe))){Xn(wt,qt,o,xt);break e}ir&&ir(e,vt,qe),e==="focusout"&&(ir=vt._wrapperState)&&ir.controlled&&vt.type==="number"&&vr(vt,"number",vt.value)}switch(ir=qe?hs(qe):window,e){case"focusin":($n(ir)||ir.contentEditable==="true")&&(as=ir,Wo=qe,ks=null);break;case"focusout":ks=Wo=as=null;break;case"mousedown":$o=!0;break;case"contextmenu":case"mouseup":case"dragend":$o=!1,ml(wt,o,xt);break;case"selectionchange":if(gc)break;case"keydown":case"keyup":ml(wt,o,xt)}var nr;if(lr)e:{switch(e){case"compositionstart":var hr="onCompositionStart";break e;case"compositionend":hr="onCompositionEnd";break e;case"compositionupdate":hr="onCompositionUpdate";break e}hr=void 0}else fr?cr(e,o)&&(hr="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(hr="onCompositionStart");hr&&(Pr&&o.locale!=="ko"&&(fr||hr!=="onCompositionStart"?hr==="onCompositionEnd"&&fr&&(nr=Jt()):(Ht=xt,kt="value"in Ht?Ht.value:Ht.textContent,fr=!0)),ir=Js(qe,hr),0<ir.length&&(hr=new K(hr,e,null,o,xt),wt.push({event:hr,listeners:ir}),nr?hr.data=nr:(nr=tr(o),nr!==null&&(hr.data=nr)))),(nr=sr?Li(e,o):Wn(e,o))&&(qe=Js(qe,"onBeforeInput"),0<qe.length&&(xt=new K("onBeforeInput","beforeinput",null,o,xt),wt.push({event:xt,listeners:qe}),xt.data=nr))}Al(wt,t)})}function Ds(e,t,o){return{instance:e,listener:t,currentTarget:o}}function Js(e,t){for(var o=t+"Capture",d=[];e!==null;){var R=e,B=R.stateNode;R.tag===5&&B!==null&&(R=B,B=Ni(e,o),B!=null&&d.unshift(Ds(e,B,R)),B=Ni(e,t),B!=null&&d.push(Ds(e,B,R))),e=e.return}return d}function us(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function El(e,t,o,d,R){for(var B=t._reactName,re=[];o!==null&&o!==d;){var Ee=o,Fe=Ee.alternate,qe=Ee.stateNode;if(Fe!==null&&Fe===d)break;Ee.tag===5&&qe!==null&&(Ee=qe,R?(Fe=Ni(o,B),Fe!=null&&re.unshift(Ds(o,Fe,Ee))):R||(Fe=Ni(o,B),Fe!=null&&re.push(Ds(o,Fe,Ee)))),o=o.return}re.length!==0&&e.push({event:t,listeners:re})}var _c=/\r\n?/g,bc=/\u0000|\uFFFD/g;function Tl(e){return(typeof e=="string"?e:""+e).replace(_c,`
`).replace(bc,"")}function eo(e,t,o){if(t=Tl(t),Tl(e)!==t&&o)throw Error(a(425))}function to(){}var Qo=null,Jo=null;function ea(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ta=typeof setTimeout=="function"?setTimeout:void 0,wc=typeof clearTimeout=="function"?clearTimeout:void 0,Ml=typeof Promise=="function"?Promise:void 0,Sc=typeof queueMicrotask=="function"?queueMicrotask:typeof Ml<"u"?function(e){return Ml.resolve(null).then(e).catch(Ac)}:ta;function Ac(e){setTimeout(function(){throw e})}function ra(e,t){var o=t,d=0;do{var R=o.nextSibling;if(e.removeChild(o),R&&R.nodeType===8)if(o=R.data,o==="/$"){if(d===0){e.removeChild(R),pt(t);return}d--}else o!=="$"&&o!=="$?"&&o!=="$!"||d++;o=R}while(o);pt(t)}function Dn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function kl(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(t===0)return e;t--}else o==="/$"&&t++}e=e.previousSibling}return null}var cs=Math.random().toString(36).slice(2),xn="__reactFiber$"+cs,zs="__reactProps$"+cs,Sn="__reactContainer$"+cs,ia="__reactEvents$"+cs,Cc="__reactListeners$"+cs,Ec="__reactHandles$"+cs;function Kn(e){var t=e[xn];if(t)return t;for(var o=e.parentNode;o;){if(t=o[Sn]||o[xn]){if(o=t.alternate,t.child!==null||o!==null&&o.child!==null)for(e=kl(e);e!==null;){if(o=e[xn])return o;e=kl(e)}return t}e=o,o=e.parentNode}return null}function Is(e){return e=e[xn]||e[Sn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function hs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(a(33))}function ro(e){return e[zs]||null}var na=[],ds=-1;function zn(e){return{current:e}}function Jr(e){0>ds||(e.current=na[ds],na[ds]=null,ds--)}function qr(e,t){ds++,na[ds]=e.current,e.current=t}var In={},ji=zn(In),qi=zn(!1),Zn=In;function fs(e,t){var o=e.type.contextTypes;if(!o)return In;var d=e.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===t)return d.__reactInternalMemoizedMaskedChildContext;var R={},B;for(B in o)R[B]=t[B];return d&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=R),R}function Yi(e){return e=e.childContextTypes,e!=null}function io(){Jr(qi),Jr(ji)}function Rl(e,t,o){if(ji.current!==In)throw Error(a(168));qr(ji,t),qr(qi,o)}function Pl(e,t,o){var d=e.stateNode;if(t=t.childContextTypes,typeof d.getChildContext!="function")return o;d=d.getChildContext();for(var R in d)if(!(R in t))throw Error(a(108,Ue(e)||"Unknown",R));return Re({},o,d)}function no(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||In,Zn=ji.current,qr(ji,e),qr(qi,qi.current),!0}function Dl(e,t,o){var d=e.stateNode;if(!d)throw Error(a(169));o?(e=Pl(e,t,Zn),d.__reactInternalMemoizedMergedChildContext=e,Jr(qi),Jr(ji),qr(ji,e)):Jr(qi),qr(qi,o)}var An=null,so=!1,sa=!1;function zl(e){An===null?An=[e]:An.push(e)}function Tc(e){so=!0,zl(e)}function Ln(){if(!sa&&An!==null){sa=!0;var e=0,t=k;try{var o=An;for(k=1;e<o.length;e++){var d=o[e];do d=d(!0);while(d!==null)}An=null,so=!1}catch(R){throw An!==null&&(An=An.slice(e+1)),xe(Mt,Ln),R}finally{k=t,sa=!1}}return null}var ps=[],ms=0,oo=null,ao=0,an=[],ln=0,qn=null,Cn=1,En="";function Yn(e,t){ps[ms++]=ao,ps[ms++]=oo,oo=e,ao=t}function Il(e,t,o){an[ln++]=Cn,an[ln++]=En,an[ln++]=qn,qn=e;var d=Cn;e=En;var R=32-_r(d)-1;d&=~(1<<R),o+=1;var B=32-_r(t)+R;if(30<B){var re=R-R%5;B=(d&(1<<re)-1).toString(32),d>>=re,R-=re,Cn=1<<32-_r(t)+R|o<<R|d,En=B+e}else Cn=1<<B|o<<R|d,En=e}function oa(e){e.return!==null&&(Yn(e,1),Il(e,1,0))}function aa(e){for(;e===oo;)oo=ps[--ms],ps[ms]=null,ao=ps[--ms],ps[ms]=null;for(;e===qn;)qn=an[--ln],an[ln]=null,En=an[--ln],an[ln]=null,Cn=an[--ln],an[ln]=null}var rn=null,nn=null,ti=!1,pn=null;function Ll(e,t){var o=dn(5,null,null,0);o.elementType="DELETED",o.stateNode=t,o.return=e,t=e.deletions,t===null?(e.deletions=[o],e.flags|=16):t.push(o)}function Ol(e,t){switch(e.tag){case 5:var o=e.type;return t=t.nodeType!==1||o.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,rn=e,nn=Dn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,rn=e,nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(o=qn!==null?{id:Cn,overflow:En}:null,e.memoizedState={dehydrated:t,treeContext:o,retryLane:1073741824},o=dn(18,null,null,0),o.stateNode=t,o.return=e,e.child=o,rn=e,nn=null,!0):!1;default:return!1}}function la(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ua(e){if(ti){var t=nn;if(t){var o=t;if(!Ol(e,t)){if(la(e))throw Error(a(418));t=Dn(o.nextSibling);var d=rn;t&&Ol(e,t)?Ll(d,o):(e.flags=e.flags&-4097|2,ti=!1,rn=e)}}else{if(la(e))throw Error(a(418));e.flags=e.flags&-4097|2,ti=!1,rn=e}}}function Fl(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;rn=e}function lo(e){if(e!==rn)return!1;if(!ti)return Fl(e),ti=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ea(e.type,e.memoizedProps)),t&&(t=nn)){if(la(e))throw Nl(),Error(a(418));for(;t;)Ll(e,t),t=Dn(t.nextSibling)}if(Fl(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(t===0){nn=Dn(e.nextSibling);break e}t--}else o!=="$"&&o!=="$!"&&o!=="$?"||t++}e=e.nextSibling}nn=null}}else nn=rn?Dn(e.stateNode.nextSibling):null;return!0}function Nl(){for(var e=nn;e;)e=Dn(e.nextSibling)}function gs(){nn=rn=null,ti=!1}function ca(e){pn===null?pn=[e]:pn.push(e)}var Mc=F.ReactCurrentBatchConfig;function Ls(e,t,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(a(309));var d=o.stateNode}if(!d)throw Error(a(147,e));var R=d,B=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===B?t.ref:(t=function(re){var Ee=R.refs;re===null?delete Ee[B]:Ee[B]=re},t._stringRef=B,t)}if(typeof e!="string")throw Error(a(284));if(!o._owner)throw Error(a(290,e))}return e}function uo(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Vl(e){var t=e._init;return t(e._payload)}function jl(e){function t($e,je){if(e){var Ze=$e.deletions;Ze===null?($e.deletions=[je],$e.flags|=16):Ze.push(je)}}function o($e,je){if(!e)return null;for(;je!==null;)t($e,je),je=je.sibling;return null}function d($e,je){for($e=new Map;je!==null;)je.key!==null?$e.set(je.key,je):$e.set(je.index,je),je=je.sibling;return $e}function R($e,je){return $e=Gn($e,je),$e.index=0,$e.sibling=null,$e}function B($e,je,Ze){return $e.index=Ze,e?(Ze=$e.alternate,Ze!==null?(Ze=Ze.index,Ze<je?($e.flags|=2,je):Ze):($e.flags|=2,je)):($e.flags|=1048576,je)}function re($e){return e&&$e.alternate===null&&($e.flags|=2),$e}function Ee($e,je,Ze,Tt){return je===null||je.tag!==6?(je=tl(Ze,$e.mode,Tt),je.return=$e,je):(je=R(je,Ze),je.return=$e,je)}function Fe($e,je,Ze,Tt){var qt=Ze.type;return qt===q?xt($e,je,Ze.props.children,Tt,Ze.key):je!==null&&(je.elementType===qt||typeof qt=="object"&&qt!==null&&qt.$$typeof===P&&Vl(qt)===je.type)?(Tt=R(je,Ze.props),Tt.ref=Ls($e,je,Ze),Tt.return=$e,Tt):(Tt=Io(Ze.type,Ze.key,Ze.props,null,$e.mode,Tt),Tt.ref=Ls($e,je,Ze),Tt.return=$e,Tt)}function qe($e,je,Ze,Tt){return je===null||je.tag!==4||je.stateNode.containerInfo!==Ze.containerInfo||je.stateNode.implementation!==Ze.implementation?(je=rl(Ze,$e.mode,Tt),je.return=$e,je):(je=R(je,Ze.children||[]),je.return=$e,je)}function xt($e,je,Ze,Tt,qt){return je===null||je.tag!==7?(je=ss(Ze,$e.mode,Tt,qt),je.return=$e,je):(je=R(je,Ze),je.return=$e,je)}function wt($e,je,Ze){if(typeof je=="string"&&je!==""||typeof je=="number")return je=tl(""+je,$e.mode,Ze),je.return=$e,je;if(typeof je=="object"&&je!==null){switch(je.$$typeof){case j:return Ze=Io(je.type,je.key,je.props,null,$e.mode,Ze),Ze.ref=Ls($e,null,je),Ze.return=$e,Ze;case G:return je=rl(je,$e.mode,Ze),je.return=$e,je;case P:var Tt=je._init;return wt($e,Tt(je._payload),Ze)}if(xr(je)||X(je))return je=ss(je,$e.mode,Ze,null),je.return=$e,je;uo($e,je)}return null}function vt($e,je,Ze,Tt){var qt=je!==null?je.key:null;if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number")return qt!==null?null:Ee($e,je,""+Ze,Tt);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case j:return Ze.key===qt?Fe($e,je,Ze,Tt):null;case G:return Ze.key===qt?qe($e,je,Ze,Tt):null;case P:return qt=Ze._init,vt($e,je,qt(Ze._payload),Tt)}if(xr(Ze)||X(Ze))return qt!==null?null:xt($e,je,Ze,Tt,null);uo($e,Ze)}return null}function jt($e,je,Ze,Tt,qt){if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number")return $e=$e.get(Ze)||null,Ee(je,$e,""+Tt,qt);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case j:return $e=$e.get(Tt.key===null?Ze:Tt.key)||null,Fe(je,$e,Tt,qt);case G:return $e=$e.get(Tt.key===null?Ze:Tt.key)||null,qe(je,$e,Tt,qt);case P:var ir=Tt._init;return jt($e,je,Ze,ir(Tt._payload),qt)}if(xr(Tt)||X(Tt))return $e=$e.get(Ze)||null,xt(je,$e,Tt,qt,null);uo(je,Tt)}return null}function $t($e,je,Ze,Tt){for(var qt=null,ir=null,nr=je,hr=je=0,Pi=null;nr!==null&&hr<Ze.length;hr++){nr.index>hr?(Pi=nr,nr=null):Pi=nr.sibling;var Vr=vt($e,nr,Ze[hr],Tt);if(Vr===null){nr===null&&(nr=Pi);break}e&&nr&&Vr.alternate===null&&t($e,nr),je=B(Vr,je,hr),ir===null?qt=Vr:ir.sibling=Vr,ir=Vr,nr=Pi}if(hr===Ze.length)return o($e,nr),ti&&Yn($e,hr),qt;if(nr===null){for(;hr<Ze.length;hr++)nr=wt($e,Ze[hr],Tt),nr!==null&&(je=B(nr,je,hr),ir===null?qt=nr:ir.sibling=nr,ir=nr);return ti&&Yn($e,hr),qt}for(nr=d($e,nr);hr<Ze.length;hr++)Pi=jt(nr,$e,hr,Ze[hr],Tt),Pi!==null&&(e&&Pi.alternate!==null&&nr.delete(Pi.key===null?hr:Pi.key),je=B(Pi,je,hr),ir===null?qt=Pi:ir.sibling=Pi,ir=Pi);return e&&nr.forEach(function(Hn){return t($e,Hn)}),ti&&Yn($e,hr),qt}function Kt($e,je,Ze,Tt){var qt=X(Ze);if(typeof qt!="function")throw Error(a(150));if(Ze=qt.call(Ze),Ze==null)throw Error(a(151));for(var ir=qt=null,nr=je,hr=je=0,Pi=null,Vr=Ze.next();nr!==null&&!Vr.done;hr++,Vr=Ze.next()){nr.index>hr?(Pi=nr,nr=null):Pi=nr.sibling;var Hn=vt($e,nr,Vr.value,Tt);if(Hn===null){nr===null&&(nr=Pi);break}e&&nr&&Hn.alternate===null&&t($e,nr),je=B(Hn,je,hr),ir===null?qt=Hn:ir.sibling=Hn,ir=Hn,nr=Pi}if(Vr.done)return o($e,nr),ti&&Yn($e,hr),qt;if(nr===null){for(;!Vr.done;hr++,Vr=Ze.next())Vr=wt($e,Vr.value,Tt),Vr!==null&&(je=B(Vr,je,hr),ir===null?qt=Vr:ir.sibling=Vr,ir=Vr);return ti&&Yn($e,hr),qt}for(nr=d($e,nr);!Vr.done;hr++,Vr=Ze.next())Vr=jt(nr,$e,hr,Vr.value,Tt),Vr!==null&&(e&&Vr.alternate!==null&&nr.delete(Vr.key===null?hr:Vr.key),je=B(Vr,je,hr),ir===null?qt=Vr:ir.sibling=Vr,ir=Vr);return e&&nr.forEach(function(ah){return t($e,ah)}),ti&&Yn($e,hr),qt}function mi($e,je,Ze,Tt){if(typeof Ze=="object"&&Ze!==null&&Ze.type===q&&Ze.key===null&&(Ze=Ze.props.children),typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case j:e:{for(var qt=Ze.key,ir=je;ir!==null;){if(ir.key===qt){if(qt=Ze.type,qt===q){if(ir.tag===7){o($e,ir.sibling),je=R(ir,Ze.props.children),je.return=$e,$e=je;break e}}else if(ir.elementType===qt||typeof qt=="object"&&qt!==null&&qt.$$typeof===P&&Vl(qt)===ir.type){o($e,ir.sibling),je=R(ir,Ze.props),je.ref=Ls($e,ir,Ze),je.return=$e,$e=je;break e}o($e,ir);break}else t($e,ir);ir=ir.sibling}Ze.type===q?(je=ss(Ze.props.children,$e.mode,Tt,Ze.key),je.return=$e,$e=je):(Tt=Io(Ze.type,Ze.key,Ze.props,null,$e.mode,Tt),Tt.ref=Ls($e,je,Ze),Tt.return=$e,$e=Tt)}return re($e);case G:e:{for(ir=Ze.key;je!==null;){if(je.key===ir)if(je.tag===4&&je.stateNode.containerInfo===Ze.containerInfo&&je.stateNode.implementation===Ze.implementation){o($e,je.sibling),je=R(je,Ze.children||[]),je.return=$e,$e=je;break e}else{o($e,je);break}else t($e,je);je=je.sibling}je=rl(Ze,$e.mode,Tt),je.return=$e,$e=je}return re($e);case P:return ir=Ze._init,mi($e,je,ir(Ze._payload),Tt)}if(xr(Ze))return $t($e,je,Ze,Tt);if(X(Ze))return Kt($e,je,Ze,Tt);uo($e,Ze)}return typeof Ze=="string"&&Ze!==""||typeof Ze=="number"?(Ze=""+Ze,je!==null&&je.tag===6?(o($e,je.sibling),je=R(je,Ze),je.return=$e,$e=je):(o($e,je),je=tl(Ze,$e.mode,Tt),je.return=$e,$e=je),re($e)):o($e,je)}return mi}var vs=jl(!0),Bl=jl(!1),co=zn(null),ho=null,ys=null,ha=null;function da(){ha=ys=ho=null}function fa(e){var t=co.current;Jr(co),e._currentValue=t}function pa(e,t,o){for(;e!==null;){var d=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,d!==null&&(d.childLanes|=t)):d!==null&&(d.childLanes&t)!==t&&(d.childLanes|=t),e===o)break;e=e.return}}function xs(e,t){ho=e,ha=ys=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Qi=!0),e.firstContext=null)}function un(e){var t=e._currentValue;if(ha!==e)if(e={context:e,memoizedValue:t,next:null},ys===null){if(ho===null)throw Error(a(308));ys=e,ho.dependencies={lanes:0,firstContext:e}}else ys=ys.next=e;return t}var Qn=null;function ma(e){Qn===null?Qn=[e]:Qn.push(e)}function Ul(e,t,o,d){var R=t.interleaved;return R===null?(o.next=o,ma(t)):(o.next=R.next,R.next=o),t.interleaved=o,Tn(e,d)}function Tn(e,t){e.lanes|=t;var o=e.alternate;for(o!==null&&(o.lanes|=t),o=e,e=e.return;e!==null;)e.childLanes|=t,o=e.alternate,o!==null&&(o.childLanes|=t),o=e,e=e.return;return o.tag===3?o.stateNode:null}var On=!1;function ga(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Mn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fn(e,t,o){var d=e.updateQueue;if(d===null)return null;if(d=d.shared,(Nr&2)!==0){var R=d.pending;return R===null?t.next=t:(t.next=R.next,R.next=t),d.pending=t,Tn(e,o)}return R=d.interleaved,R===null?(t.next=t,ma(d)):(t.next=R.next,R.next=t),d.interleaved=t,Tn(e,o)}function fo(e,t,o){if(t=t.updateQueue,t!==null&&(t=t.shared,(o&4194240)!==0)){var d=t.lanes;d&=e.pendingLanes,o|=d,t.lanes=o,S(e,o)}}function Hl(e,t){var o=e.updateQueue,d=e.alternate;if(d!==null&&(d=d.updateQueue,o===d)){var R=null,B=null;if(o=o.firstBaseUpdate,o!==null){do{var re={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};B===null?R=B=re:B=B.next=re,o=o.next}while(o!==null);B===null?R=B=t:B=B.next=t}else R=B=t;o={baseState:d.baseState,firstBaseUpdate:R,lastBaseUpdate:B,shared:d.shared,effects:d.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=t:e.next=t,o.lastBaseUpdate=t}function po(e,t,o,d){var R=e.updateQueue;On=!1;var B=R.firstBaseUpdate,re=R.lastBaseUpdate,Ee=R.shared.pending;if(Ee!==null){R.shared.pending=null;var Fe=Ee,qe=Fe.next;Fe.next=null,re===null?B=qe:re.next=qe,re=Fe;var xt=e.alternate;xt!==null&&(xt=xt.updateQueue,Ee=xt.lastBaseUpdate,Ee!==re&&(Ee===null?xt.firstBaseUpdate=qe:Ee.next=qe,xt.lastBaseUpdate=Fe))}if(B!==null){var wt=R.baseState;re=0,xt=qe=Fe=null,Ee=B;do{var vt=Ee.lane,jt=Ee.eventTime;if((d&vt)===vt){xt!==null&&(xt=xt.next={eventTime:jt,lane:0,tag:Ee.tag,payload:Ee.payload,callback:Ee.callback,next:null});e:{var $t=e,Kt=Ee;switch(vt=t,jt=o,Kt.tag){case 1:if($t=Kt.payload,typeof $t=="function"){wt=$t.call(jt,wt,vt);break e}wt=$t;break e;case 3:$t.flags=$t.flags&-65537|128;case 0:if($t=Kt.payload,vt=typeof $t=="function"?$t.call(jt,wt,vt):$t,vt==null)break e;wt=Re({},wt,vt);break e;case 2:On=!0}}Ee.callback!==null&&Ee.lane!==0&&(e.flags|=64,vt=R.effects,vt===null?R.effects=[Ee]:vt.push(Ee))}else jt={eventTime:jt,lane:vt,tag:Ee.tag,payload:Ee.payload,callback:Ee.callback,next:null},xt===null?(qe=xt=jt,Fe=wt):xt=xt.next=jt,re|=vt;if(Ee=Ee.next,Ee===null){if(Ee=R.shared.pending,Ee===null)break;vt=Ee,Ee=vt.next,vt.next=null,R.lastBaseUpdate=vt,R.shared.pending=null}}while(!0);if(xt===null&&(Fe=wt),R.baseState=Fe,R.firstBaseUpdate=qe,R.lastBaseUpdate=xt,t=R.shared.interleaved,t!==null){R=t;do re|=R.lane,R=R.next;while(R!==t)}else B===null&&(R.shared.lanes=0);ts|=re,e.lanes=re,e.memoizedState=wt}}function Wl(e,t,o){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var d=e[t],R=d.callback;if(R!==null){if(d.callback=null,d=o,typeof R!="function")throw Error(a(191,R));R.call(d)}}}var Os={},_n=zn(Os),Fs=zn(Os),Ns=zn(Os);function Jn(e){if(e===Os)throw Error(a(174));return e}function va(e,t){switch(qr(Ns,t),qr(Fs,e),qr(_n,Os),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pe(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=pe(t,e)}Jr(_n),qr(_n,t)}function _s(){Jr(_n),Jr(Fs),Jr(Ns)}function $l(e){Jn(Ns.current);var t=Jn(_n.current),o=pe(t,e.type);t!==o&&(qr(Fs,e),qr(_n,o))}function ya(e){Fs.current===e&&(Jr(_n),Jr(Fs))}var oi=zn(0);function mo(e){for(var t=e;t!==null;){if(t.tag===13){var o=t.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var xa=[];function _a(){for(var e=0;e<xa.length;e++)xa[e]._workInProgressVersionPrimary=null;xa.length=0}var go=F.ReactCurrentDispatcher,ba=F.ReactCurrentBatchConfig,es=0,ai=null,Si=null,ki=null,vo=!1,Vs=!1,js=0,kc=0;function Bi(){throw Error(a(321))}function wa(e,t){if(t===null)return!1;for(var o=0;o<t.length&&o<e.length;o++)if(!fn(e[o],t[o]))return!1;return!0}function Sa(e,t,o,d,R,B){if(es=B,ai=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,go.current=e===null||e.memoizedState===null?zc:Ic,e=o(d,R),Vs){B=0;do{if(Vs=!1,js=0,25<=B)throw Error(a(301));B+=1,ki=Si=null,t.updateQueue=null,go.current=Lc,e=o(d,R)}while(Vs)}if(go.current=_o,t=Si!==null&&Si.next!==null,es=0,ki=Si=ai=null,vo=!1,t)throw Error(a(300));return e}function Aa(){var e=js!==0;return js=0,e}function bn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ki===null?ai.memoizedState=ki=e:ki=ki.next=e,ki}function cn(){if(Si===null){var e=ai.alternate;e=e!==null?e.memoizedState:null}else e=Si.next;var t=ki===null?ai.memoizedState:ki.next;if(t!==null)ki=t,Si=e;else{if(e===null)throw Error(a(310));Si=e,e={memoizedState:Si.memoizedState,baseState:Si.baseState,baseQueue:Si.baseQueue,queue:Si.queue,next:null},ki===null?ai.memoizedState=ki=e:ki=ki.next=e}return ki}function Bs(e,t){return typeof t=="function"?t(e):t}function Ca(e){var t=cn(),o=t.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=e;var d=Si,R=d.baseQueue,B=o.pending;if(B!==null){if(R!==null){var re=R.next;R.next=B.next,B.next=re}d.baseQueue=R=B,o.pending=null}if(R!==null){B=R.next,d=d.baseState;var Ee=re=null,Fe=null,qe=B;do{var xt=qe.lane;if((es&xt)===xt)Fe!==null&&(Fe=Fe.next={lane:0,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null}),d=qe.hasEagerState?qe.eagerState:e(d,qe.action);else{var wt={lane:xt,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null};Fe===null?(Ee=Fe=wt,re=d):Fe=Fe.next=wt,ai.lanes|=xt,ts|=xt}qe=qe.next}while(qe!==null&&qe!==B);Fe===null?re=d:Fe.next=Ee,fn(d,t.memoizedState)||(Qi=!0),t.memoizedState=d,t.baseState=re,t.baseQueue=Fe,o.lastRenderedState=d}if(e=o.interleaved,e!==null){R=e;do B=R.lane,ai.lanes|=B,ts|=B,R=R.next;while(R!==e)}else R===null&&(o.lanes=0);return[t.memoizedState,o.dispatch]}function Ea(e){var t=cn(),o=t.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=e;var d=o.dispatch,R=o.pending,B=t.memoizedState;if(R!==null){o.pending=null;var re=R=R.next;do B=e(B,re.action),re=re.next;while(re!==R);fn(B,t.memoizedState)||(Qi=!0),t.memoizedState=B,t.baseQueue===null&&(t.baseState=B),o.lastRenderedState=B}return[B,d]}function Xl(){}function Kl(e,t){var o=ai,d=cn(),R=t(),B=!fn(d.memoizedState,R);if(B&&(d.memoizedState=R,Qi=!0),d=d.queue,Ta(Yl.bind(null,o,d,e),[e]),d.getSnapshot!==t||B||ki!==null&&ki.memoizedState.tag&1){if(o.flags|=2048,Us(9,ql.bind(null,o,d,R,t),void 0,null),Ri===null)throw Error(a(349));(es&30)!==0||Zl(o,t,R)}return R}function Zl(e,t,o){e.flags|=16384,e={getSnapshot:t,value:o},t=ai.updateQueue,t===null?(t={lastEffect:null,stores:null},ai.updateQueue=t,t.stores=[e]):(o=t.stores,o===null?t.stores=[e]:o.push(e))}function ql(e,t,o,d){t.value=o,t.getSnapshot=d,Ql(t)&&Jl(e)}function Yl(e,t,o){return o(function(){Ql(t)&&Jl(e)})}function Ql(e){var t=e.getSnapshot;e=e.value;try{var o=t();return!fn(e,o)}catch{return!0}}function Jl(e){var t=Tn(e,1);t!==null&&yn(t,e,1,-1)}function eu(e){var t=bn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bs,lastRenderedState:e},t.queue=e,e=e.dispatch=Dc.bind(null,ai,e),[t.memoizedState,e]}function Us(e,t,o,d){return e={tag:e,create:t,destroy:o,deps:d,next:null},t=ai.updateQueue,t===null?(t={lastEffect:null,stores:null},ai.updateQueue=t,t.lastEffect=e.next=e):(o=t.lastEffect,o===null?t.lastEffect=e.next=e:(d=o.next,o.next=e,e.next=d,t.lastEffect=e)),e}function tu(){return cn().memoizedState}function yo(e,t,o,d){var R=bn();ai.flags|=e,R.memoizedState=Us(1|t,o,void 0,d===void 0?null:d)}function xo(e,t,o,d){var R=cn();d=d===void 0?null:d;var B=void 0;if(Si!==null){var re=Si.memoizedState;if(B=re.destroy,d!==null&&wa(d,re.deps)){R.memoizedState=Us(t,o,B,d);return}}ai.flags|=e,R.memoizedState=Us(1|t,o,B,d)}function ru(e,t){return yo(8390656,8,e,t)}function Ta(e,t){return xo(2048,8,e,t)}function iu(e,t){return xo(4,2,e,t)}function nu(e,t){return xo(4,4,e,t)}function su(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ou(e,t,o){return o=o!=null?o.concat([e]):null,xo(4,4,su.bind(null,t,e),o)}function Ma(){}function au(e,t){var o=cn();t=t===void 0?null:t;var d=o.memoizedState;return d!==null&&t!==null&&wa(t,d[1])?d[0]:(o.memoizedState=[e,t],e)}function lu(e,t){var o=cn();t=t===void 0?null:t;var d=o.memoizedState;return d!==null&&t!==null&&wa(t,d[1])?d[0]:(e=e(),o.memoizedState=[e,t],e)}function uu(e,t,o){return(es&21)===0?(e.baseState&&(e.baseState=!1,Qi=!0),e.memoizedState=o):(fn(o,t)||(o=A(),ai.lanes|=o,ts|=o,e.baseState=!0),t)}function Rc(e,t){var o=k;k=o!==0&&4>o?o:4,e(!0);var d=ba.transition;ba.transition={};try{e(!1),t()}finally{k=o,ba.transition=d}}function cu(){return cn().memoizedState}function Pc(e,t,o){var d=Bn(e);if(o={lane:d,action:o,hasEagerState:!1,eagerState:null,next:null},hu(e))du(t,o);else if(o=Ul(e,t,o,d),o!==null){var R=Xi();yn(o,e,d,R),fu(o,t,d)}}function Dc(e,t,o){var d=Bn(e),R={lane:d,action:o,hasEagerState:!1,eagerState:null,next:null};if(hu(e))du(t,R);else{var B=e.alternate;if(e.lanes===0&&(B===null||B.lanes===0)&&(B=t.lastRenderedReducer,B!==null))try{var re=t.lastRenderedState,Ee=B(re,o);if(R.hasEagerState=!0,R.eagerState=Ee,fn(Ee,re)){var Fe=t.interleaved;Fe===null?(R.next=R,ma(t)):(R.next=Fe.next,Fe.next=R),t.interleaved=R;return}}catch{}finally{}o=Ul(e,t,R,d),o!==null&&(R=Xi(),yn(o,e,d,R),fu(o,t,d))}}function hu(e){var t=e.alternate;return e===ai||t!==null&&t===ai}function du(e,t){Vs=vo=!0;var o=e.pending;o===null?t.next=t:(t.next=o.next,o.next=t),e.pending=t}function fu(e,t,o){if((o&4194240)!==0){var d=t.lanes;d&=e.pendingLanes,o|=d,t.lanes=o,S(e,o)}}var _o={readContext:un,useCallback:Bi,useContext:Bi,useEffect:Bi,useImperativeHandle:Bi,useInsertionEffect:Bi,useLayoutEffect:Bi,useMemo:Bi,useReducer:Bi,useRef:Bi,useState:Bi,useDebugValue:Bi,useDeferredValue:Bi,useTransition:Bi,useMutableSource:Bi,useSyncExternalStore:Bi,useId:Bi,unstable_isNewReconciler:!1},zc={readContext:un,useCallback:function(e,t){return bn().memoizedState=[e,t===void 0?null:t],e},useContext:un,useEffect:ru,useImperativeHandle:function(e,t,o){return o=o!=null?o.concat([e]):null,yo(4194308,4,su.bind(null,t,e),o)},useLayoutEffect:function(e,t){return yo(4194308,4,e,t)},useInsertionEffect:function(e,t){return yo(4,2,e,t)},useMemo:function(e,t){var o=bn();return t=t===void 0?null:t,e=e(),o.memoizedState=[e,t],e},useReducer:function(e,t,o){var d=bn();return t=o!==void 0?o(t):t,d.memoizedState=d.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},d.queue=e,e=e.dispatch=Pc.bind(null,ai,e),[d.memoizedState,e]},useRef:function(e){var t=bn();return e={current:e},t.memoizedState=e},useState:eu,useDebugValue:Ma,useDeferredValue:function(e){return bn().memoizedState=e},useTransition:function(){var e=eu(!1),t=e[0];return e=Rc.bind(null,e[1]),bn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,o){var d=ai,R=bn();if(ti){if(o===void 0)throw Error(a(407));o=o()}else{if(o=t(),Ri===null)throw Error(a(349));(es&30)!==0||Zl(d,t,o)}R.memoizedState=o;var B={value:o,getSnapshot:t};return R.queue=B,ru(Yl.bind(null,d,B,e),[e]),d.flags|=2048,Us(9,ql.bind(null,d,B,o,t),void 0,null),o},useId:function(){var e=bn(),t=Ri.identifierPrefix;if(ti){var o=En,d=Cn;o=(d&~(1<<32-_r(d)-1)).toString(32)+o,t=":"+t+"R"+o,o=js++,0<o&&(t+="H"+o.toString(32)),t+=":"}else o=kc++,t=":"+t+"r"+o.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ic={readContext:un,useCallback:au,useContext:un,useEffect:Ta,useImperativeHandle:ou,useInsertionEffect:iu,useLayoutEffect:nu,useMemo:lu,useReducer:Ca,useRef:tu,useState:function(){return Ca(Bs)},useDebugValue:Ma,useDeferredValue:function(e){var t=cn();return uu(t,Si.memoizedState,e)},useTransition:function(){var e=Ca(Bs)[0],t=cn().memoizedState;return[e,t]},useMutableSource:Xl,useSyncExternalStore:Kl,useId:cu,unstable_isNewReconciler:!1},Lc={readContext:un,useCallback:au,useContext:un,useEffect:Ta,useImperativeHandle:ou,useInsertionEffect:iu,useLayoutEffect:nu,useMemo:lu,useReducer:Ea,useRef:tu,useState:function(){return Ea(Bs)},useDebugValue:Ma,useDeferredValue:function(e){var t=cn();return Si===null?t.memoizedState=e:uu(t,Si.memoizedState,e)},useTransition:function(){var e=Ea(Bs)[0],t=cn().memoizedState;return[e,t]},useMutableSource:Xl,useSyncExternalStore:Kl,useId:cu,unstable_isNewReconciler:!1};function mn(e,t){if(e&&e.defaultProps){t=Re({},t),e=e.defaultProps;for(var o in e)t[o]===void 0&&(t[o]=e[o]);return t}return t}function ka(e,t,o,d){t=e.memoizedState,o=o(d,t),o=o==null?t:Re({},t,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var bo={isMounted:function(e){return(e=e._reactInternals)?Gr(e)===e:!1},enqueueSetState:function(e,t,o){e=e._reactInternals;var d=Xi(),R=Bn(e),B=Mn(d,R);B.payload=t,o!=null&&(B.callback=o),t=Fn(e,B,R),t!==null&&(yn(t,e,R,d),fo(t,e,R))},enqueueReplaceState:function(e,t,o){e=e._reactInternals;var d=Xi(),R=Bn(e),B=Mn(d,R);B.tag=1,B.payload=t,o!=null&&(B.callback=o),t=Fn(e,B,R),t!==null&&(yn(t,e,R,d),fo(t,e,R))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var o=Xi(),d=Bn(e),R=Mn(o,d);R.tag=2,t!=null&&(R.callback=t),t=Fn(e,R,d),t!==null&&(yn(t,e,d,o),fo(t,e,d))}};function pu(e,t,o,d,R,B,re){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(d,B,re):t.prototype&&t.prototype.isPureReactComponent?!Ms(o,d)||!Ms(R,B):!0}function mu(e,t,o){var d=!1,R=In,B=t.contextType;return typeof B=="object"&&B!==null?B=un(B):(R=Yi(t)?Zn:ji.current,d=t.contextTypes,B=(d=d!=null)?fs(e,R):In),t=new t(o,B),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=bo,e.stateNode=t,t._reactInternals=e,d&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=R,e.__reactInternalMemoizedMaskedChildContext=B),t}function gu(e,t,o,d){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(o,d),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(o,d),t.state!==e&&bo.enqueueReplaceState(t,t.state,null)}function Ra(e,t,o,d){var R=e.stateNode;R.props=o,R.state=e.memoizedState,R.refs={},ga(e);var B=t.contextType;typeof B=="object"&&B!==null?R.context=un(B):(B=Yi(t)?Zn:ji.current,R.context=fs(e,B)),R.state=e.memoizedState,B=t.getDerivedStateFromProps,typeof B=="function"&&(ka(e,t,B,o),R.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(t=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),t!==R.state&&bo.enqueueReplaceState(R,R.state,null),po(e,o,R,d),R.state=e.memoizedState),typeof R.componentDidMount=="function"&&(e.flags|=4194308)}function bs(e,t){try{var o="",d=t;do o+=Ae(d),d=d.return;while(d);var R=o}catch(B){R=`
Error generating stack: `+B.message+`
`+B.stack}return{value:e,source:t,stack:R,digest:null}}function Pa(e,t,o){return{value:e,source:null,stack:o??null,digest:t??null}}function Da(e,t){try{console.error(t.value)}catch(o){setTimeout(function(){throw o})}}var Oc=typeof WeakMap=="function"?WeakMap:Map;function vu(e,t,o){o=Mn(-1,o),o.tag=3,o.payload={element:null};var d=t.value;return o.callback=function(){Mo||(Mo=!0,Xa=d),Da(e,t)},o}function yu(e,t,o){o=Mn(-1,o),o.tag=3;var d=e.type.getDerivedStateFromError;if(typeof d=="function"){var R=t.value;o.payload=function(){return d(R)},o.callback=function(){Da(e,t)}}var B=e.stateNode;return B!==null&&typeof B.componentDidCatch=="function"&&(o.callback=function(){Da(e,t),typeof d!="function"&&(Vn===null?Vn=new Set([this]):Vn.add(this));var re=t.stack;this.componentDidCatch(t.value,{componentStack:re!==null?re:""})}),o}function xu(e,t,o){var d=e.pingCache;if(d===null){d=e.pingCache=new Oc;var R=new Set;d.set(t,R)}else R=d.get(t),R===void 0&&(R=new Set,d.set(t,R));R.has(o)||(R.add(o),e=qc.bind(null,e,t,o),t.then(e,e))}function _u(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function bu(e,t,o,d,R){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(t=Mn(-1,1),t.tag=2,Fn(o,t,1))),o.lanes|=1),e):(e.flags|=65536,e.lanes=R,e)}var Fc=F.ReactCurrentOwner,Qi=!1;function $i(e,t,o,d){t.child=e===null?Bl(t,null,o,d):vs(t,e.child,o,d)}function wu(e,t,o,d,R){o=o.render;var B=t.ref;return xs(t,R),d=Sa(e,t,o,d,B,R),o=Aa(),e!==null&&!Qi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~R,kn(e,t,R)):(ti&&o&&oa(t),t.flags|=1,$i(e,t,d,R),t.child)}function Su(e,t,o,d,R){if(e===null){var B=o.type;return typeof B=="function"&&!el(B)&&B.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(t.tag=15,t.type=B,Au(e,t,B,d,R)):(e=Io(o.type,null,d,t,t.mode,R),e.ref=t.ref,e.return=t,t.child=e)}if(B=e.child,(e.lanes&R)===0){var re=B.memoizedProps;if(o=o.compare,o=o!==null?o:Ms,o(re,d)&&e.ref===t.ref)return kn(e,t,R)}return t.flags|=1,e=Gn(B,d),e.ref=t.ref,e.return=t,t.child=e}function Au(e,t,o,d,R){if(e!==null){var B=e.memoizedProps;if(Ms(B,d)&&e.ref===t.ref)if(Qi=!1,t.pendingProps=d=B,(e.lanes&R)!==0)(e.flags&131072)!==0&&(Qi=!0);else return t.lanes=e.lanes,kn(e,t,R)}return za(e,t,o,d,R)}function Cu(e,t,o){var d=t.pendingProps,R=d.children,B=e!==null?e.memoizedState:null;if(d.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},qr(Ss,sn),sn|=o;else{if((o&1073741824)===0)return e=B!==null?B.baseLanes|o:o,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,qr(Ss,sn),sn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=B!==null?B.baseLanes:o,qr(Ss,sn),sn|=d}else B!==null?(d=B.baseLanes|o,t.memoizedState=null):d=o,qr(Ss,sn),sn|=d;return $i(e,t,R,o),t.child}function Eu(e,t){var o=t.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(t.flags|=512,t.flags|=2097152)}function za(e,t,o,d,R){var B=Yi(o)?Zn:ji.current;return B=fs(t,B),xs(t,R),o=Sa(e,t,o,d,B,R),d=Aa(),e!==null&&!Qi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~R,kn(e,t,R)):(ti&&d&&oa(t),t.flags|=1,$i(e,t,o,R),t.child)}function Tu(e,t,o,d,R){if(Yi(o)){var B=!0;no(t)}else B=!1;if(xs(t,R),t.stateNode===null)So(e,t),mu(t,o,d),Ra(t,o,d,R),d=!0;else if(e===null){var re=t.stateNode,Ee=t.memoizedProps;re.props=Ee;var Fe=re.context,qe=o.contextType;typeof qe=="object"&&qe!==null?qe=un(qe):(qe=Yi(o)?Zn:ji.current,qe=fs(t,qe));var xt=o.getDerivedStateFromProps,wt=typeof xt=="function"||typeof re.getSnapshotBeforeUpdate=="function";wt||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(Ee!==d||Fe!==qe)&&gu(t,re,d,qe),On=!1;var vt=t.memoizedState;re.state=vt,po(t,d,re,R),Fe=t.memoizedState,Ee!==d||vt!==Fe||qi.current||On?(typeof xt=="function"&&(ka(t,o,xt,d),Fe=t.memoizedState),(Ee=On||pu(t,o,Ee,d,vt,Fe,qe))?(wt||typeof re.UNSAFE_componentWillMount!="function"&&typeof re.componentWillMount!="function"||(typeof re.componentWillMount=="function"&&re.componentWillMount(),typeof re.UNSAFE_componentWillMount=="function"&&re.UNSAFE_componentWillMount()),typeof re.componentDidMount=="function"&&(t.flags|=4194308)):(typeof re.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=d,t.memoizedState=Fe),re.props=d,re.state=Fe,re.context=qe,d=Ee):(typeof re.componentDidMount=="function"&&(t.flags|=4194308),d=!1)}else{re=t.stateNode,Gl(e,t),Ee=t.memoizedProps,qe=t.type===t.elementType?Ee:mn(t.type,Ee),re.props=qe,wt=t.pendingProps,vt=re.context,Fe=o.contextType,typeof Fe=="object"&&Fe!==null?Fe=un(Fe):(Fe=Yi(o)?Zn:ji.current,Fe=fs(t,Fe));var jt=o.getDerivedStateFromProps;(xt=typeof jt=="function"||typeof re.getSnapshotBeforeUpdate=="function")||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(Ee!==wt||vt!==Fe)&&gu(t,re,d,Fe),On=!1,vt=t.memoizedState,re.state=vt,po(t,d,re,R);var $t=t.memoizedState;Ee!==wt||vt!==$t||qi.current||On?(typeof jt=="function"&&(ka(t,o,jt,d),$t=t.memoizedState),(qe=On||pu(t,o,qe,d,vt,$t,Fe)||!1)?(xt||typeof re.UNSAFE_componentWillUpdate!="function"&&typeof re.componentWillUpdate!="function"||(typeof re.componentWillUpdate=="function"&&re.componentWillUpdate(d,$t,Fe),typeof re.UNSAFE_componentWillUpdate=="function"&&re.UNSAFE_componentWillUpdate(d,$t,Fe)),typeof re.componentDidUpdate=="function"&&(t.flags|=4),typeof re.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof re.componentDidUpdate!="function"||Ee===e.memoizedProps&&vt===e.memoizedState||(t.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||Ee===e.memoizedProps&&vt===e.memoizedState||(t.flags|=1024),t.memoizedProps=d,t.memoizedState=$t),re.props=d,re.state=$t,re.context=Fe,d=qe):(typeof re.componentDidUpdate!="function"||Ee===e.memoizedProps&&vt===e.memoizedState||(t.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||Ee===e.memoizedProps&&vt===e.memoizedState||(t.flags|=1024),d=!1)}return Ia(e,t,o,d,B,R)}function Ia(e,t,o,d,R,B){Eu(e,t);var re=(t.flags&128)!==0;if(!d&&!re)return R&&Dl(t,o,!1),kn(e,t,B);d=t.stateNode,Fc.current=t;var Ee=re&&typeof o.getDerivedStateFromError!="function"?null:d.render();return t.flags|=1,e!==null&&re?(t.child=vs(t,e.child,null,B),t.child=vs(t,null,Ee,B)):$i(e,t,Ee,B),t.memoizedState=d.state,R&&Dl(t,o,!0),t.child}function Mu(e){var t=e.stateNode;t.pendingContext?Rl(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Rl(e,t.context,!1),va(e,t.containerInfo)}function ku(e,t,o,d,R){return gs(),ca(R),t.flags|=256,$i(e,t,o,d),t.child}var La={dehydrated:null,treeContext:null,retryLane:0};function Oa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ru(e,t,o){var d=t.pendingProps,R=oi.current,B=!1,re=(t.flags&128)!==0,Ee;if((Ee=re)||(Ee=e!==null&&e.memoizedState===null?!1:(R&2)!==0),Ee?(B=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(R|=1),qr(oi,R&1),e===null)return ua(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(re=d.children,e=d.fallback,B?(d=t.mode,B=t.child,re={mode:"hidden",children:re},(d&1)===0&&B!==null?(B.childLanes=0,B.pendingProps=re):B=Lo(re,d,0,null),e=ss(e,d,o,null),B.return=t,e.return=t,B.sibling=e,t.child=B,t.child.memoizedState=Oa(o),t.memoizedState=La,e):Fa(t,re));if(R=e.memoizedState,R!==null&&(Ee=R.dehydrated,Ee!==null))return Nc(e,t,re,d,Ee,R,o);if(B){B=d.fallback,re=t.mode,R=e.child,Ee=R.sibling;var Fe={mode:"hidden",children:d.children};return(re&1)===0&&t.child!==R?(d=t.child,d.childLanes=0,d.pendingProps=Fe,t.deletions=null):(d=Gn(R,Fe),d.subtreeFlags=R.subtreeFlags&14680064),Ee!==null?B=Gn(Ee,B):(B=ss(B,re,o,null),B.flags|=2),B.return=t,d.return=t,d.sibling=B,t.child=d,d=B,B=t.child,re=e.child.memoizedState,re=re===null?Oa(o):{baseLanes:re.baseLanes|o,cachePool:null,transitions:re.transitions},B.memoizedState=re,B.childLanes=e.childLanes&~o,t.memoizedState=La,d}return B=e.child,e=B.sibling,d=Gn(B,{mode:"visible",children:d.children}),(t.mode&1)===0&&(d.lanes=o),d.return=t,d.sibling=null,e!==null&&(o=t.deletions,o===null?(t.deletions=[e],t.flags|=16):o.push(e)),t.child=d,t.memoizedState=null,d}function Fa(e,t){return t=Lo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function wo(e,t,o,d){return d!==null&&ca(d),vs(t,e.child,null,o),e=Fa(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Nc(e,t,o,d,R,B,re){if(o)return t.flags&256?(t.flags&=-257,d=Pa(Error(a(422))),wo(e,t,re,d)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(B=d.fallback,R=t.mode,d=Lo({mode:"visible",children:d.children},R,0,null),B=ss(B,R,re,null),B.flags|=2,d.return=t,B.return=t,d.sibling=B,t.child=d,(t.mode&1)!==0&&vs(t,e.child,null,re),t.child.memoizedState=Oa(re),t.memoizedState=La,B);if((t.mode&1)===0)return wo(e,t,re,null);if(R.data==="$!"){if(d=R.nextSibling&&R.nextSibling.dataset,d)var Ee=d.dgst;return d=Ee,B=Error(a(419)),d=Pa(B,d,void 0),wo(e,t,re,d)}if(Ee=(re&e.childLanes)!==0,Qi||Ee){if(d=Ri,d!==null){switch(re&-re){case 4:R=2;break;case 16:R=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:R=32;break;case 536870912:R=268435456;break;default:R=0}R=(R&(d.suspendedLanes|re))!==0?0:R,R!==0&&R!==B.retryLane&&(B.retryLane=R,Tn(e,R),yn(d,e,R,-1))}return Ja(),d=Pa(Error(a(421))),wo(e,t,re,d)}return R.data==="$?"?(t.flags|=128,t.child=e.child,t=Yc.bind(null,e),R._reactRetry=t,null):(e=B.treeContext,nn=Dn(R.nextSibling),rn=t,ti=!0,pn=null,e!==null&&(an[ln++]=Cn,an[ln++]=En,an[ln++]=qn,Cn=e.id,En=e.overflow,qn=t),t=Fa(t,d.children),t.flags|=4096,t)}function Pu(e,t,o){e.lanes|=t;var d=e.alternate;d!==null&&(d.lanes|=t),pa(e.return,t,o)}function Na(e,t,o,d,R){var B=e.memoizedState;B===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:d,tail:o,tailMode:R}:(B.isBackwards=t,B.rendering=null,B.renderingStartTime=0,B.last=d,B.tail=o,B.tailMode=R)}function Du(e,t,o){var d=t.pendingProps,R=d.revealOrder,B=d.tail;if($i(e,t,d.children,o),d=oi.current,(d&2)!==0)d=d&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Pu(e,o,t);else if(e.tag===19)Pu(e,o,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}d&=1}if(qr(oi,d),(t.mode&1)===0)t.memoizedState=null;else switch(R){case"forwards":for(o=t.child,R=null;o!==null;)e=o.alternate,e!==null&&mo(e)===null&&(R=o),o=o.sibling;o=R,o===null?(R=t.child,t.child=null):(R=o.sibling,o.sibling=null),Na(t,!1,R,o,B);break;case"backwards":for(o=null,R=t.child,t.child=null;R!==null;){if(e=R.alternate,e!==null&&mo(e)===null){t.child=R;break}e=R.sibling,R.sibling=o,o=R,R=e}Na(t,!0,o,null,B);break;case"together":Na(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function So(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function kn(e,t,o){if(e!==null&&(t.dependencies=e.dependencies),ts|=t.lanes,(o&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(a(153));if(t.child!==null){for(e=t.child,o=Gn(e,e.pendingProps),t.child=o,o.return=t;e.sibling!==null;)e=e.sibling,o=o.sibling=Gn(e,e.pendingProps),o.return=t;o.sibling=null}return t.child}function Vc(e,t,o){switch(t.tag){case 3:Mu(t),gs();break;case 5:$l(t);break;case 1:Yi(t.type)&&no(t);break;case 4:va(t,t.stateNode.containerInfo);break;case 10:var d=t.type._context,R=t.memoizedProps.value;qr(co,d._currentValue),d._currentValue=R;break;case 13:if(d=t.memoizedState,d!==null)return d.dehydrated!==null?(qr(oi,oi.current&1),t.flags|=128,null):(o&t.child.childLanes)!==0?Ru(e,t,o):(qr(oi,oi.current&1),e=kn(e,t,o),e!==null?e.sibling:null);qr(oi,oi.current&1);break;case 19:if(d=(o&t.childLanes)!==0,(e.flags&128)!==0){if(d)return Du(e,t,o);t.flags|=128}if(R=t.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),qr(oi,oi.current),d)break;return null;case 22:case 23:return t.lanes=0,Cu(e,t,o)}return kn(e,t,o)}var zu,Va,Iu,Lu;zu=function(e,t){for(var o=t.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===t)break;for(;o.sibling===null;){if(o.return===null||o.return===t)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},Va=function(){},Iu=function(e,t,o,d){var R=e.memoizedProps;if(R!==d){e=t.stateNode,Jn(_n.current);var B=null;switch(o){case"input":R=or(e,R),d=or(e,d),B=[];break;case"select":R=Re({},R,{value:void 0}),d=Re({},d,{value:void 0}),B=[];break;case"textarea":R=Rr(e,R),d=Rr(e,d),B=[];break;default:typeof R.onClick!="function"&&typeof d.onClick=="function"&&(e.onclick=to)}It(o,d);var re;o=null;for(qe in R)if(!d.hasOwnProperty(qe)&&R.hasOwnProperty(qe)&&R[qe]!=null)if(qe==="style"){var Ee=R[qe];for(re in Ee)Ee.hasOwnProperty(re)&&(o||(o={}),o[re]="")}else qe!=="dangerouslySetInnerHTML"&&qe!=="children"&&qe!=="suppressContentEditableWarning"&&qe!=="suppressHydrationWarning"&&qe!=="autoFocus"&&(m.hasOwnProperty(qe)?B||(B=[]):(B=B||[]).push(qe,null));for(qe in d){var Fe=d[qe];if(Ee=R?.[qe],d.hasOwnProperty(qe)&&Fe!==Ee&&(Fe!=null||Ee!=null))if(qe==="style")if(Ee){for(re in Ee)!Ee.hasOwnProperty(re)||Fe&&Fe.hasOwnProperty(re)||(o||(o={}),o[re]="");for(re in Fe)Fe.hasOwnProperty(re)&&Ee[re]!==Fe[re]&&(o||(o={}),o[re]=Fe[re])}else o||(B||(B=[]),B.push(qe,o)),o=Fe;else qe==="dangerouslySetInnerHTML"?(Fe=Fe?Fe.__html:void 0,Ee=Ee?Ee.__html:void 0,Fe!=null&&Ee!==Fe&&(B=B||[]).push(qe,Fe)):qe==="children"?typeof Fe!="string"&&typeof Fe!="number"||(B=B||[]).push(qe,""+Fe):qe!=="suppressContentEditableWarning"&&qe!=="suppressHydrationWarning"&&(m.hasOwnProperty(qe)?(Fe!=null&&qe==="onScroll"&&Qr("scroll",e),B||Ee===Fe||(B=[])):(B=B||[]).push(qe,Fe))}o&&(B=B||[]).push("style",o);var qe=B;(t.updateQueue=qe)&&(t.flags|=4)}},Lu=function(e,t,o,d){o!==d&&(t.flags|=4)};function Gs(e,t){if(!ti)switch(e.tailMode){case"hidden":t=e.tail;for(var o=null;t!==null;)t.alternate!==null&&(o=t),t=t.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:d.sibling=null}}function Ui(e){var t=e.alternate!==null&&e.alternate.child===e.child,o=0,d=0;if(t)for(var R=e.child;R!==null;)o|=R.lanes|R.childLanes,d|=R.subtreeFlags&14680064,d|=R.flags&14680064,R.return=e,R=R.sibling;else for(R=e.child;R!==null;)o|=R.lanes|R.childLanes,d|=R.subtreeFlags,d|=R.flags,R.return=e,R=R.sibling;return e.subtreeFlags|=d,e.childLanes=o,t}function jc(e,t,o){var d=t.pendingProps;switch(aa(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ui(t),null;case 1:return Yi(t.type)&&io(),Ui(t),null;case 3:return d=t.stateNode,_s(),Jr(qi),Jr(ji),_a(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(e===null||e.child===null)&&(lo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,pn!==null&&(qa(pn),pn=null))),Va(e,t),Ui(t),null;case 5:ya(t);var R=Jn(Ns.current);if(o=t.type,e!==null&&t.stateNode!=null)Iu(e,t,o,d,R),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!d){if(t.stateNode===null)throw Error(a(166));return Ui(t),null}if(e=Jn(_n.current),lo(t)){d=t.stateNode,o=t.type;var B=t.memoizedProps;switch(d[xn]=t,d[zs]=B,e=(t.mode&1)!==0,o){case"dialog":Qr("cancel",d),Qr("close",d);break;case"iframe":case"object":case"embed":Qr("load",d);break;case"video":case"audio":for(R=0;R<Rs.length;R++)Qr(Rs[R],d);break;case"source":Qr("error",d);break;case"img":case"image":case"link":Qr("error",d),Qr("load",d);break;case"details":Qr("toggle",d);break;case"input":ar(d,B),Qr("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!B.multiple},Qr("invalid",d);break;case"textarea":Ir(d,B),Qr("invalid",d)}It(o,B),R=null;for(var re in B)if(B.hasOwnProperty(re)){var Ee=B[re];re==="children"?typeof Ee=="string"?d.textContent!==Ee&&(B.suppressHydrationWarning!==!0&&eo(d.textContent,Ee,e),R=["children",Ee]):typeof Ee=="number"&&d.textContent!==""+Ee&&(B.suppressHydrationWarning!==!0&&eo(d.textContent,Ee,e),R=["children",""+Ee]):m.hasOwnProperty(re)&&Ee!=null&&re==="onScroll"&&Qr("scroll",d)}switch(o){case"input":at(d),pr(d,B,!0);break;case"textarea":at(d),bi(d);break;case"select":case"option":break;default:typeof B.onClick=="function"&&(d.onclick=to)}d=R,t.updateQueue=d,d!==null&&(t.flags|=4)}else{re=R.nodeType===9?R:R.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Hi(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=re.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof d.is=="string"?e=re.createElement(o,{is:d.is}):(e=re.createElement(o),o==="select"&&(re=e,d.multiple?re.multiple=!0:d.size&&(re.size=d.size))):e=re.createElementNS(e,o),e[xn]=t,e[zs]=d,zu(e,t,!1,!1),t.stateNode=e;e:{switch(re=mr(o,d),o){case"dialog":Qr("cancel",e),Qr("close",e),R=d;break;case"iframe":case"object":case"embed":Qr("load",e),R=d;break;case"video":case"audio":for(R=0;R<Rs.length;R++)Qr(Rs[R],e);R=d;break;case"source":Qr("error",e),R=d;break;case"img":case"image":case"link":Qr("error",e),Qr("load",e),R=d;break;case"details":Qr("toggle",e),R=d;break;case"input":ar(e,d),R=or(e,d),Qr("invalid",e);break;case"option":R=d;break;case"select":e._wrapperState={wasMultiple:!!d.multiple},R=Re({},d,{value:void 0}),Qr("invalid",e);break;case"textarea":Ir(e,d),R=Rr(e,d),Qr("invalid",e);break;default:R=d}It(o,R),Ee=R;for(B in Ee)if(Ee.hasOwnProperty(B)){var Fe=Ee[B];B==="style"?Lt(e,Fe):B==="dangerouslySetInnerHTML"?(Fe=Fe?Fe.__html:void 0,Fe!=null&&Le(e,Fe)):B==="children"?typeof Fe=="string"?(o!=="textarea"||Fe!=="")&&dt(e,Fe):typeof Fe=="number"&&dt(e,""+Fe):B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&B!=="autoFocus"&&(m.hasOwnProperty(B)?Fe!=null&&B==="onScroll"&&Qr("scroll",e):Fe!=null&&_(e,B,Fe,re))}switch(o){case"input":at(e),pr(e,d,!1);break;case"textarea":at(e),bi(e);break;case"option":d.value!=null&&e.setAttribute("value",""+Ie(d.value));break;case"select":e.multiple=!!d.multiple,B=d.value,B!=null?fi(e,!!d.multiple,B,!1):d.defaultValue!=null&&fi(e,!!d.multiple,d.defaultValue,!0);break;default:typeof R.onClick=="function"&&(e.onclick=to)}switch(o){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ui(t),null;case 6:if(e&&t.stateNode!=null)Lu(e,t,e.memoizedProps,d);else{if(typeof d!="string"&&t.stateNode===null)throw Error(a(166));if(o=Jn(Ns.current),Jn(_n.current),lo(t)){if(d=t.stateNode,o=t.memoizedProps,d[xn]=t,(B=d.nodeValue!==o)&&(e=rn,e!==null))switch(e.tag){case 3:eo(d.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&eo(d.nodeValue,o,(e.mode&1)!==0)}B&&(t.flags|=4)}else d=(o.nodeType===9?o:o.ownerDocument).createTextNode(d),d[xn]=t,t.stateNode=d}return Ui(t),null;case 13:if(Jr(oi),d=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ti&&nn!==null&&(t.mode&1)!==0&&(t.flags&128)===0)Nl(),gs(),t.flags|=98560,B=!1;else if(B=lo(t),d!==null&&d.dehydrated!==null){if(e===null){if(!B)throw Error(a(318));if(B=t.memoizedState,B=B!==null?B.dehydrated:null,!B)throw Error(a(317));B[xn]=t}else gs(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Ui(t),B=!1}else pn!==null&&(qa(pn),pn=null),B=!0;if(!B)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=o,t):(d=d!==null,d!==(e!==null&&e.memoizedState!==null)&&d&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(oi.current&1)!==0?Ai===0&&(Ai=3):Ja())),t.updateQueue!==null&&(t.flags|=4),Ui(t),null);case 4:return _s(),Va(e,t),e===null&&Ps(t.stateNode.containerInfo),Ui(t),null;case 10:return fa(t.type._context),Ui(t),null;case 17:return Yi(t.type)&&io(),Ui(t),null;case 19:if(Jr(oi),B=t.memoizedState,B===null)return Ui(t),null;if(d=(t.flags&128)!==0,re=B.rendering,re===null)if(d)Gs(B,!1);else{if(Ai!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(re=mo(e),re!==null){for(t.flags|=128,Gs(B,!1),d=re.updateQueue,d!==null&&(t.updateQueue=d,t.flags|=4),t.subtreeFlags=0,d=o,o=t.child;o!==null;)B=o,e=d,B.flags&=14680066,re=B.alternate,re===null?(B.childLanes=0,B.lanes=e,B.child=null,B.subtreeFlags=0,B.memoizedProps=null,B.memoizedState=null,B.updateQueue=null,B.dependencies=null,B.stateNode=null):(B.childLanes=re.childLanes,B.lanes=re.lanes,B.child=re.child,B.subtreeFlags=0,B.deletions=null,B.memoizedProps=re.memoizedProps,B.memoizedState=re.memoizedState,B.updateQueue=re.updateQueue,B.type=re.type,e=re.dependencies,B.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return qr(oi,oi.current&1|2),t.child}e=e.sibling}B.tail!==null&&lt()>As&&(t.flags|=128,d=!0,Gs(B,!1),t.lanes=4194304)}else{if(!d)if(e=mo(re),e!==null){if(t.flags|=128,d=!0,o=e.updateQueue,o!==null&&(t.updateQueue=o,t.flags|=4),Gs(B,!0),B.tail===null&&B.tailMode==="hidden"&&!re.alternate&&!ti)return Ui(t),null}else 2*lt()-B.renderingStartTime>As&&o!==1073741824&&(t.flags|=128,d=!0,Gs(B,!1),t.lanes=4194304);B.isBackwards?(re.sibling=t.child,t.child=re):(o=B.last,o!==null?o.sibling=re:t.child=re,B.last=re)}return B.tail!==null?(t=B.tail,B.rendering=t,B.tail=t.sibling,B.renderingStartTime=lt(),t.sibling=null,o=oi.current,qr(oi,d?o&1|2:o&1),t):(Ui(t),null);case 22:case 23:return Qa(),d=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==d&&(t.flags|=8192),d&&(t.mode&1)!==0?(sn&1073741824)!==0&&(Ui(t),t.subtreeFlags&6&&(t.flags|=8192)):Ui(t),null;case 24:return null;case 25:return null}throw Error(a(156,t.tag))}function Bc(e,t){switch(aa(t),t.tag){case 1:return Yi(t.type)&&io(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _s(),Jr(qi),Jr(ji),_a(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return ya(t),null;case 13:if(Jr(oi),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(a(340));gs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Jr(oi),null;case 4:return _s(),null;case 10:return fa(t.type._context),null;case 22:case 23:return Qa(),null;case 24:return null;default:return null}}var Ao=!1,Gi=!1,Uc=typeof WeakSet=="function"?WeakSet:Set,Gt=null;function ws(e,t){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(d){di(e,t,d)}else o.current=null}function ja(e,t,o){try{o()}catch(d){di(e,t,d)}}var Ou=!1;function Gc(e,t){if(Qo=et,e=pl(),Ho(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var d=o.getSelection&&o.getSelection();if(d&&d.rangeCount!==0){o=d.anchorNode;var R=d.anchorOffset,B=d.focusNode;d=d.focusOffset;try{o.nodeType,B.nodeType}catch{o=null;break e}var re=0,Ee=-1,Fe=-1,qe=0,xt=0,wt=e,vt=null;t:for(;;){for(var jt;wt!==o||R!==0&&wt.nodeType!==3||(Ee=re+R),wt!==B||d!==0&&wt.nodeType!==3||(Fe=re+d),wt.nodeType===3&&(re+=wt.nodeValue.length),(jt=wt.firstChild)!==null;)vt=wt,wt=jt;for(;;){if(wt===e)break t;if(vt===o&&++qe===R&&(Ee=re),vt===B&&++xt===d&&(Fe=re),(jt=wt.nextSibling)!==null)break;wt=vt,vt=wt.parentNode}wt=jt}o=Ee===-1||Fe===-1?null:{start:Ee,end:Fe}}else o=null}o=o||{start:0,end:0}}else o=null;for(Jo={focusedElem:e,selectionRange:o},et=!1,Gt=t;Gt!==null;)if(t=Gt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Gt=e;else for(;Gt!==null;){t=Gt;try{var $t=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if($t!==null){var Kt=$t.memoizedProps,mi=$t.memoizedState,$e=t.stateNode,je=$e.getSnapshotBeforeUpdate(t.elementType===t.type?Kt:mn(t.type,Kt),mi);$e.__reactInternalSnapshotBeforeUpdate=je}break;case 3:var Ze=t.stateNode.containerInfo;Ze.nodeType===1?Ze.textContent="":Ze.nodeType===9&&Ze.documentElement&&Ze.removeChild(Ze.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(Tt){di(t,t.return,Tt)}if(e=t.sibling,e!==null){e.return=t.return,Gt=e;break}Gt=t.return}return $t=Ou,Ou=!1,$t}function Hs(e,t,o){var d=t.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var R=d=d.next;do{if((R.tag&e)===e){var B=R.destroy;R.destroy=void 0,B!==void 0&&ja(t,o,B)}R=R.next}while(R!==d)}}function Co(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var o=t=t.next;do{if((o.tag&e)===e){var d=o.create;o.destroy=d()}o=o.next}while(o!==t)}}function Ba(e){var t=e.ref;if(t!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof t=="function"?t(e):t.current=e}}function Fu(e){var t=e.alternate;t!==null&&(e.alternate=null,Fu(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[xn],delete t[zs],delete t[ia],delete t[Cc],delete t[Ec])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Nu(e){return e.tag===5||e.tag===3||e.tag===4}function Vu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Nu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ua(e,t,o){var d=e.tag;if(d===5||d===6)e=e.stateNode,t?o.nodeType===8?o.parentNode.insertBefore(e,t):o.insertBefore(e,t):(o.nodeType===8?(t=o.parentNode,t.insertBefore(e,o)):(t=o,t.appendChild(e)),o=o._reactRootContainer,o!=null||t.onclick!==null||(t.onclick=to));else if(d!==4&&(e=e.child,e!==null))for(Ua(e,t,o),e=e.sibling;e!==null;)Ua(e,t,o),e=e.sibling}function Ga(e,t,o){var d=e.tag;if(d===5||d===6)e=e.stateNode,t?o.insertBefore(e,t):o.appendChild(e);else if(d!==4&&(e=e.child,e!==null))for(Ga(e,t,o),e=e.sibling;e!==null;)Ga(e,t,o),e=e.sibling}var Oi=null,gn=!1;function Nn(e,t,o){for(o=o.child;o!==null;)ju(e,t,o),o=o.sibling}function ju(e,t,o){if(Er&&typeof Er.onCommitFiberUnmount=="function")try{Er.onCommitFiberUnmount(Cr,o)}catch{}switch(o.tag){case 5:Gi||ws(o,t);case 6:var d=Oi,R=gn;Oi=null,Nn(e,t,o),Oi=d,gn=R,Oi!==null&&(gn?(e=Oi,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):Oi.removeChild(o.stateNode));break;case 18:Oi!==null&&(gn?(e=Oi,o=o.stateNode,e.nodeType===8?ra(e.parentNode,o):e.nodeType===1&&ra(e,o),pt(e)):ra(Oi,o.stateNode));break;case 4:d=Oi,R=gn,Oi=o.stateNode.containerInfo,gn=!0,Nn(e,t,o),Oi=d,gn=R;break;case 0:case 11:case 14:case 15:if(!Gi&&(d=o.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){R=d=d.next;do{var B=R,re=B.destroy;B=B.tag,re!==void 0&&((B&2)!==0||(B&4)!==0)&&ja(o,t,re),R=R.next}while(R!==d)}Nn(e,t,o);break;case 1:if(!Gi&&(ws(o,t),d=o.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=o.memoizedProps,d.state=o.memoizedState,d.componentWillUnmount()}catch(Ee){di(o,t,Ee)}Nn(e,t,o);break;case 21:Nn(e,t,o);break;case 22:o.mode&1?(Gi=(d=Gi)||o.memoizedState!==null,Nn(e,t,o),Gi=d):Nn(e,t,o);break;default:Nn(e,t,o)}}function Bu(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new Uc),t.forEach(function(d){var R=Qc.bind(null,e,d);o.has(d)||(o.add(d),d.then(R,R))})}}function vn(e,t){var o=t.deletions;if(o!==null)for(var d=0;d<o.length;d++){var R=o[d];try{var B=e,re=t,Ee=re;e:for(;Ee!==null;){switch(Ee.tag){case 5:Oi=Ee.stateNode,gn=!1;break e;case 3:Oi=Ee.stateNode.containerInfo,gn=!0;break e;case 4:Oi=Ee.stateNode.containerInfo,gn=!0;break e}Ee=Ee.return}if(Oi===null)throw Error(a(160));ju(B,re,R),Oi=null,gn=!1;var Fe=R.alternate;Fe!==null&&(Fe.return=null),R.return=null}catch(qe){di(R,t,qe)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Uu(t,e),t=t.sibling}function Uu(e,t){var o=e.alternate,d=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vn(t,e),wn(e),d&4){try{Hs(3,e,e.return),Co(3,e)}catch(Kt){di(e,e.return,Kt)}try{Hs(5,e,e.return)}catch(Kt){di(e,e.return,Kt)}}break;case 1:vn(t,e),wn(e),d&512&&o!==null&&ws(o,o.return);break;case 5:if(vn(t,e),wn(e),d&512&&o!==null&&ws(o,o.return),e.flags&32){var R=e.stateNode;try{dt(R,"")}catch(Kt){di(e,e.return,Kt)}}if(d&4&&(R=e.stateNode,R!=null)){var B=e.memoizedProps,re=o!==null?o.memoizedProps:B,Ee=e.type,Fe=e.updateQueue;if(e.updateQueue=null,Fe!==null)try{Ee==="input"&&B.type==="radio"&&B.name!=null&&kr(R,B),mr(Ee,re);var qe=mr(Ee,B);for(re=0;re<Fe.length;re+=2){var xt=Fe[re],wt=Fe[re+1];xt==="style"?Lt(R,wt):xt==="dangerouslySetInnerHTML"?Le(R,wt):xt==="children"?dt(R,wt):_(R,xt,wt,qe)}switch(Ee){case"input":Ar(R,B);break;case"textarea":Di(R,B);break;case"select":var vt=R._wrapperState.wasMultiple;R._wrapperState.wasMultiple=!!B.multiple;var jt=B.value;jt!=null?fi(R,!!B.multiple,jt,!1):vt!==!!B.multiple&&(B.defaultValue!=null?fi(R,!!B.multiple,B.defaultValue,!0):fi(R,!!B.multiple,B.multiple?[]:"",!1))}R[zs]=B}catch(Kt){di(e,e.return,Kt)}}break;case 6:if(vn(t,e),wn(e),d&4){if(e.stateNode===null)throw Error(a(162));R=e.stateNode,B=e.memoizedProps;try{R.nodeValue=B}catch(Kt){di(e,e.return,Kt)}}break;case 3:if(vn(t,e),wn(e),d&4&&o!==null&&o.memoizedState.isDehydrated)try{pt(t.containerInfo)}catch(Kt){di(e,e.return,Kt)}break;case 4:vn(t,e),wn(e);break;case 13:vn(t,e),wn(e),R=e.child,R.flags&8192&&(B=R.memoizedState!==null,R.stateNode.isHidden=B,!B||R.alternate!==null&&R.alternate.memoizedState!==null||($a=lt())),d&4&&Bu(e);break;case 22:if(xt=o!==null&&o.memoizedState!==null,e.mode&1?(Gi=(qe=Gi)||xt,vn(t,e),Gi=qe):vn(t,e),wn(e),d&8192){if(qe=e.memoizedState!==null,(e.stateNode.isHidden=qe)&&!xt&&(e.mode&1)!==0)for(Gt=e,xt=e.child;xt!==null;){for(wt=Gt=xt;Gt!==null;){switch(vt=Gt,jt=vt.child,vt.tag){case 0:case 11:case 14:case 15:Hs(4,vt,vt.return);break;case 1:ws(vt,vt.return);var $t=vt.stateNode;if(typeof $t.componentWillUnmount=="function"){d=vt,o=vt.return;try{t=d,$t.props=t.memoizedProps,$t.state=t.memoizedState,$t.componentWillUnmount()}catch(Kt){di(d,o,Kt)}}break;case 5:ws(vt,vt.return);break;case 22:if(vt.memoizedState!==null){Wu(wt);continue}}jt!==null?(jt.return=vt,Gt=jt):Wu(wt)}xt=xt.sibling}e:for(xt=null,wt=e;;){if(wt.tag===5){if(xt===null){xt=wt;try{R=wt.stateNode,qe?(B=R.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none"):(Ee=wt.stateNode,Fe=wt.memoizedProps.style,re=Fe!=null&&Fe.hasOwnProperty("display")?Fe.display:null,Ee.style.display=ht("display",re))}catch(Kt){di(e,e.return,Kt)}}}else if(wt.tag===6){if(xt===null)try{wt.stateNode.nodeValue=qe?"":wt.memoizedProps}catch(Kt){di(e,e.return,Kt)}}else if((wt.tag!==22&&wt.tag!==23||wt.memoizedState===null||wt===e)&&wt.child!==null){wt.child.return=wt,wt=wt.child;continue}if(wt===e)break e;for(;wt.sibling===null;){if(wt.return===null||wt.return===e)break e;xt===wt&&(xt=null),wt=wt.return}xt===wt&&(xt=null),wt.sibling.return=wt.return,wt=wt.sibling}}break;case 19:vn(t,e),wn(e),d&4&&Bu(e);break;case 21:break;default:vn(t,e),wn(e)}}function wn(e){var t=e.flags;if(t&2){try{e:{for(var o=e.return;o!==null;){if(Nu(o)){var d=o;break e}o=o.return}throw Error(a(160))}switch(d.tag){case 5:var R=d.stateNode;d.flags&32&&(dt(R,""),d.flags&=-33);var B=Vu(e);Ga(e,B,R);break;case 3:case 4:var re=d.stateNode.containerInfo,Ee=Vu(e);Ua(e,Ee,re);break;default:throw Error(a(161))}}catch(Fe){di(e,e.return,Fe)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Hc(e,t,o){Gt=e,Gu(e)}function Gu(e,t,o){for(var d=(e.mode&1)!==0;Gt!==null;){var R=Gt,B=R.child;if(R.tag===22&&d){var re=R.memoizedState!==null||Ao;if(!re){var Ee=R.alternate,Fe=Ee!==null&&Ee.memoizedState!==null||Gi;Ee=Ao;var qe=Gi;if(Ao=re,(Gi=Fe)&&!qe)for(Gt=R;Gt!==null;)re=Gt,Fe=re.child,re.tag===22&&re.memoizedState!==null?$u(R):Fe!==null?(Fe.return=re,Gt=Fe):$u(R);for(;B!==null;)Gt=B,Gu(B),B=B.sibling;Gt=R,Ao=Ee,Gi=qe}Hu(e)}else(R.subtreeFlags&8772)!==0&&B!==null?(B.return=R,Gt=B):Hu(e)}}function Hu(e){for(;Gt!==null;){var t=Gt;if((t.flags&8772)!==0){var o=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Gi||Co(5,t);break;case 1:var d=t.stateNode;if(t.flags&4&&!Gi)if(o===null)d.componentDidMount();else{var R=t.elementType===t.type?o.memoizedProps:mn(t.type,o.memoizedProps);d.componentDidUpdate(R,o.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var B=t.updateQueue;B!==null&&Wl(t,B,d);break;case 3:var re=t.updateQueue;if(re!==null){if(o=null,t.child!==null)switch(t.child.tag){case 5:o=t.child.stateNode;break;case 1:o=t.child.stateNode}Wl(t,re,o)}break;case 5:var Ee=t.stateNode;if(o===null&&t.flags&4){o=Ee;var Fe=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":Fe.autoFocus&&o.focus();break;case"img":Fe.src&&(o.src=Fe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var qe=t.alternate;if(qe!==null){var xt=qe.memoizedState;if(xt!==null){var wt=xt.dehydrated;wt!==null&&pt(wt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(a(163))}Gi||t.flags&512&&Ba(t)}catch(vt){di(t,t.return,vt)}}if(t===e){Gt=null;break}if(o=t.sibling,o!==null){o.return=t.return,Gt=o;break}Gt=t.return}}function Wu(e){for(;Gt!==null;){var t=Gt;if(t===e){Gt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Gt=o;break}Gt=t.return}}function $u(e){for(;Gt!==null;){var t=Gt;try{switch(t.tag){case 0:case 11:case 15:var o=t.return;try{Co(4,t)}catch(Fe){di(t,o,Fe)}break;case 1:var d=t.stateNode;if(typeof d.componentDidMount=="function"){var R=t.return;try{d.componentDidMount()}catch(Fe){di(t,R,Fe)}}var B=t.return;try{Ba(t)}catch(Fe){di(t,B,Fe)}break;case 5:var re=t.return;try{Ba(t)}catch(Fe){di(t,re,Fe)}}}catch(Fe){di(t,t.return,Fe)}if(t===e){Gt=null;break}var Ee=t.sibling;if(Ee!==null){Ee.return=t.return,Gt=Ee;break}Gt=t.return}}var Wc=Math.ceil,Eo=F.ReactCurrentDispatcher,Ha=F.ReactCurrentOwner,hn=F.ReactCurrentBatchConfig,Nr=0,Ri=null,_i=null,Fi=0,sn=0,Ss=zn(0),Ai=0,Ws=null,ts=0,To=0,Wa=0,$s=null,Ji=null,$a=0,As=1/0,Rn=null,Mo=!1,Xa=null,Vn=null,ko=!1,jn=null,Ro=0,Xs=0,Ka=null,Po=-1,Do=0;function Xi(){return(Nr&6)!==0?lt():Po!==-1?Po:Po=lt()}function Bn(e){return(e.mode&1)===0?1:(Nr&2)!==0&&Fi!==0?Fi&-Fi:Mc.transition!==null?(Do===0&&(Do=A()),Do):(e=k,e!==0||(e=window.event,e=e===void 0?16:Rt(e.type)),e)}function yn(e,t,o,d){if(50<Xs)throw Xs=0,Ka=null,Error(a(185));C(e,o,d),((Nr&2)===0||e!==Ri)&&(e===Ri&&((Nr&2)===0&&(To|=o),Ai===4&&Un(e,Fi)),en(e,d),o===1&&Nr===0&&(t.mode&1)===0&&(As=lt()+500,so&&Ln()))}function en(e,t){var o=e.callbackNode;l(e,t);var d=r(e,e===Ri?Fi:0);if(d===0)o!==null&&Ve(o),e.callbackNode=null,e.callbackPriority=0;else if(t=d&-d,e.callbackPriority!==t){if(o!=null&&Ve(o),t===1)e.tag===0?Tc(Ku.bind(null,e)):zl(Ku.bind(null,e)),Sc(function(){(Nr&6)===0&&Ln()}),o=null;else{switch(D(d)){case 1:o=Mt;break;case 4:o=Pt;break;case 16:o=Ot;break;case 536870912:o=Yt;break;default:o=Ot}o=rc(o,Xu.bind(null,e))}e.callbackPriority=t,e.callbackNode=o}}function Xu(e,t){if(Po=-1,Do=0,(Nr&6)!==0)throw Error(a(327));var o=e.callbackNode;if(Cs()&&e.callbackNode!==o)return null;var d=r(e,e===Ri?Fi:0);if(d===0)return null;if((d&30)!==0||(d&e.expiredLanes)!==0||t)t=zo(e,d);else{t=d;var R=Nr;Nr|=2;var B=qu();(Ri!==e||Fi!==t)&&(Rn=null,As=lt()+500,is(e,t));do try{Kc();break}catch(Ee){Zu(e,Ee)}while(!0);da(),Eo.current=B,Nr=R,_i!==null?t=0:(Ri=null,Fi=0,t=Ai)}if(t!==0){if(t===2&&(R=c(e),R!==0&&(d=R,t=Za(e,R))),t===1)throw o=Ws,is(e,0),Un(e,d),en(e,lt()),o;if(t===6)Un(e,d);else{if(R=e.current.alternate,(d&30)===0&&!$c(R)&&(t=zo(e,d),t===2&&(B=c(e),B!==0&&(d=B,t=Za(e,B))),t===1))throw o=Ws,is(e,0),Un(e,d),en(e,lt()),o;switch(e.finishedWork=R,e.finishedLanes=d,t){case 0:case 1:throw Error(a(345));case 2:ns(e,Ji,Rn);break;case 3:if(Un(e,d),(d&130023424)===d&&(t=$a+500-lt(),10<t)){if(r(e,0)!==0)break;if(R=e.suspendedLanes,(R&d)!==d){Xi(),e.pingedLanes|=e.suspendedLanes&R;break}e.timeoutHandle=ta(ns.bind(null,e,Ji,Rn),t);break}ns(e,Ji,Rn);break;case 4:if(Un(e,d),(d&4194240)===d)break;for(t=e.eventTimes,R=-1;0<d;){var re=31-_r(d);B=1<<re,re=t[re],re>R&&(R=re),d&=~B}if(d=R,d=lt()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*Wc(d/1960))-d,10<d){e.timeoutHandle=ta(ns.bind(null,e,Ji,Rn),d);break}ns(e,Ji,Rn);break;case 5:ns(e,Ji,Rn);break;default:throw Error(a(329))}}}return en(e,lt()),e.callbackNode===o?Xu.bind(null,e):null}function Za(e,t){var o=$s;return e.current.memoizedState.isDehydrated&&(is(e,t).flags|=256),e=zo(e,t),e!==2&&(t=Ji,Ji=o,t!==null&&qa(t)),e}function qa(e){Ji===null?Ji=e:Ji.push.apply(Ji,e)}function $c(e){for(var t=e;;){if(t.flags&16384){var o=t.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var d=0;d<o.length;d++){var R=o[d],B=R.getSnapshot;R=R.value;try{if(!fn(B(),R))return!1}catch{return!1}}}if(o=t.child,t.subtreeFlags&16384&&o!==null)o.return=t,t=o;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Un(e,t){for(t&=~Wa,t&=~To,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var o=31-_r(t),d=1<<o;e[o]=-1,t&=~d}}function Ku(e){if((Nr&6)!==0)throw Error(a(327));Cs();var t=r(e,0);if((t&1)===0)return en(e,lt()),null;var o=zo(e,t);if(e.tag!==0&&o===2){var d=c(e);d!==0&&(t=d,o=Za(e,d))}if(o===1)throw o=Ws,is(e,0),Un(e,t),en(e,lt()),o;if(o===6)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ns(e,Ji,Rn),en(e,lt()),null}function Ya(e,t){var o=Nr;Nr|=1;try{return e(t)}finally{Nr=o,Nr===0&&(As=lt()+500,so&&Ln())}}function rs(e){jn!==null&&jn.tag===0&&(Nr&6)===0&&Cs();var t=Nr;Nr|=1;var o=hn.transition,d=k;try{if(hn.transition=null,k=1,e)return e()}finally{k=d,hn.transition=o,Nr=t,(Nr&6)===0&&Ln()}}function Qa(){sn=Ss.current,Jr(Ss)}function is(e,t){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,wc(o)),_i!==null)for(o=_i.return;o!==null;){var d=o;switch(aa(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&io();break;case 3:_s(),Jr(qi),Jr(ji),_a();break;case 5:ya(d);break;case 4:_s();break;case 13:Jr(oi);break;case 19:Jr(oi);break;case 10:fa(d.type._context);break;case 22:case 23:Qa()}o=o.return}if(Ri=e,_i=e=Gn(e.current,null),Fi=sn=t,Ai=0,Ws=null,Wa=To=ts=0,Ji=$s=null,Qn!==null){for(t=0;t<Qn.length;t++)if(o=Qn[t],d=o.interleaved,d!==null){o.interleaved=null;var R=d.next,B=o.pending;if(B!==null){var re=B.next;B.next=R,d.next=re}o.pending=d}Qn=null}return e}function Zu(e,t){do{var o=_i;try{if(da(),go.current=_o,vo){for(var d=ai.memoizedState;d!==null;){var R=d.queue;R!==null&&(R.pending=null),d=d.next}vo=!1}if(es=0,ki=Si=ai=null,Vs=!1,js=0,Ha.current=null,o===null||o.return===null){Ai=1,Ws=t,_i=null;break}e:{var B=e,re=o.return,Ee=o,Fe=t;if(t=Fi,Ee.flags|=32768,Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"){var qe=Fe,xt=Ee,wt=xt.tag;if((xt.mode&1)===0&&(wt===0||wt===11||wt===15)){var vt=xt.alternate;vt?(xt.updateQueue=vt.updateQueue,xt.memoizedState=vt.memoizedState,xt.lanes=vt.lanes):(xt.updateQueue=null,xt.memoizedState=null)}var jt=_u(re);if(jt!==null){jt.flags&=-257,bu(jt,re,Ee,B,t),jt.mode&1&&xu(B,qe,t),t=jt,Fe=qe;var $t=t.updateQueue;if($t===null){var Kt=new Set;Kt.add(Fe),t.updateQueue=Kt}else $t.add(Fe);break e}else{if((t&1)===0){xu(B,qe,t),Ja();break e}Fe=Error(a(426))}}else if(ti&&Ee.mode&1){var mi=_u(re);if(mi!==null){(mi.flags&65536)===0&&(mi.flags|=256),bu(mi,re,Ee,B,t),ca(bs(Fe,Ee));break e}}B=Fe=bs(Fe,Ee),Ai!==4&&(Ai=2),$s===null?$s=[B]:$s.push(B),B=re;do{switch(B.tag){case 3:B.flags|=65536,t&=-t,B.lanes|=t;var $e=vu(B,Fe,t);Hl(B,$e);break e;case 1:Ee=Fe;var je=B.type,Ze=B.stateNode;if((B.flags&128)===0&&(typeof je.getDerivedStateFromError=="function"||Ze!==null&&typeof Ze.componentDidCatch=="function"&&(Vn===null||!Vn.has(Ze)))){B.flags|=65536,t&=-t,B.lanes|=t;var Tt=yu(B,Ee,t);Hl(B,Tt);break e}}B=B.return}while(B!==null)}Qu(o)}catch(qt){t=qt,_i===o&&o!==null&&(_i=o=o.return);continue}break}while(!0)}function qu(){var e=Eo.current;return Eo.current=_o,e===null?_o:e}function Ja(){(Ai===0||Ai===3||Ai===2)&&(Ai=4),Ri===null||(ts&268435455)===0&&(To&268435455)===0||Un(Ri,Fi)}function zo(e,t){var o=Nr;Nr|=2;var d=qu();(Ri!==e||Fi!==t)&&(Rn=null,is(e,t));do try{Xc();break}catch(R){Zu(e,R)}while(!0);if(da(),Nr=o,Eo.current=d,_i!==null)throw Error(a(261));return Ri=null,Fi=0,Ai}function Xc(){for(;_i!==null;)Yu(_i)}function Kc(){for(;_i!==null&&!Oe();)Yu(_i)}function Yu(e){var t=tc(e.alternate,e,sn);e.memoizedProps=e.pendingProps,t===null?Qu(e):_i=t,Ha.current=null}function Qu(e){var t=e;do{var o=t.alternate;if(e=t.return,(t.flags&32768)===0){if(o=jc(o,t,sn),o!==null){_i=o;return}}else{if(o=Bc(o,t),o!==null){o.flags&=32767,_i=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ai=6,_i=null;return}}if(t=t.sibling,t!==null){_i=t;return}_i=t=e}while(t!==null);Ai===0&&(Ai=5)}function ns(e,t,o){var d=k,R=hn.transition;try{hn.transition=null,k=1,Zc(e,t,o,d)}finally{hn.transition=R,k=d}return null}function Zc(e,t,o,d){do Cs();while(jn!==null);if((Nr&6)!==0)throw Error(a(327));o=e.finishedWork;var R=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var B=o.lanes|o.childLanes;if(E(e,B),e===Ri&&(_i=Ri=null,Fi=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||ko||(ko=!0,rc(Ot,function(){return Cs(),null})),B=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||B){B=hn.transition,hn.transition=null;var re=k;k=1;var Ee=Nr;Nr|=4,Ha.current=null,Gc(e,o),Uu(o,e),mc(Jo),et=!!Qo,Jo=Qo=null,e.current=o,Hc(o),yt(),Nr=Ee,k=re,hn.transition=B}else e.current=o;if(ko&&(ko=!1,jn=e,Ro=R),B=e.pendingLanes,B===0&&(Vn=null),Ur(o.stateNode),en(e,lt()),t!==null)for(d=e.onRecoverableError,o=0;o<t.length;o++)R=t[o],d(R.value,{componentStack:R.stack,digest:R.digest});if(Mo)throw Mo=!1,e=Xa,Xa=null,e;return(Ro&1)!==0&&e.tag!==0&&Cs(),B=e.pendingLanes,(B&1)!==0?e===Ka?Xs++:(Xs=0,Ka=e):Xs=0,Ln(),null}function Cs(){if(jn!==null){var e=D(Ro),t=hn.transition,o=k;try{if(hn.transition=null,k=16>e?16:e,jn===null)var d=!1;else{if(e=jn,jn=null,Ro=0,(Nr&6)!==0)throw Error(a(331));var R=Nr;for(Nr|=4,Gt=e.current;Gt!==null;){var B=Gt,re=B.child;if((Gt.flags&16)!==0){var Ee=B.deletions;if(Ee!==null){for(var Fe=0;Fe<Ee.length;Fe++){var qe=Ee[Fe];for(Gt=qe;Gt!==null;){var xt=Gt;switch(xt.tag){case 0:case 11:case 15:Hs(8,xt,B)}var wt=xt.child;if(wt!==null)wt.return=xt,Gt=wt;else for(;Gt!==null;){xt=Gt;var vt=xt.sibling,jt=xt.return;if(Fu(xt),xt===qe){Gt=null;break}if(vt!==null){vt.return=jt,Gt=vt;break}Gt=jt}}}var $t=B.alternate;if($t!==null){var Kt=$t.child;if(Kt!==null){$t.child=null;do{var mi=Kt.sibling;Kt.sibling=null,Kt=mi}while(Kt!==null)}}Gt=B}}if((B.subtreeFlags&2064)!==0&&re!==null)re.return=B,Gt=re;else e:for(;Gt!==null;){if(B=Gt,(B.flags&2048)!==0)switch(B.tag){case 0:case 11:case 15:Hs(9,B,B.return)}var $e=B.sibling;if($e!==null){$e.return=B.return,Gt=$e;break e}Gt=B.return}}var je=e.current;for(Gt=je;Gt!==null;){re=Gt;var Ze=re.child;if((re.subtreeFlags&2064)!==0&&Ze!==null)Ze.return=re,Gt=Ze;else e:for(re=je;Gt!==null;){if(Ee=Gt,(Ee.flags&2048)!==0)try{switch(Ee.tag){case 0:case 11:case 15:Co(9,Ee)}}catch(qt){di(Ee,Ee.return,qt)}if(Ee===re){Gt=null;break e}var Tt=Ee.sibling;if(Tt!==null){Tt.return=Ee.return,Gt=Tt;break e}Gt=Ee.return}}if(Nr=R,Ln(),Er&&typeof Er.onPostCommitFiberRoot=="function")try{Er.onPostCommitFiberRoot(Cr,e)}catch{}d=!0}return d}finally{k=o,hn.transition=t}}return!1}function Ju(e,t,o){t=bs(o,t),t=vu(e,t,1),e=Fn(e,t,1),t=Xi(),e!==null&&(C(e,1,t),en(e,t))}function di(e,t,o){if(e.tag===3)Ju(e,e,o);else for(;t!==null;){if(t.tag===3){Ju(t,e,o);break}else if(t.tag===1){var d=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Vn===null||!Vn.has(d))){e=bs(o,e),e=yu(t,e,1),t=Fn(t,e,1),e=Xi(),t!==null&&(C(t,1,e),en(t,e));break}}t=t.return}}function qc(e,t,o){var d=e.pingCache;d!==null&&d.delete(t),t=Xi(),e.pingedLanes|=e.suspendedLanes&o,Ri===e&&(Fi&o)===o&&(Ai===4||Ai===3&&(Fi&130023424)===Fi&&500>lt()-$a?is(e,0):Wa|=o),en(e,t)}function ec(e,t){t===0&&((e.mode&1)===0?t=1:(t=ri,ri<<=1,(ri&130023424)===0&&(ri=4194304)));var o=Xi();e=Tn(e,t),e!==null&&(C(e,t,o),en(e,o))}function Yc(e){var t=e.memoizedState,o=0;t!==null&&(o=t.retryLane),ec(e,o)}function Qc(e,t){var o=0;switch(e.tag){case 13:var d=e.stateNode,R=e.memoizedState;R!==null&&(o=R.retryLane);break;case 19:d=e.stateNode;break;default:throw Error(a(314))}d!==null&&d.delete(t),ec(e,o)}var tc;tc=function(e,t,o){if(e!==null)if(e.memoizedProps!==t.pendingProps||qi.current)Qi=!0;else{if((e.lanes&o)===0&&(t.flags&128)===0)return Qi=!1,Vc(e,t,o);Qi=(e.flags&131072)!==0}else Qi=!1,ti&&(t.flags&1048576)!==0&&Il(t,ao,t.index);switch(t.lanes=0,t.tag){case 2:var d=t.type;So(e,t),e=t.pendingProps;var R=fs(t,ji.current);xs(t,o),R=Sa(null,t,d,e,R,o);var B=Aa();return t.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Yi(d)?(B=!0,no(t)):B=!1,t.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,ga(t),R.updater=bo,t.stateNode=R,R._reactInternals=t,Ra(t,d,e,o),t=Ia(null,t,d,!0,B,o)):(t.tag=0,ti&&B&&oa(t),$i(null,t,R,o),t=t.child),t;case 16:d=t.elementType;e:{switch(So(e,t),e=t.pendingProps,R=d._init,d=R(d._payload),t.type=d,R=t.tag=eh(d),e=mn(d,e),R){case 0:t=za(null,t,d,e,o);break e;case 1:t=Tu(null,t,d,e,o);break e;case 11:t=wu(null,t,d,e,o);break e;case 14:t=Su(null,t,d,mn(d.type,e),o);break e}throw Error(a(306,d,""))}return t;case 0:return d=t.type,R=t.pendingProps,R=t.elementType===d?R:mn(d,R),za(e,t,d,R,o);case 1:return d=t.type,R=t.pendingProps,R=t.elementType===d?R:mn(d,R),Tu(e,t,d,R,o);case 3:e:{if(Mu(t),e===null)throw Error(a(387));d=t.pendingProps,B=t.memoizedState,R=B.element,Gl(e,t),po(t,d,null,o);var re=t.memoizedState;if(d=re.element,B.isDehydrated)if(B={element:d,isDehydrated:!1,cache:re.cache,pendingSuspenseBoundaries:re.pendingSuspenseBoundaries,transitions:re.transitions},t.updateQueue.baseState=B,t.memoizedState=B,t.flags&256){R=bs(Error(a(423)),t),t=ku(e,t,d,o,R);break e}else if(d!==R){R=bs(Error(a(424)),t),t=ku(e,t,d,o,R);break e}else for(nn=Dn(t.stateNode.containerInfo.firstChild),rn=t,ti=!0,pn=null,o=Bl(t,null,d,o),t.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(gs(),d===R){t=kn(e,t,o);break e}$i(e,t,d,o)}t=t.child}return t;case 5:return $l(t),e===null&&ua(t),d=t.type,R=t.pendingProps,B=e!==null?e.memoizedProps:null,re=R.children,ea(d,R)?re=null:B!==null&&ea(d,B)&&(t.flags|=32),Eu(e,t),$i(e,t,re,o),t.child;case 6:return e===null&&ua(t),null;case 13:return Ru(e,t,o);case 4:return va(t,t.stateNode.containerInfo),d=t.pendingProps,e===null?t.child=vs(t,null,d,o):$i(e,t,d,o),t.child;case 11:return d=t.type,R=t.pendingProps,R=t.elementType===d?R:mn(d,R),wu(e,t,d,R,o);case 7:return $i(e,t,t.pendingProps,o),t.child;case 8:return $i(e,t,t.pendingProps.children,o),t.child;case 12:return $i(e,t,t.pendingProps.children,o),t.child;case 10:e:{if(d=t.type._context,R=t.pendingProps,B=t.memoizedProps,re=R.value,qr(co,d._currentValue),d._currentValue=re,B!==null)if(fn(B.value,re)){if(B.children===R.children&&!qi.current){t=kn(e,t,o);break e}}else for(B=t.child,B!==null&&(B.return=t);B!==null;){var Ee=B.dependencies;if(Ee!==null){re=B.child;for(var Fe=Ee.firstContext;Fe!==null;){if(Fe.context===d){if(B.tag===1){Fe=Mn(-1,o&-o),Fe.tag=2;var qe=B.updateQueue;if(qe!==null){qe=qe.shared;var xt=qe.pending;xt===null?Fe.next=Fe:(Fe.next=xt.next,xt.next=Fe),qe.pending=Fe}}B.lanes|=o,Fe=B.alternate,Fe!==null&&(Fe.lanes|=o),pa(B.return,o,t),Ee.lanes|=o;break}Fe=Fe.next}}else if(B.tag===10)re=B.type===t.type?null:B.child;else if(B.tag===18){if(re=B.return,re===null)throw Error(a(341));re.lanes|=o,Ee=re.alternate,Ee!==null&&(Ee.lanes|=o),pa(re,o,t),re=B.sibling}else re=B.child;if(re!==null)re.return=B;else for(re=B;re!==null;){if(re===t){re=null;break}if(B=re.sibling,B!==null){B.return=re.return,re=B;break}re=re.return}B=re}$i(e,t,R.children,o),t=t.child}return t;case 9:return R=t.type,d=t.pendingProps.children,xs(t,o),R=un(R),d=d(R),t.flags|=1,$i(e,t,d,o),t.child;case 14:return d=t.type,R=mn(d,t.pendingProps),R=mn(d.type,R),Su(e,t,d,R,o);case 15:return Au(e,t,t.type,t.pendingProps,o);case 17:return d=t.type,R=t.pendingProps,R=t.elementType===d?R:mn(d,R),So(e,t),t.tag=1,Yi(d)?(e=!0,no(t)):e=!1,xs(t,o),mu(t,d,R),Ra(t,d,R,o),Ia(null,t,d,!0,e,o);case 19:return Du(e,t,o);case 22:return Cu(e,t,o)}throw Error(a(156,t.tag))};function rc(e,t){return xe(e,t)}function Jc(e,t,o,d){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(e,t,o,d){return new Jc(e,t,o,d)}function el(e){return e=e.prototype,!(!e||!e.isReactComponent)}function eh(e){if(typeof e=="function")return el(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ge)return 11;if(e===ue)return 14}return 2}function Gn(e,t){var o=e.alternate;return o===null?(o=dn(e.tag,t,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=t,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,t=e.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function Io(e,t,o,d,R,B){var re=2;if(d=e,typeof e=="function")el(e)&&(re=1);else if(typeof e=="string")re=5;else e:switch(e){case q:return ss(o.children,R,B,t);case N:re=8,R|=8;break;case ee:return e=dn(12,o,t,R|2),e.elementType=ee,e.lanes=B,e;case me:return e=dn(13,o,t,R),e.elementType=me,e.lanes=B,e;case Me:return e=dn(19,o,t,R),e.elementType=Me,e.lanes=B,e;case ce:return Lo(o,R,B,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ce:re=10;break e;case he:re=9;break e;case ge:re=11;break e;case ue:re=14;break e;case P:re=16,d=null;break e}throw Error(a(130,e==null?e:typeof e,""))}return t=dn(re,o,t,R),t.elementType=e,t.type=d,t.lanes=B,t}function ss(e,t,o,d){return e=dn(7,e,d,t),e.lanes=o,e}function Lo(e,t,o,d){return e=dn(22,e,d,t),e.elementType=ce,e.lanes=o,e.stateNode={isHidden:!1},e}function tl(e,t,o){return e=dn(6,e,null,t),e.lanes=o,e}function rl(e,t,o){return t=dn(4,e.children!==null?e.children:[],e.key,t),t.lanes=o,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function th(e,t,o,d,R){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=g(0),this.expirationTimes=g(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=g(0),this.identifierPrefix=d,this.onRecoverableError=R,this.mutableSourceEagerHydrationData=null}function il(e,t,o,d,R,B,re,Ee,Fe){return e=new th(e,t,o,Ee,Fe),t===1?(t=1,B===!0&&(t|=8)):t=0,B=dn(3,null,null,t),e.current=B,B.stateNode=e,B.memoizedState={element:d,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},ga(B),e}function rh(e,t,o){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:d==null?null:""+d,children:e,containerInfo:t,implementation:o}}function ic(e){if(!e)return In;e=e._reactInternals;e:{if(Gr(e)!==e||e.tag!==1)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Yi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(a(171))}if(e.tag===1){var o=e.type;if(Yi(o))return Pl(e,o,t)}return t}function nc(e,t,o,d,R,B,re,Ee,Fe){return e=il(o,d,!0,e,R,B,re,Ee,Fe),e.context=ic(null),o=e.current,d=Xi(),R=Bn(o),B=Mn(d,R),B.callback=t??null,Fn(o,B,R),e.current.lanes=R,C(e,R,d),en(e,d),e}function Oo(e,t,o,d){var R=t.current,B=Xi(),re=Bn(R);return o=ic(o),t.context===null?t.context=o:t.pendingContext=o,t=Mn(B,re),t.payload={element:e},d=d===void 0?null:d,d!==null&&(t.callback=d),e=Fn(R,t,re),e!==null&&(yn(e,R,re,B),fo(e,R,re)),re}function Fo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<t?o:t}}function nl(e,t){sc(e,t),(e=e.alternate)&&sc(e,t)}function ih(){return null}var oc=typeof reportError=="function"?reportError:function(e){console.error(e)};function sl(e){this._internalRoot=e}No.prototype.render=sl.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(a(409));Oo(e,t,null,null)},No.prototype.unmount=sl.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;rs(function(){Oo(null,e,null,null)}),t[Sn]=null}};function No(e){this._internalRoot=e}No.prototype.unstable_scheduleHydration=function(e){if(e){var t=W();e={blockedOn:null,target:e,priority:t};for(var o=0;o<Te.length&&t!==0&&t<Te[o].priority;o++);Te.splice(o,0,e),o===0&&tt(e)}};function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Vo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ac(){}function nh(e,t,o,d,R){if(R){if(typeof d=="function"){var B=d;d=function(){var qe=Fo(re);B.call(qe)}}var re=nc(t,d,e,0,null,!1,!1,"",ac);return e._reactRootContainer=re,e[Sn]=re.current,Ps(e.nodeType===8?e.parentNode:e),rs(),re}for(;R=e.lastChild;)e.removeChild(R);if(typeof d=="function"){var Ee=d;d=function(){var qe=Fo(Fe);Ee.call(qe)}}var Fe=il(e,0,!1,null,null,!1,!1,"",ac);return e._reactRootContainer=Fe,e[Sn]=Fe.current,Ps(e.nodeType===8?e.parentNode:e),rs(function(){Oo(t,Fe,o,d)}),Fe}function jo(e,t,o,d,R){var B=o._reactRootContainer;if(B){var re=B;if(typeof R=="function"){var Ee=R;R=function(){var Fe=Fo(re);Ee.call(Fe)}}Oo(t,re,e,R)}else re=nh(o,t,e,R,d);return Fo(re)}$=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var o=ae(t.pendingLanes);o!==0&&(S(t,o|1),en(t,lt()),(Nr&6)===0&&(As=lt()+500,Ln()))}break;case 13:rs(function(){var d=Tn(e,1);if(d!==null){var R=Xi();yn(d,e,1,R)}}),nl(e,1)}},U=function(e){if(e.tag===13){var t=Tn(e,134217728);if(t!==null){var o=Xi();yn(t,e,134217728,o)}nl(e,134217728)}},V=function(e){if(e.tag===13){var t=Bn(e),o=Tn(e,t);if(o!==null){var d=Xi();yn(o,e,t,d)}nl(e,t)}},W=function(){return k},H=function(e,t){var o=k;try{return k=e,t()}finally{k=o}},ui=function(e,t,o){switch(t){case"input":if(Ar(e,o),t=o.name,o.type==="radio"&&t!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<o.length;t++){var d=o[t];if(d!==e&&d.form===e.form){var R=ro(d);if(!R)throw Error(a(90));Ft(d),Ar(d,R)}}}break;case"textarea":Di(e,o);break;case"select":t=o.value,t!=null&&fi(e,!!o.multiple,t,!1)}},vi=Ya,wi=rs;var sh={usingClientEntryPoint:!1,Events:[Is,hs,ro,Dr,rr,Ya]},Ks={findFiberByHostInstance:Kn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oh={bundleType:Ks.bundleType,version:Ks.version,rendererPackageName:Ks.rendererPackageName,rendererConfig:Ks.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:F.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=x(e),e===null?null:e.stateNode},findFiberByHostInstance:Ks.findFiberByHostInstance||ih,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bo.isDisabled&&Bo.supportsFiber)try{Cr=Bo.inject(oh),Er=Bo}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sh,reactDom_production_min.createPortal=function(e,t){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(t))throw Error(a(200));return rh(e,t,null,o)},reactDom_production_min.createRoot=function(e,t){if(!ol(e))throw Error(a(299));var o=!1,d="",R=oc;return t!=null&&(t.unstable_strictMode===!0&&(o=!0),t.identifierPrefix!==void 0&&(d=t.identifierPrefix),t.onRecoverableError!==void 0&&(R=t.onRecoverableError)),t=il(e,1,!1,null,null,o,!1,d,R),e[Sn]=t.current,Ps(e.nodeType===8?e.parentNode:e),new sl(t)},reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=x(t),e=e===null?null:e.stateNode,e},reactDom_production_min.flushSync=function(e){return rs(e)},reactDom_production_min.hydrate=function(e,t,o){if(!Vo(t))throw Error(a(200));return jo(null,e,t,!0,o)},reactDom_production_min.hydrateRoot=function(e,t,o){if(!ol(e))throw Error(a(405));var d=o!=null&&o.hydratedSources||null,R=!1,B="",re=oc;if(o!=null&&(o.unstable_strictMode===!0&&(R=!0),o.identifierPrefix!==void 0&&(B=o.identifierPrefix),o.onRecoverableError!==void 0&&(re=o.onRecoverableError)),t=nc(t,null,e,1,o??null,R,!1,B,re),e[Sn]=t.current,Ps(e),d)for(e=0;e<d.length;e++)o=d[e],R=o._getVersion,R=R(o._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[o,R]:t.mutableSourceEagerHydrationData.push(o,R);return new No(t)},reactDom_production_min.render=function(e,t,o){if(!Vo(t))throw Error(a(200));return jo(null,e,t,!1,o)},reactDom_production_min.unmountComponentAtNode=function(e){if(!Vo(e))throw Error(a(40));return e._reactRootContainer?(rs(function(){jo(null,null,e,!1,function(){e._reactRootContainer=null,e[Sn]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=Ya,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,t,o,d){if(!Vo(o))throw Error(a(200));if(e==null||e._reactInternals===void 0)throw Error(a(38));return jo(e,t,o,!1,d)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var i=requireReactDom();return client.createRoot=i.createRoot,client.hydrateRoot=i.hydrateRoot,client}var clientExports=requireClient();async function getProvidersList(i="https://raw.githubusercontent.com/Materials-Consortia/providers/refs/heads/master/src/links/v1/providers.json",n=[]){async function a(z){const u=await fetch(z);if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);return await u.json()}let h;try{h=await a(i)}catch(z){console.warn("Remote fetch failed, falling back to cachedProviders.json:",z);try{h=await a("cachedProviders.json")}catch(u){throw console.error("Both remote and local fetches failed:",u),u}}const m=h.data.filter(z=>!n.includes(z.id));return{...h,data:m}}async function getProviderLinks(i){const n=m=>(m.data||[]).filter(z=>z.attributes?.link_type==="child"),a=[{name:"direct",url:`${i}/v1/links`},{name:"allorigins",url:`https://api.allorigins.win/raw?url=${encodeURIComponent(`${i}/v1/links`)}`},{name:"cors-anywhere",url:`https://cors-anywhere.com/${i}/v1/links`}];for(const{url:m,name:z}of a)try{const u=await fetch(m);if(!u.ok)continue;const y=await u.json();return{children:n(y),error:null}}catch{continue}const h=new Error("All fetch methods failed");return{children:[],error:h}}async function getInfo({providerUrl:i}){console.log(`${i}/v1/info`);const n=[{name:"direct",url:`${i}/v1/info/structures`},{name:"allorigins",url:`https://api.allorigins.win/raw?url=${encodeURIComponent(`${i}/v1/info/structures`)}`},{name:"cors-anywhere",url:`https://cors-anywhere.com/${i}/v1/info/structures`}];for(const{url:a,name:h}of n){console.log(a);try{const m=await fetch(a);if(!m.ok)continue;const z=await m.json(),u=z.data.properties,y=Object.fromEntries(Object.entries(z.data.properties).filter(([p,w])=>p.startsWith("_")));return console.log(y),{customProps:y,error:null}}catch{continue}}}async function getStructures({providerUrl:i,filter:n="",page:a=1,pageSize:h=20}){if(!i)throw new Error("Provider URL is required");const m=(a-1)*h,z=n?`?filter=${encodeURIComponent(n)}&page_offset=${m}`:`?page_offset=${m}`,u=[`${i}/v1/structures${z}`,`https://api.allorigins.win/raw?url=${encodeURIComponent(`${i}/v1/structures${z}`)}`,`https://cors-anywhere.com/${i}/v1/structures${z}`];for(const y of u)try{console.log("URL",y);const p=await fetch(y);if(!p.ok)continue;return await p.json()}catch{continue}throw new Error("All fetch methods failed for getStructures")}function OptimadeHeader(){return jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsx("img",{src:"optimade_logo.png",alt:"OptimadeLogo",className:"h-18 sm:h-24 md:h-32 w-auto object-contain"})})}var lodash_debounce,hasRequiredLodash_debounce;function requireLodash_debounce(){if(hasRequiredLodash_debounce)return lodash_debounce;hasRequiredLodash_debounce=1;var i="Expected a function",n=NaN,a="[object Symbol]",h=/^\s+|\s+$/g,m=/^[-+]0x[0-9a-f]+$/i,z=/^0b[01]+$/i,u=/^0o[0-7]+$/i,y=parseInt,p=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,w=typeof self=="object"&&self&&self.Object===Object&&self,M=p||w||Function("return this")(),b=Object.prototype,I=b.toString,O=Math.max,T=Math.min,L=function(){return M.Date.now()};function Q(j,G,q){var N,ee,Ce,he,ge,me,Me=0,ue=!1,P=!1,ce=!0;if(typeof j!="function")throw new TypeError(i);G=F(G)||0,ne(q)&&(ue=!!q.leading,P="maxWait"in q,Ce=P?O(F(q.maxWait)||0,G):Ce,ce="trailing"in q?!!q.trailing:ce);function se(Ue){var Ie=N,rt=ee;return N=ee=void 0,Me=Ue,he=j.apply(rt,Ie),he}function X(Ue){return Me=Ue,ge=setTimeout(De,G),ue?se(Ue):he}function Re(Ue){var Ie=Ue-me,rt=Ue-Me,st=G-Ie;return P?T(st,Ce-rt):st}function fe(Ue){var Ie=Ue-me,rt=Ue-Me;return me===void 0||Ie>=G||Ie<0||P&&rt>=Ce}function De(){var Ue=L();if(fe(Ue))return We(Ue);ge=setTimeout(De,Re(Ue))}function We(Ue){return ge=void 0,ce&&N?se(Ue):(N=ee=void 0,he)}function oe(){ge!==void 0&&clearTimeout(ge),Me=0,N=me=ee=ge=void 0}function Ae(){return ge===void 0?he:We(L())}function He(){var Ue=L(),Ie=fe(Ue);if(N=arguments,ee=this,me=Ue,Ie){if(ge===void 0)return X(me);if(P)return ge=setTimeout(De,G),se(me)}return ge===void 0&&(ge=setTimeout(De,G)),he}return He.cancel=oe,He.flush=Ae,He}function ne(j){var G=typeof j;return!!j&&(G=="object"||G=="function")}function Z(j){return!!j&&typeof j=="object"}function _(j){return typeof j=="symbol"||Z(j)&&I.call(j)==a}function F(j){if(typeof j=="number")return j;if(_(j))return n;if(ne(j)){var G=typeof j.valueOf=="function"?j.valueOf():j;j=ne(G)?G+"":G}if(typeof j!="string")return j===0?j:+j;j=j.replace(h,"");var q=z.test(j);return q||u.test(j)?y(j.slice(2),q?2:8):m.test(j)?n:+j}return lodash_debounce=Q,lodash_debounce}var lodash_debounceExports=requireLodash_debounce();const debounce=getDefaultExportFromCjs(lodash_debounceExports),slateDropdown=`min-w-[325]
  w-full border-2 border-slate-300
  bg-slate-200 py-1 px-3 rounded shadow hover:cursor-pointer
  hover:bg-slate-300 disabled:cursor-not-allowed
  disabled:bg-gray-100 text-sm md:text-base
`;function DatabaseSelector({providers:i,onQueryUrlChange:n}){const[a,h]=reactExports.useState(""),[m,z]=reactExports.useState([]),[u,y]=reactExports.useState(""),[p,w]=reactExports.useState(""),[M,b]=reactExports.useState(!1),I=debounce(O=>w(O),300);return reactExports.useEffect(()=>{if(!a||a==="__custom__"){z([]),y(""),n(p||"");return}async function O(){try{b(!0);const{children:T}=await getProviderLinks(a),L=T.map(Q=>Q.attributes||{});z(L),y("")}catch(T){console.error(T),z([]),y("")}finally{b(!1)}}O()},[a]),reactExports.useEffect(()=>{n(a==="__custom__"?p:u||"")},[a,u,p,n]),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-start space-y-2 w-full max-w-md",children:[jsxRuntimeExports.jsxs("select",{className:slateDropdown,value:a,onChange:O=>h(O.target.value),children:[jsxRuntimeExports.jsx("option",{value:"",disabled:!0,children:"Select a provider"}),i.map(O=>jsxRuntimeExports.jsx("option",{value:O.attributes?.base_url||"",children:O.attributes?.name||O.id},O.attributes?.id??O.id??O.attributes?.base_url)),jsxRuntimeExports.jsx("option",{value:"__custom__",children:"Custom endpoint"})]}),a==="__custom__"?jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Enter custom URL",className:"w-[calc(100%-4px)] mx-auto ring-[1px] ring-slate-300 rounded-sm px-2 py-1",onChange:O=>I(O.target.value)}):jsxRuntimeExports.jsx("select",{className:`${slateDropdown}`,value:u,onChange:O=>y(O.target.value),disabled:M,children:M?jsxRuntimeExports.jsx("option",{children:"Loading"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("option",{value:"",disabled:!0,children:"Select a subdatabase"}),m.map(O=>jsxRuntimeExports.jsx("option",{value:O.base_url,children:O.name},O.id??O.base_url??O.name))]})})]})}const elements=[{num:1,sym:"H",row:1,col:1,group:"group1"},{num:2,sym:"He",row:1,col:18,group:"group18"},{num:3,sym:"Li",row:2,col:1,group:"group1"},{num:4,sym:"Be",row:2,col:2,group:"group2"},{num:5,sym:"B",row:2,col:13,group:"metalloid"},{num:6,sym:"C",row:2,col:14,group:"mainGroup"},{num:7,sym:"N",row:2,col:15,group:"mainGroup"},{num:8,sym:"O",row:2,col:16,group:"mainGroup"},{num:9,sym:"F",row:2,col:17,group:"group17"},{num:10,sym:"Ne",row:2,col:18,group:"group18"},{num:11,sym:"Na",row:3,col:1,group:"group1"},{num:12,sym:"Mg",row:3,col:2,group:"group2"},{num:13,sym:"Al",row:3,col:13,group:"postTransition"},{num:14,sym:"Si",row:3,col:14,group:"metalloid"},{num:15,sym:"P",row:3,col:15,group:"mainGroup"},{num:16,sym:"S",row:3,col:16,group:"mainGroup"},{num:17,sym:"Cl",row:3,col:17,group:"group17"},{num:18,sym:"Ar",row:3,col:18,group:"group18"},{num:19,sym:"K",row:4,col:1,group:"group1"},{num:20,sym:"Ca",row:4,col:2,group:"group2"},{num:21,sym:"Sc",row:4,col:3,group:"transition"},{num:22,sym:"Ti",row:4,col:4,group:"transition"},{num:23,sym:"V",row:4,col:5,group:"transition"},{num:24,sym:"Cr",row:4,col:6,group:"transition"},{num:25,sym:"Mn",row:4,col:7,group:"transition"},{num:26,sym:"Fe",row:4,col:8,group:"transition"},{num:27,sym:"Co",row:4,col:9,group:"transition"},{num:28,sym:"Ni",row:4,col:10,group:"transition"},{num:29,sym:"Cu",row:4,col:11,group:"transition"},{num:30,sym:"Zn",row:4,col:12,group:"transition"},{num:31,sym:"Ga",row:4,col:13,group:"postTransition"},{num:32,sym:"Ge",row:4,col:14,group:"metalloid"},{num:33,sym:"As",row:4,col:15,group:"metalloid"},{num:34,sym:"Se",row:4,col:16,group:"mainGroup"},{num:35,sym:"Br",row:4,col:17,group:"group17"},{num:36,sym:"Kr",row:4,col:18,group:"group18"},{num:37,sym:"Rb",row:5,col:1,group:"group1"},{num:38,sym:"Sr",row:5,col:2,group:"group2"},{num:39,sym:"Y",row:5,col:3,group:"transition"},{num:40,sym:"Zr",row:5,col:4,group:"transition"},{num:41,sym:"Nb",row:5,col:5,group:"transition"},{num:42,sym:"Mo",row:5,col:6,group:"transition"},{num:43,sym:"Tc",row:5,col:7,group:"transition"},{num:44,sym:"Ru",row:5,col:8,group:"transition"},{num:45,sym:"Rh",row:5,col:9,group:"transition"},{num:46,sym:"Pd",row:5,col:10,group:"transition"},{num:47,sym:"Ag",row:5,col:11,group:"transition"},{num:48,sym:"Cd",row:5,col:12,group:"transition"},{num:49,sym:"In",row:5,col:13,group:"postTransition"},{num:50,sym:"Sn",row:5,col:14,group:"postTransition"},{num:51,sym:"Sb",row:5,col:15,group:"metalloid"},{num:52,sym:"Te",row:5,col:16,group:"metalloid"},{num:53,sym:"I",row:5,col:17,group:"group17"},{num:54,sym:"Xe",row:5,col:18,group:"group18"},{num:55,sym:"Cs",row:6,col:1,group:"group1"},{num:56,sym:"Ba",row:6,col:2,group:"group2"},{num:72,sym:"Hf",row:6,col:4,group:"transition"},{num:73,sym:"Ta",row:6,col:5,group:"transition"},{num:74,sym:"W",row:6,col:6,group:"transition"},{num:75,sym:"Re",row:6,col:7,group:"transition"},{num:76,sym:"Os",row:6,col:8,group:"transition"},{num:77,sym:"Ir",row:6,col:9,group:"transition"},{num:78,sym:"Pt",row:6,col:10,group:"transition"},{num:79,sym:"Au",row:6,col:11,group:"transition"},{num:80,sym:"Hg",row:6,col:12,group:"transition"},{num:81,sym:"Tl",row:6,col:13,group:"postTransition"},{num:82,sym:"Pb",row:6,col:14,group:"postTransition"},{num:83,sym:"Bi",row:6,col:15,group:"postTransition"},{num:84,sym:"Po",row:6,col:16,group:"postTransition"},{num:85,sym:"At",row:6,col:17,group:"group17"},{num:86,sym:"Rn",row:6,col:18,group:"group18"},{num:87,sym:"Fr",row:7,col:1,group:"group1"},{num:88,sym:"Ra",row:7,col:2,group:"group2"},{num:104,sym:"Rf",row:7,col:4,group:"transition"},{num:105,sym:"Db",row:7,col:5,group:"transition"},{num:106,sym:"Sg",row:7,col:6,group:"transition"},{num:107,sym:"Bh",row:7,col:7,group:"transition"},{num:108,sym:"Hs",row:7,col:8,group:"transition"},{num:109,sym:"Mt",row:7,col:9,group:"bg-lime-200"},{num:110,sym:"Ds",row:7,col:10,group:"bg-lime-200"},{num:111,sym:"Rg",row:7,col:11,group:"bg-lime-200"},{num:112,sym:"Cn",row:7,col:12,group:"bg-lime-200"},{num:113,sym:"Nh",row:7,col:13,group:"bg-lime-200"},{num:114,sym:"Fl",row:7,col:14,group:"bg-lime-200"},{num:115,sym:"Mc",row:7,col:15,group:"bg-lime-200"},{num:116,sym:"Lv",row:7,col:16,group:"bg-lime-200"},{num:117,sym:"Ts",row:7,col:17,group:"bg-lime-200"},{num:118,sym:"Og",row:7,col:18,group:"bg-lime-200"},{num:57,sym:"La",row:12,col:3,group:"lanthanide"},{num:58,sym:"Ce",row:12,col:4,group:"lanthanide"},{num:59,sym:"Pr",row:12,col:5,group:"lanthanide"},{num:60,sym:"Nd",row:12,col:6,group:"lanthanide"},{num:61,sym:"Pm",row:12,col:7,group:"lanthanide"},{num:62,sym:"Sm",row:12,col:8,group:"lanthanide"},{num:63,sym:"Eu",row:12,col:9,group:"lanthanide"},{num:64,sym:"Gd",row:12,col:10,group:"lanthanide"},{num:65,sym:"Tb",row:12,col:11,group:"lanthanide"},{num:66,sym:"Dy",row:12,col:12,group:"lanthanide"},{num:67,sym:"Ho",row:12,col:13,group:"lanthanide"},{num:68,sym:"Er",row:12,col:14,group:"lanthanide"},{num:69,sym:"Tm",row:12,col:15,group:"lanthanide"},{num:70,sym:"Yb",row:12,col:16,group:"lanthanide"},{num:71,sym:"Lu",row:12,col:17,group:"lanthanide"},{num:89,sym:"Ac",row:13,col:3,group:"actinide"},{num:90,sym:"Th",row:13,col:4,group:"actinide"},{num:91,sym:"Pa",row:13,col:5,group:"actinide"},{num:92,sym:"U",row:13,col:6,group:"actinide"},{num:93,sym:"Np",row:13,col:7,group:"actinide"},{num:94,sym:"Pu",row:13,col:8,group:"actinide"},{num:95,sym:"Am",row:13,col:9,group:"actinide"},{num:96,sym:"Cm",row:13,col:10,group:"actinide"},{num:97,sym:"Bk",row:13,col:11,group:"actinide"},{num:98,sym:"Cf",row:13,col:12,group:"actinide"},{num:99,sym:"Es",row:13,col:13,group:"actinide"},{num:100,sym:"Fm",row:13,col:14,group:"actinide"},{num:101,sym:"Md",row:13,col:15,group:"actinide"},{num:102,sym:"No",row:13,col:16,group:"actinide"},{num:103,sym:"Lr",row:13,col:17,group:"actinide"}],defaultColors={group1:"bg-[#d7bbbb]",group2:"bg-[#d7cdbb]",group17:"bg-[#d7d9c2]",group18:"bg-[#d0d5ee]",transition:"bg-[#c4d0d8]",lanthanide:"bg-[#e5cbee]",actinide:"bg-[#aebcee]",metalloid:"bg-[#cdd9c2]",postTransition:"bg-[#c2c8d9]",mainGroup:"bg-[#d9c2ce]",default:"bg-gray-200"};function PTable({selected:i={},onSelectionChange:n,colors:a=defaultColors,selectedClassName:h="bg-green-400 border border-green-700 text-white scale-105",deselectedClassName:m="bg-red-400 border border-red-700 text-white scale-105",defaultBorderClassName:z="border border-slate-700",hoverClassName:u="transform transition-transform duration-100 hover:scale-105 hover:z-10"}){const y=w=>{if(!n)return;const M=((i[w]??0)+1)%3;n({[w]:M})},p=w=>{const M=i[w.sym]??0;let b=a[w.group]??a.default;return M===1?h:M===2?m:`${b} ${z}`};return jsxRuntimeExports.jsx("div",{className:"w-full max-w-full mx-auto p-0",children:jsxRuntimeExports.jsx("div",{className:"@container",children:jsxRuntimeExports.jsx("div",{className:"grid @gap-0.5 @sm:gap-1 w-full",style:{gridTemplateColumns:"repeat(18, minmax(0, 1fr))"},children:elements.map(w=>jsxRuntimeExports.jsx("div",{style:{gridColumn:w.col,gridRow:w.row},className:"relative w-full",children:jsxRuntimeExports.jsx("div",{className:"w-full aspect-square",children:jsxRuntimeExports.jsxs("button",{onClick:()=>y(w.sym),className:`flex flex-col justify-center items-center w-full h-full rounded-sm ${u} ${p(w)}`,children:[jsxRuntimeExports.jsx("span",{className:`
                      text-[0px] opacity-0
                      @sm:text-[0.3rem] @sm:opacity-100
                      @md:text-[0.5rem]
                      @lg:text-[0.7rem]
                      text-gray-700 leading-tight
                    `,children:w.num}),jsxRuntimeExports.jsx("span",{className:`
                      text-[0.55rem]
                      font-medium leading-none
                    `,style:{fontSize:"clamp(0.55rem, 2.5vw, 1.25rem)"},children:w.sym})]})})},w.sym))})})})}function QueryTextBox({value:i,onChange:n,placeholder:a="Enter filter",onSubmit:h,loading:m=!1}){return jsxRuntimeExports.jsx("div",{className:"space-y-2",children:jsxRuntimeExports.jsxs("form",{onSubmit:z=>{z.preventDefault(),h?.()},className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:i,onChange:z=>n(z.target.value),placeholder:a,className:"flex-1 p-2 border border-gray-300 rounded shadow focus:outline-none focus:ring-2 focus:ring-blue-500"}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-blue-500 text-white rounded shadow hover:bg-blue-600 disabled:opacity-50 hover:cursor-pointer",children:m?"Loading":"Submit"})]})})}var lib={},Range={},utils={},types={},hasRequiredTypes;function requireTypes(){if(hasRequiredTypes)return types;hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0}),types.Direction=void 0;var i;return(function(n){n.Right="to right",n.Left="to left",n.Down="to bottom",n.Up="to top"})(i||(types.Direction=i={})),types}var hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,(function(i){var n=utils&&utils.__spreadArray||function(ge,me,Me){if(Me||arguments.length===2)for(var ue=0,P=me.length,ce;ue<P;ue++)(ce||!(ue in me))&&(ce||(ce=Array.prototype.slice.call(me,0,ue)),ce[ue]=me[ue]);return ge.concat(ce||Array.prototype.slice.call(me))};Object.defineProperty(i,"__esModule",{value:!0}),i.isIOS=i.useThumbOverlap=i.assertUnreachable=i.voidFn=i.getTrackBackground=i.replaceAt=i.schd=i.translate=i.getClosestThumbIndex=i.translateThumbs=i.getPaddingAndBorder=i.getMargin=i.checkInitialOverlap=i.checkValuesAgainstBoundaries=i.checkBoundaries=i.isVertical=i.relativeValue=i.normalizeValue=i.isStepDivisible=i.isTouchEvent=i.getStepDecimals=void 0;var a=requireReact(),h=requireTypes(),m=function(ge){var me=ge.toString().split(".")[1];return me?me.length:0};i.getStepDecimals=m;function z(ge){return ge.touches&&ge.touches.length||ge.changedTouches&&ge.changedTouches.length}i.isTouchEvent=z;function u(ge,me,Me){var ue=(me-ge)/Me,P=8,ce=Number(ue.toFixed(P));return parseInt(ce.toString(),10)===ce}i.isStepDivisible=u;function y(ge,me,Me,ue,P,ce,se){var X=1e11;if(ge=Math.round(ge*X)/X,!ce){var Re=se[me-1],fe=se[me+1];if(Re&&Re>ge)return Re;if(fe&&fe<ge)return fe}if(ge>ue)return ue;if(ge<Me)return Me;var De=Math.floor(ge*X-Me*X)%Math.floor(P*X),We=Math.floor(ge*X-Math.abs(De)),oe=De===0?ge:We/X,Ae=Math.abs(De/X)<P/2?oe:oe+P,He=(0,i.getStepDecimals)(P);return parseFloat(Ae.toFixed(He))}i.normalizeValue=y;function p(ge,me,Me){return(ge-me)/(Me-me)}i.relativeValue=p;function w(ge){return ge===h.Direction.Up||ge===h.Direction.Down}i.isVertical=w;function M(ge,me,Me){if(me>=Me)throw new RangeError("min (".concat(me,") is equal/bigger than max (").concat(Me,")"));if(ge<me)throw new RangeError("value (".concat(ge,") is smaller than min (").concat(me,")"));if(ge>Me)throw new RangeError("value (".concat(ge,") is bigger than max (").concat(Me,")"))}i.checkBoundaries=M;function b(ge,me,Me){return ge<me?me:ge>Me?Me:ge}i.checkValuesAgainstBoundaries=b;function I(ge){if(!(ge.length<2)&&!ge.slice(1).every(function(me,Me){return ge[Me]<=me}))throw new RangeError("values={[".concat(ge,"]} needs to be sorted when allowOverlap={false}"))}i.checkInitialOverlap=I;function O(ge){var me=window.getComputedStyle(ge);return{top:parseInt(me["margin-top"],10),bottom:parseInt(me["margin-bottom"],10),left:parseInt(me["margin-left"],10),right:parseInt(me["margin-right"],10)}}i.getMargin=O;function T(ge){var me=window.getComputedStyle(ge);return{top:parseInt(me["padding-top"],10)+parseInt(me["border-top-width"],10),bottom:parseInt(me["padding-bottom"],10)+parseInt(me["border-bottom-width"],10),left:parseInt(me["padding-left"],10)+parseInt(me["border-left-width"],10),right:parseInt(me["padding-right"],10)+parseInt(me["border-right-width"],10)}}i.getPaddingAndBorder=T;function L(ge,me,Me){var ue=Me?-1:1;ge.forEach(function(P,ce){return ne(P,ue*me[ce].x,me[ce].y)})}i.translateThumbs=L;function Q(ge,me,Me,ue){for(var P=0,ce=Ce(ge[0],me,Me,ue),se=1;se<ge.length;se++){var X=Ce(ge[se],me,Me,ue);X<ce&&(ce=X,P=se)}return P}i.getClosestThumbIndex=Q;function ne(ge,me,Me){ge.style.transform="translate(".concat(me,"px, ").concat(Me,"px)")}i.translate=ne;var Z=function(ge){var me=[],Me=null,ue=function(){for(var P=[],ce=0;ce<arguments.length;ce++)P[ce]=arguments[ce];me=P,!Me&&(Me=requestAnimationFrame(function(){Me=null,ge.apply(void 0,me)}))};return ue};i.schd=Z;function _(ge,me,Me){var ue=ge.slice(0);return ue[me]=Me,ue}i.replaceAt=_;function F(ge){var me=ge.values,Me=ge.colors,ue=ge.min,P=ge.max,ce=ge.direction,se=ce===void 0?h.Direction.Right:ce,X=ge.rtl,Re=X===void 0?!1:X;Re&&se===h.Direction.Right?se=h.Direction.Left:Re&&h.Direction.Left&&(se=h.Direction.Right);var fe=me.slice(0).sort(function(We,oe){return We-oe}).map(function(We){return(We-ue)/(P-ue)*100}),De=fe.reduce(function(We,oe,Ae){return"".concat(We,", ").concat(Me[Ae]," ").concat(oe,"%, ").concat(Me[Ae+1]," ").concat(oe,"%")},"");return"linear-gradient(".concat(se,", ").concat(Me[0]," 0%").concat(De,", ").concat(Me[Me.length-1]," 100%)")}i.getTrackBackground=F;function j(){}i.voidFn=j;function G(ge){throw new Error("Didn't expect to get here")}i.assertUnreachable=G;var q=function(ge,me,Me,ue,P){P===void 0&&(P=function(se){return se});var ce=Math.ceil(n([ge],Array.from(ge.children),!0).reduce(function(se,X){var Re=Math.ceil(X.getBoundingClientRect().width);if(X.innerText&&X.innerText.includes(Me)&&X.childElementCount===0){var fe=X.cloneNode(!0);fe.innerHTML=P(me.toFixed(ue)),fe.style.visibility="hidden",document.body.appendChild(fe),Re=Math.ceil(fe.getBoundingClientRect().width),document.body.removeChild(fe)}return Re>se?Re:se},ge.getBoundingClientRect().width));return ce},N=function(ge,me,Me,ue,P,ce,se){se===void 0&&(se=function(fe){return fe});var X=[],Re=function(fe){var De=q(Me[fe],ue[fe],P,ce,se),We=me[fe].x;me.forEach(function(oe,Ae){var He=oe.x,Ue=q(Me[Ae],ue[Ae],P,ce,se);fe!==Ae&&(We>=He&&We<=He+Ue||We+De>=He&&We+De<=He+Ue)&&(X.includes(Ae)||(X.push(fe),X.push(Ae),X=n(n([],X,!0),[fe,Ae],!1),Re(Ae)))})};return Re(ge),Array.from(new Set(X.sort()))},ee=function(ge,me,Me,ue,P,ce){ue===void 0&&(ue=.1),P===void 0&&(P=" - "),ce===void 0&&(ce=function(Ae){return Ae});var se=(0,i.getStepDecimals)(ue),X=(0,a.useState)({}),Re=X[0],fe=X[1],De=(0,a.useState)(ce(me[Me].toFixed(se))),We=De[0],oe=De[1];return(0,a.useEffect)(function(){if(ge){var Ae=ge.getThumbs();if(Ae.length<1)return;var He={},Ue=ge.getOffsets(),Ie=N(Me,Ue,Ae,me,P,se,ce),rt=ce(me[Me].toFixed(se));if(Ie.length){var st=Ie.reduce(function(ar,kr,Ar,pr){return ar.length?n(n([],ar,!0),[Ue[pr[Ar]].x],!1):[Ue[pr[Ar]].x]},[]);if(Math.min.apply(Math,st)===Ue[Me].x){var at=[];Ie.forEach(function(ar){at.push(me[ar].toFixed(se))}),rt=Array.from(new Set(at.sort(function(ar,kr){return parseFloat(ar)-parseFloat(kr)}))).map(ce).join(P);var Ft=Math.min.apply(Math,st),Ct=Math.max.apply(Math,st),or=Ae[Ie[st.indexOf(Ct)]].getBoundingClientRect().width;He.left="".concat(Math.abs(Ft-(Ct+or))/2,"px"),He.transform="translate(-50%, 0)"}else He.visibility="hidden"}oe(rt),fe(He)}},[ge,me]),[We,Re]};i.useThumbOverlap=ee;function Ce(ge,me,Me,ue){var P=ge.getBoundingClientRect(),ce=P.left,se=P.top,X=P.width,Re=P.height;return w(ue)?Math.abs(Me-(se+Re/2)):Math.abs(me-(ce+X/2))}var he=function(){var ge,me=((ge=navigator.userAgentData)===null||ge===void 0?void 0:ge.platform)||navigator.platform;return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(me)||navigator.userAgent.includes("Mac")&&"ontouchend"in document};i.isIOS=he})(utils)),utils}var hasRequiredRange;function requireRange(){if(hasRequiredRange)return Range;hasRequiredRange=1;var i=Range&&Range.__extends||(function(){var b=function(I,O){return b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,L){T.__proto__=L}||function(T,L){for(var Q in L)Object.prototype.hasOwnProperty.call(L,Q)&&(T[Q]=L[Q])},b(I,O)};return function(I,O){if(typeof O!="function"&&O!==null)throw new TypeError("Class extends value "+String(O)+" is not a constructor or null");b(I,O);function T(){this.constructor=I}I.prototype=O===null?Object.create(O):(T.prototype=O.prototype,new T)}})(),n=Range&&Range.__createBinding||(Object.create?(function(b,I,O,T){T===void 0&&(T=O);var L=Object.getOwnPropertyDescriptor(I,O);(!L||("get"in L?!I.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return I[O]}}),Object.defineProperty(b,T,L)}):(function(b,I,O,T){T===void 0&&(T=O),b[T]=I[O]})),a=Range&&Range.__setModuleDefault||(Object.create?(function(b,I){Object.defineProperty(b,"default",{enumerable:!0,value:I})}):function(b,I){b.default=I}),h=Range&&Range.__importStar||function(b){if(b&&b.__esModule)return b;var I={};if(b!=null)for(var O in b)O!=="default"&&Object.prototype.hasOwnProperty.call(b,O)&&n(I,b,O);return a(I,b),I},m=Range&&Range.__spreadArray||function(b,I,O){if(O||arguments.length===2)for(var T=0,L=I.length,Q;T<L;T++)(Q||!(T in I))&&(Q||(Q=Array.prototype.slice.call(I,0,T)),Q[T]=I[T]);return b.concat(Q||Array.prototype.slice.call(I))};Object.defineProperty(Range,"__esModule",{value:!0});var z=h(requireReact()),u=requireUtils(),y=requireTypes(),p=["ArrowRight","ArrowUp","k","PageUp"],w=["ArrowLeft","ArrowDown","j","PageDown"],M=(function(b){i(I,b);function I(O){var T=b.call(this,O)||this;if(T.trackRef=z.createRef(),T.thumbRefs=[],T.state={draggedTrackPos:[-1,-1],draggedThumbIndex:-1,thumbZIndexes:new Array(T.props.values.length).fill(0).map(function(L,Q){return Q}),isChanged:!1,markOffsets:[]},T.getOffsets=function(){var L=T.props,Q=L.direction,ne=L.values,Z=L.min,_=L.max,F=T.trackRef.current;if(!F)return console.warn("No track element found."),[];var j=F.getBoundingClientRect(),G=(0,u.getPaddingAndBorder)(F);return T.getThumbs().map(function(q,N){var ee={x:0,y:0},Ce=q.getBoundingClientRect(),he=(0,u.getMargin)(q);switch(Q){case y.Direction.Right:return ee.x=(he.left+G.left)*-1,ee.y=((Ce.height-j.height)/2+G.top)*-1,ee.x+=j.width*(0,u.relativeValue)(ne[N],Z,_)-Ce.width/2,ee;case y.Direction.Left:return ee.x=(he.right+G.right)*-1,ee.y=((Ce.height-j.height)/2+G.top)*-1,ee.x+=j.width-j.width*(0,u.relativeValue)(ne[N],Z,_)-Ce.width/2,ee;case y.Direction.Up:return ee.x=((Ce.width-j.width)/2+he.left+G.left)*-1,ee.y=-G.left,ee.y+=j.height-j.height*(0,u.relativeValue)(ne[N],Z,_)-Ce.height/2,ee;case y.Direction.Down:return ee.x=((Ce.width-j.width)/2+he.left+G.left)*-1,ee.y=-G.left,ee.y+=j.height*(0,u.relativeValue)(ne[N],Z,_)-Ce.height/2,ee;default:return(0,u.assertUnreachable)(Q)}})},T.getThumbs=function(){return T.trackRef&&T.trackRef.current?Array.from(T.trackRef.current.children).filter(function(L){return L.hasAttribute("aria-valuenow")}):(console.warn("No thumbs found in the track container. Did you forget to pass & spread the `props` param in renderTrack?"),[])},T.getTargetIndex=function(L){return T.getThumbs().findIndex(function(Q){return Q===L.target||Q.contains(L.target)})},T.addTouchEvents=function(L){document.addEventListener("touchmove",T.schdOnTouchMove,{passive:!1}),document.addEventListener("touchend",T.schdOnEnd,{passive:!1}),document.addEventListener("touchcancel",T.schdOnEnd,{passive:!1})},T.addMouseEvents=function(L){document.addEventListener("mousemove",T.schdOnMouseMove),document.addEventListener("mouseup",T.schdOnEnd)},T.onMouseDownTrack=function(L){var Q;if(!(L.button!==0||(0,u.isIOS)()))if(L.persist(),L.preventDefault(),T.addMouseEvents(L.nativeEvent),T.props.values.length>1&&T.props.draggableTrack){if(T.thumbRefs.some(function(Z){var _;return(_=Z.current)===null||_===void 0?void 0:_.contains(L.target)}))return;T.setState({draggedTrackPos:[L.clientX,L.clientY]},function(){return T.onMove(L.clientX,L.clientY)})}else{var ne=(0,u.getClosestThumbIndex)(T.thumbRefs.map(function(Z){return Z.current}),L.clientX,L.clientY,T.props.direction);(Q=T.thumbRefs[ne].current)===null||Q===void 0||Q.focus(),T.setState({draggedThumbIndex:ne},function(){return T.onMove(L.clientX,L.clientY)})}},T.onResize=function(){(0,u.translateThumbs)(T.getThumbs(),T.getOffsets(),T.props.rtl),T.calculateMarkOffsets()},T.onTouchStartTrack=function(L){var Q;if(L.persist(),T.addTouchEvents(L.nativeEvent),T.props.values.length>1&&T.props.draggableTrack){if(T.thumbRefs.some(function(Z){var _;return(_=Z.current)===null||_===void 0?void 0:_.contains(L.target)}))return;T.setState({draggedTrackPos:[L.touches[0].clientX,L.touches[0].clientY]},function(){return T.onMove(L.touches[0].clientX,L.touches[0].clientY)})}else{var ne=(0,u.getClosestThumbIndex)(T.thumbRefs.map(function(Z){return Z.current}),L.touches[0].clientX,L.touches[0].clientY,T.props.direction);(Q=T.thumbRefs[ne].current)===null||Q===void 0||Q.focus(),T.setState({draggedThumbIndex:ne},function(){return T.onMove(L.touches[0].clientX,L.touches[0].clientY)})}},T.onMouseOrTouchStart=function(L){if(!T.props.disabled){var Q=(0,u.isTouchEvent)(L);if(!(!Q&&L.button!==0)){var ne=T.getTargetIndex(L);ne!==-1&&(Q?T.addTouchEvents(L):T.addMouseEvents(L),T.setState({draggedThumbIndex:ne,thumbZIndexes:T.state.thumbZIndexes.map(function(Z,_){return _===ne?Math.max.apply(Math,T.state.thumbZIndexes):Z<=T.state.thumbZIndexes[ne]?Z:Z-1})}))}}},T.onMouseMove=function(L){L.preventDefault(),T.onMove(L.clientX,L.clientY)},T.onTouchMove=function(L){L.preventDefault(),T.onMove(L.touches[0].clientX,L.touches[0].clientY)},T.onKeyDown=function(L){var Q=T.props,ne=Q.values,Z=Q.onChange,_=Q.step,F=Q.rtl,j=Q.direction,G=T.state.isChanged,q=T.getTargetIndex(L.nativeEvent),N=F||j===y.Direction.Left||j===y.Direction.Down?-1:1;q!==-1&&(p.includes(L.key)?(L.preventDefault(),T.setState({draggedThumbIndex:q,isChanged:!0}),Z((0,u.replaceAt)(ne,q,T.normalizeValue(ne[q]+N*(L.key==="PageUp"?_*10:_),q)))):w.includes(L.key)?(L.preventDefault(),T.setState({draggedThumbIndex:q,isChanged:!0}),Z((0,u.replaceAt)(ne,q,T.normalizeValue(ne[q]-N*(L.key==="PageDown"?_*10:_),q)))):L.key==="Tab"?T.setState({draggedThumbIndex:-1},function(){G&&T.fireOnFinalChange()}):G&&T.fireOnFinalChange())},T.onKeyUp=function(L){var Q=T.state.isChanged;T.setState({draggedThumbIndex:-1},function(){Q&&T.fireOnFinalChange()})},T.onMove=function(L,Q){var ne=T.state,Z=ne.draggedThumbIndex,_=ne.draggedTrackPos,F=T.props,j=F.direction,G=F.min,q=F.max,N=F.onChange,ee=F.values,Ce=F.step,he=F.rtl;if(Z===-1&&_[0]===-1&&_[1]===-1)return null;var ge=T.trackRef.current;if(!ge)return null;var me=ge.getBoundingClientRect(),Me=(0,u.isVertical)(j)?me.height:me.width;if(_[0]!==-1&&_[1]!==-1){var ue=L-_[0],P=Q-_[1],ce=0;switch(j){case y.Direction.Right:case y.Direction.Left:ce=ue/Me*(q-G);break;case y.Direction.Down:case y.Direction.Up:ce=P/Me*(q-G);break;default:(0,u.assertUnreachable)(j)}if(he&&(ce*=-1),Math.abs(ce)>=Ce/2){for(var se=0;se<T.thumbRefs.length;se++){if(ee[se]===q&&Math.sign(ce)===1||ee[se]===G&&Math.sign(ce)===-1)return;var X=ee[se]+ce;X>q?ce=q-ee[se]:X<G&&(ce=G-ee[se])}for(var Re=ee.slice(0),se=0;se<T.thumbRefs.length;se++)Re=(0,u.replaceAt)(Re,se,T.normalizeValue(ee[se]+ce,se));T.setState({draggedTrackPos:[L,Q]}),N(Re)}}else{var fe=0;switch(j){case y.Direction.Right:fe=(L-me.left)/Me*(q-G)+G;break;case y.Direction.Left:fe=(Me-(L-me.left))/Me*(q-G)+G;break;case y.Direction.Down:fe=(Q-me.top)/Me*(q-G)+G;break;case y.Direction.Up:fe=(Me-(Q-me.top))/Me*(q-G)+G;break;default:(0,u.assertUnreachable)(j)}he&&(fe=q+G-fe),Math.abs(ee[Z]-fe)>=Ce/2&&N((0,u.replaceAt)(ee,Z,T.normalizeValue(fe,Z)))}},T.normalizeValue=function(L,Q){var ne=T.props,Z=ne.min,_=ne.max,F=ne.step,j=ne.allowOverlap,G=ne.values;return(0,u.normalizeValue)(L,Q,Z,_,F,j,G)},T.onEnd=function(L){if(L.preventDefault(),document.removeEventListener("mousemove",T.schdOnMouseMove),document.removeEventListener("touchmove",T.schdOnTouchMove),document.removeEventListener("mouseup",T.schdOnEnd),document.removeEventListener("touchend",T.schdOnEnd),document.removeEventListener("touchcancel",T.schdOnEnd),T.state.draggedThumbIndex===-1&&T.state.draggedTrackPos[0]===-1&&T.state.draggedTrackPos[1]===-1)return null;T.setState({draggedThumbIndex:-1,draggedTrackPos:[-1,-1]},function(){T.fireOnFinalChange()})},T.fireOnFinalChange=function(){T.setState({isChanged:!1});var L=T.props,Q=L.onFinalChange,ne=L.values;Q&&Q(ne)},T.updateMarkRefs=function(L){if(!L.renderMark){T.numOfMarks=void 0,T.markRefs=void 0;return}T.numOfMarks=(L.max-L.min)/T.props.step,T.markRefs=[];for(var Q=0;Q<T.numOfMarks+1;Q++)T.markRefs[Q]=z.createRef()},T.calculateMarkOffsets=function(){if(!(!T.props.renderMark||!T.trackRef||!T.numOfMarks||!T.markRefs||T.trackRef.current===null)){for(var L=window.getComputedStyle(T.trackRef.current),Q=parseInt(L.width,10),ne=parseInt(L.height,10),Z=parseInt(L.paddingLeft,10),_=parseInt(L.paddingTop,10),F=[],j=0;j<T.numOfMarks+1;j++){var G=9999,q=9999;if(T.markRefs[j].current){var N=T.markRefs[j].current.getBoundingClientRect();G=N.height,q=N.width}T.props.direction===y.Direction.Left||T.props.direction===y.Direction.Right?F.push([Math.round(Q/T.numOfMarks*j+Z-q/2),-Math.round((G-ne)/2)]):F.push([Math.round(ne/T.numOfMarks*j+_-G/2),-Math.round((q-Q)/2)])}T.setState({markOffsets:F})}},O.step===0)throw new Error('"step" property should be a positive number');return T.schdOnMouseMove=(0,u.schd)(T.onMouseMove),T.schdOnTouchMove=(0,u.schd)(T.onTouchMove),T.schdOnEnd=(0,u.schd)(T.onEnd),T.thumbRefs=O.values.map(function(){return z.createRef()}),T.updateMarkRefs(O),T}return I.prototype.componentDidMount=function(){var O=this,T=this.props,L=T.values,Q=T.min,ne=T.step;this.resizeObserver=window.ResizeObserver?new window.ResizeObserver(this.onResize):{observe:function(){return window.addEventListener("resize",O.onResize)},unobserve:function(){return window.removeEventListener("resize",O.onResize)}},document.addEventListener("touchstart",this.onMouseOrTouchStart,{passive:!1}),document.addEventListener("mousedown",this.onMouseOrTouchStart,{passive:!1}),!this.props.allowOverlap&&(0,u.checkInitialOverlap)(this.props.values),this.props.values.forEach(function(Z){return(0,u.checkBoundaries)(Z,O.props.min,O.props.max)}),this.resizeObserver.observe(this.trackRef.current),(0,u.translateThumbs)(this.getThumbs(),this.getOffsets(),this.props.rtl),this.calculateMarkOffsets(),L.forEach(function(Z){(0,u.isStepDivisible)(Q,Z,ne)||console.warn("The `values` property is in conflict with the current `step`, `min`, and `max` properties. Please provide values that are accessible using the min, max, and step values.")})},I.prototype.componentDidUpdate=function(O,T){var L=this.props,Q=L.max,ne=L.min,Z=L.step,_=L.values,F=L.rtl;(O.max!==Q||O.min!==ne||O.step!==Z)&&this.updateMarkRefs(this.props),(0,u.translateThumbs)(this.getThumbs(),this.getOffsets(),F),(O.max!==Q||O.min!==ne||O.step!==Z||T.markOffsets.length!==this.state.markOffsets.length)&&(this.calculateMarkOffsets(),_.forEach(function(j){(0,u.isStepDivisible)(ne,j,Z)||console.warn("The `values` property is in conflict with the current `step`, `min`, and `max` properties. Please provide values that are accessible using the min, max, and step values.")}))},I.prototype.componentWillUnmount=function(){var O={passive:!1};document.removeEventListener("mousedown",this.onMouseOrTouchStart,O),document.removeEventListener("mousemove",this.schdOnMouseMove),document.removeEventListener("touchmove",this.schdOnTouchMove),document.removeEventListener("touchstart",this.onMouseOrTouchStart),document.removeEventListener("mouseup",this.schdOnEnd),document.removeEventListener("touchend",this.schdOnEnd),this.resizeObserver.unobserve(this.trackRef.current)},I.prototype.render=function(){var O=this,T=this.props,L=T.label,Q=T.labelledBy,ne=T.renderTrack,Z=T.renderThumb,_=T.renderMark,F=_===void 0?function(){return null}:_,j=T.values,G=T.min,q=T.max,N=T.allowOverlap,ee=T.disabled,Ce=this.state,he=Ce.draggedThumbIndex,ge=Ce.thumbZIndexes,me=Ce.markOffsets;return ne({props:{style:{transform:"scale(1)",cursor:he>-1?"grabbing":this.props.draggableTrack?(0,u.isVertical)(this.props.direction)?"ns-resize":"ew-resize":j.length===1&&!ee?"pointer":"inherit"},onMouseDown:ee?u.voidFn:this.onMouseDownTrack,onTouchStart:ee?u.voidFn:this.onTouchStartTrack,ref:this.trackRef},isDragged:this.state.draggedThumbIndex>-1,disabled:ee,children:m(m([],me.map(function(Me,ue,P){return F({props:{style:O.props.direction===y.Direction.Left||O.props.direction===y.Direction.Right?{position:"absolute",left:"".concat(Me[0],"px"),marginTop:"".concat(Me[1],"px")}:{position:"absolute",top:"".concat(Me[0],"px"),marginLeft:"".concat(Me[1],"px")},key:"mark".concat(ue),ref:O.markRefs[ue]},index:ue})}),!0),j.map(function(Me,ue){var P=O.state.draggedThumbIndex===ue;return Z({index:ue,value:Me,isDragged:P,props:{style:{position:"absolute",zIndex:ge[ue],cursor:ee?"inherit":P?"grabbing":"grab",userSelect:"none",touchAction:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},key:ue,tabIndex:ee?void 0:0,"aria-valuemax":N?q:j[ue+1]||q,"aria-valuemin":N?G:j[ue-1]||G,"aria-valuenow":Me,draggable:!1,ref:O.thumbRefs[ue],"aria-label":L,"aria-labelledby":Q,role:"slider",onKeyDown:ee?u.voidFn:O.onKeyDown,onKeyUp:ee?u.voidFn:O.onKeyUp}})}),!0)})},I.defaultProps={label:"Accessibility label",labelledBy:null,step:1,direction:y.Direction.Right,rtl:!1,disabled:!1,allowOverlap:!1,draggableTrack:!1,min:0,max:100},I})(z.Component);return Range.default=M,Range}var hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,(function(i){var n=lib&&lib.__importDefault||function(z){return z&&z.__esModule?z:{default:z}};Object.defineProperty(i,"__esModule",{value:!0}),i.checkValuesAgainstBoundaries=i.relativeValue=i.useThumbOverlap=i.Direction=i.getTrackBackground=i.Range=void 0;var a=n(requireRange());i.Range=a.default;var h=requireUtils();Object.defineProperty(i,"getTrackBackground",{enumerable:!0,get:function(){return h.getTrackBackground}}),Object.defineProperty(i,"useThumbOverlap",{enumerable:!0,get:function(){return h.useThumbOverlap}}),Object.defineProperty(i,"relativeValue",{enumerable:!0,get:function(){return h.relativeValue}}),Object.defineProperty(i,"checkValuesAgainstBoundaries",{enumerable:!0,get:function(){return h.checkValuesAgainstBoundaries}});var m=requireTypes();Object.defineProperty(i,"Direction",{enumerable:!0,get:function(){return m.Direction}})})(lib)),lib}var libExports=requireLib();function RangeSlider({title:i,value:n,onChange:a,min:h,max:m}){return jsxRuntimeExports.jsxs("div",{className:"my-4 text-sm md:text-base",children:[jsxRuntimeExports.jsx("label",{className:"block font mb-1",children:i}),jsxRuntimeExports.jsx(libExports.Range,{step:1,min:h,max:m,values:n,onChange:a,renderTrack:({props:z,children:u})=>jsxRuntimeExports.jsxs("div",{...z,className:"w-full h-2 bg-gray-300 rounded relative",children:[jsxRuntimeExports.jsx("div",{className:"absolute h-2 bg-blue-500 rounded",style:{left:`${(n[0]-h)/(m-h)*100}%`,width:`${(n[1]-n[0])/(m-h)*100}%`}}),u]}),renderThumb:({props:z})=>jsxRuntimeExports.jsx("div",{...z,className:"w-5 h-5 bg-white border border-gray-500 rounded-full"})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs md:text-sm pt-2",children:[jsxRuntimeExports.jsx("span",{children:n[0]}),jsxRuntimeExports.jsx("span",{children:n[1]})]})]})}function buildQueryString(i,n,a,h,m){const z=[],u=[],y=[];for(const[p,w]of Object.entries(a))w===1&&u.push(p),w===2&&y.push(p);return y.length&&z.push(`NOT elements HAS ANY ${y.map(p=>`"${p}"`).join(", ")}`),u.length&&z.push(`elements HAS ALL ${u.map(p=>`"${p}"`).join(", ")}`),h[0]!==i[0]&&z.push(`nelements>=${h[0]}`),h[1]!==i[1]&&z.push(`nelements<=${h[1]}`),m[0]!==n[0]&&z.push(`nsites>=${m[0]}`),m[1]!==n[1]&&z.push(`nsites<=${m[1]}`),z.join(" AND ")}function OptimadeFilters({initialFilter:i,onSubmit:n}){const[a,h]=reactExports.useState([1,118]),[m,z]=reactExports.useState([1,1e3]),[u,y]=reactExports.useState({}),[p,w]=reactExports.useState(!1),[M,b]=reactExports.useState(i||""),I=buildQueryString([1,118],[1,1e3],u,a,m),O=p?M:I,T=()=>{n(O)},L=()=>{w(Q=>!Q),p||(b(I),y({}),h([1,118]),z([1,1e3]))};return reactExports.useEffect(()=>{i&&b(i)},[i]),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:p?"opacity-50 pointer-events-none":"",children:[jsxRuntimeExports.jsx(PTable,{selected:u,onSelectionChange:Q=>y(ne=>({...ne,...Q}))}),jsxRuntimeExports.jsx(RangeSlider,{title:"Number of atoms",value:a,onChange:h,min:1,max:118}),jsxRuntimeExports.jsx(RangeSlider,{title:"Number of sites",value:m,onChange:z,min:0,max:1e3})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("input",{id:"manual-mode-toggle",type:"checkbox",checked:p,onChange:L,className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),jsxRuntimeExports.jsx("label",{htmlFor:"manual-mode-toggle",className:"text-sm text-gray-700 select-none",children:"Unlock custom query"})]}),jsxRuntimeExports.jsx("div",{className:"pb-4 text-sm md:text-base",children:jsxRuntimeExports.jsx(QueryTextBox,{value:O,onChange:p?b:()=>{},onSubmit:T,placeholder:"Enter OPTIMADE filter"})})]})}const isBoolean=i=>typeof i=="boolean"||i instanceof Boolean,isNumber=i=>typeof i=="number"||i instanceof Number,isBigInt=i=>typeof i=="bigint"||i instanceof BigInt,isDate=i=>!!i&&i instanceof Date,isString=i=>typeof i=="string"||i instanceof String,isArray=i=>Array.isArray(i),isObject$1=i=>typeof i=="object"&&i!==null,isFunction=i=>!!i&&i instanceof Object&&typeof i=="function";function quoteString(i,n){return n===void 0&&(n=!1),!i||n?`"${i}"`:i}function quoteStringValue(i,n,a){return a?JSON.stringify(i):n?`"${i}"`:i}function ExpandableObject(i){let{field:n,value:a,data:h,lastElement:m,openBracket:z,closeBracket:u,level:y,style:p,shouldExpandNode:w,clickToExpandNode:M,outerRef:b,beforeExpandChange:I}=i;const O=reactExports.useRef(!1),[T,L]=reactExports.useState(()=>w(y,a,n)),Q=reactExports.useRef(null);reactExports.useEffect(()=>{O.current?L(w(y,a,n)):O.current=!0},[w]);const ne=reactExports.useId();if(h.length===0)return EmptyObject({field:n,openBracket:z,closeBracket:u,lastElement:m,style:p});const Z=T?p.collapseIcon:p.expandIcon,_=T?p.ariaLables.collapseJson:p.ariaLables.expandJson,F=y+1,j=h.length-1,G=ee=>{T!==ee&&(!I||I({level:y,value:a,field:n,newExpandValue:ee}))&&L(ee)},q=ee=>{if(ee.key==="ArrowRight"||ee.key==="ArrowLeft")ee.preventDefault(),G(ee.key==="ArrowRight");else if(ee.key==="ArrowUp"||ee.key==="ArrowDown"){ee.preventDefault();const Ce=ee.key==="ArrowUp"?-1:1;if(!b.current)return;const he=b.current.querySelectorAll("[role=button]");let ge=-1;for(let Me=0;Me<he.length;Me++)if(he[Me].tabIndex===0){ge=Me;break}if(ge<0)return;const me=(ge+Ce+he.length)%he.length;he[ge].tabIndex=-1,he[me].tabIndex=0,he[me].focus()}},N=()=>{var ee;G(!T);const Ce=Q.current;if(!Ce)return;const he=(ee=b.current)===null||ee===void 0?void 0:ee.querySelector('[role=button][tabindex="0"]');he&&(he.tabIndex=-1),Ce.tabIndex=0,Ce.focus()};return reactExports.createElement("div",{className:p.basicChildStyle,role:"treeitem","aria-expanded":T,"aria-selected":void 0},reactExports.createElement("span",{className:Z,onClick:N,onKeyDown:q,role:"button","aria-label":_,"aria-expanded":T,"aria-controls":T?ne:void 0,ref:Q,tabIndex:y===0?0:-1}),(n||n==="")&&(M?reactExports.createElement("span",{className:p.clickableLabel,onClick:N,onKeyDown:q},quoteString(n,p.quotesForFieldNames),":"):reactExports.createElement("span",{className:p.label},quoteString(n,p.quotesForFieldNames),":")),reactExports.createElement("span",{className:p.punctuation},z),T?reactExports.createElement("ul",{id:ne,role:"group",className:p.childFieldsContainer},h.map((ee,Ce)=>reactExports.createElement(DataRender,{key:ee[0]||Ce,field:ee[0],value:ee[1],style:p,lastElement:Ce===j,level:F,shouldExpandNode:w,clickToExpandNode:M,beforeExpandChange:I,outerRef:b}))):reactExports.createElement("span",{className:p.collapsedContent,onClick:N,onKeyDown:q}),reactExports.createElement("span",{className:p.punctuation},u),!m&&reactExports.createElement("span",{className:p.punctuation},","))}function EmptyObject(i){let{field:n,openBracket:a,closeBracket:h,lastElement:m,style:z}=i;return reactExports.createElement("div",{className:z.basicChildStyle,role:"treeitem","aria-selected":void 0},(n||n==="")&&reactExports.createElement("span",{className:z.label},quoteString(n,z.quotesForFieldNames),":"),reactExports.createElement("span",{className:z.punctuation},a),reactExports.createElement("span",{className:z.punctuation},h),!m&&reactExports.createElement("span",{className:z.punctuation},","))}function JsonObject(i){let{field:n,value:a,style:h,lastElement:m,shouldExpandNode:z,clickToExpandNode:u,level:y,outerRef:p,beforeExpandChange:w}=i;return ExpandableObject({field:n,value:a,lastElement:m||!1,level:y,openBracket:"{",closeBracket:"}",style:h,shouldExpandNode:z,clickToExpandNode:u,data:Object.keys(a).map(M=>[M,a[M]]),outerRef:p,beforeExpandChange:w})}function JsonArray(i){let{field:n,value:a,style:h,lastElement:m,level:z,shouldExpandNode:u,clickToExpandNode:y,outerRef:p,beforeExpandChange:w}=i;return ExpandableObject({field:n,value:a,lastElement:m||!1,level:z,openBracket:"[",closeBracket:"]",style:h,shouldExpandNode:u,clickToExpandNode:y,data:a.map(M=>[void 0,M]),outerRef:p,beforeExpandChange:w})}function JsonPrimitiveValue(i){let{field:n,value:a,style:h,lastElement:m}=i,z,u=h.otherValue;return a===null?(z="null",u=h.nullValue):a===void 0?(z="undefined",u=h.undefinedValue):isString(a)?(z=quoteStringValue(a,!h.noQuotesForStringValues,h.stringifyStringValues),u=h.stringValue):isBoolean(a)?(z=a?"true":"false",u=h.booleanValue):isNumber(a)?(z=a.toString(),u=h.numberValue):isBigInt(a)?(z=`${a.toString()}n`,u=h.numberValue):isDate(a)?z=a.toISOString():isFunction(a)?z="function() { }":z=a.toString(),reactExports.createElement("div",{className:h.basicChildStyle,role:"treeitem","aria-selected":void 0},(n||n==="")&&reactExports.createElement("span",{className:h.label},quoteString(n,h.quotesForFieldNames),":"),reactExports.createElement("span",{className:u},z),!m&&reactExports.createElement("span",{className:h.punctuation},","))}function DataRender(i){const n=i.value;return isArray(n)?reactExports.createElement(JsonArray,Object.assign({},i)):isObject$1(n)&&!isDate(n)&&!isFunction(n)?reactExports.createElement(JsonObject,Object.assign({},i)):reactExports.createElement(JsonPrimitiveValue,Object.assign({},i))}var styles={"container-light":"_2IvMF _GzYRV","basic-element-style":"_2bkNM","child-fields-container":"_1BXBN","label-light":"_1MGIk","clickable-label-light":"_2YKJg _1MGIk _1MFti","punctuation-light":"_3uHL6 _3eOF8","value-null-light":"_2T6PJ","value-undefined-light":"_1Gho6","value-string-light":"_vGjyY","value-number-light":"_1bQdo","value-boolean-light":"_3zQKs","value-other-light":"_1xvuR","collapse-icon-light":"_oLqym _f10Tu _1MFti _1LId0","expand-icon-light":"_2AXVT _f10Tu _1MFti _1UmXx","collapsed-content-light":"_2KJWg _1pNG9 _1MFti"};const defaultAriaLables={collapseJson:"collapse JSON",expandJson:"expand JSON"},defaultStyles={container:styles["container-light"],basicChildStyle:styles["basic-element-style"],childFieldsContainer:styles["child-fields-container"],label:styles["label-light"],clickableLabel:styles["clickable-label-light"],nullValue:styles["value-null-light"],undefinedValue:styles["value-undefined-light"],stringValue:styles["value-string-light"],booleanValue:styles["value-boolean-light"],numberValue:styles["value-number-light"],otherValue:styles["value-other-light"],punctuation:styles["punctuation-light"],collapseIcon:styles["collapse-icon-light"],expandIcon:styles["expand-icon-light"],collapsedContent:styles["collapsed-content-light"],noQuotesForStringValues:!1,quotesForFieldNames:!1,ariaLables:defaultAriaLables,stringifyStringValues:!1},allExpanded=()=>!0,JsonView=i=>{let{data:n,style:a=defaultStyles,shouldExpandNode:h=allExpanded,clickToExpandNode:m=!1,beforeExpandChange:z,compactTopLevel:u,...y}=i;const p=reactExports.useRef(null);return reactExports.createElement("div",Object.assign({"aria-label":"JSON view"},y,{className:a.container,ref:p,role:"tree"}),u&&isObject$1(n)?Object.entries(n).map(w=>{let[M,b]=w;return reactExports.createElement(DataRender,{key:M,field:M,value:b,style:{...defaultStyles,...a},lastElement:!0,level:1,shouldExpandNode:h,clickToExpandNode:m,beforeExpandChange:z,outerRef:p})}):reactExports.createElement(DataRender,{value:n,style:{...defaultStyles,...a},lastElement:!0,level:0,shouldExpandNode:h,clickToExpandNode:m,outerRef:p,beforeExpandChange:z}))},ControlBox=({viewerParams:i,onViewerParamChange:n,onViewerEvent:a})=>{const h=(u,y)=>{let p=i.supercell;p[u]=parseInt(y),n("supercell",p)},m=u=>{n(u,!i[u])},z=u=>{a("camera",u)};return jsxRuntimeExports.jsxs("div",{className:"control-box",children:[jsxRuntimeExports.jsxs("div",{className:"control-box-row",children:[jsxRuntimeExports.jsxs("div",{className:"supercell-container",children:[jsxRuntimeExports.jsx("label",{children:"Supercell: "}),jsxRuntimeExports.jsx("div",{style:{display:"flex"},children:[0,1,2].map(u=>jsxRuntimeExports.jsx("input",{className:"supercell-input",type:"number",min:"1",max:"99",value:i.supercell[u],onChange:y=>h(u,y.target.value)},u))})]}),jsxRuntimeExports.jsxs("div",{className:"camera-controls",children:[jsxRuntimeExports.jsx("label",{children:"Camera: "}),jsxRuntimeExports.jsx("button",{className:"camera-button",onClick:()=>z("x"),children:"x"}),jsxRuntimeExports.jsx("button",{className:"camera-button",onClick:()=>z("y"),children:"y"}),jsxRuntimeExports.jsx("button",{className:"camera-button",onClick:()=>z("z"),children:"z"})]})]}),jsxRuntimeExports.jsxs("div",{className:"control-box-row",style:{display:"flex"},children:[jsxRuntimeExports.jsxs("label",{className:"option-checkbox",children:[jsxRuntimeExports.jsx("input",{className:"control-box-input",type:"checkbox",checked:i.bonds,onChange:()=>m("bonds")}),jsxRuntimeExports.jsx("span",{children:"Bonds"})]}),jsxRuntimeExports.jsxs("label",{className:"option-checkbox",children:[jsxRuntimeExports.jsx("input",{className:"control-box-input",type:"checkbox",checked:i.packedCell,onChange:()=>m("packedCell")}),jsxRuntimeExports.jsx("span",{children:"Packed cell"})]}),jsxRuntimeExports.jsxs("label",{className:"option-checkbox",children:[jsxRuntimeExports.jsx("input",{className:"control-box-input",type:"checkbox",checked:i.atomLabels,onChange:()=>m("atomLabels")}),jsxRuntimeExports.jsx("span",{children:"Atom labels"})]}),jsxRuntimeExports.jsxs("label",{className:"option-checkbox",children:[jsxRuntimeExports.jsx("input",{className:"control-box-input",type:"checkbox",checked:i.spaceFilling,onChange:()=>m("vdwRadius")}),jsxRuntimeExports.jsx("span",{children:"vdW radius"})]})]})]})};var _3DmolMin={exports:{}};/*! For license information please see 3Dmol-min.js.LICENSE.txt */var hasRequired_3DmolMin;function require_3DmolMin(){return hasRequired_3DmolMin||(hasRequired_3DmolMin=1,(function(module,exports){var factory;factory=()=>(()=>{var __webpack_modules__={3:(i,n,a)=>{var h=a(663),m=a(981),z=a(972),u=a(681),y=a(834),p=a(746),w=a(670),M=Object.prototype.toString;function b(O){if(!(this instanceof b))return new b(O);this.options=m.assign({chunkSize:16384,windowBits:0,to:""},O||{});var T=this.options;T.raw&&T.windowBits>=0&&T.windowBits<16&&(T.windowBits=-T.windowBits,T.windowBits===0&&(T.windowBits=-15)),!(T.windowBits>=0&&T.windowBits<16)||O&&O.windowBits||(T.windowBits+=32),T.windowBits>15&&T.windowBits<48&&(15&T.windowBits||(T.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var L=h.inflateInit2(this.strm,T.windowBits);if(L!==u.Z_OK)throw new Error(y[L]);if(this.header=new w,h.inflateGetHeader(this.strm,this.header),T.dictionary&&(typeof T.dictionary=="string"?T.dictionary=z.string2buf(T.dictionary):M.call(T.dictionary)==="[object ArrayBuffer]"&&(T.dictionary=new Uint8Array(T.dictionary)),T.raw&&(L=h.inflateSetDictionary(this.strm,T.dictionary))!==u.Z_OK))throw new Error(y[L])}function I(O,T){var L=new b(T);if(L.push(O,!0),L.err)throw L.msg||y[L.err];return L.result}b.prototype.push=function(O,T){var L,Q,ne,Z,_,F=this.strm,j=this.options.chunkSize,G=this.options.dictionary,q=!1;if(this.ended)return!1;Q=T===~~T?T:T===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof O=="string"?F.input=z.binstring2buf(O):M.call(O)==="[object ArrayBuffer]"?F.input=new Uint8Array(O):F.input=O,F.next_in=0,F.avail_in=F.input.length;do{if(F.avail_out===0&&(F.output=new m.Buf8(j),F.next_out=0,F.avail_out=j),(L=h.inflate(F,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&G&&(L=h.inflateSetDictionary(this.strm,G)),L===u.Z_BUF_ERROR&&q===!0&&(L=u.Z_OK,q=!1),L!==u.Z_STREAM_END&&L!==u.Z_OK)return this.onEnd(L),this.ended=!0,!1;F.next_out&&(F.avail_out!==0&&L!==u.Z_STREAM_END&&(F.avail_in!==0||Q!==u.Z_FINISH&&Q!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(ne=z.utf8border(F.output,F.next_out),Z=F.next_out-ne,_=z.buf2string(F.output,ne),F.next_out=Z,F.avail_out=j-Z,Z&&m.arraySet(F.output,F.output,ne,Z,0),this.onData(_)):this.onData(m.shrinkBuf(F.output,F.next_out)))),F.avail_in===0&&F.avail_out===0&&(q=!0)}while((F.avail_in>0||F.avail_out===0)&&L!==u.Z_STREAM_END);return L===u.Z_STREAM_END&&(Q=u.Z_FINISH),Q===u.Z_FINISH?(L=h.inflateEnd(this.strm),this.onEnd(L),this.ended=!0,L===u.Z_OK):Q!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),F.avail_out=0,!0)},b.prototype.onData=function(O){this.chunks.push(O)},b.prototype.onEnd=function(O){O===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=O,this.msg=this.strm.msg},n.Inflate=b,n.inflate=I,n.inflateRaw=function(O,T){return(T=T||{}).raw=!0,I(O,T)},n.ungzip=I},16:(i,n,a)=>{a.r(n),a.d(n,{CAP:()=>h,CC:()=>w.CC,CONTEXTS_PER_VIEWPORT:()=>Ot,Color:()=>w.Color,CustomLinear:()=>M.CustomLinear,Cylinder:()=>y.Cylinder,GLDraw:()=>m,GLModel:()=>ur,GLShape:()=>Oe,GLViewer:()=>Yt,GLVolumetricRender:()=>Pt,Gradient:()=>M.Gradient,GradientType:()=>M.GradientType,Label:()=>Mt,LabelCount:()=>lt,MarchingCube:()=>x,MarchingCubeInitializer:()=>Bt,Matrix3:()=>p.Matrix3,Matrix4:()=>p.Matrix4,Parsers:()=>It,PausableTimer:()=>b.PausableTimer,PointGrid:()=>ie,ProteinSurface:()=>xe,Quaternion:()=>p.Quaternion,ROYGB:()=>M.ROYGB,RWB:()=>M.RWB,Ray:()=>p.Ray,Sinebow:()=>M.Sinebow,Sphere:()=>y.Sphere,SurfaceType:()=>Gr,Triangle:()=>y.Triangle,Vector2:()=>p.Vector2,Vector3:()=>p.Vector3,VolumeData:()=>Ve.VolumeData,adjustVolumeStyle:()=>b.adjustVolumeStyle,applyPartialCharges:()=>ri,autoinit:()=>_r,autoload:()=>Mi,base64ToArray:()=>b.base64ToArray,bondLength:()=>Ie.bondLength,builtinColorSchemes:()=>w.builtinColorSchemes,builtinGradients:()=>M.builtinGradients,chains:()=>w.chains,clamp:()=>p.clamp,conversionMatrix3:()=>p.conversionMatrix3,createStereoViewer:()=>Ur,createViewer:()=>Cr,createViewerGrid:()=>Er,deepCopy:()=>b.deepCopy,degToRad:()=>p.degToRad,download:()=>b.download,drawCartoon:()=>ge,elementColors:()=>w.elementColors,extend:()=>b.extend,get:()=>b.get,getAtomProperty:()=>b.getAtomProperty,getColorFromStyle:()=>b.getColorFromStyle,getElement:()=>b.getElement,getExtent:()=>b.getExtent,getGradient:()=>M.getGradient,getPropertyRange:()=>b.getPropertyRange,getbin:()=>b.getbin,htmlColors:()=>w.htmlColors,inflateString:()=>b.inflateString,isEmptyObject:()=>b.isEmptyObject,isNumeric:()=>b.isNumeric,makeFunction:()=>b.makeFunction,mergeGeos:()=>b.mergeGeos,normalizeValue:()=>M.normalizeValue,partialCharges:()=>Qt,processing_autoinit:()=>Or,residues:()=>w.residues,setBondLength:()=>Ie.setBondLength,setSyncSurface:()=>Zi,specStringToObject:()=>b.specStringToObject,splitMesh:()=>yt,ssColors:()=>w.ssColors,subdivide_spline:()=>I,syncSurface:()=>Kr,viewers:()=>br});var h,m,z=a(111),u=a(378),y=a(99),p=a(529),w=a(222);(function(ae){ae[ae.NONE=0]="NONE",ae[ae.FLAT=1]="FLAT",ae[ae.ROUND=2]="ROUND"})(h||(h={})),(function(ae){function r(c,A,g){var C,E,S,k,D,$=Math.hypot(c,A);$<1e-4?(E=0,S=1):(E=-c/$,S=A/$),A=-E*c+S*A,(C=Math.hypot(A,g))<1e-4?(k=0,D=1):(k=g/C,D=A/C);var U=new Float32Array(9);return U[0]=S,U[1]=E,U[2]=0,U[3]=-E*D,U[4]=S*D,U[5]=k,U[6]=E*k,U[7]=-S*k,U[8]=D,U}var s=new class{constructor(){this.cache={};let c,A=[],g=Math.pow(2,4),C=2,E=Math.pow(2,C),S=g/E;for(A[0]=new p.Vector3(-1,0,0),A[S]=new p.Vector3(0,0,1),A[2*S]=new p.Vector3(1,0,0),A[3*S]=new p.Vector3(0,0,-1),C=3;C<=4;C++){for(E=Math.pow(2,C-1),S=g/E,c=0;c<E-1;c++)A[S/2+c*S]=A[c*S].clone().add(A[(c+1)*S]).normalize();c=E-1,A[S/2+c*S]=A[c*S].clone().add(A[0]).normalize()}this.basisVectors=A}getVerticesForRadius(c,A,g){if(this.cache!==void 0&&this.cache[c]!==void 0&&this.cache[c][A+g]!==void 0)return this.cache[c][A+g];for(var C,E=this.basisVectors.length,S=[],k=[],D=0;D<E;D++)S.push(this.basisVectors[D].clone().multiplyScalar(c)),S.push(this.basisVectors[D].clone().multiplyScalar(c)),C=this.basisVectors[D].clone().normalize(),k.push(C),k.push(C);var $,U,V=[],W=10,H=E,Y=2*Math.PI,J=Math.PI,te=!1,de=!1;for(U=0;U<=W;U++){te=U===0||U===W,de=U===5;var le=[],ye=[];for($=0;$<=H;$++)if(de){var Pe=$<H?2*$:0;ye.push(Pe+1),le.push(Pe)}else{var Te=$/H,ke=U/W;if(te&&$!==0)te&&le.push(S.length-1);else if($<H){var be=new p.Vector3;be.x=-c*Math.cos(0+Te*Y)*Math.sin(0+ke*J),be.y=A==1?0:c*Math.cos(0+ke*J),be.z=c*Math.sin(0+Te*Y)*Math.sin(0+ke*J),Math.abs(be.x)<1e-5&&(be.x=0),Math.abs(be.y)<1e-5&&(be.y=0),Math.abs(be.z)<1e-5&&(be.z=0),A==h.FLAT?(C=new p.Vector3(0,Math.cos(0+ke*J),0)).normalize():(C=new p.Vector3(be.x,be.y,be.z)).normalize(),S.push(be),k.push(C),le.push(S.length-1)}else le.push(S.length-H)}de&&V.push(ye),V.push(le)}var Ge={vertices:S,normals:k,verticesRows:V,w:H,h:W};return c in this.cache||(this.cache[c]={}),this.cache[c][A+g]=Ge,Ge}};ae.drawCylinder=function(c,A,g,C,E,S=0,k=0){if(!A||!g)return;let D=function(_e){if(typeof _e=="string"){let ve=_e;return ve.toLowerCase()=="flat"?h.FLAT:ve.toLowerCase()=="round"?h.ROUND:h.NONE}return _e};S=D(S);var $=(k=D(k))||S;E=E||{r:0,g:0,b:0};var U,V,W,H,Y,J,te=r(g.x-A.x,g.y-A.y,g.z-A.z),de=s.getVerticesForRadius(C,k,"to"),le=de.w,ye=de.h,Pe=$?ye*le+2:2*le,Te=c.updateGeoGroup(Pe),ke=de.vertices,be=de.normals,Ge=de.verticesRows,Je=Ge[ye/2],tt=Ge[ye/2+1],Ye=Te.vertices,ut=Te.vertexArray,ft=Te.normalArray,Qe=Te.colorArray,pt=Te.faceArray;for(W=0;W<le;++W){var Be=2*W;H=te[0]*ke[Be].x+te[3]*ke[Be].y+te[6]*ke[Be].z,Y=te[1]*ke[Be].x+te[4]*ke[Be].y+te[7]*ke[Be].z,J=te[5]*ke[Be].y+te[8]*ke[Be].z,U=3*(Ye+Be),V=Te.faceidx,ut[U]=H+A.x,ut[U+1]=Y+A.y,ut[U+2]=J+A.z,ut[U+3]=H+g.x,ut[U+4]=Y+g.y,ut[U+5]=J+g.z,ft[U]=H,ft[U+3]=H,ft[U+1]=Y,ft[U+4]=Y,ft[U+2]=J,ft[U+5]=J,Qe[U]=E.r,Qe[U+3]=E.r,Qe[U+1]=E.g,Qe[U+4]=E.g,Qe[U+2]=E.b,Qe[U+5]=E.b,pt[V]=tt[W]+Ye,pt[V+1]=tt[W+1]+Ye,pt[V+2]=Je[W]+Ye,pt[V+3]=Je[W]+Ye,pt[V+4]=tt[W+1]+Ye,pt[V+5]=Je[W+1]+Ye,Te.faceidx+=6}if($){var et,St,ot,bt,At,it,Rt,Ht,kt,ct,Jt,Nt,Zt,Vt,Xt,yr,Fr,Tr,ii,Wr,wr,$r,ci,ni,hi,zi,xi,Ii,Hr,Xr,Zr,ei,f=S?ye+1:ye/2+1;for(Y=k?0:ye/2;Y<f;Y++)if(Y!==ye/2){var K=Y<=ye/2?g:A,v=s.getVerticesForRadius(C,k,"to"),we=s.getVerticesForRadius(C,S,"from");for(K===g?(ke=v.vertices,be=v.normals,Ge=v.verticesRows):K==A&&(ke=we.vertices,be=we.normals,Ge=we.verticesRows),H=0;H<le;H++)V=Te.faceidx,Hr=3*((et=Ge[Y][H+1])+Ye),Xr=3*((St=Ge[Y][H])+Ye),Zr=3*((ot=Ge[Y+1][H])+Ye),ei=3*((bt=Ge[Y+1][H+1])+Ye),At=te[0]*ke[et].x+te[3]*ke[et].y+te[6]*ke[et].z,it=te[0]*ke[St].x+te[3]*ke[St].y+te[6]*ke[St].z,Rt=te[0]*ke[ot].x+te[3]*ke[ot].y+te[6]*ke[ot].z,Ht=te[0]*ke[bt].x+te[3]*ke[bt].y+te[6]*ke[bt].z,kt=te[1]*ke[et].x+te[4]*ke[et].y+te[7]*ke[et].z,ct=te[1]*ke[St].x+te[4]*ke[St].y+te[7]*ke[St].z,Jt=te[1]*ke[ot].x+te[4]*ke[ot].y+te[7]*ke[ot].z,Nt=te[1]*ke[bt].x+te[4]*ke[bt].y+te[7]*ke[bt].z,Zt=te[5]*ke[et].y+te[8]*ke[et].z,Vt=te[5]*ke[St].y+te[8]*ke[St].z,Xt=te[5]*ke[ot].y+te[8]*ke[ot].z,yr=te[5]*ke[bt].y+te[8]*ke[bt].z,ut[Hr]=At+K.x,ut[Xr]=it+K.x,ut[Zr]=Rt+K.x,ut[ei]=Ht+K.x,ut[Hr+1]=kt+K.y,ut[Xr+1]=ct+K.y,ut[Zr+1]=Jt+K.y,ut[ei+1]=Nt+K.y,ut[Hr+2]=Zt+K.z,ut[Xr+2]=Vt+K.z,ut[Zr+2]=Xt+K.z,ut[ei+2]=yr+K.z,Qe[Hr]=E.r,Qe[Xr]=E.r,Qe[Zr]=E.r,Qe[ei]=E.r,Qe[Hr+1]=E.g,Qe[Xr+1]=E.g,Qe[Zr+1]=E.g,Qe[ei+1]=E.g,Qe[Hr+2]=E.b,Qe[Xr+2]=E.b,Qe[Zr+2]=E.b,Qe[ei+2]=E.b,Fr=te[0]*be[et].x+te[3]*be[et].y+te[6]*be[et].z,Tr=te[0]*be[St].x+te[3]*be[St].y+te[6]*be[St].z,ii=te[0]*be[ot].x+te[3]*be[ot].y+te[6]*be[ot].z,Wr=te[0]*be[bt].x+te[3]*be[bt].y+te[6]*be[bt].z,wr=te[1]*be[et].x+te[4]*be[et].y+te[7]*be[et].z,$r=te[1]*be[St].x+te[4]*be[St].y+te[7]*be[St].z,ci=te[1]*be[ot].x+te[4]*be[ot].y+te[7]*be[ot].z,ni=te[1]*be[bt].x+te[4]*be[bt].y+te[7]*be[bt].z,hi=te[5]*be[et].y+te[8]*be[et].z,zi=te[5]*be[St].y+te[8]*be[St].z,xi=te[5]*be[ot].y+te[8]*be[ot].z,Ii=te[5]*be[bt].y+te[8]*be[bt].z,Y===0?(ft[Hr]=Fr,ft[Zr]=ii,ft[ei]=Wr,ft[Hr+1]=wr,ft[Zr+1]=ci,ft[ei+1]=ni,ft[Hr+2]=hi,ft[Zr+2]=xi,ft[ei+2]=Ii,pt[V]=et+Ye,pt[V+1]=ot+Ye,pt[V+2]=bt+Ye,Te.faceidx+=3):Y===f-1?(ft[Hr]=Fr,ft[Xr]=Tr,ft[Zr]=ii,ft[Hr+1]=wr,ft[Xr+1]=$r,ft[Zr+1]=ci,ft[Hr+2]=hi,ft[Xr+2]=zi,ft[Zr+2]=xi,pt[V]=et+Ye,pt[V+1]=St+Ye,pt[V+2]=ot+Ye,Te.faceidx+=3):(ft[Hr]=Fr,ft[Xr]=Tr,ft[ei]=Wr,ft[Hr+1]=wr,ft[Xr+1]=$r,ft[ei+1]=ni,ft[Hr+2]=hi,ft[Xr+2]=zi,ft[ei+2]=Ii,ft[Xr]=Tr,ft[Zr]=ii,ft[ei]=Wr,ft[Xr+1]=$r,ft[Zr+1]=ci,ft[ei+1]=ni,ft[Xr+2]=zi,ft[Zr+2]=xi,ft[ei+2]=Ii,pt[V]=et+Ye,pt[V+1]=St+Ye,pt[V+2]=bt+Ye,pt[V+3]=St+Ye,pt[V+4]=ot+Ye,pt[V+5]=bt+Ye,Te.faceidx+=6)}}Te.vertices+=Pe},ae.drawCone=function(c,A,g,C,E){if(!A||!g)return;E=E||{r:0,g:0,b:0};let S=new p.Vector3(g.x-A.x,g.y-A.y,g.z-A.z);var k=r(S.x,S.y,S.z);S=S.normalize();var D,$,U,V,W,H,Y=s.basisVectors.length,J=s.basisVectors,te=Y+2,de=c.updateGeoGroup(te),le=de.vertices,ye=de.vertexArray,Pe=de.normalArray,Te=de.colorArray,ke=de.faceArray;for(ye[D=3*le]=A.x,ye[D+1]=A.y,ye[D+2]=A.z,Pe[D]=-S.x,Pe[D+1]=-S.y,Pe[D+2]=-S.z,Te[D]=E.r,Te[D+1]=E.g,Te[D+2]=E.b,ye[D+3]=g.x,ye[D+4]=g.y,ye[D+5]=g.z,Pe[D+3]=S.x,Pe[D+4]=S.y,Pe[D+5]=S.z,Te[D+3]=E.r,Te[D+4]=E.g,Te[D+5]=E.b,D+=6,U=0;U<Y;++U){var be=J[U].clone();be.multiplyScalar(C),V=k[0]*be.x+k[3]*be.y+k[6]*be.z,W=k[1]*be.x+k[4]*be.y+k[7]*be.z,H=k[5]*be.y+k[8]*be.z,ye[D]=V+A.x,ye[D+1]=W+A.y,ye[D+2]=H+A.z,Pe[D]=V,Pe[D+1]=W,Pe[D+2]=H,Te[D]=E.r,Te[D+1]=E.g,Te[D+2]=E.b,D+=3}for(de.vertices+=Y+2,$=de.faceidx,U=0;U<Y;U++){var Ge=le+2+U,Je=le+2+(U+1)%Y;ke[$]=Ge,ke[$+1]=Je,ke[$+2]=le,ke[$+=3]=Ge,ke[$+1]=Je,ke[$+2]=le+1,$+=3}de.faceidx+=6*Y};var l=new class{constructor(){this.cache=new Map}getVerticesForRadius(c,A){A=A||2,this.cache.has(A)||this.cache.set(A,new Map);let g=this.cache.get(A);if(g.has(c))return g.get(c);var C={vertices:[],verticesRows:[],normals:[]},E=16*A,S=10*A;c<1&&(E=10*A,S=8*A);var k,D,$=2*Math.PI,U=Math.PI;for(D=0;D<=S;D++){let W=[];for(k=0;k<=E;k++){let H=k/E,Y=D/S,J=-c*Math.cos(0+H*$)*Math.sin(0+Y*U),te=c*Math.cos(0+Y*U),de=c*Math.sin(0+H*$)*Math.sin(0+Y*U);var V=new p.Vector3(J,te,de);V.normalize(),C.vertices.push({x:J,y:te,z:de}),C.normals.push(V),W.push(C.vertices.length-1)}C.verticesRows.push(W)}return g.set(c,C),C}};ae.drawSphere=function(c,A,g,C,E){var S=l.getVerticesForRadius(g,E),k=S.vertices,D=S.normals,$=c.updateGeoGroup(k.length),U=$.vertices,V=$.vertexArray,W=$.colorArray,H=$.faceArray,Y=$.lineArray,J=$.normalArray;for(let le=0,ye=k.length;le<ye;++le){let Pe=3*(U+le),Te=k[le];V[Pe]=Te.x+A.x,V[Pe+1]=Te.y+A.y,V[Pe+2]=Te.z+A.z,W[Pe]=C.r,W[Pe+1]=C.g,W[Pe+2]=C.b}$.vertices+=k.length;let te=S.verticesRows,de=te.length-1;for(let le=0;le<de;le++){let ye=te[le].length-1;for(let Pe=0;Pe<ye;Pe++){let Te=$.faceidx,ke=$.lineidx,be=te[le][Pe+1]+U,Ge=3*be,Je=te[le][Pe]+U,tt=3*Je,Ye=te[le+1][Pe]+U,ut=3*Ye,ft=te[le+1][Pe+1]+U,Qe=3*ft,pt=D[be-U],Be=D[Je-U],et=D[Ye-U],St=D[ft-U];Math.abs(k[be-U].y)===g?(J[Ge]=pt.x,J[ut]=et.x,J[Qe]=St.x,J[Ge+1]=pt.y,J[ut+1]=et.y,J[Qe+1]=St.y,J[Ge+2]=pt.z,J[ut+2]=et.z,J[Qe+2]=St.z,H[Te]=be,H[Te+1]=Ye,H[Te+2]=ft,Y[ke]=be,Y[ke+1]=Ye,Y[ke+2]=be,Y[ke+3]=ft,Y[ke+4]=Ye,Y[ke+5]=ft,$.faceidx+=3,$.lineidx+=6):Math.abs(k[Ye-U].y)===g?(J[Ge]=pt.x,J[tt]=Be.x,J[ut]=et.x,J[Ge+1]=pt.y,J[tt+1]=Be.y,J[ut+1]=et.y,J[Ge+2]=pt.z,J[tt+2]=Be.z,J[ut+2]=et.z,H[Te]=be,H[Te+1]=Je,H[Te+2]=Ye,Y[ke]=be,Y[ke+1]=Je,Y[ke+2]=be,Y[ke+3]=Ye,Y[ke+4]=Je,Y[ke+5]=Ye,$.faceidx+=3,$.lineidx+=6):(J[Ge]=pt.x,J[tt]=Be.x,J[Qe]=St.x,J[Ge+1]=pt.y,J[tt+1]=Be.y,J[Qe+1]=St.y,J[Ge+2]=pt.z,J[tt+2]=Be.z,J[Qe+2]=St.z,J[tt]=Be.x,J[ut]=et.x,J[Qe]=St.x,J[tt+1]=Be.y,J[ut+1]=et.y,J[Qe+1]=St.y,J[tt+2]=Be.z,J[ut+2]=et.z,J[Qe+2]=St.z,H[Te]=be,H[Te+1]=Je,H[Te+2]=ft,H[Te+3]=Je,H[Te+4]=Ye,H[Te+5]=ft,Y[ke]=be,Y[ke+1]=Je,Y[ke+2]=be,Y[ke+3]=ft,Y[ke+4]=Je,Y[ke+5]=Ye,Y[ke+6]=Ye,Y[ke+7]=ft,$.faceidx+=6,$.lineidx+=8)}}}})(m||(m={}));var M=a(546),b=a(864);function I(ae,r){var s,l,c,A,g,C,E,S,k,D=[],$=ae;for(($=[]).push(ae[0]),s=1,l=ae.length-1;s<l;s++)if(g=ae[s],C=ae[s+1],g.smoothen){var U=new p.Vector3((g.x+C.x)/2,(g.y+C.y)/2,(g.z+C.z)/2);U.atom=g.atom,$.push(U)}else $.push(g);for($.push(ae[ae.length-1]),s=-1,c=$.length;s<=c-3;s++)if(A=$[s===-1?0:s],g=$[s+1],C=$[s+2],E=$[s===c-3?c-1:s+3],S=new p.Vector3().subVectors(C,A).multiplyScalar(.5),k=new p.Vector3().subVectors(E,g).multiplyScalar(.5),!C.skip)for(var V=0;V<r;V++){var W=1/r*V,H=g.x+W*S.x+W*W*(-3*g.x+3*C.x-2*S.x-k.x)+W*W*W*(2*g.x-2*C.x+S.x+k.x),Y=g.y+W*S.y+W*W*(-3*g.y+3*C.y-2*S.y-k.y)+W*W*W*(2*g.y-2*C.y+S.y+k.y),J=g.z+W*S.z+W*W*(-3*g.z+3*C.z-2*S.z-k.z)+W*W*W*(2*g.z-2*C.z+S.z+k.z),te=new p.Vector3(H,Y,J);te.atom=V<r/2?g.atom:C.atom,D.push(te)}return D.push($[$.length-1]),D}const O=.5,T=1.3,L=.8,Q=.4,ne=.4;function Z(ae,r,s,l){for(var c,A,g,C,E=0,S=r.length;E<S;E++){C=Math.round(E*(l.length-1)/S),g=w.CC.color(l[C]);var k=ae.updateGeoGroup(2),D=k.vertexArray,$=k.colorArray,U=k.faceArray;D[A=3*(c=k.vertices)]=r[E].x,D[A+1]=r[E].y,D[A+2]=r[E].z,D[A+3]=s[E].x,D[A+4]=s[E].y,D[A+5]=s[E].z;for(var V=0;V<6;++V)$[A+3*V]=g.r,$[A+1+3*V]=g.g,$[A+2+3*V]=g.b;if(E>0){var W=[c,c+1,c-1,c-2],H=k.faceidx;U[H]=W[0],U[H+1]=W[1],U[H+2]=W[3],U[H+3]=W[1],U[H+4]=W[2],U[H+5]=W[3],k.faceidx+=6}k.vertices+=2}}function _(ae,r,s,l,c,A,g){g&&g!=="default"||(g="rectangle"),g==="edged"?(function(C,E,S,k,D){if(!(E.length<2)){var $,U;if($=E[0],U=E[E.length-1],$=I($,k),U=I(U,k),!D)return Z(C,$,U,S);var V,W,H,Y,J,te,de,le,ye,Pe,Te,ke,be,Ge,Je,tt,Ye,ut,ft,Qe,pt,Be,et=[],St=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]];for(be=0,Ge=$.length;be<Ge;be++){if(Pe=Math.round(be*(S.length-1)/Ge),ye=w.CC.color(S[Pe]),et.push(W=$[be]),et.push(W),et.push(H=U[be]),et.push(H),be<Ge-1){var ot=$[be+1].clone().sub($[be]);V=U[be].clone().sub($[be]).cross(ot).normalize().multiplyScalar(D)}for(et.push(Y=$[be].clone().add(V)),et.push(Y),et.push(J=U[be].clone().add(V)),et.push(J),W.atom!==void 0&&(Te=W.atom),Qe=(ft=C.updateGeoGroup(8)).vertexArray,pt=ft.colorArray,Be=ft.faceArray,Qe[de=3*(te=ft.vertices)]=W.x,Qe[de+1]=W.y,Qe[de+2]=W.z,Qe[de+3]=W.x,Qe[de+4]=W.y,Qe[de+5]=W.z,Qe[de+6]=H.x,Qe[de+7]=H.y,Qe[de+8]=H.z,Qe[de+9]=H.x,Qe[de+10]=H.y,Qe[de+11]=H.z,Qe[de+12]=Y.x,Qe[de+13]=Y.y,Qe[de+14]=Y.z,Qe[de+15]=Y.x,Qe[de+16]=Y.y,Qe[de+17]=Y.z,Qe[de+18]=J.x,Qe[de+19]=J.y,Qe[de+20]=J.z,Qe[de+21]=J.x,Qe[de+22]=J.y,Qe[de+23]=J.z,Je=0;Je<8;++Je)pt[de+3*Je]=ye.r,pt[de+1+3*Je]=ye.g,pt[de+2+3*Je]=ye.b;if(be>0){var bt=ke!==void 0&&Te!==void 0&&ke.serial!==Te.serial;for(Je=0;Je<4;Je++){var At=[te+St[Je][0],te+St[Je][1],te+St[Je][2],te+St[Je][3]];if(Be[le=ft.faceidx]=At[0],Be[le+1]=At[1],Be[le+2]=At[3],Be[le+3]=At[1],Be[le+4]=At[2],Be[le+5]=At[3],ft.faceidx+=6,Te.clickable||ke.clickable||Te.hoverable||ke.hoverable){var it=et[At[3]].clone(),Rt=et[At[0]].clone(),Ht=et[At[2]].clone(),kt=et[At[1]].clone();if(it.atom=et[At[3]].atom||null,Ht.atom=et[At[2]].atom||null,Rt.atom=et[At[0]].atom||null,kt.atom=et[At[1]].atom||null,bt){var ct=it.clone().add(Rt).multiplyScalar(.5),Jt=Ht.clone().add(kt).multiplyScalar(.5),Nt=it.clone().add(kt).multiplyScalar(.5);Je%2==0?((ke.clickable||ke.hoverable)&&(tt=new y.Triangle(ct,Nt,it),Ye=new y.Triangle(Jt,Ht,Nt),ut=new y.Triangle(Nt,Ht,it),ke.intersectionShape.triangle.push(tt),ke.intersectionShape.triangle.push(Ye),ke.intersectionShape.triangle.push(ut)),(Te.clickable||Te.hoverable)&&(tt=new y.Triangle(Rt,kt,Nt),Ye=new y.Triangle(kt,Jt,Nt),ut=new y.Triangle(Rt,Nt,ct),Te.intersectionShape.triangle.push(tt),Te.intersectionShape.triangle.push(Ye),Te.intersectionShape.triangle.push(ut))):((Te.clickable||Te.hoverable)&&(tt=new y.Triangle(ct,Nt,it),Ye=new y.Triangle(Jt,Ht,Nt),ut=new y.Triangle(Nt,Ht,it),Te.intersectionShape.triangle.push(tt),Te.intersectionShape.triangle.push(Ye),Te.intersectionShape.triangle.push(ut)),(ke.clickable||ke.hoverable)&&(tt=new y.Triangle(Rt,kt,Nt),Ye=new y.Triangle(kt,Jt,Nt),ut=new y.Triangle(Rt,Nt,ct),ke.intersectionShape.triangle.push(tt),ke.intersectionShape.triangle.push(Ye),ke.intersectionShape.triangle.push(ut)))}else(Te.clickable||Te.hoverable)&&(tt=new y.Triangle(Rt,kt,it),Ye=new y.Triangle(kt,Ht,it),Te.intersectionShape.triangle.push(tt),Te.intersectionShape.triangle.push(Ye))}}}ft.vertices+=8,ke=Te}var Zt=et.length-8;for(Qe=(ft=C.updateGeoGroup(8)).vertexArray,pt=ft.colorArray,Be=ft.faceArray,de=3*(te=ft.vertices),le=ft.faceidx,be=0;be<4;be++){et.push(et[2*be]),et.push(et[Zt+2*be]);var Vt=et[2*be],Xt=et[Zt+2*be];Qe[de+6*be]=Vt.x,Qe[de+1+6*be]=Vt.y,Qe[de+2+6*be]=Vt.z,Qe[de+3+6*be]=Xt.x,Qe[de+4+6*be]=Xt.y,Qe[de+5+6*be]=Xt.z,pt[de+6*be]=ye.r,pt[de+1+6*be]=ye.g,pt[de+2+6*be]=ye.b,pt[de+3+6*be]=ye.r,pt[de+4+6*be]=ye.g,pt[de+5+6*be]=ye.b}Zt+=8,tt=[te,te+2,te+6,te+4],Ye=[te+1,te+5,te+7,te+3],Be[le]=tt[0],Be[le+1]=tt[1],Be[le+2]=tt[3],Be[le+3]=tt[1],Be[le+4]=tt[2],Be[le+5]=tt[3],Be[le+6]=Ye[0],Be[le+7]=Ye[1],Be[le+8]=Ye[3],Be[le+9]=Ye[1],Be[le+10]=Ye[2],Be[le+11]=Ye[3],ft.faceidx+=12,ft.vertices+=8}})(ae,r,s,l,c):g!=="rectangle"&&g!=="oval"&&g!=="parabola"||(function(C,E,S,k,D,$,U){var V,W,H,Y,J,te,de,le,ye,Pe;if((H=E.length)<2||E[0].length<2)return;for(V=0;V<H;V++)E[V]=I(E[V],k);if(Y=E[0].length,!D)return Z(C,E[0],E[H-1],S);var Te=[],ke=[],be=[];for(W=0;W<H;W++)Te.push(.25+1.5*Math.sqrt((H-1)*W-Math.pow(W,2))/(H-1)),ke.push(.5),be.push(2*(Math.pow(W/H,2)-W/H)+.6);var Ge,Je,tt,Ye,ut,ft,Qe,pt,Be,et,St=[];for(W=0;W<2*H-1;W++)St[W]=[W,W+1,W+1-2*H,W-2*H];St[2*H-1]=[W,W+1-2*H,W+1-4*H,W-2*H];let ot=C.updateGeoGroup();for(V=0;V<Y;V++){let Rt=C.groups,Ht=!1;var bt,At;for(ot=C.updateGeoGroup(2*H),Rt!=C.groups&&V>0&&(V-=1,Ht=!0),ft=Math.round(V*(S.length-1)/Y),ut=w.CC.color(S[ft]),ye=de,Pe=le,de=[],le=[],J=[],E[0][V].atom!==void 0&&(Ye=E[0][V].atom,U==="oval"?te=Te:U==="rectangle"?te=ke:U==="parabola"&&(te=be)),te||(te=ke),W=0;W<H;W++)bt=V<Y-1?E[W][V+1].clone().sub(E[W][V]):E[W][V-1].clone().sub(E[W][V]).negate(),At=W<H-1?E[W+1][V].clone().sub(E[W][V]):E[W-1][V].clone().sub(E[W][V]).negate(),J[W]=At.cross(bt).normalize().multiplyScalar(D*te[W]);for(W=0;W<H;W++)de[W]=E[W][V].clone().add(J[W].clone().negate());for(W=0;W<H;W++)le[W]=E[W][V].clone().add(J[W]);for(Qe=ot.vertexArray,pt=ot.colorArray,Be=ot.faceArray,Je=3*(Ge=ot.vertices),W=0;W<H;W++)Qe[Je+3*W+0]=de[W].x,Qe[Je+3*W+1]=de[W].y,Qe[Je+3*W+2]=de[W].z;for(W=0;W<H;W++)Qe[Je+3*W+0+3*H]=le[H-1-W].x,Qe[Je+3*W+1+3*H]=le[H-1-W].y,Qe[Je+3*W+2+3*H]=le[H-1-W].z;for(W=0;W<2*H;++W)pt[Je+3*W+0]=ut.r,pt[Je+3*W+1]=ut.g,pt[Je+3*W+2]=ut.b;if(V>0&&!Ht){for(W=0;W<2*H;W++)et=[Ge+St[W][0],Ge+St[W][1],Ge+St[W][2],Ge+St[W][3]],Be[tt=ot.faceidx]=et[0],Be[tt+1]=et[1],Be[tt+2]=et[3],Be[tt+3]=et[1],Be[tt+4]=et[2],Be[tt+5]=et[3],ot.faceidx+=6;if(Ye.clickable||Ye.hoverable){var it=[];for(W in it.push(new y.Triangle(ye[0],de[0],de[H-1])),it.push(new y.Triangle(ye[0],de[H-1],ye[H-1])),it.push(new y.Triangle(ye[H-1],de[H-1],le[H-1])),it.push(new y.Triangle(ye[H-1],le[H-1],Pe[H-1])),it.push(new y.Triangle(le[0],Pe[0],Pe[H-1])),it.push(new y.Triangle(le[H-1],le[0],Pe[H-1])),it.push(new y.Triangle(de[0],ye[0],Pe[0])),it.push(new y.Triangle(le[0],de[0],Pe[0])),it)Ye.intersectionShape.triangle.push(it[W])}}ot.vertices+=2*H}for(Qe=ot.vertexArray,pt=ot.colorArray,Be=ot.faceArray,Je=3*(Ge=ot.vertices),tt=ot.faceidx,V=0;V<H-1;V++)et=[V,V+1,2*H-2-V,2*H-1-V],Be[tt=ot.faceidx]=et[0],Be[tt+1]=et[1],Be[tt+2]=et[3],Be[tt+3]=et[1],Be[tt+4]=et[2],Be[tt+5]=et[3],ot.faceidx+=6;for(V=0;V<H-1;V++)et=[Ge-1-V,Ge-2-V,Ge-2*H+V+1,Ge-2*H+V],Be[tt=ot.faceidx]=et[0],Be[tt+1]=et[1],Be[tt+2]=et[3],Be[tt+3]=et[1],Be[tt+4]=et[2],Be[tt+5]=et[3],ot.faceidx+=6})(ae,r,s,l,c,0,g)}function F(ae){return ae&&ae.elem==="C"&&ae.atom==="CA"}function j(ae,r){if(ae&&r&&ae.chain===r.chain){if(!(ae.hetflag||r.hetflag||ae.reschain!==r.reschain||ae.resi!==r.resi&&ae.resi!==r.resi-1))return!0;if(ae.resi<r.resi){var s=ae.x-r.x,l=ae.y-r.y,c=ae.z-r.z,A=s*s+l*l+c*c;if(ae.atom=="CA"&&r.atom=="CA"&&A<16||(ae.atom=="P"||r.atom=="P")&&A<64)return!0}}return!1}function G(ae,r,s,l,c){if(r!=null&&r.vertices!=0){c&&(r.initTypedArrays(),r.setUpNormals());var A=new u.MeshDoubleLambertMaterial;A.vertexColors=u.Coloring.FaceColors,typeof s=="number"&&s>=0&&s<1&&(A.transparent=!0,A.opacity=s),A.outline=l;var g=new u.Mesh(r,A);ae.add(g)}}function q(ae,r,s,l,c,A,g,C,E){var S,k,D,$,U,V;if(l&&c&&g){var W=c.sub(l);W.normalize();var H=C[E];for(k=E+1;k<C.length&&(H=C[k]).atom!=g.atom;k++);if((H=H?new p.Vector3(H.x,H.y,H.z):new p.Vector3(0,0,0)).sub(l),g.ss==="arrow start"){var Y=H.clone().multiplyScalar(.3).cross(c);l.add(Y);var J=H.clone().cross(W).normalize();W.rotateAboutVector(J,.43)}for(g.style.cartoon.ribbon?S=g.style.cartoon.thickness||Q:g.style.cartoon.width?S=g.style.cartoon.width:g.ss==="c"?S=g.atom==="P"?L:O:g.ss==="arrow start"?(S=T,U=!0):S=g.ss==="arrow end"||g.ss==="h"&&g.style.cartoon.tubes||g.ss==="tube start"?O:T,A!=null&&W.dot(A)<0&&W.negate(),W.multiplyScalar(S),k=0;k<r;k++)D=2*k/(r-1)-1,($=new p.Vector3(l.x+D*W.x,l.y+D*W.y,l.z+D*W.z)).atom=g,g.ss==="s"&&($.smoothen=!0),ae[k].push($);if(U)for(W.multiplyScalar(2),k=0;k<r;k++)D=2*k/(r-1)-1,($=new p.Vector3(l.x+D*W.x,l.y+D*W.y,l.z+D*W.z)).atom=g,$.smoothen=!1,$.skip=!0,ae[k].push($);return V=g.style.cartoon.style||"default",ae.style?ae.style!=V&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),ae.style="default"):ae.style=V,g.ss!=="arrow start"&&g.ss!=="arrow end"||(g.ss="s"),U}}const N={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},ee={DA:!0,DG:!0,A:!0,G:!0},Ce={DT:!0,DC:!0,U:!0,C:!0,T:!0},he={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function ge(ae,r,s,l=10){let c=l,A=l;var g,C,E,S,k,D,$,U,V,W,H,Y,J,te,de,le,ye,Pe,Te=new u.Geometry(!0),ke=new u.Geometry(!0),be=[],Ge=[],Je=1,tt=!1,Ye={};for(var ut in M.Gradient.builtinGradients)M.Gradient.builtinGradients.hasOwnProperty(ut)&&(Ye[ut]=new M.Gradient.builtinGradients[ut](s[1],s[0]));var ft=function(Vt,Xt){return s&&Xt.color==="spectrum"?Xt.colorscheme in Ye?Ye[Xt.colorscheme].valueToHex(Vt.resi):Ye.sinebow.valueToHex(Vt.resi):(0,b.getColorFromStyle)(Vt,Xt).getHex()};for(U=0;U<c;U++)Ge[U]=[];var Qe=!1,pt=!1,Be=[];for(U in r){if((S=r[U]).elem==="C"&&S.atom==="CA"){var et=j(E,S);et&&S.ss==="s"?Qe=!0:Qe&&(E&&C&&E.style.cartoon.arrows&&C.style.cartoon.arrows&&(E.ss="arrow end",C.ss="arrow start"),Qe=!1),et&&(E.ss==="h"||E.ss=="tube start")&&E.style.cartoon.tubes?!pt&&E.ss!="tube start"&&S.style.cartoon.tubes&&(S.ss="tube start",pt=!0):pt&&(E.ss==="tube start"?E.ss="tube end":C&&C.style.cartoon.tubes&&(C.ss="tube end"),pt=!1),C=E,E=S}S&&S.atom in N&&Be.push(S)}pt&&E.style.cartoon.tubes&&(E.ss="tube end",pt=!1);var St=function(Vt){Ge[0].length>0&&_(ke,Ge,be,A,$,0,Ge.style);var Xt=[],yr=null;if(Vt){for(U=0;U<c;U++)Xt[U]=Ge[U][Ge[U].length-1];yr=be[be.length-1]}for(Ge=[],U=0;U<c;U++)Ge[U]=[];if(be=[],Vt){for(U=0;U<c;U++)Ge[U].push(Xt[U]);be.push(yr)}G(ae,ke,Je,tt,!0),G(ae,Te,Je,tt,!1),ke=new u.Geometry(!0),Te=new u.Geometry(!0)};E=void 0;let ot=[];for(var bt=0;bt<Be.length;bt++){var At=(S=Be[bt]).resn.trim(),it=At in he;if(Je=1,g=S.style.cartoon,E&&E.style.cartoon&&(Je=E.style.cartoon.opacity),E&&E.style.cartoon&&E.style.cartoon.outline&&(tt=E.style.cartoon.outline),!E||!E.style.cartoon||S.style.cartoon&&E.style.cartoon.opacity==S.style.cartoon.opacity||St(E.chain==S.chain),E&&S&&!j(E,S)&&E.chain&&E.chain==S.chain&&!E.hetflag&&!S.hetflag&&E.reschain+1==S.reschain&&ot.push([E,S]),g.style==="trace"){if(!S.hetflag&&(S.elem==="C"&&S.atom==="CA"||it&&S.atom==="P"||S.atom==="BB")){if(D=ft(S,g),$=(0,b.isNumeric)(g.thickness)?g.thickness:Q,j(E,S))if(D==k){var Rt=w.CC.color(D);m.drawCylinder(Te,E,S,$,Rt,2,2)}else{var Ht=new p.Vector3().addVectors(E,S).multiplyScalar(.5),kt=w.CC.color(k),ct=w.CC.color(D);m.drawCylinder(Te,E,Ht,$,kt,2,0),m.drawCylinder(Te,Ht,S,$,ct,0,2)}if((S.clickable===!0||S.hoverable)&&S.intersectionShape!==void 0){var Jt=new p.Vector3(S.x,S.y,S.z);S.intersectionShape.sphere.push(new y.Sphere(Jt,$))}E=S,k=D}}else{if(F(S)||it&&(S.atom==="P"||S.atom.indexOf("O5")==0)){if(Pe)if(S.ss==="tube end")Pe=!1,ye=new p.Vector3(S.x,S.y,S.z),m.drawCylinder(Te,le,ye,2,w.CC.color(k),1,1),S.ss="h";else{if(E.chain==S.chain&&E.ss!=="tube end")continue;Pe=!1,E.ss="h",ye=new p.Vector3(E.x,E.y,E.z),m.drawCylinder(Te,le,ye,2,w.CC.color(k),1,1)}if(E&&(!j(E,S)||E.ss==="tube start")){for(E.ss==="tube start"&&(Pe=!0,le=new p.Vector3(E.x,E.y,E.z),E.ss="h"),de&&(te=Y?new p.Vector3().addVectors(E,Y).multiplyScalar(.5):new p.Vector3(E.x,E.y,E.z),m.drawCylinder(Te,te,de,ne,w.CC.color(de.color),0,2),q(Ge,c,!0,Y,J,H,E,Be,bt),be.push(D),te=null,de=null),Ge[0].length>0&&_(ke,Ge,be,A,$,0,Ge.style),Ge=[],U=0;U<c;U++)Ge[U]=[];be=[]}if(E===void 0||E.rescode!=S.rescode||E.resi!=S.resi){if(de&&E!=null){var Nt=(te=new p.Vector3().addVectors(E,S).multiplyScalar(.5)).clone().sub(de).multiplyScalar(.02);te.add(Nt),m.drawCylinder(Te,te,de,ne,w.CC.color(de.color),0,2),te=null,de=null}D=ft(S,g),be.push(D),$=(0,b.isNumeric)(g.thickness)?g.thickness:Q,E=S,(V=new p.Vector3(E.x,E.y,E.z)).resi=E.resi,k=D}S.clickable!==!0&&S.hoverable!==!0||S.intersectionShape!==void 0&&S.intersectionShape.triangle!==void 0||(S.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else E!=null&&(F(E)&&S.atom==="O"||it&&E.atom==="P"&&(S.atom==="OP2"||S.atom==="O2P")||it&&E.atom.indexOf("O5")==0&&S.atom.indexOf("C5")==0)?((W=new p.Vector3(S.x,S.y,S.z)).resi=S.resi,S.atom!=="OP2"&&S.atom!=="O2P"||(J=new p.Vector3(S.x,S.y,S.z))):it&&S.atom.indexOf("O3")==0?Y=new p.Vector3(S.x,S.y,S.z):(S.atom==="N1"&&At in ee||S.atom==="N3"&&At in Ce)&&((de=new p.Vector3(S.x,S.y,S.z)).color=(0,b.getColorFromStyle)(S,g).getHex());W&&V&&W.resi===V.resi&&(q(Ge,c,!0,V,W,H,E,Be,bt),H=W,V=null,W=null,be.push(D))}}de&&(te=Y?new p.Vector3().addVectors(E,Y).multiplyScalar(.5):new p.Vector3(E.x,E.y,E.z),m.drawCylinder(Te,te,de,ne,w.CC.color(de.color),0,2),q(Ge,c,!0,Y,J,H,E,Be,bt),be.push(D)),St(!1);var Zt=function(Vt,Xt){if(Vt.style.cartoon.gapcutoff&&Vt.style.cartoon.gapcutoff==Xt.style.cartoon.gapcutoff){let Fr=Vt.style.cartoon.gapcutoff,Tr=Xt.resi-Vt.resi;if(Tr>0&&Tr<Fr){let ii=.25,Wr=Xt.x-Vt.x,wr=Xt.y-Vt.y,$r=Xt.z-Vt.z,ci=Math.sqrt(Wr*Wr+wr*wr+$r*$r),ni=ci/(2*Tr),hi=new p.Vector3(Vt.x,Vt.y,Vt.z),zi=ci/ni,xi=new p.Vector3((Xt.x-Vt.x)/zi,(Xt.y-Vt.y)/zi,(Xt.z-Vt.z)/zi);hi.add({x:xi.x/2,y:xi.y/2,z:xi.z/2});let Ii=hi.clone().add(xi);xi.multiplyScalar(2);let Hr=(0,b.extend)({},Vt);for(var yr=0;yr<Tr;yr++){Hr.resi+=1;let Xr=ft(Hr,Hr.style.cartoon);m.drawCylinder(Te,hi,Ii,ii,w.CC.color(Xr),h.FLAT,h.FLAT),hi.add(xi),Ii.add(xi)}St(!1)}}};for(let Vt of ot)Zt(Vt[0],Vt[1])}var me=a(797),Me=a(865),ue=a(392);function P(ae,r){for(var s=[[]],l=(r=r||{}).assignBonds===void 0||r.assignBonds,c=ae.trimStart().split(/\r?\n|\r/);c.length>0&&!(c.length<3);){var A=parseInt(c[0]);if(isNaN(A)||A<=0||c.length<A+2)break;var g=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi.exec(c[1]);if(g!=null&&g.length>1){var C=new Float32Array(g[1].split(/\s+/)),E=new u.Matrix3(C[0],C[3],C[6],C[1],C[4],C[7],C[2],C[5],C[8]);s.modelData=[{cryst:{matrix:E}}]}for(var S=2,k=s[s.length-1].length,D=k+A,$=k;$<D;$++){var U=c[S++].trim().split(/\s+/),V={};V.serial=$;var W=U[0];V.atom=V.elem=W[0].toUpperCase()+W.substring(1,2).toLowerCase(),V.x=parseFloat(U[1]),V.y=parseFloat(U[2]),V.z=parseFloat(U[3]),V.hetflag=!0,V.bonds=[],V.bondOrder=[],V.properties={},s[s.length-1][$]=V,U.length>=7&&(V.dx=parseFloat(U[4]),V.dy=parseFloat(U[5]),V.dz=parseFloat(U[6]))}if(!r.multimodel)break;s.push([]),c.splice(0,S)}if(l)for(let Y=0;Y<s.length;Y++)(0,ue.assignBonds)(s[Y],r);if(r.onemol){var H=s;(s=[]).push(H[0]);for(let Y=1;Y<H.length;Y++){let J=s[0].length;for(let te=0;te<H[Y].length;te++){let de=H[Y][te];for(let le=0;le<de.bonds.length;le++)de.bonds[le]=de.bonds[le]+J;de.index=s[0].length,de.serial=s[0].length,s[0].push(de)}}}return s}function ce(ae,r){var s="V2000",l=ae.split(/\r?\n|\r/);return l.length>3&&l[3].length>38&&(s=l[3].substring(34,39)),s==="V2000"?(function(c,A){var g=[[]],C=!1;for(A.keepH!==void 0&&(C=!A.keepH);c.length>0&&!(c.length<4);){var E=parseInt(c[3].substring(0,3));if(isNaN(E)||E<=0)break;var S=parseInt(c[3].substring(3,6)),k=4;if(c.length<4+E+S)break;var D,$,U=[],V=g[g.length-1].length,W=V+E;for(D=V;D<W;D++,k++){var H={},Y=($=c[k]).substring(31,34).replace(/ /g,"");H.atom=H.elem=Y[0].toUpperCase()+Y.substring(1).toLowerCase(),H.elem==="H"&&C||(H.serial=D,U[D]=g[g.length-1].length,H.x=parseFloat($.substring(0,10)),H.y=parseFloat($.substring(10,20)),H.z=parseFloat($.substring(20,30)),H.hetflag=!0,H.bonds=[],H.bondOrder=[],H.properties={},H.index=g[g.length-1].length,g[g.length-1].push(H))}for(D=0;D<S;D++,k++){$=c[k];var J=U[parseInt($.substring(0,3))-1+V],te=U[parseInt($.substring(3,6))-1+V],de=parseFloat($.substring(6));J!==void 0&&te!==void 0&&(g[g.length-1][J].bonds.push(te),g[g.length-1][J].bondOrder.push(de),g[g.length-1][te].bonds.push(J),g[g.length-1][te].bondOrder.push(de))}if(!A.multimodel)break;for(A.onemol||g.push([]);c[k]!=="$$$$"&&k<c.length;)k++;c.splice(0,++k)}return g})(l,r):s==="V3000"?(function(c,A){var g=[[]],C=!1;for(A.keepH!==void 0&&(C=!A.keepH);c.length>0&&!(c.length<8)&&c[4].startsWith("M  V30 BEGIN CTAB")&&c[5].startsWith("M  V30 COUNTS")&&!(c[5].length<14);){var E=c[5].substring(13).match(/\S+/g);if(E.length<2)break;var S=parseInt(E[0]);if(isNaN(S)||S<=0)break;var k=parseInt(E[1]),D=7;if(c.length<8+S+k)break;var $,U=[],V=g[g.length-1].length,W=V+S;for($=V;$<W;$++,D++){var H=c[D].substring(6).match(/\S+/g);if(H.length>4){var Y={},J=H[1].replace(/ /g,"");Y.atom=Y.elem=J[0].toUpperCase()+J.substring(1).toLowerCase(),Y.elem==="H"&&C||(Y.serial=$,U[$]=g[g.length-1].length,Y.x=parseFloat(H[2]),Y.y=parseFloat(H[3]),Y.z=parseFloat(H[4]),Y.hetflag=!0,Y.bonds=[],Y.bondOrder=[],Y.properties={},Y.index=g[g.length-1].length,g[g.length-1].push(Y))}}if(c[D]!=="M  V30 END ATOM"||(D++,k===0||c[D]!=="M  V30 BEGIN BOND"))break;for(D++,$=0;$<k;$++,D++){var te=c[D].substring(6).match(/\S+/g);if(te.length>3){var de=U[parseInt(te[2])-1+V],le=U[parseInt(te[3])-1+V],ye=parseFloat(te[1]);de!==void 0&&le!==void 0&&(g[g.length-1][de].bonds.push(le),g[g.length-1][de].bondOrder.push(ye),g[g.length-1][le].bonds.push(de),g[g.length-1][le].bondOrder.push(ye))}}if(!A.multimodel)break;for(A.onemol||g.push([]);c[D]!=="$$$$"&&D<c.length;)D++;c.splice(0,++D)}return g})(l,r):[[""]]}function se(ae,r){var s=[[]];typeof ae=="string"&&(ae=JSON.parse(ae));for(var l=ae.m,c=l[0].a,A=l[0].b,g=l[0].s,C=r!==void 0&&r.parseStyle!==void 0?r.parseStyle:g!==void 0,E=s[s.length-1].length,S=0;S<c.length;S++){var k=c[S],D={};D.id=k.i,D.x=k.x,D.y=k.y,D.z=k.z||0,D.bonds=[],D.bondOrder=[];var $=k.l||"C";D.elem=$[0].toUpperCase()+$.substring(1).toLowerCase(),D.serial=s[s.length-1].length,C&&(D.style=g[k.s||0]),s[s.length-1].push(D)}for(let U=0;U<A.length;U++){let V=A[U],W=V.b+E,H=V.e+E,Y=V.o||1,J=s[s.length-1][W],te=s[s.length-1][H];J.bonds.push(H),J.bondOrder.push(Y),te.bonds.push(W),te.bondOrder.push(Y)}return s}function X(ae,r){(function(S,k){const D=k||3.2,$=D*D,U=[];for(let V=0,W=S.length;V<W;V++){S[V].index=V;const H=S[V];H.hetflag||H.atom!=="N"&&H.atom!=="O"||(U.push(H),H.hbondOther=null,H.hbondDistanceSq=Number.POSITIVE_INFINITY)}U.sort(function(V,W){return V.z-W.z});for(let V=0,W=U.length;V<W;V++){const H=U[V];for(let Y=V+1;Y<W;Y++){const J=U[Y],te=J.z-H.z;if(te>D)break;if(J.atom==H.atom)continue;const de=Math.abs(J.y-H.y);if(de>D)continue;const le=Math.abs(J.x-H.x);if(le>D)continue;const ye=le*le+de*de+te*te;ye>$||J.chain==H.chain&&Math.abs(J.resi-H.resi)<4||(ye<H.hbondDistanceSq&&(H.hbondOther=J,H.hbondDistanceSq=ye),ye<J.hbondDistanceSq&&(J.hbondOther=H,J.hbondDistanceSq=ye))}}})(ae,r);const s={};let l,c,A,g,C,E;for(l=0,c=ae.length;l<c;l++)if(C=ae[l],s[C.chain]===void 0&&(s[C.chain]=[]),isFinite(C.hbondDistanceSq)){const S=C.hbondOther;s[S.chain]===void 0&&(s[S.chain]=[]),Math.abs(S.resi-C.resi)===4&&(s[C.chain][C.resi]="h")}for(A in s)for(g=1;g<s[A].length-1;g++){const S=s[A][g-1],k=s[A][g+1];E=s[A][g],S=="h"&&S==k&&E!=S&&(s[A][g]=S)}for(l=0,c=ae.length;l<c;l++)C=ae[l],isFinite(C.hbondDistanceSq)&&s[C.chain][C.resi]!="h"&&C.ss!=="h"&&(s[C.chain][C.resi]="maybesheet");for(let S=0,k=ae.length;S<k;S++)if(C=ae[S],isFinite(C.hbondDistanceSq)&&s[C.chain][C.resi]=="maybesheet"){let D=C.hbondOther,$=s[D.chain][D.resi];$!="maybesheet"&&$!="s"||(s[C.chain][C.resi]="s",s[D.chain][D.resi]="s")}for(let S in s){for(let k=1;k<s[S].length-1;k++){const D=s[S][k-1],$=s[S][k+1];E=s[S][k],D=="s"&&D==$&&E!=D&&(s[S][k]=D)}for(let k=0;k<s[S].length;k++){const D=s[S][k];D!="h"&&D!="s"||s[S][k-1]!=D&&s[S][k+1]!=D&&delete s[S][k]}}for(l=0,c=ae.length;l<c;l++)C=ae[l],E=s[C.chain][C.resi],delete C.hbondOther,delete C.hbondDistanceSq,E!==void 0&&E!=="maybesheet"&&(C.ss=E,s[C.chain][C.resi-1]!=E&&(C.ssbegin=!0),s[C.chain][C.resi+1]!=E&&(C.ssend=!0))}function Re(ae,r,s,l){const c=!s.duplicateAssemblyAtoms,A=r.length;let g=A,C=-1,E=null,S=null;(s.normalizeAssembly||s.wrapAtoms)&&l&&(E=(0,u.conversionMatrix3)(l.a,l.b,l.c,l.alpha,l.beta,l.gamma),S=new u.Matrix3,S.getInverse3(E));let k=function(U){let V=U.clone().applyMatrix3(S);const W=[V.x,V.y,V.z],H=[0,0,0];for(let J=0;J<3;J++){for(;W[J]<-.001;)W[J]+=1,H[J]+=1;for(;W[J]>1.001;)W[J]-=1,H[J]-=1}const Y=new u.Vector3(H[0],H[1],H[2]);return Y.applyMatrix3(E),Y};if(s.normalizeAssembly&&l)for(let U=0;U<ae.length;U++){const V=new u.Vector3(0,0,0);for(let H=0;H<A;H++){const Y=new u.Vector3(r[H].x,r[H].y,r[H].z);Y.applyMatrix4(ae[U]),V.add(Y)}V.divideScalar(A);const W=k(V);ae[U].isNearlyIdentity()&&W.lengthSq()>.001&&(C=U),ae[U].translate(W)}if(c){if(ae.length>1)for(let U=0;U<r.length;U++){var D=[];for(let V=0;V<ae.length;V++)if(!ae[V].isNearlyIdentity()){var $=new u.Vector3;$.set(r[U].x,r[U].y,r[U].z),$.applyMatrix4(ae[V]),D.push($)}r[U].symmetries=D}}else{for(let U=0;U<A;U++)r[U].sym=-1;for(let U=0;U<ae.length;U++)if(ae[U].isNearlyIdentity()||C==U)for(let V=0;V<A;V++)r[V].sym=U;else{let V=new u.Vector3;for(let W=0;W<A;W++){const H=[];for(let J=0;J<r[W].bonds.length;J++)H.push(r[W].bonds[J]+g);if(V.set(r[W].x,r[W].y,r[W].z),V.applyMatrix4(ae[U]),s.wrapAtoms&&l){let J=k(V);V.add(J)}const Y={};for(const J in r[W])Y[J]=r[W][J];Y.x=V.x,Y.y=V.y,Y.z=V.z,Y.bonds=H,Y.sym=U,Y.index=r.length,r.push(Y)}g=r.length}if(s.wrapAtoms&&l){let U=new u.Vector3;for(let V=0;V<A;V++){U.set(r[V].x,r[V].y,r[V].z);let W=k(U);U.add(W),r[V].x=U.x,r[V].y=U.y,r[V].z=U.z}}if(C>=0){const U=new u.Vector3;for(let V=0;V<A;V++)U.set(r[V].x,r[V].y,r[V].z),U.applyMatrix4(ae[C]),r[V].x=U.x,r[V].y=U.y,r[V].z=U.z}ae.length=0}}var fe=a(408);const De=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"]);function We(ae,r){const s=[],l=[];for(let C=0,E=ae.length;C<E;C++){const S=ae[C];S.index=C,S.hetflag||!De.has(S.resn)?l.push(S):s.push(S)}(0,ue.assignBonds)(l,r),s.sort(function(C,E){return C.chain!==E.chain?C.chain<E.chain?-1:1:C.resi-E.resi});let c,A=-1,g=-1;for(let C=0,E=s.length;C<E;C++){const S=s[C];S.resi!==A&&(A=S.resi,c||g++,c=!1),S.reschain=g;for(let k=C+1;k<s.length;k++){const D=s[k];if(D.chain!==S.chain||D.resi-S.resi>1)break;(0,fe.areConnected)(S,D,r)&&(S.bonds.indexOf(D.index)===-1&&(S.bonds.push(D.index),S.bondOrder.push(1),D.bonds.push(S.index),D.bondOrder.push(1)),S.resi!==D.resi&&(c=!0))}}}const oe=function(ae,r,s,l){return new u.Vector3(r,s,l).applyMatrix3(ae)};function Ae(ae,r={}){const s=[],l=!r.doAssembly,c=s.modelData=[],A=r.assignBonds===void 0||r.assignBonds;function g($,U){const V=[];let W=0,H=0;for(;H<$.length;){for(;$.substring(H,H+U.length)!==U&&H<$.length;)if($[H]==="'"){for(H++;H<$.length&&$[H]!=="'";)H++;for(;$.substring(H,H+U.length)!==U&&H<$.length;)H++}else if($[H]==='"'){for(H++;H<$.length&&$[H]!=='"';)H++;H++}else H++;V.push($.substring(W,H)),W=H+=U.length}return V}const C=ae.split(/\r?\n|\r/),E=[];let S=!1;for(let $=0;$<C.length;$++){var k=C[$].split("#")[0];if(S?k[0]===";"&&(S=!1):k[0]===";"&&(S=!0),S||k!==""){if(!S&&(k=k.trim())[0]==="_"){const U=k.split(/\s/)[0].indexOf(".");if(U>-1){let V=k.split("");V[U]="_",k=(k=V.join("")).substring(0,U)+"_"+k.substring(U+1)}}E.push(k)}}let D=0;for(;D<E.length;){for(;!E[D].startsWith("data_")||E[D]==="data_global";)D++;D++;const $={};for(;D<E.length&&!E[D].startsWith("data_");)if(E[D][0]===void 0)D++;else if(E[D][0]==="_"){const H=E[D].split(/\s/)[0].toLowerCase(),Y=$[H]=$[H]||[],J=E[D].substring(E[D].indexOf(H)+H.length);if(J==="")if(D++,E[D][0]===";"){let te=E[D].substring(1);for(D++;E[D]!==";";)te=te+`
`+E[D],D++;Y.push(te)}else Y.push(E[D]);else Y.push(J.trim());D++}else if(E[D].substring(0,5)==="loop_"){D++;const H=[];for(;E[D]===""||E[D][0]==="_";){if(E[D]!==""){let J=E[D].split(/\s/)[0].toLowerCase(),te=$[J]=$[J]||[];H.push(te)}D++}let Y=0;for(;D<E.length&&E[D][0]!=="_"&&!E[D].startsWith("loop_")&&!E[D].startsWith("data_");){let J=g(E[D]," ");for(let te=0;te<J.length;te++)J[te]!==""&&(H[Y].push(J[te]),Y=(Y+1)%H.length);D++}}else D++;c.push({symmetries:[]}),s.push([]);const U=$._atom_site_id!==void 0?$._atom_site_id.length:$._atom_site_label.length;let V;if($._cell_length_a!==void 0){const H=parseFloat($._cell_length_a),Y=parseFloat($._cell_length_b),J=parseFloat($._cell_length_c),te=parseFloat($._cell_angle_alpha)||90,de=parseFloat($._cell_angle_beta)||90,le=parseFloat($._cell_angle_gamma)||90;V=(0,u.conversionMatrix3)(H,Y,J,te,de,le),c[c.length-1].cryst={a:H,b:Y,c:J,alpha:te,beta:de,gamma:le}}for(let H=0;H<U;H++){if($._atom_site_group_pdb!==void 0&&$._atom_site_group_pdb[H]==="TER")continue;const Y={};if($._atom_site_cartn_x!==void 0)Y.x=parseFloat($._atom_site_cartn_x[H]),Y.y=parseFloat($._atom_site_cartn_y[H]),Y.z=parseFloat($._atom_site_cartn_z[H]);else{const te=oe(V,parseFloat($._atom_site_fract_x[H]),parseFloat($._atom_site_fract_y[H]),parseFloat($._atom_site_fract_z[H]));Y.x=te.x,Y.y=te.y,Y.z=te.z}Y.chain=$._atom_site_auth_asym_id?$._atom_site_auth_asym_id[H]:$._atom_site_label_asym_id?$._atom_site_label_asym_id[H]:void 0,Y.lchain=$._atom_site_label_asym_id?$._atom_site_label_asym_id[H]:void 0,Y.resi=$._atom_site_auth_seq_id?parseInt($._atom_site_auth_seq_id[H]):$._atom_site_label_seq_id?$._atom_site_label_seq_id[H]:void 0,Y.resn=$._atom_site_auth_comp_id?$._atom_site_auth_comp_id[H].trim():$._atom_site_label_comp_id?$._atom_site_label_comp_id[H].trim():void 0,Y.atom=$._atom_site_auth_atom_id?$._atom_site_auth_atom_id[H].replace(/"/gm,""):$._atom_site_label_atom_id?$._atom_site_label_atom_id[H].replace(/"/gm,""):void 0,Y.hetflag=!$._atom_site_group_pdb||$._atom_site_group_pdb[H]==="HETA"||$._atom_site_group_pdb[H]==="HETATM",$._atom_site_b_iso_or_equiv&&(Y.b=parseFloat($._atom_site_b_iso_or_equiv[H]));let J="X";$._atom_site_type_symbol?J=$._atom_site_type_symbol[H].replace(/\(?\+?\d+.*/,""):$._atom_site_label&&(J=$._atom_site_label[H].split("_")[0].replace(/\(?\d+.*/,"")),Y.elem=J[0].toUpperCase()+J.substring(1,2).toLowerCase(),Y.bonds=[],Y.ss="c",Y.serial=H,Y.bondOrder=[],Y.properties={},s[s.length-1].push(Y)}if($._pdbx_struct_oper_list_id!==void 0&&!l)for(let H=0;H<$._pdbx_struct_oper_list_id.length;H++){const Y=parseFloat($["_pdbx_struct_oper_list_matrix[1][1]"][H]),J=parseFloat($["_pdbx_struct_oper_list_matrix[1][2]"][H]),te=parseFloat($["_pdbx_struct_oper_list_matrix[1][3]"][H]),de=parseFloat($["_pdbx_struct_oper_list_vector[1]"][H]),le=parseFloat($["_pdbx_struct_oper_list_matrix[2][1]"][H]),ye=parseFloat($["_pdbx_struct_oper_list_matrix[2][2]"][H]),Pe=parseFloat($["_pdbx_struct_oper_list_matrix[2][3]"][H]),Te=parseFloat($["_pdbx_struct_oper_list_vector[2]"][H]),ke=parseFloat($["_pdbx_struct_oper_list_matrix[3][1]"][H]),be=parseFloat($["_pdbx_struct_oper_list_matrix[3][2]"][H]),Ge=parseFloat($["_pdbx_struct_oper_list_matrix[3][3]"][H]),Je=parseFloat($["_pdbx_struct_oper_list_vector[3]"][H]),tt=new u.Matrix4(Y,J,te,de,le,ye,Pe,Te,ke,be,Ge,Je);c[c.length-1].symmetries.push(tt)}const W=function(H){const Y=H.match("-"),J=(H=H.replace(/[-xyz]/g,"")).split("/");let te,de;return de=J[1]===void 0?1:parseInt(J[1]),te=J[0]===""?1:parseInt(J[0]),te/de*(Y?-1:1)};if($._symmetry_equiv_pos_as_xyz!==void 0&&!l)for(let H=0;H<$._symmetry_equiv_pos_as_xyz.length;H++){const Y=$._symmetry_equiv_pos_as_xyz[H].replace(/["' ]/g,"").split(",").map(function(le){return le.replace(/-/g,"+-")});let J=new u.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let le=0;le<3;le++){const ye=Y[le].split("+");for(let Pe=0;Pe<ye.length;Pe++){const Te=ye[Pe];if(Te==="")continue;const ke=W(Te);Te.match("x")?J.elements[le+0]=ke:Te.match("y")?J.elements[le+4]=ke:Te.match("z")?J.elements[le+8]=ke:J.elements[le+12]=ke}}const te=V.getMatrix4(),de=new u.Matrix4().getInverse(te,!0);J=new u.Matrix4().multiplyMatrices(J,de),J=new u.Matrix4().multiplyMatrices(te,J),c[c.length-1].symmetries.push(J)}}for(let $=0;$<s.length;$++)!A||r.duplicateAssemblyAtoms&&!r.dontConnectDuplicatedAtoms||We(s[$],r),X(s[$],r.hbondCutoff),Re(c[$].symmetries,s[$],r,c[$].cryst),r.duplicateAssemblyAtoms&&!r.dontConnectDuplicatedAtoms&&A&&We(s[$],r);return s}let He={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function Ue(ae,r){var s=[[]],l=!1;r.keepH!==void 0&&(l=!r.keepH);var c=ae.search(/@<TRIPOS>MOLECULE/),A=ae.search(/@<TRIPOS>ATOM/);if(c==-1||A==-1)return s;for(var g=ae.substring(c).split(/\r?\n|\r/);g.length>0;){var C=[],E=g[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),S=parseInt(E[0]),k=0;E.length>1&&(k=parseInt(E[1]));var D,$=4;for(D=3;D<g.length;D++)if(g[D]=="@<TRIPOS>ATOM"){$=D+1;break}var U=s[s.length-1].length,V=U+S;for(D=U;D<V;D++){var W={},H=(E=g[$++].replace(/^\s+/,"").replace(/\s+/g," ").split(" "))[5];if(H=He[H]!==void 0?He[H]:(H=H.split(".")[0])[0].toUpperCase()+H.substring(1).toLowerCase(),W.atom=E[1],W.elem=H,!(W.elem=="H"&&l)){var Y=s[s.length-1].length,J=parseInt(E[0]);W.serial=J,W.x=parseFloat(E[2]),W.y=parseFloat(E[3]),W.z=parseFloat(E[4]),W.atom=E[5];var te=parseFloat(E[8]);W.index=Y,W.bonds=[],W.bondOrder=[],W.properties={charge:te,partialCharge:te},C[J]=Y,s[s.length-1].push(W)}}for(var de=!1;$<g.length;)if(g[$++]=="@<TRIPOS>BOND"){de=!0;break}if(de&&k)for(D=0;D<k;D++){E=g[$++].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var le=parseInt(E[1]),ye=s[s.length-1][C[le]],Pe=parseInt(E[2]),Te=s[s.length-1][C[Pe]],ke=parseInt(E[3]);isNaN(ke)&&(ke=1),ye!==void 0&&Te!==void 0&&(ye.bonds.push(C[Pe]),ye.bondOrder.push(ke),Te.bonds.push(C[le]),Te.bondOrder.push(ke))}if(!r.multimodel)break;r.onemol||s.push([]),g.splice(0,$),ae=g.join(`
`)}return s}var Ie=a(40);function rt(ae,r){let s=ae.replace(/ /g,"");return s.length>0&&s[0]==="H"&&s!=="Hg"&&s!=="He"&&s!=="Hf"&&s!=="Hs"&&s!=="Ho"&&(s="H"),s.length>1&&(s=s[0].toUpperCase()+s.substring(1).toLowerCase(),Ie.bondTable[s]===void 0?s=s[0]:r&&(s==="Ca"||s==="Cd")&&(s="C")),s}function st(ae){for(const r in ae)return!1;return!0}function at(ae,r,s){const l=[],c=r.assignBonds===void 0||r.assignBonds,A=!r.keepH,g=!!r.noSecondaryStructure,C=!r.noComputeSecondaryStructure,E=!r.doAssembly,S=r.altLoc?r.altLoc:"A",k={symmetries:[],cryst:void 0};let D,$=[];const U=[];let V;const W={};for(let H=0;H<ae.length;H++){V=ae[H].replace(/^\s*/,"");const Y=V.substring(0,6);let J,te,de;if(Y.indexOf("END")===0){if($=ae.slice(H+1),Y==="END")for(const le in s)s.hasOwnProperty(le)&&delete s[le];break}if(Y==="ATOM  "||Y==="HETATM"){let le,ye,Pe,Te,ke,be,Ge,Je,tt,Ye,ut,ft;if(ut=V.substring(16,17),ut!==" "&&ut!==S&&S!=="*"||(Ye=parseInt(V.substring(6,11)),D=V.substring(12,16).replace(/ /g,""),le=V.substring(17,20).replace(/ /g,""),ye=V.substring(21,22),Pe=parseInt(V.substring(22,26)),Te=V.substring(26,27),ke=parseFloat(V.substring(30,38)),be=parseFloat(V.substring(38,46)),Ge=parseFloat(V.substring(46,54)),ft=parseFloat(V.substring(60,68)),tt=V.substring(76,78).replace(/ /g,""),tt=tt===""||Ie.bondTable[tt]===void 0?rt(V.substring(12,14),V[0]=="A"):tt[0].toUpperCase()+tt.substring(1).toLowerCase(),tt==="H"&&A))continue;Je=Y[0]=="H",U[Ye]=l.length,l.push({resn:le,x:ke,y:be,z:Ge,elem:tt,hetflag:Je,altLoc:ut,chain:ye,resi:Pe,icode:Te,rescode:Pe+(Te!==" "?"^"+Te:""),serial:Ye,atom:D,bonds:[],ss:"c",bondOrder:[],properties:{},b:ft,pdbline:V})}else if(Y==="SHEET "){J=V.substring(21,22),te=parseInt(V.substring(22,26)),de=parseInt(V.substring(33,37)),J in s||(s[J]={}),s[J][te]="s1";for(let le=te+1;le<de;le++)s[J][le]="s";s[J][de]="s2"}else if(Y==="CONECT"){const le=U[parseInt(V.substring(6,11))],ye=l[le],Pe=[11,16,21,26];for(let Te=0;Te<4;Te++){const ke=U[parseInt(V.substring(Pe[Te],Pe[Te]+5))];let be=le+":"+ke;const Ge=l[ke];if(ye!==void 0&&Ge!==void 0)if(W[be]){W[be]+=1;for(let Je=0;Je<ye.bonds.length;Je++)if(ye.bonds[Je]==ke){const tt=W[be];ye.bondOrder[Je]=tt>=4?1:tt}}else W[be]=1,ye.bonds.length!=0&&ye.bonds[ye.bonds.length-1]===ke||(ye.bonds.push(ke),ye.bondOrder.push(1))}}else if(Y==="HELIX "){J=V.substring(19,20),te=parseInt(V.substring(21,25)),de=parseInt(V.substring(33,37)),J in s||(s[J]={}),s[J][te]="h1";for(let le=te+1;le<de;le++)s[J][le]="h";s[J][de]="h2"}else if(E||Y!=="REMARK"||V.substring(13,18)!=="BIOMT"){if(Y==="CRYST1"){let le,ye,Pe,Te,ke,be;le=parseFloat(V.substring(7,15)),ye=parseFloat(V.substring(16,24)),Pe=parseFloat(V.substring(25,33)),Te=parseFloat(V.substring(34,40)),ke=parseFloat(V.substring(41,47)),be=parseFloat(V.substring(48,54)),k.cryst={a:le,b:ye,c:Pe,alpha:Te,beta:ke,gamma:be}}else if(Y==="ANISOU"){const le=l[U[parseInt(V.substring(6,11))]];if(le){const ye=V.substring(30).trim().split(/\s+/),Pe={u11:parseInt(ye[0]),u22:parseInt(ye[1]),u33:parseInt(ye[2]),u12:parseInt(ye[3]),u13:parseInt(ye[4]),u23:parseInt(ye[5])};le.uMat=Pe}}}else{let le,ye=new u.Matrix4;for(le=1;le<=3;le++)if(V=ae[H].replace(/^\s*/,""),parseInt(V.substring(18,19))==le)ye.elements[le-1]=parseFloat(V.substring(23,33)),ye.elements[le-1+4]=parseFloat(V.substring(33,43)),ye.elements[le-1+8]=parseFloat(V.substring(43,53)),ye.elements[le-1+12]=parseFloat(V.substring(53)),H++;else for(;V.substring(13,18)==="BIOMT";)H++,V=ae[H].replace(/^\s*/,"");ye.elements[3]=0,ye.elements[7]=0,ye.elements[11]=0,ye.elements[15]=1,k.symmetries.push(ye),H--}}if((function(H,Y){for(let J=0,te=H.length;J<te;J++){const de=H[J];for(let le=0;le<de.bonds.length;le++){const ye=H[de.bonds[le]],Pe=Y[de.serial];ye&&Pe&&ye.bonds.indexOf(Pe)<0&&(ye.bonds.push(Pe),ye.bondOrder.push(de.bondOrder[le]))}}})(l,U),c&&We(l,r),E||Re(k.symmetries,l,r,k.cryst),C&&!g&&X(l,r.hbondCutoff),!st(s))for(let H=0;H<l.length;H++){const Y=l[H];if(Y!==void 0&&Y.chain in s&&Y.resi in s[Y.chain]){const J=s[Y.chain][Y.resi];Y.ss=J[0],J.length>1&&(J[1]=="1"?Y.ssbegin=!0:J[1]=="2"&&(Y.ssend=!0))}}return[l,k,$]}function Ft(ae,r){r=r||{};var s=[],l={};s.modelData=[];for(var c=ae.split(/\r?\n|\r/);c.length>0;){var A=at(c,r,l),g=A[0],C=A[1];if(c=A[2],g.length!=0){if(r.multimodel&&r.onemol&&s.length>0)for(var E=s[0].length,S=0;S<g.length;S++){var k=g[S];k.index=S;for(var D=0;D<k.bonds.length;D++)k.bonds[D]+=E;s[0].push(k)}else s.modelData.push(C),s.push(g);if(!r.multimodel)break}}return s}function Ct(ae,r){var s=[[]],l=!r.noSecondaryStructure;s.modelData=[{symmetries:[]}];var c,A=[],g=ae.split(/\r?\n|\r/);for(let de=0;de<g.length;de++){var C=(c=g[de].replace(/^\s*/,"")).substring(0,6);if(C.indexOf("END")==0){if(r.multimodel){r.onemol||s.push([]);continue}break}if(C=="ATOM  "||C=="HETATM"){var E;let le=parseInt(c.substring(6,11)),ye=c.substring(12,16).replace(/ /g,""),Pe=c.substring(17,20).trim(),Te=c.substring(21,22),ke=parseInt(c.substring(22,26));var S=c.substring(30).trim().split(/\s+/),k=parseFloat(S[0]),D=parseFloat(S[1]),$=parseFloat(S[2]),U=parseFloat(S[3]),V=parseFloat(S[4]),W=ye[0];ye.length>1&&ye[1].toUpperCase()!=ye[1]&&(W=ye.substring(0,2)),E=c[0]=="H",A[le]=s[s.length-1].length,s[s.length-1].push({resn:Pe,x:k,y:D,z:$,elem:W,hetflag:E,chain:Te,resi:ke,serial:le,atom:ye,bonds:[],ss:"c",bondOrder:[],properties:{charge:U,partialCharge:U,radius:V},pdbline:c})}else if(C=="CONECT"){var H=parseInt(c.substring(6,11)),Y=s[s.length-1][A[H]];for(let le=0;le<4;le++){var J=parseInt(c.substring([11,16,21,26][le],[11,16,21,26][le]+5)),te=s[s.length-1][A[J]];Y!==void 0&&te!==void 0&&(Y.bonds.push(A[J]),Y.bondOrder.push(1))}}}for(let de=0;de<s.length;de++)We(s[de],r),l&&X(s[de],r.hbondCutoff);return s}var or=a(471),ar=function(ae){return String.fromCharCode.apply(null,ae).replace(/\0/g,"")},kr=function(ae){return ae==0||ae==2||ae==4?"h":ae==3?"s":"c"};let Ar=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function pr(ae,r){var s=!r.keepH,l=r.altLoc?r.altLoc:"A",c=!!r.noSecondaryStructure,A=!r.noComputeSecondaryStructure,g=!r.doAssembly,C=r.assemblyIndex?r.assemblyIndex:0;ae=typeof ae=="string"?(0,b.base64ToArray)(ae):new Uint8Array(ae);var E,S,k,D,$,U,V=or.decode(ae),W=[[]],H=W.modelData=[],Y=0,J=0,te=0,de=V.secStructList,le=V.bFactorList,ye=V.altLocList,Pe=V.occupancyList,Te=V.bondAtomList,ke=V.bondOrderList,be=V.numModels;if(be==0)return W;r.multimodel||(be=1);var Ge=[];if(!g&&V.bioAssemblyList&&V.bioAssemblyList.length>0){var Je=V.bioAssemblyList[C].transformList;for(E=0,U=Je.length;E<U;E++){var tt=new u.Matrix4(Je[E].matrix);tt.transpose(),Ge.push(tt)}}var Ye=null;if(V.unitCell){var ut=V.unitCell;Ye={a:ut[0],b:ut[1],c:ut[2],alpha:ut[3],beta:ut[4],gamma:ut[5]}}let ft=[];V.entityList.forEach(K=>{K.chainIndexList.forEach(v=>{ft[v]=K.type=="polymer"})});var Qe=0;for($=0;$<be;$++){var pt=V.chainsPerModel[$],Be=W[W.length-1],et=[];for(H.push({symmetries:Ge,cryst:Ye}),E=0;E<pt;++E){var St=V.groupsPerChain[Y],ot=ar(V.chainIdList.subarray(4*Y,4*Y+4));V.chainNameList&&(ot=ar(V.chainNameList.subarray(4*Y,4*Y+4)));var bt=J,At="";for(S=0;S<St;++S){var it=V.groupList[V.groupTypeList[J]],Rt=it.atomNameList.length,Ht=0,kt=!1,ct=!1;if(de){Ht=de[J];var Jt=kr(Ht);J!=0&&Jt==At||(kt=!0),At=Jt;var Nt=J+1;(Nt>=de.length||kr(de[Nt]!=Jt))&&(ct=!0)}var Zt=V.groupIdList[J],Vt=it.groupName;let K=it.chemCompType;var Xt=te;let v=Ar.has(K)||!ft[Y];for(k=0;k<Rt;++k){var yr=it.elementList[k];if(s&&yr=="H")te+=1;else{var Fr="";le&&(Fr=le[te]);var Tr="";ye&&ye[te]&&(Tr=String.fromCharCode(ye[te]));var ii="";if(Pe&&(ii=Pe[te]),Tr==""||Tr==l||l=="*"){var Wr=V.atomIdList[te],wr=it.atomNameList[k],$r=0;it.atomChargeList&&($r=it.atomChargeList[k]);var ci=V.xCoordList[te],ni=V.yCoordList[te],hi=V.zCoordList[te];et[te]=Be.length,Be.push({resn:Vt,x:ci,y:ni,z:hi,elem:yr,hetflag:v,chain:ot,resi:Zt,icode:Tr,rescode:Zt+(Tr!=" "?"^"+Tr:""),serial:Wr,altLoc:Tr,index:te,atom:wr,bonds:[],ss:kr(Ht),ssbegin:kt,ssend:ct,bondOrder:[],properties:{charge:$r,occupancy:ii},b:Fr}),te+=1}else te+=1}}var zi=it.bondAtomList;for(k=0,D=it.bondOrderList.length;k<D;++k){var xi=Xt+zi[2*k],Ii=Xt+zi[2*k+1],Hr=it.bondOrderList[k],Xr=et[xi],Zr=et[Ii],ei=Be[Xr],f=Be[Zr];ei&&f&&(ei.bonds.push(Zr),ei.bondOrder.push(Hr),f.bonds.push(Xr),f.bondOrder.push(Hr))}J+=1}for(J=bt,S=0;S<St;++S)J+=1;Y+=1}if(Te)for(let K=Qe,v=Te.length;K<v;K+=2){let we=Te[K],_e=Te[K+1],ve=ke?ke[K/2]:1;if(we>=te){Qe=K;break}let Xe=et[we],ze=et[_e],gt=Be[Xe],Ne=Be[ze];gt&&Ne&&(gt.bonds.push(ze),gt.bondOrder.push(ve),Ne.bonds.push(Xe),Ne.bondOrder.push(ve))}r.multimodel&&(r.onemol||W.push([]))}if(!g)for(let K=0;K<W.length;K++)Re(H[K].symmetries,W[K],r,H[K].cryst);return A&&!c&&X(W,r.hbondCutoff),W}function vr(ae){var r,s=[],l=0,c=ae.split(/\r?\n|\r/);if(!(c.length>0&&c[0].includes("VERSION")))return[];{var A=c.filter(function(V){return V.includes("POINTERS")||V.includes("ATOM_NAME")||V.includes("CHARGE")||V.includes("RADII")||V.includes("BONDS_INC_HYDROGEN")||V.includes("BONDS_WITHOUT_HYDROGEN")||V.includes("RESIDUE_LABEL")||V.includes("RESIDUE_POINTER")}),g=D("POINTERS");if(g==-1)return[];var C=$(g),E=parseInt(c[g+1].slice(0,C[1]));let U=parseInt(c[g+2].slice(C[1],C[0]+C[1]));if(isNaN(E)||E<=0)return[];if((g=D("ATOM_NAME"))==-1)return[];var S=(C=$(g))[0];for(let V=0;V<E/C[0];V++){V==parseInt(E/C[0])&&(S=E%C[0]);for(let W=0;W<S;W++){let H={},Y={charge:"",radii:""};H.serial=l,H.x=0,H.y=0,H.z=0,H.atom=c[g+1].slice(C[1]*W,C[1]*(W+1)).trim(),H.elem=c[g+1].slice(C[1]*W,C[1]*W+1).trim(),H.properties=Y,H.bonds=[],H.bondOrder=[],H.index=s.length,s.push(H),l++}g++}if((g=D("CHARGE"))!=-1){l=0,S=(C=$(g))[0];for(let V=0;V<E/C[0];V++){V==parseInt(E/C[0])&&(S=E%C[0]);for(let W=0;W<S;W++)s[l].properties.charge=parseFloat(c[g+1].slice(C[1]*W,C[1]*(W+1))),l++;g++}}var k=[];if((g=D("RESIDUE_POINTER"))!=-1){S=(C=$(g))[0],g+=1;for(let V=0;V<U/C[0];V++){V==parseInt(U/C[0])&&(S=U%C[0]);for(let W=0;W<S;W++)k.push(parseInt(c[g].slice(C[1]*W,C[1]*(W+1))));g++}if((g=D("RESIDUE_LABEL"))!=-1){let V=[];S=(C=$(g))[0],g+=1;for(let J=0;J<U/C[0];J++){J==parseInt(U/C[0])&&(S=U%C[0]);for(let te=0;te<S;te++)V.push(c[g].slice(C[1]*te,C[1]*(te+1)).trim());g++}let W=0,H=0,Y="";k.push(s.length+1);for(let J=0;J<s.length;J++)J+1>=k[W]&&(Y=V[W],W+=1,H+=1),s[J].resi=H,s[J].resn=Y}}if((g=D("RADII"))!=-1){l=0,S=(C=$(g))[0];for(let V=0;V<E/C[0];V++){V==parseInt(E/C[0])&&(S=E%C[0]);for(let W=0;W<S;W++)s[l].properties.radii=parseFloat(c[g+1].slice(C[1]*W,C[1]*(W+1))),l++;g++}}if((g=D("BONDS_WITHOUT_HYDROGEN"))!=-1)for(l=0,S=(C=$(g))[0],g+=1;!c[g].match(/^%FLAG/);){c[g+1].match(/^%FLAG/)&&(S=E%C[0]);for(let V=0;V<S;V++)l%3==0?r=parseInt(c[g].slice(C[1]*V,C[1]*(V+1))/3):l%3==1&&(s[r].bonds.push(parseInt(c[g].slice(C[1]*V,C[1]*(V+1))/3)),s[r].bondOrder.push(1)),l++;g++}if((g=D("BONDS_INC_HYDROGEN"))!=-1)for(l=0,S=(C=$(g))[0],g+=1;!c[g].match(/^%FLAG/);){c[g+1].match(/^%FLAG/)&&(S=E%C[0]);for(let V=0;V<S;V++)l%3==0?r=parseInt(c[g].slice(C[1]*V,C[1]*(V+1))/3):l%3==1&&(s[r].bonds.push(parseInt(c[g].slice(C[1]*V,C[1]*(V+1))/3)),s[r].bonds.push(1)),l++;g++}}function D(U){var V=c.indexOf(A.filter(function(W){return W.includes(U)})[0]);if(Number.isInteger(V)&&V>0){for(;!c[V].includes("FORMAT");)V++;return V}return-1}function $(U){var V=c[U].match(/\((\d*)\S*/),W=c[U].match(/[a-zA-Z](\d*)\)\s*/);return W==null&&(W=c[U].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[parseInt(V[1]),parseInt(W[1])]}return[s]}function xr(ae,r){const s=[],l=ae.split(/\r?\n|\r/);for(;l.length>0;){const c=parseInt(l[1]);if(l.length<3||isNaN(c)||c<=0||l.length<c+3)break;const A=[];s.push(A);let g=2;const C=A.length,E=C+c;for(let S=C;S<E;S++){const k=l[g++],D={};D.serial=S,D.atom=k.slice(10,15).trim(),D.elem=rt(D.atom,!0),D.x=10*parseFloat(k.slice(20,28)),D.y=10*parseFloat(k.slice(28,36)),D.z=10*parseFloat(k.slice(36,44)),D.resi=parseInt(k.slice(0,5)),D.resn=k.slice(5,10).trim(),D.bonds=[],D.bondOrder=[],D.properties={},k.length>44&&(D.dx=10*parseFloat(k.slice(44,52)),D.dy=10*parseFloat(k.slice(52,60)),D.dz=10*parseFloat(k.slice(60,68))),A[S]=D}if(l.length<=g+3){const S=l[g++].trim().split(/\s+/);if(S.length===3){for(let k=0;k<3;k++)S[k]=(10*parseFloat(S[k])).toString();s.box=S}}l.splice(0,++g)}for(let c=0;c<s.length;c++)We(s[c],r);return s}const fi={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function Rr(ae,r){const s=[],l=ae.split(/\r?\n|\r/);let c=0,A=0,g=0;for(;g<l.length-9;){for(var C=g;C<l.length;C++)if(l[C].match(/ITEM: NUMBER OF ATOMS/)&&(A=parseInt(l[C+1])),l[C].match(/ITEM: ATOMS/)){c=C+1;break}const E=l[c-1].replace("ITEM: ATOMS ","").split(" ");s.push([]);for(let S=c;S<c+A;S++){const k={},D={},$=l[S].split(" ");for(let U=0;U<$.length;U++){const V=fi[E[U]];V!==void 0&&(V==="serial"?k[V]=parseInt($[U]):V==="x"||V==="y"||V==="z"?k[V]=parseFloat($[U]):V==="charge"||V==="radius"?D[V]=parseFloat($[U]):k[V]=$[U]),k.properties=D,k.bonds=[],k.bondOrder=[]}s[s.length-1][S-c]=k}g=c+A-1}if(r.assignBonds)for(let E=0;E<s.length;E++)(0,ue.assignBonds)(s[E],r);return s}var Ir;(function(ae){(function(r){r[r.Int8=1]="Int8",r[r.Int16=2]="Int16",r[r.Int32=3]="Int32",r[r.Uint8=4]="Uint8",r[r.Uint16=5]="Uint16",r[r.Uint32=6]="Uint32"})(ae.IntDataType||(ae.IntDataType={})),(function(r){r[r.Float32=32]="Float32",r[r.Float64=33]="Float64"})(ae.FloatDataType||(ae.FloatDataType={})),ae.getDataType=function(r){let s;return s=r instanceof Int8Array?ae.IntDataType.Int8:r instanceof Int16Array?ae.IntDataType.Int16:r instanceof Int32Array?ae.IntDataType.Int32:r instanceof Uint8Array?ae.IntDataType.Uint8:r instanceof Uint16Array?ae.IntDataType.Uint16:r instanceof Uint32Array?ae.IntDataType.Uint32:r instanceof Float32Array?ae.FloatDataType.Float32:r instanceof Float64Array?ae.FloatDataType.Float64:ae.IntDataType.Int32,s},ae.isSignedIntegerDataType=function(r){if(r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array)return!0;for(let s=0,l=r.length;s<l;s++)if(s<0)return!1;return!0}})(Ir||(Ir={}));const Di=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function bi(ae){let r=ae.data;for(let s=ae.encoding.length-1;s>=0;s--)r=Hi(r,ae.encoding[s]);return r}function Hi(ae,r){switch(r.kind){case"ByteArray":switch(r.type){case Ir.IntDataType.Uint8:return ae;case Ir.IntDataType.Int8:return(function(s){return new Int8Array(s.buffer,s.byteOffset)})(ae);case Ir.IntDataType.Int16:return(function(s){return Le(s,2,Int16Array)})(ae);case Ir.IntDataType.Uint16:return(function(s){return Le(s,2,Uint16Array)})(ae);case Ir.IntDataType.Int32:return(function(s){return Le(s,4,Int32Array)})(ae);case Ir.IntDataType.Uint32:return(function(s){return Le(s,4,Uint32Array)})(ae);case Ir.FloatDataType.Float32:return(function(s){return Le(s,4,Float32Array)})(ae);case Ir.FloatDataType.Float64:return(function(s){return Le(s,8,Float64Array)})(ae);default:throw new Error("unreachable")}case"FixedPoint":return(function(s,l){const c=s.length,A=Se(l.srcType,c),g=1/l.factor;for(let C=0;C<c;C++)A[C]=g*s[C];return A})(ae,r);case"IntervalQuantization":return(function(s,l){const c=s.length,A=Se(l.srcType,c),g=(l.max-l.min)/(l.numSteps-1),C=l.min;for(let E=0;E<c;E++)A[E]=C+g*s[E];return A})(ae,r);case"RunLength":return(function(s,l){const c=pe(l.srcType,l.srcSize);let A=0;for(let g=0,C=s.length;g<C;g+=2){const E=s[g],S=s[g+1];for(let k=0;k<S;++k)c[A++]=E}return c})(ae,r);case"Delta":return(function(s,l){const c=s.length,A=pe(l.srcType,c);if(!c)return s;A[0]=s[0]+(0|l.origin);for(let g=1;g<c;++g)A[g]=s[g]+A[g-1];return A})(ae,r);case"IntegerPacking":return(function(s,l){return s.length===l.srcSize?s:l.isUnsigned?(function(c,A){const g=A.byteCount===1?255:65535,C=c.length,E=new Int32Array(A.srcSize);let S=0,k=0;for(;S<C;){let D=0,$=c[S];for(;$===g;)D+=$,S++,$=c[S];D+=$,E[k]=D,S++,k++}return E})(s,l):(function(c,A){const g=A.byteCount===1?127:32767,C=-g-1,E=c.length,S=new Int32Array(A.srcSize);let k=0,D=0;for(;k<E;){let $=0,U=c[k];for(;U===g||U===C;)$+=U,k++,U=c[k];$+=U,S[D]=$,k++,D++}return S})(s,l)})(ae,r);case"StringArray":return(function(s,l){const c=bi({encoding:l.offsetEncoding,data:l.offsets}),A=bi({encoding:l.dataEncoding,data:s}),g=l.stringData,C=new Array(c.length);C[0]="";for(let k=1,D=c.length;k<D;k++)C[k]=g.substring(c[k-1],c[k]);let E=0;const S=new Array(A.length);for(let k=0,D=A.length;k<D;k++)S[E++]=C[A[k]+1];return S})(ae,r)}}function pe(ae,r){switch(ae){case Ir.IntDataType.Int8:return new Int8Array(r);case Ir.IntDataType.Int16:return new Int16Array(r);case Ir.IntDataType.Int32:return new Int32Array(r);case Ir.IntDataType.Uint8:return new Uint8Array(r);case Ir.IntDataType.Uint16:return new Uint16Array(r);case Ir.IntDataType.Uint32:return new Uint32Array(r);default:return new Int32Array(r)}}function Se(ae,r){switch(ae){case Ir.FloatDataType.Float32:return new Float32Array(r);case Ir.FloatDataType.Float64:default:return new Float64Array(r)}}function Le(ae,r,s){return ae.byteOffset==0&&ae.byteLength==ae.buffer.byteLength||(ae=new Uint8Array(ae)),new s(Di?ae.buffer:(function(l,c){const A=new ArrayBuffer(l.length),g=new Uint8Array(A);for(let C=0,E=l.length;C<E;C+=c)for(let S=0;S<c;S++)g[C+c-S-1]=l[C+S];return A})(ae,r))}function dt(ae){const r=Object.create(null),s=Object.create(null);for(const l of ae.columns)r[l.name]=l;return{rowCount:ae.rowCount,name:ae.name.substring(1),fieldNames:ae.columns.map(l=>l.name),getField(l){const c=r[l];if(c)return s[l]||(s[l]=bi(c.data)),s[l]}}}var nt=a(471);class zt{constructor(r){if(this.C={},r){let s=r.getField("comp_id"),l=r.getField("atom_id_1"),c=r.getField("atom_id_2"),A=r.getField("value_order");for(let g=0;g<s.length;g++){let C=s[g],E=l[g],S=c[g],k=A[g],D=1;k=="doub"?D=2:k=="trip"&&(D=3),this.C[C]==null&&(this.C[C]={}),this.C[C][E]==null&&(this.C[C][E]={}),this.C[C][S]==null&&(this.C[C][S]={}),this.C[C][E][S]=D,this.C[C][S][E]=D}}}order(r,s,l){return this.C[r]!==void 0&&this.C[r][s]!==void 0&&this.C[r][s][l]!==void 0?this.C[r][s][l]:0}}class ht{constructor(r){if(this.C=[],r){let s=r.getField("conn_type_id"),l=r.getField("ptnr1_label_asym_id"),c=r.getField("ptnr1_label_seq_id"),A=r.getField("ptnr1_label_comp_id"),g=r.getField("ptnr1_label_atom_id"),C=r.getField("ptnr2_label_asym_id"),E=r.getField("ptnr2_label_seq_id"),S=r.getField("ptnr2_label_comp_id"),k=r.getField("ptnr2_label_atom_id"),D=r.getField("pdbx_value_order");for(let $=0;$<s.length;$++)if(s[$]=="disulf"||s[$]=="covale"){let U=D?D[$]==""?1:parseInt(D[$]):1;this.C.push([[l[$],c[$],A[$],g[$]],[C[$],E[$],S[$],k[$]],U])}}}}class Lt{constructor(){this.R={}}add(r){this.R[r.lchain]==null&&(this.R[r.lchain]={}),this.R[r.lchain][r.lresi]==null&&(this.R[r.lchain][r.lresi]={}),this.R[r.lchain][r.lresi][r.lresn]==null&&(this.R[r.lchain][r.lresi][r.lresn]=[]),this.R[r.lchain][r.lresi][r.lresn].push(r),this.R[r.lchain][r.lresi][r.lresn][r.atom]=r}geta([r,s,l,c]){if(this.R[r]!==void 0&&this.R[r][s]!==void 0&&this.R[r][s][l]!==void 0)return this.R[r][s][l][c]}setBonds(r,s){for(let l in this.R)for(let c in this.R[l])for(let A in this.R[l][c]){let g=this.R[l][c][A];for(let C=0;C<g.length;C++)for(let E=C+1;E<g.length;E++){let S=g[C],k=g[E],D=r.order(A,S.atom,k.atom);S.altLoc!=k.altLoc&&S.altLoc!=""&&k.altLoc!=""&&(D=0),D>0&&(S.bonds.push(k.index),k.bonds.push(S.index),S.bondOrder.push(D),k.bondOrder.push(D))}}for(let l of s.C){let c=l[0],A=l[1],g=l[2],C=this.geta(c),E=this.geta(A);C!=null&&E!=null&&(C.bonds.push(E.index),E.bonds.push(C.index),C.bondOrder.push(g),E.bondOrder.push(g))}}}function Ut(ae,r){var s=!r.keepH,l=r.altLoc?r.altLoc:"A",c=!r.noComputeSecondaryStructure;const A=!r.doAssembly,g=r.assignBonds===void 0||r.assignBonds;if(typeof ae=="string")try{ae=(0,b.base64ToArray)(ae)}catch{ae=new TextEncoder().encode(ae)}else ae=new Uint8Array(ae);var C=nt.decodeMsgpack(ae);C==31&&(ae=(0,b.inflateString)(ae,!1),C=nt.decodeMsgpack(ae));var E=[],S=E.modelData=[],k=C.dataBlocks.length;if(k==0)return E;r.multimodel||(k=1);for(let D=0;D<k;D++){let $=E.length;const U=[];S.push({symmetries:[]}),E.push([]);const V=C.dataBlocks[D],W=Object.create(null);for(const kt of V.categories)W[kt.name.substr(1)]=dt(kt);let H={},Y=W.struct_conf;if(Y){let kt=Y.getField("conf_type_id"),ct=Y.getField("beg_label_asym_id"),Jt=Y.getField("beg_label_seq_id"),Nt=Y.getField("end_label_seq_id");for(let Zt=0;Zt<kt.length;Zt++)if(kt[Zt].startsWith("H")){let Vt=ct[Zt],Xt=Jt[Zt],yr=Nt[Zt];Vt in H||(H[Vt]={}),H[Vt][Xt]="h1";for(let Fr=Xt+1;Fr<yr;Fr++)H[Vt][Fr]="h";H[Vt][yr]="h2"}}let J=W.struct_sheet_range;if(J){let kt=J.getField("id"),ct=J.getField("beg_label_asym_id"),Jt=J.getField("beg_label_seq_id"),Nt=J.getField("end_label_seq_id");for(let Zt=0;Zt<kt.length;Zt++){let Vt=ct[Zt],Xt=Jt[Zt],yr=Nt[Zt];Vt in H||(H[Vt]={}),H[Vt][Xt]="s1";for(let Fr=Xt+1;Fr<yr;Fr++)H[Vt][Fr]="s";H[Vt][yr]="s2"}}let te=W.pdbx_struct_oper_list,de=te.getField("id");if(de&&!A){let kt=te.getField("matrix[1][1]"),ct=te.getField("matrix[1][2]"),Jt=te.getField("matrix[1][3]"),Nt=te.getField("matrix[2][1]"),Zt=te.getField("matrix[2][2]"),Vt=te.getField("matrix[2][3]"),Xt=te.getField("matrix[3][1]"),yr=te.getField("matrix[3][2]"),Fr=te.getField("matrix[3][3]"),Tr=te.getField("vector[1]"),ii=te.getField("vector[2]"),Wr=te.getField("vector[3]");for(let wr=0;wr<de.length;wr++){const $r=new u.Matrix4(kt[wr],ct[wr],Jt[wr],Tr[wr],Nt[wr],Zt[wr],Vt[wr],ii[wr],Xt[wr],yr[wr],Fr[wr],Wr[wr]);S[S.length-1].symmetries.push($r)}}let le=new zt(W.chem_comp_bond),ye=new Lt,Pe=new ht(W.struct_conn),Te=W.atom_site,ke=Te.rowCount,be=Te.getField("group_PDB"),Ge=Te.getField("Cartn_x"),Je=Te.getField("Cartn_y"),tt=Te.getField("Cartn_z"),Ye=Te.getField("auth_asym_id"),ut=Te.getField("label_asym_id"),ft=Te.getField("auth_seq_id"),Qe=Te.getField("label_seq_id"),pt=Te.getField("auth_comp_id"),Be=Te.getField("label_comp_id"),et=Te.getField("auth_atom_id"),St=Te.getField("label_atom_id"),ot=Te.getField("type_symbol"),bt=Te.getField("B_iso_or_equiv"),At=Te.getField("id"),it=Te.getField("label_alt_id"),Rt=Te.getField("pdbx_PDB_model_num"),Ht=Rt?Rt[0]:0;for(let kt=0;kt<ke;kt++){if(be!==void 0&&be[kt]==="TER")continue;if(Rt&&Rt[kt]!=Ht){if(Ht=Rt[kt],!r.multimodel)break;r.onemol||(E.push([]),S.push(S[S.length-1]),Ht=Rt[kt],ye.setBonds(le,Pe),ye=new Lt)}const ct={};ct.x=Ge[kt],ct.y=Je[kt],ct.z=tt[kt],ct.chain=Ye?Ye[kt]:ut?ut[kt]:void 0,ct.lchain=ut?ut[kt]:void 0,ct.resi=ft?ft[kt]:Qe?Qe[kt]:void 0,ct.lresi=Qe?Qe[kt]:void 0,ct.resn=pt?pt[kt].trim():Be?Be[kt].trim():void 0,ct.lresn=Be?Be[kt].trim():void 0,ct.atom=et?et[kt].replace(/"/gm,""):St?St[kt].replace(/"/gm,""):void 0,ct.icode=it?it[kt]:void 0,ct.altLoc=ct.icode,ct.hetflag=!be||be[kt]==="HETA"||be[kt]==="HETATM";let Jt="X";ot&&(Jt=ot[kt].replace(/\(?\+?\d+.*/,"")),ct.elem=Jt[0].toUpperCase()+Jt.substring(1,2).toLowerCase(),bt&&(ct.b=bt[kt]),s&&ct.elem=="H"||ct.altLoc!=""&&ct.altLoc!=l&&l!="*"||(ct.bonds=[],ct.ss="c",ct.serial=At[kt],ct.model=Ht,ct.bondOrder=[],ct.properties={},ct.index=E[E.length-1].length,U[ct.serial]=[E.length,ct.index],E[E.length-1].push(ct),ye.add(ct))}if(ye.setBonds(le,Pe),!st(H))for(let kt=$;kt<E.length;kt++){let ct=E[kt];for(let Jt=0;Jt<ct.length;Jt++){const Nt=ct[Jt];if(Nt!==void 0&&Nt.lchain in H&&Nt.lresi in H[Nt.lchain]){const Zt=H[Nt.lchain][Nt.lresi];Nt.ss=Zt[0],Zt.length>1&&(Zt[1]=="1"?Nt.ssbegin=!0:Zt[1]=="2"&&(Nt.ssend=!0))}}}r.multimodel&&D<k-1&&(r.onemol||(E.push([]),S.push({symmetries:[]})))}for(let D=0;D<E.length;D++)!g||r.duplicateAssemblyAtoms&&!r.dontConnectDuplicatedAtoms||We(E[D],r),c&&X(E[D],r.hbondCutoff),Re(S[D].symmetries,E[D],r,S[D].cryst),r.duplicateAssemblyAtoms&&!r.dontConnectDuplicatedAtoms&&g&&We(E[D],r);return E}const It={vasp:me.VASP,VASP:me.VASP,cube:Me.CUBE,CUBE:Me.CUBE,xyz:P,XYZ:P,sdf:ce,SDF:ce,json:se,cdjson:se,CDJSON:se,mcif:Ae,cif:Ae,CIF:Ae,mol2:Ue,MOL2:Ue,pdb:Ft,PDB:Ft,pdbqt:Ft,PDBQT:Ft,pqr:Ct,PQR:Ct,mmtf:pr,MMTF:pr,prmtop:vr,PRMTOP:vr,gro:xr,GRO:xr,lammpstrj:Rr,LAMMPSTRJ:Rr,bcif:Ut,BCIF:Ut};function mr(ae,r="utf8"){return new TextDecoder(r).decode(ae)}const li=new TextEncoder,Ci=(()=>{const ae=new Uint8Array(4);return!((new Uint32Array(ae.buffer)[0]=1)&ae[0])})(),ui={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class gi{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(r=8192,s={}){let l=!1;typeof r=="number"?r=new ArrayBuffer(r):(l=!0,this.lastWrittenByte=r.byteLength);const c=s.offset?s.offset>>>0:0,A=r.byteLength-c;let g=c;(ArrayBuffer.isView(r)||r instanceof gi)&&(r.byteLength!==r.buffer.byteLength&&(g=r.byteOffset+c),r=r.buffer),this.lastWrittenByte=l?A:0,this.buffer=r,this.length=A,this.byteLength=A,this.byteOffset=g,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,g,A),this._mark=0,this._marks=[]}available(r=1){return this.offset+r<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(r=1){return this.offset+=r,this}back(r=1){return this.offset-=r,this}seek(r){return this.offset=r,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const r=this._marks.pop();if(r===void 0)throw new Error("Mark stack empty");return this.seek(r),this}rewind(){return this.offset=0,this}ensureAvailable(r=1){if(!this.available(r)){const s=2*(this.offset+r),l=new Uint8Array(s);l.set(new Uint8Array(this.buffer)),this.buffer=l.buffer,this.length=s,this.byteLength=s,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(r=1){return this.readArray(r,"uint8")}readArray(r,s){const l=ui[s].BYTES_PER_ELEMENT*r,c=this.byteOffset+this.offset,A=this.buffer.slice(c,c+l);if(this.littleEndian===Ci&&s!=="uint8"&&s!=="int8"){const C=new Uint8Array(this.buffer.slice(c,c+l));C.reverse();const E=new ui[s](C.buffer);return this.offset+=l,E.reverse(),E}const g=new ui[s](A);return this.offset+=l,g}readInt16(){const r=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,r}readUint16(){const r=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,r}readInt32(){const r=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,r}readUint32(){const r=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat32(){const r=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat64(){const r=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,r}readBigInt64(){const r=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,r}readBigUint64(){const r=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,r}readChar(){return String.fromCharCode(this.readInt8())}readChars(r=1){let s="";for(let l=0;l<r;l++)s+=this.readChar();return s}readUtf8(r=1){return mr(this.readBytes(r))}decodeText(r=1,s="utf8"){return mr(this.readBytes(r),s)}writeBoolean(r){return this.writeUint8(r?255:0),this}writeInt8(r){return this.ensureAvailable(1),this._data.setInt8(this.offset++,r),this._updateLastWrittenByte(),this}writeUint8(r){return this.ensureAvailable(1),this._data.setUint8(this.offset++,r),this._updateLastWrittenByte(),this}writeByte(r){return this.writeUint8(r)}writeBytes(r){this.ensureAvailable(r.length);for(let s=0;s<r.length;s++)this._data.setUint8(this.offset++,r[s]);return this._updateLastWrittenByte(),this}writeInt16(r){return this.ensureAvailable(2),this._data.setInt16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(r){return this.ensureAvailable(2),this._data.setUint16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(r){return this.ensureAvailable(4),this._data.setInt32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(r){return this.ensureAvailable(4),this._data.setUint32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(r){return this.ensureAvailable(4),this._data.setFloat32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(r){return this.ensureAvailable(8),this._data.setFloat64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(r){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(r){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(r){return this.writeUint8(r.charCodeAt(0))}writeChars(r){for(let s=0;s<r.length;s++)this.writeUint8(r.charCodeAt(s));return this}writeUtf8(r){return this.writeBytes((function(s){return li.encode(s)})(r))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}const jr=1,Lr=2,Dr=3,rr=4,vi=5,wi=6;function Ki(ae){switch(Number(ae)){case jr:return"byte";case Lr:return"char";case Dr:return"short";case rr:return"int";case vi:return"float";case wi:return"double";default:return"undefined"}}function Ei(ae){switch(Number(ae)){case jr:case Lr:return 1;case Dr:return 2;case rr:case vi:return 4;case wi:return 8;default:return-1}}function Ni(ae){switch(String(ae)){case"byte":return jr;case"char":return Lr;case"short":return Dr;case"int":return rr;case"float":return vi;case"double":return wi;default:return-1}}function Ti(ae,r){if(ae!==1){const s=new Array(ae);for(let l=0;l<ae;l++)s[l]=r();return s}return r()}function pi(ae,r,s){switch(r){case jr:return Array.from(ae.readBytes(s));case Lr:return(l=ae.readChars(s)).charCodeAt(l.length-1)===0?l.substring(0,l.length-1):l;case Dr:return Ti(s,ae.readInt16.bind(ae));case rr:return Ti(s,ae.readInt32.bind(ae));case vi:return Ti(s,ae.readFloat32.bind(ae));case wi:return Ti(s,ae.readFloat64.bind(ae));default:throw new Error(`non valid type ${r}`)}var l}function Br(ae,r){if(ae)throw new TypeError(`Not a valid NetCDF v3.x file: ${r}`)}function Yr(ae){ae.offset%4!=0&&ae.skip(4-ae.offset%4)}function Vi(ae){const r=ae.readUint32(),s=ae.readChars(r);return Yr(ae),s}function yi(ae,r){const s={version:r},l={length:ae.readUint32()},c=(function(g){const C={};let E,S;const k=g.readUint32();let D;if(k===0)return Br(g.readUint32()!==0,"wrong empty tag for list of dimensions"),[];{Br(k!==10,"wrong tag for list of dimensions");const $=g.readUint32();D=new Array($);for(let U=0;U<$;U++){const V=Vi(g),W=g.readUint32();W===0&&(E=U,S=V),D[U]={name:V,size:W}}}return E!==void 0&&(C.recordId=E),S!==void 0&&(C.recordName=S),C.dimensions=D,C})(ae);Array.isArray(c)||(l.id=c.recordId,l.name=c.recordName,s.dimensions=c.dimensions),s.globalAttributes=Wi(ae);const A=(function(g,C,E){const S=g.readUint32();let k,D=0;if(S===0)return Br(g.readUint32()!==0,"wrong empty tag for list of variables"),[];{Br(S!==11,"wrong tag for list of variables");const $=g.readUint32();k=new Array($);for(let U=0;U<$;U++){const V=Vi(g),W=g.readUint32(),H=new Array(W);for(let ye=0;ye<W;ye++)H[ye]=g.readUint32();const Y=Wi(g),J=g.readUint32();Br(J<1&&J>6,`non valid type ${J}`);const te=g.readUint32();let de=g.readUint32();E===2&&(Br(de>0,"offsets larger than 4GB not supported"),de=g.readUint32());let le=!1;C!==void 0&&H[0]===C&&(D+=te,le=!0),k[U]={name:V,dimensions:H,attributes:Y,type:Ki(J),size:te,offset:de,record:le}}}return{variables:k,recordStep:D}})(ae,l?.id,r);return Array.isArray(A)||(s.variables=A.variables,l.recordStep=A.recordStep),s.recordDimension=l,s}function Wi(ae){const r=ae.readUint32();let s;if(r===0)return Br(ae.readUint32()!==0,"wrong empty tag for list of attributes"),[];{Br(r!==12,"wrong tag for list of attributes");const l=ae.readUint32();s=new Array(l);for(let c=0;c<l;c++){const A=Vi(ae),g=ae.readUint32();Br(g<1||g>6,`non valid type ${g}`);const C=ae.readUint32(),E=pi(ae,g,C);Yr(ae),s[c]={name:A,type:Ki(g),value:E}}}return s}function tn(){const ae=[];ae.push("DIMENSIONS");for(const s of this.dimensions)ae.push(`  ${s.name.padEnd(30)} = size: ${s.size}`);ae.push(""),ae.push("GLOBAL ATTRIBUTES");for(const s of this.globalAttributes)ae.push(`  ${s.name.padEnd(30)} = ${s.value}`);const r=JSON.parse(JSON.stringify(this.variables));ae.push(""),ae.push("VARIABLES:");for(const s of r){s.value=this.getDataVariable(s);let l=JSON.stringify(s.value);l.length>50&&(l=l.substring(0,50)),isNaN(s.value.length)||(l+=` (length: ${s.value.length})`),ae.push(`  ${s.name.padEnd(30)} = ${l}`)}return ae.join(`
`)}class on{constructor(r){this.toString=tn;const s=new gi(r);s.setBigEndian(),Br(s.readChars(3)!=="CDF","should start with CDF");const l=s.readByte();Br(l>2,"unknown version"),this.header=yi(s,l),this.buffer=s}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(r){const s=this.globalAttributes.find(l=>l.name===r);return s?s.value:null}getDataVariableAsString(r){const s=this.getDataVariable(r);return s?s.join(""):null}get variables(){return this.header.variables}getDataVariable(r){let s;if(s=typeof r=="string"?this.header.variables.find(l=>l.name===r):r,s===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(s.offset),s.record?(function(l,c,A){const g=Ni(c.type),C=c.size?c.size/Ei(g):1,E=A.length,S=new Array(E),k=A.recordStep;if(!k)throw new Error("recordDimension.recordStep is undefined");for(let D=0;D<E;D++){const $=l.offset;S[D]=pi(l,g,C),l.seek($+k)}return S})(this.buffer,s,this.header.recordDimension):(function(l,c){const A=Ni(c.type),g=c.size/Ei(A),C=new Array(g);for(let E=0;E<g;E++)C[E]=pi(l,A,1);return C})(this.buffer,s)}dataVariableExists(r){return this.header.variables.find(s=>s.name===r)!==void 0}attributeExists(r){return this.globalAttributes.find(s=>s.name===r)!==void 0}}class ur{static sameObj(r,s){return r&&s?JSON.stringify(r)==JSON.stringify(s):r==s}constructor(r,s,l){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new p.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=w.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=s||{},this.viewer=l,this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:w.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=r}getRadiusFromStyle(r,s){var l=this.defaultSphereRadius;if(s.radius!==void 0)l=s.radius;else if(ur.vdwRadii[r.elem])l=ur.vdwRadii[r.elem];else if(r.elem.length>1){let c=r.elem;c=c[0].toUpperCase()+c[1].toLowerCase(),ur.vdwRadii[c]&&(l=ur.vdwRadii[c])}return s.scale!==void 0&&(l*=s.scale),l}drawAtomCross(r,s){if(r.style.cross){var l=r.style.cross;if(!l.hidden){var c=l.linewidth||ur.defaultlineWidth;s[c]||(s[c]=new u.Geometry);var A=s[c].updateGeoGroup(6),g=this.getRadiusFromStyle(r,l),C=[[g,0,0],[-g,0,0],[0,g,0],[0,-g,0],[0,0,g],[0,0,-g]],E=r.clickable||r.hoverable;E&&r.intersectionShape===void 0&&(r.intersectionShape={sphere:[],cylinder:[],line:[]});for(var S=(0,b.getColorFromStyle)(r,l),k=A.vertexArray,D=A.colorArray,$=0;$<6;$++){var U=3*A.vertices;if(A.vertices++,k[U]=r.x+C[$][0],k[U+1]=r.y+C[$][1],k[U+2]=r.z+C[$][2],D[U]=S.r,D[U+1]=S.g,D[U+2]=S.b,E){var V=new p.Vector3(C[$][0],C[$][1],C[$][2]);V.multiplyScalar(.1),V.set(V.x+r.x,V.y+r.y,V.z+r.z),r.intersectionShape.line.push(V)}}}}}getGoodCross(r,s,l,c){for(var A=null,g=-1,C=0,E=r.bonds.length;C<E;C++)if(r.bonds[C]!=s.index){let k=r.bonds[C],D=this.atoms[k],$=new p.Vector3(D.x,D.y,D.z).clone();$.sub(l);let U=$.clone();U.cross(c);var S=U.lengthSq();if(S>g&&(A=U,(g=S)>.1))return A}return A}getSideBondV(r,s,l){var c,A,g,C,E=new p.Vector3(r.x,r.y,r.z),S=new p.Vector3(s.x,s.y,s.z).clone(),k=null;if(S.sub(E),r.bonds.length===1)s.bonds.length===1?(k=S.clone(),Math.abs(k.x)>1e-4?k.y+=1:k.x+=1):(c=(l+1)%s.bonds.length,A=s.bonds[c],(g=this.atoms[A]).index==r.index&&(c=(c+1)%s.bonds.length,A=s.bonds[c],g=this.atoms[A]),(C=new p.Vector3(g.x,g.y,g.z).clone()).sub(E),(k=C.clone()).cross(S));else if((k=this.getGoodCross(r,s,E,S)).lengthSq()<.01){var D=this.getGoodCross(s,r,E,S);D!=null&&(k=D)}return k.lengthSq()<.01&&(k=S.clone(),Math.abs(k.x)>1e-4?k.y+=1:k.x+=1),k.cross(S),k.normalize(),k}addLine(r,s,l,c,A,g){r[l]=c.x,r[l+1]=c.y,r[l+2]=c.z,s[l]=g.r,s[l+1]=g.g,s[l+2]=g.b,r[l+3]=A.x,r[l+4]=A.y,r[l+5]=A.z,s[l+3]=g.r,s[l+4]=g.g,s[l+5]=g.b}drawBondLines(r,s,l){if(r.style.line){var c=r.style.line;if(!c.hidden){var A,g,C,E,S=c.linewidth||ur.defaultlineWidth;l[S]||(l[S]=new u.Geometry);for(var k=l[S].updateGeoGroup(6*r.bonds.length),D=k.vertexArray,$=k.colorArray,U=0;U<r.bonds.length;U++){var V=s[r.bonds[U]];if(V.style.line&&!(r.index>=V.index)){var W=new p.Vector3(r.x,r.y,r.z),H=new p.Vector3(V.x,V.y,V.z),Y=W.clone().add(H).multiplyScalar(.5),J=!1,te=r.clickable||r.hoverable,de=V.clickable||V.hoverable;(te||de)&&(te&&(r.intersectionShape===void 0&&(r.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),r.intersectionShape.line.push(W),r.intersectionShape.line.push(Y)),de&&(V.intersectionShape===void 0&&(V.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),V.intersectionShape.line.push(Y),V.intersectionShape.line.push(H)));var le=(0,b.getColorFromStyle)(r,r.style.line),ye=(0,b.getColorFromStyle)(V,V.style.line);if(r.bondStyles&&r.bondStyles[U]){var Pe=r.bondStyles[U];if(!Pe.iswire)continue;Pe.singleBond&&(J=!0),Pe.color1!==void 0&&(le=w.CC.color(Pe.color1)),Pe.color2!==void 0&&(ye=w.CC.color(Pe.color2))}var Te,ke,be=3*k.vertices;if(r.bondOrder[U]>1&&r.bondOrder[U]<4&&!J){var Ge=this.getSideBondV(r,V,U),Je=H.clone();Je.sub(W),r.bondOrder[U]==2?(Ge.multiplyScalar(.1),(A=W.clone()).add(Ge),(g=W.clone()).sub(Ge),(C=A.clone()).add(Je),(E=g.clone()).add(Je),le==ye?(k.vertices+=4,this.addLine(D,$,be,A,C,le),this.addLine(D,$,be+6,g,E,le)):(k.vertices+=8,Je.multiplyScalar(.5),(Te=A.clone()).add(Je),(ke=g.clone()).add(Je),this.addLine(D,$,be,A,Te,le),this.addLine(D,$,be+6,Te,C,ye),this.addLine(D,$,be+12,g,ke,le),this.addLine(D,$,be+18,ke,E,ye))):r.bondOrder[U]==3&&(Ge.multiplyScalar(.1),(A=W.clone()).add(Ge),(g=W.clone()).sub(Ge),(C=A.clone()).add(Je),(E=g.clone()).add(Je),le==ye?(k.vertices+=6,this.addLine(D,$,be,W,H,le),this.addLine(D,$,be+6,A,C,le),this.addLine(D,$,be+12,g,E,le)):(k.vertices+=12,Je.multiplyScalar(.5),(Te=A.clone()).add(Je),(ke=g.clone()).add(Je),this.addLine(D,$,be,W,Y,le),this.addLine(D,$,be+6,Y,H,ye),this.addLine(D,$,be+12,A,Te,le),this.addLine(D,$,be+18,Te,C,ye),this.addLine(D,$,be+24,g,ke,le),this.addLine(D,$,be+30,ke,E,ye)))}else le==ye?(k.vertices+=2,this.addLine(D,$,be,W,H,le)):(k.vertices+=4,this.addLine(D,$,be,W,Y,le),this.addLine(D,$,be+6,Y,H,ye))}}}}}drawAtomSphere(r,s){if(r.style.sphere){var l=r.style.sphere;if(!l.hidden){var c=(0,b.getColorFromStyle)(r,l),A=this.getRadiusFromStyle(r,l);if((r.clickable===!0||r.hoverable)&&r.intersectionShape!==void 0){var g=new p.Vector3(r.x,r.y,r.z);r.intersectionShape.sphere.push(new y.Sphere(g,A))}m.drawSphere(s,r,A,c)}}}drawAtomClickSphere(r){if(r.style.clicksphere){var s=r.style.clicksphere;if(!s.hidden){var l=this.getRadiusFromStyle(r,s);if((r.clickable===!0||r.hoverable)&&r.intersectionShape!==void 0){var c=new p.Vector3(r.x,r.y,r.z);r.intersectionShape.sphere.push(new y.Sphere(c,l))}}}}drawAtomInstanced(r,s){if(r.style.sphere){var l=r.style.sphere;if(!l.hidden){var c=this.getRadiusFromStyle(r,l),A=(0,b.getColorFromStyle)(r,l),g=s.updateGeoGroup(1),C=g.vertices,E=3*C,S=g.vertexArray,k=g.colorArray,D=g.radiusArray;if(S[E]=r.x,S[E+1]=r.y,S[E+2]=r.z,k[E]=A.r,k[E+1]=A.g,k[E+2]=A.b,D[C]=c,(r.clickable===!0||r.hoverable)&&r.intersectionShape!==void 0){var $=new p.Vector3(r.x,r.y,r.z);r.intersectionShape.sphere.push(new y.Sphere($,c))}g.vertices+=1}}}drawSphereImposter(r,s,l,c){var A,g=r.updateGeoGroup(4),C=g.vertices,E=3*C,S=g.vertexArray,k=g.colorArray;for(A=0;A<4;A++)S[E+3*A]=s.x,S[E+3*A+1]=s.y,S[E+3*A+2]=s.z;var D=g.normalArray;for(A=0;A<4;A++)k[E+3*A]=c.r,k[E+3*A+1]=c.g,k[E+3*A+2]=c.b;D[E+0]=-l,D[E+1]=l,D[E+2]=0,D[E+3]=-l,D[E+4]=-l,D[E+5]=0,D[E+6]=l,D[E+7]=-l,D[E+8]=0,D[E+9]=l,D[E+10]=l,D[E+11]=0,g.vertices+=4;var $=g.faceArray,U=g.faceidx;$[U+0]=C,$[U+1]=C+1,$[U+2]=C+2,$[U+3]=C+2,$[U+4]=C+3,$[U+5]=C,g.faceidx+=6}drawAtomImposter(r,s){if(r.style.sphere){var l=r.style.sphere;if(!l.hidden){var c=this.getRadiusFromStyle(r,l),A=(0,b.getColorFromStyle)(r,l);if((r.clickable===!0||r.hoverable)&&r.intersectionShape!==void 0){var g=new p.Vector3(r.x,r.y,r.z);r.intersectionShape.sphere.push(new y.Sphere(g,c))}this.drawSphereImposter(s,r,c,A)}}}calculateDashes(r,s,l,c,A){var g=Math.sqrt(Math.pow(r.x-s.x,2)+Math.pow(r.y-s.y,2)+Math.pow(r.z-s.z,2));l=Math.max(l,0),A=Math.max(A,0)+2*l,(c=Math.max(c,.001))+A>g&&(c=g,A=0);var C,E=Math.floor((g-c)/(c+A))+1;A=(g-E*c)/E;for(var S=new p.Vector3(r.x,r.y,r.z),k=new p.Vector3((s.x-r.x)/(g/A),(s.y-r.y)/(g/A),(s.z-r.z)/(g/A)),D=new p.Vector3((s.x-r.x)/(g/c),(s.y-r.y)/(g/c),(s.z-r.z)/(g/c)),$=[],U=0;U<E;U++)C=new p.Vector3(S.x+D.x,S.y+D.y,S.z+D.z),$.push({from:S,to:C}),S=new p.Vector3(C.x+k.x,C.y+k.y,C.z+k.z);return $}static drawStickImposter(r,s,l,c,A,g=0,C=0){for(var E=r.updateGeoGroup(4),S=E.vertices,k=3*S,D=E.vertexArray,$=E.colorArray,U=E.radiusArray,V=E.normalArray,W=A.r,H=A.g,Y=A.b,J=function(Pe){var Te=-Pe;return Te==0&&(Te=-1e-4),Te},te=k,de=0;de<4;de++)D[te]=s.x,V[te]=l.x,$[te]=W,D[++te]=s.y,V[te]=l.y,$[te]=H,D[++te]=s.z,V[te]=l.z,$[te]=de<2?Y:J(Y),te++;E.vertices+=4,U[S]=-c,U[S+1]=c,U[S+2]=-c,U[S+3]=c;var le=E.faceArray,ye=E.faceidx;le[ye+0]=S,le[ye+1]=S+1,le[ye+2]=S+2,le[ye+3]=S+2,le[ye+4]=S+3,le[ye+5]=S,E.faceidx+=6}drawBondSticks(r,s,l){var c,A;if(r.style.stick){var g=r.style.stick;if(!g.hidden){var C,E,S,k,D,$,U,V,W,H,Y,J,te,de,le=g.radius||this.defaultStickRadius,ye=g.doubleBondScaling||.4,Pe=g.tripleBondScaling||.25,Te=((c=g.dashedBondConfig)===null||c===void 0?void 0:c.dashLength)||.1,ke=((A=g.dashedBondConfig)===null||A===void 0?void 0:A.gapLength)||.25,be=le,Ge=g.singleBonds||!1,Je=g.dashedBonds||!1,tt=0,Ye=0,ut=(0,b.getColorFromStyle)(r,g);!r.capDrawn&&r.bonds.length<4&&(tt=2);var ft=Wr=>{var wr=l.imposter?ur.drawStickImposter:m.drawCylinder;return!Je&&Wr>=1?wr:($r,ci,ni,hi,zi,xi=0,Ii=0,Hr=.1,Xr=.25)=>{this.calculateDashes(ci,ni,hi,Hr,Xr).forEach(Zr=>{wr($r,Zr.from,Zr.to,hi,zi,xi,Ii)})}};for(S=0;S<r.bonds.length;S++){var Qe=ft(r.bondOrder[S]),pt=s[r.bonds[S]];if(J=te=de=null,r.index<pt.index){var Be=pt.style;if(!Be.stick||Be.stick.hidden)continue;var et=(0,b.getColorFromStyle)(pt,Be.stick);if(be=le,k=Ge,r.bondStyles&&r.bondStyles[S]){if((D=r.bondStyles[S]).iswire)continue;D.radius&&(be=D.radius),D.singleBond&&(k=!0),D.color1!==void 0&&(ut=w.CC.color(D.color1)),D.color2!==void 0&&(et=w.CC.color(D.color2))}var St=new p.Vector3(r.x,r.y,r.z),ot=new p.Vector3(pt.x,pt.y,pt.z);if(r.bondOrder[S]<=1||k||r.bondOrder[S]>3){if(r.bondOrder[S]<1&&(be*=r.bondOrder[S]),!pt.capDrawn&&pt.bonds.length<4&&(Ye=2),ut!=et?(J=new p.Vector3().addVectors(St,ot).multiplyScalar(.5),Qe(l,St,J,be,ut,tt,0,Te,ke),Qe(l,J,ot,be,et,0,Ye,Te,ke)):Qe(l,St,ot,be,ut,tt,Ye,Te,ke),C=r.clickable||r.hoverable,E=pt.clickable||pt.hoverable,C||E){if(J||(J=new p.Vector3().addVectors(St,ot).multiplyScalar(.5)),C){var bt=new y.Cylinder(St,J,be),At=new y.Sphere(St,be);r.intersectionShape.cylinder.push(bt),r.intersectionShape.sphere.push(At)}if(E){var it=new y.Cylinder(ot,J,be),Rt=new y.Sphere(ot,be);pt.intersectionShape.cylinder.push(it),pt.intersectionShape.sphere.push(Rt)}}}else if(r.bondOrder[S]>1){var Ht=0,kt=0;be!=le&&(Ht=2,kt=2);var ct,Jt,Nt,Zt,Vt,Xt=ot.clone(),yr=null;Xt.sub(St),yr=this.getSideBondV(r,pt,S),r.bondOrder[S]==2?(ct=be*ye,yr.multiplyScalar(1.5*ct),(Jt=St.clone()).add(yr),(Nt=St.clone()).sub(yr),(Zt=Jt.clone()).add(Xt),(Vt=Nt.clone()).add(Xt),ut!=et?(J=new p.Vector3().addVectors(Jt,Zt).multiplyScalar(.5),te=new p.Vector3().addVectors(Nt,Vt).multiplyScalar(.5),Qe(l,Jt,J,ct,ut,Ht,0),Qe(l,J,Zt,ct,et,0,kt),Qe(l,Nt,te,ct,ut,Ht,0),Qe(l,te,Vt,ct,et,0,kt)):(Qe(l,Jt,Zt,ct,ut,Ht,kt),Qe(l,Nt,Vt,ct,ut,Ht,kt)),C=r.clickable||r.hoverable,E=pt.clickable||pt.hoverable,(C||E)&&(J||(J=new p.Vector3().addVectors(Jt,Zt).multiplyScalar(.5)),te||(te=new p.Vector3().addVectors(Nt,Vt).multiplyScalar(.5)),C&&($=new y.Cylinder(Jt,J,ct),U=new y.Cylinder(Nt,te,ct),r.intersectionShape.cylinder.push($),r.intersectionShape.cylinder.push(U)),E&&(W=new y.Cylinder(Zt,J,ct),H=new y.Cylinder(Vt,te,ct),pt.intersectionShape.cylinder.push(W),pt.intersectionShape.cylinder.push(H)))):r.bondOrder[S]==3&&(ct=be*Pe,yr.cross(Xt),yr.normalize(),yr.multiplyScalar(3*ct),(Jt=St.clone()).add(yr),(Nt=St.clone()).sub(yr),(Zt=Jt.clone()).add(Xt),(Vt=Nt.clone()).add(Xt),ut!=et?(J=new p.Vector3().addVectors(Jt,Zt).multiplyScalar(.5),te=new p.Vector3().addVectors(Nt,Vt).multiplyScalar(.5),de=new p.Vector3().addVectors(St,ot).multiplyScalar(.5),Qe(l,Jt,J,ct,ut,Ht,0),Qe(l,J,Zt,ct,et,0,kt),Qe(l,St,de,ct,ut,tt,0),Qe(l,de,ot,ct,et,0,Ye),Qe(l,Nt,te,ct,ut,Ht,0),Qe(l,te,Vt,ct,et,0,kt)):(Qe(l,Jt,Zt,ct,ut,Ht,kt),Qe(l,St,ot,ct,ut,tt,Ye),Qe(l,Nt,Vt,ct,ut,Ht,kt)),C=r.clickable||r.hoverable,E=pt.clickable||pt.hoverable,(C||E)&&(J||(J=new p.Vector3().addVectors(Jt,Zt).multiplyScalar(.5)),te||(te=new p.Vector3().addVectors(Nt,Vt).multiplyScalar(.5)),de||(de=new p.Vector3().addVectors(St,ot).multiplyScalar(.5)),C&&($=new y.Cylinder(Jt.clone(),J.clone(),ct),U=new y.Cylinder(Nt.clone(),te.clone(),ct),V=new y.Cylinder(St.clone(),de.clone(),ct),r.intersectionShape.cylinder.push($),r.intersectionShape.cylinder.push(U),r.intersectionShape.cylinder.push(V)),E&&(W=new y.Cylinder(Zt.clone(),J.clone(),ct),H=new y.Cylinder(Vt.clone(),te.clone(),ct),Y=new y.Cylinder(ot.clone(),de.clone(),ct),pt.intersectionShape.cylinder.push(W),pt.intersectionShape.cylinder.push(H),pt.intersectionShape.cylinder.push(Y))))}}}var Fr=!1,Tr=0,ii=!1;for(S=0;S<r.bonds.length;S++)k=Ge,r.bondStyles&&r.bondStyles[S]&&((D=r.bondStyles[S]).singleBond&&(k=!0),D.radius&&D.radius!=le&&(ii=!0)),(k||r.bondOrder[S]==1)&&Tr++;ii?Tr>0&&(Fr=!0):Tr==0&&(r.bonds.length>0||g.showNonBonded)&&(Fr=!0),Fr&&(be=le,l.imposter?this.drawSphereImposter(l.sphereGeometry,r,be,ut):m.drawSphere(l,r,be,ut))}}}createMolObj(r,s){s=s||{};var l,c,A,g,C=new u.Object3D,E=[],S={},k={},D=this.drawAtomSphere,$=null,U=null;s.supportsImposters?(D=this.drawAtomImposter,($=new u.Geometry(!0)).imposter=!0,(U=new u.Geometry(!0,!0)).imposter=!0,U.sphereGeometry=new u.Geometry(!0),U.sphereGeometry.imposter=!0,U.drawnCaps={}):s.supportsAIA?(D=this.drawAtomInstanced,($=new u.Geometry(!1,!0,!0)).instanced=!0,U=new u.Geometry(!0)):($=new u.Geometry(!0),U=new u.Geometry(!0));var V,W={},H=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(l=0,A=r.length;l<A;l++){var Y=r[l];if(Y&&Y.style){for(c in(Y.clickable||Y.hoverable)&&Y.intersectionShape===void 0&&(Y.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),g={line:void 0,cross:void 0,stick:void 0,sphere:void 0})Y.style[c]?Y.style[c].opacity?g[c]=parseFloat(Y.style[c].opacity):g[c]=1:g[c]=void 0,W[c]?g[c]!=null&&W[c]!=g[c]&&(console.log("Warning: "+c+" opacity is ambiguous"),W[c]=1):W[c]=g[c];D.call(this,Y,$),this.drawAtomClickSphere(Y),this.drawAtomCross(Y,k),this.drawBondLines(Y,r,S),this.drawBondSticks(Y,r,U),Y.style.cartoon===void 0||Y.style.cartoon.hidden||(Y.style.cartoon.color!=="spectrum"||typeof Y.resi!="number"||Y.hetflag||(Y.resi<H[0]&&(H[0]=Y.resi),Y.resi>H[1]&&(H[1]=Y.resi)),E.push(Y))}}if(E.length>0&&ge(C,E,H,this.defaultCartoonQuality),$&&$.vertices>0){$.initTypedArrays();var J=null,te=null;$.imposter?J=new u.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):$.instanced?(te=new u.Geometry(!0),m.drawSphere(te,{x:0,y:0,z:0},1,new w.Color(.5,.5,.5)),te.initTypedArrays(),J=new u.InstancedMaterial({sphereMaterial:new u.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:te})):J=new u.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),W.sphere<1&&W.sphere>=0&&(J.transparent=!0,J.opacity=W.sphere),te=new u.Mesh($,J),C.add(te)}if(U.vertices>0){var de=null,le=null,ye=U.sphereGeometry;ye&&ye.vertices!==void 0&&ye.vertices!=0||(ye=null),U.initTypedArrays(),ye&&ye.initTypedArrays();var Pe={ambient:0,vertexColors:!0,reflectivity:0};U.imposter?(de=new u.StickImposterMaterial(Pe),le=new u.SphereImposterMaterial(Pe)):(de=new u.MeshLambertMaterial(Pe),le=new u.MeshLambertMaterial(Pe),de.wireframe&&(U.setUpWireframe(),ye&&ye.setUpWireframe())),W.stick<1&&W.stick>=0&&(de.transparent=!0,de.opacity=W.stick,le.transparent=!0,le.opacity=W.stick);var Te=new u.Mesh(U,de);if(C.add(Te),ye){var ke=new u.Mesh(ye,le);C.add(ke)}}for(l in S)if(S.hasOwnProperty(l)){V=l;var be=new u.LineBasicMaterial({linewidth:V,vertexColors:!0});W.line<1&&W.line>=0&&(be.transparent=!0,be.opacity=W.line),S[l].initTypedArrays();var Ge=new u.Line(S[l],be,u.LineStyle.LinePieces);C.add(Ge)}for(l in k)if(k.hasOwnProperty(l)){V=l;var Je=new u.LineBasicMaterial({linewidth:V,vertexColors:!0});W.cross<1&&W.cross>=0&&(Je.transparent=!0,Je.opacity=W.cross),k[l].initTypedArrays();var tt=new u.Line(k[l],Je,u.LineStyle.LinePieces);C.add(tt)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var Ye,ut=new u.Object3D;for(Ye=0;Ye<this.modelData.symmetries.length;Ye++){var ft=new u.Object3D;(ft=C.clone()).matrix.copy(this.modelData.symmetries[Ye]),ft.matrixAutoUpdate=!1,ut.add(ft)}return ut}return C}getViewer(){return this.viewer}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(r){this.atoms=r.atoms,this.frames=r.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const r=this.modelData.cryst;this.modelData.cryst.matrix=(0,p.conversionMatrix3)(r.a,r.b,r.c,r.alpha,r.beta,r.gamma)}return this.modelData.cryst}return null}setCrystData(r,s,l,c,A,g){r=r||1,s=s||1,l=l||1,c=c||90,A=A||90,g=g||90;const C=(0,p.conversionMatrix3)(r,s,l,c,A,g);this.modelData.cryst={a:r,b:s,c:l,alpha:c,beta:A,gamma:g,matrix:C}}setCrystMatrix(r){r=r||new p.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:r}}getSymmetries(){return this.modelData.symmetries===void 0&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(r){r===void 0?this.modelData.symmetries=[this.idMatrix]:(this.modelData.symmetries=r,this.molObj=null)}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(r,s,l,c){var A=s-r;return A<-l?s+c:A>l?s-c:s}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var r=this.box[0],s=this.box[1],l=this.box[2],c=.9*r,A=.9*s,g=.9*l,C=0;C<this.atomdfs.length;C++)for(var E=this.atomdfs[C],S=1;S<E.length;S++){var k=this.atoms[E[S][0]],D=this.atoms[E[S][1]];k.x=this.adjustCoord(D.x,k.x,c,r),k.y=this.adjustCoord(D.y,k.y,A,s),k.z=this.adjustCoord(D.z,k.z,g,l)}}setFrame(r){var s=this.getNumFrames();let l=this,c=this.viewer;return new Promise(function(A,g){if(s==0&&A(),(r<0||r>=s)&&(r=s-1),l.frames.url!=null){var C=l.frames.url;(0,b.getbin)(C+"/traj/frame/"+r+"/"+l.frames.path,void 0,"POST",void 0).then(function(E){for(var S=new Float32Array(E,44),k=0,D=0;D<l.atoms.length;D++)l.atoms[D].x=S[k++],l.atoms[D].y=S[k++],l.atoms[D].z=S[k++];l.box&&l.atomdfs&&l.adjustCoordinatesToBox(),A()}).catch(g)}else l.atoms=l.frames[r],A();l.molObj=null,l.modelDatas&&r<l.modelDatas.length&&(l.modelData=l.modelDatas[r],l.unitCellObjects&&c&&(c.removeUnitCell(l),c.addUnitCell(l)))})}addFrame(r){this.frames.push(r)}vibrate(r=10,s=1,l=!1,c){var A=0,g=r;let C=this.viewer;l&&(A=-r,g=r),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),A<g&&(this.frames=[]),l&&(this.frames.origIndex=r);for(var E=A;E<g;E++){var S=[],k=this.frames.length;if(E!=0||c){for(var D=0;D<this.atoms.length;D++){var $=(0,b.getAtomProperty)(this.atoms[D],"dx"),U=(0,b.getAtomProperty)(this.atoms[D],"dy"),V=(0,b.getAtomProperty)(this.atoms[D],"dz"),W=new p.Vector3($,U,V),H=new p.Vector3(this.atoms[D].x,this.atoms[D].y,this.atoms[D].z),Y=E*s/r;W.multiplyScalar(Y),H.add(W);var J={};for(var te in this.atoms[D])J[te]=this.atoms[D][te];if(J.x=H.x,J.y=H.y,J.z=H.z,S.push(J),C&&c){var de=(0,b.extend)({},c),le=new p.Vector3($,U,V);if(le.multiplyScalar(s),le.add(H),de.start=H,de.end=le,de.frame=k,!de.color){var ye=J.style.sphere;ye||(ye=J.style.stick),ye||(ye=J.style.line),de.color=(0,b.getColorFromStyle)(J,ye)}C.addArrow(de)}}this.frames.push(S)}else this.frames.push(this.atoms)}}setAtomDefaults(r){for(let s=0;s<r.length;s++){let l=r[s];l&&(l.style=l.style||(0,b.deepCopy)(ur.defaultAtomStyle),l.color=l.color||this.ElementColors[l.elem]||this.defaultColor,l.model=this.id,(l.clickable||l.hoverable)&&(l.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(r,s,l={}){var c=ur.parseMolData(r,s,l);this.dontDuplicateAtoms=!l.duplicateAssemblyAtoms;var A=c.modelData;if(A&&(Array.isArray(A)?(this.modelData=A[0],l.frames&&(this.modelDatas=A)):this.modelData=A),c.box?this.box=c.box:this.box=null,this.frames.length==0){for(let C=0;C<c.length;C++)c[C].length!=0&&this.frames.push(c[C]);this.frames[0]&&(this.atoms=this.frames[0])}else if(l.frames)for(let C=0;C<c.length;C++)this.frames.push(c[C]);else for(var g=0;g<c.length;g++)this.addAtoms(c[g]);for(let C=0;C<this.frames.length;C++)this.setAtomDefaults(this.frames[C]);l.vibrate&&l.vibrate.frames&&l.vibrate.amplitude&&this.vibrate(l.vibrate.frames,l.vibrate.amplitude),l.style&&this.setStyle({},l.style)}setDontDuplicateAtoms(r){this.dontDuplicateAtoms=r}setModelData(r){this.modelData=r}propertyMatches(r,s){if(r==s)return!0;if(typeof s=="string"&&typeof r=="number"){var l=s.match(/(-?\d+)\s*-\s*(-?\d+)/);if(l){var c=parseInt(l[1]),A=parseInt(l[2]);if(l&&r>=c&&r<=A)return!0}}return!1}static deepCopyAndCache(r,s){if(typeof r!="object"||r==null||r instanceof ur||r.__cache_created)return r;const l={};for(const c in r){const A=r[c];if(Array.isArray(A)){l[c]=[];for(let g=0;g<A.length;g++)l[c].push(ur.deepCopyAndCache(A[g],s))}else l[c]=typeof A=="object"&&c!="properties"&&c!="model"?ur.deepCopyAndCache(A,s):A;if(c=="and"||c=="or"){const g=[];for(const C of l[c]){const E=new Set;for(const S of s.selectedAtoms(C))E.add(S.index);g.push(E)}if(c=="and"){const C=function(S,k){const D=new Set;for(const $ of k)S.has($)&&D.add($);return D};let E=new Set(g[0]);for(const S of g.splice(1))E=C(E,S);l[c].__cached_results=E}else if(c=="or"){const C=new Set;for(const E of g)for(const S of E)C.add(S);l[c].__cached_results=C}}}return l.__cache_created=!0,l}atomIsSelected(r,s){if(s===void 0)return!0;var l=!!s.invert,c=!0;for(var A in s)if(A=="and"||A=="or"||A=="not"){if(A=="not"){if(this.atomIsSelected(r,s[A])){c=!1;break}}else if(s[A].__cached_results===void 0&&(s=ur.deepCopyAndCache(s,this)),!(c=s[A].__cached_results.has(r.index)))break}else if(A==="predicate"){if(!s.predicate(r)){c=!1;break}}else if(A=="properties"&&r[A]){for(var g in s.properties)if(!g.startsWith("__cache")){if(r.properties[g]===void 0){c=!1;break}if(r.properties[g]!=s.properties[g]){c=!1;break}}}else if(A=="model"){let S=s.model;if(typeof S=="number"&&S<0&&(S=this.viewer.getNextModelId()+S),Array.isArray(S)){let k=!1;for(let D=0;D<S.length;D++)if(S[D]==this||S[D]==this.id){k=!0;break}if(!k){c=!1;break}}else if(S!=this&&S!=this.id){c=!1;break}}else if(s.hasOwnProperty(A)&&!ur.ignoredKeys.has(A)&&!A.startsWith("__cache")){if(r[A]===void 0){c=!1;break}let S=!1;if(A==="bonds"){if(s[A]!=r.bonds.length){c=!1;break}}else if(Array.isArray(s[A])){var C=s[A],E=r[A];for(let k=0;k<C.length;k++)if(this.propertyMatches(E,C[k])){S=!0;break}if(!S){c=!1;break}}else{let k=s[A];if(!this.propertyMatches(r[A],k)){c=!1;break}}}return l?!c:c}static squaredDistance(r,s){var l=s.x-r.x,c=s.y-r.y,A=s.z-r.z;return l*l+c*c+A*A}expandAtomList(r,s){if(s<=0)return r;for(var l=(0,b.getExtent)(r,void 0),c=[[],[],[]],A=0;A<3;A++)c[0][A]=l[0][A]-s,c[1][A]=l[1][A]+s,c[2][A]=l[2][A];var g=[];for(let k=0;k<this.atoms.length;k++){var C=this.atoms[k].x,E=this.atoms[k].y,S=this.atoms[k].z;C>=c[0][0]&&C<=c[1][0]&&E>=c[0][1]&&E<=c[1][1]&&S>=c[0][2]&&S<=c[1][2]&&(C>=l[0][0]&&C<=l[1][0]&&E>=l[0][1]&&E<=l[1][1]&&S>=l[0][2]&&S<=l[1][2]||g.push(this.atoms[k]))}return g}static getFloat(r){return typeof r=="number"?r:parseFloat(r)}selectedAtoms(r,s){var l=[];r=ur.deepCopyAndCache(r||{},this),s||(s=this.atoms);for(var c=s.length,A=0;A<c;A++){var g=s[A];g&&this.atomIsSelected(g,r)&&l.push(g)}if(r.hasOwnProperty("expand")){const J=ur.getFloat(r.expand);let te=this.expandAtomList(l,J),de=l.length;const le=J*J;for(let ye=0;ye<te.length;ye++)for(let Pe=0;Pe<de;Pe++){var C=ur.squaredDistance(te[ye],l[Pe]);C<le&&C>0&&l.push(te[ye])}}if(r.hasOwnProperty("within")&&r.within.hasOwnProperty("sel")&&r.within.hasOwnProperty("distance")){var E=this.selectedAtoms(r.within.sel,this.atoms),S={};const J=ur.getFloat(r.within.distance),te=J*J;for(let de=0;de<E.length;de++)for(let le=0;le<l.length;le++){let ye=ur.squaredDistance(E[de],l[le]);ye<te&&ye>0&&(S[le]=1)}var k=[];if(r.within.invert)for(let de=0;de<l.length;de++)S[de]||k.push(l[de]);else for(let de in S)k.push(l[de]);l=k}if(r.hasOwnProperty("byres")){var D={},$=[],U=[];for(let J=0;J<l.length;J++){let te=l[J];var V=te.chain,W=te.resi;if(D[V]===void 0&&(D[V]={}),te.hasOwnProperty("resi")&&D[V][W]===void 0){for(D[V][W]=!0,U.push(te);U.length>0;)if(te=U.pop(),V=te.chain,W=te.resi,$[te.index]===void 0){$[te.index]=!0;for(var H=0;H<te.bonds.length;H++){var Y=this.atoms[te.bonds[H]];$[Y.index]===void 0&&Y.hasOwnProperty("resi")&&Y.chain==V&&Y.resi==W&&(U.push(Y),l.push(Y))}}}}}return l}addAtoms(r){this.molObj=null;var s,l=this.atoms.length,c=[];for(s=0;s<r.length;s++)r[s].index===void 0&&(r[s].index=s),r[s].serial===void 0&&(r[s].serial=s),c[r[s].index]=l+s;for(s=0;s<r.length;s++){var A=r[s],g=c[A.index],C=(0,b.extend)({},A);C.index=g,C.bonds=[],C.bondOrder=[],C.model=this.id,C.style=C.style||(0,b.deepCopy)(ur.defaultAtomStyle),C.color===void 0&&(C.color=this.ElementColors[C.elem]||this.defaultColor);for(var E=A.bonds?A.bonds.length:0,S=0;S<E;S++){var k=c[A.bonds[S]];k!==void 0&&(C.bonds.push(k),C.bondOrder.push(A.bondOrder?A.bondOrder[S]:1))}this.atoms.push(C)}}assignBonds(){(0,ue.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(r){this.molObj=null;var s,l=[];for(s=0;s<r.length;s++)l[r[s].index]=!0;var c=[];for(s=0;s<this.atoms.length;s++){var A=this.atoms[s];l[A.index]||c.push(A)}this.atoms=[],this.addAtoms(c)}setStyle(r,s,l){s===void 0&&l===void 0&&(s=r,r={}),typeof s=="string"&&(s=(0,b.specStringToObject)(s));var c=!1,A=this,g=function(E){var S=A.selectedAtoms(r,E);for(let k=0;k<E.length;k++)E[k]&&(E[k].capDrawn=!1);for(let k=0;k<S.length;k++){c=!0,(S[k].clickable||S[k].hoverable)&&(S[k].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),l||(S[k].style={});for(let D in s)s.hasOwnProperty(D)&&(S[k].style[D]=S[k].style[D]||{},Object.assign(S[k].style[D],s[D]))}};if(r.frame!==void 0&&r.frame<this.frames.length){let E=r.frame;E<0&&(E=this.frames.length+E),g(this.frames[E])}else{g(this.atoms);for(var C=0;C<this.frames.length;C++)this.frames[C]!==this.atoms&&g(this.frames[C])}c&&(this.molObj=null)}setClickable(r,s,l){if(s=!!s,(l=(0,b.makeFunction)(l))!==null){var c=this.selectedAtoms(r,this.atoms),A=c.length;for(let g=0;g<A;g++)c[g].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},c[g].clickable=s,l&&(c[g].callback=l);A>0&&(this.molObj=null)}else console.log("Callback is not a function")}setHoverable(r,s,l,c){if(s=!!s,l=(0,b.makeFunction)(l),c=(0,b.makeFunction)(c),l!==null)if(c!==null){var A=this.selectedAtoms(r,this.atoms),g=A.length;for(let C=0;C<g;C++)A[C].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},A[C].hoverable=s,l&&(A[C].hover_callback=l),c&&(A[C].unhover_callback=c);g>0&&(this.molObj=null)}else console.log("Unhover_callback is not a function");else console.log("Hover_callback is not a function")}enableContextMenu(r,s){var l;s=!!s;var c=this.selectedAtoms(r,this.atoms),A=c.length;for(l=0;l<A;l++)c[l].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},c[l].contextMenuEnabled=s;A>0&&(this.molObj=null)}setColorByElement(r,s){if(this.molObj===null||!ur.sameObj(s,this.lastColors)){this.lastColors=s;var l=this.selectedAtoms(r,l);l.length>0&&(this.molObj=null);for(var c=0;c<l.length;c++){var A=l[c];s[A.elem]!==void 0&&(A.color=s[A.elem])}}}setColorByProperty(r,s,l,c){var A,g,C=this.selectedAtoms(r,C);for(this.lastColors=null,C.length>0&&(this.molObj=null),typeof l=="string"&&M.Gradient.builtinGradients[l]!==void 0&&(l=new M.Gradient.builtinGradients[l]),c||(c=l.range()),c||(c=(0,b.getPropertyRange)(C,s)),A=0;A<C.length;A++)g=C[A],(0,b.getAtomProperty)(g,s)!=null&&(g.color=l.valueToHex(parseFloat(g.properties[s]),c))}setColorByFunction(r,s){var l=this.selectedAtoms(r,l);if(typeof s=="function"){this.lastColors=null,l.length>0&&(this.molObj=null);for(let c=0;c<l.length;c++){let A=l[c];A.color=s(A)}}}toCDObject(r=!1){var s={a:[],b:[]};r&&(s.s=[]);for(let c=0;c<this.atoms.length;c++){let A={},g=this.atoms[c];if(A.x=g.x,A.y=g.y,A.z=g.z,g.elem!="C"&&(A.l=g.elem),r){for(var l=0;l<s.s.length&&JSON.stringify(g.style)!==JSON.stringify(s.s[l]);)l++;l===s.s.length&&s.s.push(g.style),l!==0&&(A.s=l)}s.a.push(A);for(let C=0;C<g.bonds.length;C++){let E=c,S=g.bonds[C];if(E>=S)continue;let k={b:E,e:S},D=g.bondOrder[C];D!=1&&(k.o=D),s.b.push(k)}}return s}globj(r,s){(this.molObj===null||s.regen)&&(this.molObj=this.createMolObj(this.atoms,s),this.renderedMolObj&&(r.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),r.add(this.renderedMolObj))}exportVRML(){return this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1}).vrml()}removegl(r){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),r.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(r,s,l){let c=this.selectedAtoms(s),A=this.viewer,g=(0,b.deepCopy)(l);for(let E=0;E<c.length;E++){let S=c[E];var C=null;S[r]!==void 0?C=String(S[r]):S.properties[r]!==void 0&&(C=String(S.properties[r])),C!=null&&(g.position=S,A.addLabel(C,g))}}addResLabels(r,s,l=!1){let c=this.viewer;var A=[],g=function(E,S){for(var k=E.selectedAtoms(r,k),D={},$=0;$<k.length;$++){var U=k[$],V=U.chain,W=U.resn+""+U.resi;D[V]||(D[V]={}),D[V][W]||(D[V][W]=[]),D[V][W].push(U)}var H=(0,b.deepCopy)(s);for(let J in D)if(D.hasOwnProperty(J)){var Y=D[J];for(let te in Y)if(Y.hasOwnProperty(te)){let de=Y[te],le=new p.Vector3(0,0,0);for(let Pe=0;Pe<de.length;Pe++){let Te=de[Pe];le.x+=Te.x,le.y+=Te.y,le.z+=Te.z}le.divideScalar(de.length),H.position=le,H.frame=S;let ye=c.addLabel(te,H,void 0,!0);A.push(ye)}}};if(l){var C=this.getNumFrames();let E=this.atoms;for(let S=0;S<C;S++)this.frames[S]&&(this.atoms=this.frames[S],g(this,S));this.atoms=E}else g(this);return A}setupDFS(){this.atomdfs=[];var r=this,s=new Int8Array(this.atoms.length);s.fill(0);for(var l=function(g,C,E){E.push([g,C]);var S=r.atoms[g];s[g]=1;for(var k=0;k<S.bonds.length;k++){var D=S.bonds[k];r.atoms[D]&&!s[D]&&l(D,g,E)}},c=0;c<this.atoms.length;c++)if(this.atoms[c]&&!s[c]){var A=[];l(c,-1,A),this.atomdfs.push(A)}}setCoordinatesFromURL(r,s){this.frames=[];var l=this;return this.box&&this.setupDFS(),r.startsWith("http")||(r="http://"+r),(0,b.get)(r+"/traj/numframes/"+s,function(c){if(!isNaN(parseInt(c)))return l.frames.push(l.atoms),l.frames.numFrames=c,l.frames.url=r,l.frames.path=s,l.setFrame(0)})}setCoordinates(r,s){if(!r)return[];if(/\.gz$/.test(s=s||"")){s=s.replace(/\.gz$/,"");try{r=(0,b.inflateString)(r)}catch(k){console.log(k)}}if({mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""}.hasOwnProperty(s)){this.frames=[];for(var l=this.atoms.length,c=ur.parseCrd(r,s),A=0;A<c.length;){for(var g=[],C=0;C<l;C++){var E={};for(var S in this.atoms[C])E[S]=this.atoms[C][S];g[C]=E,g[C].x=c[A++],g[C].y=c[A++],g[C].z=c[A++]}this.frames.push(g)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(r){}static parseCrd(r,s){var l=[],c=0;if(s=="pdb")for(var A=r.indexOf(`
ATOM`);A!=-1;){for(;r.slice(A,A+5)==`
ATOM`||r.slice(A,A+7)==`
HETATM`;)l[c++]=parseFloat(r.slice(A+31,A+39)),l[c++]=parseFloat(r.slice(A+39,A+47)),l[c++]=parseFloat(r.slice(A+47,A+55)),A=r.indexOf(`
`,A+54),r.slice(A,A+4)==`
TER`&&(A=r.indexOf(`
`,A+5));A=r.indexOf(`
ATOM`,A)}else if(s=="netcdf"){var g=new on(r);l=[].concat.apply([],g.getDataVariable("coordinates"))}else{if(s=="array"||Array.isArray(r))return r.flat(2);{let C=r.indexOf(`
`);s=="inpcrd"&&(C=r.indexOf(`
`,C+1)),l=(r=r.slice(C+1)).match(/\S+/g).map(parseFloat)}}return l}static parseMolData(r,s="",l){if(!r)return[];if(/\.gz$/.test(s)){s=s.replace(/\.gz$/,"");try{r=s.match(/bcif/i)?(0,b.inflateString)(r,!1):(0,b.inflateString)(r)}catch(c){console.log(c)}}return It[s]===void 0&&(s=s.split(".").pop(),It[s]===void 0&&(console.log("Unknown format: "+s),s=r instanceof Uint8Array?"bcif":r.match(/^@<TRIPOS>MOLECULE/gm)?"mol2":r.match(/^data_/gm)&&r.match(/^loop_/gm)?"cif":r.match(/^HETATM/gm)||r.match(/^ATOM/gm)?"pdb":r.match(/ITEM: TIMESTEP/gm)?"lammpstrj":r.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?"sdf":r.match(/^%VERSION\s+VERSION_STAMP/gm)?"prmtop":"xyz",console.log("Best guess: "+s))),(0,It[s])(r,l)}}var Gr;ur.defaultAtomStyle={line:{}},ur.defaultlineWidth=1,ur.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},ur.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"]),(function(ae){ae[ae.VDW=1]="VDW",ae[ae.MS=2]="MS",ae[ae.SAS=3]="SAS",ae[ae.SES=4]="SES"})(Gr||(Gr={}));var Kr=!1;function Zi(ae){Kr=ae}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&(Kr=!0);class Bt{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(r,s,l,c){let A=!!c.fulltable,g=c.hasOwnProperty("origin")&&c.origin.hasOwnProperty("x")?c.origin:{x:0,y:0,z:0},C=!!c.voxel,E=c.matrix,S=c.nX||0,k=c.nY||0,D=c.nZ||0,$=c.scale||1,U=null;U=c.unitCube?c.unitCube:{x:$,y:$,z:$};let V,W,H=new Int32Array(S*k*D);for(V=0,W=H.length;V<W;++V)H[V]=-1;let Y=function(le,ye,Pe,Te,ke,be){let Ge={x:0,y:0,z:0},Je=ke;if(!(Te&1<<ke)&&Te&1<<be&&(Je=be),1&Je&&Pe++,2&Je&&ye++,4&Je&&le++,E){let Ye=new p.Vector3(le,ye,Pe);Ye=Ye.applyMatrix4(E),Ge={x:Ye.x,y:Ye.y,z:Ye.z}}else Ge.x=g.x+U.x*le,Ge.y=g.y+U.y*ye,Ge.z=g.z+U.z*Pe;let tt=(k*le+ye)*D+Pe;return C?(s.push(Ge),s.length-1):(H[tt]<0&&(H[tt]=s.length,s.push(Ge)),H[tt])},J=new Int32Array(12),te=A?this.edgeTable2:this.edgeTable,de=A?this.triTable2:this.triTable;for(V=0;V<S-1;++V)for(let le=0;le<k-1;++le)for(let ye=0;ye<D-1;++ye){let Pe=0;for(let be=0;be<8;++be)Pe|=!!(r[(k*(V+((4&be)>>2))+le+((2&be)>>1))*D+ye+(1&be)]&this.ISDONE)<<be;if(Pe===0||Pe===255)continue;let Te=te[Pe];if(Te===0)continue;let ke=de[Pe];1&Te&&(J[0]=Y(V,le,ye,Pe,0,1)),2&Te&&(J[1]=Y(V,le,ye,Pe,1,3)),4&Te&&(J[2]=Y(V,le,ye,Pe,3,2)),8&Te&&(J[3]=Y(V,le,ye,Pe,2,0)),16&Te&&(J[4]=Y(V,le,ye,Pe,4,5)),32&Te&&(J[5]=Y(V,le,ye,Pe,5,7)),64&Te&&(J[6]=Y(V,le,ye,Pe,7,6)),128&Te&&(J[7]=Y(V,le,ye,Pe,6,4)),256&Te&&(J[8]=Y(V,le,ye,Pe,0,4)),512&Te&&(J[9]=Y(V,le,ye,Pe,1,5)),1024&Te&&(J[10]=Y(V,le,ye,Pe,3,7)),2048&Te&&(J[11]=Y(V,le,ye,Pe,2,6));for(let be=0;be<ke.length;be+=3){let Ge=J[ke[be]],Je=J[ke[be+1]],tt=J[ke[be+2]];C&&be>=3&&(s.push(s[Ge]),Ge=s.length-1,s.push(s[Je]),Je=s.length-1,s.push(s[tt]),tt=s.length-1),l.push(Ge),l.push(Je),l.push(tt)}}}laplacianSmooth(r,s,l){let c,A,g,C,E,S=new Array(s.length);for(c=0,A=s.length;c<A;c++)S[c]={x:0,y:0,z:0};let k,D=new Array(20);for(c=0;c<20;c++)D[c]=new Array(s.length);for(c=0,A=s.length;c<A;c++)D[0][c]=0;for(c=0,A=l.length/3;c<A;c++){let U=3*c,V=3*c+1,W=3*c+2;for(k=!0,g=0,C=D[0][l[U]];g<C;g++)if(l[V]==D[g+1][l[U]]){k=!1;break}for(k&&(D[0][l[U]]++,D[D[0][l[U]]][l[U]]=l[V]),k=!0,g=0,C=D[0][l[U]];g<C;g++)if(l[W]==D[g+1][l[U]]){k=!1;break}for(k&&(D[0][l[U]]++,D[D[0][l[U]]][l[U]]=l[W]),k=!0,g=0,C=D[0][l[V]];g<C;g++)if(l[U]==D[g+1][l[V]]){k=!1;break}for(k&&(D[0][l[V]]++,D[D[0][l[V]]][l[V]]=l[U]),k=!0,g=0,C=D[0][l[V]];g<C;g++)if(l[W]==D[g+1][l[V]]){k=!1;break}for(k&&(D[0][l[V]]++,D[D[0][l[V]]][l[V]]=l[W]),k=!0,g=0;g<D[0][l[W]];g++)if(l[U]==D[g+1][l[W]]){k=!1;break}for(k&&(D[0][l[W]]++,D[D[0][l[W]]][l[W]]=l[U]),k=!0,g=0,C=D[0][l[W]];g<C;g++)if(l[V]==D[g+1][l[W]]){k=!1;break}k&&(D[0][l[W]]++,D[D[0][l[W]]][l[W]]=l[V])}let $=.5;for(E=0;E<r;E++){for(c=0,A=s.length;c<A;c++)if(D[0][c]<3)S[c].x=s[c].x,S[c].y=s[c].y,S[c].z=s[c].z;else if(D[0][c]==3||D[0][c]==4){for(S[c].x=0,S[c].y=0,S[c].z=0,g=0,C=D[0][c];g<C;g++)S[c].x+=s[D[g+1][c]].x,S[c].y+=s[D[g+1][c]].y,S[c].z+=s[D[g+1][c]].z;S[c].x+=$*s[c].x,S[c].y+=$*s[c].y,S[c].z+=$*s[c].z,S[c].x/=$+D[0][c],S[c].y/=$+D[0][c],S[c].z/=$+D[0][c]}else{for(S[c].x=0,S[c].y=0,S[c].z=0,g=0,C=D[0][c];g<C;g++)S[c].x+=s[D[g+1][c]].x,S[c].y+=s[D[g+1][c]].y,S[c].z+=s[D[g+1][c]].z;S[c].x+=1*s[c].x,S[c].y+=1*s[c].y,S[c].z+=1*s[c].z,S[c].x/=1+D[0][c],S[c].y/=1+D[0][c],S[c].z/=1+D[0][c]}for(c=0,A=s.length;c<A;c++)s[c].x=S[c].x,s[c].y=S[c].y,s[c].z=S[c].z}}}let x=new Bt;class ie{constructor(r,s,l){this.data=new Int32Array(r*s*l*3),this.width=s,this.height=l}set(r,s,l,c){let A=3*((r*this.width+s)*this.height+l);this.data[A]=c.ix,this.data[A+1]=c.iy,this.data[A+2]=c.iz}get(r,s,l){let c=3*((r*this.width+s)*this.height+l);return{ix:this.data[c],iy:this.data[c+1],iz:this.data[c+2]}}}class xe{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],xe.MarchingCube||(xe.MarchingCube=new Bt)}getVDWIndex(r){return r.elem&&this.vdwRadii[r.elem]!==void 0?r.elem:"X"}getFacesAndVertices(r){let s={};for(let A=0,g=r.length;A<g;A++)s[r[A]]=!0;let l=this.verts;for(let A=0,g=l.length;A<g;A++)l[A].x=l[A].x/this.scaleFactor-this.ptranx,l[A].y=l[A].y/this.scaleFactor-this.ptrany,l[A].z=l[A].z/this.scaleFactor-this.ptranz;let c=[];for(let A=0,g=this.faces.length;A<g;A+=3){let C=this.faces[A],E=this.faces[A+1],S=this.faces[A+2],k=l[C].atomid,D=l[E].atomid,$=l[S].atomid,U=k;D<U&&(U=D),$<U&&(U=$),s[U]&&C!==E&&E!==S&&C!==S&&(c.push(C),c.push(E),c.push(S))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:l,faces:c}}initparm(r,s,l){l>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let c=1/this.scaleFactor*5.5;this.pminx=r[0][0],this.pmaxx=r[1][0],this.pminy=r[0][1],this.pmaxy=r[1][1],this.pminz=r[0][2],this.pmaxz=r[1][2],s?(this.pminx-=this.probeRadius+c,this.pminy-=this.probeRadius+c,this.pminz-=this.probeRadius+c,this.pmaxx+=this.probeRadius+c,this.pmaxy+=this.probeRadius+c,this.pmaxz+=this.probeRadius+c):(this.pminx-=c,this.pminy-=c,this.pminz-=c,this.pmaxx+=c,this.pmaxy+=c,this.pmaxz+=c),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(s),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(r){let s={};for(const l in this.vdwRadii){let c=this.vdwRadii[l];s[l]=r?(c+this.probeRadius)*this.scaleFactor+.5:c*this.scaleFactor+.5;let A=s[l]*s[l];this.widxz[l]=Math.floor(s[l])+1,this.depty[l]=new Int32Array(this.widxz[l]*this.widxz[l]);let g=0;for(let C=0;C<this.widxz[l];C++)for(let E=0;E<this.widxz[l];E++){let S=C*C+E*E;if(S>A)this.depty[l][g]=-1;else{let k=Math.sqrt(A-S);this.depty[l][g]=Math.floor(k)}g++}}}fillvoxels(r,s){for(let l=0,c=this.vpBits.length;l<c;l++)this.vpBits[l]=0,this.vpDistance[l]=-1,this.vpAtomID[l]=-1;for(let l in s){let c=r[s[l]];c!==void 0&&this.fillAtom(c,r)}for(let l=0,c=this.vpBits.length;l<c;l++)this.vpBits[l]&this.INOUT&&(this.vpBits[l]|=this.ISDONE)}fillAtom(r,s){let l=Math.floor(.5+this.scaleFactor*(r.x+this.ptranx)),c=Math.floor(.5+this.scaleFactor*(r.y+this.ptrany)),A=Math.floor(.5+this.scaleFactor*(r.z+this.ptranz)),g=this.getVDWIndex(r),C=0,E=this.pWidth*this.pHeight;for(let S=0,k=this.widxz[g];S<k;S++)for(let D=0;D<k;D++){if(this.depty[g][C]!=-1){for(let $=-1;$<2;$++)for(let U=-1;U<2;U++)for(let V=-1;V<2;V++)if($!==0&&U!==0&&V!==0){let W=$*S,H=V*D;for(let Y=0;Y<=this.depty[g][C];Y++){let J=Y*U,te=l+W,de=c+J,le=A+H;if(te<0||de<0||le<0||te>=this.pLength||de>=this.pWidth||le>=this.pHeight)continue;let ye=te*E+de*this.pHeight+le;if(this.vpBits[ye]&this.INOUT){let Pe=s[this.vpAtomID[ye]];if(Pe.serial!=r.serial){let Te=l+W-Math.floor(.5+this.scaleFactor*(Pe.x+this.ptranx)),ke=c+J-Math.floor(.5+this.scaleFactor*(Pe.y+this.ptrany)),be=A+H-Math.floor(.5+this.scaleFactor*(Pe.z+this.ptranz));W*W+J*J+H*H<Te*Te+ke*ke+be*be&&(this.vpAtomID[ye]=r.serial)}}else this.vpBits[ye]|=this.INOUT,this.vpAtomID[ye]=r.serial}}}C++}}fillvoxelswaals(r,s){for(let l=0,c=this.vpBits.length;l<c;l++)this.vpBits[l]&=~this.ISDONE;for(let l in s){let c=r[s[l]];c!==void 0&&this.fillAtomWaals(c,r)}}fillAtomWaals(r,s){let l=0,c=Math.floor(.5+this.scaleFactor*(r.x+this.ptranx)),A=Math.floor(.5+this.scaleFactor*(r.y+this.ptrany)),g=Math.floor(.5+this.scaleFactor*(r.z+this.ptranz)),C=this.getVDWIndex(r),E=this.pWidth*this.pHeight;for(let S=0,k=this.widxz[C];S<k;S++)for(let D=0;D<k;D++){if(this.depty[C][l]!=-1){for(let $=-1;$<2;$++)for(let U=-1;U<2;U++)for(let V=-1;V<2;V++)if($!==0&&U!==0&&V!==0){let W=$*S,H=V*D;for(let Y=0;Y<=this.depty[C][l];Y++){let J=Y*U,te=c+W,de=A+J,le=g+H;if(te<0||de<0||le<0||te>=this.pLength||de>=this.pWidth||le>=this.pHeight)continue;let ye=te*E+de*this.pHeight+le;if(this.vpBits[ye]&this.ISDONE){let Pe=s[this.vpAtomID[ye]];if(Pe.serial!=r.serial){let Te=c+W-Math.floor(.5+this.scaleFactor*(Pe.x+this.ptranx)),ke=A+J-Math.floor(.5+this.scaleFactor*(Pe.y+this.ptrany)),be=g+H-Math.floor(.5+this.scaleFactor*(Pe.z+this.ptranz));W*W+J*J+H*H<Te*Te+ke*ke+be*be&&(this.vpAtomID[ye]=r.serial)}}else this.vpBits[ye]|=this.ISDONE,this.vpAtomID[ye]=r.serial}}}l++}}buildboundary(){let r=this.pWidth*this.pHeight;for(let s=0;s<this.pLength;s++)for(let l=0;l<this.pHeight;l++)for(let c=0;c<this.pWidth;c++){let A=s*r+c*this.pHeight+l;if(this.vpBits[A]&this.INOUT){let g=0;for(;g<26;){let C=s+this.nb[g][0],E=l+this.nb[g][2],S=c+this.nb[g][1];if(C>-1&&C<this.pLength&&S>-1&&S<this.pWidth&&E>-1&&E<this.pHeight&&!(this.vpBits[C*r+S*this.pHeight+E]&this.INOUT)){this.vpBits[A]|=this.ISBOUND;break}g++}}}}fastdistancemap(){let r,s=new ie(this.pLength,this.pWidth,this.pHeight),l=this.pWidth*this.pHeight,c=this.cutRadius*this.cutRadius,A=[],g=[];for(let S=0;S<this.pLength;S++)for(let k=0;k<this.pWidth;k++)for(let D=0;D<this.pHeight;D++)if(r=S*l+k*this.pHeight+D,this.vpBits[r]&=~this.ISDONE,this.vpBits[r]&this.INOUT&&this.vpBits[r]&this.ISBOUND){let $={ix:S,iy:k,iz:D};s.set(S,k,D,$),A.push($),this.vpDistance[r]=0,this.vpBits[r]|=this.ISDONE,this.vpBits[r]&=~this.ISBOUND}do{g=this.fastoneshell(A,s),A=[];for(let S=0,k=g.length;S<k;S++)r=l*g[S].ix+this.pHeight*g[S].iy+g[S].iz,this.vpBits[r]&=~this.ISBOUND,this.vpDistance[r]<=1.0404*c&&A.push({ix:g[S].ix,iy:g[S].iy,iz:g[S].iz})}while(A.length!==0);A=[],g=[],s=null;let C=this.scaleFactor-.5;C<0&&(C=0);let E=c-.5/(.1+C);for(let S=0;S<this.pLength;S++)for(let k=0;k<this.pWidth;k++)for(let D=0;D<this.pHeight;D++)r=S*l+k*this.pHeight+D,this.vpBits[r]&=~this.ISBOUND,this.vpBits[r]&this.INOUT&&(this.vpBits[r]&this.ISDONE&&!(this.vpBits[r]&this.ISDONE&&this.vpDistance[r]>=E)||(this.vpBits[r]|=this.ISBOUND))}fastoneshell(r,s){let l,c,A,g,C,E,S,k,D,$=[];if(r.length===0)return $;let U={ix:-1,iy:-1,iz:-1},V=this.pWidth*this.pHeight;for(let W=0,H=r.length;W<H;W++){l=r[W].ix,c=r[W].iy,A=r[W].iz,k=s.get(l,c,A);for(let Y=0;Y<6;Y++)U.ix=l+this.nb[Y][0],U.iy=c+this.nb[Y][1],U.iz=A+this.nb[Y][2],U.ix<this.pLength&&U.ix>-1&&U.iy<this.pWidth&&U.iy>-1&&U.iz<this.pHeight&&U.iz>-1&&(D=U.ix*V+this.pHeight*U.iy+U.iz,this.vpBits[D]&this.INOUT&&!(this.vpBits[D]&this.ISDONE)?(s.set(U.ix,U.iy,A+this.nb[Y][2],k),g=U.ix-k.ix,C=U.iy-k.iy,E=U.iz-k.iz,S=g*g+C*C+E*E,this.vpDistance[D]=S,this.vpBits[D]|=this.ISDONE,this.vpBits[D]|=this.ISBOUND,$.push({ix:U.ix,iy:U.iy,iz:U.iz})):this.vpBits[D]&this.INOUT&&this.vpBits[D]&this.ISDONE&&(g=U.ix-k.ix,C=U.iy-k.iy,E=U.iz-k.iz,S=g*g+C*C+E*E,S<this.vpDistance[D]&&(s.set(U.ix,U.iy,U.iz,k),this.vpDistance[D]=S,this.vpBits[D]&this.ISBOUND||(this.vpBits[D]|=this.ISBOUND,$.push({ix:U.ix,iy:U.iy,iz:U.iz})))))}for(let W=0,H=r.length;W<H;W++){l=r[W].ix,c=r[W].iy,A=r[W].iz,k=s.get(l,c,A);for(let Y=6;Y<18;Y++)U.ix=l+this.nb[Y][0],U.iy=c+this.nb[Y][1],U.iz=A+this.nb[Y][2],U.ix<this.pLength&&U.ix>-1&&U.iy<this.pWidth&&U.iy>-1&&U.iz<this.pHeight&&U.iz>-1&&(D=U.ix*V+this.pHeight*U.iy+U.iz,this.vpBits[D]&this.INOUT&&!(this.vpBits[D]&this.ISDONE)?(s.set(U.ix,U.iy,A+this.nb[Y][2],k),g=U.ix-k.ix,C=U.iy-k.iy,E=U.iz-k.iz,S=g*g+C*C+E*E,this.vpDistance[D]=S,this.vpBits[D]|=this.ISDONE,this.vpBits[D]|=this.ISBOUND,$.push({ix:U.ix,iy:U.iy,iz:U.iz})):this.vpBits[D]&this.INOUT&&this.vpBits[D]&this.ISDONE&&(g=U.ix-k.ix,C=U.iy-k.iy,E=U.iz-k.iz,S=g*g+C*C+E*E,S<this.vpDistance[D]&&(s.set(U.ix,U.iy,U.iz,k),this.vpDistance[D]=S,this.vpBits[D]&this.ISBOUND||(this.vpBits[D]|=this.ISBOUND,$.push({ix:U.ix,iy:U.iy,iz:U.iz})))))}for(let W=0,H=r.length;W<H;W++){l=r[W].ix,c=r[W].iy,A=r[W].iz,k=s.get(l,c,A);for(let Y=18;Y<26;Y++)U.ix=l+this.nb[Y][0],U.iy=c+this.nb[Y][1],U.iz=A+this.nb[Y][2],U.ix<this.pLength&&U.ix>-1&&U.iy<this.pWidth&&U.iy>-1&&U.iz<this.pHeight&&U.iz>-1&&(D=U.ix*V+this.pHeight*U.iy+U.iz,this.vpBits[D]&this.INOUT&&!(this.vpBits[D]&this.ISDONE)?(s.set(U.ix,U.iy,A+this.nb[Y][2],k),g=U.ix-k.ix,C=U.iy-k.iy,E=U.iz-k.iz,S=g*g+C*C+E*E,this.vpDistance[D]=S,this.vpBits[D]|=this.ISDONE,this.vpBits[D]|=this.ISBOUND,$.push({ix:U.ix,iy:U.iy,iz:U.iz})):this.vpBits[D]&this.INOUT&&this.vpBits[D]&this.ISDONE&&(g=U.ix-k.ix,C=U.iy-k.iy,E=U.iz-k.iz,S=g*g+C*C+E*E,S<this.vpDistance[D]&&(s.set(U.ix,U.iy,U.iz,k),this.vpDistance[D]=S,this.vpBits[D]&this.ISBOUND||(this.vpBits[D]|=this.ISBOUND,$.push({ix:U.ix,iy:U.iy,iz:U.iz})))))}return $}marchingcubeinit(r){for(let s=0,l=this.vpBits.length;s<l;s++)r==1?this.vpBits[s]&=~this.ISBOUND:r==4?(this.vpBits[s]&=~this.ISDONE,this.vpBits[s]&this.ISBOUND&&(this.vpBits[s]|=this.ISDONE),this.vpBits[s]&=~this.ISBOUND):r==2?this.vpBits[s]&this.ISBOUND&&this.vpBits[s]&this.ISDONE?this.vpBits[s]&=~this.ISBOUND:this.vpBits[s]&this.ISBOUND&&!(this.vpBits[s]&this.ISDONE)&&(this.vpBits[s]|=this.ISDONE):r==3&&(this.vpBits[s]&=~this.ISBOUND)}marchingcube(r){this.marchingcubeinit(r),this.verts=[],this.faces=[],xe.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let s=this.pWidth*this.pHeight;for(let l=0,c=this.verts.length;l<c;l++)this.verts[l].atomid=this.vpAtomID[this.verts[l].x*s+this.pHeight*this.verts[l].y+this.verts[l].z];xe.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}xe.MarchingCube=new Bt;var Ve=a(848);class Oe{static finalizeGeo(r){var s=r.updateGeoGroup(0);s.vertices>0&&s.truncateArrayBuffers(!0,!0)}static updateColor(r,s){var l,c,A;s=s||w.CC.color(s),r.colorsNeedUpdate=!0,s.constructor!==Array&&(l=s.r,c=s.g,A=s.b);for(let g in r.geometryGroups){let C=r.geometryGroups[g],E=C.colorArray;for(let S=0,k=C.vertices;S<k;++S){if(s.constructor===Array){let D=s[S];l=D.r,c=D.g,A=D.b}E[3*S]=l,E[3*S+1]=c,E[3*S+2]=A}}}static drawArrow(r,s,l){var c=l.start,A=l.end,g=l.radius,C=l.radiusRatio,E=l.mid,S=l.midpos;if(!c||!A)return;var k=s.updateGeoGroup(51),D=new p.Vector3(A.x,A.y,A.z).sub(c);if(S){let hi=D.length();E=S>0?S/hi:(hi+S)/hi}D.multiplyScalar(E);var $=new p.Vector3(c.x,c.y,c.z).add(D),U=D.clone().negate();let V=new p.Vector3(c.x,c.y,c.z);r.intersectionShape.cylinder.push(new y.Cylinder(V,$.clone(),g)),r.intersectionShape.sphere.push(new y.Sphere(V,g));var W=[];W[0]=D.clone(),Math.abs(W[0].x)>1e-4?W[0].y+=1:W[0].x+=1,W[0].cross(D),W[0].normalize(),W[4]=W[0].clone(),W[4].crossVectors(W[0],D),W[4].normalize(),W[8]=W[0].clone().negate(),W[12]=W[4].clone().negate(),W[2]=W[0].clone().add(W[4]).normalize(),W[6]=W[4].clone().add(W[8]).normalize(),W[10]=W[8].clone().add(W[12]).normalize(),W[14]=W[12].clone().add(W[0]).normalize(),W[1]=W[0].clone().add(W[2]).normalize(),W[3]=W[2].clone().add(W[4]).normalize(),W[5]=W[4].clone().add(W[6]).normalize(),W[7]=W[6].clone().add(W[8]).normalize(),W[9]=W[8].clone().add(W[10]).normalize(),W[11]=W[10].clone().add(W[12]).normalize(),W[13]=W[12].clone().add(W[14]).normalize(),W[15]=W[14].clone().add(W[0]).normalize();var H,Y,J,te,de,le,ye,Pe,Te,ke,be,Ge,Je,tt,Ye,ut,ft,Qe,pt,Be,et,St,ot=k.vertices,bt=k.vertexArray,At=k.faceArray,it=k.normalArray,Rt=k.lineArray;for(Y=0,J=W.length;Y<J;++Y){H=3*(ot+3*Y);var Ht=W[Y].clone().multiplyScalar(g).add(c),kt=W[Y].clone().multiplyScalar(g).add($),ct=W[Y].clone().multiplyScalar(g*C).add($);if(bt[H]=Ht.x,bt[H+1]=Ht.y,bt[H+2]=Ht.z,bt[H+3]=kt.x,bt[H+4]=kt.y,bt[H+5]=kt.z,bt[H+6]=ct.x,bt[H+7]=ct.y,bt[H+8]=ct.z,Y>0){var Jt=bt[H-3],Nt=bt[H-2],Zt=bt[H-1],Vt=new p.Vector3(Jt,Nt,Zt),Xt=new p.Vector3(A.x,A.y,A.z),yr=$.clone(),Fr=new p.Vector3(ct.x,ct.y,ct.z);r.intersectionShape.triangle.push(new y.Triangle(Fr,Xt,Vt)),r.intersectionShape.triangle.push(new y.Triangle(Vt.clone(),yr,Fr.clone()))}}k.vertices+=48,bt[H=3*k.vertices]=c.x,bt[H+1]=c.y,bt[H+2]=c.z,bt[H+3]=$.x,bt[H+4]=$.y,bt[H+5]=$.z,bt[H+6]=A.x,bt[H+7]=A.y,bt[H+8]=A.z,k.vertices+=3;var Tr=k.vertices-3,ii=k.vertices-2,Wr=k.vertices-1,wr=3*Tr,$r=3*ii,ci=3*Wr;for(Y=0,J=W.length-1;Y<J;++Y){var ni=ot+3*Y;H=3*ni,de=k.faceidx,le=k.lineidx,Je=3*(ye=ni),tt=3*(Pe=ni+1),Ye=3*(Te=ni+2),ut=3*(ke=ni+4),ft=3*(be=ni+5),Qe=3*(Ge=ni+3),pt=Be=W[Y],et=St=W[Y+1],it[Je]=pt.x,it[tt]=Be.x,it[Qe]=St.x,it[Je+1]=pt.y,it[tt+1]=Be.y,it[Qe+1]=St.y,it[Je+2]=pt.z,it[tt+2]=Be.z,it[Qe+2]=St.z,it[tt]=Be.x,it[ut]=et.x,it[Qe]=St.x,it[tt+1]=Be.y,it[ut+1]=et.y,it[Qe+1]=St.y,it[tt+2]=Be.z,it[ut+2]=et.z,it[Qe+2]=St.z,it[Ye]=Be.x,it[ft]=et.x,it[Ye+1]=Be.y,it[ft+1]=et.y,it[Ye+2]=Be.z,it[ft+2]=et.z,At[de]=ye,At[de+1]=Pe,At[de+2]=Ge,At[de+3]=Pe,At[de+4]=ke,At[de+5]=Ge,At[de+6]=ye,At[de+7]=Ge,At[de+8]=Tr,At[de+9]=Te,At[de+10]=ii,At[de+11]=be,At[de+12]=Te,At[de+13]=Wr,At[de+14]=be,Rt[le]=ye,Rt[le+1]=Pe,Rt[le+2]=ye,Rt[le+3]=Ge,Rt[le+4]=ke,Rt[le+5]=Ge,Rt[le+6]=ye,Rt[le+7]=Ge,Rt[le+8]=Te,Rt[le+9]=Pe,Rt[le+10]=Te,Rt[le+11]=be,Rt[le+12]=ke,Rt[le+13]=be,Rt[le+14]=Te,Rt[le+15]=Wr,Rt[le+16]=Te,Rt[le+17]=be,Rt[le+18]=Wr,Rt[le+19]=be,k.faceidx+=15,k.lineidx+=20}te=[ot+45,ot+46,ot+1,ot,ot+47,ot+2],de=k.faceidx,le=k.lineidx,Je=3*(ye=te[0]),tt=3*(Pe=te[1]),Ye=3*(Te=te[4]),ut=3*(ke=te[2]),ft=3*(be=te[5]),Qe=3*(Ge=te[3]),pt=Be=W[15],et=St=W[0],it[Je]=pt.x,it[tt]=Be.x,it[Qe]=St.x,it[Je+1]=pt.y,it[tt+1]=Be.y,it[Qe+1]=St.y,it[Je+2]=pt.z,it[tt+2]=Be.z,it[Qe+2]=St.z,it[tt]=Be.x,it[ut]=et.x,it[Qe]=St.x,it[tt+1]=Be.y,it[ut+1]=et.y,it[Qe+1]=St.y,it[tt+2]=Be.z,it[ut+2]=et.z,it[Qe+2]=St.z,it[Ye]=Be.x,it[ft]=et.x,it[Ye+1]=Be.y,it[ft+1]=et.y,it[Ye+2]=Be.z,it[ft+2]=et.z,D.normalize(),U.normalize(),it[wr]=U.x,it[$r]=it[ci]=D.x,it[wr+1]=U.y,it[$r+1]=it[ci+1]=D.y,it[wr+2]=U.z,it[$r+2]=it[ci+2]=D.z,At[de]=ye,At[de+1]=Pe,At[de+2]=Ge,At[de+3]=Pe,At[de+4]=ke,At[de+5]=Ge,At[de+6]=ye,At[de+7]=Ge,At[de+8]=Tr,At[de+9]=Te,At[de+10]=ii,At[de+11]=be,At[de+12]=Te,At[de+13]=Wr,At[de+14]=be,Rt[le]=ye,Rt[le+1]=Pe,Rt[le+2]=ye,Rt[le+3]=Ge,Rt[le+4]=ke,Rt[le+5]=Ge,Rt[le+6]=ye,Rt[le+7]=Ge,Rt[le+8]=Te,Rt[le+9]=Pe,Rt[le+10]=Te,Rt[le+11]=be,Rt[le+12]=ke,Rt[le+13]=be,Rt[le+14]=Te,Rt[le+15]=Wr,Rt[le+16]=Te,Rt[le+17]=be,Rt[le+18]=Wr,Rt[le+19]=be,k.faceidx+=15,k.lineidx+=20}static updateBoundingFromPoints(r,s,l,c){r.center.set(0,0,0);let A=1/0,g=1/0,C=1/0,E=-1/0,S=-1/0,k=-1/0;r.box&&(A=r.box.min.x,E=r.box.max.x,g=r.box.min.y,S=r.box.max.y,C=r.box.min.z,k=r.box.max.z);for(let V=0,W=c;V<W;V++){var D=l[3*V],$=l[3*V+1],U=l[3*V+2];D<A&&(A=D),$<g&&(g=$),U<C&&(C=U),D>E&&(E=D),$>S&&(S=$),U>k&&(k=U)}r.center.set((E+A)/2,(S+g)/2,(k+C)/2),r.radius=r.center.distanceTo({x:E,y:S,z:k}),r.box={min:{x:A,y:g,z:C},max:{x:E,y:S,z:k}}}static addCustomGeo(r,s,l,c,A){var g,C,E,S,k,D,$,U,V,W=s.addGeoGroup(),H=l.vertexArr,Y=l.normalArr,J=l.faceArr;W.vertices=H.length,W.faceidx=J.length;var te=W.vertexArray,de=W.colorArray;for(c.constructor!==Array&&(U=c.r,V=c.g,S=c.b),D=0,$=W.vertices;D<$;++D)g=3*D,C=H[D],te[g]=C.x,te[g+1]=C.y,te[g+2]=C.z,c.constructor===Array&&(U=(k=c[D]).r,V=k.g,S=k.b),de[g]=U,de[g+1]=V,de[g+2]=S;if(A)for(D=0,$=W.faceidx/3;D<$;++D){E=J[g=3*D],S=J[g+1],k=J[g+2];var le=new p.Vector3,ye=new p.Vector3,Pe=new p.Vector3;r.intersectionShape.triangle.push(new y.Triangle(le.copy(H[E]),ye.copy(H[S]),Pe.copy(H[k])))}if(A){var Te=new p.Vector3(0,0,0),ke=0;for(let Je=0;Je<s.geometryGroups.length;Je++)Te.add(s.geometryGroups[Je].getCentroid()),ke++;Te.divideScalar(ke),Oe.updateBoundingFromPoints(r.boundingSphere,{centroid:Te},te,W.vertices)}if(W.faceArray=new Uint16Array(J),W.truncateArrayBuffers(!0,!0),Y.length<W.vertices)W.setNormals();else{var be,Ge=W.normalArray=new Float32Array(3*W.vertices);for(D=0,$=W.vertices;D<$;++D)g=3*D,be=Y[D],Ge[g]=be.x,Ge[g+1]=be.y,Ge[g+2]=be.z}W.setLineIndices(),W.lineidx=W.lineArray.length}static updateFromStyle(r,s){s.color!==void 0?(r.color=s.color||new w.Color,s.color instanceof w.Color||(r.color=w.CC.color(s.color))):r.color=w.CC.color(0),r.wireframe=!!s.wireframe,r.opacity=s.alpha?(0,p.clamp)(s.alpha,0,1):1,s.opacity!==void 0&&(r.opacity=(0,p.clamp)(s.opacity,0,1)),r.side=s.side!==void 0?s.side:u.DoubleSide,r.linewidth=s.linewidth===void 0?1:s.linewidth,r.clickable=!!s.clickable,r.callback=(0,b.makeFunction)(s.callback),r.hoverable=!!s.hoverable,r.hover_callback=(0,b.makeFunction)(s.hover_callback),r.unhover_callback=(0,b.makeFunction)(s.unhover_callback),r.contextMenuEnabled=!!s.contextMenuEnabled,r.hidden=s.hidden,r.frame=s.frame}constructor(r){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=u.DoubleSide,this.stylespec=r||{},this.boundingSphere=new y.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},Oe.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new u.Geometry(!0),this.linegeo=new u.Geometry(!0)}updateStyle(r){for(var s in r)this.stylespec[s]=r[s];if(Oe.updateFromStyle(this,this.stylespec),r.voldata&&r.volscheme){(0,b.adjustVolumeStyle)(r);const l=r.volscheme,c=r.voldata,A=w.CC,g=l.range()||[-1,1];this.geo.setColors(function(C,E,S){let k=c.getVal(C,E,S);return A.color(l.valueToHex(k,g))}),delete this.color}}addCustom(r){r.vertexArr=r.vertexArr||[],r.faceArr=r.faceArr||[],r.normalArr=r.normalArr||[],Oe.drawCustom(this,this.geo,r)}addSphere(r){r.center||(r.center=new p.Vector3(0,0,0)),r.radius=r.radius?(0,p.clamp)(r.radius,0,1/0):1.5,r.color=w.CC.color(r.color),this.intersectionShape.sphere.push(new y.Sphere(r.center,r.radius)),m.drawSphere(this.geo,r.center,r.radius,r.color,r.quality),this.components.push({centroid:new p.Vector3(r.center.x,r.center.y,r.center.z)});var s=this.geo.updateGeoGroup(0);Oe.updateBoundingFromPoints(this.boundingSphere,this.components,s.vertexArray,s.vertices)}addBox(r){var s,l,c,A=r.dimensions||{w:1,h:1,d:1};s=typeof A.w=="number"?{x:A.w,y:0,z:0}:A.w,l=typeof A.h=="number"?{x:0,y:A.h,z:0}:A.h,c=typeof A.d=="number"?{x:0,y:0,z:A.d}:A.d;var g=r.corner;g==null&&(g=r.center!==void 0?{x:r.center.x-.5*(s.x+l.x+c.x),y:r.center.y-.5*(s.y+l.y+c.y),z:r.center.z-.5*(s.z+l.z+c.z)}:{x:0,y:0,z:0});var C=[{x:g.x,y:g.y,z:g.z},{x:g.x+s.x,y:g.y+s.y,z:g.z+s.z},{x:g.x+l.x,y:g.y+l.y,z:g.z+l.z},{x:g.x+s.x+l.x,y:g.y+s.y+l.y,z:g.z+s.z+l.z},{x:g.x+c.x,y:g.y+c.y,z:g.z+c.z},{x:g.x+s.x+c.x,y:g.y+s.y+c.y,z:g.z+s.z+c.z},{x:g.x+l.x+c.x,y:g.y+l.y+c.y,z:g.z+l.z+c.z},{x:g.x+s.x+l.x+c.x,y:g.y+s.y+l.y+c.y,z:g.z+s.z+l.z+c.z}],E=[],S=[];E.splice(E.length,0,C[0],C[1],C[2],C[3]),S.splice(S.length,0,0,2,1,1,2,3);var k=4;E.splice(E.length,0,C[2],C[3],C[6],C[7]),S.splice(S.length,0,k+0,k+2,k+1,k+1,k+2,k+3),k+=4,E.splice(E.length,0,C[4],C[5],C[0],C[1]),S.splice(S.length,0,k+0,k+2,k+1,k+1,k+2,k+3),k+=4,E.splice(E.length,0,C[6],C[7],C[4],C[5]),S.splice(S.length,0,k+0,k+2,k+1,k+1,k+2,k+3),k+=4,E.splice(E.length,0,C[3],C[1],C[7],C[5]),S.splice(S.length,0,k+0,k+2,k+1,k+1,k+2,k+3),k+=4,E.splice(E.length,0,C[2],C[6],C[0],C[4]),S.splice(S.length,0,k+0,k+2,k+1,k+1,k+2,k+3),k+=4;var D=(0,b.extend)({},r);D.vertexArr=E,D.faceArr=S,D.normalArr=[],Oe.drawCustom(this,this.geo,D);var $=new p.Vector3;this.components.push({centroid:$.addVectors(C[0],C[7]).multiplyScalar(.5)});var U=this.geo.updateGeoGroup(0);Oe.updateBoundingFromPoints(this.boundingSphere,this.components,U.vertexArray,U.vertices)}addCylinder(r){var s,l;s=r.start?new p.Vector3(r.start.x||0,r.start.y||0,r.start.z||0):new p.Vector3(0,0,0),r.end?(l=new p.Vector3(r.end.x,r.end.y||0,r.end.z||0)).x===void 0&&(l.x=3):l=new p.Vector3(0,0,0);var c=r.radius||.1,A=w.CC.color(r.color);this.intersectionShape.cylinder.push(new y.Cylinder(s,l,c)),m.drawCylinder(this.geo,s,l,c,A,r.fromCap,r.toCap);var g=new p.Vector3;this.components.push({centroid:g.addVectors(s,l).multiplyScalar(.5)});var C=this.geo.updateGeoGroup(0);Oe.updateBoundingFromPoints(this.boundingSphere,this.components,C.vertexArray,C.vertices)}addDashedCylinder(r){var s,l;r.dashLength=r.dashLength||.25,r.gapLength=r.gapLength||.25,s=r.start?new p.Vector3(r.start.x||0,r.start.y||0,r.start.z||0):new p.Vector3(0,0,0),r.end?(l=new p.Vector3(r.end.x,r.end.y||0,r.end.z||0)).x===void 0&&(l.x=3):l=new p.Vector3(3,0,0);for(var c=r.radius||.1,A=w.CC.color(r.color),g=Math.sqrt(Math.pow(s.x-l.x,2)+Math.pow(s.y-l.y,2)+Math.pow(s.z-l.z,2)),C=g/(r.gapLength+r.dashLength),E=new p.Vector3(r.start.x||0,r.start.y||0,r.start.z||0),S=new p.Vector3(r.end.x,r.end.y||0,r.end.z||0),k=new p.Vector3((l.x-s.x)/(g/r.gapLength),(l.y-s.y)/(g/r.gapLength),(l.z-s.z)/(g/r.gapLength)),D=new p.Vector3((l.x-s.x)/(g/r.dashLength),(l.y-s.y)/(g/r.dashLength),(l.z-s.z)/(g/r.dashLength)),$=0;$<C;$++)S=new p.Vector3(E.x+D.x,E.y+D.y,E.z+D.z),this.intersectionShape.cylinder.push(new y.Cylinder(E,S,c)),m.drawCylinder(this.geo,E,S,c,A,r.fromCap,r.toCap),E=new p.Vector3(S.x+k.x,S.y+k.y,S.z+k.z);var U=new p.Vector3;this.components.push({centroid:U.addVectors(s,l).multiplyScalar(.5)});var V=this.geo.updateGeoGroup(0);Oe.updateBoundingFromPoints(this.boundingSphere,this.components,V.vertexArray,V.vertices)}addCurve(r){r.points=r.points||[],r.smooth=r.smooth||10,r.fromCap===void 0&&(r.fromCap=2),r.toCap===void 0&&(r.toCap=2);var s=I(r.points,r.smooth);if(s.length<3)console.log("Too few points in addCurve");else{var l=r.radius||.1,c=w.CC.color(r.color),A=0,g=s.length-1,C=s[0].distanceTo(s[1]),E=Math.ceil(2*l/C);if(r.toArrow){let $={start:s[g-=E],end:s[s.length-1],radius:l,color:c,mid:1e-4};this.addArrow($)}if(r.fromArrow){let $={start:s[A+=E],end:s[0],radius:l,color:c,mid:1e-4};this.addArrow($)}for(var S=Math.ceil(s.length/2),k={radius:l,color:c,fromCap:2,toCap:2},D=A;D<g;D++)k.start=s[D],k.end=s[D+1],k.fromCap=2,k.toCap=2,D<S?(k.fromCap=2,k.toCap=0):D>S?(k.fromCap=0,k.toCap=2):(k.fromCap=2,k.toCap=2),this.addCylinder(k)}}addLine(r){var s,l;s=r.start?new p.Vector3(r.start.x||0,r.start.y||0,r.start.z||0):new p.Vector3(0,0,0),r.end?(l=new p.Vector3(r.end.x,r.end.y||0,r.end.z||0)).x===void 0&&(l.x=3):l=new p.Vector3(3,0,0);var c=this.geo.updateGeoGroup(2),A=c.vertices,g=3*A,C=c.vertexArray;C[g]=s.x,C[g+1]=s.y,C[g+2]=s.z,C[g+3]=l.x,C[g+4]=l.y,C[g+5]=l.z,c.vertices+=2;var E=c.lineArray,S=c.lineidx;E[S]=A,E[S+1]=A+1,c.lineidx+=2;var k=new p.Vector3;this.components.push({centroid:k.addVectors(s,l).multiplyScalar(.5)}),c=this.geo.updateGeoGroup(0),Oe.updateBoundingFromPoints(this.boundingSphere,this.components,c.vertexArray,c.vertices)}addArrow(r){if(r.start?r.start=new p.Vector3(r.start.x||0,r.start.y||0,r.start.z||0):r.start=new p.Vector3(0,0,0),r.dir instanceof p.Vector3&&typeof r.length=="number"){var s=r.dir.clone().multiplyScalar(r.length).add(r.start);r.end=s}else r.end?(r.end=new p.Vector3(r.end.x,r.end.y||0,r.end.z||0),r.end.x===void 0&&(r.end.x=3)):r.end=new p.Vector3(3,0,0);r.radius=r.radius||.1,r.radiusRatio=r.radiusRatio||1.618034,r.mid=0<r.mid&&r.mid<1?r.mid:.618034,Oe.drawArrow(this,this.geo,r);var l=new p.Vector3;this.components.push({centroid:l.addVectors(r.start,r.end).multiplyScalar(.5)});var c=this.geo.updateGeoGroup(0);Oe.updateBoundingFromPoints(this.boundingSphere,this.components,c.vertexArray,c.vertices)}static distance_from(r,s){return Math.sqrt(Math.pow(r.x-s.x,2)+Math.pow(r.y-s.y,2)+Math.pow(r.z-s.z,2))}static inSelectedRegion(r,s,l){for(var c=0;c<s.length;c++)if(Oe.distance_from(s[c],r)<=l)return!0;return!1}addIsosurface(r,s,l,c){var A,g,C=s.isoval!==void 0&&typeof s.isoval=="number"?s.isoval:0,E=!!s.voxel,S=s.smoothness===void 0?1:s.smoothness,k=r.size.x,D=r.size.y,$=r.size.z,U=new Int16Array(k*D*$),V=r.data;for(A=0,g=U.length;A<g;++A)U[A]=-1;var W=new Uint8Array(k*D*$);for(A=0,g=V.length;A<g;++A)(C>=0?V[A]-C:C-V[A])>0&&(W[A]|=Oe.ISDONE);var H=[],Y=[];x.march(W,H,Y,{fulltable:!0,voxel:E,unitCube:r.unit,origin:r.origin,matrix:r.matrix,nX:k,nY:D,nZ:$}),!E&&S>0&&x.laplacianSmooth(S,H,Y);var J=[],te=[],de=[];if(s.selectedRegion&&s.coords===void 0&&(s.coords=s.selectedRegion),s.coords===void 0&&s.selection!==void 0&&(c?s.coords=c.selectedAtoms(s.selection):console.log("addIsosurface needs viewer is selection provided.")),s.coords!==void 0){var le=s.coords[0].x,ye=s.coords[0].y,Pe=s.coords[0].z,Te=s.coords[0].x,ke=s.coords[0].y,be=s.coords[0].z;for(let Be=0;Be<s.coords.length;Be++)s.coords[Be].x>le?le=s.coords[Be].x:s.coords[Be].x<Te&&(Te=s.coords[Be].x),s.coords[Be].y>ye?ye=s.coords[Be].y:s.coords[Be].y<ke&&(ke=s.coords[Be].y),s.coords[Be].z>Pe?Pe=s.coords[Be].z:s.coords[Be].z<be&&(be=s.coords[Be].z);var Ge=2;s.radius!==void 0&&(Ge=s.radius),s.selectedOffset!==void 0&&(Ge=s.selectedOffset),s.seldist!==void 0&&(Ge=s.seldist),Te-=Ge,le+=Ge,ke-=Ge,ye+=Ge,be-=Ge,Pe+=Ge;for(let Be=0;Be<H.length;Be++)H[Be].x>Te&&H[Be].x<le&&H[Be].y>ke&&H[Be].y<ye&&H[Be].z>be&&H[Be].z<Pe&&Oe.inSelectedRegion(H[Be],s.coords,Ge)?(J.push(te.length),te.push(H[Be])):J.push(-1);for(let Be=0;Be+2<Y.length;Be+=3)J[Y[Be]]!==-1&&J[Y[Be+1]]!==-1&&J[Y[Be+2]]!==-1&&(de.push(Y[Be]-(Y[Be]-J[Y[Be]])),de.push(Y[Be+1]-(Y[Be+1]-J[Y[Be+1]])),de.push(Y[Be+2]-(Y[Be+2]-J[Y[Be+2]])));H=te,Y=de}Oe.drawCustom(this,this.geo,{vertexArr:H,faceArr:Y,normalArr:[],clickable:s.clickable,hoverable:s.hoverable}),this.updateStyle(s);var Je=new p.Vector3(r.origin.x,r.origin.y,r.origin.z),tt=new p.Vector3(r.size.x*r.unit.x,r.size.y*r.unit.y,r.size.z*r.unit.z),Ye=new p.Vector3(0,0,0),ut=Je.clone(),ft=Je.clone().add(tt);for(let Be=0;Be<H.length;Be++)Ye.add(H[Be]),ut.max(H[Be]),ft.min(H[Be]);Ye.divideScalar(H.length);var Qe=Ye.distanceTo(ft),pt=Ye.distanceTo(ut);this.boundingSphere.center=Ye,this.boundingSphere.radius=Math.max(Qe,pt),typeof l=="function"&&l()}addVolumetricData(r,s,l){r=new Ve.VolumeData(r,s),this.addIsosurface(r,l)}finalize(){return Oe.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj(r){if(this.renderedShapeObj&&(r.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){Oe.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),this.color!==void 0&&Oe.updateColor(this.geo,this.color),this.shapeObj=new u.Object3D;var s=null;s=this.side==u.DoubleSide?new u.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:u.Coloring.VertexColors}):new u.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:u.Coloring.VertexColors});var l=new u.Mesh(this.geo,s);if(this.shapeObj.add(l),this.linegeo&&this.linegeo.vertices>0){var c=new u.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),A=new u.Line(this.linegeo,c,u.LineStyle.LinePieces);this.shapeObj.add(A)}this.renderedShapeObj=this.shapeObj.clone(),r.add(this.renderedShapeObj)}}removegl(r){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),r.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}function yt(ae){if(ae.vertexArr.length<64e3)return[ae];var r=[{vertexArr:[],normalArr:[],faceArr:[]}];ae.colorArr&&(r.colorArr=[]);var s=[],l=[],c=0,A=ae.faceArr;for(let C=0,E=A.length;C<E;C+=3){let S=r[c];for(let k=0;k<3;k++){var g=A[C+k];s[g]!==c&&(s[g]=c,l[g]=S.vertexArr.length,S.vertexArr.push(ae.vertexArr[g]),ae.normalArr&&ae.normalArr[g]&&S.normalArr.push(ae.normalArr[g]),ae.colorArr&&ae.colorArr[g]&&S.colorArr.push(ae.colorArr[g])),S.faceArr.push(l[g])}S.vertexArr.length>=64e3&&(r.push({vertexArr:[],normalArr:[],faceArr:[]}),ae.colorArr&&(r.colorArr=[]),c++)}return r}Oe.ISDONE=2,Oe.drawCustom=function(ae,r,s){var l=s,c=l.vertexArr,A=l.faceArr;c.length!==0&&A.length!==0||console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var g=s.color;g===void 0&&(g=ae.color),g=w.CC.color(g);for(var C=yt(l),E=0,S=C.length;E<S;E++)Oe.addCustomGeo(ae,r,C[E],C[E].colorArr?C[E].colorArr:g,s.clickable)};let lt=0;function mt(ae,r,s){var l=s;return ae!==void 0&&(ae instanceof w.Color?l=ae.scaled():(l=w.CC.color(ae)).scaled!==void 0&&(l=l.scaled())),r!==void 0&&(l.a=parseFloat(r)),l}class Mt{constructor(r,s){this.id=lt++,this.stylespec=s||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new u.Sprite,this.text=r,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}hide(){this.sprite&&(this.sprite.visible=!1)}show(){this.sprite&&(this.sprite.visible=!0)}setContext(){var r=this.stylespec,s=r.useScreen!==void 0&&r.useScreen,l=r.showBackground;l!=="0"&&l!=="false"||(l=!1),l===void 0&&(l=!0);var c=r.font?r.font:"sans-serif",A=parseInt(r.fontSize)?parseInt(r.fontSize):18,g=mt(r.fontColor,r.fontOpacity,{r:255,g:255,b:255,a:1}),C=r.padding?r.padding:4,E=r.borderThickness?r.borderThickness:0,S=mt(r.backgroundColor,r.backgroundOpacity,{r:0,g:0,b:0,a:1}),k=mt(r.borderColor,r.borderOpacity,S),D=r.position?r.position:{x:-10,y:1,z:1},$=r.inFront===void 0||r.inFront;$!=="false"&&$!=="0"||($=!1);var U=r.alignment||u.SpriteAlignment.topLeft;typeof U=="string"&&U in u.SpriteAlignment&&(U=u.SpriteAlignment[U]);var V="";r.bold&&(V="bold "),this.context.font=V+A+"px  "+c;var W=this.context.measureText(this.text).width;l||(E=0);var H=W+2.5*E+2*C,Y=1.25*A+2*E+2*C;if(r.backgroundImage){var J=r.backgroundImage,te=r.backgroundWidth?r.backgroundWidth:J.width,de=r.backgroundHeight?r.backgroundHeight:J.height;te>H&&(H=te),de>Y&&(Y=de)}if(this.canvas.width=H,this.canvas.height=Y,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),V="",r.bold&&(V="bold "),this.context.font=V+A+"px  "+c,this.context.fillStyle="rgba("+S.r+","+S.g+","+S.b+","+S.a+")",this.context.strokeStyle="rgba("+k.r+","+k.g+","+k.b+","+k.a+")",r.backgroundGradient){let ye=this.context.createLinearGradient(0,Y/2,H,Y/2),Pe=M.Gradient.getGradient(r.backgroundGradient),Te=Pe.range(),ke=-1,be=1;Te&&(ke=Te[0],be=Te[1]);let Ge=be-ke;for(let Je=0;Je<1.01;Je+=.1){let tt=mt(Pe.valueToHex(ke+Ge*Je)),Ye="rgba("+tt.r+","+tt.g+","+tt.b+","+tt.a+")";ye.addColorStop(Je,Ye)}this.context.fillStyle=ye}this.context.lineWidth=E,l&&(function(ye,Pe,Te,ke,be,Ge,Je){ye.beginPath(),ye.moveTo(Pe+Ge,Te),ye.lineTo(Pe+ke-Ge,Te),ye.quadraticCurveTo(Pe+ke,Te,Pe+ke,Te+Ge),ye.lineTo(Pe+ke,Te+be-Ge),ye.quadraticCurveTo(Pe+ke,Te+be,Pe+ke-Ge,Te+be),ye.lineTo(Pe+Ge,Te+be),ye.quadraticCurveTo(Pe,Te+be,Pe,Te+be-Ge),ye.lineTo(Pe,Te+Ge),ye.quadraticCurveTo(Pe,Te,Pe+Ge,Te),ye.closePath(),ye.fill(),Je&&ye.stroke()})(this.context,E,E,H-2*E,Y-2*E,6,E>0),r.backgroundImage&&this.context.drawImage(J,0,0,H,Y),this.context.fillStyle="rgba("+g.r+","+g.g+","+g.b+","+g.a+")",this.context.fillText(this.text,E+C,A+E+C,W);var le=new u.Texture(this.canvas);le.needsUpdate=!0,this.sprite.material=new u.SpriteMaterial({map:le,useScreenCoordinates:s,alignment:U,depthTest:!$,screenOffset:r.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(D.x,D.y,D.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}class Pt{static interpolateArray(r,s){function l(D,$,U){return D+($-D)*U}var c=[],A=(r.length-1)/(s-1);c[0]=r[0];for(var g=1;g<s-1;g++){var C=g*A,E=Math.floor(C),S=Math.ceil(C),k=C-E;c[g]=l(r[E],r[S],k)}return c[s-1]=r[r.length-1],c}constructor(r,s,l){this.hidden=!1,this.boundingSphere=new y.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,s=s||{};var c,A,g,C,E,S,k,D,$,U,V=Object.assign([],s.transferfn);this.subsamples=s.subsamples||5,V.forEach(function(H){H.value=parseFloat(H.value)}),V.sort(function(H,Y){return H.value-Y.value}),this.min=V[0].value,V.length==0&&V.push(V[0]),this.max=V[V.length-1].value;for(let H=0;H<V.length-1;H++)if(g=w.CC.color(V[H].color),C=w.CC.color(V[H+1].color),$=V[H].opacity,U=V[H+1].opacity,(c=Math.floor(256*(V[H].value-this.min)/(this.max-this.min)))!=(A=Math.floor(256*(V[H+1].value-this.min)/(this.max-this.min)))){E=Pt.interpolateArray([255*g.r,255*C.r],A-c),S=Pt.interpolateArray([255*g.g,255*C.g],A-c),k=Pt.interpolateArray([255*g.b,255*C.b],A-c),D=Pt.interpolateArray([255*$,255*U],A-c);for(let Y=0;Y<E.length;Y++)this.transferfunctionbuffer.push(E[Y]),this.transferfunctionbuffer.push(S[Y]),this.transferfunctionbuffer.push(k[Y]),this.transferfunctionbuffer.push(D[Y])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),r.matrix){let H=new p.Vector3(0,0,0),Y=new p.Vector3(r.size.x,r.size.y,r.size.z),J=new p.Vector3(1,1,1);H.applyMatrix4(r.matrix),Y.applyMatrix4(r.matrix),J.applyMatrix4(r.matrix).sub(H),this.extent=[[H.x,H.y,H.z],[Y.x,Y.y,Y.z]];for(let ye=1;ye<7;ye++)Y.x=1&ye?r.size.x:0,Y.y=2&ye?r.size.y:0,Y.z=4&ye?r.size.z:0,Y.applyMatrix4(r.matrix),this.extent[0][0]=Math.min(this.extent[0][0],Y.x),this.extent[0][1]=Math.min(this.extent[0][1],Y.y),this.extent[0][2]=Math.min(this.extent[0][2],Y.z),this.extent[1][0]=Math.max(this.extent[1][0],Y.x),this.extent[1][1]=Math.max(this.extent[1][1],Y.y),this.extent[1][2]=Math.max(this.extent[1][2],Y.z);let te=Y.x-H.x,de=Y.y-H.y,le=Y.z-H.z;this.maxdepth=Math.sqrt(te*te+de*de+le*le),this.minunit=Math.min(Math.min(J.x,J.y),J.z),this.texmatrix=new p.Matrix4().identity().scale({x:r.size.x,y:r.size.y,z:r.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(r.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new p.Matrix4().identity();let H=r.unit.x*r.size.x,Y=r.unit.y*r.size.y,J=r.unit.z*r.size.z;this.texmatrix.makeTranslation(-r.origin.x/H,-r.origin.y/Y,-r.origin.z/J),this.texmatrix.scale({x:1/H,y:1/Y,z:1/J}),this.minunit=Math.min(Math.min(r.unit.x,r.unit.y),r.unit.z),this.extent=[[r.origin.x,r.origin.y,r.origin.z],[r.origin.x+H,r.origin.y+Y,r.origin.z+J]],this.maxdepth=Math.sqrt(H*H+Y*Y+J*J)}var W=new Oe({});if(W.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=W.finalize(),this.boundingSphere.center=new p.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,s.coords===void 0&&s.selection!==void 0&&(l?s.coords=l.selectedAtoms(s.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),s.coords!==void 0&&s.seldist!==void 0){let H=new Uint8Array(r.data.length),Y=s.seldist,J=Y*Y;for(let te=0,de=s.coords.length;te<de;te++){let le=s.coords[te],ye=le.x-Y,Pe=le.y-Y,Te=le.z-Y,ke=le.x+Y,be=le.y+Y,Ge=le.z+Y;if(r.getIndex(ye,Pe,Te)>=0||r.getIndex(ke,be,Ge)>=0)for(let Je=ye;Je<ke;Je+=this.minunit)for(let tt=Pe;tt<be;tt+=this.minunit)for(let Ye=Te;Ye<Ge;Ye+=this.minunit){let ut=r.getIndex(Je,tt,Ye);ut>=0&&!H[ut]&&(Je-le.x)*(Je-le.x)+(tt-le.y)*(tt-le.y)+(Ye-le.z)*(Ye-le.z)<J&&(H[ut]=1)}}for(let te=0,de=r.data.length;te<de;te++)H[te]==0&&(r.data[te]=1/0)}this.data=r}globj(r){if(this.renderedShapeObj&&(r.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new u.Object3D;var s,l=new u.Texture(this.data,!0),c=new u.Texture(this.transferfunctionbuffer,!1);l.needsUpdate=!0,c.needsUpdate=!0,c.flipY=!1,s=new u.VolumetricMaterial({transferfn:c,transfermin:this.min,transfermax:this.max,map:l,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var A=new u.Mesh(this.geo,s);this.shapeObj.add(A),this.renderedShapeObj=this.shapeObj.clone(),r.add(this.renderedShapeObj)}}removegl(r){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),r.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}const Ot=16;class gr extends Array{constructor(r){super(...r)}getSymmetries(){if(this.length==0)return[];let r=this[0];return r.symmetries===void 0&&this.setSymmetries([new p.Matrix4]),r.symmetries}setSymmetries(r){r===void 0&&(r=[new p.Matrix4]);for(let s of this)s.symmetries=r,s.finished=!1}}class Yt{getWidth(){let r=this.container,s=r.offsetWidth;if(s==0&&r.style.display==="none"){let l=r.style.position,c=r.style.visibility;r.style.display="block",r.style.visibility="hidden",r.style.position="absolute",s=r.offsetWidth,r.style.display="none",r.style.visibility=c,r.style.position=l}return s}getHeight(){let r=this.container,s=r.offsetHeight;if(s==0&&r.style.display==="none"){let l=r.style.position,c=r.style.visibility;r.style.display="block",r.style.visibility="hidden",r.style.position="absolute",s=r.offsetHeight,r.style.display="none",r.style.visibility=c,r.style.position=l}return s}setupRenderer(){let r=Object.assign(Object.assign({},this.config),{preserveDrawingBuffer:!0,premultipliedAlpha:!1,containerWidth:this.WIDTH,containerHeight:this.HEIGHT});this.renderer=new u.Renderer(r),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new u.Scene,this.scene.fog=new u.Fog(this.bgColor,100,200),this.modelGroup=new u.Object3D,this.rotationGroup=new u.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new p.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var r=new u.Light(16777215);r.position=new p.Vector3(.2,.2,1).normalize(),r.intensity=1,this.scene.add(r)}_handleLostContext(r){const s=function(l){const c=l.getBoundingClientRect();return!(c.right<0||c.bottom<0||c.top>(window.innerHeight||document.documentElement.clientHeight)||c.left>(window.innerWidth||document.documentElement.clientWidth))};if(s(this.container)){let l=0;for(let c of document.getElementsByTagName("canvas"))if(s(c)&&c._3dmol_viewer!=null&&(c._3dmol_viewer.resize(),l+=1,l>=Ot))break}}initContainer(r){this.container=r,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var r=0;for(let l in this.surfaces)if(this.surfaces.hasOwnProperty(l)){var s=parseInt(l);isNaN(s)||s>r&&(r=s)}return r+1}setSlabAndFog(){let r=this.camera.position.z-this.rotationGroup.position.z;r<1&&(r=1),this.camera.near=r+this.slabNear,!this.camera.ortho&&this.camera.near<1&&(this.camera.near=1),this.camera.far=r+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=r*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.near+this.fogEnd*(this.camera.far-this.camera.near),this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(r){if(this.renderer.setViewport(),this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!r&&this.linkedViewers.length>0))for(var s=this._viewer.getView(),l=0;l<this.linkedViewers.length;l++)this.linkedViewers[l].setView(s,!0)}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let r=0,s=this.models.length;r<s;r++){let l=this.models[r];if(l){let c=l.selectedAtoms({clickable:!0}),A=l.selectedAtoms({hoverable:!0}),g=l.selectedAtoms({contextMenuEnabled:!0});for(let C=0;C<A.length;C++)this.hoverables.push(A[C]);for(let C=0;C<c.length;C++)this.clickables.push(c[C]);for(let C=0;C<g.length;C++)this.contextMenuEnabledObjects.push(g[C])}}for(let r=0,s=this.shapes.length;r<s;r++){let l=this.shapes[r];l&&l.clickable&&this.clickables.push(l),l&&l.hoverable&&this.hoverables.push(l),l&&l.contextMenuEnabled&&this.contextMenuEnabledObjects.push(l)}}handleClickSelection(r,s,l){let c=this.targetedObjects(r,s,this.clickables);if(c.length){var A=c[0].clickable;A.callback!==void 0&&(typeof A.callback!="function"&&(A.callback=(0,b.makeFunction)(A.callback)),typeof A.callback=="function")&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(A)&&this.userContextMenuHandler||A.callback(A,this._viewer,l,this.container,c))}}canvasOffset(){let r=this.glDOM,s=r.getBoundingClientRect(),l=r.ownerDocument,c=l.documentElement,A=l.defaultView;return{top:s.top+A.pageYOffset-c.clientTop,left:s.left+A.pageXOffset-c.clientLeft}}setHover(r,s,l){this.current_hover!=r&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,b.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,s,this.container,l)),this.current_hover=r,r&&r.hover_callback!==void 0&&(typeof r.hover_callback!="function"&&(r.hover_callback=(0,b.makeFunction)(r.hover_callback)),typeof r.hover_callback=="function"&&r.hover_callback(r,this._viewer,s,this.container,l)))}handleHoverSelection(r,s,l){if(this.hoverables.length==0)return;let c=this.targetedObjects(r,s,this.hoverables);if(c.length){var A=c[0].clickable;this.setHover(A,l,c),this.current_hover=A}else this.setHover(null)}handleHoverContinue(r,s){let l=this.targetedObjects(r,s,this.hoverables);l.length!=0&&l[0]!==void 0||this.setHover(null),l[0]!==void 0&&l[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(r,{allowTolerance:s=r.targetTouches,tolerance:l=5}={}){const c=this.getX(r),A=this.getY(r);if(s){const g=Math.abs(c-this.mouseStartX),C=Math.abs(A-this.mouseStartY);return g<=l&&C<=l}return c===this.mouseStartX&&A===this.mouseStartY}calcTouchDistance(r){var s=r.targetTouches[0].pageX-r.targetTouches[1].pageX,l=r.targetTouches[0].pageY-r.targetTouches[1].pageY;return Math.hypot(s,l)}getX(r){var s=r.pageX;return s==null&&(s=r.pageX),r.targetTouches&&r.targetTouches[0]?s=r.targetTouches[0].pageX:r.changedTouches&&r.changedTouches[0]&&(s=r.changedTouches[0].pageX),s}getY(r){var s=r.pageY;return s==null&&(s=r.pageY),r.targetTouches&&r.targetTouches[0]?s=r.targetTouches[0].pageY:r.changedTouches&&r.changedTouches[0]&&(s=r.changedTouches[0].pageY),s}isInViewer(r,s){if(this.viewers!=null){var l=this.WIDTH/this.cols,c=this.HEIGHT/this.rows,A=this.canvasOffset(),g=r-A.left,C=s-A.top,E=this.rows-Math.floor(C/c)-1,S=Math.floor(g/l);if(E!=this.row||S!=this.col)return!1}return!0}adjustZoomToLimits(r){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let s=this.CAMERA_Z-this.config.lowerZoomLimit;r>s&&(r=s)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let s=this.CAMERA_Z-this.config.upperZoomLimit;r<s&&(r=s)}return r>this.CAMERA_Z-1&&(r=this.CAMERA_Z-1),r}static slerp(r,s,l){if(l==1)return s.clone();if(l==0)return r.clone();let c=r.x*s.x+r.y*s.y+r.z*s.z+r.w*s.w;if(c>.9995){let k=new p.Quaternion(r.x+l*(s.x-r.x),r.y+l*(s.y-r.y),r.z+l*(s.z-r.z),r.w+l*(s.w-r.w));return k.normalize(),k}c<0&&(s=s.clone().multiplyScalar(-1),c=-c),c>1?c=1:c<-1&&(c=-1);var A=Math.acos(c)*l,g=s.clone();g.sub(r.clone().multiplyScalar(c)),g.normalize();var C=Math.cos(A),E=Math.sin(A),S=new p.Quaternion(r.x*C+g.x*E,r.y*C+g.y*E,r.z*C+g.z*E,r.w*C+g.w*E);return S.normalize(),S}constructor(r,s={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.fogEnd=1,this.slabNear=-50,this.slabFar=50,this.cq=new p.Quaternion(0,0,0,1),this.dq=new p.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=s,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=w.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",this.config.backgroundColor!==void 0&&(this.bgColor=w.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,this.config.camerax!==void 0&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=r,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new u.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new p.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new p.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new u.Raycaster(new p.Vector3(0,0,0),new p.Vector3(0,0,0)),this.projector=new u.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=w.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),window.ResizeObserver!==void 0&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),window.IntersectionObserver!==void 0){let l=(c,A)=>{c.forEach(g=>{g.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(l),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(l){console.log("error with glviewer callback: "+l)}}targetedObjects(r,s,l){var c={x:r,y:s,z:-1};return Array.isArray(l)||(l=this.selectedAtoms(l)),l.length==0?[]:(this.raycaster.setFromCamera(c,this.camera),this.raycaster.intersectObjects(this.modelGroup,l))}modelToScreen(r){let s=!1;Array.isArray(r)||(r=[r],s=!0);let l=this.renderer.getXRatio(),c=this.renderer.getYRatio(),A=this.col,g=this.row,C=A*(this.WIDTH/l),E=(c-g-1)*(this.HEIGHT/c),S=[],k=this.canvasOffset();return r.forEach(D=>{let $=new p.Vector3(D.x,D.y,D.z);$.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector($,this.camera);let U=this.WIDTH/l*($.x+1)/2+k.left+C,V=-this.HEIGHT/c*($.y-1)/2+k.top+E;S.push({x:U,y:V})}),s&&(S=S[0]),S}screenOffsetToModel(r,s,l){var c=r/this.WIDTH,A=s/this.HEIGHT,g=l===void 0?this.rotationGroup.position.z:l,C=this.rotationGroup.quaternion,E=new p.Vector3(0,0,g);return this.projector.projectVector(E,this.camera),E.x+=2*c,E.y-=2*A,this.projector.unprojectVector(E,this.camera),E.z=0,E.applyQuaternion(C),E}screenToModelDistance(r,s){let l=this.canvasOffset(),c=new p.Vector3(s.x,s.y,s.z);c.applyMatrix4(this.modelGroup.matrixWorld);let A=c.clone();this.projector.projectVector(c,this.camera);let g=new p.Vector3(2*(r.x-l.left)/this.WIDTH-1,2*(r.y-l.top)/-this.HEIGHT+1,c.z);return this.projector.unprojectVector(g,this.camera),g.distanceTo(A)}setViewChangeCallback(r){typeof r!="function"&&r!=null||(this.viewChangeCallback=r)}setStateChangeCallback(r){typeof r!="function"&&r!=null||(this.stateChangeCallback=r)}getConfig(){return this.config}setConfig(r){this.config=r,r.ambientOcclusion&&this.renderer.enableAmbientOcclusion(r.ambientOcclusion)}getInternalState(){var r={models:[],surfaces:[],shapes:[],labels:[]};for(let s=0;s<this.models.length;s++)this.models[s]&&(r.models[s]=this.models[s].getInternalState());return r}setInternalState(r){this.clear();var s=r.models;for(let l=0;l<s.length;l++)s[l]&&(this.models[l]=new ur(l,void 0,this),this.models[l].setInternalState(s[l]));this.render()}setZoomLimits(r,s){r!==void 0&&(this.config.lowerZoomLimit=r),s&&(this.config.upperZoomLimit=s),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(r){r.fov!==void 0&&(this.fov=r.fov,this.camera.fov=this.fov),r.z!==void 0&&(this.CAMERA_Z=r.z,this.camera.z=this.CAMERA_Z),r.orthographic!==void 0&&(this.camera.ortho=r.orthographic),this.setSlabAndFog()}_handleMouseDown(r){if(r.preventDefault(),!this.scene)return;var s=this.getX(r),l=this.getY(r);if(s===void 0)return;this.isDragging=!0,this.mouseButton=r.which,this.mouseStartX=s,this.mouseStartY=l,this.touchHold=!0,this.touchDistanceStart=0,r.targetTouches&&r.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(r)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let c=this;r.targetTouches&&r.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(c.touchHold==1){c.glDOM=c.renderer.domElement;const A=r.targetTouches[0],g=new PointerEvent("contextmenu",Object.assign(Object.assign({},r),{pageX:A.pageX,pageY:A.pageY,screenX:A.screenX,screenY:A.screenY,clientX:A.clientX,clientY:A.clientY}));c.glDOM.dispatchEvent(g)}},this.longTouchDuration))}_handleMouseUp(r){if(this.touchHold=!1,this.isDragging&&this.scene){var s=this.getX(r),l=this.getY(r);if(this.closeEnoughForClick(r)&&this.isInViewer(s,l)){let c=this.mouseXY(s,l);this.handleClickSelection(c.x,c.y,r)}}this.isDragging=!1}_handleMouseScroll(r){if(r.preventDefault(),this.scene){var s=this.getX(r),l=this.getY(r);if(s!==void 0&&(this.control_all||this.isInViewer(s,l))){var c=.85*(this.CAMERA_Z-this.rotationGroup.position.z),A=1;if(r.ctrlKey&&(A=-1),r.detail)this.rotationGroup.position.z+=A*c*r.detail/10;else if(r.wheelDelta){let g=600*r.wheelDelta/(r.wheelDelta+600);this.rotationGroup.position.z-=A*c*g/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(r){let s=this;return r=r||1,new Promise(function(l){let c=0,A=s.viewChangeCallback,g=[],C=[],E=Date.now();s.viewChangeCallback=function(){C.push(Date.now()-E),E=Date.now(),g.push(new Promise(S=>{s.getCanvas().toBlob(function(k){k.arrayBuffer().then(S)},"image/png")})),c+=1,c==r&&(s.viewChangeCallback=A,Promise.all(g).then(S=>{let k=[];for(let H=0;H<S.length;H++){let Y=(0,z.decode)(S[H]);k.push((0,z.toRGBA8)(Y)[0])}let D=s.getCanvas().width,$=s.getCanvas().height,U=(0,z.encode)(k,D,$,0,C),V=new Blob([U],{type:"image/png"}),W=new FileReader;W.onload=function(H){l(H.target.result)},W.readAsDataURL(V)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(r){this.hoverDuration=r}mouseXY(r,s){let l=this.canvasOffset(),c=this.renderer.getXRatio(),A=this.renderer.getYRatio(),g=this.col,C=this.row,E=g*(this.WIDTH/c),S=(A-C-1)*(this.HEIGHT/A);return{x:(r-l.left-E)/(this.WIDTH/c)*2-1,y:-(s-l.top-S)/(this.HEIGHT/A)*2+1}}_handleMouseMove(r){clearTimeout(this.hoverTimeout),r.preventDefault();let s=this.getX(r),l=this.getY(r);if(s===void 0)return;let c=this.renderer.getXRatio(),A=this.renderer.getYRatio(),g=this.mouseXY(s,l),C=this;this.current_hover!==null&&this.handleHoverContinue(g.x,g.y);var E=0;if((this.control_all||this.isInViewer(s,l))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){C.handleHoverSelection(g.x,g.y,r)},this.hoverDuration)),this.isDragging)){r.targetTouches&&(r.targetTouches.length>1||r.targetTouches.length===1&&!this.closeEnoughForClick(r))&&clearTimeout(this.longTouchTimeout);var S=(s-this.mouseStartX)/this.WIDTH,k=(l-this.mouseStartY)/this.HEIGHT;this.touchDistanceStart!=0&&r.targetTouches&&r.targetTouches.length==2?(E=2,k=2*(this.calcTouchDistance(r)-this.touchDistanceStart)/(this.WIDTH+this.HEIGHT)):r.targetTouches&&r.targetTouches.length==3&&(E=1),S*=c,k*=A;var D,$=Math.hypot(S,k);if(E==3||this.mouseButton==3&&r.ctrlKey)this.slabNear=this.cslabNear+100*S,this.slabFar=this.cslabFar-100*k;else if(E==2||this.mouseButton==3||r.shiftKey)(D=.85*(this.CAMERA_Z-this.rotationGroup.position.z))<80&&(D=80),this.rotationGroup.position.z=this.cz+k*D,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(E==1||this.mouseButton==2||r.ctrlKey){var U=this.screenOffsetToModel(c*(s-this.mouseStartX),A*(l-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,U)}else if((E===0||this.mouseButton==1)&&$!==0){var V=Math.sin($*Math.PI)/$;this.dq.x=Math.cos($*Math.PI),this.dq.y=0,this.dq.z=V*S,this.dq.w=-V*k,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(r){if(r.preventDefault(),this.closeEnoughForClick(r)){var s=this.mouseStartX,l=this.mouseStartY,c=this.canvasOffset();let g=this.mouseXY(s,l),C=g.x,E=g.y,S=this.targetedObjects(C,E,this.contextMenuEnabledObjects);var A=null;S.length&&(A=S[0].clickable),c=this.canvasOffset(),s=this.mouseStartX-c.left,l=this.mouseStartY-c.top,this.userContextMenuHandler&&(this.userContextMenuHandler(A,s,l,S,r),this.isDragging=!1)}}setContainer(r){let s=(0,b.getElement)(r)||this.container;return this.initContainer(s),this}setBackgroundColor(r,s){(s===void 0||s<0||s>1)&&(s=1);var l=w.CC.color(r);return this.scene.fog.color=l,this.bgColor=l.getHex(),this.renderer.setClearColorHex(l.getHex(),s),this.show(),this}setProjection(r){this.camera.ortho=r==="orthographic",this.setSlabAndFog()}setViewStyle(r){if((r=r||{}).style=r.style||"",r.style.includes("outline")?this.renderer.enableOutline(r):this.renderer.disableOutline(),r.style.includes("ambientOcclusion")){var s={};r.strength&&(s.strength=r.strength),r.radius&&(s.radius=r.radius),this.renderer.enableAmbientOcclusion(s)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(r){return this.WIDTH=r||this.WIDTH,this.updateSize(),this}setHeight(r){return this.HEIGHT=r||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let r=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let s=!1,l=this.container.querySelector("canvas");l&&l!=this.renderer.getCanvas()?this.config.canvas=l:(l.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,s=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),r=!0,s&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),r){let s=this.renderer.supportedExtensions();if(s.regen=!0,this.viewers)for(let l=0,c=this.viewers.length;l<c;l++)for(let A=0,g=this.viewers[l].length;A<g;A++)this.viewers[l][A].render(null,s);this._viewer.render(null,s)}else this.WIDTH>0&&this.HEIGHT>0&&this.show();return this}getModel(r){return r===void 0?this.models.length==0?null:this.models[this.models.length-1]:r instanceof ur?r:r in this.models?this.models[r]:this.models.length==0?null:this.models[this.models.length-1]}spin(r,s=1,l=!1){if(clearInterval(this.spinInterval),r===void 0&&(r="y"),typeof r=="boolean"){if(!r)return;r="y"}Array.isArray(r)&&(r={x:r[0],y:r[1],z:r[2]});var c=this;this.spinInterval=setInterval(function(){!c.getCanvas().isConnected&&c.renderer.isLost()&&clearInterval(c.spinInterval),(!l||c.container.checkVisibility&&c.container.checkVisibility())&&c.rotate(1*s,r)},25)}animateMotion(r,s,l,c,A,g){var C=Math.ceil(r/20);C<1&&(C=1),this.incAnim();var E={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(s){let D=new Array(C);for(let W=0;W<C;W++){let H=(W+1)/C,Y={mpos:E.mpos,rz:E.rz,rot:E.rot};Y.mpos=l.clone().sub(E.mpos).multiplyScalar(H).add(E.mpos),Y.rz=E.rz+H*(c-E.rz),Y.rot=Yt.slerp(E.rot,A,H),Y.cam=g.clone().sub(E.cam).multiplyScalar(H).add(E.cam),D[W]=Y}let $=0,U=this,V=function(){var W=D[$];$+=1,U.modelGroup.position=W.mpos,U.rotationGroup.position.z=W.rz,U.rotationGroup.quaternion=W.rot,U.camera.lookAt(W.cam),$<D.length?setTimeout(V,20):U.decAnim(),U.show()};setTimeout(V,20)}else{var S={};let D=1/C;if(l&&(S.mpos=l.clone().sub(E.mpos).multiplyScalar(D)),c!==void 0&&c!=null&&(S.rz=D*(c-E.rz)),A){var k=Yt.slerp(E.rot,A,D);S.rot=E.rot.clone().inverse().multiply(k)}g&&(S.cam=g.clone().sub(E.cam).multiplyScalar(D));let $=0,U=this,V=function(){$+=1,S.mpos&&U.modelGroup.position.add(S.mpos),S.rz&&(U.rotationGroup.position.z+=S.rz),S.rot&&U.rotationGroup.quaternion.multiply(S.rot),S.cam&&(U.lookingAt.add(S.cam),U.camera.lookAt(U.lookingAt)),$<C?setTimeout(V,20):U.decAnim(),U.show()};setTimeout(V,20)}}rotate(r,s="y",l=0,c=!1){if(s=="x"?s={x:1,y:0,z:0}:s=="y"?s={x:0,y:1,z:0}:s=="z"&&(s={x:0,y:0,z:1}),s=="vx"?s={vx:1,vy:0,vz:0}:s=="vy"?s={vx:0,vy:1,vz:0}:s=="vz"&&(s={vx:0,vy:0,vz:1}),s.vx!==void 0){var A=new p.Vector3(s.vx,s.vy,s.vz);A.applyQuaternion(this.rotationGroup.quaternion),s={x:A.x,y:A.y,z:A.z}}var g=(function(E){var S,k,D,$=Math.sin(E/2),U=Math.cos(E/2);return S=s.x*$,k=s.y*$,D=s.z*$,new p.Quaternion(S,k,D,U).normalize()})(Math.PI*r/180);if(l){var C=new p.Quaternion().copy(this.rotationGroup.quaternion).multiply(g);this.animateMotion(l,c,this.modelGroup.position,this.rotationGroup.position.z,C,this.lookingAt)}else this.rotationGroup.quaternion.multiply(g),this.show();return this}surfacesFinished(){for(var r in this.surfaces)if(!this.surfaces[r][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var r=this.modelGroup.position,s=this.rotationGroup.quaternion;return[r.x,r.y,r.z,this.rotationGroup.position.z,s.x,s.y,s.z,s.w]}setView(r,s){return r!==void 0&&(r instanceof Array||r.length!==8)&&this.modelGroup&&this.rotationGroup?(this.modelGroup.position.x=r[0],this.modelGroup.position.y=r[1],this.modelGroup.position.z=r[2],this.rotationGroup.position.z=r[3],this.rotationGroup.quaternion.x=r[4],this.rotationGroup.quaternion.y=r[5],this.rotationGroup.quaternion.z=r[6],this.rotationGroup.quaternion.w=r[7],r[8]!==void 0&&(this.rotationGroup.position.x=r[8],this.rotationGroup.position.y=r[9]),this.show(s),this):this}render(r,s){this.renderer.setViewport(),this.updateClickables();var l,c,A=this.getView();for(this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState()),s||(s=this.renderer.supportedExtensions()),l=0;l<this.models.length;l++)this.models[l]&&this.models[l].globj(this.modelGroup,s);for(l=0;l<this.shapes.length;l++)this.shapes[l]&&(this.shapes[l].frame===void 0||this.viewer_frame<0||this.shapes[l].frame<0||this.shapes[l].frame==this.viewer_frame?this.shapes[l].globj(this.modelGroup,s):this.shapes[l].removegl(this.modelGroup));for(l=0;l<this.labels.length;l++)s.regen&&(this.labels[l].dispose(),this.modelGroup.remove(this.labels[l].sprite),this.labels[l].setContext(),this.modelGroup.add(this.labels[l].sprite)),this.labels[l]&&this.labels[l].frame!==void 0&&this.labels[l].frame>=0&&(this.modelGroup.remove(this.labels[l].sprite),(this.viewer_frame<0||this.labels[l].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[l].sprite));for(l in this.surfaces)if(this.surfaces.hasOwnProperty(l)){var g=this.surfaces[l];for(c=0;c<g.length;c++)if(g.hasOwnProperty(c)){var C=g[c].geo;if(!g[c].finished||s.regen){C.verticesNeedUpdate=!0,C.elementsNeedUpdate=!0,C.normalsNeedUpdate=!0,C.colorsNeedUpdate=!0,C.buffersNeedUpdate=!0,g[c].mat.needsUpdate=!0,g[c].done&&(g[c].finished=!0),g[c].lastGL&&this.modelGroup.remove(g[c].lastGL);var E=null;if(g[c].mat instanceof u.LineBasicMaterial?E=new u.Line(C,g[c].mat):("wireframe"in g.style&&g.style.wireframe&&C.setUpWireframe(),E=new u.Mesh(C,g[c].mat)),g[c].mat.transparent&&g[c].mat.opacity==0?E.visible=!1:E.visible=!0,g[c].symmetries.length>1||g[c].symmetries.length==1&&!g[c].symmetries[0].isIdentity()){var S,k=new u.Object3D;for(S=0;S<g[c].symmetries.length;S++){var D=E.clone();D.matrix=g[c].symmetries[S],D.matrixAutoUpdate=!1,k.add(D)}g[c].lastGL=k,this.modelGroup.add(k)}else g[c].lastGL=E,this.modelGroup.add(E)}}}return this.setView(A),typeof r=="function"&&r(this),this}getModelList(r){let s=[];if(r===void 0||r.model===void 0)for(let c=0;c<this.models.length;c++)this.models[c]&&s.push(this.models[c]);else{let c=r.model;Array.isArray(c)||(c=[c]);for(let A=0;A<c.length;A++)if(typeof c[A]=="number"){var l=c[A];l<0&&(l+=this.models.length),s.push(this.models[l])}else s.push(c[A])}return s}getAtomsFromSel(r){var s=[];r===void 0&&(r={});var l=this.getModelList(r);for(let c=0;c<l.length;c++)s=s.concat(l[c].selectedAtoms(r));return s}atomIsSelected(r,s){s===void 0&&(s={});for(var l=this.getModelList(s),c=0;c<l.length;c++)if(l[c].atomIsSelected(r,s))return!0;return!1}selectedAtoms(r){return this.getAtomsFromSel(r)}getUniqueValues(r,s){s===void 0&&(s={});var l=this.getAtomsFromSel(s),c={};for(var A in l)l[A].hasOwnProperty(r)&&(c[l[A][r]]=!0);return Object.keys(c)}pdbData(r){for(var s=this.getAtomsFromSel(r),l="",c=0,A=s.length;c<A;++c)l+=s[c].pdbline+`
`;return l}zoom(r=2,s=0,l=!1){var c=(this.CAMERA_Z-this.rotationGroup.position.z)/r,A=this.CAMERA_Z-c;return s>0?this.animateMotion(s,l,this.modelGroup.position,this.adjustZoomToLimits(A),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(A),this.show()),this}translate(r,s,l=0,c=!1){var A=r/this.WIDTH,g=s/this.HEIGHT,C=new p.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(C,this.camera),C.x-=A,C.y-=g,this.projector.unprojectVector(C,this.camera),C.z=0;var E=this.lookingAt.clone().add(C);return l>0?this.animateMotion(l,c,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,E):(this.lookingAt=E,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(r,s,l=0,c=!1){var A=this.screenOffsetToModel(r,s),g=this.modelGroup.position.clone().add(A);return l>0?this.animateMotion(l,c,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=g,this.show()),this}fitSlab(r){r=r||{};var s=this.getAtomsFromSel(r),l=(0,b.getExtent)(s),c=l[1][0]-l[0][0],A=l[1][1]-l[0][1],g=l[1][2]-l[0][2],C=Math.hypot(c,A,g);return C<5&&(C=5),this.slabNear=-C/1.9,this.slabFar=C/2,this}center(r={},s=0,l=!1){var c,A,g=this.getAtomsFromSel(r),C=(0,b.getExtent)(g);(0,b.isEmptyObject)(r)?(this.shapes.forEach(Y=>{if(Y&&Y.boundingSphere&&Y.boundingSphere.center){var J=Y.boundingSphere.center,te=Y.boundingSphere.radius;te>0?(g.push(new p.Vector3(J.x+te,J.y,J.z)),g.push(new p.Vector3(J.x-te,J.y,J.z)),g.push(new p.Vector3(J.x,J.y+te,J.z)),g.push(new p.Vector3(J.x,J.y-te,J.z)),g.push(new p.Vector3(J.x,J.y,J.z+te)),g.push(new p.Vector3(J.x,J.y,J.z-te))):g.push(J)}}),C=(0,b.getExtent)(g),c=g,A=C):(c=this.getAtomsFromSel({}),A=(0,b.getExtent)(c));var E=new p.Vector3(C[2][0],C[2][1],C[2][2]),S=A[1][0]-A[0][0],k=A[1][1]-A[0][1],D=A[1][2]-A[0][2],$=Math.hypot(S,k,D);$<5&&($=5),this.slabNear=-$/1.9,this.slabFar=$/2,S=C[1][0]-C[0][0],k=C[1][1]-C[0][1],D=C[1][2]-C[0][2],($=Math.hypot(S,k,D))<5&&($=5);for(var U=25,V=0;V<g.length;V++)if(g[V]){var W=E.distanceToSquared(g[V]);W>U&&(U=W)}$=2*Math.sqrt(U);var H=E.clone().multiplyScalar(-1);return s>0?this.animateMotion(s,l,H,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=H,this.show()),this}zoomTo(r={},s=0,l=!1){let c=this.getAtomsFromSel(r),A=(0,b.getExtent)(c),g=A;if((0,b.isEmptyObject)(r)){let J=c&&c.length;if(this.shapes.forEach(te=>{if(te&&te.boundingSphere){if(te.boundingSphere.box){let ye=te.boundingSphere.box;c.push(new p.Vector3(ye.min.x,ye.min.y,ye.min.z)),c.push(new p.Vector3(ye.max.x,ye.max.y,ye.max.z))}else if(te.boundingSphere.center){var de=te.boundingSphere.center,le=te.boundingSphere.radius;le>0?(c.push(new p.Vector3(de.x+le,de.y,de.z)),c.push(new p.Vector3(de.x-le,de.y,de.z)),c.push(new p.Vector3(de.x,de.y+le,de.z)),c.push(new p.Vector3(de.x,de.y-le,de.z)),c.push(new p.Vector3(de.x,de.y,de.z+le)),c.push(new p.Vector3(de.x,de.y,de.z-le))):c.push(de)}}}),g=(0,b.getExtent)(c),!J)for(let te=0;te<3;te++)A[2][te]=(g[0][te]+g[1][te])/2}else{let J=this.getAtomsFromSel({});g=(0,b.getExtent)(J)}var C=new p.Vector3(A[2][0],A[2][1],A[2][2]),E=g[1][0]-g[0][0],S=g[1][1]-g[0][1],k=g[1][2]-g[0][2],D=Math.hypot(E,S,k);D<5&&(D=5),this.slabNear=-D/1.9,this.slabFar=D/2,Object.keys(r).length===0&&(this.slabNear=Math.min(2*-D,-50),this.slabFar=Math.max(2*D,50));var $=this.config.minimumZoomToDistance||5;E=A[1][0]-A[0][0],S=A[1][1]-A[0][1],k=A[1][2]-A[0][2],(D=Math.hypot(E,S,k))<$&&(D=$);for(var U=$*$,V=0;V<c.length;V++)if(c[V]){var W=C.distanceToSquared(c[V]);W>U&&(U=W)}D=2*Math.sqrt(U);var H=C.clone().multiplyScalar(-1),Y=-(.5*D/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return Y=this.adjustZoomToLimits(Y),s>0?this.animateMotion(s,l,H,Y,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=H,this.rotationGroup.position.z=Y,this.show()),this}setSlab(r,s){this.slabNear=r,this.slabFar=s}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(r,s={},l,c=!1){if(l){var A=(0,b.getExtent)(this.getAtomsFromSel(l));s.position={x:A[2][0],y:A[2][1],z:A[2][2]}}var g=new Mt(r,s);return g.setContext(),this.modelGroup.add(g.sprite),this.labels.push(g),c||this.show(),g}addResLabels(r,s,l=!1){let c=this.labels.length;return this.applyToModels("addResLabels",r,s,l),this.show(),this.labels.slice(c)}addPropertyLabels(r,s,l){return this.applyToModels("addPropertyLabels",r,s,l),this.show(),this}removeLabel(r){for(var s=0;s<this.labels.length;s++)if(this.labels[s]==r){this.labels.splice(s,1),r.dispose(),this.modelGroup.remove(r.sprite);break}return this.show(),this}removeAllLabels(){for(var r=0;r<this.labels.length;r++)this.labels[r]&&this.labels[r].sprite&&this.modelGroup.remove(this.labels[r].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}hideAllLabels(){for(var r=0;r<this.labels.length;r++)this.labels[r]&&this.labels[r].hide();return this.show(),this}showAllLabels(){for(var r=0;r<this.labels.length;r++)this.labels[r]&&this.labels[r].show();return this.show(),this}setLabelStyle(r,s){return this.modelGroup.remove(r.sprite),r.dispose(),r.stylespec=s,r.setContext(),this.modelGroup.add(r.sprite),this.show(),r}setLabelText(r,s){return this.modelGroup.remove(r.sprite),r.dispose(),r.text=s,r.setContext(),this.modelGroup.add(r.sprite),this.show(),r}addShape(r){var s=new Oe(r=r||{});return s.shapePosition=this.shapes.length,this.shapes.push(s),s}removeShape(r){if(!r)return this;for(r.removegl(this.modelGroup),delete this.shapes[r.shapePosition];this.shapes.length>0&&this.shapes[this.shapes.length-1]===void 0;)this.shapes.pop();return this}removeAllShapes(){for(var r=0;r<this.shapes.length;r++){var s=this.shapes[r];s&&s.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(r){if(r.hasOwnProperty("x")&&r.hasOwnProperty("y")&&r.hasOwnProperty("z"))return r;var s=this.getAtomsFromSel(r);if(s.length==0)return{x:0,y:0,z:0};var l=(0,b.getExtent)(s);return{x:l[0][0]+(l[1][0]-l[0][0])/2,y:l[0][1]+(l[1][1]-l[0][1])/2,z:l[0][2]+(l[1][2]-l[0][2])/2}}addSphere(r){(r=r||{}).center=this.getSelectionCenter(r.center);var s=new Oe(r);return s.shapePosition=this.shapes.length,s.addSphere(r),this.shapes.push(s),s.finalize(),s}addBox(r={}){r.corner!=null&&(r.corner=this.getSelectionCenter(r.corner)),r.center!=null&&(r.center=this.getSelectionCenter(r.center));var s=new Oe(r);return s.shapePosition=this.shapes.length,s.addBox(r),this.shapes.push(s),s.finalize(),s}addArrow(r={}){r.start=this.getSelectionCenter(r.start),r.end=this.getSelectionCenter(r.end);var s=new Oe(r);return s.shapePosition=this.shapes.length,s.addArrow(r),this.shapes.push(s),s.finalize(),s}addCylinder(r={}){r.start=this.getSelectionCenter(r.start),r.end=this.getSelectionCenter(r.end);var s=new Oe(r);return s.shapePosition=this.shapes.length,r.dashed?s.addDashedCylinder(r):s.addCylinder(r),this.shapes.push(s),s.finalize(),s}addCurve(r={}){var s=new Oe(r);return s.shapePosition=this.shapes.length,s.addCurve(r),this.shapes.push(s),s.finalize(),s}addLine(r={}){r.start=this.getSelectionCenter(r.start),r.end=this.getSelectionCenter(r.end),r.wireframe=!0;var s=new Oe(r);return s.shapePosition=this.shapes.length,r.dashed?s=this.addLineDashed(r,s):s.addLine(r),this.shapes.push(s),s.finalize(),s}addUnitCell(r,s){r=this.getModel(r),(s=s||{alabel:"a",blabel:"b",clabel:"c"}).box=s.box||{},s.astyle=s.astyle||{color:"red",radius:.1,midpos:-1},s.bstyle=s.bstyle||{color:"green",radius:.1,midpos:-1},s.cstyle=s.cstyle||{color:"blue",radius:.1,midpos:-1},s.alabelstyle=s.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},s.blabelstyle=s.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},s.clabelstyle=s.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},r.unitCellObjects&&this.removeUnitCell(r),r.unitCellObjects={shapes:[],labels:[]};var l=r.getCrystData(),c=null;if(l){if(l.matrix)c=l.matrix;else{var A,g,C,E=l.a,S=l.b,k=l.c,D=l.alpha,$=l.beta,U=l.gamma;D=D*Math.PI/180,$=$*Math.PI/180,U=U*Math.PI/180,A=Math.cos($),g=(Math.cos(D)-Math.cos($)*Math.cos(U))/Math.sin(U),C=Math.sqrt(Math.max(0,1-A*A-g*g)),c=new p.Matrix3(E,S*Math.cos(U),k*A,0,S*Math.sin(U),k*g,0,0,k*C)}var V=[new p.Vector3(0,0,0),new p.Vector3(1,0,0),new p.Vector3(0,1,0),new p.Vector3(0,0,1),new p.Vector3(1,1,0),new p.Vector3(0,1,1),new p.Vector3(1,0,1),new p.Vector3(1,1,1)];if(l.matrix4)for(let H=0;H<V.length;H++)l.size&&V[H].multiplyVectors(V[H],l.size),V[H]=V[H].applyMatrix4(l.matrix4);else for(let H=0;H<V.length;H++)V[H]=V[H].applyMatrix3(c);if(s.box&&!s.box.hidden){s.box.wireframe=!0;var W=new Oe(s.box);W.shapePosition=this.shapes.length,W.addLine({start:V[0],end:V[1]}),W.addLine({start:V[0],end:V[2]}),W.addLine({start:V[1],end:V[4]}),W.addLine({start:V[2],end:V[4]}),W.addLine({start:V[0],end:V[3]}),W.addLine({start:V[3],end:V[5]}),W.addLine({start:V[2],end:V[5]}),W.addLine({start:V[1],end:V[6]}),W.addLine({start:V[4],end:V[7]}),W.addLine({start:V[6],end:V[7]}),W.addLine({start:V[3],end:V[6]}),W.addLine({start:V[5],end:V[7]}),this.shapes.push(W),r.unitCellObjects.shapes.push(W),W.finalize()}if(!s.astyle.hidden){s.astyle.start=V[0],s.astyle.end=V[1];let H=this.addArrow(s.astyle);r.unitCellObjects.shapes.push(H)}if(!s.bstyle.hidden){s.bstyle.start=V[0],s.bstyle.end=V[2];let H=this.addArrow(s.bstyle);r.unitCellObjects.shapes.push(H)}if(!s.cstyle.hidden){s.cstyle.start=V[0],s.cstyle.end=V[3];let H=this.addArrow(s.cstyle);r.unitCellObjects.shapes.push(H)}if(s.alabel){s.alabelstyle.position=V[1];let H=this.addLabel(s.alabel,s.alabelstyle);r.unitCellObjects.labels.push(H)}if(s.blabel){s.blabelstyle.position=V[2];let H=this.addLabel(s.blabel,s.blabelstyle);r.unitCellObjects.labels.push(H)}if(s.clabel){s.clabelstyle.position=V[3];let H=this.addLabel(s.clabel,s.clabelstyle);r.unitCellObjects.labels.push(H)}}}removeUnitCell(r){if((r=this.getModel(r)).unitCellObjects){let s=this;r.unitCellObjects.shapes.forEach(function(l){s.removeShape(l)}),r.unitCellObjects.labels.forEach(function(l){s.removeLabel(l)})}delete r.unitCellObjects}replicateUnitCell(r=3,s=r,l=s,c,A,g){let C=(c=this.getModel(c)).getCrystData();if(C){const E=c.selectedAtoms({}),S=C.matrix;let k=function($){return $%2==0?-$/2:Math.ceil($/2)};r<=1&&s<=1&&l<=1&&(g=!0,r=s=l=3);let D=function($,U,V){return!1};if(g){const $=new p.Matrix3().getInverse3(S);D=function(U,V,W){let H=new p.Vector3(U,V,W).applyMatrix3($);return!(H.x>-1e-4&&H.x<1.0001&&H.y>-1e-4&&H.y<1.0001&&H.z>-1e-4&&H.z<1.0001)}}for(let $=0;$<r;$++)for(let U=0;U<s;U++)for(let V=0;V<l;V++){if($==0&&U==0&&V==0)continue;let W=new p.Vector3(k($),k(U),k(V));W.applyMatrix3(S);let H=[];for(let Y=0;Y<E.length;Y++){let J=E[Y].x+W.x,te=E[Y].y+W.y,de=E[Y].z+W.z;if(D(J,te,de))continue;let le={};for(let ye in E[Y])le[ye]=E[Y][ye];le.x=J,le.y=te,le.z=de,H.push(le)}c.addAtoms(H)}A&&c.assignBonds()}}addLineDashed(r,s){var l,c;r.dashLength=r.dashLength||.5,r.gapLength=r.gapLength||.5,l=r.start?new p.Vector3(r.start.x||0,r.start.y||0,r.start.z||0):new p.Vector3(0,0,0),c=r.end?new p.Vector3(r.end.x,r.end.y||0,r.end.z||0):new p.Vector3(0,0,0);var A,g,C,E=new p.Vector3,S=new p.Vector3,k=new p.Vector3,D=l.clone(),$=0;for(E.subVectors(c,l),A=E.length(),E.normalize(),S=E.clone(),k=E.clone(),S.multiplyScalar(r.dashLength),k.multiplyScalar(r.gapLength),g=S.length(),C=k.length();$<A;){if($+g>A){r.start=l,r.end=c,s.addLine(r);break}D.addVectors(l,S),r.start=l,r.end=D,s.addLine(r),l=D.clone(),$+=g,D.addVectors(l,k),l=D.clone(),$+=C}return s.finalize(),s}addCustom(r){var s=new Oe(r=r||{});return s.shapePosition=this.shapes.length,s.addCustom(r),this.shapes.push(s),s.finalize(),s}addVolumetricData(r,s,l={}){var c=new Ve.VolumeData(r,s);return l.hasOwnProperty("transferfn")?this.addVolumetricRender(c,l):this.addIsosurface(c,l)}addIsosurface(r,s={},l){var c=new Oe(s);return c.shapePosition=this.shapes.length,c.addIsosurface(r,s,l,this),this.shapes.push(c),c}addVolumetricRender(r,s){var l=new Pt(r,s=s||{},this);return l.shapePosition=this.shapes.length,this.shapes.push(l),l}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(r){if(r){this.scene.fog=new u.Fog(this.bgColor,100,200),this.config.disableFog=!1;const s=r;s.fogStart==null?this.fogStart=.4:this.fogStart=s.fogStart,s.fogEnd==null?this.fogEnd=1:this.fogEnd=s.fogEnd}else this.config.disableFog=!0,this.show()}setFrame(r){this.viewer_frame=r;let s=this;return new Promise(function(l){var c=s.models.map(function(A){return A.setFrame(r)});Promise.all(c).then(function(){l()})})}getFrame(){return this.viewer_frame}getNumFrames(){var r=0;for(let s=0;s<this.models.length;s++)this.models[s].getNumFrames()>r&&(r=this.models[s].getNumFrames());for(let s=0;s<this.shapes.length;s++)this.shapes[s].frame&&this.shapes[s].frame>=r&&(r=this.shapes[s].frame+1);for(let s=0;s<this.labels.length;s++)this.labels[s].frame&&this.labels[s].frame>=r&&(r=this.labels[s].frame+1);return r}getNextModelId(){return this.models.length}animate(r){this.incAnim();var s=100,l="forward",c=1/0;(r=r||{}).interval&&(s=r.interval),r.loop&&(l=r.loop),r.reps&&(c=r.reps);var A=this.getNumFrames(),g=this,C=0;r.startFrame&&(C=r.startFrame%A);var E=1;r.step&&(c/=E=r.step);var S,k,D=0,$=A*c,U=new Date,V=function(W){U=new Date,W=="forward"?g.setFrame(C).then(function(){C=(C+E)%A,S()}):W=="backward"?g.setFrame(A-1-C).then(function(){C=(C+E)%A,S()}):g.setFrame(C).then(function(){E*=(C+=E)%(A-1)==0?-1:1,S()})};return S=function(){if(g.render(),g.getCanvas().isConnected)if(++D>=$||!g.isAnimated())k.cancel(),g.animationTimers.delete(k),g.decAnim();else{var W=s-(new Date().getTime()-U.getTime());W=W>0?W:0,k.cancel(),g.animationTimers.delete(k),k=new b.PausableTimer(V,W,l),g.animationTimers.add(k)}else g.stopAnimate()},k=new b.PausableTimer(V,0,l),this.animationTimers.add(k),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(r){r.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(r){r.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(r){r.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(r){return r&&!r.defaultcolors?(r.defaultcolors=this.defaultcolors,r.cartoonQuality=r.cartoonQuality||this.config.cartoonQuality):r===void 0&&(r={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),r}addModel(r,s="",l){l=this.getModelOpt(l);var c=new ur(this.models.length,l,this);return c.addMolData(r,s,l),this.models.push(c),c}addModels(r,s,l){(l=this.getModelOpt(l)).multimodel=!0,l.frames=!0;for(var c=ur.parseMolData(r,s,l),A=0;A<c.length;A++){var g=new ur(this.models.length,l,this);g.setAtomDefaults(c[A]),g.addFrame(c[A]),g.setFrame(0),c.modelData&&g.setModelData(c.modelData[A]),g.setDontDuplicateAtoms(!l.duplicateAssemblyAtoms),this.models.push(g)}return this.models}addModelsAsFrames(r,s,l){(l=this.getModelOpt(l)).multimodel=!0,l.frames=!0;var c=new ur(this.models.length,l,this);return c.addMolData(r,s,l),this.models.push(c),c}addAsOneMolecule(r,s,l){(l=this.getModelOpt(l)).multimodel=!0,l.onemol=!0;var c=new ur(this.models.length,l,this);return c.addMolData(r,s,l),this.models.push(c),c}removeModel(r){if(r=this.getModel(r)){for(r.removegl(this.modelGroup),delete this.models[r.getID()];this.models.length>0&&this.models[this.models.length-1]===void 0;)this.models.pop();return this}}removeAllModels(){for(var r=0;r<this.models.length;r++){var s=this.models[r];s&&s.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(r,s){var l={};return l.m=s===void 0?this.models.map(function(c){return c.toCDObject(r)}):[this.models[s].toCDObject()],JSON.stringify(l)}exportVRML(){var r=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new u.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var s=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=r,s}createModelFrom(r,s=!1){for(var l=new ur(this.models.length,this.defaultcolors,this),c=0;c<this.models.length;c++)if(this.models[c]){var A=this.models[c].selectedAtoms(r);l.addAtoms(A),s&&this.models[c].removeAtoms(A)}return this.models.push(l),l}applyToModels(r,s,l,c,A,g,C){for(var E=this.getModelList(s),S=0;S<E.length;S++)E[S][r](s,l,c,A,g,C)}setStyle(r,s){return s===void 0&&(s=r,r={}),this.applyToModels("setStyle",r,s,!1),this}addStyle(r,s){return s===void 0&&(s=r,r={}),this.applyToModels("setStyle",r,s,!0),this}setClickable(r,s,l){return this.applyToModels("setClickable",r,s,l),this}setHoverable(r,s,l,c){return this.applyToModels("setHoverable",r,s,l,c),this}enableContextMenu(r,s){return this.applyToModels("enableContextMenu",r,s),this}vibrate(r,s,l,c){return this.applyToModels("vibrate",r,s,l,c),this}setColorByProperty(r,s,l,c){return this.applyToModels("setColorByProperty",r,s,l,c),this}setColorByElement(r,s){return this.applyToModels("setColorByElement",r,s),this}static getAtomsWithin(r,s){var l=[];for(let A=0;A<r.length;A++){var c=r[A];c!==void 0&&(c.x<s[0][0]||c.x>s[1][0]||c.y<s[0][1]||c.y>s[1][1]||c.z<s[0][2]||c.z>s[1][2]||l.push(c))}return l}static volume(r){return(r[1][0]-r[0][0])*(r[1][1]-r[0][1])*(r[1][2]-r[0][2])}carveUpExtent(r,s,l){let c=[],A={};for(let k=0,D=s.length;k<D;k++)A[s[k].index]=k;let g=function(k){let D=[];for(let $=0,U=k.length;$<U;$++)k[$].index in A&&D.push(A[k[$].index]);return D},C=function(k){let D=[];return D[0]=[k[0][0],k[0][1],k[0][2]],D[1]=[k[1][0],k[1][1],k[1][2]],D},E=function(k){if(Yt.volume(k)<Yt.maxVolume)return[k];var D,$=k[1][0]-k[0][0],U=k[1][1]-k[0][1],V=k[1][2]-k[0][2];D=$>U&&$>V?0:U>$&&U>V?1:2;var W=C(k),H=C(k),Y=(k[1][D]-k[0][D])/2+k[0][D];W[1][D]=Y,H[0][D]=Y;var J=E(W),te=E(H);return J.concat(te)},S=E(r);for(let k=0,D=S.length;k<D;k++){let $=C(S[k]);$[0][0]-=6,$[0][1]-=6,$[0][2]-=6,$[1][0]+=6,$[1][1]+=6,$[1][2]+=6;let U=Yt.getAtomsWithin(s,$),V=Yt.getAtomsWithin(l,S[k]);c.push({extent:S[k],atoms:g(U),toshow:g(V)})}return c}static generateSurfaceMesh(r,s,l){var c=new u.Geometry(!0),A=c.updateGeoGroup(0),g=[];for(let ke=0,be=r.length;ke<be;ke++){var C=r[ke];C&&(C.surfaceColor!==void 0?g[ke]=C.surfaceColor:C.color&&(g[ke]=w.CC.color(C.color)))}var E=A.vertexArray,S=s.vertices;for(let ke=0,be=S.length;ke<be;ke++){let Ge=3*A.vertices;E[Ge]=S[ke].x,E[Ge+1]=S[ke].y,E[Ge+2]=S[ke].z,A.vertices++}var k=A.colorArray;let D=A.atomArray;if(l.voldata&&l.volscheme){var $=l.volscheme,U=l.voldata,V=$.range()||[-1,1];for(let ke=0,be=S.length;ke<be;ke++){let Ge=S[ke].atomid,Je=U.getVal(S[ke].x,S[ke].y,S[ke].z),tt=w.CC.color($.valueToHex(Je,V)),Ye=3*ke;k[Ye]=tt.r,k[Ye+1]=tt.g,k[Ye+2]=tt.b,D[ke]=r[Ge]}}else if(g.length>0)for(let ke=0,be=S.length;ke<be;ke++){let Ge=S[ke].atomid,Je=3*ke;k[Je]=g[Ge].r,k[Je+1]=g[Ge].g,k[Je+2]=g[Ge].b,D[ke]=r[Ge]}var W=s.faces;A.faceidx=W.length,c.initTypedArrays();var H,Y,J,te,de=A.vertexArray,le=A.normalArray;for(let ke=0,be=W.length;ke<be;ke+=3){var ye=3*W[ke],Pe=3*W[ke+1],Te=3*W[ke+2];H=new p.Vector3(de[ye],de[ye+1],de[ye+2]),Y=new p.Vector3(de[Pe],de[Pe+1],de[Pe+2]),(J=new p.Vector3(de[Te],de[Te+1],de[Te+2])).subVectors(J,Y),H.subVectors(H,Y),J.cross(H),(te=J).normalize(),le[ye]+=te.x,le[Pe]+=te.x,le[Te]+=te.x,le[ye+1]+=te.y,le[Pe+1]+=te.y,le[Te+1]+=te.y,le[ye+2]+=te.z,le[Pe+2]+=te.z,le[Te+2]+=te.z}return A.faceArray=new Uint16Array(W),new u.Mesh(c,l)}static generateMeshSyncHelper(r,s,l,c,A,g){var C=new xe;return C.initparm(s,r!==1,g),C.fillvoxels(A,l),C.buildboundary(),r!=Gr.SES&&r!=Gr.MS||(C.fastdistancemap(),C.boundingatom(!1),C.fillvoxelswaals(A,l)),C.marchingcube(r),C.getFacesAndVertices(c)}static getMatWithStyle(r){let s=null;for(var l in s=r.onesided?new u.MeshLambertMaterial:new u.MeshDoubleLambertMaterial,s.vertexColors=u.Coloring.VertexColors,r)l==="color"||l==="map"||r.hasOwnProperty(l)&&(s[l]=r[l]);return r.opacity!==void 0&&(r.opacity===1?s.transparent=!1:s.transparent=!0),r.wireframe!==void 0&&(s.wireframe=r.wireframe),s}addMesh(r){let s={geo:r.geometry,mat:r.material,done:!0,finished:!1};var l=this.nextSurfID();return this.surfaces[l]=new gr([s]),l}static shallowCopy(r){var s=[];let l=r.length;for(let c=0;c<l;c++)s[c]=(0,b.extend)({},r[c]);return s}addSurface(r,s={},l={},c,A,g){let C=this.nextSurfID(),E=null,S=this,k=Gr.VDW;typeof r=="string"?Yt.surfaceTypeMap[r.toUpperCase()]!==void 0?k=Yt.surfaceTypeMap[r]:console.log("Surface type : "+r+" is not recognized"):typeof r=="number"&&(k=r);var D=null,$=null,U=Yt.shallowCopy(this.getAtomsFromSel(l));D=c?Yt.shallowCopy(this.getAtomsFromSel(c)):U,(0,b.adjustVolumeStyle)(s);var V,W=!1;for(V=0;V<this.models.length;V++)if(this.models[V]){var H=this.models[V].getSymmetries();if(H.length>1||H.length==1&&!H[0].isIdentity()){W=!0;break}}var Y=function(Pe,Te,ke){var be;$=A?Yt.shallowCopy(S.getAtomsFromSel(A)):ke;var Ge=(0,b.getExtent)(ke,!0);if(s.map&&s.map.prop){var Je=s.map.prop;let ot=(0,M.getGradient)(s.map.scheme||s.map.gradient||new M.Gradient.RWB),bt=ot.range();bt||(bt=(0,b.getPropertyRange)(ke,Je)),s.colorscheme={prop:Je,gradient:ot}}for(let ot=0,bt=Te.length;ot<bt;ot++)(be=Te[ot]).surfaceColor=(0,b.getColorFromStyle)(be,s);var tt=Yt.volume(Ge),Ye=S.carveUpExtent(Ge,Te,ke);if($&&$.length&&$.length>0){var ut=(0,b.getExtent)($,!0);Ye.sort(function(ot,bt){var At=function(it,Rt){var Ht=it.extent,kt=Ht[1][0]-Ht[0][0],ct=Ht[1][1]-Ht[0][1],Jt=Ht[1][2]-Ht[0][2],Nt=kt-Rt[2][0];Nt*=Nt;var Zt=ct-Rt[2][1];Zt*=Zt;var Vt=Jt-Rt[2][2];return Nt+Zt+(Vt*=Vt)};return At(ot,ut)-At(bt,ut)})}var ft=[];for(let ot=0,bt=Te.length;ot<bt;ot++)be=Te[ot],ft[ot]={x:be.x,y:be.y,z:be.z,serial:ot,elem:be.elem};var Qe=!!Kr;if(typeof $3Dmol<"u"&&$3Dmol.SurfaceWorker!==void 0||(console.log("$3Dmol.SurfaceWorker is not defined, using synchronous surface generation."),Qe=!0),Qe){var pt=function(ot){return new Promise(function(bt){for(var At=Yt.generateMeshSyncHelper(k,Ye[ot].extent,Ye[ot].atoms,Ye[ot].toshow,ft,tt),it=yt({vertexArr:At.vertices,faceArr:At.faces}),Rt=0,Ht=it.length;Rt<Ht;Rt++){At={vertices:it[Rt].vertexArr,faces:it[Rt].faceArr};var kt=Yt.generateSurfaceMesh(Te,At,E);(0,b.mergeGeos)(Pe.geo,kt)}S.render(),bt()})},Be=[];for(let ot=0;ot<Ye.length;ot++)Be.push(pt(ot));return Promise.all(Be).then(function(){return Pe.done=!0,S.render(),Promise.resolve(C)})}var et=[];k<0&&(k=0);for(let ot=0,bt=Yt.numWorkers;ot<bt;ot++){var St=new Worker($3Dmol.SurfaceWorker);et.push(St),St.postMessage({type:-1,atoms:ft,volume:tt})}return new Promise(function(ot,bt){var At=0,it=function(){et&&et.length&&et.forEach(function(ct){ct&&ct.terminate&&ct.terminate()})},Rt=function(ct){for(var Jt=yt({vertexArr:ct.data.vertices,faceArr:ct.data.faces}),Nt=0,Zt=Jt.length;Nt<Zt;Nt++){var Vt={vertices:Jt[Nt].vertexArr,faces:Jt[Nt].faceArr},Xt=Yt.generateSurfaceMesh(Te,Vt,E);(0,b.mergeGeos)(Pe.geo,Xt)}S.render(),++At==Ye.length&&(Pe.done=!0,it(),ot(C))},Ht=function(ct){it(),console.log(ct.message+" ("+ct.filename+":"+ct.lineno+")"),bt(ct)};for(let ct=0;ct<Ye.length;ct++){var kt=et[ct%et.length];kt.onmessage=Rt,kt.onerror=Ht,kt.postMessage({type:k,expandedExtent:Ye[ct].extent,extendedAtoms:Ye[ct].atoms,atomsToShow:Ye[ct].toshow})}})};s=s||{},E=Yt.getMatWithStyle(s);let J=new gr([]);J.style=s,J.atomsel=l,J.allsel=c,J.focus=A;var te=null;if(W){var de={},le={};for(V=0;V<this.models.length;V++)de[V]=[],le[V]=[];for(V=0;V<D.length;V++)de[D[V].model].push(D[V]);for(V=0;V<U.length;V++)le[U[V].model].push(U[V]);var ye=[];for(V=0;V<this.models.length;V++)le[V].length>0&&(J.push({geo:new u.Geometry(!0),mat:E,done:!1,finished:!1,symmetries:this.models[V].getSymmetries()}),ye.push(Y(J[J.length-1],de[V],le[V])));te=Promise.all(ye)}else J.push({geo:new u.Geometry(!0),mat:E,done:!1,finished:!1,symmetries:[new p.Matrix4]}),te=Y(J[J.length-1],D,U);return this.surfaces[C]=J,te.surfid=C,g&&typeof g=="function"?(te.then(function(Pe){g(Pe)}),C):te}setSurfaceMaterialStyle(r,s){if((0,b.adjustVolumeStyle)(s),this.surfaces[r]){var l=this.surfaces[r];for(let A=0;A<l.length;A++){var c=l[A].mat=Yt.getMatWithStyle(s);if(l[A].mat.side=u.FrontSide,s.wireframe&&l[A].geo.setUpWireframe(),s.color){l[A].mat.color=w.CC.color(s.color),l[A].geo.colorsNeedUpdate=!0;const g=w.CC.color(s.color);l[A].geo.setColor(g)}else if(c.voldata&&c.volscheme){const g=c.volscheme,C=c.voldata,E=w.CC,S=g.range()||[-1,1];l[A].geo.setColors(function(k,D,$){let U=C.getVal(k,D,$);return E.color(g.valueToHex(U,S))})}else{l[A].geo.colorsNeedUpdate=!0;for(let g of l[A].geo.geometryGroups)for(let C=0;C<g.vertices;C++){let E=(0,b.getColorFromStyle)(g.atomArray[C],s),S=3*C;g.colorArray[S]=E.r,g.colorArray[S+1]=E.g,g.colorArray[S+2]=E.b}}l[A].finished=!1}}return this}getSurface(r){return this.surfaces[r]}removeSurface(r){for(var s=this.surfaces[r],l=0;l<s.length;l++)s[l]&&s[l].lastGL&&(s[l].geo!==void 0&&s[l].geo.dispose(),s[l].mat!==void 0&&s[l].mat.dispose(),this.modelGroup.remove(s[l].lastGL));return delete this.surfaces[r],this.show(),this}removeAllSurfaces(){for(var r in this.surfaces)if(this.surfaces.hasOwnProperty(r)){for(var s=this.surfaces[r],l=0;l<s.length;l++)s[l]&&s[l].lastGL&&(s[l].geo!==void 0&&s[l].geo.dispose(),s[l].mat!==void 0&&s[l].mat.dispose(),this.modelGroup.remove(s[l].lastGL));delete this.surfaces[r]}return this.show(),this}jmolMoveTo(){var r=this.modelGroup.position,s="center { "+-r.x+" "+-r.y+" "+-r.z+" }; ",l=this.rotationGroup.quaternion;return s+="moveto .5 quaternion { "+l.x+" "+l.y+" "+l.z+" "+l.w+" };"}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(r,s){s=s||{};var l=this.getAtomsFromSel(s);if(typeof r=="function")for(let g=0,C=l.length;g<C;g++)r(l[g]);else for(let g=0,C=l.length;g<C;g++){var c=l[g];for(let E=0,S=r.length;E<S;E++){let k=r[E];if(k.props)for(var A in k.props)k.props.hasOwnProperty(A)&&this.atomIsSelected(c,k)&&(c.properties||(c.properties={}),c.properties[A]=k.props[A])}}return this}linkViewer(r){return this.linkedViewers.push(r),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(r){this.rotationGroup.position.z=this.CAMERA_Z-r}setAutoEyeSeparation(r,s){var l=this.getPerceivedDistance();return s||(s=5),r||this.camera.position.x>0?this.camera.position.x=l*Math.tan(Math.PI/180*s):this.camera.position.x=-l*Math.tan(Math.PI/180*s),this.camera.lookAt(new p.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(r){this.config.cartoonQuality=r}}function Cr(ae,r){if(ae=(0,b.getElement)(ae)){r=r||{};try{return new Yt(ae,r)}catch(s){throw"error creating viewer: "+s}}}function Er(ae,r={},s={}){if(ae=(0,b.getElement)(ae)){var l=[],c=document.createElement("canvas");s.rows=r.rows,s.cols=r.cols,s.control_all=r.control_all!=null&&r.control_all,ae.appendChild(c);try{for(var A=0;A<r.rows;A++){for(var g=[],C=0;C<r.cols;C++){s.row=A,s.col=C,s.canvas=c,s.viewers=l,s.control_all=r.control_all;var E=Cr(ae,(0,b.extend)({},s));g.push(E)}l.unshift(g)}}catch(S){throw"error creating viewer grid: "+S}return l}}function Ur(ae){var r=this;if(ae=(0,b.getElement)(ae)){var s=Er(ae,{rows:1,cols:2,control_all:!0});this.glviewer1=s[0][0],this.glviewer2=s[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var l=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(A){return typeof r.glviewer1[A]=="function"}),c=0;c<l.length;c++)this[l[c]]=(function(A){return function(){return[this.glviewer1[A].apply(this.glviewer1,arguments),this.glviewer2[A].apply(this.glviewer2,arguments)]}})(l[c]);this.setCoordinates=function(A,g,C){for(var E=0;E<A.length;E++)A[E].setCoordinates(g,C)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(A){this.glviewer1.render(),this.glviewer2.render(),A&&A(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}Yt.numWorkers=4,Yt.maxVolume=64e3,Yt.surfaceTypeMap={VDW:Gr.VDW,MS:Gr.MS,SAS:Gr.SAS,SES:Gr.SES};var _r=!1,Or=!1,br={};function Mi(ae,r){var s,l,c;if(document.querySelector(".viewer_3Dmoljs")!=null&&(_r=!0),_r){Or=!0,ae=ae??null;var A=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(g=>{var C=[],E=[],S="";g.style.position=="static"&&(g.style.position="relative");var k=null;if(c=null,g.dataset.pdb)C.push("https://files.rcsb.org/view/"+g.dataset.pdb+".pdb"),E.push("pdb");else if(g.dataset.cid)E.push("sdf"),C.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+g.dataset.cid+"/SDF?record_type=3d");else if(g.dataset.href||g.dataset.url){if(S=g.dataset.href?g.dataset.href:g.dataset.url,C.push(S),(c=S.substring(S.lastIndexOf(".")+1))=="gz"){let ot=S.substring(0,S.lastIndexOf(".")).lastIndexOf(".");c=S.substring(ot+1)}E.push(c);var D=S.substring(S.lastIndexOf("/")+1,S.lastIndexOf("."));D=="/"&&(D=S.substring(S.lastIndexOf("/")+1)),g.dataset[E[E.length-1]]=D}let $=g.dataset;for(s in $)s.substring(0,3)==="pdb"&&s!=="pdb"?(C.push("https://files.rcsb.org/view/"+$[s]+".pdb"),E.push("pdb")):s.substring(0,4)==="href"&&s!=="href"?(S=$[s],C.push(S),E.push(S.substring(S.lastIndexOf(".")+1))):s.substring(0,3)==="cid"&&s!=="cid"&&(C.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+$[s]+"/SDF?record_type=3d"),E.push("sdf"));var U={};g.dataset.options&&(U=(0,b.specStringToObject)(g.dataset.options));var V=w.CC.color(g.dataset.backgroundcolor),W=g.dataset.backgroundalpha;W=W==null?1:parseFloat(W);var H={line:{}};g.dataset.style&&(H=(0,b.specStringToObject)(g.dataset.style));var Y={};g.dataset.select&&(Y=(0,b.specStringToObject)(g.dataset.select));var J=[],te=[],de=[],le={},ye=null,Pe=g.dataset,Te=/style(.+)/,ke=/surface(.*)/,be=/labelres(.*)/,Ge=[];for(l in Pe)Object.prototype.hasOwnProperty.call(Pe,l)&&Ge.push(l);for(Ge.sort(),s=0;s<Ge.length;s++){l=Ge[s];var Je,tt,Ye,ut=Te.exec(l);ut&&(Je="select"+ut[1],tt=(0,b.specStringToObject)(Pe[Je]),Ye=(0,b.specStringToObject)(Pe[l]),J.push([tt,Ye])),(ut=ke.exec(l))&&(Je="select"+ut[1],tt=(0,b.specStringToObject)(Pe[Je]),Ye=(0,b.specStringToObject)(Pe[l]),te.push([tt,Ye])),(ut=be.exec(l))&&(Je="select"+ut[1],tt=(0,b.specStringToObject)(Pe[Je]),Ye=(0,b.specStringToObject)(Pe[l]),de.push([tt,Ye])),l=="zoomto"&&(le=(0,b.specStringToObject)(Pe[l])),l=="spin"&&(ye=(0,b.specStringToObject)(Pe[l]))}var ft=function(ot){for(ot.setStyle(Y,H),k&&k.createSelectionAndStyle(Y,H),s=0;s<J.length;s++){let bt=J[s][0]||{},At=J[s][1]||{line:{}};ot.setStyle(bt,At),k&&k.createSelectionAndStyle(Y,H)}for(s=0;s<te.length;s++){let bt=te[s][0]||{},At=te[s][1]||{};k?ot.addSurface(Gr.VDW,At,bt,bt).then(it=>{k.loadSurface("VDW",bt,At,it)}):ot.addSurface(Gr.VDW,At,bt,bt)}for(s=0;s<de.length;s++){let bt=de[s][0]||{},At=de[s][1]||{};ot.addResLabels(bt,At)}ot.render(),ot.zoomTo(le),ye&&ot.spin(ye.axis,ye.speed)};let Qe=ae;try{var pt=(0,b.specStringToObject)(g.dataset.config)||{};pt.backgroundColor===void 0&&(pt.backgroundColor=V),pt.backgroundAlpha===void 0&&(pt.backgroundAlpha=W),Qe==null?Qe=br[g.id||A++]=Cr(g,pt):(Qe.setBackgroundColor(V,W),Qe.setConfig(pt),k&&k.initiateUI()),g.dataset.ui&&$3Dmol.StateManager&&(k=new $3Dmol.StateManager(Qe))}catch(ot){console.log(ot),g.textContent="WebGL appears to be disabled."}if(C.length!=0){let ot=0,bt=((At,it)=>function(Rt){S=C[ot];var Ht=At.dataset.type||At.dataset.datatype||E[ot];if(it.addModel(Rt,Ht,U),k){var kt=At.dataset[E[ot]];k.setModelTitle(kt)}ot+=1,ot<C.length?(0,b.get)(C[ot]).then(bt):(ft(it),At.dataset.callback&&(0,b.makeFunction)(At.dataset.callback)(it),Or=!1,r&&r(it))})(g,Qe);c&&c.endsWith("gz")?(0,b.getbin)(C[0]).then(bt):(0,b.get)(C[0]).then(bt)}else{if(g.dataset.element){var Be="#"+g.dataset.element,et=document.querySelector(Be),St=et?et.textContent:"";c=g.dataset.type||g.dataset.datatype,Qe.addModel(St,c,U)}ft(Qe),g.dataset.callback&&(0,b.makeFunction)(g.dataset.callback)(Qe),Or=!1,r&&r(Qe)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&Mi()};const Qt={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function ri(ae,r){if((!r||ae.partialCharge===void 0)&&ae.resn&&ae.atom){var s=ae.resn+":"+ae.atom;ae.properties.partialCharge=Qt[s]}}window&&(window.$3Dmol=n)},40:(i,n,a)=>{a.r(n),a.d(n,{bondLength:()=>m,bondTable:()=>h,setBondLength:()=>z});let h={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function m(u){return h[u]||1.6}function z(u,y){y<0&&(y=0),h[u]=y}},71:(i,n,a)=>{var h=a(107),m=a(981),z=a(972),u=a(834),y=a(746),p=Object.prototype.toString;function w(b){if(!(this instanceof w))return new w(b);this.options=m.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},b||{});var I=this.options;I.raw&&I.windowBits>0?I.windowBits=-I.windowBits:I.gzip&&I.windowBits>0&&I.windowBits<16&&(I.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var O=h.deflateInit2(this.strm,I.level,I.method,I.windowBits,I.memLevel,I.strategy);if(O!==0)throw new Error(u[O]);if(I.header&&h.deflateSetHeader(this.strm,I.header),I.dictionary){var T;if(T=typeof I.dictionary=="string"?z.string2buf(I.dictionary):p.call(I.dictionary)==="[object ArrayBuffer]"?new Uint8Array(I.dictionary):I.dictionary,(O=h.deflateSetDictionary(this.strm,T))!==0)throw new Error(u[O]);this._dict_set=!0}}function M(b,I){var O=new w(I);if(O.push(b,!0),O.err)throw O.msg||u[O.err];return O.result}w.prototype.push=function(b,I){var O,T,L=this.strm,Q=this.options.chunkSize;if(this.ended)return!1;T=I===~~I?I:I===!0?4:0,typeof b=="string"?L.input=z.string2buf(b):p.call(b)==="[object ArrayBuffer]"?L.input=new Uint8Array(b):L.input=b,L.next_in=0,L.avail_in=L.input.length;do{if(L.avail_out===0&&(L.output=new m.Buf8(Q),L.next_out=0,L.avail_out=Q),(O=h.deflate(L,T))!==1&&O!==0)return this.onEnd(O),this.ended=!0,!1;L.avail_out!==0&&(L.avail_in!==0||T!==4&&T!==2)||(this.options.to==="string"?this.onData(z.buf2binstring(m.shrinkBuf(L.output,L.next_out))):this.onData(m.shrinkBuf(L.output,L.next_out)))}while((L.avail_in>0||L.avail_out===0)&&O!==1);return T===4?(O=h.deflateEnd(this.strm),this.onEnd(O),this.ended=!0,O===0):T!==2||(this.onEnd(0),L.avail_out=0,!0)},w.prototype.onData=function(b){this.chunks.push(b)},w.prototype.onEnd=function(b){b===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},n.Deflate=w,n.deflate=M,n.deflateRaw=function(b,I){return(I=I||{}).raw=!0,M(b,I)},n.gzip=function(b,I){return(I=I||{}).gzip=!0,M(b,I)}},75:(i,n,a)=>{function h(f){let K=f.length;for(;--K>=0;)f[K]=0}a.r(n),a.d(n,{Deflate:()=>ci,Inflate:()=>xi,constants:()=>Zr,default:()=>ei,deflate:()=>ni,deflateRaw:()=>hi,gzip:()=>zi,inflate:()=>Ii,inflateRaw:()=>Hr,ungzip:()=>Xr});const m=256,z=286,u=30,y=15,p=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),w=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),M=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),b=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),I=new Array(576);h(I);const O=new Array(60);h(O);const T=new Array(512);h(T);const L=new Array(256);h(L);const Q=new Array(29);h(Q);const ne=new Array(u);function Z(f,K,v,we,_e){this.static_tree=f,this.extra_bits=K,this.extra_base=v,this.elems=we,this.max_length=_e,this.has_stree=f&&f.length}let _,F,j;function G(f,K){this.dyn_tree=f,this.max_code=0,this.stat_desc=K}h(ne);const q=f=>f<256?T[f]:T[256+(f>>>7)],N=(f,K)=>{f.pending_buf[f.pending++]=255&K,f.pending_buf[f.pending++]=K>>>8&255},ee=(f,K,v)=>{f.bi_valid>16-v?(f.bi_buf|=K<<f.bi_valid&65535,N(f,f.bi_buf),f.bi_buf=K>>16-f.bi_valid,f.bi_valid+=v-16):(f.bi_buf|=K<<f.bi_valid&65535,f.bi_valid+=v)},Ce=(f,K,v)=>{ee(f,v[2*K],v[2*K+1])},he=(f,K)=>{let v=0;do v|=1&f,f>>>=1,v<<=1;while(--K>0);return v>>>1},ge=(f,K,v)=>{const we=new Array(16);let _e,ve,Xe=0;for(_e=1;_e<=y;_e++)Xe=Xe+v[_e-1]<<1,we[_e]=Xe;for(ve=0;ve<=K;ve++){let ze=f[2*ve+1];ze!==0&&(f[2*ve]=he(we[ze]++,ze))}},me=f=>{let K;for(K=0;K<z;K++)f.dyn_ltree[2*K]=0;for(K=0;K<u;K++)f.dyn_dtree[2*K]=0;for(K=0;K<19;K++)f.bl_tree[2*K]=0;f.dyn_ltree[512]=1,f.opt_len=f.static_len=0,f.sym_next=f.matches=0},Me=f=>{f.bi_valid>8?N(f,f.bi_buf):f.bi_valid>0&&(f.pending_buf[f.pending++]=f.bi_buf),f.bi_buf=0,f.bi_valid=0},ue=(f,K,v,we)=>{const _e=2*K,ve=2*v;return f[_e]<f[ve]||f[_e]===f[ve]&&we[K]<=we[v]},P=(f,K,v)=>{const we=f.heap[v];let _e=v<<1;for(;_e<=f.heap_len&&(_e<f.heap_len&&ue(K,f.heap[_e+1],f.heap[_e],f.depth)&&_e++,!ue(K,we,f.heap[_e],f.depth));)f.heap[v]=f.heap[_e],v=_e,_e<<=1;f.heap[v]=we},ce=(f,K,v)=>{let we,_e,ve,Xe,ze=0;if(f.sym_next!==0)do we=255&f.pending_buf[f.sym_buf+ze++],we+=(255&f.pending_buf[f.sym_buf+ze++])<<8,_e=f.pending_buf[f.sym_buf+ze++],we===0?Ce(f,_e,K):(ve=L[_e],Ce(f,ve+m+1,K),Xe=p[ve],Xe!==0&&(_e-=Q[ve],ee(f,_e,Xe)),we--,ve=q(we),Ce(f,ve,v),Xe=w[ve],Xe!==0&&(we-=ne[ve],ee(f,we,Xe)));while(ze<f.sym_next);Ce(f,256,K)},se=(f,K)=>{const v=K.dyn_tree,we=K.stat_desc.static_tree,_e=K.stat_desc.has_stree,ve=K.stat_desc.elems;let Xe,ze,gt,Ne=-1;for(f.heap_len=0,f.heap_max=573,Xe=0;Xe<ve;Xe++)v[2*Xe]!==0?(f.heap[++f.heap_len]=Ne=Xe,f.depth[Xe]=0):v[2*Xe+1]=0;for(;f.heap_len<2;)gt=f.heap[++f.heap_len]=Ne<2?++Ne:0,v[2*gt]=1,f.depth[gt]=0,f.opt_len--,_e&&(f.static_len-=we[2*gt+1]);for(K.max_code=Ne,Xe=f.heap_len>>1;Xe>=1;Xe--)P(f,v,Xe);gt=ve;do Xe=f.heap[1],f.heap[1]=f.heap[f.heap_len--],P(f,v,1),ze=f.heap[1],f.heap[--f.heap_max]=Xe,f.heap[--f.heap_max]=ze,v[2*gt]=v[2*Xe]+v[2*ze],f.depth[gt]=(f.depth[Xe]>=f.depth[ze]?f.depth[Xe]:f.depth[ze])+1,v[2*Xe+1]=v[2*ze+1]=gt,f.heap[1]=gt++,P(f,v,1);while(f.heap_len>=2);f.heap[--f.heap_max]=f.heap[1],((Ke,dr)=>{const Wt=dr.dyn_tree,_t=dr.max_code,si=dr.stat_desc.static_tree,Mr=dr.stat_desc.has_stree,er=dr.stat_desc.extra_bits,zr=dr.stat_desc.extra_base,lr=dr.stat_desc.max_length;let Et,sr,Pr,Dt,Sr,cr,tr=0;for(Dt=0;Dt<=y;Dt++)Ke.bl_count[Dt]=0;for(Wt[2*Ke.heap[Ke.heap_max]+1]=0,Et=Ke.heap_max+1;Et<573;Et++)sr=Ke.heap[Et],Dt=Wt[2*Wt[2*sr+1]+1]+1,Dt>lr&&(Dt=lr,tr++),Wt[2*sr+1]=Dt,sr>_t||(Ke.bl_count[Dt]++,Sr=0,sr>=zr&&(Sr=er[sr-zr]),cr=Wt[2*sr],Ke.opt_len+=cr*(Dt+Sr),Mr&&(Ke.static_len+=cr*(si[2*sr+1]+Sr)));if(tr!==0){do{for(Dt=lr-1;Ke.bl_count[Dt]===0;)Dt--;Ke.bl_count[Dt]--,Ke.bl_count[Dt+1]+=2,Ke.bl_count[lr]--,tr-=2}while(tr>0);for(Dt=lr;Dt!==0;Dt--)for(sr=Ke.bl_count[Dt];sr!==0;)Pr=Ke.heap[--Et],Pr>_t||(Wt[2*Pr+1]!==Dt&&(Ke.opt_len+=(Dt-Wt[2*Pr+1])*Wt[2*Pr],Wt[2*Pr+1]=Dt),sr--)}})(f,K),ge(v,Ne,f.bl_count)},X=(f,K,v)=>{let we,_e,ve=-1,Xe=K[1],ze=0,gt=7,Ne=4;for(Xe===0&&(gt=138,Ne=3),K[2*(v+1)+1]=65535,we=0;we<=v;we++)_e=Xe,Xe=K[2*(we+1)+1],++ze<gt&&_e===Xe||(ze<Ne?f.bl_tree[2*_e]+=ze:_e!==0?(_e!==ve&&f.bl_tree[2*_e]++,f.bl_tree[32]++):ze<=10?f.bl_tree[34]++:f.bl_tree[36]++,ze=0,ve=_e,Xe===0?(gt=138,Ne=3):_e===Xe?(gt=6,Ne=3):(gt=7,Ne=4))},Re=(f,K,v)=>{let we,_e,ve=-1,Xe=K[1],ze=0,gt=7,Ne=4;for(Xe===0&&(gt=138,Ne=3),we=0;we<=v;we++)if(_e=Xe,Xe=K[2*(we+1)+1],!(++ze<gt&&_e===Xe)){if(ze<Ne)do Ce(f,_e,f.bl_tree);while(--ze!==0);else _e!==0?(_e!==ve&&(Ce(f,_e,f.bl_tree),ze--),Ce(f,16,f.bl_tree),ee(f,ze-3,2)):ze<=10?(Ce(f,17,f.bl_tree),ee(f,ze-3,3)):(Ce(f,18,f.bl_tree),ee(f,ze-11,7));ze=0,ve=_e,Xe===0?(gt=138,Ne=3):_e===Xe?(gt=6,Ne=3):(gt=7,Ne=4)}};let fe=!1;const De=(f,K,v,we)=>{ee(f,0+(we?1:0),3),Me(f),N(f,v),N(f,~v),v&&f.pending_buf.set(f.window.subarray(K,K+v),f.pending),f.pending+=v};var We=(f,K,v,we)=>{let _e,ve,Xe=0;f.level>0?(f.strm.data_type===2&&(f.strm.data_type=(ze=>{let gt,Ne=4093624447;for(gt=0;gt<=31;gt++,Ne>>>=1)if(1&Ne&&ze.dyn_ltree[2*gt]!==0)return 0;if(ze.dyn_ltree[18]!==0||ze.dyn_ltree[20]!==0||ze.dyn_ltree[26]!==0)return 1;for(gt=32;gt<m;gt++)if(ze.dyn_ltree[2*gt]!==0)return 1;return 0})(f)),se(f,f.l_desc),se(f,f.d_desc),Xe=(ze=>{let gt;for(X(ze,ze.dyn_ltree,ze.l_desc.max_code),X(ze,ze.dyn_dtree,ze.d_desc.max_code),se(ze,ze.bl_desc),gt=18;gt>=3&&ze.bl_tree[2*b[gt]+1]===0;gt--);return ze.opt_len+=3*(gt+1)+5+5+4,gt})(f),_e=f.opt_len+3+7>>>3,ve=f.static_len+3+7>>>3,ve<=_e&&(_e=ve)):_e=ve=v+5,v+4<=_e&&K!==-1?De(f,K,v,we):f.strategy===4||ve===_e?(ee(f,2+(we?1:0),3),ce(f,I,O)):(ee(f,4+(we?1:0),3),((ze,gt,Ne,Ke)=>{let dr;for(ee(ze,gt-257,5),ee(ze,Ne-1,5),ee(ze,Ke-4,4),dr=0;dr<Ke;dr++)ee(ze,ze.bl_tree[2*b[dr]+1],3);Re(ze,ze.dyn_ltree,gt-1),Re(ze,ze.dyn_dtree,Ne-1)})(f,f.l_desc.max_code+1,f.d_desc.max_code+1,Xe+1),ce(f,f.dyn_ltree,f.dyn_dtree)),me(f),we&&Me(f)},oe={_tr_init:f=>{fe||((()=>{let K,v,we,_e,ve;const Xe=new Array(16);for(we=0,_e=0;_e<28;_e++)for(Q[_e]=we,K=0;K<1<<p[_e];K++)L[we++]=_e;for(L[we-1]=_e,ve=0,_e=0;_e<16;_e++)for(ne[_e]=ve,K=0;K<1<<w[_e];K++)T[ve++]=_e;for(ve>>=7;_e<u;_e++)for(ne[_e]=ve<<7,K=0;K<1<<w[_e]-7;K++)T[256+ve++]=_e;for(v=0;v<=y;v++)Xe[v]=0;for(K=0;K<=143;)I[2*K+1]=8,K++,Xe[8]++;for(;K<=255;)I[2*K+1]=9,K++,Xe[9]++;for(;K<=279;)I[2*K+1]=7,K++,Xe[7]++;for(;K<=287;)I[2*K+1]=8,K++,Xe[8]++;for(ge(I,287,Xe),K=0;K<u;K++)O[2*K+1]=5,O[2*K]=he(K,5);_=new Z(I,p,257,z,y),F=new Z(O,w,0,u,y),j=new Z(new Array(0),M,0,19,7)})(),fe=!0),f.l_desc=new G(f.dyn_ltree,_),f.d_desc=new G(f.dyn_dtree,F),f.bl_desc=new G(f.bl_tree,j),f.bi_buf=0,f.bi_valid=0,me(f)},_tr_stored_block:De,_tr_flush_block:We,_tr_tally:(f,K,v)=>(f.pending_buf[f.sym_buf+f.sym_next++]=K,f.pending_buf[f.sym_buf+f.sym_next++]=K>>8,f.pending_buf[f.sym_buf+f.sym_next++]=v,K===0?f.dyn_ltree[2*v]++:(f.matches++,K--,f.dyn_ltree[2*(L[v]+m+1)]++,f.dyn_dtree[2*q(K)]++),f.sym_next===f.sym_end),_tr_align:f=>{ee(f,2,3),Ce(f,256,I),(K=>{K.bi_valid===16?(N(K,K.bi_buf),K.bi_buf=0,K.bi_valid=0):K.bi_valid>=8&&(K.pending_buf[K.pending++]=255&K.bi_buf,K.bi_buf>>=8,K.bi_valid-=8)})(f)}},Ae=(f,K,v,we)=>{let _e=65535&f,ve=f>>>16&65535,Xe=0;for(;v!==0;){Xe=v>2e3?2e3:v,v-=Xe;do _e=_e+K[we++]|0,ve=ve+_e|0;while(--Xe);_e%=65521,ve%=65521}return _e|ve<<16};const He=new Uint32Array((()=>{let f,K=[];for(var v=0;v<256;v++){f=v;for(var we=0;we<8;we++)f=1&f?3988292384^f>>>1:f>>>1;K[v]=f}return K})());var Ue=(f,K,v,we)=>{const _e=He,ve=we+v;f^=-1;for(let Xe=we;Xe<ve;Xe++)f=f>>>8^_e[255&(f^K[Xe])];return-1^f},Ie={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},rt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:st,_tr_stored_block:at,_tr_flush_block:Ft,_tr_tally:Ct,_tr_align:or}=oe,{Z_NO_FLUSH:ar,Z_PARTIAL_FLUSH:kr,Z_FULL_FLUSH:Ar,Z_FINISH:pr,Z_BLOCK:vr,Z_OK:xr,Z_STREAM_END:fi,Z_STREAM_ERROR:Rr,Z_DATA_ERROR:Ir,Z_BUF_ERROR:Di,Z_DEFAULT_COMPRESSION:bi,Z_FILTERED:Hi,Z_HUFFMAN_ONLY:pe,Z_RLE:Se,Z_FIXED:Le,Z_DEFAULT_STRATEGY:dt,Z_UNKNOWN:nt,Z_DEFLATED:zt}=rt,ht=258,Lt=262,Ut=42,It=113,mr=666,li=(f,K)=>(f.msg=Ie[K],K),Ci=f=>2*f-(f>4?9:0),ui=f=>{let K=f.length;for(;--K>=0;)f[K]=0},gi=f=>{let K,v,we,_e=f.w_size;K=f.hash_size,we=K;do v=f.head[--we],f.head[we]=v>=_e?v-_e:0;while(--K);K=_e,we=K;do v=f.prev[--we],f.prev[we]=v>=_e?v-_e:0;while(--K)};let jr=(f,K,v)=>(K<<f.hash_shift^v)&f.hash_mask;const Lr=f=>{const K=f.state;let v=K.pending;v>f.avail_out&&(v=f.avail_out),v!==0&&(f.output.set(K.pending_buf.subarray(K.pending_out,K.pending_out+v),f.next_out),f.next_out+=v,K.pending_out+=v,f.total_out+=v,f.avail_out-=v,K.pending-=v,K.pending===0&&(K.pending_out=0))},Dr=(f,K)=>{Ft(f,f.block_start>=0?f.block_start:-1,f.strstart-f.block_start,K),f.block_start=f.strstart,Lr(f.strm)},rr=(f,K)=>{f.pending_buf[f.pending++]=K},vi=(f,K)=>{f.pending_buf[f.pending++]=K>>>8&255,f.pending_buf[f.pending++]=255&K},wi=(f,K,v,we)=>{let _e=f.avail_in;return _e>we&&(_e=we),_e===0?0:(f.avail_in-=_e,K.set(f.input.subarray(f.next_in,f.next_in+_e),v),f.state.wrap===1?f.adler=Ae(f.adler,K,_e,v):f.state.wrap===2&&(f.adler=Ue(f.adler,K,_e,v)),f.next_in+=_e,f.total_in+=_e,_e)},Ki=(f,K)=>{let v,we,_e=f.max_chain_length,ve=f.strstart,Xe=f.prev_length,ze=f.nice_match;const gt=f.strstart>f.w_size-Lt?f.strstart-(f.w_size-Lt):0,Ne=f.window,Ke=f.w_mask,dr=f.prev,Wt=f.strstart+ht;let _t=Ne[ve+Xe-1],si=Ne[ve+Xe];f.prev_length>=f.good_match&&(_e>>=2),ze>f.lookahead&&(ze=f.lookahead);do if(v=K,Ne[v+Xe]===si&&Ne[v+Xe-1]===_t&&Ne[v]===Ne[ve]&&Ne[++v]===Ne[ve+1]){ve+=2,v++;do;while(Ne[++ve]===Ne[++v]&&Ne[++ve]===Ne[++v]&&Ne[++ve]===Ne[++v]&&Ne[++ve]===Ne[++v]&&Ne[++ve]===Ne[++v]&&Ne[++ve]===Ne[++v]&&Ne[++ve]===Ne[++v]&&Ne[++ve]===Ne[++v]&&ve<Wt);if(we=ht-(Wt-ve),ve=Wt-ht,we>Xe){if(f.match_start=K,Xe=we,we>=ze)break;_t=Ne[ve+Xe-1],si=Ne[ve+Xe]}}while((K=dr[K&Ke])>gt&&--_e!==0);return Xe<=f.lookahead?Xe:f.lookahead},Ei=f=>{const K=f.w_size;let v,we,_e;do{if(we=f.window_size-f.lookahead-f.strstart,f.strstart>=K+(K-Lt)&&(f.window.set(f.window.subarray(K,K+K-we),0),f.match_start-=K,f.strstart-=K,f.block_start-=K,f.insert>f.strstart&&(f.insert=f.strstart),gi(f),we+=K),f.strm.avail_in===0)break;if(v=wi(f.strm,f.window,f.strstart+f.lookahead,we),f.lookahead+=v,f.lookahead+f.insert>=3)for(_e=f.strstart-f.insert,f.ins_h=f.window[_e],f.ins_h=jr(f,f.ins_h,f.window[_e+1]);f.insert&&(f.ins_h=jr(f,f.ins_h,f.window[_e+3-1]),f.prev[_e&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=_e,_e++,f.insert--,!(f.lookahead+f.insert<3)););}while(f.lookahead<Lt&&f.strm.avail_in!==0)},Ni=(f,K)=>{let v,we,_e,ve=f.pending_buf_size-5>f.w_size?f.w_size:f.pending_buf_size-5,Xe=0,ze=f.strm.avail_in;do{if(v=65535,_e=f.bi_valid+42>>3,f.strm.avail_out<_e||(_e=f.strm.avail_out-_e,we=f.strstart-f.block_start,v>we+f.strm.avail_in&&(v=we+f.strm.avail_in),v>_e&&(v=_e),v<ve&&(v===0&&K!==pr||K===ar||v!==we+f.strm.avail_in)))break;Xe=K===pr&&v===we+f.strm.avail_in?1:0,at(f,0,0,Xe),f.pending_buf[f.pending-4]=v,f.pending_buf[f.pending-3]=v>>8,f.pending_buf[f.pending-2]=~v,f.pending_buf[f.pending-1]=~v>>8,Lr(f.strm),we&&(we>v&&(we=v),f.strm.output.set(f.window.subarray(f.block_start,f.block_start+we),f.strm.next_out),f.strm.next_out+=we,f.strm.avail_out-=we,f.strm.total_out+=we,f.block_start+=we,v-=we),v&&(wi(f.strm,f.strm.output,f.strm.next_out,v),f.strm.next_out+=v,f.strm.avail_out-=v,f.strm.total_out+=v)}while(Xe===0);return ze-=f.strm.avail_in,ze&&(ze>=f.w_size?(f.matches=2,f.window.set(f.strm.input.subarray(f.strm.next_in-f.w_size,f.strm.next_in),0),f.strstart=f.w_size,f.insert=f.strstart):(f.window_size-f.strstart<=ze&&(f.strstart-=f.w_size,f.window.set(f.window.subarray(f.w_size,f.w_size+f.strstart),0),f.matches<2&&f.matches++,f.insert>f.strstart&&(f.insert=f.strstart)),f.window.set(f.strm.input.subarray(f.strm.next_in-ze,f.strm.next_in),f.strstart),f.strstart+=ze,f.insert+=ze>f.w_size-f.insert?f.w_size-f.insert:ze),f.block_start=f.strstart),f.high_water<f.strstart&&(f.high_water=f.strstart),Xe?4:K!==ar&&K!==pr&&f.strm.avail_in===0&&f.strstart===f.block_start?2:(_e=f.window_size-f.strstart,f.strm.avail_in>_e&&f.block_start>=f.w_size&&(f.block_start-=f.w_size,f.strstart-=f.w_size,f.window.set(f.window.subarray(f.w_size,f.w_size+f.strstart),0),f.matches<2&&f.matches++,_e+=f.w_size,f.insert>f.strstart&&(f.insert=f.strstart)),_e>f.strm.avail_in&&(_e=f.strm.avail_in),_e&&(wi(f.strm,f.window,f.strstart,_e),f.strstart+=_e,f.insert+=_e>f.w_size-f.insert?f.w_size-f.insert:_e),f.high_water<f.strstart&&(f.high_water=f.strstart),_e=f.bi_valid+42>>3,_e=f.pending_buf_size-_e>65535?65535:f.pending_buf_size-_e,ve=_e>f.w_size?f.w_size:_e,we=f.strstart-f.block_start,(we>=ve||(we||K===pr)&&K!==ar&&f.strm.avail_in===0&&we<=_e)&&(v=we>_e?_e:we,Xe=K===pr&&f.strm.avail_in===0&&v===we?1:0,at(f,f.block_start,v,Xe),f.block_start+=v,Lr(f.strm)),Xe?3:1)},Ti=(f,K)=>{let v,we;for(;;){if(f.lookahead<Lt){if(Ei(f),f.lookahead<Lt&&K===ar)return 1;if(f.lookahead===0)break}if(v=0,f.lookahead>=3&&(f.ins_h=jr(f,f.ins_h,f.window[f.strstart+3-1]),v=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),v!==0&&f.strstart-v<=f.w_size-Lt&&(f.match_length=Ki(f,v)),f.match_length>=3)if(we=Ct(f,f.strstart-f.match_start,f.match_length-3),f.lookahead-=f.match_length,f.match_length<=f.max_lazy_match&&f.lookahead>=3){f.match_length--;do f.strstart++,f.ins_h=jr(f,f.ins_h,f.window[f.strstart+3-1]),v=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart;while(--f.match_length!==0);f.strstart++}else f.strstart+=f.match_length,f.match_length=0,f.ins_h=f.window[f.strstart],f.ins_h=jr(f,f.ins_h,f.window[f.strstart+1]);else we=Ct(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++;if(we&&(Dr(f,!1),f.strm.avail_out===0))return 1}return f.insert=f.strstart<2?f.strstart:2,K===pr?(Dr(f,!0),f.strm.avail_out===0?3:4):f.sym_next&&(Dr(f,!1),f.strm.avail_out===0)?1:2},pi=(f,K)=>{let v,we,_e;for(;;){if(f.lookahead<Lt){if(Ei(f),f.lookahead<Lt&&K===ar)return 1;if(f.lookahead===0)break}if(v=0,f.lookahead>=3&&(f.ins_h=jr(f,f.ins_h,f.window[f.strstart+3-1]),v=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),f.prev_length=f.match_length,f.prev_match=f.match_start,f.match_length=2,v!==0&&f.prev_length<f.max_lazy_match&&f.strstart-v<=f.w_size-Lt&&(f.match_length=Ki(f,v),f.match_length<=5&&(f.strategy===Hi||f.match_length===3&&f.strstart-f.match_start>4096)&&(f.match_length=2)),f.prev_length>=3&&f.match_length<=f.prev_length){_e=f.strstart+f.lookahead-3,we=Ct(f,f.strstart-1-f.prev_match,f.prev_length-3),f.lookahead-=f.prev_length-1,f.prev_length-=2;do++f.strstart<=_e&&(f.ins_h=jr(f,f.ins_h,f.window[f.strstart+3-1]),v=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart);while(--f.prev_length!==0);if(f.match_available=0,f.match_length=2,f.strstart++,we&&(Dr(f,!1),f.strm.avail_out===0))return 1}else if(f.match_available){if(we=Ct(f,0,f.window[f.strstart-1]),we&&Dr(f,!1),f.strstart++,f.lookahead--,f.strm.avail_out===0)return 1}else f.match_available=1,f.strstart++,f.lookahead--}return f.match_available&&(we=Ct(f,0,f.window[f.strstart-1]),f.match_available=0),f.insert=f.strstart<2?f.strstart:2,K===pr?(Dr(f,!0),f.strm.avail_out===0?3:4):f.sym_next&&(Dr(f,!1),f.strm.avail_out===0)?1:2};function Br(f,K,v,we,_e){this.good_length=f,this.max_lazy=K,this.nice_length=v,this.max_chain=we,this.func=_e}const Yr=[new Br(0,0,0,0,Ni),new Br(4,4,8,4,Ti),new Br(4,5,16,8,Ti),new Br(4,6,32,32,Ti),new Br(4,4,16,16,pi),new Br(8,16,32,32,pi),new Br(8,16,128,128,pi),new Br(8,32,128,256,pi),new Br(32,128,258,1024,pi),new Br(32,258,258,4096,pi)];function Vi(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=zt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),ui(this.dyn_ltree),ui(this.dyn_dtree),ui(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),ui(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),ui(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const yi=f=>{if(!f)return 1;const K=f.state;return!K||K.strm!==f||K.status!==Ut&&K.status!==57&&K.status!==69&&K.status!==73&&K.status!==91&&K.status!==103&&K.status!==It&&K.status!==mr?1:0},Wi=f=>{if(yi(f))return li(f,Rr);f.total_in=f.total_out=0,f.data_type=nt;const K=f.state;return K.pending=0,K.pending_out=0,K.wrap<0&&(K.wrap=-K.wrap),K.status=K.wrap===2?57:K.wrap?Ut:It,f.adler=K.wrap===2?0:1,K.last_flush=-2,st(K),xr},tn=f=>{const K=Wi(f);var v;return K===xr&&((v=f.state).window_size=2*v.w_size,ui(v.head),v.max_lazy_match=Yr[v.level].max_lazy,v.good_match=Yr[v.level].good_length,v.nice_match=Yr[v.level].nice_length,v.max_chain_length=Yr[v.level].max_chain,v.strstart=0,v.block_start=0,v.lookahead=0,v.insert=0,v.match_length=v.prev_length=2,v.match_available=0,v.ins_h=0),K},on=(f,K,v,we,_e,ve)=>{if(!f)return Rr;let Xe=1;if(K===bi&&(K=6),we<0?(Xe=0,we=-we):we>15&&(Xe=2,we-=16),_e<1||_e>9||v!==zt||we<8||we>15||K<0||K>9||ve<0||ve>Le||we===8&&Xe!==1)return li(f,Rr);we===8&&(we=9);const ze=new Vi;return f.state=ze,ze.strm=f,ze.status=Ut,ze.wrap=Xe,ze.gzhead=null,ze.w_bits=we,ze.w_size=1<<ze.w_bits,ze.w_mask=ze.w_size-1,ze.hash_bits=_e+7,ze.hash_size=1<<ze.hash_bits,ze.hash_mask=ze.hash_size-1,ze.hash_shift=~~((ze.hash_bits+3-1)/3),ze.window=new Uint8Array(2*ze.w_size),ze.head=new Uint16Array(ze.hash_size),ze.prev=new Uint16Array(ze.w_size),ze.lit_bufsize=1<<_e+6,ze.pending_buf_size=4*ze.lit_bufsize,ze.pending_buf=new Uint8Array(ze.pending_buf_size),ze.sym_buf=ze.lit_bufsize,ze.sym_end=3*(ze.lit_bufsize-1),ze.level=K,ze.strategy=ve,ze.method=v,tn(f)};var ur={deflateInit:(f,K)=>on(f,K,zt,15,8,dt),deflateInit2:on,deflateReset:tn,deflateResetKeep:Wi,deflateSetHeader:(f,K)=>yi(f)||f.state.wrap!==2?Rr:(f.state.gzhead=K,xr),deflate:(f,K)=>{if(yi(f)||K>vr||K<0)return f?li(f,Rr):Rr;const v=f.state;if(!f.output||f.avail_in!==0&&!f.input||v.status===mr&&K!==pr)return li(f,f.avail_out===0?Di:Rr);const we=v.last_flush;if(v.last_flush=K,v.pending!==0){if(Lr(f),f.avail_out===0)return v.last_flush=-1,xr}else if(f.avail_in===0&&Ci(K)<=Ci(we)&&K!==pr)return li(f,Di);if(v.status===mr&&f.avail_in!==0)return li(f,Di);if(v.status===Ut&&v.wrap===0&&(v.status=It),v.status===Ut){let _e=zt+(v.w_bits-8<<4)<<8,ve=-1;if(ve=v.strategy>=pe||v.level<2?0:v.level<6?1:v.level===6?2:3,_e|=ve<<6,v.strstart!==0&&(_e|=32),_e+=31-_e%31,vi(v,_e),v.strstart!==0&&(vi(v,f.adler>>>16),vi(v,65535&f.adler)),f.adler=1,v.status=It,Lr(f),v.pending!==0)return v.last_flush=-1,xr}if(v.status===57){if(f.adler=0,rr(v,31),rr(v,139),rr(v,8),v.gzhead)rr(v,(v.gzhead.text?1:0)+(v.gzhead.hcrc?2:0)+(v.gzhead.extra?4:0)+(v.gzhead.name?8:0)+(v.gzhead.comment?16:0)),rr(v,255&v.gzhead.time),rr(v,v.gzhead.time>>8&255),rr(v,v.gzhead.time>>16&255),rr(v,v.gzhead.time>>24&255),rr(v,v.level===9?2:v.strategy>=pe||v.level<2?4:0),rr(v,255&v.gzhead.os),v.gzhead.extra&&v.gzhead.extra.length&&(rr(v,255&v.gzhead.extra.length),rr(v,v.gzhead.extra.length>>8&255)),v.gzhead.hcrc&&(f.adler=Ue(f.adler,v.pending_buf,v.pending,0)),v.gzindex=0,v.status=69;else if(rr(v,0),rr(v,0),rr(v,0),rr(v,0),rr(v,0),rr(v,v.level===9?2:v.strategy>=pe||v.level<2?4:0),rr(v,3),v.status=It,Lr(f),v.pending!==0)return v.last_flush=-1,xr}if(v.status===69){if(v.gzhead.extra){let _e=v.pending,ve=(65535&v.gzhead.extra.length)-v.gzindex;for(;v.pending+ve>v.pending_buf_size;){let ze=v.pending_buf_size-v.pending;if(v.pending_buf.set(v.gzhead.extra.subarray(v.gzindex,v.gzindex+ze),v.pending),v.pending=v.pending_buf_size,v.gzhead.hcrc&&v.pending>_e&&(f.adler=Ue(f.adler,v.pending_buf,v.pending-_e,_e)),v.gzindex+=ze,Lr(f),v.pending!==0)return v.last_flush=-1,xr;_e=0,ve-=ze}let Xe=new Uint8Array(v.gzhead.extra);v.pending_buf.set(Xe.subarray(v.gzindex,v.gzindex+ve),v.pending),v.pending+=ve,v.gzhead.hcrc&&v.pending>_e&&(f.adler=Ue(f.adler,v.pending_buf,v.pending-_e,_e)),v.gzindex=0}v.status=73}if(v.status===73){if(v.gzhead.name){let _e,ve=v.pending;do{if(v.pending===v.pending_buf_size){if(v.gzhead.hcrc&&v.pending>ve&&(f.adler=Ue(f.adler,v.pending_buf,v.pending-ve,ve)),Lr(f),v.pending!==0)return v.last_flush=-1,xr;ve=0}_e=v.gzindex<v.gzhead.name.length?255&v.gzhead.name.charCodeAt(v.gzindex++):0,rr(v,_e)}while(_e!==0);v.gzhead.hcrc&&v.pending>ve&&(f.adler=Ue(f.adler,v.pending_buf,v.pending-ve,ve)),v.gzindex=0}v.status=91}if(v.status===91){if(v.gzhead.comment){let _e,ve=v.pending;do{if(v.pending===v.pending_buf_size){if(v.gzhead.hcrc&&v.pending>ve&&(f.adler=Ue(f.adler,v.pending_buf,v.pending-ve,ve)),Lr(f),v.pending!==0)return v.last_flush=-1,xr;ve=0}_e=v.gzindex<v.gzhead.comment.length?255&v.gzhead.comment.charCodeAt(v.gzindex++):0,rr(v,_e)}while(_e!==0);v.gzhead.hcrc&&v.pending>ve&&(f.adler=Ue(f.adler,v.pending_buf,v.pending-ve,ve))}v.status=103}if(v.status===103){if(v.gzhead.hcrc){if(v.pending+2>v.pending_buf_size&&(Lr(f),v.pending!==0))return v.last_flush=-1,xr;rr(v,255&f.adler),rr(v,f.adler>>8&255),f.adler=0}if(v.status=It,Lr(f),v.pending!==0)return v.last_flush=-1,xr}if(f.avail_in!==0||v.lookahead!==0||K!==ar&&v.status!==mr){let _e=v.level===0?Ni(v,K):v.strategy===pe?((ve,Xe)=>{let ze;for(;;){if(ve.lookahead===0&&(Ei(ve),ve.lookahead===0)){if(Xe===ar)return 1;break}if(ve.match_length=0,ze=Ct(ve,0,ve.window[ve.strstart]),ve.lookahead--,ve.strstart++,ze&&(Dr(ve,!1),ve.strm.avail_out===0))return 1}return ve.insert=0,Xe===pr?(Dr(ve,!0),ve.strm.avail_out===0?3:4):ve.sym_next&&(Dr(ve,!1),ve.strm.avail_out===0)?1:2})(v,K):v.strategy===Se?((ve,Xe)=>{let ze,gt,Ne,Ke;const dr=ve.window;for(;;){if(ve.lookahead<=ht){if(Ei(ve),ve.lookahead<=ht&&Xe===ar)return 1;if(ve.lookahead===0)break}if(ve.match_length=0,ve.lookahead>=3&&ve.strstart>0&&(Ne=ve.strstart-1,gt=dr[Ne],gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne])){Ke=ve.strstart+ht;do;while(gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&Ne<Ke);ve.match_length=ht-(Ke-Ne),ve.match_length>ve.lookahead&&(ve.match_length=ve.lookahead)}if(ve.match_length>=3?(ze=Ct(ve,1,ve.match_length-3),ve.lookahead-=ve.match_length,ve.strstart+=ve.match_length,ve.match_length=0):(ze=Ct(ve,0,ve.window[ve.strstart]),ve.lookahead--,ve.strstart++),ze&&(Dr(ve,!1),ve.strm.avail_out===0))return 1}return ve.insert=0,Xe===pr?(Dr(ve,!0),ve.strm.avail_out===0?3:4):ve.sym_next&&(Dr(ve,!1),ve.strm.avail_out===0)?1:2})(v,K):Yr[v.level].func(v,K);if(_e!==3&&_e!==4||(v.status=mr),_e===1||_e===3)return f.avail_out===0&&(v.last_flush=-1),xr;if(_e===2&&(K===kr?or(v):K!==vr&&(at(v,0,0,!1),K===Ar&&(ui(v.head),v.lookahead===0&&(v.strstart=0,v.block_start=0,v.insert=0))),Lr(f),f.avail_out===0))return v.last_flush=-1,xr}return K!==pr?xr:v.wrap<=0?fi:(v.wrap===2?(rr(v,255&f.adler),rr(v,f.adler>>8&255),rr(v,f.adler>>16&255),rr(v,f.adler>>24&255),rr(v,255&f.total_in),rr(v,f.total_in>>8&255),rr(v,f.total_in>>16&255),rr(v,f.total_in>>24&255)):(vi(v,f.adler>>>16),vi(v,65535&f.adler)),Lr(f),v.wrap>0&&(v.wrap=-v.wrap),v.pending!==0?xr:fi)},deflateEnd:f=>{if(yi(f))return Rr;const K=f.state.status;return f.state=null,K===It?li(f,Ir):xr},deflateSetDictionary:(f,K)=>{let v=K.length;if(yi(f))return Rr;const we=f.state,_e=we.wrap;if(_e===2||_e===1&&we.status!==Ut||we.lookahead)return Rr;if(_e===1&&(f.adler=Ae(f.adler,K,v,0)),we.wrap=0,v>=we.w_size){_e===0&&(ui(we.head),we.strstart=0,we.block_start=0,we.insert=0);let gt=new Uint8Array(we.w_size);gt.set(K.subarray(v-we.w_size,v),0),K=gt,v=we.w_size}const ve=f.avail_in,Xe=f.next_in,ze=f.input;for(f.avail_in=v,f.next_in=0,f.input=K,Ei(we);we.lookahead>=3;){let gt=we.strstart,Ne=we.lookahead-2;do we.ins_h=jr(we,we.ins_h,we.window[gt+3-1]),we.prev[gt&we.w_mask]=we.head[we.ins_h],we.head[we.ins_h]=gt,gt++;while(--Ne);we.strstart=gt,we.lookahead=2,Ei(we)}return we.strstart+=we.lookahead,we.block_start=we.strstart,we.insert=we.lookahead,we.lookahead=0,we.match_length=we.prev_length=2,we.match_available=0,f.next_in=Xe,f.input=ze,f.avail_in=ve,we.wrap=_e,xr},deflateInfo:"pako deflate (from Nodeca project)"};const Gr=(f,K)=>Object.prototype.hasOwnProperty.call(f,K);var Kr=function(f){const K=Array.prototype.slice.call(arguments,1);for(;K.length;){const v=K.shift();if(v){if(typeof v!="object")throw new TypeError(v+"must be non-object");for(const we in v)Gr(v,we)&&(f[we]=v[we])}}return f},Zi=f=>{let K=0;for(let we=0,_e=f.length;we<_e;we++)K+=f[we].length;const v=new Uint8Array(K);for(let we=0,_e=0,ve=f.length;we<ve;we++){let Xe=f[we];v.set(Xe,_e),_e+=Xe.length}return v};let Bt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Bt=!1}const x=new Uint8Array(256);for(let f=0;f<256;f++)x[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;x[254]=x[254]=1;var ie=f=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(f);let K,v,we,_e,ve,Xe=f.length,ze=0;for(_e=0;_e<Xe;_e++)v=f.charCodeAt(_e),(64512&v)==55296&&_e+1<Xe&&(we=f.charCodeAt(_e+1),(64512&we)==56320&&(v=65536+(v-55296<<10)+(we-56320),_e++)),ze+=v<128?1:v<2048?2:v<65536?3:4;for(K=new Uint8Array(ze),ve=0,_e=0;ve<ze;_e++)v=f.charCodeAt(_e),(64512&v)==55296&&_e+1<Xe&&(we=f.charCodeAt(_e+1),(64512&we)==56320&&(v=65536+(v-55296<<10)+(we-56320),_e++)),v<128?K[ve++]=v:v<2048?(K[ve++]=192|v>>>6,K[ve++]=128|63&v):v<65536?(K[ve++]=224|v>>>12,K[ve++]=128|v>>>6&63,K[ve++]=128|63&v):(K[ve++]=240|v>>>18,K[ve++]=128|v>>>12&63,K[ve++]=128|v>>>6&63,K[ve++]=128|63&v);return K},xe=(f,K)=>{const v=K||f.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(f.subarray(0,K));let we,_e;const ve=new Array(2*v);for(_e=0,we=0;we<v;){let Xe=f[we++];if(Xe<128){ve[_e++]=Xe;continue}let ze=x[Xe];if(ze>4)ve[_e++]=65533,we+=ze-1;else{for(Xe&=ze===2?31:ze===3?15:7;ze>1&&we<v;)Xe=Xe<<6|63&f[we++],ze--;ze>1?ve[_e++]=65533:Xe<65536?ve[_e++]=Xe:(Xe-=65536,ve[_e++]=55296|Xe>>10&1023,ve[_e++]=56320|1023&Xe)}}return((Xe,ze)=>{if(ze<65534&&Xe.subarray&&Bt)return String.fromCharCode.apply(null,Xe.length===ze?Xe:Xe.subarray(0,ze));let gt="";for(let Ne=0;Ne<ze;Ne++)gt+=String.fromCharCode(Xe[Ne]);return gt})(ve,_e)},Ve=(f,K)=>{(K=K||f.length)>f.length&&(K=f.length);let v=K-1;for(;v>=0&&(192&f[v])==128;)v--;return v<0||v===0?K:v+x[f[v]]>K?v:K},Oe=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const yt=Object.prototype.toString,{Z_NO_FLUSH:lt,Z_SYNC_FLUSH:mt,Z_FULL_FLUSH:Mt,Z_FINISH:Pt,Z_OK:Ot,Z_STREAM_END:gr,Z_DEFAULT_COMPRESSION:Yt,Z_DEFAULT_STRATEGY:Cr,Z_DEFLATED:Er}=rt;function Ur(f){this.options=Kr({level:Yt,method:Er,chunkSize:16384,windowBits:15,memLevel:8,strategy:Cr},f||{});let K=this.options;K.raw&&K.windowBits>0?K.windowBits=-K.windowBits:K.gzip&&K.windowBits>0&&K.windowBits<16&&(K.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Oe,this.strm.avail_out=0;let v=ur.deflateInit2(this.strm,K.level,K.method,K.windowBits,K.memLevel,K.strategy);if(v!==Ot)throw new Error(Ie[v]);if(K.header&&ur.deflateSetHeader(this.strm,K.header),K.dictionary){let we;if(we=typeof K.dictionary=="string"?ie(K.dictionary):yt.call(K.dictionary)==="[object ArrayBuffer]"?new Uint8Array(K.dictionary):K.dictionary,v=ur.deflateSetDictionary(this.strm,we),v!==Ot)throw new Error(Ie[v]);this._dict_set=!0}}function _r(f,K){const v=new Ur(K);if(v.push(f,!0),v.err)throw v.msg||Ie[v.err];return v.result}Ur.prototype.push=function(f,K){const v=this.strm,we=this.options.chunkSize;let _e,ve;if(this.ended)return!1;for(ve=K===~~K?K:K===!0?Pt:lt,typeof f=="string"?v.input=ie(f):yt.call(f)==="[object ArrayBuffer]"?v.input=new Uint8Array(f):v.input=f,v.next_in=0,v.avail_in=v.input.length;;)if(v.avail_out===0&&(v.output=new Uint8Array(we),v.next_out=0,v.avail_out=we),(ve===mt||ve===Mt)&&v.avail_out<=6)this.onData(v.output.subarray(0,v.next_out)),v.avail_out=0;else{if(_e=ur.deflate(v,ve),_e===gr)return v.next_out>0&&this.onData(v.output.subarray(0,v.next_out)),_e=ur.deflateEnd(this.strm),this.onEnd(_e),this.ended=!0,_e===Ot;if(v.avail_out!==0){if(ve>0&&v.next_out>0)this.onData(v.output.subarray(0,v.next_out)),v.avail_out=0;else if(v.avail_in===0)break}else this.onData(v.output)}return!0},Ur.prototype.onData=function(f){this.chunks.push(f)},Ur.prototype.onEnd=function(f){f===Ot&&(this.result=Zi(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg};var Or={Deflate:Ur,deflate:_r,deflateRaw:function(f,K){return(K=K||{}).raw=!0,_r(f,K)},gzip:function(f,K){return(K=K||{}).gzip=!0,_r(f,K)}};const br=16209;var Mi=function(f,K){let v,we,_e,ve,Xe,ze,gt,Ne,Ke,dr,Wt,_t,si,Mr,er,zr,lr,Et,sr,Pr,Dt,Sr,cr,tr;const fr=f.state;v=f.next_in,cr=f.input,we=v+(f.avail_in-5),_e=f.next_out,tr=f.output,ve=_e-(K-f.avail_out),Xe=_e+(f.avail_out-257),ze=fr.dmax,gt=fr.wsize,Ne=fr.whave,Ke=fr.wnext,dr=fr.window,Wt=fr.hold,_t=fr.bits,si=fr.lencode,Mr=fr.distcode,er=(1<<fr.lenbits)-1,zr=(1<<fr.distbits)-1;e:do{_t<15&&(Wt+=cr[v++]<<_t,_t+=8,Wt+=cr[v++]<<_t,_t+=8),lr=si[Wt&er];t:for(;;){if(Et=lr>>>24,Wt>>>=Et,_t-=Et,Et=lr>>>16&255,Et===0)tr[_e++]=65535&lr;else{if(!(16&Et)){if(64&Et){if(32&Et){fr.mode=16191;break e}f.msg="invalid literal/length code",fr.mode=br;break e}lr=si[(65535&lr)+(Wt&(1<<Et)-1)];continue t}for(sr=65535&lr,Et&=15,Et&&(_t<Et&&(Wt+=cr[v++]<<_t,_t+=8),sr+=Wt&(1<<Et)-1,Wt>>>=Et,_t-=Et),_t<15&&(Wt+=cr[v++]<<_t,_t+=8,Wt+=cr[v++]<<_t,_t+=8),lr=Mr[Wt&zr];;){if(Et=lr>>>24,Wt>>>=Et,_t-=Et,Et=lr>>>16&255,16&Et){if(Pr=65535&lr,Et&=15,_t<Et&&(Wt+=cr[v++]<<_t,_t+=8,_t<Et&&(Wt+=cr[v++]<<_t,_t+=8)),Pr+=Wt&(1<<Et)-1,Pr>ze){f.msg="invalid distance too far back",fr.mode=br;break e}if(Wt>>>=Et,_t-=Et,Et=_e-ve,Pr>Et){if(Et=Pr-Et,Et>Ne&&fr.sane){f.msg="invalid distance too far back",fr.mode=br;break e}if(Dt=0,Sr=dr,Ke===0){if(Dt+=gt-Et,Et<sr){sr-=Et;do tr[_e++]=dr[Dt++];while(--Et);Dt=_e-Pr,Sr=tr}}else if(Ke<Et){if(Dt+=gt+Ke-Et,Et-=Ke,Et<sr){sr-=Et;do tr[_e++]=dr[Dt++];while(--Et);if(Dt=0,Ke<sr){Et=Ke,sr-=Et;do tr[_e++]=dr[Dt++];while(--Et);Dt=_e-Pr,Sr=tr}}}else if(Dt+=Ke-Et,Et<sr){sr-=Et;do tr[_e++]=dr[Dt++];while(--Et);Dt=_e-Pr,Sr=tr}for(;sr>2;)tr[_e++]=Sr[Dt++],tr[_e++]=Sr[Dt++],tr[_e++]=Sr[Dt++],sr-=3;sr&&(tr[_e++]=Sr[Dt++],sr>1&&(tr[_e++]=Sr[Dt++]))}else{Dt=_e-Pr;do tr[_e++]=tr[Dt++],tr[_e++]=tr[Dt++],tr[_e++]=tr[Dt++],sr-=3;while(sr>2);sr&&(tr[_e++]=tr[Dt++],sr>1&&(tr[_e++]=tr[Dt++]))}break}if(64&Et){f.msg="invalid distance code",fr.mode=br;break e}lr=Mr[(65535&lr)+(Wt&(1<<Et)-1)]}}break}}while(v<we&&_e<Xe);sr=_t>>3,v-=sr,_t-=sr<<3,Wt&=(1<<_t)-1,f.next_in=v,f.next_out=_e,f.avail_in=v<we?we-v+5:5-(v-we),f.avail_out=_e<Xe?Xe-_e+257:257-(_e-Xe),fr.hold=Wt,fr.bits=_t};const Qt=15,ri=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ae=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),r=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),s=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var l=(f,K,v,we,_e,ve,Xe,ze)=>{const gt=ze.bits;let Ne,Ke,dr,Wt,_t,si,Mr=0,er=0,zr=0,lr=0,Et=0,sr=0,Pr=0,Dt=0,Sr=0,cr=0,tr=null;const fr=new Uint16Array(16),Li=new Uint16Array(16);let Wn,os,$n,Xn=null;for(Mr=0;Mr<=Qt;Mr++)fr[Mr]=0;for(er=0;er<we;er++)fr[K[v+er]]++;for(Et=gt,lr=Qt;lr>=1&&fr[lr]===0;lr--);if(Et>lr&&(Et=lr),lr===0)return _e[ve++]=20971520,_e[ve++]=20971520,ze.bits=1,0;for(zr=1;zr<lr&&fr[zr]===0;zr++);for(Et<zr&&(Et=zr),Dt=1,Mr=1;Mr<=Qt;Mr++)if(Dt<<=1,Dt-=fr[Mr],Dt<0)return-1;if(Dt>0&&(f===0||lr!==1))return-1;for(Li[1]=0,Mr=1;Mr<Qt;Mr++)Li[Mr+1]=Li[Mr]+fr[Mr];for(er=0;er<we;er++)K[v+er]!==0&&(Xe[Li[K[v+er]]++]=er);if(f===0?(tr=Xn=Xe,si=20):f===1?(tr=ri,Xn=ae,si=257):(tr=r,Xn=s,si=0),cr=0,er=0,Mr=zr,_t=ve,sr=Et,Pr=0,dr=-1,Sr=1<<Et,Wt=Sr-1,f===1&&Sr>852||f===2&&Sr>592)return 1;for(;;){Wn=Mr-Pr,Xe[er]+1<si?(os=0,$n=Xe[er]):Xe[er]>=si?(os=Xn[Xe[er]-si],$n=tr[Xe[er]-si]):(os=96,$n=0),Ne=1<<Mr-Pr,Ke=1<<sr,zr=Ke;do Ke-=Ne,_e[_t+(cr>>Pr)+Ke]=Wn<<24|os<<16|$n;while(Ke!==0);for(Ne=1<<Mr-1;cr&Ne;)Ne>>=1;if(Ne!==0?(cr&=Ne-1,cr+=Ne):cr=0,er++,--fr[Mr]===0){if(Mr===lr)break;Mr=K[v+Xe[er]]}if(Mr>Et&&(cr&Wt)!==dr){for(Pr===0&&(Pr=Et),_t+=zr,sr=Mr-Pr,Dt=1<<sr;sr+Pr<lr&&(Dt-=fr[sr+Pr],!(Dt<=0));)sr++,Dt<<=1;if(Sr+=1<<sr,f===1&&Sr>852||f===2&&Sr>592)return 1;dr=cr&Wt,_e[dr]=Et<<24|sr<<16|_t-ve}}return cr!==0&&(_e[_t+cr]=Mr-Pr<<24|64<<16),ze.bits=Et,0};const{Z_FINISH:c,Z_BLOCK:A,Z_TREES:g,Z_OK:C,Z_STREAM_END:E,Z_NEED_DICT:S,Z_STREAM_ERROR:k,Z_DATA_ERROR:D,Z_MEM_ERROR:$,Z_BUF_ERROR:U,Z_DEFLATED:V}=rt,W=16180,H=16190,Y=16191,J=16192,te=16194,de=16199,le=16200,ye=16206,Pe=16209,Te=f=>(f>>>24&255)+(f>>>8&65280)+((65280&f)<<8)+((255&f)<<24);function ke(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const be=f=>{if(!f)return 1;const K=f.state;return!K||K.strm!==f||K.mode<W||K.mode>16211?1:0},Ge=f=>{if(be(f))return k;const K=f.state;return f.total_in=f.total_out=K.total=0,f.msg="",K.wrap&&(f.adler=1&K.wrap),K.mode=W,K.last=0,K.havedict=0,K.flags=-1,K.dmax=32768,K.head=null,K.hold=0,K.bits=0,K.lencode=K.lendyn=new Int32Array(852),K.distcode=K.distdyn=new Int32Array(592),K.sane=1,K.back=-1,C},Je=f=>{if(be(f))return k;const K=f.state;return K.wsize=0,K.whave=0,K.wnext=0,Ge(f)},tt=(f,K)=>{let v;if(be(f))return k;const we=f.state;return K<0?(v=0,K=-K):(v=5+(K>>4),K<48&&(K&=15)),K&&(K<8||K>15)?k:(we.window!==null&&we.wbits!==K&&(we.window=null),we.wrap=v,we.wbits=K,Je(f))},Ye=(f,K)=>{if(!f)return k;const v=new ke;f.state=v,v.strm=f,v.window=null,v.mode=W;const we=tt(f,K);return we!==C&&(f.state=null),we};let ut,ft,Qe=!0;const pt=f=>{if(Qe){ut=new Int32Array(512),ft=new Int32Array(32);let K=0;for(;K<144;)f.lens[K++]=8;for(;K<256;)f.lens[K++]=9;for(;K<280;)f.lens[K++]=7;for(;K<288;)f.lens[K++]=8;for(l(1,f.lens,0,288,ut,0,f.work,{bits:9}),K=0;K<32;)f.lens[K++]=5;l(2,f.lens,0,32,ft,0,f.work,{bits:5}),Qe=!1}f.lencode=ut,f.lenbits=9,f.distcode=ft,f.distbits=5},Be=(f,K,v,we)=>{let _e;const ve=f.state;return ve.window===null&&(ve.wsize=1<<ve.wbits,ve.wnext=0,ve.whave=0,ve.window=new Uint8Array(ve.wsize)),we>=ve.wsize?(ve.window.set(K.subarray(v-ve.wsize,v),0),ve.wnext=0,ve.whave=ve.wsize):(_e=ve.wsize-ve.wnext,_e>we&&(_e=we),ve.window.set(K.subarray(v-we,v-we+_e),ve.wnext),(we-=_e)?(ve.window.set(K.subarray(v-we,v),0),ve.wnext=we,ve.whave=ve.wsize):(ve.wnext+=_e,ve.wnext===ve.wsize&&(ve.wnext=0),ve.whave<ve.wsize&&(ve.whave+=_e))),0};var et={inflateReset:Je,inflateReset2:tt,inflateResetKeep:Ge,inflateInit:f=>Ye(f,15),inflateInit2:Ye,inflate:(f,K)=>{let v,we,_e,ve,Xe,ze,gt,Ne,Ke,dr,Wt,_t,si,Mr,er,zr,lr,Et,sr,Pr,Dt,Sr,cr=0;const tr=new Uint8Array(4);let fr,Li;const Wn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(be(f)||!f.output||!f.input&&f.avail_in!==0)return k;v=f.state,v.mode===Y&&(v.mode=J),Xe=f.next_out,_e=f.output,gt=f.avail_out,ve=f.next_in,we=f.input,ze=f.avail_in,Ne=v.hold,Ke=v.bits,dr=ze,Wt=gt,Sr=C;e:for(;;)switch(v.mode){case W:if(v.wrap===0){v.mode=J;break}for(;Ke<16;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}if(2&v.wrap&&Ne===35615){v.wbits===0&&(v.wbits=15),v.check=0,tr[0]=255&Ne,tr[1]=Ne>>>8&255,v.check=Ue(v.check,tr,2,0),Ne=0,Ke=0,v.mode=16181;break}if(v.head&&(v.head.done=!1),!(1&v.wrap)||(((255&Ne)<<8)+(Ne>>8))%31){f.msg="incorrect header check",v.mode=Pe;break}if((15&Ne)!==V){f.msg="unknown compression method",v.mode=Pe;break}if(Ne>>>=4,Ke-=4,Dt=8+(15&Ne),v.wbits===0&&(v.wbits=Dt),Dt>15||Dt>v.wbits){f.msg="invalid window size",v.mode=Pe;break}v.dmax=1<<v.wbits,v.flags=0,f.adler=v.check=1,v.mode=512&Ne?16189:Y,Ne=0,Ke=0;break;case 16181:for(;Ke<16;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}if(v.flags=Ne,(255&v.flags)!==V){f.msg="unknown compression method",v.mode=Pe;break}if(57344&v.flags){f.msg="unknown header flags set",v.mode=Pe;break}v.head&&(v.head.text=Ne>>8&1),512&v.flags&&4&v.wrap&&(tr[0]=255&Ne,tr[1]=Ne>>>8&255,v.check=Ue(v.check,tr,2,0)),Ne=0,Ke=0,v.mode=16182;case 16182:for(;Ke<32;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}v.head&&(v.head.time=Ne),512&v.flags&&4&v.wrap&&(tr[0]=255&Ne,tr[1]=Ne>>>8&255,tr[2]=Ne>>>16&255,tr[3]=Ne>>>24&255,v.check=Ue(v.check,tr,4,0)),Ne=0,Ke=0,v.mode=16183;case 16183:for(;Ke<16;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}v.head&&(v.head.xflags=255&Ne,v.head.os=Ne>>8),512&v.flags&&4&v.wrap&&(tr[0]=255&Ne,tr[1]=Ne>>>8&255,v.check=Ue(v.check,tr,2,0)),Ne=0,Ke=0,v.mode=16184;case 16184:if(1024&v.flags){for(;Ke<16;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}v.length=Ne,v.head&&(v.head.extra_len=Ne),512&v.flags&&4&v.wrap&&(tr[0]=255&Ne,tr[1]=Ne>>>8&255,v.check=Ue(v.check,tr,2,0)),Ne=0,Ke=0}else v.head&&(v.head.extra=null);v.mode=16185;case 16185:if(1024&v.flags&&(_t=v.length,_t>ze&&(_t=ze),_t&&(v.head&&(Dt=v.head.extra_len-v.length,v.head.extra||(v.head.extra=new Uint8Array(v.head.extra_len)),v.head.extra.set(we.subarray(ve,ve+_t),Dt)),512&v.flags&&4&v.wrap&&(v.check=Ue(v.check,we,_t,ve)),ze-=_t,ve+=_t,v.length-=_t),v.length))break e;v.length=0,v.mode=16186;case 16186:if(2048&v.flags){if(ze===0)break e;_t=0;do Dt=we[ve+_t++],v.head&&Dt&&v.length<65536&&(v.head.name+=String.fromCharCode(Dt));while(Dt&&_t<ze);if(512&v.flags&&4&v.wrap&&(v.check=Ue(v.check,we,_t,ve)),ze-=_t,ve+=_t,Dt)break e}else v.head&&(v.head.name=null);v.length=0,v.mode=16187;case 16187:if(4096&v.flags){if(ze===0)break e;_t=0;do Dt=we[ve+_t++],v.head&&Dt&&v.length<65536&&(v.head.comment+=String.fromCharCode(Dt));while(Dt&&_t<ze);if(512&v.flags&&4&v.wrap&&(v.check=Ue(v.check,we,_t,ve)),ze-=_t,ve+=_t,Dt)break e}else v.head&&(v.head.comment=null);v.mode=16188;case 16188:if(512&v.flags){for(;Ke<16;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}if(4&v.wrap&&Ne!==(65535&v.check)){f.msg="header crc mismatch",v.mode=Pe;break}Ne=0,Ke=0}v.head&&(v.head.hcrc=v.flags>>9&1,v.head.done=!0),f.adler=v.check=0,v.mode=Y;break;case 16189:for(;Ke<32;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}f.adler=v.check=Te(Ne),Ne=0,Ke=0,v.mode=H;case H:if(v.havedict===0)return f.next_out=Xe,f.avail_out=gt,f.next_in=ve,f.avail_in=ze,v.hold=Ne,v.bits=Ke,S;f.adler=v.check=1,v.mode=Y;case Y:if(K===A||K===g)break e;case J:if(v.last){Ne>>>=7&Ke,Ke-=7&Ke,v.mode=ye;break}for(;Ke<3;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}switch(v.last=1&Ne,Ne>>>=1,Ke-=1,3&Ne){case 0:v.mode=16193;break;case 1:if(pt(v),v.mode=de,K===g){Ne>>>=2,Ke-=2;break e}break;case 2:v.mode=16196;break;case 3:f.msg="invalid block type",v.mode=Pe}Ne>>>=2,Ke-=2;break;case 16193:for(Ne>>>=7&Ke,Ke-=7&Ke;Ke<32;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}if((65535&Ne)!=(Ne>>>16^65535)){f.msg="invalid stored block lengths",v.mode=Pe;break}if(v.length=65535&Ne,Ne=0,Ke=0,v.mode=te,K===g)break e;case te:v.mode=16195;case 16195:if(_t=v.length,_t){if(_t>ze&&(_t=ze),_t>gt&&(_t=gt),_t===0)break e;_e.set(we.subarray(ve,ve+_t),Xe),ze-=_t,ve+=_t,gt-=_t,Xe+=_t,v.length-=_t;break}v.mode=Y;break;case 16196:for(;Ke<14;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}if(v.nlen=257+(31&Ne),Ne>>>=5,Ke-=5,v.ndist=1+(31&Ne),Ne>>>=5,Ke-=5,v.ncode=4+(15&Ne),Ne>>>=4,Ke-=4,v.nlen>286||v.ndist>30){f.msg="too many length or distance symbols",v.mode=Pe;break}v.have=0,v.mode=16197;case 16197:for(;v.have<v.ncode;){for(;Ke<3;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}v.lens[Wn[v.have++]]=7&Ne,Ne>>>=3,Ke-=3}for(;v.have<19;)v.lens[Wn[v.have++]]=0;if(v.lencode=v.lendyn,v.lenbits=7,fr={bits:v.lenbits},Sr=l(0,v.lens,0,19,v.lencode,0,v.work,fr),v.lenbits=fr.bits,Sr){f.msg="invalid code lengths set",v.mode=Pe;break}v.have=0,v.mode=16198;case 16198:for(;v.have<v.nlen+v.ndist;){for(;cr=v.lencode[Ne&(1<<v.lenbits)-1],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(er<=Ke);){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}if(lr<16)Ne>>>=er,Ke-=er,v.lens[v.have++]=lr;else{if(lr===16){for(Li=er+2;Ke<Li;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}if(Ne>>>=er,Ke-=er,v.have===0){f.msg="invalid bit length repeat",v.mode=Pe;break}Dt=v.lens[v.have-1],_t=3+(3&Ne),Ne>>>=2,Ke-=2}else if(lr===17){for(Li=er+3;Ke<Li;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}Ne>>>=er,Ke-=er,Dt=0,_t=3+(7&Ne),Ne>>>=3,Ke-=3}else{for(Li=er+7;Ke<Li;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}Ne>>>=er,Ke-=er,Dt=0,_t=11+(127&Ne),Ne>>>=7,Ke-=7}if(v.have+_t>v.nlen+v.ndist){f.msg="invalid bit length repeat",v.mode=Pe;break}for(;_t--;)v.lens[v.have++]=Dt}}if(v.mode===Pe)break;if(v.lens[256]===0){f.msg="invalid code -- missing end-of-block",v.mode=Pe;break}if(v.lenbits=9,fr={bits:v.lenbits},Sr=l(1,v.lens,0,v.nlen,v.lencode,0,v.work,fr),v.lenbits=fr.bits,Sr){f.msg="invalid literal/lengths set",v.mode=Pe;break}if(v.distbits=6,v.distcode=v.distdyn,fr={bits:v.distbits},Sr=l(2,v.lens,v.nlen,v.ndist,v.distcode,0,v.work,fr),v.distbits=fr.bits,Sr){f.msg="invalid distances set",v.mode=Pe;break}if(v.mode=de,K===g)break e;case de:v.mode=le;case le:if(ze>=6&&gt>=258){f.next_out=Xe,f.avail_out=gt,f.next_in=ve,f.avail_in=ze,v.hold=Ne,v.bits=Ke,Mi(f,Wt),Xe=f.next_out,_e=f.output,gt=f.avail_out,ve=f.next_in,we=f.input,ze=f.avail_in,Ne=v.hold,Ke=v.bits,v.mode===Y&&(v.back=-1);break}for(v.back=0;cr=v.lencode[Ne&(1<<v.lenbits)-1],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(er<=Ke);){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}if(zr&&!(240&zr)){for(Et=er,sr=zr,Pr=lr;cr=v.lencode[Pr+((Ne&(1<<Et+sr)-1)>>Et)],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(Et+er<=Ke);){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}Ne>>>=Et,Ke-=Et,v.back+=Et}if(Ne>>>=er,Ke-=er,v.back+=er,v.length=lr,zr===0){v.mode=16205;break}if(32&zr){v.back=-1,v.mode=Y;break}if(64&zr){f.msg="invalid literal/length code",v.mode=Pe;break}v.extra=15&zr,v.mode=16201;case 16201:if(v.extra){for(Li=v.extra;Ke<Li;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}v.length+=Ne&(1<<v.extra)-1,Ne>>>=v.extra,Ke-=v.extra,v.back+=v.extra}v.was=v.length,v.mode=16202;case 16202:for(;cr=v.distcode[Ne&(1<<v.distbits)-1],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(er<=Ke);){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}if(!(240&zr)){for(Et=er,sr=zr,Pr=lr;cr=v.distcode[Pr+((Ne&(1<<Et+sr)-1)>>Et)],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(Et+er<=Ke);){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}Ne>>>=Et,Ke-=Et,v.back+=Et}if(Ne>>>=er,Ke-=er,v.back+=er,64&zr){f.msg="invalid distance code",v.mode=Pe;break}v.offset=lr,v.extra=15&zr,v.mode=16203;case 16203:if(v.extra){for(Li=v.extra;Ke<Li;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}v.offset+=Ne&(1<<v.extra)-1,Ne>>>=v.extra,Ke-=v.extra,v.back+=v.extra}if(v.offset>v.dmax){f.msg="invalid distance too far back",v.mode=Pe;break}v.mode=16204;case 16204:if(gt===0)break e;if(_t=Wt-gt,v.offset>_t){if(_t=v.offset-_t,_t>v.whave&&v.sane){f.msg="invalid distance too far back",v.mode=Pe;break}_t>v.wnext?(_t-=v.wnext,si=v.wsize-_t):si=v.wnext-_t,_t>v.length&&(_t=v.length),Mr=v.window}else Mr=_e,si=Xe-v.offset,_t=v.length;_t>gt&&(_t=gt),gt-=_t,v.length-=_t;do _e[Xe++]=Mr[si++];while(--_t);v.length===0&&(v.mode=le);break;case 16205:if(gt===0)break e;_e[Xe++]=v.length,gt--,v.mode=le;break;case ye:if(v.wrap){for(;Ke<32;){if(ze===0)break e;ze--,Ne|=we[ve++]<<Ke,Ke+=8}if(Wt-=gt,f.total_out+=Wt,v.total+=Wt,4&v.wrap&&Wt&&(f.adler=v.check=v.flags?Ue(v.check,_e,Wt,Xe-Wt):Ae(v.check,_e,Wt,Xe-Wt)),Wt=gt,4&v.wrap&&(v.flags?Ne:Te(Ne))!==v.check){f.msg="incorrect data check",v.mode=Pe;break}Ne=0,Ke=0}v.mode=16207;case 16207:if(v.wrap&&v.flags){for(;Ke<32;){if(ze===0)break e;ze--,Ne+=we[ve++]<<Ke,Ke+=8}if(4&v.wrap&&Ne!==(4294967295&v.total)){f.msg="incorrect length check",v.mode=Pe;break}Ne=0,Ke=0}v.mode=16208;case 16208:Sr=E;break e;case Pe:Sr=D;break e;case 16210:return $;default:return k}return f.next_out=Xe,f.avail_out=gt,f.next_in=ve,f.avail_in=ze,v.hold=Ne,v.bits=Ke,(v.wsize||Wt!==f.avail_out&&v.mode<Pe&&(v.mode<ye||K!==c))&&Be(f,f.output,f.next_out,Wt-f.avail_out),dr-=f.avail_in,Wt-=f.avail_out,f.total_in+=dr,f.total_out+=Wt,v.total+=Wt,4&v.wrap&&Wt&&(f.adler=v.check=v.flags?Ue(v.check,_e,Wt,f.next_out-Wt):Ae(v.check,_e,Wt,f.next_out-Wt)),f.data_type=v.bits+(v.last?64:0)+(v.mode===Y?128:0)+(v.mode===de||v.mode===te?256:0),(dr===0&&Wt===0||K===c)&&Sr===C&&(Sr=U),Sr},inflateEnd:f=>{if(be(f))return k;let K=f.state;return K.window&&(K.window=null),f.state=null,C},inflateGetHeader:(f,K)=>{if(be(f))return k;const v=f.state;return 2&v.wrap?(v.head=K,K.done=!1,C):k},inflateSetDictionary:(f,K)=>{const v=K.length;let we,_e,ve;return be(f)?k:(we=f.state,we.wrap!==0&&we.mode!==H?k:we.mode===H&&(_e=1,_e=Ae(_e,K,v,0),_e!==we.check)?D:(ve=Be(f,K,v,v),ve?(we.mode=16210,$):(we.havedict=1,C)))},inflateInfo:"pako inflate (from Nodeca project)"},St=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const ot=Object.prototype.toString,{Z_NO_FLUSH:bt,Z_FINISH:At,Z_OK:it,Z_STREAM_END:Rt,Z_NEED_DICT:Ht,Z_STREAM_ERROR:kt,Z_DATA_ERROR:ct,Z_MEM_ERROR:Jt}=rt;function Nt(f){this.options=Kr({chunkSize:65536,windowBits:15,to:""},f||{});const K=this.options;K.raw&&K.windowBits>=0&&K.windowBits<16&&(K.windowBits=-K.windowBits,K.windowBits===0&&(K.windowBits=-15)),!(K.windowBits>=0&&K.windowBits<16)||f&&f.windowBits||(K.windowBits+=32),K.windowBits>15&&K.windowBits<48&&(15&K.windowBits||(K.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Oe,this.strm.avail_out=0;let v=et.inflateInit2(this.strm,K.windowBits);if(v!==it)throw new Error(Ie[v]);if(this.header=new St,et.inflateGetHeader(this.strm,this.header),K.dictionary&&(typeof K.dictionary=="string"?K.dictionary=ie(K.dictionary):ot.call(K.dictionary)==="[object ArrayBuffer]"&&(K.dictionary=new Uint8Array(K.dictionary)),K.raw&&(v=et.inflateSetDictionary(this.strm,K.dictionary),v!==it)))throw new Error(Ie[v])}function Zt(f,K){const v=new Nt(K);if(v.push(f),v.err)throw v.msg||Ie[v.err];return v.result}Nt.prototype.push=function(f,K){const v=this.strm,we=this.options.chunkSize,_e=this.options.dictionary;let ve,Xe,ze;if(this.ended)return!1;for(Xe=K===~~K?K:K===!0?At:bt,ot.call(f)==="[object ArrayBuffer]"?v.input=new Uint8Array(f):v.input=f,v.next_in=0,v.avail_in=v.input.length;;){for(v.avail_out===0&&(v.output=new Uint8Array(we),v.next_out=0,v.avail_out=we),ve=et.inflate(v,Xe),ve===Ht&&_e&&(ve=et.inflateSetDictionary(v,_e),ve===it?ve=et.inflate(v,Xe):ve===ct&&(ve=Ht));v.avail_in>0&&ve===Rt&&v.state.wrap>0&&f[v.next_in]!==0;)et.inflateReset(v),ve=et.inflate(v,Xe);switch(ve){case kt:case ct:case Ht:case Jt:return this.onEnd(ve),this.ended=!0,!1}if(ze=v.avail_out,v.next_out&&(v.avail_out===0||ve===Rt))if(this.options.to==="string"){let gt=Ve(v.output,v.next_out),Ne=v.next_out-gt,Ke=xe(v.output,gt);v.next_out=Ne,v.avail_out=we-Ne,Ne&&v.output.set(v.output.subarray(gt,gt+Ne),0),this.onData(Ke)}else this.onData(v.output.length===v.next_out?v.output:v.output.subarray(0,v.next_out));if(ve!==it||ze!==0){if(ve===Rt)return ve=et.inflateEnd(this.strm),this.onEnd(ve),this.ended=!0,!0;if(v.avail_in===0)break}}return!0},Nt.prototype.onData=function(f){this.chunks.push(f)},Nt.prototype.onEnd=function(f){f===it&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Zi(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg};var Vt={Inflate:Nt,inflate:Zt,inflateRaw:function(f,K){return(K=K||{}).raw=!0,Zt(f,K)},ungzip:Zt};const{Deflate:Xt,deflate:yr,deflateRaw:Fr,gzip:Tr}=Or,{Inflate:ii,inflate:Wr,inflateRaw:wr,ungzip:$r}=Vt;var ci=Xt,ni=yr,hi=Fr,zi=Tr,xi=ii,Ii=Wr,Hr=wr,Xr=$r,Zr=rt,ei={Deflate:Xt,deflate:yr,deflateRaw:Fr,gzip:Tr,Inflate:ii,inflate:Wr,inflateRaw:wr,ungzip:$r,constants:rt}},99:(i,n,a)=>{a.r(n),a.d(n,{Cylinder:()=>u,Sphere:()=>m,Triangle:()=>p});var h=a(529);class m{constructor(M={x:0,y:0,z:0},b=0){this.center=new h.Vector3(M.x,M.y,M.z),this.radius=b}set(M,b){return this.center.copy(M),this.radius=b,this}copy(M){return this.center.copy(M.center),this.radius=M.radius,this}applyMatrix4(M){return this.center.applyMatrix4(M),this.radius=this.radius*M.getMaxScaleOnAxis(),this}translate(M){return this.center.add(M),this}equals(M){return M.center.equals(this.center)&&M.radius===this.radius}clone(){return new m().copy(this)}}let z=new h.Vector3;class u{constructor(M=new h.Vector3,b=new h.Vector3,I=0){this.c1=M,this.c2=b,this.radius=I,this.direction=new h.Vector3().subVectors(this.c2,this.c1).normalize()}copy(M){return this.c1.copy(M.c1),this.c2.copy(M.c2),this.direction.copy(M.direction),this.radius=M.radius,this}lengthSq(){return z.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(M){return this.direction.add(this.c1).applyMatrix4(M),this.c1.applyMatrix4(M),this.c2.applyMatrix4(M),this.direction.sub(this.c1).normalize(),this.radius=this.radius*M.getMaxScaleOnAxis(),this}}const y=new h.Vector3;class p{constructor(M=new h.Vector3,b=new h.Vector3,I=new h.Vector3){this.a=M,this.b=b,this.c=I}copy(M){return this.a.copy(M.a),this.b.copy(M.b),this.c.copy(M.c),this}applyMatrix4(M){return this.a.applyMatrix4(M),this.b.applyMatrix4(M),this.c.applyMatrix4(M),this}getNormal(){var M=this.a.clone();return M.sub(this.b),y.subVectors(this.c,this.b),M.cross(y),M.normalize(),M}}},107:(i,n,a)=>{var h,m=a(981),z=a(697),u=a(701),y=a(407),p=a(834),w=-2,M=258,b=262,I=103,O=113,T=666;function L(P,ce){return P.msg=p[ce],ce}function Q(P){return(P<<1)-(P>4?9:0)}function ne(P){for(var ce=P.length;--ce>=0;)P[ce]=0}function Z(P){var ce=P.state,se=ce.pending;se>P.avail_out&&(se=P.avail_out),se!==0&&(m.arraySet(P.output,ce.pending_buf,ce.pending_out,se,P.next_out),P.next_out+=se,ce.pending_out+=se,P.total_out+=se,P.avail_out-=se,ce.pending-=se,ce.pending===0&&(ce.pending_out=0))}function _(P,ce){z._tr_flush_block(P,P.block_start>=0?P.block_start:-1,P.strstart-P.block_start,ce),P.block_start=P.strstart,Z(P.strm)}function F(P,ce){P.pending_buf[P.pending++]=ce}function j(P,ce){P.pending_buf[P.pending++]=ce>>>8&255,P.pending_buf[P.pending++]=255&ce}function G(P,ce,se,X){var Re=P.avail_in;return Re>X&&(Re=X),Re===0?0:(P.avail_in-=Re,m.arraySet(ce,P.input,P.next_in,Re,se),P.state.wrap===1?P.adler=u(P.adler,ce,Re,se):P.state.wrap===2&&(P.adler=y(P.adler,ce,Re,se)),P.next_in+=Re,P.total_in+=Re,Re)}function q(P,ce){var se,X,Re=P.max_chain_length,fe=P.strstart,De=P.prev_length,We=P.nice_match,oe=P.strstart>P.w_size-b?P.strstart-(P.w_size-b):0,Ae=P.window,He=P.w_mask,Ue=P.prev,Ie=P.strstart+M,rt=Ae[fe+De-1],st=Ae[fe+De];P.prev_length>=P.good_match&&(Re>>=2),We>P.lookahead&&(We=P.lookahead);do if(Ae[(se=ce)+De]===st&&Ae[se+De-1]===rt&&Ae[se]===Ae[fe]&&Ae[++se]===Ae[fe+1]){fe+=2,se++;do;while(Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&fe<Ie);if(X=M-(Ie-fe),fe=Ie-M,X>De){if(P.match_start=ce,De=X,X>=We)break;rt=Ae[fe+De-1],st=Ae[fe+De]}}while((ce=Ue[ce&He])>oe&&--Re!==0);return De<=P.lookahead?De:P.lookahead}function N(P){var ce,se,X,Re,fe,De=P.w_size;do{if(Re=P.window_size-P.lookahead-P.strstart,P.strstart>=De+(De-b)){m.arraySet(P.window,P.window,De,De,0),P.match_start-=De,P.strstart-=De,P.block_start-=De,ce=se=P.hash_size;do X=P.head[--ce],P.head[ce]=X>=De?X-De:0;while(--se);ce=se=De;do X=P.prev[--ce],P.prev[ce]=X>=De?X-De:0;while(--se);Re+=De}if(P.strm.avail_in===0)break;if(se=G(P.strm,P.window,P.strstart+P.lookahead,Re),P.lookahead+=se,P.lookahead+P.insert>=3)for(fe=P.strstart-P.insert,P.ins_h=P.window[fe],P.ins_h=(P.ins_h<<P.hash_shift^P.window[fe+1])&P.hash_mask;P.insert&&(P.ins_h=(P.ins_h<<P.hash_shift^P.window[fe+3-1])&P.hash_mask,P.prev[fe&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=fe,fe++,P.insert--,!(P.lookahead+P.insert<3)););}while(P.lookahead<b&&P.strm.avail_in!==0)}function ee(P,ce){for(var se,X;;){if(P.lookahead<b){if(N(P),P.lookahead<b&&ce===0)return 1;if(P.lookahead===0)break}if(se=0,P.lookahead>=3&&(P.ins_h=(P.ins_h<<P.hash_shift^P.window[P.strstart+3-1])&P.hash_mask,se=P.prev[P.strstart&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=P.strstart),se!==0&&P.strstart-se<=P.w_size-b&&(P.match_length=q(P,se)),P.match_length>=3)if(X=z._tr_tally(P,P.strstart-P.match_start,P.match_length-3),P.lookahead-=P.match_length,P.match_length<=P.max_lazy_match&&P.lookahead>=3){P.match_length--;do P.strstart++,P.ins_h=(P.ins_h<<P.hash_shift^P.window[P.strstart+3-1])&P.hash_mask,se=P.prev[P.strstart&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=P.strstart;while(--P.match_length!==0);P.strstart++}else P.strstart+=P.match_length,P.match_length=0,P.ins_h=P.window[P.strstart],P.ins_h=(P.ins_h<<P.hash_shift^P.window[P.strstart+1])&P.hash_mask;else X=z._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++;if(X&&(_(P,!1),P.strm.avail_out===0))return 1}return P.insert=P.strstart<2?P.strstart:2,ce===4?(_(P,!0),P.strm.avail_out===0?3:4):P.last_lit&&(_(P,!1),P.strm.avail_out===0)?1:2}function Ce(P,ce){for(var se,X,Re;;){if(P.lookahead<b){if(N(P),P.lookahead<b&&ce===0)return 1;if(P.lookahead===0)break}if(se=0,P.lookahead>=3&&(P.ins_h=(P.ins_h<<P.hash_shift^P.window[P.strstart+3-1])&P.hash_mask,se=P.prev[P.strstart&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=P.strstart),P.prev_length=P.match_length,P.prev_match=P.match_start,P.match_length=2,se!==0&&P.prev_length<P.max_lazy_match&&P.strstart-se<=P.w_size-b&&(P.match_length=q(P,se),P.match_length<=5&&(P.strategy===1||P.match_length===3&&P.strstart-P.match_start>4096)&&(P.match_length=2)),P.prev_length>=3&&P.match_length<=P.prev_length){Re=P.strstart+P.lookahead-3,X=z._tr_tally(P,P.strstart-1-P.prev_match,P.prev_length-3),P.lookahead-=P.prev_length-1,P.prev_length-=2;do++P.strstart<=Re&&(P.ins_h=(P.ins_h<<P.hash_shift^P.window[P.strstart+3-1])&P.hash_mask,se=P.prev[P.strstart&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=P.strstart);while(--P.prev_length!==0);if(P.match_available=0,P.match_length=2,P.strstart++,X&&(_(P,!1),P.strm.avail_out===0))return 1}else if(P.match_available){if((X=z._tr_tally(P,0,P.window[P.strstart-1]))&&_(P,!1),P.strstart++,P.lookahead--,P.strm.avail_out===0)return 1}else P.match_available=1,P.strstart++,P.lookahead--}return P.match_available&&(X=z._tr_tally(P,0,P.window[P.strstart-1]),P.match_available=0),P.insert=P.strstart<2?P.strstart:2,ce===4?(_(P,!0),P.strm.avail_out===0?3:4):P.last_lit&&(_(P,!1),P.strm.avail_out===0)?1:2}function he(P,ce,se,X,Re){this.good_length=P,this.max_lazy=ce,this.nice_length=se,this.max_chain=X,this.func=Re}function ge(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new m.Buf16(1146),this.dyn_dtree=new m.Buf16(122),this.bl_tree=new m.Buf16(78),ne(this.dyn_ltree),ne(this.dyn_dtree),ne(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new m.Buf16(16),this.heap=new m.Buf16(573),ne(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new m.Buf16(573),ne(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function me(P){var ce;return P&&P.state?(P.total_in=P.total_out=0,P.data_type=2,(ce=P.state).pending=0,ce.pending_out=0,ce.wrap<0&&(ce.wrap=-ce.wrap),ce.status=ce.wrap?42:O,P.adler=ce.wrap===2?0:1,ce.last_flush=0,z._tr_init(ce),0):L(P,w)}function Me(P){var ce,se=me(P);return se===0&&((ce=P.state).window_size=2*ce.w_size,ne(ce.head),ce.max_lazy_match=h[ce.level].max_lazy,ce.good_match=h[ce.level].good_length,ce.nice_match=h[ce.level].nice_length,ce.max_chain_length=h[ce.level].max_chain,ce.strstart=0,ce.block_start=0,ce.lookahead=0,ce.insert=0,ce.match_length=ce.prev_length=2,ce.match_available=0,ce.ins_h=0),se}function ue(P,ce,se,X,Re,fe){if(!P)return w;var De=1;if(ce===-1&&(ce=6),X<0?(De=0,X=-X):X>15&&(De=2,X-=16),Re<1||Re>9||se!==8||X<8||X>15||ce<0||ce>9||fe<0||fe>4)return L(P,w);X===8&&(X=9);var We=new ge;return P.state=We,We.strm=P,We.wrap=De,We.gzhead=null,We.w_bits=X,We.w_size=1<<We.w_bits,We.w_mask=We.w_size-1,We.hash_bits=Re+7,We.hash_size=1<<We.hash_bits,We.hash_mask=We.hash_size-1,We.hash_shift=~~((We.hash_bits+3-1)/3),We.window=new m.Buf8(2*We.w_size),We.head=new m.Buf16(We.hash_size),We.prev=new m.Buf16(We.w_size),We.lit_bufsize=1<<Re+6,We.pending_buf_size=4*We.lit_bufsize,We.pending_buf=new m.Buf8(We.pending_buf_size),We.d_buf=1*We.lit_bufsize,We.l_buf=3*We.lit_bufsize,We.level=ce,We.strategy=fe,We.method=se,Me(P)}h=[new he(0,0,0,0,function(P,ce){var se=65535;for(se>P.pending_buf_size-5&&(se=P.pending_buf_size-5);;){if(P.lookahead<=1){if(N(P),P.lookahead===0&&ce===0)return 1;if(P.lookahead===0)break}P.strstart+=P.lookahead,P.lookahead=0;var X=P.block_start+se;if((P.strstart===0||P.strstart>=X)&&(P.lookahead=P.strstart-X,P.strstart=X,_(P,!1),P.strm.avail_out===0)||P.strstart-P.block_start>=P.w_size-b&&(_(P,!1),P.strm.avail_out===0))return 1}return P.insert=0,ce===4?(_(P,!0),P.strm.avail_out===0?3:4):(P.strstart>P.block_start&&(_(P,!1),P.strm.avail_out),1)}),new he(4,4,8,4,ee),new he(4,5,16,8,ee),new he(4,6,32,32,ee),new he(4,4,16,16,Ce),new he(8,16,32,32,Ce),new he(8,16,128,128,Ce),new he(8,32,128,256,Ce),new he(32,128,258,1024,Ce),new he(32,258,258,4096,Ce)],n.deflateInit=function(P,ce){return ue(P,ce,8,15,8,0)},n.deflateInit2=ue,n.deflateReset=Me,n.deflateResetKeep=me,n.deflateSetHeader=function(P,ce){return P&&P.state?P.state.wrap!==2?w:(P.state.gzhead=ce,0):w},n.deflate=function(P,ce){var se,X,Re,fe;if(!P||!P.state||ce>5||ce<0)return P?L(P,w):w;if(X=P.state,!P.output||!P.input&&P.avail_in!==0||X.status===T&&ce!==4)return L(P,P.avail_out===0?-5:w);if(X.strm=P,se=X.last_flush,X.last_flush=ce,X.status===42)if(X.wrap===2)P.adler=0,F(X,31),F(X,139),F(X,8),X.gzhead?(F(X,(X.gzhead.text?1:0)+(X.gzhead.hcrc?2:0)+(X.gzhead.extra?4:0)+(X.gzhead.name?8:0)+(X.gzhead.comment?16:0)),F(X,255&X.gzhead.time),F(X,X.gzhead.time>>8&255),F(X,X.gzhead.time>>16&255),F(X,X.gzhead.time>>24&255),F(X,X.level===9?2:X.strategy>=2||X.level<2?4:0),F(X,255&X.gzhead.os),X.gzhead.extra&&X.gzhead.extra.length&&(F(X,255&X.gzhead.extra.length),F(X,X.gzhead.extra.length>>8&255)),X.gzhead.hcrc&&(P.adler=y(P.adler,X.pending_buf,X.pending,0)),X.gzindex=0,X.status=69):(F(X,0),F(X,0),F(X,0),F(X,0),F(X,0),F(X,X.level===9?2:X.strategy>=2||X.level<2?4:0),F(X,3),X.status=O);else{var De=8+(X.w_bits-8<<4)<<8;De|=(X.strategy>=2||X.level<2?0:X.level<6?1:X.level===6?2:3)<<6,X.strstart!==0&&(De|=32),De+=31-De%31,X.status=O,j(X,De),X.strstart!==0&&(j(X,P.adler>>>16),j(X,65535&P.adler)),P.adler=1}if(X.status===69)if(X.gzhead.extra){for(Re=X.pending;X.gzindex<(65535&X.gzhead.extra.length)&&(X.pending!==X.pending_buf_size||(X.gzhead.hcrc&&X.pending>Re&&(P.adler=y(P.adler,X.pending_buf,X.pending-Re,Re)),Z(P),Re=X.pending,X.pending!==X.pending_buf_size));)F(X,255&X.gzhead.extra[X.gzindex]),X.gzindex++;X.gzhead.hcrc&&X.pending>Re&&(P.adler=y(P.adler,X.pending_buf,X.pending-Re,Re)),X.gzindex===X.gzhead.extra.length&&(X.gzindex=0,X.status=73)}else X.status=73;if(X.status===73)if(X.gzhead.name){Re=X.pending;do{if(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>Re&&(P.adler=y(P.adler,X.pending_buf,X.pending-Re,Re)),Z(P),Re=X.pending,X.pending===X.pending_buf_size)){fe=1;break}fe=X.gzindex<X.gzhead.name.length?255&X.gzhead.name.charCodeAt(X.gzindex++):0,F(X,fe)}while(fe!==0);X.gzhead.hcrc&&X.pending>Re&&(P.adler=y(P.adler,X.pending_buf,X.pending-Re,Re)),fe===0&&(X.gzindex=0,X.status=91)}else X.status=91;if(X.status===91)if(X.gzhead.comment){Re=X.pending;do{if(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>Re&&(P.adler=y(P.adler,X.pending_buf,X.pending-Re,Re)),Z(P),Re=X.pending,X.pending===X.pending_buf_size)){fe=1;break}fe=X.gzindex<X.gzhead.comment.length?255&X.gzhead.comment.charCodeAt(X.gzindex++):0,F(X,fe)}while(fe!==0);X.gzhead.hcrc&&X.pending>Re&&(P.adler=y(P.adler,X.pending_buf,X.pending-Re,Re)),fe===0&&(X.status=I)}else X.status=I;if(X.status===I&&(X.gzhead.hcrc?(X.pending+2>X.pending_buf_size&&Z(P),X.pending+2<=X.pending_buf_size&&(F(X,255&P.adler),F(X,P.adler>>8&255),P.adler=0,X.status=O)):X.status=O),X.pending!==0){if(Z(P),P.avail_out===0)return X.last_flush=-1,0}else if(P.avail_in===0&&Q(ce)<=Q(se)&&ce!==4)return L(P,-5);if(X.status===T&&P.avail_in!==0)return L(P,-5);if(P.avail_in!==0||X.lookahead!==0||ce!==0&&X.status!==T){var We=X.strategy===2?(function(oe,Ae){for(var He;;){if(oe.lookahead===0&&(N(oe),oe.lookahead===0)){if(Ae===0)return 1;break}if(oe.match_length=0,He=z._tr_tally(oe,0,oe.window[oe.strstart]),oe.lookahead--,oe.strstart++,He&&(_(oe,!1),oe.strm.avail_out===0))return 1}return oe.insert=0,Ae===4?(_(oe,!0),oe.strm.avail_out===0?3:4):oe.last_lit&&(_(oe,!1),oe.strm.avail_out===0)?1:2})(X,ce):X.strategy===3?(function(oe,Ae){for(var He,Ue,Ie,rt,st=oe.window;;){if(oe.lookahead<=M){if(N(oe),oe.lookahead<=M&&Ae===0)return 1;if(oe.lookahead===0)break}if(oe.match_length=0,oe.lookahead>=3&&oe.strstart>0&&(Ue=st[Ie=oe.strstart-1])===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]){rt=oe.strstart+M;do;while(Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ie<rt);oe.match_length=M-(rt-Ie),oe.match_length>oe.lookahead&&(oe.match_length=oe.lookahead)}if(oe.match_length>=3?(He=z._tr_tally(oe,1,oe.match_length-3),oe.lookahead-=oe.match_length,oe.strstart+=oe.match_length,oe.match_length=0):(He=z._tr_tally(oe,0,oe.window[oe.strstart]),oe.lookahead--,oe.strstart++),He&&(_(oe,!1),oe.strm.avail_out===0))return 1}return oe.insert=0,Ae===4?(_(oe,!0),oe.strm.avail_out===0?3:4):oe.last_lit&&(_(oe,!1),oe.strm.avail_out===0)?1:2})(X,ce):h[X.level].func(X,ce);if(We!==3&&We!==4||(X.status=T),We===1||We===3)return P.avail_out===0&&(X.last_flush=-1),0;if(We===2&&(ce===1?z._tr_align(X):ce!==5&&(z._tr_stored_block(X,0,0,!1),ce===3&&(ne(X.head),X.lookahead===0&&(X.strstart=0,X.block_start=0,X.insert=0))),Z(P),P.avail_out===0))return X.last_flush=-1,0}return ce!==4?0:X.wrap<=0?1:(X.wrap===2?(F(X,255&P.adler),F(X,P.adler>>8&255),F(X,P.adler>>16&255),F(X,P.adler>>24&255),F(X,255&P.total_in),F(X,P.total_in>>8&255),F(X,P.total_in>>16&255),F(X,P.total_in>>24&255)):(j(X,P.adler>>>16),j(X,65535&P.adler)),Z(P),X.wrap>0&&(X.wrap=-X.wrap),X.pending!==0?0:1)},n.deflateEnd=function(P){var ce;return P&&P.state?(ce=P.state.status)!==42&&ce!==69&&ce!==73&&ce!==91&&ce!==I&&ce!==O&&ce!==T?L(P,w):(P.state=null,ce===O?L(P,-3):0):w},n.deflateSetDictionary=function(P,ce){var se,X,Re,fe,De,We,oe,Ae,He=ce.length;if(!P||!P.state||(fe=(se=P.state).wrap)===2||fe===1&&se.status!==42||se.lookahead)return w;for(fe===1&&(P.adler=u(P.adler,ce,He,0)),se.wrap=0,He>=se.w_size&&(fe===0&&(ne(se.head),se.strstart=0,se.block_start=0,se.insert=0),Ae=new m.Buf8(se.w_size),m.arraySet(Ae,ce,He-se.w_size,se.w_size,0),ce=Ae,He=se.w_size),De=P.avail_in,We=P.next_in,oe=P.input,P.avail_in=He,P.next_in=0,P.input=ce,N(se);se.lookahead>=3;){X=se.strstart,Re=se.lookahead-2;do se.ins_h=(se.ins_h<<se.hash_shift^se.window[X+3-1])&se.hash_mask,se.prev[X&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=X,X++;while(--Re);se.strstart=X,se.lookahead=2,N(se)}return se.strstart+=se.lookahead,se.block_start=se.strstart,se.insert=se.lookahead,se.lookahead=0,se.match_length=se.prev_length=2,se.match_available=0,P.next_in=We,P.input=oe,P.avail_in=De,se.wrap=fe,0},n.deflateInfo="pako deflate (from Nodeca project)"},111:(i,n,a)=>{var h;h={},i.exports=h,(function(m,z){m.toRGBA8=function(u){var y=u.width,p=u.height;if(u.tabs.acTL==null)return[m.toRGBA8.decodeImage(u.data,y,p,u).buffer];var w=[];u.frames[0].data==null&&(u.frames[0].data=u.data);for(var M,b=new Uint8Array(y*p*4),I=0;I<u.frames.length;I++){var O=u.frames[I],T=O.rect.x,L=O.rect.y,Q=O.rect.width,ne=O.rect.height,Z=m.toRGBA8.decodeImage(O.data,Q,ne,u);if(I==0?M=Z:O.blend==0?m._copyTile(Z,Q,ne,M,y,p,T,L,0):O.blend==1&&m._copyTile(Z,Q,ne,M,y,p,T,L,1),w.push(M.buffer),M=M.slice(0),O.dispose!=0){if(O.dispose==1)m._copyTile(b,Q,ne,M,y,p,T,L,0);else if(O.dispose==2){for(var _=I-1;u.frames[_].dispose==2;)_--;M=new Uint8Array(w[_]).slice(0)}}}return w},m.toRGBA8.decodeImage=function(u,y,p,w){var M=y*p,b=m.decode._getBPP(w),I=Math.ceil(y*b/8),O=new Uint8Array(4*M),T=new Uint32Array(O.buffer),L=w.ctype,Q=w.depth,ne=m._bin.readUshort;if(L==6){var Z=M<<2;if(Q==8)for(var _=0;_<Z;_++)O[_]=u[_];if(Q==16)for(_=0;_<Z;_++)O[_]=u[_<<1]}else if(L==2){var F=w.tabs.tRNS,j=-1,G=-1,q=-1;if(F&&(j=F[0],G=F[1],q=F[2]),Q==8)for(_=0;_<M;_++){var N=3*_;O[ue=_<<2]=u[N],O[ue+1]=u[N+1],O[ue+2]=u[N+2],O[ue+3]=255,j!=-1&&u[N]==j&&u[N+1]==G&&u[N+2]==q&&(O[ue+3]=0)}if(Q==16)for(_=0;_<M;_++)N=6*_,O[ue=_<<2]=u[N],O[ue+1]=u[N+2],O[ue+2]=u[N+4],O[ue+3]=255,j!=-1&&ne(u,N)==j&&ne(u,N+2)==G&&ne(u,N+4)==q&&(O[ue+3]=0)}else if(L==3){var ee=w.tabs.PLTE,Ce=w.tabs.tRNS,he=Ce?Ce.length:0;if(Q==1)for(var ge=0;ge<p;ge++){var me=ge*I,Me=ge*y;for(_=0;_<y;_++){var ue=Me+_<<2,P=3*(ce=u[me+(_>>3)]>>7-(7&_)&1);O[ue]=ee[P],O[ue+1]=ee[P+1],O[ue+2]=ee[P+2],O[ue+3]=ce<he?Ce[ce]:255}}if(Q==2)for(ge=0;ge<p;ge++)for(me=ge*I,Me=ge*y,_=0;_<y;_++)ue=Me+_<<2,P=3*(ce=u[me+(_>>2)]>>6-((3&_)<<1)&3),O[ue]=ee[P],O[ue+1]=ee[P+1],O[ue+2]=ee[P+2],O[ue+3]=ce<he?Ce[ce]:255;if(Q==4)for(ge=0;ge<p;ge++)for(me=ge*I,Me=ge*y,_=0;_<y;_++)ue=Me+_<<2,P=3*(ce=u[me+(_>>1)]>>4-((1&_)<<2)&15),O[ue]=ee[P],O[ue+1]=ee[P+1],O[ue+2]=ee[P+2],O[ue+3]=ce<he?Ce[ce]:255;if(Q==8)for(_=0;_<M;_++){var ce;ue=_<<2,P=3*(ce=u[_]),O[ue]=ee[P],O[ue+1]=ee[P+1],O[ue+2]=ee[P+2],O[ue+3]=ce<he?Ce[ce]:255}}else if(L==4){if(Q==8)for(_=0;_<M;_++){ue=_<<2;var se=u[X=_<<1];O[ue]=se,O[ue+1]=se,O[ue+2]=se,O[ue+3]=u[X+1]}if(Q==16)for(_=0;_<M;_++){var X;ue=_<<2,se=u[X=_<<2],O[ue]=se,O[ue+1]=se,O[ue+2]=se,O[ue+3]=u[X+2]}}else if(L==0){if(j=w.tabs.tRNS?w.tabs.tRNS:-1,Q==1)for(_=0;_<M;_++){var Re=(se=255*(u[_>>3]>>7-(7&_)&1))==255*j?0:255;T[_]=Re<<24|se<<16|se<<8|se}if(Q==2)for(_=0;_<M;_++)Re=(se=85*(u[_>>2]>>6-((3&_)<<1)&3))==85*j?0:255,T[_]=Re<<24|se<<16|se<<8|se;if(Q==4)for(_=0;_<M;_++)Re=(se=17*(u[_>>1]>>4-((1&_)<<2)&15))==17*j?0:255,T[_]=Re<<24|se<<16|se<<8|se;if(Q==8)for(_=0;_<M;_++)Re=(se=u[_])==j?0:255,T[_]=Re<<24|se<<16|se<<8|se;if(Q==16)for(_=0;_<M;_++)se=u[_<<1],Re=ne(u,_<<1)==j?0:255,T[_]=Re<<24|se<<16|se<<8|se}return O},m.decode=function(u){for(var y,p=new Uint8Array(u),w=8,M=m._bin,b=M.readUshort,I=M.readUint,O={tabs:{},frames:[]},T=new Uint8Array(p.length),L=0,Q=0,ne=[137,80,78,71,13,10,26,10],Z=0;Z<8;Z++)if(p[Z]!=ne[Z])throw"The input is not a PNG file!";for(;w<p.length;){var _=M.readUint(p,w);w+=4;var F=M.readASCII(p,w,4);if(w+=4,F=="IHDR")m.decode._IHDR(p,w,O);else if(F=="IDAT"){for(Z=0;Z<_;Z++)T[L+Z]=p[w+Z];L+=_}else if(F=="acTL")O.tabs[F]={num_frames:I(p,w),num_plays:I(p,w+4)},y=new Uint8Array(p.length);else if(F=="fcTL"){Q!=0&&((me=O.frames[O.frames.length-1]).data=m.decode._decompress(O,y.slice(0,Q),me.rect.width,me.rect.height),Q=0);var j={x:I(p,w+12),y:I(p,w+16),width:I(p,w+4),height:I(p,w+8)},G=b(p,w+22);G=b(p,w+20)/(G==0?100:G);var q={rect:j,delay:Math.round(1e3*G),dispose:p[w+24],blend:p[w+25]};O.frames.push(q)}else if(F=="fdAT"){for(Z=0;Z<_-4;Z++)y[Q+Z]=p[w+Z+4];Q+=_-4}else if(F=="pHYs")O.tabs[F]=[M.readUint(p,w),M.readUint(p,w+4),p[w+8]];else if(F=="cHRM")for(O.tabs[F]=[],Z=0;Z<8;Z++)O.tabs[F].push(M.readUint(p,w+4*Z));else if(F=="tEXt"){O.tabs[F]==null&&(O.tabs[F]={});var N=M.nextZero(p,w),ee=M.readASCII(p,w,N-w),Ce=M.readASCII(p,N+1,w+_-N-1);O.tabs[F][ee]=Ce}else if(F=="iTXt"){O.tabs[F]==null&&(O.tabs[F]={}),N=0;var he=w;N=M.nextZero(p,he),ee=M.readASCII(p,he,N-he),p[he=N+1],p[he+1],he+=2,N=M.nextZero(p,he),M.readASCII(p,he,N-he),he=N+1,N=M.nextZero(p,he),M.readUTF8(p,he,N-he),he=N+1,Ce=M.readUTF8(p,he,_-(he-w)),O.tabs[F][ee]=Ce}else if(F=="PLTE")O.tabs[F]=M.readBytes(p,w,_);else if(F=="hIST"){var ge=O.tabs.PLTE.length/3;for(O.tabs[F]=[],Z=0;Z<ge;Z++)O.tabs[F].push(b(p,w+2*Z))}else if(F=="tRNS")O.ctype==3?O.tabs[F]=M.readBytes(p,w,_):O.ctype==0?O.tabs[F]=b(p,w):O.ctype==2&&(O.tabs[F]=[b(p,w),b(p,w+2),b(p,w+4)]);else if(F=="gAMA")O.tabs[F]=M.readUint(p,w)/1e5;else if(F=="sRGB")O.tabs[F]=p[w];else if(F=="bKGD")O.ctype==0||O.ctype==4?O.tabs[F]=[b(p,w)]:O.ctype==2||O.ctype==6?O.tabs[F]=[b(p,w),b(p,w+2),b(p,w+4)]:O.ctype==3&&(O.tabs[F]=p[w]);else if(F=="IEND"){var me;Q!=0&&((me=O.frames[O.frames.length-1]).data=m.decode._decompress(O,y.slice(0,Q),me.rect.width,me.rect.height),Q=0),O.data=m.decode._decompress(O,T,O.width,O.height);break}w+=_,M.readUint(p,w),w+=4}return delete O.compress,delete O.interlace,delete O.filter,O},m.decode._decompress=function(u,y,p,w){return u.compress==0&&(y=m.decode._inflate(y)),u.interlace==0?y=m.decode._filterZero(y,u,0,p,w):u.interlace==1&&(y=m.decode._readInterlace(y,u)),y},m.decode._inflate=function(u){return z.inflate(u)},m.decode._readInterlace=function(u,y){for(var p=y.width,w=y.height,M=m.decode._getBPP(y),b=M>>3,I=Math.ceil(p*M/8),O=new Uint8Array(w*I),T=0,L=[0,0,4,0,2,0,1],Q=[0,4,0,2,0,1,0],ne=[8,8,8,4,4,2,2],Z=[8,8,4,4,2,2,1],_=0;_<7;){for(var F=ne[_],j=Z[_],G=0,q=0,N=L[_];N<w;)N+=F,q++;for(var ee=Q[_];ee<p;)ee+=j,G++;var Ce=Math.ceil(G*M/8);m.decode._filterZero(u,y,T,G,q);for(var he=0,ge=L[_];ge<w;){for(var me=Q[_],Me=T+he*Ce<<3;me<p;){var ue;if(M==1&&(ue=(ue=u[Me>>3])>>7-(7&Me)&1,O[ge*I+(me>>3)]|=ue<<7-(3&me)),M==2&&(ue=(ue=u[Me>>3])>>6-(7&Me)&3,O[ge*I+(me>>2)]|=ue<<6-((3&me)<<1)),M==4&&(ue=(ue=u[Me>>3])>>4-(7&Me)&15,O[ge*I+(me>>1)]|=ue<<4-((1&me)<<2)),M>=8)for(var P=ge*I+me*b,ce=0;ce<b;ce++)O[P+ce]=u[(Me>>3)+ce];Me+=M,me+=j}he++,ge+=F}G*q!=0&&(T+=q*(1+Ce)),_+=1}return O},m.decode._getBPP=function(u){return[1,null,3,1,2,null,4][u.ctype]*u.depth},m.decode._filterZero=function(u,y,p,w,M){var b=m.decode._getBPP(y),I=Math.ceil(w*b/8),O=m.decode._paeth;b=Math.ceil(b/8);for(var T=0;T<M;T++){var L=p+T*I,Q=L+T+1,ne=u[Q-1];if(ne==0)for(var Z=0;Z<I;Z++)u[L+Z]=u[Q+Z];else if(ne==1){for(Z=0;Z<b;Z++)u[L+Z]=u[Q+Z];for(Z=b;Z<I;Z++)u[L+Z]=u[Q+Z]+u[L+Z-b]&255}else if(T==0){for(Z=0;Z<b;Z++)u[L+Z]=u[Q+Z];if(ne==2)for(Z=b;Z<I;Z++)u[L+Z]=255&u[Q+Z];if(ne==3)for(Z=b;Z<I;Z++)u[L+Z]=u[Q+Z]+(u[L+Z-b]>>1)&255;if(ne==4)for(Z=b;Z<I;Z++)u[L+Z]=u[Q+Z]+O(u[L+Z-b],0,0)&255}else{if(ne==2)for(Z=0;Z<I;Z++)u[L+Z]=u[Q+Z]+u[L+Z-I]&255;if(ne==3){for(Z=0;Z<b;Z++)u[L+Z]=u[Q+Z]+(u[L+Z-I]>>1)&255;for(Z=b;Z<I;Z++)u[L+Z]=u[Q+Z]+(u[L+Z-I]+u[L+Z-b]>>1)&255}if(ne==4){for(Z=0;Z<b;Z++)u[L+Z]=u[Q+Z]+O(0,u[L+Z-I],0)&255;for(Z=b;Z<I;Z++)u[L+Z]=u[Q+Z]+O(u[L+Z-b],u[L+Z-I],u[L+Z-b-I])&255}}}return u},m.decode._paeth=function(u,y,p){var w=u+y-p,M=Math.abs(w-u),b=Math.abs(w-y),I=Math.abs(w-p);return M<=b&&M<=I?u:b<=I?y:p},m.decode._IHDR=function(u,y,p){var w=m._bin;p.width=w.readUint(u,y),y+=4,p.height=w.readUint(u,y),y+=4,p.depth=u[y],y++,p.ctype=u[y],y++,p.compress=u[y],y++,p.filter=u[y],y++,p.interlace=u[y],y++},m._bin={nextZero:function(u,y){for(;u[y]!=0;)y++;return y},readUshort:function(u,y){return u[y]<<8|u[y+1]},writeUshort:function(u,y,p){u[y]=p>>8&255,u[y+1]=255&p},readUint:function(u,y){return 16777216*u[y]+(u[y+1]<<16|u[y+2]<<8|u[y+3])},writeUint:function(u,y,p){u[y]=p>>24&255,u[y+1]=p>>16&255,u[y+2]=p>>8&255,u[y+3]=255&p},readASCII:function(u,y,p){for(var w="",M=0;M<p;M++)w+=String.fromCharCode(u[y+M]);return w},writeASCII:function(u,y,p){for(var w=0;w<p.length;w++)u[y+w]=p.charCodeAt(w)},readBytes:function(u,y,p){for(var w=[],M=0;M<p;M++)w.push(u[y+M]);return w},pad:function(u){return u.length<2?"0"+u:u},readUTF8:function(u,y,p){for(var w,M="",b=0;b<p;b++)M+="%"+m._bin.pad(u[y+b].toString(16));try{w=decodeURIComponent(M)}catch{return m._bin.readASCII(u,y,p)}return w}},m._copyTile=function(u,y,p,w,M,b,I,O,T){for(var L=Math.min(y,M),Q=Math.min(p,b),ne=0,Z=0,_=0;_<Q;_++)for(var F=0;F<L;F++)if(I>=0&&O>=0?(ne=_*y+F<<2,Z=(O+_)*M+I+F<<2):(ne=(-O+_)*y-I+F<<2,Z=_*M+F<<2),T==0)w[Z]=u[ne],w[Z+1]=u[ne+1],w[Z+2]=u[ne+2],w[Z+3]=u[ne+3];else if(T==1){var j=u[ne+3]*.00392156862745098,G=u[ne]*j,q=u[ne+1]*j,N=u[ne+2]*j,ee=w[Z+3]*(1/255),Ce=w[Z]*ee,he=w[Z+1]*ee,ge=w[Z+2]*ee,me=1-j,Me=j+ee*me,ue=Me==0?0:1/Me;w[Z+3]=255*Me,w[Z+0]=(G+Ce*me)*ue,w[Z+1]=(q+he*me)*ue,w[Z+2]=(N+ge*me)*ue}else if(T==2)j=u[ne+3],G=u[ne],q=u[ne+1],N=u[ne+2],ee=w[Z+3],Ce=w[Z],he=w[Z+1],ge=w[Z+2],j==ee&&G==Ce&&q==he&&N==ge?(w[Z]=0,w[Z+1]=0,w[Z+2]=0,w[Z+3]=0):(w[Z]=G,w[Z+1]=q,w[Z+2]=N,w[Z+3]=j);else if(T==3){if(j=u[ne+3],G=u[ne],q=u[ne+1],N=u[ne+2],ee=w[Z+3],Ce=w[Z],he=w[Z+1],ge=w[Z+2],j==ee&&G==Ce&&q==he&&N==ge)continue;if(j<220&&ee>20)return!1}return!0},m.encode=function(u,y,p,w,M,b){w==null&&(w=0),b==null&&(b=!1);for(var I=new Uint8Array(u[0].byteLength*u.length+100),O=[137,80,78,71,13,10,26,10],T=0;T<8;T++)I[T]=O[T];var L=8,Q=m._bin,ne=m.crc.crc,Z=Q.writeUint,_=Q.writeUshort,F=Q.writeASCII,j=m.encode.compressPNG(u,y,p,w,b);Z(I,L,13),F(I,L+=4,"IHDR"),Z(I,L+=4,y),Z(I,L+=4,p),I[L+=4]=j.depth,I[++L]=j.ctype,I[++L]=0,I[++L]=0,I[++L]=0,Z(I,++L,ne(I,L-17,17)),Z(I,L+=4,1),F(I,L+=4,"sRGB"),I[L+=4]=1,Z(I,++L,ne(I,L-5,5)),L+=4;var G=u.length>1;if(G&&(Z(I,L,8),F(I,L+=4,"acTL"),Z(I,L+=4,u.length),Z(I,L+=4,0),Z(I,L+=4,ne(I,L-12,12)),L+=4),j.ctype==3){for(Z(I,L,3*(ue=j.plte.length)),F(I,L+=4,"PLTE"),L+=4,T=0;T<ue;T++){var q=3*T,N=j.plte[T],ee=255&N,Ce=N>>8&255,he=N>>16&255;I[L+q+0]=ee,I[L+q+1]=Ce,I[L+q+2]=he}if(Z(I,L+=3*ue,ne(I,L-3*ue-4,3*ue+4)),L+=4,j.gotAlpha){for(Z(I,L,ue),F(I,L+=4,"tRNS"),L+=4,T=0;T<ue;T++)I[L+T]=j.plte[T]>>24&255;Z(I,L+=ue,ne(I,L-ue-4,ue+4)),L+=4}}for(var ge=0,me=0;me<j.frames.length;me++){var Me=j.frames[me];G&&(Z(I,L,26),F(I,L+=4,"fcTL"),Z(I,L+=4,ge++),Z(I,L+=4,Me.rect.width),Z(I,L+=4,Me.rect.height),Z(I,L+=4,Me.rect.x),Z(I,L+=4,Me.rect.y),_(I,L+=4,M[me]),_(I,L+=2,1e3),I[L+=2]=Me.dispose,I[++L]=Me.blend,Z(I,++L,ne(I,L-30,30)),L+=4);var ue,P=Me.cimg;Z(I,L,(ue=P.length)+(me==0?0:4));var ce=L+=4;for(F(I,L,me==0?"IDAT":"fdAT"),L+=4,me!=0&&(Z(I,L,ge++),L+=4),T=0;T<ue;T++)I[L+T]=P[T];Z(I,L+=ue,ne(I,ce,L-ce)),L+=4}return Z(I,L,0),F(I,L+=4,"IEND"),Z(I,L+=4,ne(I,L-4,4)),L+=4,I.buffer.slice(0,L)},m.encode.compressPNG=function(u,y,p,w,M){for(var b=m.encode.compress(u,y,p,w,!1,M),I=0;I<u.length;I++){var O=b.frames[I],T=(O.rect.width,O.rect.height),L=O.bpl,Q=O.bpp,ne=new Uint8Array(T*L+T);O.cimg=m.encode._filterZero(O.img,T,Q,L,ne)}return b},m.encode.compress=function(u,y,p,w,M,b){b==null&&(b=!1);for(var I=6,O=8,T=4,L=255,Q=0;Q<u.length;Q++)for(var ne=new Uint8Array(u[Q]),Z=ne.length,_=0;_<Z;_+=4)L&=ne[_+3];var F=L!=255,j={},G=[];if(u.length!=0&&(j[0]=0,G.push(0),w!=0&&w--),w!=0){var q=m.quantize(u,w,M);for(u=q.bufs,_=0;_<q.plte.length;_++)j[ee=q.plte[_].est.rgba]==null&&(j[ee]=G.length,G.push(ee))}else for(Q=0;Q<u.length;Q++){var N=new Uint32Array(u[Q]);for(Z=N.length,_=0;_<Z;_++){var ee=N[_];if((_<y||ee!=N[_-1]&&ee!=N[_-y])&&j[ee]==null&&(j[ee]=G.length,G.push(ee),G.length>=300))break}}var Ce=!!F&&M,he=G.length;he<=256&&b==0&&(O=he<=2?1:he<=4?2:he<=16?4:8,M&&(O=8),F=!0);var ge=[];for(Q=0;Q<u.length;Q++){var me=new Uint8Array(u[Q]),Me=new Uint32Array(me.buffer),ue=0,P=0,ce=y,se=p,X=0;if(Q!=0&&!Ce){for(var Re=M||Q==1||ge[ge.length-2].dispose==2?1:2,fe=0,De=1e9,We=0;We<Re;We++){for(var oe=new Uint8Array(u[Q-1-We]),Ae=new Uint32Array(u[Q-1-We]),He=y,Ue=p,Ie=-1,rt=-1,st=0;st<p;st++)for(var at=0;at<y;at++)Me[_=st*y+at]!=Ae[_]&&(at<He&&(He=at),at>Ie&&(Ie=at),st<Ue&&(Ue=st),st>rt&&(rt=st));var Ft=Ie==-1?1:(Ie-He+1)*(rt-Ue+1);Ft<De&&(De=Ft,fe=We,Ie==-1?(ue=P=0,ce=se=1):(ue=He,P=Ue,ce=Ie-He+1,se=rt-Ue+1))}oe=new Uint8Array(u[Q-1-fe]),fe==1&&(ge[ge.length-1].dispose=2);var Ct=new Uint8Array(ce*se*4);new Uint32Array(Ct.buffer),m._copyTile(oe,y,p,Ct,ce,se,-ue,-P,0),m._copyTile(me,y,p,Ct,ce,se,-ue,-P,3)?(m._copyTile(me,y,p,Ct,ce,se,-ue,-P,2),X=1):(m._copyTile(me,y,p,Ct,ce,se,-ue,-P,0),X=0),me=Ct,Me=new Uint32Array(me.buffer)}var or=4*ce;if(he<=256&&b==0){for(or=Math.ceil(O*ce/8),Ct=new Uint8Array(or*se),st=0;st<se;st++){_=st*or;var ar=st*ce;if(O==8)for(at=0;at<ce;at++)Ct[_+at]=j[Me[ar+at]];else if(O==4)for(at=0;at<ce;at++)Ct[_+(at>>1)]|=j[Me[ar+at]]<<4-4*(1&at);else if(O==2)for(at=0;at<ce;at++)Ct[_+(at>>2)]|=j[Me[ar+at]]<<6-2*(3&at);else if(O==1)for(at=0;at<ce;at++)Ct[_+(at>>3)]|=j[Me[ar+at]]<<7-1*(7&at)}me=Ct,I=3,T=1}else if(F==0&&u.length==1){Ct=new Uint8Array(ce*se*3);var kr=ce*se;for(_=0;_<kr;_++){var Ar=3*_,pr=4*_;Ct[Ar]=me[pr],Ct[Ar+1]=me[pr+1],Ct[Ar+2]=me[pr+2]}me=Ct,I=2,T=3,or=3*ce}ge.push({rect:{x:ue,y:P,width:ce,height:se},img:me,bpl:or,bpp:T,blend:X,dispose:Ce?1:0})}return{ctype:I,depth:O,plte:G,gotAlpha:F,frames:ge}},m.encode._filterZero=function(u,y,p,w,M){for(var b=[],I=0;I<5;I++)if(!(y*w>5e5)||I!=2&&I!=3&&I!=4){for(var O=0;O<y;O++)m.encode._filterLine(M,u,O,w,p,I);if(b.push(z.deflate(M)),p==1)break}for(var T,L=1e9,Q=0;Q<b.length;Q++)b[Q].length<L&&(T=Q,L=b[Q].length);return b[T]},m.encode._filterLine=function(u,y,p,w,M,b){var I=p*w,O=I+p,T=m.decode._paeth;if(u[O]=b,O++,b==0)for(var L=0;L<w;L++)u[O+L]=y[I+L];else if(b==1){for(L=0;L<M;L++)u[O+L]=y[I+L];for(L=M;L<w;L++)u[O+L]=y[I+L]-y[I+L-M]+256&255}else if(p==0){for(L=0;L<M;L++)u[O+L]=y[I+L];if(b==2)for(L=M;L<w;L++)u[O+L]=y[I+L];if(b==3)for(L=M;L<w;L++)u[O+L]=y[I+L]-(y[I+L-M]>>1)+256&255;if(b==4)for(L=M;L<w;L++)u[O+L]=y[I+L]-T(y[I+L-M],0,0)+256&255}else{if(b==2)for(L=0;L<w;L++)u[O+L]=y[I+L]+256-y[I+L-w]&255;if(b==3){for(L=0;L<M;L++)u[O+L]=y[I+L]+256-(y[I+L-w]>>1)&255;for(L=M;L<w;L++)u[O+L]=y[I+L]+256-(y[I+L-w]+y[I+L-M]>>1)&255}if(b==4){for(L=0;L<M;L++)u[O+L]=y[I+L]+256-T(0,y[I+L-w],0)&255;for(L=M;L<w;L++)u[O+L]=y[I+L]+256-T(y[I+L-M],y[I+L-w],y[I+L-M-w])&255}}},m.crc={table:(function(){for(var u=new Uint32Array(256),y=0;y<256;y++){for(var p=y,w=0;w<8;w++)1&p?p=3988292384^p>>>1:p>>>=1;u[y]=p}return u})(),update:function(u,y,p,w){for(var M=0;M<w;M++)u=m.crc.table[255&(u^y[p+M])]^u>>>8;return u},crc:function(u,y,p){return 4294967295^m.crc.update(4294967295,u,y,p)}},m.quantize=function(u,y,p){for(var w=[],M=0,b=0;b<u.length;b++)w.push(m.encode.alphaMul(new Uint8Array(u[b]),p)),M+=u[b].byteLength;var I=new Uint8Array(M),O=new Uint32Array(I.buffer),T=0;for(b=0;b<w.length;b++){for(var L=w[b],Q=L.length,ne=0;ne<Q;ne++)I[T+ne]=L[ne];T+=Q}var Z={i0:0,i1:I.length,bst:null,est:null,tdst:0,left:null,right:null};Z.bst=m.quantize.stats(I,Z.i0,Z.i1),Z.est=m.quantize.estats(Z.bst);for(var _=[Z];_.length<y;){var F=0,j=0;for(b=0;b<_.length;b++)_[b].est.L>F&&(F=_[b].est.L,j=b);if(F<.001)break;var G=_[j],q=m.quantize.splitPixels(I,O,G.i0,G.i1,G.est.e,G.est.eMq255),N={i0:G.i0,i1:q,bst:null,est:null,tdst:0,left:null,right:null};N.bst=m.quantize.stats(I,N.i0,N.i1),N.est=m.quantize.estats(N.bst);var ee={i0:q,i1:G.i1,bst:null,est:null,tdst:0,left:null,right:null};for(ee.bst={R:[],m:[],N:G.bst.N-N.bst.N},b=0;b<16;b++)ee.bst.R[b]=G.bst.R[b]-N.bst.R[b];for(b=0;b<4;b++)ee.bst.m[b]=G.bst.m[b]-N.bst.m[b];ee.est=m.quantize.estats(ee.bst),G.left=N,G.right=ee,_[j]=N,_.push(ee)}_.sort(function(Re,fe){return fe.bst.N-Re.bst.N});for(var Ce=0;Ce<w.length;Ce++){var he=m.quantize.planeDst,ge=new Uint8Array(w[Ce].buffer),me=new Uint32Array(w[Ce].buffer),Me=ge.length;for(b=0;b<Me;b+=4){for(var ue=ge[b]*.00392156862745098,P=ge[b+1]*.00392156862745098,ce=ge[b+2]*.00392156862745098,se=ge[b+3]*.00392156862745098,X=Z;X.left;)X=he(X.est,ue,P,ce,se)<=0?X.left:X.right;me[b>>2]=X.est.rgba}w[Ce]=me.buffer}return{bufs:w,plte:_}},m.quantize.getNearest=function(u,y,p,w,M){if(u.left==null)return u.tdst=m.quantize.dist(u.est.q,y,p,w,M),u;var b=m.quantize.planeDst(u.est,y,p,w,M),I=u.left,O=u.right;b>0&&(I=u.right,O=u.left);var T=m.quantize.getNearest(I,y,p,w,M);if(T.tdst<=b*b)return T;var L=m.quantize.getNearest(O,y,p,w,M);return L.tdst<T.tdst?L:T},m.quantize.planeDst=function(u,y,p,w,M){var b=u.e;return b[0]*y+b[1]*p+b[2]*w+b[3]*M-u.eMq},m.quantize.dist=function(u,y,p,w,M){var b=y-u[0],I=p-u[1],O=w-u[2],T=M-u[3];return b*b+I*I+O*O+T*T},m.quantize.splitPixels=function(u,y,p,w,M,b){var I=m.quantize.vecDot;for(w-=4;p<w;){for(;I(u,p,M)<=b;)p+=4;for(;I(u,w,M)>b;)w-=4;if(p>=w)break;var O=y[p>>2];y[p>>2]=y[w>>2],y[w>>2]=O,p+=4,w-=4}for(;I(u,p,M)>b;)p-=4;return p+4},m.quantize.vecDot=function(u,y,p){return u[y]*p[0]+u[y+1]*p[1]+u[y+2]*p[2]+u[y+3]*p[3]},m.quantize.stats=function(u,y,p){for(var w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],M=[0,0,0,0],b=p-y>>2,I=y;I<p;I+=4){var O=u[I]*.00392156862745098,T=u[I+1]*(1/255),L=u[I+2]*(1/255),Q=u[I+3]*(1/255);M[0]+=O,M[1]+=T,M[2]+=L,M[3]+=Q,w[0]+=O*O,w[1]+=O*T,w[2]+=O*L,w[3]+=O*Q,w[5]+=T*T,w[6]+=T*L,w[7]+=T*Q,w[10]+=L*L,w[11]+=L*Q,w[15]+=Q*Q}return w[4]=w[1],w[8]=w[2],w[12]=w[3],w[9]=w[6],w[13]=w[7],w[14]=w[11],{R:w,m:M,N:b}},m.quantize.estats=function(u){var y=u.R,p=u.m,w=u.N,M=p[0],b=p[1],I=p[2],O=p[3],T=w==0?0:1/w,L=[y[0]-M*M*T,y[1]-M*b*T,y[2]-M*I*T,y[3]-M*O*T,y[4]-b*M*T,y[5]-b*b*T,y[6]-b*I*T,y[7]-b*O*T,y[8]-I*M*T,y[9]-I*b*T,y[10]-I*I*T,y[11]-I*O*T,y[12]-O*M*T,y[13]-O*b*T,y[14]-O*I*T,y[15]-O*O*T],Q=L,ne=m.M4,Z=[.5,.5,.5,.5],_=0,F=0;if(w!=0)for(var j=0;j<10&&(Z=ne.multVec(Q,Z),F=Math.sqrt(ne.dot(Z,Z)),Z=ne.sml(1/F,Z),!(Math.abs(F-_)<1e-9));j++)_=F;var G=[M*T,b*T,I*T,O*T],q=ne.dot(ne.sml(255,G),Z),N=G[3]<.001?0:1/G[3];return{Cov:L,q:G,e:Z,L:_,eMq255:q,eMq:ne.dot(Z,G),rgba:(Math.round(255*G[3])<<24|Math.round(255*G[2]*N)<<16|Math.round(255*G[1]*N)<<8|Math.round(255*G[0]*N))>>>0}},m.M4={multVec:function(u,y){return[u[0]*y[0]+u[1]*y[1]+u[2]*y[2]+u[3]*y[3],u[4]*y[0]+u[5]*y[1]+u[6]*y[2]+u[7]*y[3],u[8]*y[0]+u[9]*y[1]+u[10]*y[2]+u[11]*y[3],u[12]*y[0]+u[13]*y[1]+u[14]*y[2]+u[15]*y[3]]},dot:function(u,y){return u[0]*y[0]+u[1]*y[1]+u[2]*y[2]+u[3]*y[3]},sml:function(u,y){return[u*y[0],u*y[1],u*y[2],u*y[3]]}},m.encode.alphaMul=function(u,y){for(var p=new Uint8Array(u.length),w=u.length>>2,M=0;M<w;M++){var b=M<<2,I=u[b+3];y&&(I=I<128?0:255);var O=I*(1/255);p[b+0]=u[b+0]*O,p[b+1]=u[b+1]*O,p[b+2]=u[b+2]*O,p[b+3]=I}return p}})(h,a(788))},165:i=>{i.exports=function(n,a){var h,m,z,u,y,p,w,M,b,I,O,T,L,Q,ne,Z,_,F,j,G,q,N,ee,Ce,he;h=n.state,m=n.next_in,Ce=n.input,z=m+(n.avail_in-5),u=n.next_out,he=n.output,y=u-(a-n.avail_out),p=u+(n.avail_out-257),w=h.dmax,M=h.wsize,b=h.whave,I=h.wnext,O=h.window,T=h.hold,L=h.bits,Q=h.lencode,ne=h.distcode,Z=(1<<h.lenbits)-1,_=(1<<h.distbits)-1;e:do{L<15&&(T+=Ce[m++]<<L,L+=8,T+=Ce[m++]<<L,L+=8),F=Q[T&Z];t:for(;;){if(T>>>=j=F>>>24,L-=j,(j=F>>>16&255)==0)he[u++]=65535&F;else{if(!(16&j)){if(64&j){if(32&j){h.mode=12;break e}n.msg="invalid literal/length code",h.mode=30;break e}F=Q[(65535&F)+(T&(1<<j)-1)];continue t}for(G=65535&F,(j&=15)&&(L<j&&(T+=Ce[m++]<<L,L+=8),G+=T&(1<<j)-1,T>>>=j,L-=j),L<15&&(T+=Ce[m++]<<L,L+=8,T+=Ce[m++]<<L,L+=8),F=ne[T&_];;){if(T>>>=j=F>>>24,L-=j,16&(j=F>>>16&255)){if(q=65535&F,L<(j&=15)&&(T+=Ce[m++]<<L,(L+=8)<j&&(T+=Ce[m++]<<L,L+=8)),(q+=T&(1<<j)-1)>w){n.msg="invalid distance too far back",h.mode=30;break e}if(T>>>=j,L-=j,q>(j=u-y)){if((j=q-j)>b&&h.sane){n.msg="invalid distance too far back",h.mode=30;break e}if(N=0,ee=O,I===0){if(N+=M-j,j<G){G-=j;do he[u++]=O[N++];while(--j);N=u-q,ee=he}}else if(I<j){if(N+=M+I-j,(j-=I)<G){G-=j;do he[u++]=O[N++];while(--j);if(N=0,I<G){G-=j=I;do he[u++]=O[N++];while(--j);N=u-q,ee=he}}}else if(N+=I-j,j<G){G-=j;do he[u++]=O[N++];while(--j);N=u-q,ee=he}for(;G>2;)he[u++]=ee[N++],he[u++]=ee[N++],he[u++]=ee[N++],G-=3;G&&(he[u++]=ee[N++],G>1&&(he[u++]=ee[N++]))}else{N=u-q;do he[u++]=he[N++],he[u++]=he[N++],he[u++]=he[N++],G-=3;while(G>2);G&&(he[u++]=he[N++],G>1&&(he[u++]=he[N++]))}break}if(64&j){n.msg="invalid distance code",h.mode=30;break e}F=ne[(65535&F)+(T&(1<<j)-1)]}}break}}while(m<z&&u<p);m-=G=L>>3,T&=(1<<(L-=G<<3))-1,n.next_in=m,n.next_out=u,n.avail_in=m<z?z-m+5:5-(m-z),n.avail_out=u<p?p-u+257:257-(u-p),h.hold=T,h.bits=L}},185:()=>{$3Dmol.workerString=(function(){self.onmessage=function(i){var n=i.data,a=n.type;if(a<0)self.atomData=n.atoms,self.volume=n.volume,self.ps=new ProteinSurface;else{var h=self.ps;h.initparm(n.expandedExtent,a!=1,self.volume),h.fillvoxels(self.atomData,n.extendedAtoms),h.buildboundary(),a!==4&&a!==2||(h.fastdistancemap(),h.boundingatom(!1),h.fillvoxelswaals(self.atomData,n.extendedAtoms)),h.marchingcube(a);var m=h.getFacesAndVertices(n.atomsToShow);self.postMessage(m)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0},222:(i,n,a)=>{a.r(n),a.d(n,{CC:()=>m,Color:()=>h,builtinColorSchemes:()=>b,chains:()=>M,elementColors:()=>p,htmlColors:()=>z,residues:()=>w,ssColors:()=>u});class h{constructor(O,T,L){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof O=="number"?(this.r=O||0,this.g=T||0,this.b=L||0,this):this.set(O||0)}set(O){return O instanceof h?O.clone():(typeof O=="number"?this.setHex(O):typeof O=="object"&&(this.r=O?.r||0,this.g=O?.g||0,this.b=O?.b||0),this)}setHex(O){return O=Math.floor(O),this.r=(O>>16&255)/255,this.g=(O>>8&255)/255,this.b=(255&O)/255,this}getHex(){return Math.round(255*this.r)<<16|Math.round(255*this.g)<<8|Math.round(255*this.b)}clone(){return new h(this.r,this.g,this.b)}copy(O){return this.r=O.r,this.g=O.g,this.b=O.b,this}scaled(){var O={};return O.r=Math.round(255*this.r),O.g=Math.round(255*this.g),O.b=Math.round(255*this.b),O.a=1,O}}class m{static color(O){if(!O)return m.cache[0];if(O instanceof h)return O;if(typeof O=="number"&&m.cache[O]!==void 0)return m.cache[O];if(O&&Array.isArray(O))return O.map(m.color);let T=m.getHex(O),L=new h(T);return m.cache[T]=L,L}static getHex(O){if(Array.isArray(O))return O.map(m.getHex);if(typeof O=="string"){let T=O;if(!isNaN(parseInt(T)))return parseInt(T);if(T=T.trim(),T.length==4&&T[0]=="#"&&(T="#"+T[1]+T[1]+T[2]+T[2]+T[3]+T[3]),T.length==7&&T[0]=="#")return parseInt(T.substring(1),16);let L=m.rgbRegEx.exec(T);if(L){L[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let ne=0;for(let Z=2;Z<5;Z++){ne*=256;let _=L[Z].endsWith("%")?255*parseFloat(L[Z])/100:parseFloat(L[Z]);ne+=Math.round(_)}return ne}let Q=z[T.toLowerCase()];return Q!==void 0?Q:(console.error("color not found",O.toLowerCase(),z),0)}return O}}m.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,m.cache={0:new h(0)};const z={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074,b:255,g:32768,r:16711680,c:49087,m:12517567,y:12566272,k:0,w:16777215},u={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},y={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},p={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:y,defaultColors:Object.assign({},y),greenCarbon:Object.assign(Object.assign({},y),{C:65280}),cyanCarbon:Object.assign(Object.assign({},y),{C:65535}),magentaCarbon:Object.assign(Object.assign({},y),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},y),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},y),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},y),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},y),{C:8388736}),blueCarbon:Object.assign(Object.assign({},y),{C:255})},w={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},M={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},b={ssPyMol:{prop:"ss",map:u.pyMol},ssJmol:{prop:"ss",map:u.Jmol},Jmol:{prop:"elem",map:p.Jmol},amino:{prop:"resn",map:w.amino},shapely:{prop:"resn",map:w.shapely},nucleic:{prop:"resn",map:w.nucleic},chain:{prop:"chain",map:M.atom},rasmol:{prop:"elem",map:p.rasmol},default:{prop:"elem",map:p.defaultColors},greenCarbon:{prop:"elem",map:p.greenCarbon},chainHetatm:{prop:"chain",map:M.hetatm},cyanCarbon:{prop:"elem",map:p.cyanCarbon},magentaCarbon:{prop:"elem",map:p.magentaCarbon},purpleCarbon:{prop:"elem",map:p.purpleCarbon},whiteCarbon:{prop:"elem",map:p.whiteCarbon},orangeCarbon:{prop:"elem",map:p.orangeCarbon},yellowCarbon:{prop:"elem",map:p.yellowCarbon},blueCarbon:{prop:"elem",map:p.blueCarbon}}},307:i=>{typeof i.exports=="object"&&(i.exports=window.$3Dmol)},358:(i,n,a)=>{var h=a(981),m=15,z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],p=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(w,M,b,I,O,T,L,Q){var ne,Z,_,F,j,G,q,N,ee,Ce=Q.bits,he=0,ge=0,me=0,Me=0,ue=0,P=0,ce=0,se=0,X=0,Re=0,fe=null,De=0,We=new h.Buf16(16),oe=new h.Buf16(16),Ae=null,He=0;for(he=0;he<=m;he++)We[he]=0;for(ge=0;ge<I;ge++)We[M[b+ge]]++;for(ue=Ce,Me=m;Me>=1&&We[Me]===0;Me--);if(ue>Me&&(ue=Me),Me===0)return O[T++]=20971520,O[T++]=20971520,Q.bits=1,0;for(me=1;me<Me&&We[me]===0;me++);for(ue<me&&(ue=me),se=1,he=1;he<=m;he++)if(se<<=1,(se-=We[he])<0)return-1;if(se>0&&(w===0||Me!==1))return-1;for(oe[1]=0,he=1;he<m;he++)oe[he+1]=oe[he]+We[he];for(ge=0;ge<I;ge++)M[b+ge]!==0&&(L[oe[M[b+ge]]++]=ge);if(w===0?(fe=Ae=L,G=19):w===1?(fe=z,De-=257,Ae=u,He-=257,G=256):(fe=y,Ae=p,G=-1),Re=0,ge=0,he=me,j=T,P=ue,ce=0,_=-1,F=(X=1<<ue)-1,w===1&&X>852||w===2&&X>592)return 1;for(;;){q=he-ce,L[ge]<G?(N=0,ee=L[ge]):L[ge]>G?(N=Ae[He+L[ge]],ee=fe[De+L[ge]]):(N=96,ee=0),ne=1<<he-ce,me=Z=1<<P;do O[j+(Re>>ce)+(Z-=ne)]=q<<24|N<<16|ee;while(Z!==0);for(ne=1<<he-1;Re&ne;)ne>>=1;if(ne!==0?(Re&=ne-1,Re+=ne):Re=0,ge++,--We[he]===0){if(he===Me)break;he=M[b+L[ge]]}if(he>ue&&(Re&F)!==_){for(ce===0&&(ce=ue),j+=me,se=1<<(P=he-ce);P+ce<Me&&!((se-=We[P+ce])<=0);)P++,se<<=1;if(X+=1<<P,w===1&&X>852||w===2&&X>592)return 1;O[_=Re&F]=ue<<24|P<<16|j-T}}return Re!==0&&(O[j+Re]=he-ce<<24|4194304),Q.bits=ue,0}},378:(i,n,a)=>{var h;a.r(n),a.d(n,{BackSide:()=>z,Camera:()=>Wi,ClampToEdgeWrapping:()=>M,Coloring:()=>h,Cylinder:()=>X.Cylinder,DoubleSide:()=>u,EventDispatcher:()=>F,FloatType:()=>L,Fog:()=>tn,FrontSide:()=>m,Geometry:()=>he,GeometryGroup:()=>Ce,GeometryIDCount:()=>ge,ImposterMaterial:()=>kr,InstancedMaterial:()=>Ar,Light:()=>P,Line:()=>Se,LineBasicMaterial:()=>N,LineStyle:()=>pe,LinearFilter:()=>b,LinearMipMapLinearFilter:()=>O,Material:()=>G,MaterialIdCount:()=>q,Matrix3:()=>p.Matrix3,Matrix4:()=>p.Matrix4,Mesh:()=>Le,MeshDoubleLambertMaterial:()=>vr,MeshLambertMaterial:()=>pr,MeshOutlineMaterial:()=>xr,NearestFilter:()=>I,Object3D:()=>Me,Object3DIDCount:()=>me,Projector:()=>se,Quaternion:()=>p.Quaternion,R32Format:()=>Z,RFormat:()=>ne,RGBAFormat:()=>Q,Ray:()=>p.Ray,Raycaster:()=>De,Renderer:()=>Zi,Scene:()=>ue,ShaderLib:()=>Yr,ShaderUtils:()=>yi,Shading:()=>y,Sphere:()=>X.Sphere,SphereImposterMaterial:()=>fi,SphereImposterOutlineMaterial:()=>Rr,Sprite:()=>dt,SpriteAlignment:()=>w,SpriteMaterial:()=>Ir,SpritePlugin:()=>on,StickImposterMaterial:()=>Di,StickImposterOutlineMaterial:()=>bi,Texture:()=>or,TextureIdCount:()=>ar,TextureOperations:()=>_,Triangle:()=>X.Triangle,UVMapping:()=>Ct,UnsignedByteType:()=>T,Vector2:()=>p.Vector2,Vector3:()=>p.Vector3,VolumetricMaterial:()=>Hi,basic:()=>zt,clamp:()=>p.clamp,clone:()=>Vi,conversionMatrix3:()=>p.conversionMatrix3,degToRad:()=>p.degToRad,instanced:()=>Lt,intersectObject:()=>Ft,lambert:()=>It,lambertdouble:()=>li,outline:()=>ui,screen:()=>gi,screenaa:()=>jr,sphereimposter:()=>Dr,sphereimposteroutline:()=>vi,sprite:()=>wi,stickimposter:()=>Ni,stickimposteroutline:()=>Ti,volumetric:()=>Br}),(function(Bt){Bt[Bt.NoColors=0]="NoColors",Bt[Bt.FaceColors=1]="FaceColors",Bt[Bt.VertexColors=2]="VertexColors"})(h||(h={}));const m=0,z=1,u=2;var y;(function(Bt){Bt[Bt.NoShading=0]="NoShading",Bt[Bt.FlatShading=1]="FlatShading",Bt[Bt.SmoothShading=2]="SmoothShading"})(y||(y={}));var p=a(529);const w={topLeft:new p.Vector2(1,-1),topCenter:new p.Vector2(0,-1),topRight:new p.Vector2(-1,-1),centerLeft:new p.Vector2(1,0),center:new p.Vector2(0,0),centerRight:new p.Vector2(-1,0),bottomLeft:new p.Vector2(1,1),bottomCenter:new p.Vector2(0,1),bottomRight:new p.Vector2(-1,1)},M=1001,b=1006,I=1007,O=1008,T=1009,L=1010,Q=1021,ne=1022,Z=1023;var _;(function(Bt){Bt[Bt.MultiplyOperation=0]="MultiplyOperation",Bt[Bt.MixOperation=1]="MixOperation",Bt[Bt.AddOperation=2]="AddOperation"})(_||(_={}));class F{constructor(){this.listeners={}}dispatchEvent(x){var ie=this.listeners[x.type];if(ie!==void 0){x.target=this;for(var xe=0,Ve=ie.length;xe<Ve;xe++)ie[xe].call(this,x)}}removeEventListener(x,ie){if(ie){var xe=this.listeners[x].indexOf(ie);xe!==-1&&this.listeners[x].splice(xe,1)}else this.listeners[x]=[]}addEventListener(x,ie){this.listeners[x]===void 0&&(this.listeners[x]=[]),this.listeners[x].indexOf(ie)===-1&&this.listeners[x].push(ie)}}var j=a(222);class G extends F{constructor(){super(...arguments),this.id=q++,this.name="",this.side=m,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(x={}){if(x!==void 0)for(var ie in x){var xe=x[ie];if(xe!==void 0){if(ie in this){var Ve=this[ie];Ve instanceof j.Color&&xe instanceof j.Color?Ve.copy(xe):Ve instanceof j.Color?Ve.set(xe):Ve instanceof p.Vector3&&xe instanceof p.Vector3?Ve.copy(xe):this[ie]=xe}}else console.warn("$3Dmol.Material: '"+ie+"' parameter is undefined.")}}clone(x=new G){return x.name=this.name,x.side=this.side,x.opacity=this.opacity,x.transparent=this.transparent,x.depthTest=this.depthTest,x.depthWrite=this.depthWrite,x.polygonOffset=this.polygonOffset,x.polygonOffsetFactor=this.polygonOffsetFactor,x.polygonOffsetUnits=this.polygonOffsetUnits,x.alphaTest=this.alphaTest,x.overdraw=this.overdraw,x.visible=this.visible,x}makeShaded(x){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:x},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let q=0;class N extends G{constructor(x){super(),this.color=new j.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(x)}clone(x=new N){return super.clone.call(this,x),x.color.copy(this.color),x}}const ee=65535;class Ce{constructor(x=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.atomArray=Array(),this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=x}setColor(x){var ie=this.vertexArray,xe=this.colorArray;if(!ie)throw new Error("vertex array not initialized");if(!xe)throw new Error("color array not initialized");let Ve=j.CC.color(x);for(var Oe=0;Oe<ie.length;Oe+=3)xe[Oe]=Ve.r,xe[Oe+1]=Ve.g,xe[Oe+2]=Ve.b}setColors(x){var ie=this.vertexArray,xe=this.colorArray;if(!ie)throw new Error("vertex array not initialized");if(!xe)throw new Error("color array not initialized");if(ie.length==xe.length)for(var Ve=0;Ve<ie.length;Ve+=3){var Oe=x(ie[Ve],ie[Ve+1],ie[Ve+2]);Oe instanceof j.Color||(Oe=j.CC.color(Oe)),xe[Ve]=Oe.r,xe[Ve+1]=Oe.g,xe[Ve+2]=Oe.b}else console.log("Cannot re-color geometry group due to mismatched lengths.")}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var x,ie,xe,Ve,Oe=new p.Vector3,yt=0;yt<this.vertices;++yt)x=3*yt,ie=this.vertexArray[x],xe=this.vertexArray[x+1],Ve=this.vertexArray[x+2],Oe.x+=ie,Oe.y+=xe,Oe.z+=Ve;return Oe.divideScalar(this.vertices),Oe}setNormals(){var x=this.faceArray,ie=this.vertexArray,xe=this.normalArray;if(this.vertices&&this.faceidx){if(!x)throw new Error("face array not initialized");if(!ie)throw new Error("vertex array not initialized");if(!xe)throw new Error("normal array not initialized");for(var Ve,Oe,yt,lt,mt,Mt,Pt,Ot=0;Ot<x.length/3;++Ot)Ve=3*x[3*Ot],Oe=3*x[3*Ot+1],yt=3*x[3*Ot+2],lt=new p.Vector3(ie[Ve],ie[Ve+1],ie[Ve+2]),mt=new p.Vector3(ie[Oe],ie[Oe+1],ie[Oe+2]),Mt=new p.Vector3(ie[yt],ie[yt+1],ie[yt+2]),lt.subVectors(lt,mt),Mt.subVectors(Mt,mt),Mt.cross(lt),(Pt=Mt).normalize(),xe[Ve]+=Pt.x,xe[Oe]+=Pt.x,xe[yt]+=Pt.x,xe[Ve+1]+=Pt.y,xe[Oe+1]+=Pt.y,xe[yt+1]+=Pt.y,xe[Ve+2]+=Pt.z,xe[Oe+2]+=Pt.z,xe[yt+2]+=Pt.z}}setLineIndices(){if(this.faceidx&&(!this.lineArray||this.lineArray.length!=2*this.faceidx||this.lineidx!=2*this.faceidx)){var x=this.faceArray,ie=this.lineArray=new Uint16Array(2*this.faceidx);if(this.lineidx=2*this.faceidx,!x)throw new Error("face array not initialized");for(var xe=0;xe<this.faceidx/3;++xe){var Ve=3*xe,Oe=2*Ve,yt=x[Ve],lt=x[Ve+1],mt=x[Ve+2];ie[Oe]=yt,ie[Oe+1]=lt,ie[Oe+2]=yt,ie[Oe+3]=mt,ie[Oe+4]=lt,ie[Oe+5]=mt}}}vrml(x,ie){var xe,Ve,Oe,yt,lt,mt,Mt,Pt,Ot,gr,Yt,Cr,Er,Ur,_r,Or,br,Mi,Qt="";if(Qt+=x+`Shape {
`+x+` appearance Appearance {
`+x+`  material Material {
`+x+"   diffuseColor "+((xe=ie?.color)===null||xe===void 0?void 0:xe.r)+" "+((Ve=ie?.color)===null||Ve===void 0?void 0:Ve.g)+" "+((Oe=ie?.color)===null||Oe===void 0?void 0:Oe.b)+`
`,ie.wireframe&&this.colorArray){let ae=this.colorArray;Qt+=x+"    emissiveColor "+ae[0]+" "+ae[1]+" "+ae[2]+`
`}ie?.transparent&&(Qt+=x+"   transparency "+(1-ie.opacity)+`
`),Qt+=x+`  }
`,Qt+=x+` }
`;var ri=x;if(x+=" ",ie instanceof N||ie.wireframe){let ae,r,s;Qt+=x+`geometry IndexedLineSet {
`+x+` colorPerVertex TRUE
`+x+` coord Coordinate {
`+x+`  point [
`;for(let l=0;l<this.vertices;++l){let c=3*l;ae=(yt=this.vertexArray)===null||yt===void 0?void 0:yt[c],r=(lt=this.vertexArray)===null||lt===void 0?void 0:lt[c+1],s=(mt=this.vertexArray)===null||mt===void 0?void 0:mt[c+2],Qt+=x+"   "+ae+" "+r+" "+s+`,
`}if(Qt+=x+`  ]
`,Qt+=x+` }
`,this.colorArray&&!ie.wireframe){Qt+=x+` color Color {
`+x+`  color [
`;for(let l=0;l<this.vertices;++l){let c=3*l;ae=this.colorArray[c],r=this.colorArray[c+1],s=this.colorArray[c+2],Qt+=x+"   "+ae+" "+r+" "+s+`,
`}Qt+=x+`  ]
`,Qt+=x+` }
`}if(Qt+=x+` coordIndex [
`,ie.wireframe&&this.faceArray)for(let l=0;l<this.faceidx;l+=3)ae=(Mt=this.faceArray)===null||Mt===void 0?void 0:Mt[l],r=(Pt=this.faceArray)===null||Pt===void 0?void 0:Pt[l+1],s=(Ot=this.faceArray)===null||Ot===void 0?void 0:Ot[l+2],Qt+=x+"  "+ae+", "+r+", "+s+`, -1,
`;else for(let l=0;l<this.vertices-1;l+=2)Qt+=x+"  "+l+", "+(l+1)+`, -1,
`;Qt+=x+` ]
`,Qt+=x+`}
`}else{let ae,r,s;Qt+=x+`geometry IndexedFaceSet {
`+x+` colorPerVertex TRUE
`+x+` normalPerVertex TRUE
`+x+` solid FALSE
`,Qt+=x+` coord Coordinate {
`+x+`  point [
`;for(let l=0;l<this.vertices;++l){let c=3*l;ae=(gr=this.vertexArray)===null||gr===void 0?void 0:gr[c],r=(Yt=this.vertexArray)===null||Yt===void 0?void 0:Yt[c+1],s=(Cr=this.vertexArray)===null||Cr===void 0?void 0:Cr[c+2],Qt+=x+"   "+ae+" "+r+" "+s+`,
`}Qt+=x+`  ]
`,Qt+=x+` }
`,Qt+=x+` normal Normal {
`+x+`  vector [
`;for(let l=0;l<this.vertices;++l){let c=3*l;ae=(Er=this.normalArray)===null||Er===void 0?void 0:Er[c],r=(Ur=this.normalArray)===null||Ur===void 0?void 0:Ur[c+1],s=(_r=this.normalArray)===null||_r===void 0?void 0:_r[c+2],Qt+=x+"   "+ae+" "+r+" "+s+`,
`}if(Qt+=x+`  ]
`,Qt+=x+` }
`,this.colorArray){Qt+=x+` color Color {
`+x+`  color [
`;for(let l=0;l<this.vertices;++l){let c=3*l;ae=this.colorArray[c],r=this.colorArray[c+1],s=this.colorArray[c+2],Qt+=x+"   "+ae+" "+r+" "+s+`,
`}Qt+=x+`  ]
`,Qt+=x+` }
`}Qt+=x+` coordIndex [
`;for(let l=0;l<this.faceidx;l+=3)ae=(Or=this.faceArray)===null||Or===void 0?void 0:Or[l],r=(br=this.faceArray)===null||br===void 0?void 0:br[l+1],s=(Mi=this.faceArray)===null||Mi===void 0?void 0:Mi[l+2],Qt+=x+"  "+ae+", "+r+", "+s+`, -1,
`;Qt+=x+` ]
`,Qt+=x+`}
`}return Qt+=ri+"}"}truncateArrayBuffers(x=!0,ie=!1){var xe=this.vertexArray,Ve=this.colorArray,Oe=this.normalArray,yt=this.faceArray,lt=this.lineArray,mt=this.radiusArray;this.vertexArray=xe?.subarray(0,3*this.vertices)||null,this.colorArray=Ve?.subarray(0,3*this.vertices)||null,x?(this.normalArray=Oe?.subarray(0,3*this.vertices)||null,this.faceArray=yt?.subarray(0,this.faceidx)||null,this.lineidx>0?this.lineArray=lt?.subarray(0,this.lineidx)||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),mt&&(this.radiusArray=mt.subarray(0,this.vertices)),ie&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class he extends F{constructor(x=!1,ie=!1,xe=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=ge++,this.mesh=x,this.radii=ie,this.offset=xe}updateGeoGroup(x=0){var ie,xe=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!xe||xe.vertices+x>(((ie=xe?.vertexArray)===null||ie===void 0?void 0:ie.length)||0)/3)&&(xe=this.addGeoGroup()),xe}vrml(x,ie){for(var xe="",Ve=this.geometryGroups.length,Oe=0;Oe<Ve;Oe++)xe+=this.geometryGroups[Oe].vrml(x,ie)+`,
`;return xe}addGeoGroup(){var x=new Ce(this.geometryGroups.length);return this.geometryGroups.push(x),this.groups=this.geometryGroups.length,x.vertexArray=new Float32Array(196605),x.colorArray=new Float32Array(196605),this.mesh&&(x.normalArray=new Float32Array(196605),x.faceArray=new Uint16Array(393210),x.lineArray=new Uint16Array(393210)),this.radii&&(x.radiusArray=new Float32Array(ee)),x.useOffset=this.offset,x}setUpNormals(...x){for(var ie=0;ie<this.groups;ie++)this.geometryGroups[ie].setNormals(...x)}setColors(...x){for(var ie=this.geometryGroups.length,xe=0;xe<ie;xe++)this.geometryGroups[xe].setColors(...x)}setColor(...x){let ie=this.geometryGroups.length;for(var xe=0;xe<ie;xe++)this.geometryGroups[xe].setColor(...x)}setUpWireframe(...x){let ie=this.geometryGroups.length;for(var xe=0;xe<ie;xe++)this.geometryGroups[xe].setLineIndices(...x)}initTypedArrays(){for(var x=0;x<this.groups;x++){var ie=this.geometryGroups[x];ie.__inittedArrays!==!0&&ie.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var x=0,ie=0;ie<this.groups;ie++)x+=this.geometryGroups[ie].vertices;return x}}let ge=0,me=0;class Me{constructor(){this.id=me++,this.name="",this.children=[],this.position=new p.Vector3,this.rotation=new p.Vector3,this.matrix=new p.Matrix4,this.matrixWorld=new p.Matrix4,this.quaternion=new p.Quaternion,this.eulerOrder="XYZ",this.up=new p.Vector3(0,1,0),this.scale=new p.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(x){this.matrix.lookAt(x,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof p.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(x){if(x!==this){x.parent=this,this.children.push(x);for(var ie=this;ie.parent!==void 0;)ie=ie.parent;ie!==void 0&&ie instanceof ue&&ie.__addObject(x)}else console.error("Can't add $3Dmol.Object3D to itself")}remove(x){var ie=this.children.indexOf(x);if(ie!==-1){x.parent=void 0,this.children.splice(ie,1);for(var xe=this;xe.parent!==void 0;)xe=xe.parent;xe!==void 0&&xe instanceof ue&&xe.__removeObject(x)}}vrml(x){x||(x=" ");var ie=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),xe=0,Ve=0,Oe=0;if(ie!=0){let mt=Math.sin(ie/2);xe=this.quaternion.x/mt,Ve=this.quaternion.y/mt,Oe=this.quaternion.z/mt}var yt=x+`Transform {
`+x+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+x+" rotation "+xe+" "+Ve+" "+Oe+" "+ie+`
`+x+` children [
`;this.geometry&&(yt+=this.geometry.vrml(x,this.material));for(var lt=0;lt<this.children.length;lt++)yt+=this.children[lt].vrml(x+" ")+`,
`;return yt+=` ]
`,yt+="}"}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof p.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),this.scale.x===1&&this.scale.y===1&&this.scale.z===1||this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(x){this.matrixAutoUpdate===!0&&this.updateMatrix(),this.matrixWorldNeedsUpdate!==!0&&x!==!0||(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var ie=0;ie<this.children.length;ie++)this.children[ie].updateMatrixWorld(!0)}clone(x){x===void 0&&(x=new Me),x.name=this.name,x.up.copy(this.up),x.position.copy(this.position),x.rotation instanceof p.Vector3&&this.rotation instanceof p.Vector3?x.rotation.copy(this.rotation):x.rotation=this.rotation,x.eulerOrder=this.eulerOrder,x.scale.copy(this.scale),x.rotationAutoUpdate=this.rotationAutoUpdate,x.matrix.copy(this.matrix),x.matrixWorld.copy(this.matrixWorld),x.quaternion.copy(this.quaternion),x.matrixAutoUpdate=this.matrixAutoUpdate,x.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,x.useQuaternion=this.useQuaternion,x.visible=this.visible;for(var ie=0;ie<this.children.length;ie++){var xe=this.children[ie];x.add(xe.clone())}return x}setVisible(x){this.visible=x;for(var ie=0;ie<this.children.length;ie++)this.children[ie].setVisible(x)}}class ue extends Me{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(x){if(x instanceof P)this.__lights.indexOf(x)===-1&&this.__lights.push(x),x.target&&x.target.parent===void 0&&this.add(x.target);else if(this.__objects.indexOf(x)===-1){this.__objects.push(x),this.__objectsAdded.push(x);var ie=this.__objectsRemoved.indexOf(x);ie!==-1&&this.__objectsRemoved.splice(ie,1)}for(var xe=0;xe<x.children.length;xe++)this.__addObject(x.children[xe])}__removeObject(x){var ie;x instanceof P?(ie=this.__lights.indexOf(x))!==-1&&this.__lights.splice(ie,1):(ie=this.__objects.indexOf(x))!==-1&&(this.__objects.splice(ie,1),this.__objectsRemoved.push(x),this.__objectsAdded.indexOf(x)!==-1&&this.__objectsAdded.splice(ie,1));for(var xe=0;xe<x.children.length;xe++)this.__removeObject(x.children[xe])}}class P extends Me{constructor(x,ie=1){super(),this.position=new p.Vector3(0,1,0),this.target=new Me,this.castShadow=!1,this.onlyShadow=!1,this.color=new j.Color(x),this.intensity=ie}}const ce=new p.Matrix4;class se{static unprojectVector(x,ie){return ie.projectionMatrixInverse.getInverse(ie.projectionMatrix),ce.multiplyMatrices(ie.matrixWorld,ie.projectionMatrixInverse),x.applyProjection(ce)}static projectVector(x,ie){return ie.matrixWorldInverse.getInverse(ie.matrixWorld),ce.multiplyMatrices(ie.projectionMatrix,ie.matrixWorldInverse),x.applyProjection(ce)}projectVector(x,ie){return se.projectVector(x,ie)}unprojectVector(x,ie){return se.unprojectVector(x,ie)}}var X=a(99);const Re=(Bt,x)=>Bt.distance-x.distance,fe=new p.Matrix4;class De{constructor(x,ie,xe,Ve){this.precision=1e-4,this.linePrecision=.2,this.ray=new p.Ray(x,ie),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=Ve||0,this.far=xe||1/0}set(x,ie){this.ray.set(x,ie)}setFromCamera(x,ie){ie.ortho?(this.ray.origin.set(x.x,x.y,(ie.near+ie.far)/(ie.near-ie.far)).unproject(ie),this.ray.direction.set(0,0,-1).transformDirection(ie.matrixWorld)):(this.ray.origin.setFromMatrixPosition(ie.matrixWorld),this.ray.direction.set(x.x,x.y,x.z),ie.projectionMatrixInverse.getInverse(ie.projectionMatrix),fe.multiplyMatrices(ie.matrixWorld,ie.projectionMatrixInverse),this.ray.direction.applyProjection(fe),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(x,ie){for(var xe=[],Ve=0,Oe=ie.length;Ve<Oe;Ve++)Ft(x,ie[Ve],this,xe);return xe.sort(Re),xe}}const We=Bt=>Math.min(Math.max(Bt,-1),1);var oe=new X.Sphere,Ae=new X.Cylinder,He=new X.Triangle,Ue=new p.Vector3,Ie=new p.Vector3,rt=new p.Vector3,st=new p.Vector3,at=new p.Vector3;function Ft(Bt,x,ie,xe){if(at.getPositionFromMatrix(Bt.matrixWorld),x.intersectionShape===void 0||x.hidden)return xe;var Ve,Oe,yt,lt,mt,Mt,Pt,Ot,gr,Yt,Cr,Er,Ur,_r,Or=x.intersectionShape,br=ie.linePrecision,Mi=(br*=Bt.matrixWorld.getMaxScaleOnAxis())*br;if(x.boundingSphere!==void 0&&x.boundingSphere instanceof X.Sphere&&(oe.copy(x.boundingSphere),oe.applyMatrix4(Bt.matrixWorld),!ie.ray.isIntersectionSphere(oe)))return xe;for(Ve=0,Oe=Or.triangle.length;Ve<Oe;Ve++)if(Or.triangle[Ve]instanceof X.Triangle){if(He.copy(Or.triangle[Ve]),He.applyMatrix4(Bt.matrixWorld),yt=He.getNormal(),(lt=ie.ray.direction.dot(yt))>=0||(Ue.subVectors(He.a,ie.ray.origin),(Pt=yt.dot(Ue)/lt)<0))continue;Ie.copy(ie.ray.direction).multiplyScalar(Pt).add(ie.ray.origin),Ie.sub(He.a),rt.copy(He.b).sub(He.a),st.copy(He.c).sub(He.a);var Qt=rt.dot(st),ri=rt.lengthSq(),ae=st.lengthSq();if((Er=(ri*Ie.dot(st)-Qt*Ie.dot(rt))/(ri*ae-Qt*Qt))<0||Er>1||(Cr=(Ie.dot(rt)-Er*Qt)/ri)<0||Cr>1||Cr+Er>1)continue;xe.push({clickable:x,distance:Pt})}for(Ve=0,Oe=Or.cylinder.length;Ve<Oe;Ve++)if(Or.cylinder[Ve]instanceof X.Cylinder){if(Ae.copy(Or.cylinder[Ve]),Ae.applyMatrix4(Bt.matrixWorld),Ue.subVectors(Ae.c1,ie.ray.origin),mt=Ue.dot(Ae.direction),Mt=Ue.dot(ie.ray.direction),(gr=1-(lt=We(ie.ray.direction.dot(Ae.direction)))*lt)==0)continue;Ur=(lt*Mt-mt)/gr,_r=(Mt-lt*mt)/gr,Ie.copy(Ae.direction).multiplyScalar(Ur).add(Ae.c1),rt.copy(ie.ray.direction).multiplyScalar(_r).add(ie.ray.origin),Ot=st.subVectors(Ie,rt).lengthSq();var r=Ae.radius*Ae.radius;if(Ot<=r){if((Cr=lt*(Er=Pt=(Yt=(lt*mt-Mt)*(lt*mt-Mt)-gr*(Ue.lengthSq()-mt*mt-r))<=0?Math.sqrt(Ot):(Mt-lt*mt-Math.sqrt(Yt))/gr)-mt)<0||Cr*Cr>Ae.lengthSq()||Er<0)continue;xe.push({clickable:x,distance:Pt})}}for(Ve=0,Oe=Or.line.length;Ve<Oe;Ve+=2){Ie.copy(Or.line[Ve]),Ie.applyMatrix4(Bt.matrixWorld),rt.copy(Or.line[Ve+1]),rt.applyMatrix4(Bt.matrixWorld),st.subVectors(rt,Ie);var s=st.lengthSq();st.normalize(),Ue.subVectors(Ie,ie.ray.origin);var l=Ue.dot(st);Mt=Ue.dot(ie.ray.direction),(gr=1-(lt=We(ie.ray.direction.dot(st)))*lt)!=0&&(Ur=(lt*Mt-l)/gr,_r=(Mt-lt*l)/gr,Ie.add(st.multiplyScalar(Ur)),rt.copy(ie.ray.direction).multiplyScalar(_r).add(ie.ray.origin),(Ot=st.subVectors(rt,Ie).lengthSq())<Mi&&Ur*Ur<s&&xe.push({clickable:x,distance:_r}))}for(Ve=0,Oe=Or.sphere.length;Ve<Oe;Ve++)if(Or.sphere[Ve]instanceof X.Sphere&&(oe.copy(Or.sphere[Ve]),oe.applyMatrix4(Bt.matrixWorld),ie.ray.isIntersectionSphere(oe))){Ie.subVectors(oe.center,ie.ray.origin);var c=Ie.dot(ie.ray.direction);if(Yt=c*c-(Ie.lengthSq()-oe.radius*oe.radius),c<0)return xe;Pt=Yt<=0?c:c-Math.sqrt(Yt),xe.push({clickable:x,distance:Pt})}return xe}class Ct{}class or extends F{constructor(x,ie){super(),this.id=ar++,this.name="",this.image=x,this.mapping=new Ct,this.wrapS=M,this.wrapT=M,this.anisotropy=1,ie?(this.format=ne,this.type=L,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=I,this.minFilter=I):(this.format=Q,this.type=T,this.offset=new p.Vector2(0,0),this.repeat=new p.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=b,this.minFilter=O),this.needsUpdate=!1,this.onUpdate=null}clone(x=new or){return x.image=this.image,x.mapping=this.mapping,x.wrapS=this.wrapS,x.wrapT=this.wrapT,x.magFilter=this.magFilter,x.minFilter=this.minFilter,x.anisotropy=this.anisotropy,x.format=this.format,x.type=this.type,x.offset.copy(this.offset),x.repeat.copy(this.repeat),x.premultiplyAlpha=this.premultiplyAlpha,x.flipY=this.flipY,x.unpackAlignment=this.unpackAlignment,x}dispose(){this.dispatchEvent({type:"dispose"})}}let ar=0;class kr extends G{constructor(x){super(),this.color=new j.Color(16777215),this.ambient=new j.Color(1048575),this.emissive=new j.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new p.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=y.SmoothShading,this.shaderID=null,this.vertexColors=h.NoColors,this.skinning=!1,this.setValues(x)}clone(x=new kr){return super.clone.call(this,x),x.color.copy(this.color),x.ambient.copy(this.ambient),x.emissive.copy(this.emissive),x.wrapAround=this.wrapAround,x.wrapRGB.copy(this.wrapRGB),x.map=this.map,x.lightMap=this.lightMap,x.specularMap=this.specularMap,x.envMap=this.envMap,x.combine=this.combine,x.reflectivity=this.reflectivity,x.refractionRatio=this.refractionRatio,x.fog=this.fog,x.shading=this.shading,x.shaderID=this.shaderID,x.vertexColors=this.vertexColors,x.skinning=this.skinning,x.morphTargets=this.morphTargets,x.morphNormals=this.morphNormals,x}}class Ar extends G{constructor(x){super(),this.color=new j.Color(16777215),this.ambient=new j.Color(1048575),this.emissive=new j.Color(0),this.wrapAround=!1,this.wrapRGB=new p.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=y.SmoothShading,this.shaderID="instanced",this.vertexColors=h.NoColors,this.skinning=!1,this.sphere=null,this.setValues(x)}clone(x=new Ar){return super.clone.call(this,x),x.color.copy(this.color),x.ambient.copy(this.ambient),x.emissive.copy(this.emissive),x.wrapAround=this.wrapAround,x.wrapRGB.copy(this.wrapRGB),x.map=this.map,x.lightMap=this.lightMap,x.specularMap=this.specularMap,x.envMap=this.envMap,x.combine=this.combine,x.reflectivity=this.reflectivity,x.refractionRatio=this.refractionRatio,x.fog=this.fog,x.shading=this.shading,x.shaderID=this.shaderID,x.vertexColors=this.vertexColors,x.skinning=this.skinning,x.morphTargets=this.morphTargets,x.morphNormals=this.morphNormals,x.sphere=this.sphere,x}}class pr extends G{constructor(x){super(),this.color=new j.Color(16777215),this.ambient=new j.Color(1048575),this.emissive=new j.Color(0),this.wrapAround=!1,this.wrapRGB=new p.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=y.SmoothShading,this.shaderID="lambert",this.vertexColors=h.NoColors,this.skinning=!1,this.setValues(x)}clone(x=new pr){return super.clone.call(this,x),x.color.copy(this.color),x.ambient.copy(this.ambient),x.emissive.copy(this.emissive),x.wrapAround=this.wrapAround,x.wrapRGB.copy(this.wrapRGB),x.map=this.map,x.lightMap=this.lightMap,x.specularMap=this.specularMap,x.envMap=this.envMap,x.combine=this.combine,x.reflectivity=this.reflectivity,x.refractionRatio=this.refractionRatio,x.fog=this.fog,x.shading=this.shading,x.shaderID=this.shaderID,x.vertexColors=this.vertexColors,x.skinning=this.skinning,x.morphTargets=this.morphTargets,x.morphNormals=this.morphNormals,x}}class vr extends pr{constructor(x){super(x),this.shaderID="lambertdouble",this.side=u,this.outline=!1}clone(x=new vr){return super.clone.call(this,x),x}}class xr extends G{constructor(x){super(),x=x||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=j.CC.color(x.color||new j.Color(0,0,0)),this.outlineWidth=x.width||.1,this.outlinePushback=x.pushback||1,this.outlineMaxPixels=x.maxpixels||0}clone(x=new xr){return super.clone.call(this,x),x.fog=this.fog,x.shaderID=this.shaderID,x.wireframe=this.wireframe,x.outlineColor=this.outlineColor,x.outlineWidth=this.outlineWidth,x.outlinePushback=this.outlinePushback,x.outlineMaxPixels=this.outlineMaxPixels,x}}class fi extends kr{constructor(x){super(x),this.shaderID="sphereimposter",this.setValues(x)}clone(x=new fi){return super.clone.call(this,x),x}}class Rr extends kr{constructor(x){super(x),x=x||{},this.shaderID="sphereimposteroutline",this.outlineColor=j.CC.color(x.color||new j.Color(0,0,0)),this.outlineWidth=x.width||.1,this.outlinePushback=x.pushback||1,this.outlineMaxPixels=x.maxpixels||0,this.setValues(x)}clone(x=new Rr){return super.clone.call(this,x),x.outlineColor=this.outlineColor,x.outlineWidth=this.outlineWidth,x.outlinePushback=this.outlinePushback,x.outlineMaxPixels=this.outlineMaxPixels,x}}class Ir extends G{constructor(x){super(),this.color=new j.Color(16777215),this.map=new or,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new p.Vector2(0,0),this.uvScale=new p.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=w.center.clone(),this.setValues(x),(x=x||{}).depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),x.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),x.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(x=new Ir){return super.clone.call(this,x),x.color.copy(this.color),x.map=this.map,x.useScreenCoordinates=this.useScreenCoordinates,x.screenOffset=this.screenOffset,x.sizeAttenuation=this.sizeAttenuation,x.scaleByViewport=this.scaleByViewPort,x.alignment.copy(this.alignment),x.uvOffset.copy(this.uvOffset),x}}class Di extends kr{constructor(x){super(x),this.shaderID="stickimposter",this.setValues(x)}clone(x=new Di){return super.clone.call(this,x),x}}class bi extends kr{constructor(x={}){super(x),this.shaderID="stickimposteroutline",this.outlineColor=new j.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,this.outlineMaxPixels=0,x.color&&(this.outlineColor=j.CC.color(x.color)),x.width&&(this.outlineWidth=x.width),x.pushback&&(this.outlinePushback=x.pushback),x.maxpixels&&(this.outlineMaxPixels=x.maxpixels),this.setValues(x)}clone(x=new bi){return super.clone.call(this,x),x.outlineColor=this.outlineColor,x.outlineWidth=this.outlineWidth,x.outlinePushback=this.outlinePushback,x.outlineMaxPixels=this.outlineMaxPixels,x}}class Hi extends G{constructor(x){super(),this.transparent=!1,this.volumetric=!0,this.color=new j.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=m,this.setValues(x)}clone(x=new Hi){return super.clone.call(this,x),x.transparent=this.transparent,x.volumetric=this.volumetric,x.color=this.color,x.transferfn=this.transferfn,x.map=this.map,x.extent=this.extent,x.maxdepth=this.maxdepth,x.unit=this.unit,x.texmatrix=this.texmatrix,x.transfermin=this.transfermin,x.transfermax=this.transfermax,x.subsamples=this.subsamples,x.shaderID=this.shaderID,x.side=this.side,x}}var pe;(function(Bt){Bt[Bt.LineStrip=0]="LineStrip",Bt[Bt.LinePieces=1]="LinePieces"})(pe||(pe={}));class Se extends Me{constructor(x,ie=new N({color:16777215*Math.random()}),xe=pe.LineStrip){super(),this.geometry=x,this.material=ie,this.type=xe}clone(x=new Se(this.geometry,this.material,this.type)){return super.clone.call(this,x),x}}class Le extends Me{constructor(x,ie){super(),this.geometry=x,this.material=ie}clone(x){return x===void 0&&(x=new Le(this.geometry,this.material)),super.clone.call(this,x),x}}class dt extends Me{constructor(x=new Ir){super(),this.material=x,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),this.scale.x===1&&this.scale.y===1||this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(x=new dt(this.material)){return Me.prototype.clone.call(this,x),x}}const nt={opacity:{type:"f",value:1},fogColor:{type:"c",value:new j.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}},zt={vertexShader:`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;
varying vec4 mvPosition;

void main() {

    vColor = color;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`.replace("#define GLSLIFY 1",""),fragmentShader:`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`.replace("#define GLSLIFY 1",""),uniforms:nt},ht={opacity:{type:"f",value:1},fogColor:{type:"c",value:new j.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},Lt={fragmentShader:`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`.replace("#define GLSLIFY 1",""),uniforms:ht},Ut={opacity:{type:"f",value:1},fogColor:{type:"c",value:new j.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},It={fragmentShader:`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
varying vec4 mvPosition;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}`.replace("#define GLSLIFY 1",""),vertexShader:`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`.replace("#define GLSLIFY 1",""),uniforms:Ut},mr={opacity:{type:"f",value:1},fogColor:{type:"c",value:new j.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},li={fragmentShader:`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}


`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`.replace("#define GLSLIFY 1",""),uniforms:mr},Ci={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new j.Color(0,0,0)},fogColor:{type:"c",value:new j.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}},ui={fragmentShader:`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec4 mvPosition;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float vWidth;
uniform float vHeight;
uniform float outlineMaxPixels;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec4 mvPosition;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    vec4 outpos = projectionMatrix * mvPosition;

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*modelViewMatrix * vec4( position, 1.0 );
        float w = outpos.w;
        //normalize homogeneous coords
        unadjusted /= unadjusted.w;
        outpos /= outpos.w;
        vec2 diff = outpos.xy-unadjusted.xy;
        //put into pixels
        diff.x *= vWidth;
        diff.y *= vHeight;
        if ( length(diff) > outlineMaxPixels) {
            vec2 ndiff = normalize(diff)*outlineMaxPixels;
            ndiff.x /= vWidth;
            ndiff.y /= vHeight;
            outpos.xy = unadjusted.xy;
            outpos.xy += ndiff;
        }
        outpos *= w; //if I don't do this things blow up
    }
    gl_Position = outpos;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`.replace("#define GLSLIFY 1",""),uniforms:Ci},gi={fragmentShader:`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `.replace("#define GLSLIFY 1",""),vertexShader:`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `.replace("#define GLSLIFY 1",""),uniforms:{}},jr={fragmentShader:`
        
precision highp float;
precision highp int;
precision highp sampler2D;

uniform sampler2D tColor;
varying highp vec2 vTexCoords;

// adapted from https://github.com/kosua20/Rendu
// MIT License Copyright (c) 2017 Simon Rodriguez
// by way of molstar (https://github.com/molstar/molstar/blob/master/src/mol-gl/shader/fxaa.frag.ts)

#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))

float rgb2luma(vec3 rgb){
    return sqrt(dot(rgb, vec3(0.299, 0.587, 0.114)));
}

float sampleLuma(vec2 uv) {
    return rgb2luma(texture2D(tColor, uv).rgb);
}

float sampleLuma(vec2 uv, float uOffset, float vOffset) {
    uv += vec2(uOffset, vOffset);
    return sampleLuma(uv);
}

//DEFINEFRAGCOLOR
void main(void) {
    ivec2 dim = textureSize(tColor,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseScreenSize = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec2 coords = vTexCoords;

    vec4 colorCenter = texture2D(tColor, coords);
    float dEdgeThresholdMin = 0.0312;
    float dEdgeThresholdMax = 0.125;
    int dIterations = 12;
    float dSubpixelQuality = 0.3;

    // Luma at the current fragment
    float lumaCenter = rgb2luma(colorCenter.rgb);

    // Luma at the four direct neighbours of the current fragment.
    float lumaDown = sampleLuma(coords, 0.0, -inverseScreenSize.y);
    float lumaUp = sampleLuma(coords, 0.0, inverseScreenSize.y);
    float lumaLeft = sampleLuma(coords, -inverseScreenSize.x, 0.0);
    float lumaRight = sampleLuma(coords, inverseScreenSize.x, 0.0);

    // Find the maximum and minimum luma around the current fragment.
    float lumaMin = min(lumaCenter, min(min(lumaDown, lumaUp), min(lumaLeft, lumaRight)));
    float lumaMax = max(lumaCenter, max(max(lumaDown, lumaUp), max(lumaLeft, lumaRight)));

    // Compute the delta.
    float lumaRange = lumaMax - lumaMin;

    // If the luma variation is lower that a threshold (or if we are in a really dark area),
    // we are not on an edge, don't perform any AA.
    if (lumaRange < max(dEdgeThresholdMin, lumaMax * dEdgeThresholdMax)) {
        gl_FragColor = colorCenter;
        return;
    }

    // Query the 4 remaining corners lumas.
    float lumaDownLeft = sampleLuma(coords, -inverseScreenSize.x, -inverseScreenSize.y);
    float lumaUpRight = sampleLuma(coords, inverseScreenSize.x, inverseScreenSize.y);
    float lumaUpLeft = sampleLuma(coords, -inverseScreenSize.x, inverseScreenSize.y);
    float lumaDownRight = sampleLuma(coords, inverseScreenSize.x, -inverseScreenSize.y);

    // Combine the four edges lumas (using intermediary variables for future computations
    // with the same values).
    float lumaDownUp = lumaDown + lumaUp;
    float lumaLeftRight = lumaLeft + lumaRight;

    // Same for corners
    float lumaLeftCorners = lumaDownLeft + lumaUpLeft;
    float lumaDownCorners = lumaDownLeft + lumaDownRight;
    float lumaRightCorners = lumaDownRight + lumaUpRight;
    float lumaUpCorners = lumaUpRight + lumaUpLeft;

    // Compute an estimation of the gradient along the horizontal and vertical axis.
    float edgeHorizontal = abs(-2.0 * lumaLeft + lumaLeftCorners) + abs(-2.0 * lumaCenter + lumaDownUp) * 2.0 + abs(-2.0 * lumaRight + lumaRightCorners);
    float edgeVertical = abs(-2.0 * lumaUp + lumaUpCorners) + abs(-2.0 * lumaCenter + lumaLeftRight) * 2.0 + abs(-2.0 * lumaDown + lumaDownCorners);

    // Is the local edge horizontal or vertical ?
    bool isHorizontal = (edgeHorizontal >= edgeVertical);

    // Choose the step size (one pixel) accordingly.
    float stepLength = isHorizontal ? inverseScreenSize.y : inverseScreenSize.x;

    // Select the two neighboring texels lumas in the opposite direction to the local edge.
    float luma1 = isHorizontal ? lumaDown : lumaLeft;
    float luma2 = isHorizontal ? lumaUp : lumaRight;
    // Compute gradients in this direction.
    float gradient1 = luma1 - lumaCenter;
    float gradient2 = luma2 - lumaCenter;

    // Which direction is the steepest ?
    bool is1Steepest = abs(gradient1) >= abs(gradient2);

    // Gradient in the corresponding direction, normalized.
    float gradientScaled = 0.25 * max(abs(gradient1), abs(gradient2));

    // Average luma in the correct direction.
    float lumaLocalAverage = 0.0;
    if(is1Steepest){
        // Switch the direction
        stepLength = -stepLength;
        lumaLocalAverage = 0.5 * (luma1 + lumaCenter);
    } else {
        lumaLocalAverage = 0.5 * (luma2 + lumaCenter);
    }

    // Shift UV in the correct direction by half a pixel.
    vec2 currentUv = coords;
    if(isHorizontal){
        currentUv.y += stepLength * 0.5;
    } else {
        currentUv.x += stepLength * 0.5;
    }

    // Compute offset (for each iteration step) in the right direction.
    vec2 offset = isHorizontal ? vec2(inverseScreenSize.x, 0.0) : vec2(0.0, inverseScreenSize.y);
    // Compute UVs to explore on each side of the edge, orthogonally.
    // The QUALITY allows us to step faster.
    vec2 uv1 = currentUv - offset * QUALITY(0);
    vec2 uv2 = currentUv + offset * QUALITY(0);

    // Read the lumas at both current extremities of the exploration segment,
    // and compute the delta wrt to the local average luma.
    float lumaEnd1 = sampleLuma(uv1);
    float lumaEnd2 = sampleLuma(uv2);
    lumaEnd1 -= lumaLocalAverage;
    lumaEnd2 -= lumaLocalAverage;

    // If the luma deltas at the current extremities is larger than the local gradient,
    // we have reached the side of the edge.
    bool reached1 = abs(lumaEnd1) >= gradientScaled;
    bool reached2 = abs(lumaEnd2) >= gradientScaled;
    bool reachedBoth = reached1 && reached2;

    // If the side is not reached, we continue to explore in this direction.
    if(!reached1){
        uv1 -= offset * QUALITY(1);
    }
    if(!reached2){
        uv2 += offset * QUALITY(1);
    }

    // If both sides have not been reached, continue to explore.
    if(!reachedBoth){
        for(int i = 2; i < dIterations; i++){
            // If needed, read luma in 1st direction, compute delta.
            if(!reached1){
                lumaEnd1 = sampleLuma(uv1);
                lumaEnd1 = lumaEnd1 - lumaLocalAverage;
            }
            // If needed, read luma in opposite direction, compute delta.
            if(!reached2){
                lumaEnd2 = sampleLuma(uv2);
                lumaEnd2 = lumaEnd2 - lumaLocalAverage;
            }
            // If the luma deltas at the current extremities is larger than the local gradient,
            // we have reached the side of the edge.
            reached1 = abs(lumaEnd1) >= gradientScaled;
            reached2 = abs(lumaEnd2) >= gradientScaled;
            reachedBoth = reached1 && reached2;

            // If the side is not reached, we continue to explore in this direction,
            // with a variable quality.
            if(!reached1){
                uv1 -= offset * QUALITY(i);
            }
            if(!reached2){
                uv2 += offset * QUALITY(i);
            }

            // If both sides have been reached, stop the exploration.
            if(reachedBoth){
                break;
            }
        }
    }

    // Compute the distances to each side edge of the edge (!).
    float distance1 = isHorizontal ? (coords.x - uv1.x) : (coords.y - uv1.y);
    float distance2 = isHorizontal ? (uv2.x - coords.x) : (uv2.y - coords.y);

    // In which direction is the side of the edge closer ?
    bool isDirection1 = distance1 < distance2;
    float distanceFinal = min(distance1, distance2);

    // Thickness of the edge.
    float edgeThickness = (distance1 + distance2);

    // Is the luma at center smaller than the local average ?
    bool isLumaCenterSmaller = lumaCenter < lumaLocalAverage;

    // If the luma at center is smaller than at its neighbour,
    // the delta luma at each end should be positive (same variation).
    bool correctVariation1 = (lumaEnd1 < 0.0) != isLumaCenterSmaller;
    bool correctVariation2 = (lumaEnd2 < 0.0) != isLumaCenterSmaller;

    // Only keep the result in the direction of the closer side of the edge.
    bool correctVariation = isDirection1 ? correctVariation1 : correctVariation2;

    // UV offset: read in the direction of the closest side of the edge.
    float pixelOffset = - distanceFinal / edgeThickness + 0.5;

    // If the luma variation is incorrect, do not offset.
    float finalOffset = correctVariation ? pixelOffset : 0.0;

    // Sub-pixel shifting
    // Full weighted average of the luma over the 3x3 neighborhood.
    float lumaAverage = (1.0 / 12.0) * (2.0 * (lumaDownUp + lumaLeftRight) + lumaLeftCorners + lumaRightCorners);
    // Ratio of the delta between the global average and the center luma,
    // over the luma range in the 3x3 neighborhood.
    float subPixelOffset1 = clamp(abs(lumaAverage - lumaCenter) / lumaRange, 0.0, 1.0);
    float subPixelOffset2 = (-2.0 * subPixelOffset1 + 3.0) * subPixelOffset1 * subPixelOffset1;
    // Compute a sub-pixel offset based on this delta.
    float subPixelOffsetFinal = subPixelOffset2 * subPixelOffset2 * float(dSubpixelQuality);

    // Pick the biggest of the two offsets.
    finalOffset = max(finalOffset, subPixelOffsetFinal);

    // Compute the final UV coordinates.
    vec2 finalUv = coords;
    if(isHorizontal){
        finalUv.y += finalOffset * stepLength;
    } else {
        finalUv.x += finalOffset * stepLength;
    }

    // Read the color at the new UV coordinates, and use it.
    gl_FragColor = texture2D(tColor, finalUv);
}        

/* old fxaa implementation
uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec4 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP);
    vec4 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP);
    vec4 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP);
    vec4 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP);
    vec4 rgbM  = texture2D(tex, fragCoord );
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW.xyz, luma);
    float lumaNE = dot(rgbNE.xyz, luma);
    float lumaSW = dot(rgbSW.xyz, luma);
    float lumaSE = dot(rgbSE.xyz, luma);
    float lumaM  = dot(rgbM.xyz,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec4 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)) +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)));
    vec4 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5) +
        texture2D(tex, fragCoord  + dir * 0.5));

    float lumaB = dot(rgbB.xyz, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = rgbA;
    else
        color = rgbB;

    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        
*/`.replace("#define GLSLIFY 1",""),vertexShader:`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `.replace("#define GLSLIFY 1",""),uniforms:{}},Lr={opacity:{type:"f",value:1},fogColor:{type:"c",value:new j.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},Dr={vertexShader:`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`.replace("#define GLSLIFY 1",""),fragmentShader:`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
     
}

`.replace("#define GLSLIFY 1",""),uniforms:Lr},rr={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new j.Color(0,0,0)},fogColor:{type:"c",value:new j.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}},vi={fragmentShader:`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform float vHeight;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);

    vec4 adjust = projectionMatrix* vec4(norm,normal.z,1.0); 
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+vec4(adjust.xy,0.0,0.0);

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*vec4(center.x+normal.x, center.y,center.z,1.0); 
        vec4 ccoord = projectionMatrix*vec4(center.xyz,1.0);
        adjust = projectionMatrix* vec4(center.x+norm.x,center.y,center.z,1.0); 
        //subtract center 
        unadjusted.xyz -= ccoord.xyz;
        adjust.xyz -= ccoord.xyz;
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth;
        if(diff > outlineMaxPixels) {
            
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth;
            //adjsut reval by ratio of lengths
            rval *= fixlen/abs(adjust.x);
        }

    }
}

`.replace("#define GLSLIFY 1",""),uniforms:rr},wi={fragmentShader:`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogNear != fogFar) {

        float depth = gl_FragCoord.z / gl_FragCoord.w; //probably wrong
        float fogFactor = smoothstep(fogNear, fogFar, depth);        
        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);
    }
}

`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`.replace("#define GLSLIFY 1",""),uniforms:{}},Ki={opacity:{type:"f",value:1},fogColor:{type:"c",value:new j.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},Ei=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`,Ni={fragmentShader:[Ei,`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`].join(`
`),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
    bool isperspective = (projectionMatrix[3][3] == 0.0);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(isperspective) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(isperspective) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }

    if(isperspective) { //perspective
      vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
      vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    } else {
      vec3 cr = normalize(cross(vec3(0.0,0.0,-1.0),norm))*radius;
      vec3 doublecr = normalize(cross(vec3(0.0,0.0,-1.0),cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;     
    }

    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`,uniforms:Ki},Ti={fragmentShader:Ei+`
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`,vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform mat4 projinv;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);

    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    float scale = 1.0;
    if(projectionMatrix[3][3] != 0.0) { //orthographic
        to.z -= outlinePushback;
        pt.z -= outlinePushback;
    } else { //perspective
        vec4 midbefore = pt;
        if(length(to.xyz) < length(pt)) {
            midbefore = to;
        }
        vec4 midafter = midbefore;
        midafter.xyz += normalize(midbefore.xyz)*outlinePushback;

        to.xyz += normalize(to.xyz)*outlinePushback;
        pt.xyz += normalize(pt.xyz)*outlinePushback;

        //figure out a scaling factor for radius to account for perspective setback
        vec4 midbeforer = vec4(midbefore.x+rad,midbefore.y, midbefore.z, midbefore.w);
        vec4 midafterr = vec4(midafter.x+rad,midafter.y, midafter.z, midafter.w);

        vec4 mb = projectionMatrix*midbefore;
        vec4 mbr = projectionMatrix*midbeforer;
        vec4 ma = projectionMatrix*midafter;
        vec4 mar = projectionMatrix*midafterr;
        mb /= mb.w;
        mbr /= mbr.w;
        ma /= ma.w;
        mar /= mar.w;
        scale = abs((mbr.x-mb.x)/(mar.x-ma.x));
        rad *= scale;
        r = abs(rad);
    }
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }

    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }

    if(outlineMaxPixels > 0.0) {
        vec4 cpos = mvPosition;
        vec4 unadjusted = projectionMatrix*vec4(cpos.x+abs(scale*radius), cpos.y,cpos.z,cpos.w); 
        vec4 ccoord = projectionMatrix*cpos;
        vec4 adjust = projectionMatrix*vec4(cpos.x+r,cpos.y,cpos.z,cpos.w); 
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        unadjusted.xyz -= ccoord.xyz/ccoord.w;
        adjust.xyz -= ccoord.xyz/ccoord.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth; //this should now be in pixels
        if(diff > outlineMaxPixels) {
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth; 
            vec4 pcoord = ccoord;
            pcoord.x += fixlen*pcoord.w;
            vec4 altc = projinv*pcoord;
            r= abs(altc.x-cpos.x);
        }
    }

    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`,uniforms:{opacity:{type:"f",value:1},fogColor:{type:"c",value:new j.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new j.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0},projinv:{type:"mat4",value:[]}}},pi={opacity:{type:"f",value:1},fogColor:{type:"c",value:new j.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}},Br={fragmentShader:`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `.replace("#define GLSLIFY 1",""),vertexShader:`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`.replace("#define GLSLIFY 1",""),uniforms:pi},Yr={basic:zt,blur:{fragmentShader:`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`,vertexShader:`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `,uniforms:{}},instanced:Lt,lambert:It,lambertdouble:li,outline:ui,screen:gi,screenaa:jr,ssao:{fragmentShader:`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`,vertexShader:`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `,uniforms:{total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}},sphereimposter:Dr,sphereimposteroutline:vi,sprite:wi,stickimposter:Ni,stickimposteroutline:Ti,volumetric:Br};function Vi(Bt){let x={};for(const xe in Bt){x[xe]={},x[xe].type=Bt[xe].type;var ie=Bt[xe].value;ie instanceof j.Color?x[xe].value=ie.clone():typeof ie=="number"?x[xe].value=ie:ie instanceof Array?x[xe].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return x}const yi={clone:Vi};class Wi extends Me{constructor(x=50,ie=1,xe=.1,Ve=2e3,Oe=!1){super(),this.projectionMatrix=new p.Matrix4,this.projectionMatrixInverse=new p.Matrix4,this.matrixWorldInverse=new p.Matrix4,this.fov=x,this.aspect=ie,this.near=xe,this.far=Ve;var yt=this.position.z;this.right=yt*Math.tan(Math.PI/180*x),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!Oe,this.updateProjectionMatrix()}lookAt(x){this.matrix.lookAt(this.position,x,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof p.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}class tn{constructor(x,ie=1,xe=1e3){this.name="",this.color=new j.Color(x),this.near=ie,this.far=xe}clone(){return new tn(this.color.getHex(),this.near,this.far)}}class on{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(x){this.gl=x.context,this.renderer=x,this.precision=x.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var ie=0;this.sprite.vertices[ie++]=-1,this.sprite.vertices[ie++]=-1,this.sprite.vertices[ie++]=0,this.sprite.vertices[ie++]=0,this.sprite.vertices[ie++]=1,this.sprite.vertices[ie++]=-1,this.sprite.vertices[ie++]=1,this.sprite.vertices[ie++]=0,this.sprite.vertices[ie++]=1,this.sprite.vertices[ie++]=1,this.sprite.vertices[ie++]=1,this.sprite.vertices[ie++]=1,this.sprite.vertices[ie++]=-1,this.sprite.vertices[ie++]=1,this.sprite.vertices[ie++]=0,this.sprite.vertices[ie++]=1,ie=0,this.sprite.faces[ie++]=0,this.sprite.faces[ie++]=1,this.sprite.faces[ie++]=2,this.sprite.faces[ie++]=0,this.sprite.faces[ie++]=2,this.sprite.faces[ie++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(Yr.sprite,this.precision||1),this.sprite.attributes={};const xe={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),xe.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),xe.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),xe.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),xe.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),xe.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),xe.color=this.gl.getUniformLocation(this.sprite.program,"color"),xe.map=this.gl.getUniformLocation(this.sprite.program,"map"),xe.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),xe.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),xe.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),xe.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),xe.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),xe.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),xe.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),xe.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),xe.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=xe}render(x,ie,xe,Ve,Oe){var yt,lt,mt,Mt,Pt,Ot,gr,Yt,Cr,Er;if(!this.gl)throw new Error("WebGLRenderer not initialized");let Ur=[];(yt=x?.__webglSprites)===null||yt===void 0||yt.forEach(C=>{(Oe&&C.material.depthTest==0||!Oe&&C.material.depthTest)&&Ur.push(C)});let _r=Ur.length;if(!_r)return;const Or=this.sprite.attributes,br=this.sprite.uniforms;if(!br)throw new Error("Uniforms not defined");var Mi=.5*xe,Qt=.5*Ve;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(Or.position),this.gl.enableVertexAttribArray(Or.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(Or.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(Or.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(br.projectionMatrix,!1,ie.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(br.map,0);var ri,ae=x.fog;let r,s,l;ae?(this.gl.uniform3f(br.fogColor,ae.color.r,ae.color.g,ae.color.b),this.gl.uniform1f(br.fogNear,ae.near),this.gl.uniform1f(br.fogFar,ae.far)):(this.gl.uniform1f(br.fogNear,0),this.gl.uniform1f(br.fogFar,0));let c=[];for(ri=0;ri<_r;ri++)r=Ur[ri],s=r.material,s&&(s.depthTest!=0||Oe)&&r.visible&&s.opacity!==0&&(s.useScreenCoordinates?r.z=-r.position.z:(r._modelViewMatrix.multiplyMatrices(ie.matrixWorldInverse,r.matrixWorld),r.z=-r._modelViewMatrix.elements[14]));for(Ur.sort(ur),ri=0;ri<_r;ri++)if(r=Ur[ri],s=r.material,s&&r.visible&&s.opacity!==0&&s.map&&s.map.image&&s.map.image.width){this.gl.uniform1f(br?.alphaTest||null,s.alphaTest);var A=s.map.image.width,g=s.map.image.height;c[0]=A*this.renderer.devicePixelRatio/xe,c[1]=g*this.renderer.devicePixelRatio/Ve,s.useScreenCoordinates===!0?(this.gl.uniform1i(br.useScreenCoordinates,1),this.gl.uniform3f(br.screenPosition,(r.position.x*this.renderer.devicePixelRatio-Mi)/Mi,(Qt-r.position.y*this.renderer.devicePixelRatio)/Qt,Math.max(0,Math.min(1,r.position.z)))):(this.gl.uniform1i(br.useScreenCoordinates,0),this.gl.uniformMatrix4fv(br.modelViewMatrix,!1,r._modelViewMatrix.elements)),l=1/(s.scaleByViewport?Ve:1),c[0]*=l*r.scale.x,c[1]*=l*r.scale.y;let C=(lt=s?.alignment)===null||lt===void 0?void 0:lt.x,E=(mt=s?.alignment)===null||mt===void 0?void 0:mt.y;s.screenOffset&&(C=(C||0)+2*s.screenOffset.x/A,E=(E||0)+2*s.screenOffset.y/g),this.gl.uniform2f(br.uvScale,((Mt=s?.uvScale)===null||Mt===void 0?void 0:Mt.x)||1,((Pt=s?.uvScale)===null||Pt===void 0?void 0:Pt.y)||1),this.gl.uniform2f(br.uvOffset,((Ot=s?.uvOffset)===null||Ot===void 0?void 0:Ot.x)||0,((gr=s?.uvOffset)===null||gr===void 0?void 0:gr.y)||0),this.gl.uniform2f(br.alignment,C||0,E||0),this.gl.uniform1f(br.opacity,s.opacity),this.gl.uniform3f(br.color,((Yt=s?.color)===null||Yt===void 0?void 0:Yt.r)||0,((Cr=s?.color)===null||Cr===void 0?void 0:Cr.g)||0,((Er=s?.color)===null||Er===void 0?void 0:Er.b)||0),this.gl.uniform1f(br.rotation,r.rotation),this.gl.uniform2fv(br.scale,c),this.renderer.setDepthTest(s.depthTest),this.renderer.setDepthWrite(s.depthWrite),this.renderer.setTexture(s.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(x,ie){if(!this.gl)throw new Error("WebGL Rendering context not found");var xe=this.gl.createProgram();if(!xe)throw new Error("Error creating webgl program");var Ve=this.gl.createShader(this.gl.FRAGMENT_SHADER),Oe=this.gl.createShader(this.gl.VERTEX_SHADER);if(!Ve)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!Oe)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var yt="precision "+ie+` float;
`;if(this.gl.shaderSource(Ve,yt+x.fragmentShader),this.gl.shaderSource(Oe,yt+x.vertexShader),this.gl.compileShader(Ve),this.gl.compileShader(Oe),!this.gl.getShaderParameter(Ve,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(Oe,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(Ve)} 
      ${this.gl.getShaderInfoLog(Oe)}`);return this.gl.attachShader(xe,Ve),this.gl.attachShader(xe,Oe),this.gl.linkProgram(xe),this.gl.getProgramParameter(xe,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),xe}}function ur(Bt,x){return Bt.z!==x.z?x.z-Bt.z:x.id-Bt.id}var Gr=null,Kr=null;class Zi{constructor(x){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._offscreen=null,this._bitmap=null,this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new p.Vector3,this._worldInverse=new p.Matrix4,this._projInverse=new p.Matrix4,this._textureMatrix=new p.Matrix4,this._fullProjModelMatrix=new p.Matrix4,this._fullProjModelMatrixInv=new p.Matrix4,this._direction=new p.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new on,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._upscale=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,x=x||{},this.row=x.row,this.col=x.col,this.rows=x.rows,this.cols=x.cols,this._canvas=x.canvas!==void 0?x.canvas:document.createElement("canvas"),this._precision=x.precision!==void 0?x.precision:"highp",this._alpha=x.alpha===void 0||x.alpha,this._premultipliedAlpha=x.premultipliedAlpha===void 0||x.premultipliedAlpha,this._antialias=x.antialias!==void 0&&x.antialias,this._upscale=x.upscale!==void 0?x.upscale:this._antialias,this._preserveDrawingBuffer=x.preserveDrawingBuffer!==void 0&&x.preserveDrawingBuffer,this._clearColor=x.clearColor!==void 0?new j.Color(x.clearColor):new j.Color(0),this._clearAlpha=x.clearAlpha!==void 0?x.clearAlpha:0,this._outlineMaterial=new xr(x.outline),this._outlineSphereImposterMaterial=new Rr(x.outline),this._outlineStickImposterMaterial=new bi(x.outline),this._outlineEnabled=!!x.outline,this._AOEnabled=!!x.ambientOcclusion,x.ambientOcclusion&&x.ambientOcclusion.strength!==void 0&&(this._AOstrength=parseFloat(x.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),x.ambientOcclusion&&x.ambientOcclusion.radius!==void 0&&(this._AOradius=parseFloat(x.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=x.id,x.containerWidth!=0&&x.containerHeight!=0&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(x,ie){this._clearColor.setHex(x),this._clearAlpha=ie,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(x){this._outlineMaterial=new xr(x),this._outlineSphereImposterMaterial=new Rr(x),this._outlineStickImposterMaterial=new bi(x),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(x){x&&(x.strength&&(this._AOstrength=x.strength),x.scale&&(this._AOradius=x.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this._offscreen&&(this._offscreen.width=this._canvas.width,this._offscreen.height=this._canvas.height),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null&&!this.isLost()){var x=this._gl.drawingBufferWidth/this.cols,ie=this._gl.drawingBufferHeight/this.rows;this._viewportWidth=x,this._viewportHeight=ie,this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(x*this.col,ie*this.row,x,ie),this._gl.viewport(x*this.col,ie*this.row,x,ie)}}setSize(x,ie){this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._upscale&&this.devicePixelRatio<2&&(this.devicePixelRatio=2),this._canvas.width=x*this.devicePixelRatio,this._canvas.height=ie*this.devicePixelRatio,this._canvas.style.width=x+"px",this._canvas.style.height=ie+"px",this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null?(this.isLost()||(this._viewportWidth=this._gl.drawingBufferWidth/this.cols,this._viewportHeight=this._gl.drawingBufferHeight/this.rows),this.setViewport()):(this._viewportWidth=this._canvas.width,this._viewportHeight=this._canvas.height,this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight)),this.initFrameBuffer()}clear(x,ie,xe){var Ve=0;(x===void 0||x)&&(Ve|=this._gl.COLOR_BUFFER_BIT),(ie===void 0||ie)&&(Ve|=this._gl.DEPTH_BUFFER_BIT),(xe===void 0||xe)&&(Ve|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(Ve)}setMaterialFaces(x,ie){var xe=x.side===u,Ve=x.side===z;x.imposter||(Ve=ie?!Ve:Ve),this._oldDoubleSided!==xe&&(xe?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=xe),this._oldFlipSided!==Ve&&(Ve?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=Ve),this._gl.cullFace(this._gl.BACK)}setDepthTest(x){this._oldDepthTest!==x&&(x?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=x)}setDepthWrite(x){this._oldDepthWrite!==x&&(this._gl.depthMask(x),this._oldDepthWrite=x)}setBlending(x){x?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(x,ie,xe,Ve){var Oe,yt;if(x.addEventListener("dispose",this.onMaterialDispose.bind(this)),yt=x.shaderID){var lt=Yr[yt];x.vertexShader=lt.vertexShader,x.fragmentShader=lt.fragmentShader,x.uniforms=yi.clone(lt.uniforms),x.shaded&&x.makeShaded(this.SHADE_TEXTURE)}Oe={wireframe:x.wireframe,fragdepth:x.imposter,volumetric:x.volumetric,shaded:x.shaded},x.program=this.buildProgram(x.fragmentShader,x.vertexShader,x.uniforms,Oe)}renderBuffer(x,ie,xe,Ve,Oe,yt){var lt,mt;if(Ve.visible&&(lt=this.setProgram(x,ie,xe,Ve,yt,this))){mt=lt.attributes;var Mt,Pt,Ot=!1,gr=Ve.wireframe?1:0,Yt=16777215*Oe.id+2*lt.id+gr;if(Yt!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=Yt,Ot=!0),Ot&&(this.disableAttributes(),mt.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglVertexBuffer),this.enableAttribute(mt.position),this._gl.vertexAttribPointer(mt.position,3,this._gl.FLOAT,!1,0,0)),mt.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglColorBuffer),this.enableAttribute(mt.color),this._gl.vertexAttribPointer(mt.color,3,this._gl.FLOAT,!1,0,0)),mt.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglNormalBuffer),this.enableAttribute(mt.normal),this._gl.vertexAttribPointer(mt.normal,3,this._gl.FLOAT,!1,0,0)),mt.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglOffsetBuffer),this.enableAttribute(mt.offset),this._gl.vertexAttribPointer(mt.offset,3,this._gl.FLOAT,!1,0,0)),mt.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglRadiusBuffer),this.enableAttribute(mt.radius),this._gl.vertexAttribPointer(mt.radius,1,this._gl.FLOAT,!1,0,0))),yt instanceof Le){if(Ve.shaderID==="instanced"){var Cr=Ve.sphere.geometryGroups[0];Ot&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Cr.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Cr.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,Oe.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,Cr.faceArray,this._gl.STATIC_DRAW)),Mt=Cr.faceidx,this._extInstanced.vertexAttribDivisorANGLE(mt.offset,1),this._extInstanced.vertexAttribDivisorANGLE(mt.radius,1),this._extInstanced.vertexAttribDivisorANGLE(mt.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,Mt,this._gl.UNSIGNED_SHORT,0,Oe.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(mt.offset,0),this._extInstanced.vertexAttribDivisorANGLE(mt.radius,0),this._extInstanced.vertexAttribDivisorANGLE(mt.color,0)}else Ve.wireframe?(Pt=Oe.lineidx,this.setLineWidth(Ve.wireframeLinewidth),Ot&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,Oe.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,Pt,this._gl.UNSIGNED_SHORT,0)):(Mt=Oe.faceidx,Ot&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,Oe.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,Mt,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=Mt,this.info.render.faces+=Mt/3}else yt instanceof Se&&(Pt=Oe.vertices,this.setLineWidth(Ve.linewidth),this._gl.drawArrays(this._gl.LINES,0,Pt),this.info.render.calls++)}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(x,ie,xe){let Ve=x.__lights,Oe=x.fog,yt=[];for(let Mt=0,Pt=x.__webglObjects.length;Mt<Pt;Mt++){let Ot=x.__webglObjects[Mt];Ot.render&&Ot[xe]&&yt.push(Ot)}if(yt.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(x.__webglObjects,!0,xe+"Depth",ie,Ve,Oe,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let lt=this._AOshader.uniforms;this._gl.uniform1f(lt.total_strength,this._AOstrength),this._gl.uniform1f(lt.radius,this._AOradius),this._fullProjModelMatrix=new p.Matrix4,this._fullProjModelMatrixInv=new p.Matrix4;let mt=yt[0].object;this._fullProjModelMatrix.multiplyMatrices(ie.projectionMatrix,mt._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(lt.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(lt.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(x,ie){if(ie instanceof Wi==0)return void console.error("Renderer.render: camera is not an instance of Camera.");var xe,Ve,Oe,yt,lt,mt=x.__lights,Mt=x.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&x.updateMatrixWorld(),ie.parent===void 0&&ie.updateMatrixWorld(),ie.matrixWorldInverse.getInverse(ie.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(x),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),lt=x.__webglObjects;let Pt=!1,Ot=this._AOEnabled;for(xe=0,Ve=lt.length;xe<Ve;xe++)yt=(Oe=lt[xe]).object,Oe.render=!1,yt.visible&&(this.setupMatrices(yt,ie),this.unrollBufferMaterial(Oe),Oe.render=!0,Oe.volumetric&&(Pt=!0),Oe.hasAO&&(Ot=!0));if(this.setBlending(!1),Ot&&this.setShading(x,ie,"opaque"),this.renderObjects(x.__webglObjects,!0,"opaque",ie,mt,Mt,!1),Ot&&this.clearShading(),this.renderSprites(x,ie,!1),this.renderObjects(x.__webglObjects,!0,"transparentDepth",ie,mt,Mt,!0),this.renderObjects(x.__webglObjects,!1,"transparent",ie,mt,Mt,!0),Pt&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(x.__webglObjects,!1,"volumetric",ie,mt,Mt,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(x,ie,!0),this._bitmap){const gr=this._offscreen.transferToImageBitmap();this._bitmap.transferFromImageBitmap(gr),gr.close()}}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let x=this._viewportWidth,ie=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,x,ie),this._gl.viewport(0,0,x,ie),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,x,ie,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,x,ie,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,x,ie,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,x,ie,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let x=this._viewportWidth,ie=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,x,ie),this._gl.viewport(0,0,x,ie),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var xe=this._antialias?Yr.screenaa:Yr.screen;this._screenshader=this.buildProgram(xe.fragmentShader,xe.vertexShader,xe.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition"),this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([1,1,-1,1,-1,-1,-1,-1,1,-1,1,1]),this._gl.STATIC_DRAW);let Ve=Yr.ssao;this._AOshader=this.buildProgram(Ve.fragmentShader,Ve.vertexShader,Ve.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let Oe=Yr.blur;this._blurshader=this.buildProgram(Oe.fragmentShader,Oe.vertexShader,Oe.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(x){if(x.__webglObjects||(x.__webglObjects=[],x.__webglObjectsImmediate=[],x.__webglSprites=[],x.__webglFlares=[]),x.__objectsAdded.length){for(;x.__objectsAdded.length;)this.addObject(x.__objectsAdded[0],x),x.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;x.__objectsRemoved.length;)this.removeObject(x.__objectsRemoved[0],x),x.__objectsRemoved.splice(0,1);for(var ie=0,xe=x.__webglObjects.length;ie<xe;ie++)this.updateObject(x.__webglObjects[ie].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(x,ie){x!=null&&ie!=null||(x=this._canvas.width,ie=this._canvas.height);var xe=x/ie;return this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null&&(xe=x/this.cols/(ie/this.rows)),xe}setTexture(x,ie,xe){if(x.needsUpdate){x.__webglInit||(x.__webglInit=!0,x.addEventListener("dispose",this.onTextureDispose.bind(this)),x.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+ie);var Ve=xe?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(Ve,x.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,x.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,x.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,x.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,x.unpackAlignment);var Oe=this.paramToGL(x.format),yt=this.paramToGL(x.type);if(xe)this.setTextureParameters(this._gl.TEXTURE_3D,x),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,x.image.size.z,x.image.size.y,x.image.size.x,0,this._gl.RED,this._gl.FLOAT,x.image.data);else{var lt=x.image,mt=lt.width,Mt=lt.height;mt===void 0&&(mt=lt.length,Oe==this._gl.RGBA&&(mt/=4),Mt=1),this.setTextureParameters(this._gl.TEXTURE_2D,x),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,Oe,Oe,yt,x.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,Oe,mt,Mt,0,Oe,yt,x.image)}x.needsUpdate=!1,x.onUpdate&&x.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+ie),xe?this._gl.bindTexture(this._gl.TEXTURE_3D,x.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,x.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(x){this._enabledAttributes[x]||(this._gl.enableVertexAttribArray(x),this._enabledAttributes[x]=!0)}disableAttributes(){for(let x in this._enabledAttributes)this._enabledAttributes[x]&&(this._gl.disableVertexAttribArray(x),this._enabledAttributes[x]=!1)}setPolygonOffset(x,ie,xe){this._oldPolygonOffset!==x&&(x?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(x){x!==this._oldLineWidth&&(this._gl.lineWidth(x),this._oldLineWidth=x)}deallocateGeometry(x){if(x.__webglInit=void 0,x.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(x.__webglVertexBuffer),x.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(x.__webglColorBuffer),x.geometryGroups!==void 0)for(var ie=0,xe=x.groups;ie<xe;ie++){var Ve=x.geometryGroups[ie];Ve.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglVertexBuffer),Ve.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglColorBuffer),Ve.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglNormalBuffer),Ve.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglFaceBuffer),Ve.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglLineBuffer)}}deallocateMaterial(x){var ie=x.program;if(ie!==void 0){var xe,Ve,Oe;x.program=void 0;var yt=!1;for(xe=0,Ve=this._programs.length;xe<Ve;xe++)if((Oe=this._programs[xe]).program===ie){Oe.usedTimes--,Oe.usedTimes===0&&(yt=!0);break}if(yt===!0){var lt=[];for(xe=0,Ve=this._programs.length;xe<Ve;xe++)(Oe=this._programs[xe]).program!==ie&&lt.push(Oe);this._programs=lt,this._gl.deleteProgram(ie),this.info.memory.programs--}}}deallocateTexture(x){if(x.image&&x.image.__webglTextureCube)this._gl.deleteTexture(x.image.__webglTextureCube);else{if(!x.__webglInit)return;x.__webglInit=!1,this._gl.deleteTexture(x.__webglTexture)}}onGeometryDispose(x){var ie=x.target;ie.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(ie),this.info.memory.geometries--}onTextureDispose(x){var ie=x.target;ie.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(ie),this.info.memory.textures--}onMaterialDispose(x){var ie=x.target;ie.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(ie)}getShader(x,ie){var xe;return this.isWebGL1()||ie.startsWith("#version")||(ie=ie.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),ie=`#version 300 es
`+(ie=(ie=(ie=(ie=(ie=x=="fragment"?ie.replace(/varying/g,"in"):ie.replace(/varying/g,"out")).replace(/attribute/g,"in")).replace(/texture2D/g,"texture")).replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;")).replace(/gl_FragColor/g,"glFragColor"))),x==="fragment"?xe=this._gl.createShader(this._gl.FRAGMENT_SHADER):x==="vertex"&&(xe=this._gl.createShader(this._gl.VERTEX_SHADER)),xe==null?null:(this._gl.shaderSource(xe,ie),this._gl.compileShader(xe),this._gl.getShaderParameter(xe,this._gl.COMPILE_STATUS)?xe:(console.error(this._gl.getShaderInfoLog(xe)),console.error("could not initialize shader"),null))}buildProgram(x,ie,xe,Ve){var Oe,yt,lt,mt,Mt=[];for(Oe in Mt.push(x),Mt.push(ie),Ve)Mt.push(Oe),Mt.push(Ve[Oe]);for(mt=Mt.join(),Oe=0,yt=this._programs.length;Oe<yt;Oe++){var Pt=this._programs[Oe];if(Pt.code===mt)return Pt.usedTimes++,Pt.program}if(this.isWebGL1()&&Ve.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if((lt=this._gl.createProgram())==null)return null;var Ot,gr,Yt,Cr="precision "+this._precision+" float;",Er=[Ve.volumetric?"#version 300 es":"",Cr].join(`
`),Ur=[Ve.volumetric?"#version 300 es":"",Ve.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",Ve.shaded?"#define SHADED 1":"",Ve.wireframe?"#define WIREFRAME 1":"",Cr].join(`
`),_r=this.getShader("fragment",Ur+x),Or=this.getShader("vertex",Er+ie);for(gr in Or!=null&&this._gl.attachShader(lt,Or),_r!=null&&this._gl.attachShader(lt,_r),this._gl.linkProgram(lt),this._gl.getProgramParameter(lt,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),lt.uniforms={},lt.attributes={},Ot=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","vWidth","vHeight"],xe)Ot.push(gr);for(Yt=0;Yt<Ot.length;Yt++){var br=Ot[Yt];lt.uniforms[br]=this._gl.getUniformLocation(lt,br)}for(Ot=["position","normal","color","lineDistance","offset","radius"],Yt=0;Yt<Ot.length;Yt++){var Mi=Ot[Yt];lt.attributes[Mi]=this._gl.getAttribLocation(lt,Mi)}return lt.id=this._programs_counter++,this._programs.push({program:lt,code:mt,usedTimes:1}),this.info.memory.programs=this._programs.length,lt}setProgram(x,ie,xe,Ve,Oe,yt){if(Ve.needsUpdate&&(Ve.program&&this.deallocateMaterial(Ve),this.initMaterial(Ve,ie,xe,Oe),Ve.needsUpdate=!1),Ve.program==null)return null;var lt=!1,mt=Ve.program,Mt=mt.uniforms,Pt=Ve.uniforms;if(mt!=this._currentProgram&&(this._gl.useProgram(mt),this._currentProgram=mt,lt=!0),Ve.id!=this._currentMaterialId&&(this._currentMaterialId=Ve.id,lt=!0),x!=this._currentCamera&&(this._currentCamera=x,lt=!0),Mt.projectionMatrix&&this._gl.uniformMatrix4fv(Mt.projectionMatrix,!1,x.projectionMatrix.elements),Mt.modelViewMatrix&&this._gl.uniformMatrix4fv(Mt.modelViewMatrix,!1,Oe._modelViewMatrix.elements),Mt.normalMatrix&&this._gl.uniformMatrix3fv(Mt.normalMatrix,!1,Oe._normalMatrix.elements),Mt.projinv&&(this._projInverse.getInverse(x.projectionMatrix),this._gl.uniformMatrix4fv(Mt.projinv,!1,this._projInverse.elements)),Mt.viewMatrix&&this._gl.uniformMatrix4fv(Mt.viewMatrix,!1,x.matrixWorldInverse.elements),Mt.vWidth&&this._gl.uniform1f(Mt.vWidth,this._viewportWidth),Mt.vHeight&&this._gl.uniform1f(Mt.vHeight,this._viewportHeight),lt){if(Pt.fogColor.value=xe.color,Pt.fogNear.value=xe.near,Pt.fogFar.value=xe.far,Ve.shaderID.startsWith("lambert")||Ve.shaderID==="instanced"||Ve.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(mt,ie),this._lightsNeedUpdate=!1),Pt.directionalLightColor.value=this._lights.directional.colors,Pt.directionalLightDirection.value=this._lights.directional.positions;else if(Ve.shaderID.endsWith("outline"))Pt.outlineColor.value=Ve.outlineColor,Pt.outlineWidth.value=Ve.outlineWidth,Pt.outlinePushback.value=Ve.outlinePushback,Pt.outlineMaxPixels.value=Ve.outlineMaxPixels*this.devicePixelRatio;else if(Ve.shaderID==="volumetric"){Oe._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(Oe._modelViewMatrix),this._projInverse.getInverse(x.projectionMatrix),this._textureMatrix.multiplyMatrices(Oe.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(Mt.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(Mt.projinv,!1,this._projInverse.elements);let Ot=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);Pt.step.value=Oe.material.unit*Ot,Pt.maxdepth.value=Oe.material.maxdepth*Ot,Pt.transfermax.value=Oe.material.transfermax,Pt.transfermin.value=Oe.material.transfermin,Pt.subsamples.value=Oe.material.subsamples,yt.setTexture(Oe.material.transferfn,4,!1),yt.setTexture(Oe.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}Pt.opacity.value=Ve.opacity,this.loadMaterialUniforms(Mt,Pt)}return Pt.shading&&(Pt.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),mt}loadMaterialUniforms(x,ie){var xe,Ve,Oe,yt;for(xe in ie)x[xe]&&(Ve=ie[xe].type,Oe=ie[xe].value,yt=x[xe],Ve==="f"?this._gl.uniform1f(yt,Oe):Ve==="i"?this._gl.uniform1i(yt,Oe):Ve==="fv"?this._gl.uniform3fv(yt,Oe):Ve==="c"?this._gl.uniform3f(yt,Oe.r,Oe.g,Oe.b):Ve==="f4"&&this._gl.uniform4f(yt,Oe[0],Oe[1],Oe[2],Oe[3]))}addObject(x,ie){var xe,Ve,Oe,yt;if(!x.__webglInit&&(x.__webglInit=!0,x._modelViewMatrix=new p.Matrix4,x._normalMatrix=new p.Matrix3,x.geometry!==void 0&&x.geometry.__webglInit===void 0&&(x.geometry.__webglInit=!0,x.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),x instanceof Le||x instanceof Se))for(xe=0,Ve=(Oe=x.geometry).geometryGroups.length;xe<Ve;xe++)(yt=Oe.geometryGroups[xe]).id=this._geometryGroupCounter++,yt.__webglVertexBuffer||(x instanceof Le?(this.createMeshBuffers(yt),Oe.elementsNeedUpdate=!0,Oe.normalsNeedUpdate=!0):x instanceof Se&&this.createLineBuffers(yt),Oe.verticesNeedUpdate=!0,Oe.colorsNeedUpdate=!0);if(!x.__webglActive){if(x instanceof Le||x instanceof Se)for(xe=0,Ve=(Oe=x.geometry).geometryGroups.length;xe<Ve;xe++)yt=Oe.geometryGroups[xe],this.addBuffer(ie.__webglObjects,yt,x);else x instanceof dt&&ie.__webglSprites.push(x);x.__webglActive=!0}}updateObject(x){var ie,xe=x.geometry;if(x instanceof Le||x instanceof Se){for(var Ve=0,Oe=xe.geometryGroups.length;Ve<Oe;Ve++)ie=xe.geometryGroups[Ve],(xe.verticesNeedUpdate||xe.elementsNeedUpdate||xe.colorsNeedUpdate||xe.normalsNeedUpdate)&&this.setBuffers(ie,this._gl.STATIC_DRAW);xe.verticesNeedUpdate=!1,xe.elementsNeedUpdate=!1,xe.normalsNeedUpdate=!1,xe.colorsNeedUpdate=!1,xe.buffersNeedUpdate=!1}}removeObject(x,ie){x instanceof Le||x instanceof Se?this.removeInstances(ie.__webglObjects,x):x instanceof dt&&this.removeInstancesDirect(ie.__webglSprites,x),x.__webglActive=!1}removeInstances(x,ie){for(var xe=x.length-1;xe>=0;--xe)x[xe].object===ie&&x.splice(xe,1)}removeInstancesDirect(x,ie){for(var xe=x.length-1;xe>=0;--xe)x[xe]===ie&&x.splice(xe,1)}unrollBufferMaterial(x){var ie=x.object.material;if(ie.volumetric)x.opaque=null,x.transparent=null,x.volumetric=ie;else if(ie.transparent){if(x.opaque=null,x.volumetric=null,x.transparent=ie,!ie.wireframe){let xe=ie.clone();xe.opacity=0,x.transparentDepth=xe}}else{if(x.opaque=ie,x.transparent=null,x.volumetric=null,!ie.wireframe){let xe=ie.clone();xe.opacity=0,x.opaqueDepth=xe}ie.hasAO&&(x.hasAO=!0),(this._AOEnabled||x.hasAO)&&(x.opaqueShaded=ie.clone(),x.opaqueShaded.shaded=!0)}}setBuffers(x,ie){var xe=x.vertexArray,Ve=x.colorArray;if(x.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,xe,ie)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,xe,ie)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Ve,ie),x.normalArray&&x.__webglNormalBuffer!==void 0){var Oe=x.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Oe,ie)}if(x.radiusArray&&x.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,x.radiusArray,ie)),x.faceArray&&x.__webglFaceBuffer!==void 0){var yt=x.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,x.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,yt,ie)}if(x.lineArray&&x.__webglLineBuffer!==void 0){var lt=x.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,x.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,lt,ie)}}createMeshBuffers(x){x.radiusArray&&(x.__webglRadiusBuffer=this._gl.createBuffer()),x.useOffset&&(x.__webglOffsetBuffer=this._gl.createBuffer()),x.__webglVertexBuffer=this._gl.createBuffer(),x.__webglNormalBuffer=this._gl.createBuffer(),x.__webglColorBuffer=this._gl.createBuffer(),x.__webglFaceBuffer=this._gl.createBuffer(),x.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(x){x.__webglVertexBuffer=this._gl.createBuffer(),x.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(x,ie,xe){x.push({buffer:ie,object:xe,opaque:null,transparent:null})}setupMatrices(x,ie){x._modelViewMatrix.multiplyMatrices(ie.matrixWorldInverse,x.matrixWorld),x._normalMatrix.getInverse(x._modelViewMatrix),x._normalMatrix.transpose()}filterFallback(x){return this._gl.LINEAR}setTextureParameters(x,ie){x==this._gl.TEXTURE_2D?(this._gl.texParameteri(x,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(x,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(x,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(ie.magFilter)),this._gl.texParameteri(x,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(ie.minFilter))):(this._gl.texParameteri(x,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(x,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(x,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(x,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(x,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(x,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(x,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(x){return x===T?this._gl.UNSIGNED_BYTE:x===Q?this._gl.RGBA:x===I?this._gl.NEAREST:0}setupLights(x,ie){var xe,Ve,Oe,yt,lt,mt=this._lights,Mt=mt.directional.colors,Pt=mt.directional.positions,Ot=0,gr=0;for(xe=0,Ve=ie.length;xe<Ve;xe++)if(yt=(Oe=ie[xe]).color,lt=Oe.intensity,Oe instanceof P){if(this._direction.getPositionFromMatrix(Oe.matrixWorld),this._vector3.getPositionFromMatrix(Oe.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;Pt[gr]=this._direction.x,Pt[gr+1]=this._direction.y,Pt[gr+2]=this._direction.z,Mt[gr]=yt.r*lt,Mt[gr+1]=yt.g*lt,Mt[gr+2]=yt.b*lt,gr+=3,Ot++}mt.ambient[0]=0,mt.ambient[1]=0,mt.ambient[2]=0,mt.directional.length=Ot}initGL(){try{if(!OffscreenCanvas||this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context."}else(Kr==null||Kr.isContextLost())&&(Gr=new OffscreenCanvas(this._canvas.width,this._canvas.height),Kr=Gr.getContext("webgl2",{alpha:!0,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})),this._offscreen=Gr,this._gl=Kr,this._bitmap=this._canvas.getContext("bitmaprenderer",{alpha:!0});var x=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(x[6])}catch(ie){console.error(ie)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(x,ie,xe,Ve,Oe,yt,lt){var mt,Mt,Pt,Ot,gr,Yt,Cr;ie?(gr=x.length-1,Yt=-1,Cr=-1):(gr=0,Yt=x.length,Cr=1);for(var Er=gr;Er!==Yt;Er+=Cr)if((mt=x[Er]).render){if(Mt=mt.object,Pt=mt.buffer,Ot=mt[xe],(mt.hasAO||this._AOEnabled)&&mt[xe+"Shaded"]&&(Ot=mt[xe+"Shaded"]),!Ot)continue;this.setBlending(lt),this.setDepthTest(Ot.depthTest),this.setDepthWrite(Ot.depthWrite),this.setPolygonOffset(Ot.polygonOffset,Ot.polygonOffsetFactor,Ot.polygonOffsetUnits);var Ur=Mt._modelViewMatrix.isReflected();if(this.setMaterialFaces(Ot,Ur),this.renderBuffer(Ve,Oe,yt,Ot,Pt,Mt),(this._outlineEnabled||Ot.outline)&&!Ot.wireframe&&Ot.shaderID!=="basic"&&Ot.opacity!==0){let _r=this._outlineMaterial;Ot.shaderID=="sphereimposter"?_r=this._outlineSphereImposterMaterial:Ot.shaderID=="stickimposter"&&(_r=this._outlineStickImposterMaterial),this.renderBuffer(Ve,Oe,yt,_r,Pt,Mt)}}}renderSprites(x,ie,xe){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(x,ie,this._currentWidth,this._currentHeight,xe),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}},392:(i,n,a)=>{a.r(n),a.d(n,{assignBonds:()=>u});var h=a(408);const m=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],z=4.95;function u(y,p){for(let b=0,I=y.length;b<I;b++)y[b].index||(y[b].index=b);const w={x:{y:{z:[]}}};for(let b=0;b<y.length;b++){const I=y[b],O=Math.floor(I.x/z),T=Math.floor(I.y/z),L=Math.floor(I.z/z);w[O]||(w[O]={}),w[O][T]||(w[O][T]={}),w[O][T][L]||(w[O][T][L]=[]),w[O][T][L].push(I)}function M(b,I){for(let O=0;O<b.length;O++){const T=b[O];for(let L=0;L<I.length;L++){const Q=I[L];if((0,h.areConnected)(T,Q,p)){const ne=T.bonds.indexOf(Q.index),Z=Q.bonds.indexOf(T.index);ne===-1&&Z===-1?(T.bonds.push(Q.index),T.bondOrder.push(1),Q.bonds.push(T.index),Q.bondOrder.push(1)):ne===-1?(T.bonds.push(Q.index),T.bondOrder.push(Q.bondOrder[Z])):Z===-1&&(Q.bonds.push(T.index),Q.bondOrder.push(T.bondOrder[ne]))}}}}for(let b in w){const I=parseInt(b);for(let O in w[I]){const T=parseInt(O);for(let L in w[I][T]){const Q=parseInt(L),ne=w[I][T][Q];for(let Z=0;Z<ne.length;Z++){const _=ne[Z];for(let F=Z+1;F<ne.length;F++){const j=ne[F];(0,h.areConnected)(_,j,p)&&_.bonds.indexOf(j.index)==-1&&(_.bonds.push(j.index),_.bondOrder.push(1),j.bonds.push(_.index),j.bondOrder.push(1))}}for(let Z=0;Z<m.length;Z++){const _=m[Z];w[I+_.x]&&w[I+_.x][T+_.y]&&w[I+_.x][T+_.y][Q+_.z]&&M(ne,w[I+_.x][T+_.y][Q+_.z])}}}}}},407:i=>{var n=(function(){for(var a,h=[],m=0;m<256;m++){a=m;for(var z=0;z<8;z++)a=1&a?3988292384^a>>>1:a>>>1;h[m]=a}return h})();i.exports=function(a,h,m,z){var u=n,y=z+m;a^=-1;for(var p=z;p<y;p++)a=a>>>8^u[255&(a^h[p])];return-1^a}},408:(i,n,a)=>{a.r(n),a.d(n,{areConnected:()=>z});var h=a(40);const m=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function z(u,y,p){if(p&&p.unboundCations&&(m.has(u.elem)||m.has(y.elem)))return!1;let w=(0,h.bondLength)(u.elem)+(0,h.bondLength)(y.elem);w+=.25,w*=w;let M=u.x-y.x;if(M*=M,M>w)return!1;let b=u.y-y.y;if(b*=b,b>w)return!1;let I=u.z-y.z;if(I*=I,I>w)return!1;const O=M+b+I;return!(isNaN(O)||O<.5||O>w||u.altLoc!==y.altLoc&&u.altLoc.trim()!==""&&y.altLoc.trim()!=="")}},471:function(i,n){(function(a){function h(pe,Se,Le){for(var dt=(pe.byteLength,0),nt=Le.length;nt>dt;dt++){var zt=Le.charCodeAt(dt);if(128>zt)pe.setUint8(Se++,zt>>>0&127);else if(2048>zt)pe.setUint8(Se++,zt>>>6&31|192),pe.setUint8(Se++,zt>>>0&63|128);else if(65536>zt)pe.setUint8(Se++,zt>>>12&15|224),pe.setUint8(Se++,zt>>>6&63|128),pe.setUint8(Se++,zt>>>0&63|128);else{if(!(1114112>zt))throw new Error("bad codepoint "+zt);pe.setUint8(Se++,zt>>>18&7|240),pe.setUint8(Se++,zt>>>12&63|128),pe.setUint8(Se++,zt>>>6&63|128),pe.setUint8(Se++,zt>>>0&63|128)}}}function m(pe){for(var Se=0,Le=0,dt=pe.length;dt>Le;Le++){var nt=pe.charCodeAt(Le);if(128>nt)Se+=1;else if(2048>nt)Se+=2;else if(65536>nt)Se+=3;else{if(!(1114112>nt))throw new Error("bad codepoint "+nt);Se+=4}}return Se}function z(pe,Se,Le){var dt=typeof pe;if(dt==="string"){if(32>(nt=m(pe)))return Se.setUint8(Le,160|nt),h(Se,Le+1,pe),1+nt;if(256>nt)return Se.setUint8(Le,217),Se.setUint8(Le+1,nt),h(Se,Le+2,pe),2+nt;if(65536>nt)return Se.setUint8(Le,218),Se.setUint16(Le+1,nt),h(Se,Le+3,pe),3+nt;if(4294967296>nt)return Se.setUint8(Le,219),Se.setUint32(Le+1,nt),h(Se,Le+5,pe),5+nt}if(pe instanceof Uint8Array){var nt=pe.byteLength,zt=new Uint8Array(Se.buffer);if(256>nt)return Se.setUint8(Le,196),Se.setUint8(Le+1,nt),zt.set(pe,Le+2),2+nt;if(65536>nt)return Se.setUint8(Le,197),Se.setUint16(Le+1,nt),zt.set(pe,Le+3),3+nt;if(4294967296>nt)return Se.setUint8(Le,198),Se.setUint32(Le+1,nt),zt.set(pe,Le+5),5+nt}if(dt==="number"){if(!isFinite(pe))throw new Error("Number not finite: "+pe);if(Math.floor(pe)!==pe)return Se.setUint8(Le,203),Se.setFloat64(Le+1,pe),9;if(pe>=0){if(128>pe)return Se.setUint8(Le,pe),1;if(256>pe)return Se.setUint8(Le,204),Se.setUint8(Le+1,pe),2;if(65536>pe)return Se.setUint8(Le,205),Se.setUint16(Le+1,pe),3;if(4294967296>pe)return Se.setUint8(Le,206),Se.setUint32(Le+1,pe),5;throw new Error("Number too big 0x"+pe.toString(16))}if(pe>=-32)return Se.setInt8(Le,pe),1;if(pe>=-128)return Se.setUint8(Le,208),Se.setInt8(Le+1,pe),2;if(pe>=-32768)return Se.setUint8(Le,209),Se.setInt16(Le+1,pe),3;if(pe>=-2147483648)return Se.setUint8(Le,210),Se.setInt32(Le+1,pe),5;throw new Error("Number too small -0x"+(-pe).toString(16).substr(1))}if(pe===null)return Se.setUint8(Le,192),1;if(dt==="boolean")return Se.setUint8(Le,pe?195:194),1;if(dt==="object"){var ht=0,Lt=Array.isArray(pe);if(Lt)nt=pe.length;else{var Ut=Object.keys(pe);nt=Ut.length}if(16>nt?(Se.setUint8(Le,nt|(Lt?144:128)),ht=1):65536>nt?(Se.setUint8(Le,Lt?220:222),Se.setUint16(Le+1,nt),ht=3):4294967296>nt&&(Se.setUint8(Le,Lt?221:223),Se.setUint32(Le+1,nt),ht=5),Lt)for(var It=0;nt>It;It++)ht+=z(pe[It],Se,Le+ht);else for(It=0;nt>It;It++){var mr=Ut[It];ht+=z(mr,Se,Le+ht),ht+=z(pe[mr],Se,Le+ht)}return ht}throw new Error("Unknown type "+dt)}function u(pe){var Se=typeof pe;if(Se==="string"){if(32>(Le=m(pe)))return 1+Le;if(256>Le)return 2+Le;if(65536>Le)return 3+Le;if(4294967296>Le)return 5+Le}if(pe instanceof Uint8Array){if(256>(Le=pe.byteLength))return 2+Le;if(65536>Le)return 3+Le;if(4294967296>Le)return 5+Le}if(Se==="number"){if(Math.floor(pe)!==pe)return 9;if(pe>=0){if(128>pe)return 1;if(256>pe)return 2;if(65536>pe)return 3;if(4294967296>pe)return 5;throw new Error("Number too big 0x"+pe.toString(16))}if(pe>=-32)return 1;if(pe>=-128)return 2;if(pe>=-32768)return 3;if(pe>=-2147483648)return 5;throw new Error("Number too small -0x"+pe.toString(16).substr(1))}if(Se==="boolean"||pe===null)return 1;if(Se==="object"){var Le,dt=0;if(Array.isArray(pe)){Le=pe.length;for(var nt=0;Le>nt;nt++)dt+=u(pe[nt])}else{var zt=Object.keys(pe);for(Le=zt.length,nt=0;Le>nt;nt++){var ht=zt[nt];dt+=u(ht)+u(pe[ht])}}if(16>Le)return 1+dt;if(65536>Le)return 3+dt;if(4294967296>Le)return 5+dt;throw new Error("Array or object too long 0x"+Le.toString(16))}throw new Error("Unknown type "+Se)}function y(pe){var Se=new ArrayBuffer(u(pe));return z(pe,new DataView(Se),0),new Uint8Array(Se)}function p(pe,Se,Le){return Se?new pe(Se.buffer,Se.byteOffset,Se.byteLength/(Le||1)):void 0}function w(pe){return p(DataView,pe)}function M(pe){return p(Uint8Array,pe)}function b(pe){return p(Int8Array,pe)}function I(pe){return p(Int32Array,pe,4)}function O(pe){return p(Float32Array,pe,4)}function T(pe,Se){var Le=pe.length/2;Se||(Se=new Int16Array(Le));for(var dt=0,nt=0;Le>dt;++dt,nt+=2)Se[dt]=pe[nt]<<8^pe[nt+1];return Se}function L(pe,Se){var Le=pe.length;Se||(Se=new Uint8Array(2*Le));for(var dt=w(Se),nt=0;Le>nt;++nt)dt.setInt16(2*nt,pe[nt]);return M(Se)}function Q(pe,Se){var Le=pe.length/4;Se||(Se=new Int32Array(Le));for(var dt=0,nt=0;Le>dt;++dt,nt+=4)Se[dt]=pe[nt]<<24^pe[nt+1]<<16^pe[nt+2]<<8^pe[nt+3];return Se}function ne(pe,Se){var Le=pe.length;Se||(Se=new Uint8Array(4*Le));for(var dt=w(Se),nt=0;Le>nt;++nt)dt.setInt32(4*nt,pe[nt]);return M(Se)}function Z(pe,Se){var Le=pe.length;Se||(Se=new Float32Array(Le/4));for(var dt=w(Se),nt=w(pe),zt=0,ht=0,Lt=Le/4;Lt>zt;++zt,ht+=4)dt.setFloat32(ht,nt.getFloat32(ht),!0);return Se}function _(pe,Se,Le){var dt=pe.length,nt=1/Se;Le||(Le=new Float32Array(dt));for(var zt=0;dt>zt;++zt)Le[zt]=pe[zt]*nt;return Le}function F(pe,Se,Le){var dt=pe.length;Le||(Le=new Int32Array(dt));for(var nt=0;dt>nt;++nt)Le[nt]=Math.round(pe[nt]*Se);return Le}function j(pe,Se){var Le,dt;if(!Se){var nt=0;for(Le=0,dt=pe.length;dt>Le;Le+=2)nt+=pe[Le+1];Se=new pe.constructor(nt)}var zt=0;for(Le=0,dt=pe.length;dt>Le;Le+=2)for(var ht=pe[Le],Lt=pe[Le+1],Ut=0;Lt>Ut;++Ut)Se[zt]=ht,++zt;return Se}function G(pe){if(pe.length===0)return new Int32Array;var Se,Le,dt=2;for(Se=1,Le=pe.length;Le>Se;++Se)pe[Se-1]!==pe[Se]&&(dt+=2);var nt=new Int32Array(dt),zt=0,ht=1;for(Se=1,Le=pe.length;Le>Se;++Se)pe[Se-1]!==pe[Se]?(nt[zt]=pe[Se-1],nt[zt+1]=ht,ht=1,zt+=2):++ht;return nt[zt]=pe[pe.length-1],nt[zt+1]=ht,nt}function q(pe,Se){var Le=pe.length;Se||(Se=new pe.constructor(Le)),Le&&(Se[0]=pe[0]);for(var dt=1;Le>dt;++dt)Se[dt]=pe[dt]+Se[dt-1];return Se}function N(pe,Se){var Le=pe.length;Se||(Se=new pe.constructor(Le)),Se[0]=pe[0];for(var dt=1;Le>dt;++dt)Se[dt]=pe[dt]-pe[dt-1];return Se}function ee(pe,Se){var Le,dt,nt=pe instanceof Int8Array?127:32767,zt=-nt-1,ht=pe.length;if(!Se){var Lt=0;for(Le=0;ht>Le;++Le)pe[Le]<nt&&pe[Le]>zt&&++Lt;Se=new Int32Array(Lt)}for(Le=0,dt=0;ht>Le;){for(var Ut=0;pe[Le]===nt||pe[Le]===zt;)Ut+=pe[Le],++Le;Ut+=pe[Le],++Le,Se[dt]=Ut,++dt}return Se}function Ce(pe,Se){var Le,dt=32767,nt=-dt-1,zt=pe.length,ht=0;for(Le=0;zt>Le;++Le)(It=pe[Le])===0?++ht:It>0?(ht+=Math.ceil(It/dt),It%dt===0&&(ht+=1)):(ht+=Math.ceil(It/nt),It%nt===0&&(ht+=1));var Lt=new Int16Array(ht),Ut=0;for(Le=0;zt>Le;++Le){var It;if((It=pe[Le])>=0)for(;It>=dt;)Lt[Ut]=dt,++Ut,It-=dt;else for(;nt>=It;)Lt[Ut]=nt,++Ut,It-=nt;Lt[Ut]=It,++Ut}return Lt}function he(pe,Se){return q(j(pe),Se)}function ge(pe){return G(N(pe))}function me(pe,Se,Le){return _(j(pe,I(Le)),Se,Le)}function Me(pe,Se){return G(F(pe,Se))}function ue(pe,Se,Le){return _(q(pe,I(Le)),Se,Le)}function P(pe,Se,Le){return N(F(pe,Se),Le)}function ce(pe,Se,Le){return _(ee(pe,I(Le)),Se,Le)}function se(pe,Se,Le){var dt=ee(pe,I(Le));return ue(dt,Se,O(dt))}function X(pe,Se,Le){return Ce(P(pe,Se))}function Re(pe){var Se=w(pe),Le=Se.getInt32(0),dt=Se.getInt32(4),nt=pe.subarray(8,12);return[Le,pe=pe.subarray(12),dt,nt]}function fe(pe,Se,Le,dt){var nt=new ArrayBuffer(12+dt.byteLength),zt=new Uint8Array(nt),ht=new DataView(nt);return ht.setInt32(0,pe),ht.setInt32(4,Se),Le&&zt.set(Le,8),zt.set(dt,12),zt}function De(pe){return fe(2,pe.length,void 0,M(pe))}function We(pe){return fe(4,pe.length,void 0,ne(pe))}function oe(pe,Se){return fe(5,pe.length/Se,ne([Se]),M(pe))}function Ae(pe){return fe(6,pe.length,void 0,ne(G(pe)))}function He(pe){return fe(8,pe.length,void 0,ne(ge(pe)))}function Ue(pe,Se){return fe(9,pe.length,ne([Se]),ne(Me(pe,Se)))}function Ie(pe,Se){return fe(10,pe.length,ne([Se]),L(X(pe,Se)))}function rt(pe){var Se={};return xr.forEach(function(Le){pe[Le]!==void 0&&(Se[Le]=pe[Le])}),pe.bondAtomList&&(Se.bondAtomList=We(pe.bondAtomList)),pe.bondOrderList&&(Se.bondOrderList=De(pe.bondOrderList)),Se.xCoordList=Ie(pe.xCoordList,1e3),Se.yCoordList=Ie(pe.yCoordList,1e3),Se.zCoordList=Ie(pe.zCoordList,1e3),pe.bFactorList&&(Se.bFactorList=Ie(pe.bFactorList,100)),pe.atomIdList&&(Se.atomIdList=He(pe.atomIdList)),pe.altLocList&&(Se.altLocList=Ae(pe.altLocList)),pe.occupancyList&&(Se.occupancyList=Ue(pe.occupancyList,100)),Se.groupIdList=He(pe.groupIdList),Se.groupTypeList=We(pe.groupTypeList),pe.secStructList&&(Se.secStructList=De(pe.secStructList)),pe.insCodeList&&(Se.insCodeList=Ae(pe.insCodeList)),pe.sequenceIndexList&&(Se.sequenceIndexList=He(pe.sequenceIndexList)),Se.chainIdList=oe(pe.chainIdList,4),pe.chainNameList&&(Se.chainNameList=oe(pe.chainNameList,4)),Se}function st(pe){function Se(Ut){for(var It={},mr=0;Ut>mr;mr++)It[zt()]=zt();return It}function Le(Ut){var It=pe.subarray(ht,ht+Ut);return ht+=Ut,It}function dt(Ut){var It=pe.subarray(ht,ht+Ut);ht+=Ut;var mr=65535;if(Ut>mr){for(var li=[],Ci=0;Ci<It.length;Ci+=mr)li.push(String.fromCharCode.apply(null,It.subarray(Ci,Ci+mr)));return li.join("")}return String.fromCharCode.apply(null,It)}function nt(Ut){for(var It=new Array(Ut),mr=0;Ut>mr;mr++)It[mr]=zt();return It}function zt(){var Ut,It,mr=pe[ht];if(!(128&mr))return ht++,mr;if((240&mr)==128)return ht++,Se(It=15&mr);if((240&mr)==144)return ht++,nt(It=15&mr);if((224&mr)==160)return ht++,dt(It=31&mr);if(!(224&~mr))return Ut=Lt.getInt8(ht),ht++,Ut;switch(mr){case 192:return ht++,null;case 194:return ht++,!1;case 195:return ht++,!0;case 196:return It=Lt.getUint8(ht+1),ht+=2,Le(It);case 197:return It=Lt.getUint16(ht+1),ht+=3,Le(It);case 198:return It=Lt.getUint32(ht+1),ht+=5,Le(It);case 202:return Ut=Lt.getFloat32(ht+1),ht+=5,Ut;case 203:return Ut=Lt.getFloat64(ht+1),ht+=9,Ut;case 204:return Ut=pe[ht+1],ht+=2,Ut;case 205:return Ut=Lt.getUint16(ht+1),ht+=3,Ut;case 206:return Ut=Lt.getUint32(ht+1),ht+=5,Ut;case 208:return Ut=Lt.getInt8(ht+1),ht+=2,Ut;case 209:return Ut=Lt.getInt16(ht+1),ht+=3,Ut;case 210:return Ut=Lt.getInt32(ht+1),ht+=5,Ut;case 217:return It=Lt.getUint8(ht+1),ht+=2,dt(It);case 218:return It=Lt.getUint16(ht+1),ht+=3,dt(It);case 219:return It=Lt.getUint32(ht+1),ht+=5,dt(It);case 220:return It=Lt.getUint16(ht+1),ht+=3,nt(It);case 221:return It=Lt.getUint32(ht+1),ht+=5,nt(It);case 222:return It=Lt.getUint16(ht+1),ht+=3,Se(It);case 223:return It=Lt.getUint32(ht+1),ht+=5,Se(It)}throw new Error("Unknown type 0x"+mr.toString(16))}var ht=0,Lt=new DataView(pe.buffer);return zt()}function at(pe,Se,Le,dt){switch(pe){case 1:return Z(Se);case 2:return b(Se);case 3:return T(Se);case 4:return Q(Se);case 5:return M(Se);case 6:return j(Q(Se),new Uint8Array(Le));case 7:return j(Q(Se));case 8:return he(Q(Se));case 9:return me(Q(Se),Q(dt)[0]);case 10:return se(T(Se),Q(dt)[0]);case 11:return _(T(Se),Q(dt)[0]);case 12:return ce(T(Se),Q(dt)[0]);case 13:return ce(b(Se),Q(dt)[0]);case 14:return ee(T(Se));case 15:return ee(b(Se))}}function Ft(pe,Se){var Le=(Se=Se||{}).ignoreFields,dt={};return Rr.forEach(function(nt){var zt=!!Le&&Le.indexOf(nt)!==-1,ht=pe[nt];zt||ht===void 0||(ht instanceof Uint8Array?dt[nt]=at.apply(null,Re(ht)):dt[nt]=ht)}),dt}function Ct(pe){return String.fromCharCode.apply(null,pe).replace(/\0/g,"")}function or(pe,Se,Le){var dt,nt,zt,ht,Lt,Ut,It=(Le=Le||{}).firstModelOnly,mr=Se.onModel,li=Se.onChain,Ci=Se.onGroup,ui=Se.onAtom,gi=Se.onBond,jr=0,Lr=0,Dr=0,rr=0,vi=0,wi=-1,Ki=pe.chainNameList,Ei=pe.secStructList,Ni=pe.insCodeList,Ti=pe.sequenceIndexList,pi=pe.atomIdList,Br=pe.bFactorList,Yr=pe.altLocList,Vi=pe.occupancyList,yi=pe.bondAtomList,Wi=pe.bondOrderList;for(dt=0,nt=pe.chainsPerModel.length;nt>dt&&!(It&&jr>0);++dt){var tn=pe.chainsPerModel[jr];for(mr&&mr({chainCount:tn,modelIndex:jr}),zt=0;tn>zt;++zt){var on=pe.groupsPerChain[Lr];if(li){var ur=Ct(pe.chainIdList.subarray(4*Lr,4*Lr+4)),Gr=null;Ki&&(Gr=Ct(Ki.subarray(4*Lr,4*Lr+4))),li({groupCount:on,chainIndex:Lr,modelIndex:jr,chainId:ur,chainName:Gr})}for(ht=0;on>ht;++ht){var Kr=pe.groupList[pe.groupTypeList[Dr]],Zi=Kr.atomNameList.length;if(Ci){var Bt=null;Ei&&(Bt=Ei[Dr]);var x=null;pe.insCodeList&&(x=String.fromCharCode(Ni[Dr]));var ie=null;Ti&&(ie=Ti[Dr]),Ci({atomCount:Zi,groupIndex:Dr,chainIndex:Lr,modelIndex:jr,groupId:pe.groupIdList[Dr],groupType:pe.groupTypeList[Dr],groupName:Kr.groupName,singleLetterCode:Kr.singleLetterCode,chemCompType:Kr.chemCompType,secStruct:Bt,insCode:x,sequenceIndex:ie})}for(Lt=0;Zi>Lt;++Lt){if(ui){var xe=null;pi&&(xe=pi[rr]);var Ve=null;Br&&(Ve=Br[rr]);var Oe=null;Yr&&(Oe=String.fromCharCode(Yr[rr]));var yt=null;Vi&&(yt=Vi[rr]),ui({atomIndex:rr,groupIndex:Dr,chainIndex:Lr,modelIndex:jr,atomId:xe,element:Kr.elementList[Lt],atomName:Kr.atomNameList[Lt],formalCharge:Kr.formalChargeList[Lt],xCoord:pe.xCoordList[rr],yCoord:pe.yCoordList[rr],zCoord:pe.zCoordList[rr],bFactor:Ve,altLoc:Oe,occupancy:yt})}rr+=1}if(gi){var lt=Kr.bondAtomList;for(Lt=0,Ut=Kr.bondOrderList.length;Ut>Lt;++Lt)gi({atomIndex1:rr-Zi+lt[2*Lt],atomIndex2:rr-Zi+lt[2*Lt+1],bondOrder:Kr.bondOrderList[Lt]})}Dr+=1}Lr+=1}if(vi=wi+1,wi=rr-1,gi&&yi)for(Lt=0,Ut=yi.length;Ut>Lt;Lt+=2){var mt=yi[Lt],Mt=yi[Lt+1];(mt>=vi&&wi>=mt||Mt>=vi&&wi>=Mt)&&gi({atomIndex1:mt,atomIndex2:Mt,bondOrder:Wi?Wi[Lt/2]:null})}jr+=1}}function ar(pe){return y(rt(pe))}function kr(pe,Se){return pe instanceof ArrayBuffer&&(pe=new Uint8Array(pe)),Ft(pe instanceof Uint8Array?st(pe):pe,Se)}function Ar(pe,Se,Le,dt){function nt(){try{var ht=kr(zt.response);Le(ht)}catch(Lt){dt(Lt)}}var zt=new XMLHttpRequest;zt.addEventListener("load",nt,!0),zt.addEventListener("error",dt,!0),zt.responseType="arraybuffer",zt.open("GET",Se+pe.toUpperCase()),zt.send()}function pr(pe,Se,Le){Ar(pe,bi,Se,Le)}function vr(pe,Se,Le){Ar(pe,Hi,Se,Le)}var xr=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],fi=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],Rr=xr.concat(fi),Ir="v1.0.1",Di="//mmtf.rcsb.org/v1.0/",bi=Di+"full/",Hi=Di+"reduced/";a.encode=ar,a.decode=kr,a.traverse=or,a.fetch=pr,a.fetchReduced=vr,a.version=Ir,a.fetchUrl=bi,a.fetchReducedUrl=Hi,a.encodeMsgpack=y,a.encodeMmtf=rt,a.decodeMsgpack=st,a.decodeMmtf=Ft})(n)},529:(i,n,a)=>{a.r(n),a.d(n,{Matrix3:()=>L,Matrix4:()=>O,Quaternion:()=>h,Ray:()=>Q,Vector2:()=>m,Vector3:()=>T,clamp:()=>z,conversionMatrix3:()=>ne,degToRad:()=>y});class h{constructor(_,F,j,G){this.x=_||0,this.y=F||0,this.z=j||0,this.w=G!==void 0?G:1}set(_,F,j,G){return this.x=_,this.y=F,this.z=j,this.w=G,this}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this.w=_.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let _=this.length();return _===0?(this.x=0,this.y=0,this.z=0,this.w=1):(_=1/_,this.x*=_,this.y*=_,this.z*=_,this.w*=_),this}multiply(_){return this.multiplyQuaternions(this,_)}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this.w*=_,this}multiplyQuaternions(_,F){const j=_.x,G=_.y,q=_.z,N=_.w,ee=F.x,Ce=F.y,he=F.z,ge=F.w;return this.x=j*ge+N*ee+G*he-q*Ce,this.y=G*ge+N*Ce+q*ee-j*he,this.z=q*ge+N*he+j*Ce-G*ee,this.w=N*ge-j*ee-G*Ce-q*he,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this.w-=_.w,this}clone(){return new h(this.x,this.y,this.z,this.w)}setFromEuler(_){const F=Math.cos(_.x/2),j=Math.cos(_.y/2),G=Math.cos(_.z/2),q=Math.sin(_.x/2),N=Math.sin(_.y/2),ee=Math.sin(_.z/2);return this.x=q*j*G+F*N*ee,this.y=F*N*G-q*j*ee,this.z=F*j*ee+q*N*G,this.w=F*j*G-q*N*ee,this}}class m{constructor(_,F){this.x=_||0,this.y=F||0}set(_,F){return this.x=_,this.y=F,this}subVectors(_,F){return this.x=_.x-F.x,this.y=_.y-F.y,this}copy(_){return this.x=_.x,this.y=_.y,this}clone(){return new m(this.x,this.y)}}function z(Z,_,F){return Math.min(Math.max(Z,_),F)}const u=Math.PI/180;function y(Z){return Z*u}var p,w,M,b,I;class O{constructor(_=1,F=0,j=0,G=0,q=0,N=1,ee=0,Ce=0,he=0,ge=0,me=1,Me=0,ue=0,P=0,ce=0,se=1){_!==void 0&&typeof _!="number"?this.elements=new Float32Array(_):(this.elements=new Float32Array(16),this.elements[0]=_,this.elements[4]=F,this.elements[8]=j,this.elements[12]=G,this.elements[1]=q,this.elements[5]=N,this.elements[9]=ee,this.elements[13]=Ce,this.elements[2]=he,this.elements[6]=ge,this.elements[10]=me,this.elements[14]=Me,this.elements[3]=ue,this.elements[7]=P,this.elements[11]=ce,this.elements[15]=se)}makeScale(_,F,j){throw new Error("Method not implemented.")}set(_,F,j,G,q,N,ee,Ce,he,ge,me,Me,ue,P,ce,se){const X=this.elements;return X[0]=_,X[4]=F,X[8]=j,X[12]=G,X[1]=q,X[5]=N,X[9]=ee,X[13]=Ce,X[2]=he,X[6]=ge,X[10]=me,X[14]=Me,X[3]=ue,X[7]=P,X[11]=ce,X[15]=se,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(_){const F=_.elements;return this.set(F[0],F[4],F[8],F[12],F[1],F[5],F[9],F[13],F[2],F[6],F[10],F[14],F[3],F[7],F[11],F[15]),this}matrix3FromTopLeft(){const _=this.elements;return new L(_[0],_[4],_[8],_[1],_[5],_[9],_[2],_[6],_[10])}setRotationFromEuler(_,F){const j=this.elements,{x:G,y:q,z:N}=_,ee=Math.cos(G),Ce=Math.sin(G),he=Math.cos(q),ge=Math.sin(q),me=Math.cos(N),Me=Math.sin(N);if(F===void 0||F==="XYZ"){const ue=ee*me,P=ee*Me,ce=Ce*me,se=Ce*Me;j[0]=he*me,j[4]=-he*Me,j[8]=ge,j[1]=P+ce*ge,j[5]=ue-se*ge,j[9]=-Ce*he,j[2]=se-ue*ge,j[6]=ce+P*ge,j[10]=ee*he}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${F}`);return this}setRotationFromQuaternion(_){const F=this.elements,{x:j,y:G,z:q,w:N}=_,ee=j+j,Ce=G+G,he=q+q,ge=j*ee,me=j*Ce,Me=j*he,ue=G*Ce,P=G*he,ce=q*he,se=N*ee,X=N*Ce,Re=N*he;return F[0]=1-(ue+ce),F[4]=me-Re,F[8]=Me+X,F[1]=me+Re,F[5]=1-(ge+ce),F[9]=P-se,F[2]=Me-X,F[6]=P+se,F[10]=1-(ge+ue),this}multiplyMatrices(_,F){const j=_.elements,G=F.elements,q=this.elements,N=j[0],ee=j[4],Ce=j[8],he=j[12],ge=j[1],me=j[5],Me=j[9],ue=j[13],P=j[2],ce=j[6],se=j[10],X=j[14],Re=j[3],fe=j[7],De=j[11],We=j[15],oe=G[0],Ae=G[4],He=G[8],Ue=G[12],Ie=G[1],rt=G[5],st=G[9],at=G[13],Ft=G[2],Ct=G[6],or=G[10],ar=G[14],kr=G[3],Ar=G[7],pr=G[11],vr=G[15];return q[0]=N*oe+ee*Ie+Ce*Ft+he*kr,q[4]=N*Ae+ee*rt+Ce*Ct+he*Ar,q[8]=N*He+ee*st+Ce*or+he*pr,q[12]=N*Ue+ee*at+Ce*ar+he*vr,q[1]=ge*oe+me*Ie+Me*Ft+ue*kr,q[5]=ge*Ae+me*rt+Me*Ct+ue*Ar,q[9]=ge*He+me*st+Me*or+ue*pr,q[13]=ge*Ue+me*at+Me*ar+ue*vr,q[2]=P*oe+ce*Ie+se*Ft+X*kr,q[6]=P*Ae+ce*rt+se*Ct+X*Ar,q[10]=P*He+ce*st+se*or+X*pr,q[14]=P*Ue+ce*at+se*ar+X*vr,q[3]=Re*oe+fe*Ie+De*Ft+We*kr,q[7]=Re*Ae+fe*rt+De*Ct+We*Ar,q[11]=Re*He+fe*st+De*or+We*pr,q[15]=Re*Ue+fe*at+De*ar+We*vr,this}multiplyScalar(_){const F=this.elements;return F[0]*=_,F[4]*=_,F[8]*=_,F[12]*=_,F[1]*=_,F[5]*=_,F[9]*=_,F[13]*=_,F[2]*=_,F[6]*=_,F[10]*=_,F[14]*=_,F[3]*=_,F[7]*=_,F[11]*=_,F[15]*=_,this}makeTranslation(_,F,j){return this.set(1,0,0,_,0,1,0,F,0,0,1,j,0,0,0,1),this}snap(_){const F=Math.pow(10,4),j=this.elements;for(let G=0;G<16;G++){const q=Math.round(j[G]);q===Math.round(j[G]*F)/F&&(j[G]=q)}return this}transpose(){const _=this.elements;let F;return F=_[1],_[1]=_[4],_[4]=F,F=_[2],_[2]=_[8],_[8]=F,F=_[6],_[6]=_[9],_[9]=F,F=_[3],_[3]=_[12],_[12]=F,F=_[7],_[7]=_[13],_[13]=F,F=_[11],_[11]=_[14],_[14]=F,this}setPosition(_){const F=this.elements;return F[12]=_.x,F[13]=_.y,F[14]=_.z,this}translate(_){const F=this.elements;return F[12]+=_.x,F[13]+=_.y,F[14]+=_.z,this}getInverse(_,F){const j=this.elements,G=_.elements,q=G[0],N=G[4],ee=G[8],Ce=G[12],he=G[1],ge=G[5],me=G[9],Me=G[13],ue=G[2],P=G[6],ce=G[10],se=G[14],X=G[3],Re=G[7],fe=G[11],De=G[15];j[0]=me*se*Re-Me*ce*Re+Me*P*fe-ge*se*fe-me*P*De+ge*ce*De,j[4]=Ce*ce*Re-ee*se*Re-Ce*P*fe+N*se*fe+ee*P*De-N*ce*De,j[8]=ee*Me*Re-Ce*me*Re+Ce*ge*fe-N*Me*fe-ee*ge*De+N*me*De,j[12]=Ce*me*P-ee*Me*P-Ce*ge*ce+N*Me*ce+ee*ge*se-N*me*se,j[1]=Me*ce*X-me*se*X-Me*ue*fe+he*se*fe+me*ue*De-he*ce*De,j[5]=ee*se*X-Ce*ce*X+Ce*ue*fe-q*se*fe-ee*ue*De+q*ce*De,j[9]=Ce*me*X-ee*Me*X-Ce*he*fe+q*Me*fe+ee*he*De-q*me*De,j[13]=ee*Me*ue-Ce*me*ue+Ce*he*ce-q*Me*ce-ee*he*se+q*me*se,j[2]=ge*se*X-Me*P*X+Me*ue*Re-he*se*Re-ge*ue*De+he*P*De,j[6]=Ce*P*X-N*se*X-Ce*ue*Re+q*se*Re+N*ue*De-q*P*De,j[10]=N*Me*X-Ce*ge*X+Ce*he*Re-q*Me*Re-N*he*De+q*ge*De,j[14]=Ce*ge*ue-N*Me*ue-Ce*he*P+q*Me*P+N*he*se-q*ge*se,j[3]=me*P*X-ge*ce*X-me*ue*Re+he*ce*Re+ge*ue*fe-he*P*fe,j[7]=N*ce*X-ee*P*X+ee*ue*Re-q*ce*Re-N*ue*fe+q*P*fe,j[11]=ee*ge*X-N*me*X-ee*he*Re+q*me*Re+N*he*fe-q*ge*fe,j[15]=N*me*ue-ee*ge*ue+ee*he*P-q*me*P-N*he*ce+q*ge*ce;const We=q*j[0]+he*j[4]+ue*j[8]+X*j[12];if(We===0){const oe="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(F)throw new Error(oe);return console.warn(oe),this.identity(),this}return this.multiplyScalar(1/We),this}isReflected(){const _=this.elements,F=_[0],j=_[4],G=_[8],q=_[1],N=_[5],ee=_[9],Ce=_[2],he=_[6],ge=_[10];return F*N*ge+q*he*G+Ce*j*ee-Ce*N*G-q*j*ge-F*he*ee<0}scale(_){const F=this.elements,{x:j}=_,{y:G}=_,{z:q}=_;return F[0]*=j,F[4]*=G,F[8]*=q,F[1]*=j,F[5]*=G,F[9]*=q,F[2]*=j,F[6]*=G,F[10]*=q,F[3]*=j,F[7]*=G,F[11]*=q,this}getMaxScaleOnAxis(){const _=this.elements,F=_[0]*_[0]+_[1]*_[1]+_[2]*_[2],j=_[4]*_[4]+_[5]*_[5]+_[6]*_[6],G=_[8]*_[8]+_[9]*_[9]+_[10]*_[10];return Math.sqrt(Math.max(F,Math.max(j,G)))}makeFrustum(_,F,j,G,q,N){const ee=this.elements,Ce=2*q/(F-_),he=2*q/(G-j),ge=(F+_)/(F-_),me=(G+j)/(G-j),Me=-(N+q)/(N-q),ue=-2*N*q/(N-q);return ee[0]=Ce,ee[4]=0,ee[8]=ge,ee[12]=0,ee[1]=0,ee[5]=he,ee[9]=me,ee[13]=0,ee[2]=0,ee[6]=0,ee[10]=Me,ee[14]=ue,ee[3]=0,ee[7]=0,ee[11]=-1,ee[15]=0,this}makePerspective(_,F,j,G){const q=j*Math.tan(y(.5*_)),N=-q,ee=N*F,Ce=q*F;return this.makeFrustum(ee,Ce,N,q,j,G)}makeOrthographic(_,F,j,G,q,N){const ee=this.elements,Ce=1/(F-_),he=1/(j-G),ge=1/(N-q),me=(F+_)*Ce,Me=(j+G)*he,ue=(N+q)*ge;return ee[0]=2*Ce,ee[4]=0,ee[8]=0,ee[12]=-me,ee[1]=0,ee[5]=2*he,ee[9]=0,ee[13]=-Me,ee[2]=0,ee[6]=0,ee[10]=-2*ge,ee[14]=-ue,ee[3]=0,ee[7]=0,ee[11]=0,ee[15]=1,this}isEqual(_){const F=_.elements,j=this.elements;return j[0]===F[0]&&j[4]===F[4]&&j[8]===F[8]&&j[12]===F[12]&&j[1]===F[1]&&j[5]===F[5]&&j[9]===F[9]&&j[13]===F[13]&&j[2]===F[2]&&j[6]===F[6]&&j[10]===F[10]&&j[14]===F[14]&&j[3]===F[3]&&j[7]===F[7]&&j[11]===F[11]&&j[15]===F[15]}clone(){const _=this.elements;return new O(_[0],_[4],_[8],_[12],_[1],_[5],_[9],_[13],_[2],_[6],_[10],_[14],_[3],_[7],_[11],_[15])}isIdentity(){const _=this.elements;return _[0]===1&&_[4]===0&&_[8]===0&&_[12]===0&&_[1]===0&&_[5]===1&&_[9]===0&&_[13]===0&&_[2]===0&&_[6]===0&&_[10]===1&&_[14]===0&&_[3]===0&&_[7]===0&&_[11]===0&&_[15]===1}isNearlyIdentity(_){return this.clone().snap(_).isIdentity()}getScale(_){const F=this.elements;return _=_||new T,M.set(F[0],F[1],F[2]),b.set(F[4],F[5],F[6]),I.set(F[8],F[9],F[10]),_.x=M.length(),_.y=b.length(),_.z=I.length(),_}lookAt(_,F,j){const G=this.elements;return I.subVectors(_,F).normalize(),I.length()===0&&(I.z=1),M.crossVectors(j,I).normalize(),M.length()===0&&(I.x+=1e-4,M.crossVectors(j,I).normalize()),b.crossVectors(I,M),G[0]=M.x,G[4]=b.x,G[8]=I.x,G[1]=M.y,G[5]=b.y,G[9]=I.y,G[2]=M.z,G[6]=b.z,G[10]=I.z,this}compose(_,F,j){const G=this.elements;return p.identity(),p.setRotationFromQuaternion(F),w.makeScale(j.x,j.y,j.z),this.multiplyMatrices(p,w),G[12]=_.x,G[13]=_.y,G[14]=_.z,this}}p=new O,w=new O;class T{constructor(_,F,j){this.x=_||0,this.y=F||0,this.z=j||0,this.atomid=void 0}set(_,F,j){return this.x=_,this.y=F,this.z=j,this}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this}addVectors(_,F){return this.x=_.x+F.x,this.y=_.y+F.y,this.z=_.z+F.z,this}multiplyVectors(_,F){return this.x=_.x*F.x,this.y=_.y*F.y,this.z=_.z*F.z,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this}subVectors(_,F){return this.x=_.x-F.x,this.y=_.y-F.y,this.z=_.z-F.z,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this}divideScalar(_){return _!==0?(this.x/=_,this.y/=_,this.z/=_):(this.x=0,this.y=0,this.z=0),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const F=this.x-_.x,j=this.y-_.y,G=this.z-_.z;return F*F+j*j+G*G}applyMatrix3(_){const{x:F}=this,{y:j}=this,{z:G}=this,q=_.elements;return this.x=q[0]*F+q[3]*j+q[6]*G,this.y=q[1]*F+q[4]*j+q[7]*G,this.z=q[2]*F+q[5]*j+q[8]*G,this}applyMatrix4(_){const{x:F}=this,{y:j}=this,{z:G}=this,q=_.elements;return this.x=q[0]*F+q[4]*j+q[8]*G+q[12],this.y=q[1]*F+q[5]*j+q[9]*G+q[13],this.z=q[2]*F+q[6]*j+q[10]*G+q[14],this}applyProjection(_){const{x:F}=this,{y:j}=this,{z:G}=this,q=_.elements,N=q[3]*F+q[7]*j+q[11]*G+q[15];return this.x=(q[0]*F+q[4]*j+q[8]*G+q[12])/N,this.y=(q[1]*F+q[5]*j+q[9]*G+q[13])/N,this.z=(q[2]*F+q[6]*j+q[10]*G+q[14])/N,this}applyQuaternion(_){const{x:F}=this,{y:j}=this,{z:G}=this,q=_.x,N=_.y,ee=_.z,Ce=_.w,he={};he.x=2*(j*ee-G*N),he.y=2*(G*q-F*ee),he.z=2*(F*N-j*q);const ge={};return ge.x=he.y*ee-he.z*N,ge.y=he.z*q-he.x*ee,ge.z=he.x*N-he.y*q,this.x=F+Ce*he.x+ge.x,this.y=j+Ce*he.y+ge.y,this.z=G+Ce*he.z+ge.z,this}negate(){return this.multiplyScalar(-1)}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross(_){const{x:F}=this,{y:j}=this,{z:G}=this;return this.x=j*_.z-G*_.y,this.y=G*_.x-F*_.z,this.z=F*_.y-j*_.x,this}crossVectors(_,F){return this.x=_.y*F.z-_.z*F.y,this.y=_.z*F.x-_.x*F.z,this.z=_.x*F.y-_.y*F.x,this}equals(_){return this.x==_.x&&this.y==_.y&&this.z==_.z}getPositionFromMatrix(_){return this.x=_.elements[12],this.y=_.elements[13],this.z=_.elements[14],this}setEulerFromRotationMatrix(_,F){const j=_.elements,G=j[0],q=j[4],N=j[8],ee=j[5],Ce=j[9],he=j[6],ge=j[10];return F===void 0||F==="XYZ"?(this.y=Math.asin(z(N,-1,1)),Math.abs(N)<.99999?(this.x=Math.atan2(-Ce,ge),this.z=Math.atan2(-q,G)):(this.x=Math.atan2(he,ee),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${F}`),this}rotateAboutVector(_,F){_.normalize();const j=Math.cos(F),G=Math.sin(F),q=this.clone().multiplyScalar(j),N=_.clone().cross(this).multiplyScalar(G),ee=_.clone().multiplyScalar(_.clone().dot(this)).multiplyScalar(1-j),Ce=q.add(N).add(ee);return this.x=Ce.x,this.y=Ce.y,this.z=Ce.z,this}setFromMatrixPosition(_){const F=_.elements;return this.x=F[12],this.y=F[13],this.z=F[14],this}transformDirection(_){const{x:F}=this,{y:j}=this,{z:G}=this,q=_.elements;return this.x=q[0]*F+q[4]*j+q[8]*G,this.y=q[1]*F+q[5]*j+q[9]*G,this.z=q[2]*F+q[6]*j+q[10]*G,this.normalize()}clone(){return new T(this.x,this.y,this.z)}unproject(_){const F=p;return F.multiplyMatrices(_.matrixWorld,F.getInverse(_.projectionMatrix)),this.applyMatrix4(F)}}M=new T,b=new T,I=new T;class L{constructor(_=1,F=0,j=0,G=0,q=1,N=0,ee=0,Ce=0,he=1){this.elements=new Float32Array(9),this.set(_,F,j,G,q,N,ee,Ce,he)}set(_,F,j,G,q,N,ee,Ce,he){const ge=this.elements;return ge[0]=_,ge[3]=F,ge[6]=j,ge[1]=G,ge[4]=q,ge[7]=N,ge[2]=ee,ge[5]=Ce,ge[8]=he,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_){const F=_.elements;this.set(F[0],F[3],F[6],F[1],F[4],F[7],F[2],F[5],F[8])}multiplyScalar(_){const F=this.elements;return F[0]*=_,F[3]*=_,F[6]*=_,F[1]*=_,F[4]*=_,F[7]*=_,F[2]*=_,F[5]*=_,F[8]*=_,this}getInverse3(_){const F=_.elements,j=this.elements;j[0]=F[4]*F[8]-F[5]*F[7],j[3]=F[6]*F[5]-F[3]*F[8],j[6]=F[3]*F[7]-F[6]*F[4],j[1]=F[7]*F[2]-F[1]*F[8],j[4]=F[0]*F[8]-F[6]*F[2],j[7]=F[1]*F[6]-F[0]*F[7],j[2]=F[1]*F[5]-F[2]*F[4],j[5]=F[2]*F[3]-F[0]*F[5],j[8]=F[0]*F[4]-F[1]*F[3];const G=F[0]*j[0]+F[3]*j[1]+F[6]*j[2];return this.multiplyScalar(1/G),this}getInverse(_,F){const j=_.elements,G=this.elements;G[0]=j[10]*j[5]-j[6]*j[9],G[1]=-j[10]*j[1]+j[2]*j[9],G[2]=j[6]*j[1]-j[2]*j[5],G[3]=-j[10]*j[4]+j[6]*j[8],G[4]=j[10]*j[0]-j[2]*j[8],G[5]=-j[6]*j[0]+j[2]*j[4],G[6]=j[9]*j[4]-j[5]*j[8],G[7]=-j[9]*j[0]+j[1]*j[8],G[8]=j[5]*j[0]-j[1]*j[4];const q=j[0]*G[0]+j[1]*G[3]+j[2]*G[6];if(q===0){const N="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(F)throw new Error(N);return console.warn(N),this.identity(),this}return this.multiplyScalar(1/q),this}getDeterminant(){const _=this.elements;return _[0]*_[4]*_[8]+_[1]*_[5]*_[6]+_[2]*_[3]*_[7]-_[2]*_[4]*_[6]-_[1]*_[3]*_[8]-_[0]*_[5]*_[7]}transpose(){let _;const F=this.elements;return _=F[1],F[1]=F[3],F[3]=_,_=F[2],F[2]=F[6],F[6]=_,_=F[5],F[5]=F[7],F[7]=_,this}clone(){const _=this.elements;return new L(_[0],_[3],_[6],_[1],_[4],_[7],_[2],_[5],_[8])}getMatrix4(){const _=this.elements;return new O(_[0],_[3],_[6],0,_[1],_[4],_[7],0,_[2],_[5],_[8],0)}}class Q{constructor(_,F){this.origin=_!==void 0?_:new T,this.direction=F!==void 0?F:new T}set(_,F){return this.origin.copy(_),this.direction.copy(F),this}copy(_){return this.origin.copy(_.origin),this.direction.copy(_.direction),this}at(_,F){return(F||new T).copy(this.direction).multiplyScalar(_).add(this.origin)}recast(_){const F=M;return this.origin.copy(this.at(_,F)),this}closestPointToPoint(_,F){const j=F||new T;j.subVectors(_,this.origin);const G=j.dot(this.direction);return j.copy(this.direction).multiplyScalar(G).add(this.origin)}distanceToPoint(_){const F=M,j=F.subVectors(_,this.origin).dot(this.direction);return F.copy(this.direction).multiplyScalar(j).add(this.origin),F.distanceTo(_)}isIntersectionCylinder(){}isIntersectionSphere(_){return this.distanceToPoint(_.center)<=_.radius}isIntersectionPlane(_){return _.normal.dot(this.direction)!==0||_.distanceToPoint(this.origin)===0}distanceToPlane(_){const F=_.normal.dot(this.direction);return F===0?_.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot(_.normal)+_.constant)/F}intersectPlane(_,F){const j=this.distanceToPlane(_);if(j!==void 0)return this.at(j,F)}applyMatrix4(_){return this.direction.add(this.origin).applyMatrix4(_),this.origin.applyMatrix4(_),this.direction.sub(this.origin),this}clone(){return new Q().copy(this)}}function ne(Z,_,F,j,G,q){j=j*Math.PI/180,G=G*Math.PI/180,q=q*Math.PI/180;const N=me=>me*me,ee=Math.cos(j),Ce=Math.cos(G),he=Math.cos(q),ge=Math.sin(q);return new L(Z,_*he,F*Ce,0,_*ge,F*(ee-Ce*he)/ge,0,0,F*Math.sqrt(1-N(ee)-N(Ce)-N(he)+2*ee*Ce*he)/ge)}},546:(i,n,a)=>{a.r(n),a.d(n,{CustomLinear:()=>M,Gradient:()=>I,GradientType:()=>m,ROYGB:()=>p,RWB:()=>y,Sinebow:()=>w,builtinGradients:()=>b,getGradient:()=>u,normalizeValue:()=>z});var h=a(222);class m{}function z(O,T,L){return T>=O?(L<O&&(L=O),L>T&&(L=T),{lo:O,hi:T,val:L}):(L>O&&(L=O),L<T&&(L=T),{lo:T,hi:O,val:L=O-L+T})}function u(O){if(O instanceof m)return O;if(O.gradient!==void 0&&b[O.gradient]){let T=O.min===void 0?-1:O.min,L=O.max===void 0?1:O.max;return O.mid===void 0?O.colors===void 0?new b[O.gradient](T,L):new b[O.gradient](T,L,O.colors):new b[O.gradient](T,L,O.mid)}if(typeof O.gradient=="string"&&O.gradient.startsWith("linear_")){let T=O.gradient.split("_");T.shift();let L=O.min===void 0?-1:O.min,Q=O.max===void 0?1:O.max;return new M(L,Q,T)}return O}class y extends m{constructor(T,L,Q){super(),this.gradient="RWB",this.mult=1,this.mid=Q,this.min=T,this.max=L,L===void 0&&Array.isArray(T)&&T.length>=2?(this.max=T[1],this.min=T[0]):T&&L&&!Array.isArray(T)&&(this.min=T,this.max=L)}range(){return this.min!==void 0&&this.max!==void 0?[this.min,this.max]:null}valueToHex(T,L){var Q,ne;if(T=this.mult*T,L?(Q=L[0],ne=L[1]):(Q=this.min,ne=this.max),T===void 0)return 16777215;var Z=z(Q,ne,T);Q=Z.lo;var _,F=((ne=Z.hi)+Q)/2;return(T=Z.val)<(F=L&&L[2]!==void 0?L[2]:this.mid!==void 0?this.mid:(Q+ne)/2)?16711680+256*(_=Math.floor(255*Math.sqrt((T-Q)/(F-Q))))+_:T>F?65536*(_=Math.floor(255*Math.sqrt(1-(T-F)/(ne-F))))+256*_+255:16777215}}class p extends m{constructor(T,L){super(),this.gradient="ROYGB",this.mult=1,this.min=T,this.max=L,L===void 0&&Array.isArray(T)&&T.length>=2?(this.max=T[1],this.min=T[0]):T&&L&&!Array.isArray(T)&&(this.min=T,this.max=L)}valueToHex(T,L){var Q,ne;if(T=this.mult*T,L?(Q=L[0],ne=L[1]):(Q=this.min,ne=this.max),T===void 0)return 16777215;var Z=z(Q,ne,T),_=((Q=Z.lo)+(ne=Z.hi))/2,F=(Q+_)/2,j=(_+ne)/2;return(T=Z.val)<F?16711680+256*Math.floor(255*Math.sqrt((T-Q)/(F-Q)))+0:T<_?65536*Math.floor(255*Math.sqrt(1-(T-F)/(_-F)))+65280+0:T<j?65280+1*Math.floor(255*Math.sqrt((T-_)/(j-_))):0+256*Math.floor(255*Math.sqrt(1-(T-j)/(ne-j)))+255}range(){return this.min!==void 0&&this.max!==void 0?[this.min,this.max]:null}}class w extends m{constructor(T,L){super(),this.gradient="Sinebow",this.mult=1,this.min=T,this.max=L,L===void 0&&Array.isArray(T)&&T.length>=2&&(this.max=T[1],this.min=T[0]),L<T&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(T,L){var Q,ne;if(T=this.mult*T,L?(Q=L[0],ne=L[1]):(Q=this.min,ne=this.max),T===void 0)return 16777215;var Z=I.normalizeValue(Q,ne,T);Q=Z.lo,ne=Z.hi;var _=((T=Z.val)-Q)/(ne-Q)*5/6+.5,F=Math.sin(Math.PI*_);F*=255*F;var j=Math.sin(Math.PI*(_+1/3));j*=255*j;var G=Math.sin(Math.PI*(_+2/3));return G*=255*G,65536*Math.floor(F)+256*Math.floor(G)+1*Math.floor(j)}range(){return this.min!==void 0&&this.max!==void 0?[this.min,this.max]:null}}class M extends m{constructor(T,L,Q){var ne;if(super(),this.gradient="linear",this.colors=new Array,Array.isArray(T)&&T.length>=2?(this.max=T[1],this.min=T[0],ne=L):(this.min=T,this.max=L,ne=Q),ne)for(let Z of ne)this.colors.push(h.CC.color(Z));else this.colors.push(h.CC.color(0))}range(){return this.min!==void 0&&this.max!==void 0?[this.min,this.max]:null}valueToHex(T,L){var Q,ne;if(L?(Q=L[0],ne=L[1]):(Q=this.min,ne=this.max),T===void 0)return 16777215;var Z=z(Q,ne,T);Q=Z.lo,ne=Z.hi,T=Z.val;let _=this.colors.length,F=(ne-Q)/_,j=Math.min(Math.floor((T-Q)/F),_-1),G=Math.min(j+1,_-1),q=(T-Q-j*F)/F,N=this.colors[j],ee=this.colors[G];return new h.Color(N.r+q*(ee.r-N.r),N.g+q*(ee.g-N.g),N.b+q*(ee.b-N.b)).getHex()}}const b={rwb:y,RWB:y,roygb:p,ROYGB:p,sinebow:w,linear:M};class I extends m{valueToHex(T,L){return 0}range(){return null}}I.RWB=y,I.ROYGB=p,I.Sinebow=w,I.CustomLinear=M,I.builtinGradients=b,I.normalizeValue=z,I.getGradient=u},663:(i,n,a)=>{var h=a(981),m=a(701),z=a(407),u=a(165),y=a(358),p=-2,w=12,M=30;function b(G){return(G>>>24&255)+(G>>>8&65280)+((65280&G)<<8)+((255&G)<<24)}function I(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new h.Buf16(320),this.work=new h.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function O(G){var q;return G&&G.state?(q=G.state,G.total_in=G.total_out=q.total=0,G.msg="",q.wrap&&(G.adler=1&q.wrap),q.mode=1,q.last=0,q.havedict=0,q.dmax=32768,q.head=null,q.hold=0,q.bits=0,q.lencode=q.lendyn=new h.Buf32(852),q.distcode=q.distdyn=new h.Buf32(592),q.sane=1,q.back=-1,0):p}function T(G){var q;return G&&G.state?((q=G.state).wsize=0,q.whave=0,q.wnext=0,O(G)):p}function L(G,q){var N,ee;return G&&G.state?(ee=G.state,q<0?(N=0,q=-q):(N=1+(q>>4),q<48&&(q&=15)),q&&(q<8||q>15)?p:(ee.window!==null&&ee.wbits!==q&&(ee.window=null),ee.wrap=N,ee.wbits=q,T(G))):p}function Q(G,q){var N,ee;return G?(ee=new I,G.state=ee,ee.window=null,(N=L(G,q))!==0&&(G.state=null),N):p}var ne,Z,_=!0;function F(G){if(_){var q;for(ne=new h.Buf32(512),Z=new h.Buf32(32),q=0;q<144;)G.lens[q++]=8;for(;q<256;)G.lens[q++]=9;for(;q<280;)G.lens[q++]=7;for(;q<288;)G.lens[q++]=8;for(y(1,G.lens,0,288,ne,0,G.work,{bits:9}),q=0;q<32;)G.lens[q++]=5;y(2,G.lens,0,32,Z,0,G.work,{bits:5}),_=!1}G.lencode=ne,G.lenbits=9,G.distcode=Z,G.distbits=5}function j(G,q,N,ee){var Ce,he=G.state;return he.window===null&&(he.wsize=1<<he.wbits,he.wnext=0,he.whave=0,he.window=new h.Buf8(he.wsize)),ee>=he.wsize?(h.arraySet(he.window,q,N-he.wsize,he.wsize,0),he.wnext=0,he.whave=he.wsize):((Ce=he.wsize-he.wnext)>ee&&(Ce=ee),h.arraySet(he.window,q,N-ee,Ce,he.wnext),(ee-=Ce)?(h.arraySet(he.window,q,N-ee,ee,0),he.wnext=ee,he.whave=he.wsize):(he.wnext+=Ce,he.wnext===he.wsize&&(he.wnext=0),he.whave<he.wsize&&(he.whave+=Ce))),0}n.inflateReset=T,n.inflateReset2=L,n.inflateResetKeep=O,n.inflateInit=function(G){return Q(G,15)},n.inflateInit2=Q,n.inflate=function(G,q){var N,ee,Ce,he,ge,me,Me,ue,P,ce,se,X,Re,fe,De,We,oe,Ae,He,Ue,Ie,rt,st,at,Ft=0,Ct=new h.Buf8(4),or=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!G||!G.state||!G.output||!G.input&&G.avail_in!==0)return p;(N=G.state).mode===w&&(N.mode=13),ge=G.next_out,Ce=G.output,Me=G.avail_out,he=G.next_in,ee=G.input,me=G.avail_in,ue=N.hold,P=N.bits,ce=me,se=Me,rt=0;e:for(;;)switch(N.mode){case 1:if(N.wrap===0){N.mode=13;break}for(;P<16;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}if(2&N.wrap&&ue===35615){N.check=0,Ct[0]=255&ue,Ct[1]=ue>>>8&255,N.check=z(N.check,Ct,2,0),ue=0,P=0,N.mode=2;break}if(N.flags=0,N.head&&(N.head.done=!1),!(1&N.wrap)||(((255&ue)<<8)+(ue>>8))%31){G.msg="incorrect header check",N.mode=M;break}if((15&ue)!=8){G.msg="unknown compression method",N.mode=M;break}if(P-=4,Ie=8+(15&(ue>>>=4)),N.wbits===0)N.wbits=Ie;else if(Ie>N.wbits){G.msg="invalid window size",N.mode=M;break}N.dmax=1<<Ie,G.adler=N.check=1,N.mode=512&ue?10:w,ue=0,P=0;break;case 2:for(;P<16;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}if(N.flags=ue,(255&N.flags)!=8){G.msg="unknown compression method",N.mode=M;break}if(57344&N.flags){G.msg="unknown header flags set",N.mode=M;break}N.head&&(N.head.text=ue>>8&1),512&N.flags&&(Ct[0]=255&ue,Ct[1]=ue>>>8&255,N.check=z(N.check,Ct,2,0)),ue=0,P=0,N.mode=3;case 3:for(;P<32;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}N.head&&(N.head.time=ue),512&N.flags&&(Ct[0]=255&ue,Ct[1]=ue>>>8&255,Ct[2]=ue>>>16&255,Ct[3]=ue>>>24&255,N.check=z(N.check,Ct,4,0)),ue=0,P=0,N.mode=4;case 4:for(;P<16;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}N.head&&(N.head.xflags=255&ue,N.head.os=ue>>8),512&N.flags&&(Ct[0]=255&ue,Ct[1]=ue>>>8&255,N.check=z(N.check,Ct,2,0)),ue=0,P=0,N.mode=5;case 5:if(1024&N.flags){for(;P<16;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}N.length=ue,N.head&&(N.head.extra_len=ue),512&N.flags&&(Ct[0]=255&ue,Ct[1]=ue>>>8&255,N.check=z(N.check,Ct,2,0)),ue=0,P=0}else N.head&&(N.head.extra=null);N.mode=6;case 6:if(1024&N.flags&&((X=N.length)>me&&(X=me),X&&(N.head&&(Ie=N.head.extra_len-N.length,N.head.extra||(N.head.extra=new Array(N.head.extra_len)),h.arraySet(N.head.extra,ee,he,X,Ie)),512&N.flags&&(N.check=z(N.check,ee,X,he)),me-=X,he+=X,N.length-=X),N.length))break e;N.length=0,N.mode=7;case 7:if(2048&N.flags){if(me===0)break e;X=0;do Ie=ee[he+X++],N.head&&Ie&&N.length<65536&&(N.head.name+=String.fromCharCode(Ie));while(Ie&&X<me);if(512&N.flags&&(N.check=z(N.check,ee,X,he)),me-=X,he+=X,Ie)break e}else N.head&&(N.head.name=null);N.length=0,N.mode=8;case 8:if(4096&N.flags){if(me===0)break e;X=0;do Ie=ee[he+X++],N.head&&Ie&&N.length<65536&&(N.head.comment+=String.fromCharCode(Ie));while(Ie&&X<me);if(512&N.flags&&(N.check=z(N.check,ee,X,he)),me-=X,he+=X,Ie)break e}else N.head&&(N.head.comment=null);N.mode=9;case 9:if(512&N.flags){for(;P<16;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}if(ue!==(65535&N.check)){G.msg="header crc mismatch",N.mode=M;break}ue=0,P=0}N.head&&(N.head.hcrc=N.flags>>9&1,N.head.done=!0),G.adler=N.check=0,N.mode=w;break;case 10:for(;P<32;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}G.adler=N.check=b(ue),ue=0,P=0,N.mode=11;case 11:if(N.havedict===0)return G.next_out=ge,G.avail_out=Me,G.next_in=he,G.avail_in=me,N.hold=ue,N.bits=P,2;G.adler=N.check=1,N.mode=w;case w:if(q===5||q===6)break e;case 13:if(N.last){ue>>>=7&P,P-=7&P,N.mode=27;break}for(;P<3;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}switch(N.last=1&ue,P-=1,3&(ue>>>=1)){case 0:N.mode=14;break;case 1:if(F(N),N.mode=20,q===6){ue>>>=2,P-=2;break e}break;case 2:N.mode=17;break;case 3:G.msg="invalid block type",N.mode=M}ue>>>=2,P-=2;break;case 14:for(ue>>>=7&P,P-=7&P;P<32;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}if((65535&ue)!=(ue>>>16^65535)){G.msg="invalid stored block lengths",N.mode=M;break}if(N.length=65535&ue,ue=0,P=0,N.mode=15,q===6)break e;case 15:N.mode=16;case 16:if(X=N.length){if(X>me&&(X=me),X>Me&&(X=Me),X===0)break e;h.arraySet(Ce,ee,he,X,ge),me-=X,he+=X,Me-=X,ge+=X,N.length-=X;break}N.mode=w;break;case 17:for(;P<14;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}if(N.nlen=257+(31&ue),ue>>>=5,P-=5,N.ndist=1+(31&ue),ue>>>=5,P-=5,N.ncode=4+(15&ue),ue>>>=4,P-=4,N.nlen>286||N.ndist>30){G.msg="too many length or distance symbols",N.mode=M;break}N.have=0,N.mode=18;case 18:for(;N.have<N.ncode;){for(;P<3;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}N.lens[or[N.have++]]=7&ue,ue>>>=3,P-=3}for(;N.have<19;)N.lens[or[N.have++]]=0;if(N.lencode=N.lendyn,N.lenbits=7,st={bits:N.lenbits},rt=y(0,N.lens,0,19,N.lencode,0,N.work,st),N.lenbits=st.bits,rt){G.msg="invalid code lengths set",N.mode=M;break}N.have=0,N.mode=19;case 19:for(;N.have<N.nlen+N.ndist;){for(;We=(Ft=N.lencode[ue&(1<<N.lenbits)-1])>>>16&255,oe=65535&Ft,!((De=Ft>>>24)<=P);){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}if(oe<16)ue>>>=De,P-=De,N.lens[N.have++]=oe;else{if(oe===16){for(at=De+2;P<at;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}if(ue>>>=De,P-=De,N.have===0){G.msg="invalid bit length repeat",N.mode=M;break}Ie=N.lens[N.have-1],X=3+(3&ue),ue>>>=2,P-=2}else if(oe===17){for(at=De+3;P<at;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}P-=De,Ie=0,X=3+(7&(ue>>>=De)),ue>>>=3,P-=3}else{for(at=De+7;P<at;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}P-=De,Ie=0,X=11+(127&(ue>>>=De)),ue>>>=7,P-=7}if(N.have+X>N.nlen+N.ndist){G.msg="invalid bit length repeat",N.mode=M;break}for(;X--;)N.lens[N.have++]=Ie}}if(N.mode===M)break;if(N.lens[256]===0){G.msg="invalid code -- missing end-of-block",N.mode=M;break}if(N.lenbits=9,st={bits:N.lenbits},rt=y(1,N.lens,0,N.nlen,N.lencode,0,N.work,st),N.lenbits=st.bits,rt){G.msg="invalid literal/lengths set",N.mode=M;break}if(N.distbits=6,N.distcode=N.distdyn,st={bits:N.distbits},rt=y(2,N.lens,N.nlen,N.ndist,N.distcode,0,N.work,st),N.distbits=st.bits,rt){G.msg="invalid distances set",N.mode=M;break}if(N.mode=20,q===6)break e;case 20:N.mode=21;case 21:if(me>=6&&Me>=258){G.next_out=ge,G.avail_out=Me,G.next_in=he,G.avail_in=me,N.hold=ue,N.bits=P,u(G,se),ge=G.next_out,Ce=G.output,Me=G.avail_out,he=G.next_in,ee=G.input,me=G.avail_in,ue=N.hold,P=N.bits,N.mode===w&&(N.back=-1);break}for(N.back=0;We=(Ft=N.lencode[ue&(1<<N.lenbits)-1])>>>16&255,oe=65535&Ft,!((De=Ft>>>24)<=P);){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}if(We&&!(240&We)){for(Ae=De,He=We,Ue=oe;We=(Ft=N.lencode[Ue+((ue&(1<<Ae+He)-1)>>Ae)])>>>16&255,oe=65535&Ft,!(Ae+(De=Ft>>>24)<=P);){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}ue>>>=Ae,P-=Ae,N.back+=Ae}if(ue>>>=De,P-=De,N.back+=De,N.length=oe,We===0){N.mode=26;break}if(32&We){N.back=-1,N.mode=w;break}if(64&We){G.msg="invalid literal/length code",N.mode=M;break}N.extra=15&We,N.mode=22;case 22:if(N.extra){for(at=N.extra;P<at;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}N.length+=ue&(1<<N.extra)-1,ue>>>=N.extra,P-=N.extra,N.back+=N.extra}N.was=N.length,N.mode=23;case 23:for(;We=(Ft=N.distcode[ue&(1<<N.distbits)-1])>>>16&255,oe=65535&Ft,!((De=Ft>>>24)<=P);){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}if(!(240&We)){for(Ae=De,He=We,Ue=oe;We=(Ft=N.distcode[Ue+((ue&(1<<Ae+He)-1)>>Ae)])>>>16&255,oe=65535&Ft,!(Ae+(De=Ft>>>24)<=P);){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}ue>>>=Ae,P-=Ae,N.back+=Ae}if(ue>>>=De,P-=De,N.back+=De,64&We){G.msg="invalid distance code",N.mode=M;break}N.offset=oe,N.extra=15&We,N.mode=24;case 24:if(N.extra){for(at=N.extra;P<at;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}N.offset+=ue&(1<<N.extra)-1,ue>>>=N.extra,P-=N.extra,N.back+=N.extra}if(N.offset>N.dmax){G.msg="invalid distance too far back",N.mode=M;break}N.mode=25;case 25:if(Me===0)break e;if(X=se-Me,N.offset>X){if((X=N.offset-X)>N.whave&&N.sane){G.msg="invalid distance too far back",N.mode=M;break}X>N.wnext?(X-=N.wnext,Re=N.wsize-X):Re=N.wnext-X,X>N.length&&(X=N.length),fe=N.window}else fe=Ce,Re=ge-N.offset,X=N.length;X>Me&&(X=Me),Me-=X,N.length-=X;do Ce[ge++]=fe[Re++];while(--X);N.length===0&&(N.mode=21);break;case 26:if(Me===0)break e;Ce[ge++]=N.length,Me--,N.mode=21;break;case 27:if(N.wrap){for(;P<32;){if(me===0)break e;me--,ue|=ee[he++]<<P,P+=8}if(se-=Me,G.total_out+=se,N.total+=se,se&&(G.adler=N.check=N.flags?z(N.check,Ce,se,ge-se):m(N.check,Ce,se,ge-se)),se=Me,(N.flags?ue:b(ue))!==N.check){G.msg="incorrect data check",N.mode=M;break}ue=0,P=0}N.mode=28;case 28:if(N.wrap&&N.flags){for(;P<32;){if(me===0)break e;me--,ue+=ee[he++]<<P,P+=8}if(ue!==(4294967295&N.total)){G.msg="incorrect length check",N.mode=M;break}ue=0,P=0}N.mode=29;case 29:rt=1;break e;case M:rt=-3;break e;case 31:return-4;default:return p}return G.next_out=ge,G.avail_out=Me,G.next_in=he,G.avail_in=me,N.hold=ue,N.bits=P,(N.wsize||se!==G.avail_out&&N.mode<M&&(N.mode<27||q!==4))&&j(G,G.output,G.next_out,se-G.avail_out)?(N.mode=31,-4):(ce-=G.avail_in,se-=G.avail_out,G.total_in+=ce,G.total_out+=se,N.total+=se,N.wrap&&se&&(G.adler=N.check=N.flags?z(N.check,Ce,se,G.next_out-se):m(N.check,Ce,se,G.next_out-se)),G.data_type=N.bits+(N.last?64:0)+(N.mode===w?128:0)+(N.mode===20||N.mode===15?256:0),(ce===0&&se===0||q===4)&&rt===0&&(rt=-5),rt)},n.inflateEnd=function(G){if(!G||!G.state)return p;var q=G.state;return q.window&&(q.window=null),G.state=null,0},n.inflateGetHeader=function(G,q){var N;return G&&G.state&&2&(N=G.state).wrap?(N.head=q,q.done=!1,0):p},n.inflateSetDictionary=function(G,q){var N,ee=q.length;return G&&G.state?(N=G.state).wrap!==0&&N.mode!==11?p:N.mode===11&&m(1,q,ee,0)!==N.check?-3:j(G,q,ee,ee)?(N.mode=31,-4):(N.havedict=1,0):p},n.inflateInfo="pako inflate (from Nodeca project)"},670:i=>{i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},681:i=>{i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},697:(i,n,a)=>{var h=a(981);function m(oe){for(var Ae=oe.length;--Ae>=0;)oe[Ae]=0}var z=256,u=286,y=30,p=15,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],M=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O=new Array(576);m(O);var T=new Array(60);m(T);var L=new Array(512);m(L);var Q=new Array(256);m(Q);var ne=new Array(29);m(ne);var Z,_,F,j=new Array(y);function G(oe,Ae,He,Ue,Ie){this.static_tree=oe,this.extra_bits=Ae,this.extra_base=He,this.elems=Ue,this.max_length=Ie,this.has_stree=oe&&oe.length}function q(oe,Ae){this.dyn_tree=oe,this.max_code=0,this.stat_desc=Ae}function N(oe){return oe<256?L[oe]:L[256+(oe>>>7)]}function ee(oe,Ae){oe.pending_buf[oe.pending++]=255&Ae,oe.pending_buf[oe.pending++]=Ae>>>8&255}function Ce(oe,Ae,He){oe.bi_valid>16-He?(oe.bi_buf|=Ae<<oe.bi_valid&65535,ee(oe,oe.bi_buf),oe.bi_buf=Ae>>16-oe.bi_valid,oe.bi_valid+=He-16):(oe.bi_buf|=Ae<<oe.bi_valid&65535,oe.bi_valid+=He)}function he(oe,Ae,He){Ce(oe,He[2*Ae],He[2*Ae+1])}function ge(oe,Ae){var He=0;do He|=1&oe,oe>>>=1,He<<=1;while(--Ae>0);return He>>>1}function me(oe,Ae,He){var Ue,Ie,rt=new Array(16),st=0;for(Ue=1;Ue<=p;Ue++)rt[Ue]=st=st+He[Ue-1]<<1;for(Ie=0;Ie<=Ae;Ie++){var at=oe[2*Ie+1];at!==0&&(oe[2*Ie]=ge(rt[at]++,at))}}function Me(oe){var Ae;for(Ae=0;Ae<u;Ae++)oe.dyn_ltree[2*Ae]=0;for(Ae=0;Ae<y;Ae++)oe.dyn_dtree[2*Ae]=0;for(Ae=0;Ae<19;Ae++)oe.bl_tree[2*Ae]=0;oe.dyn_ltree[512]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function ue(oe){oe.bi_valid>8?ee(oe,oe.bi_buf):oe.bi_valid>0&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function P(oe,Ae,He,Ue){var Ie=2*Ae,rt=2*He;return oe[Ie]<oe[rt]||oe[Ie]===oe[rt]&&Ue[Ae]<=Ue[He]}function ce(oe,Ae,He){for(var Ue=oe.heap[He],Ie=He<<1;Ie<=oe.heap_len&&(Ie<oe.heap_len&&P(Ae,oe.heap[Ie+1],oe.heap[Ie],oe.depth)&&Ie++,!P(Ae,Ue,oe.heap[Ie],oe.depth));)oe.heap[He]=oe.heap[Ie],He=Ie,Ie<<=1;oe.heap[He]=Ue}function se(oe,Ae,He){var Ue,Ie,rt,st,at=0;if(oe.last_lit!==0)do Ue=oe.pending_buf[oe.d_buf+2*at]<<8|oe.pending_buf[oe.d_buf+2*at+1],Ie=oe.pending_buf[oe.l_buf+at],at++,Ue===0?he(oe,Ie,Ae):(he(oe,(rt=Q[Ie])+z+1,Ae),(st=w[rt])!==0&&Ce(oe,Ie-=ne[rt],st),he(oe,rt=N(--Ue),He),(st=M[rt])!==0&&Ce(oe,Ue-=j[rt],st));while(at<oe.last_lit);he(oe,256,Ae)}function X(oe,Ae){var He,Ue,Ie,rt=Ae.dyn_tree,st=Ae.stat_desc.static_tree,at=Ae.stat_desc.has_stree,Ft=Ae.stat_desc.elems,Ct=-1;for(oe.heap_len=0,oe.heap_max=573,He=0;He<Ft;He++)rt[2*He]!==0?(oe.heap[++oe.heap_len]=Ct=He,oe.depth[He]=0):rt[2*He+1]=0;for(;oe.heap_len<2;)rt[2*(Ie=oe.heap[++oe.heap_len]=Ct<2?++Ct:0)]=1,oe.depth[Ie]=0,oe.opt_len--,at&&(oe.static_len-=st[2*Ie+1]);for(Ae.max_code=Ct,He=oe.heap_len>>1;He>=1;He--)ce(oe,rt,He);Ie=Ft;do He=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],ce(oe,rt,1),Ue=oe.heap[1],oe.heap[--oe.heap_max]=He,oe.heap[--oe.heap_max]=Ue,rt[2*Ie]=rt[2*He]+rt[2*Ue],oe.depth[Ie]=(oe.depth[He]>=oe.depth[Ue]?oe.depth[He]:oe.depth[Ue])+1,rt[2*He+1]=rt[2*Ue+1]=Ie,oe.heap[1]=Ie++,ce(oe,rt,1);while(oe.heap_len>=2);oe.heap[--oe.heap_max]=oe.heap[1],(function(or,ar){var kr,Ar,pr,vr,xr,fi,Rr=ar.dyn_tree,Ir=ar.max_code,Di=ar.stat_desc.static_tree,bi=ar.stat_desc.has_stree,Hi=ar.stat_desc.extra_bits,pe=ar.stat_desc.extra_base,Se=ar.stat_desc.max_length,Le=0;for(vr=0;vr<=p;vr++)or.bl_count[vr]=0;for(Rr[2*or.heap[or.heap_max]+1]=0,kr=or.heap_max+1;kr<573;kr++)(vr=Rr[2*Rr[2*(Ar=or.heap[kr])+1]+1]+1)>Se&&(vr=Se,Le++),Rr[2*Ar+1]=vr,Ar>Ir||(or.bl_count[vr]++,xr=0,Ar>=pe&&(xr=Hi[Ar-pe]),fi=Rr[2*Ar],or.opt_len+=fi*(vr+xr),bi&&(or.static_len+=fi*(Di[2*Ar+1]+xr)));if(Le!==0){do{for(vr=Se-1;or.bl_count[vr]===0;)vr--;or.bl_count[vr]--,or.bl_count[vr+1]+=2,or.bl_count[Se]--,Le-=2}while(Le>0);for(vr=Se;vr!==0;vr--)for(Ar=or.bl_count[vr];Ar!==0;)(pr=or.heap[--kr])>Ir||(Rr[2*pr+1]!==vr&&(or.opt_len+=(vr-Rr[2*pr+1])*Rr[2*pr],Rr[2*pr+1]=vr),Ar--)}})(oe,Ae),me(rt,Ct,oe.bl_count)}function Re(oe,Ae,He){var Ue,Ie,rt=-1,st=Ae[1],at=0,Ft=7,Ct=4;for(st===0&&(Ft=138,Ct=3),Ae[2*(He+1)+1]=65535,Ue=0;Ue<=He;Ue++)Ie=st,st=Ae[2*(Ue+1)+1],++at<Ft&&Ie===st||(at<Ct?oe.bl_tree[2*Ie]+=at:Ie!==0?(Ie!==rt&&oe.bl_tree[2*Ie]++,oe.bl_tree[32]++):at<=10?oe.bl_tree[34]++:oe.bl_tree[36]++,at=0,rt=Ie,st===0?(Ft=138,Ct=3):Ie===st?(Ft=6,Ct=3):(Ft=7,Ct=4))}function fe(oe,Ae,He){var Ue,Ie,rt=-1,st=Ae[1],at=0,Ft=7,Ct=4;for(st===0&&(Ft=138,Ct=3),Ue=0;Ue<=He;Ue++)if(Ie=st,st=Ae[2*(Ue+1)+1],!(++at<Ft&&Ie===st)){if(at<Ct)do he(oe,Ie,oe.bl_tree);while(--at!==0);else Ie!==0?(Ie!==rt&&(he(oe,Ie,oe.bl_tree),at--),he(oe,16,oe.bl_tree),Ce(oe,at-3,2)):at<=10?(he(oe,17,oe.bl_tree),Ce(oe,at-3,3)):(he(oe,18,oe.bl_tree),Ce(oe,at-11,7));at=0,rt=Ie,st===0?(Ft=138,Ct=3):Ie===st?(Ft=6,Ct=3):(Ft=7,Ct=4)}}m(j);var De=!1;function We(oe,Ae,He,Ue){Ce(oe,0+(Ue?1:0),3),(function(Ie,rt,st,at){ue(Ie),ee(Ie,st),ee(Ie,~st),h.arraySet(Ie.pending_buf,Ie.window,rt,st,Ie.pending),Ie.pending+=st})(oe,Ae,He)}n._tr_init=function(oe){De||((function(){var Ae,He,Ue,Ie,rt,st=new Array(16);for(Ue=0,Ie=0;Ie<28;Ie++)for(ne[Ie]=Ue,Ae=0;Ae<1<<w[Ie];Ae++)Q[Ue++]=Ie;for(Q[Ue-1]=Ie,rt=0,Ie=0;Ie<16;Ie++)for(j[Ie]=rt,Ae=0;Ae<1<<M[Ie];Ae++)L[rt++]=Ie;for(rt>>=7;Ie<y;Ie++)for(j[Ie]=rt<<7,Ae=0;Ae<1<<M[Ie]-7;Ae++)L[256+rt++]=Ie;for(He=0;He<=p;He++)st[He]=0;for(Ae=0;Ae<=143;)O[2*Ae+1]=8,Ae++,st[8]++;for(;Ae<=255;)O[2*Ae+1]=9,Ae++,st[9]++;for(;Ae<=279;)O[2*Ae+1]=7,Ae++,st[7]++;for(;Ae<=287;)O[2*Ae+1]=8,Ae++,st[8]++;for(me(O,287,st),Ae=0;Ae<y;Ae++)T[2*Ae+1]=5,T[2*Ae]=ge(Ae,5);Z=new G(O,w,257,u,p),_=new G(T,M,0,y,p),F=new G(new Array(0),b,0,19,7)})(),De=!0),oe.l_desc=new q(oe.dyn_ltree,Z),oe.d_desc=new q(oe.dyn_dtree,_),oe.bl_desc=new q(oe.bl_tree,F),oe.bi_buf=0,oe.bi_valid=0,Me(oe)},n._tr_stored_block=We,n._tr_flush_block=function(oe,Ae,He,Ue){var Ie,rt,st=0;oe.level>0?(oe.strm.data_type===2&&(oe.strm.data_type=(function(at){var Ft,Ct=4093624447;for(Ft=0;Ft<=31;Ft++,Ct>>>=1)if(1&Ct&&at.dyn_ltree[2*Ft]!==0)return 0;if(at.dyn_ltree[18]!==0||at.dyn_ltree[20]!==0||at.dyn_ltree[26]!==0)return 1;for(Ft=32;Ft<z;Ft++)if(at.dyn_ltree[2*Ft]!==0)return 1;return 0})(oe)),X(oe,oe.l_desc),X(oe,oe.d_desc),st=(function(at){var Ft;for(Re(at,at.dyn_ltree,at.l_desc.max_code),Re(at,at.dyn_dtree,at.d_desc.max_code),X(at,at.bl_desc),Ft=18;Ft>=3&&at.bl_tree[2*I[Ft]+1]===0;Ft--);return at.opt_len+=3*(Ft+1)+5+5+4,Ft})(oe),Ie=oe.opt_len+3+7>>>3,(rt=oe.static_len+3+7>>>3)<=Ie&&(Ie=rt)):Ie=rt=He+5,He+4<=Ie&&Ae!==-1?We(oe,Ae,He,Ue):oe.strategy===4||rt===Ie?(Ce(oe,2+(Ue?1:0),3),se(oe,O,T)):(Ce(oe,4+(Ue?1:0),3),(function(at,Ft,Ct,or){var ar;for(Ce(at,Ft-257,5),Ce(at,Ct-1,5),Ce(at,or-4,4),ar=0;ar<or;ar++)Ce(at,at.bl_tree[2*I[ar]+1],3);fe(at,at.dyn_ltree,Ft-1),fe(at,at.dyn_dtree,Ct-1)})(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,st+1),se(oe,oe.dyn_ltree,oe.dyn_dtree)),Me(oe),Ue&&ue(oe)},n._tr_tally=function(oe,Ae,He){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=Ae>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&Ae,oe.pending_buf[oe.l_buf+oe.last_lit]=255&He,oe.last_lit++,Ae===0?oe.dyn_ltree[2*He]++:(oe.matches++,Ae--,oe.dyn_ltree[2*(Q[He]+z+1)]++,oe.dyn_dtree[2*N(Ae)]++),oe.last_lit===oe.lit_bufsize-1},n._tr_align=function(oe){Ce(oe,2,3),he(oe,256,O),(function(Ae){Ae.bi_valid===16?(ee(Ae,Ae.bi_buf),Ae.bi_buf=0,Ae.bi_valid=0):Ae.bi_valid>=8&&(Ae.pending_buf[Ae.pending++]=255&Ae.bi_buf,Ae.bi_buf>>=8,Ae.bi_valid-=8)})(oe)}},701:i=>{i.exports=function(n,a,h,m){for(var z=65535&n,u=n>>>16&65535,y=0;h!==0;){h-=y=h>2e3?2e3:h;do u=u+(z=z+a[m++]|0)|0;while(--y);z%=65521,u%=65521}return z|u<<16}},746:i=>{i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},788:(i,n,a)=>{var h={};(0,a(981).assign)(h,a(71),a(3),a(681)),i.exports=h},797:(i,n,a)=>{a.r(n),a.d(n,{VASP:()=>z});var h=a(378),m=a(392);function z(u,y={}){var p=[[]],w={};const M=y.assignBonds===void 0||y.assignBonds;var b=u.replace(/^\s+/,"").split(/\r?\n/);if(b.length<3)return p;if(!b[1].match(/\d+/))return console.log("Warning: second line of the vasp structure file must be a number"),p;if(w.length=parseFloat(b[1]),w.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),p;w.xVec=new Float32Array(b[2].replace(/^\s+/,"").split(/\s+/)),w.yVec=new Float32Array(b[3].replace(/^\s+/,"").split(/\s+/)),w.zVec=new Float32Array(b[4].replace(/^\s+/,"").split(/\s+/));var I=new h.Matrix3(w.xVec[0],w.xVec[1],w.xVec[2],w.yVec[0],w.yVec[1],w.yVec[2],w.zVec[0],w.zVec[1],w.zVec[2]);I.multiplyScalar(w.length),p.modelData=[{symmetries:[],cryst:{matrix:I}}];var O=b[5].trim().split(/\s+/),T=new Int16Array(b[6].trim().split(/\s+/)),L=b[7].trim(),Q=!1;if(L.match(/S/)&&(Q=!0,L=b[8].trim()),L.toLowerCase()[0]=="c")L="cartesian";else{if(L.toLowerCase()[0]!="d")return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),p;L="direct"}if(O.length!=T.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(O),console.log(T),p;Q?b.splice(0,9):b.splice(0,8);for(var ne=0,Z=0,_=O.length;Z<_;Z++){for(var F=O[Z],j=0,G=T[Z];j<G;j++){var q=new Float32Array(b[ne+j].trim().split(/\s+/)),N={};N.elem=F,L=="cartesian"?(N.x=w.length*q[0],N.y=w.length*q[1],N.z=w.length*q[2]):(N.x=w.length*(q[0]*w.xVec[0]+q[1]*w.yVec[0]+q[2]*w.zVec[0]),N.y=w.length*(q[0]*w.xVec[1]+q[1]*w.yVec[1]+q[2]*w.zVec[1]),N.z=w.length*(q[0]*w.xVec[2]+q[1]*w.yVec[2]+q[2]*w.zVec[2])),N.bonds=[],N.bondOrder=[],p[0].push(N)}ne+=T[Z]}if(M)for(let ee=0;ee<p.length;ee++)(0,m.assignBonds)(p[ee],y);return p}},834:i=>{i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},848:(i,n,a)=>{a.r(n),a.d(n,{VolumeData:()=>p});var h=a(864),m=a(529),z=a(797),u=a(865),y=a(75);class p{constructor(M,b,I){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(ne){var Z=ne/(this.size.y*this.size.z),_=ne%(this.size.y*this.size.z),F=ne%this.size.z;return Z*=this.unit.x,_*=this.unit.y,F*=this.unit.z,{x:Z+=this.origin.x,y:_+=this.origin.y,z:F+=this.origin.z}},this.vasp=function(ne){var Z=ne.replace(/^\s+/,"").split(/[\n\r]/),_=(0,z.VASP)(ne)[0].length;if(_==0)return console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),void(this.data=[]);var F,j=1.889725992,G=parseFloat(Z[1]);F=Z[2].replace(/^\s+/,"").split(/\s+/);var q=new m.Vector3(parseFloat(F[0]),parseFloat(F[1]),parseFloat(F[2])).multiplyScalar(G*j);F=Z[3].replace(/^\s+/,"").split(/\s+/);var N=new m.Vector3(parseFloat(F[0]),parseFloat(F[1]),parseFloat(F[2])).multiplyScalar(G*j);F=Z[4].replace(/^\s+/,"").split(/\s+/);var ee=new m.Vector3(parseFloat(F[0]),parseFloat(F[1]),parseFloat(F[2])).multiplyScalar(G*j),Ce=q.x*(N.y*ee.z-ee.y*N.z)-N.x*(q.y*ee.z-ee.y*q.z)+ee.x*(q.y*N.z-N.y*q.z),he=1/(Ce=Math.abs(Ce)/Math.pow(j,3));Z.splice(0,8+_+1);var ge=Z[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),me=Math.abs(parseFloat(ge[0])),Me=Math.abs(parseFloat(ge[1])),ue=Math.abs(parseFloat(ge[2])),P=this.origin=new m.Vector3(0,0,0);this.size={x:me,y:Me,z:ue},this.unit=new m.Vector3(q.x,N.y,ee.z),q=q.multiplyScalar(1/(j*me)),N=N.multiplyScalar(1/(j*Me)),ee=ee.multiplyScalar(1/(j*ue)),q.y==0&&q.z==0&&N.x==0&&N.z==0&&ee.x==0&&ee.y==0||(this.matrix=new m.Matrix4(q.x,N.x,ee.x,0,q.y,N.y,ee.y,0,q.z,N.z,ee.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new m.Matrix4().makeTranslation(P.x,P.y,P.z)),this.origin=new m.Vector3(0,0,0),this.unit=new m.Vector3(1,1,1)),Z.splice(0,1);var ce=Z.join(" "),se=(ce=ce.replace(/^\s+/,"")).split(/[\s\r]+/);se.splice(me*Me*ue+1);for(var X=Float32Array.from(se,parseFloat),Re=0;Re<X.length;Re++)X[Re]=X[Re]*he*.036749309;this.data=X},this.dx=function(ne){var Z,_=ne.split(/[\n\r]+/),F=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,j=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,G=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,q=/data follows/,N=0;for(N=0;N<_.length;N++){var ee=_[N];if(Z=F.exec(ee)){var Ce=parseInt(Z[1]),he=parseInt(Z[2]),ge=parseInt(Z[3]);this.size={x:Ce,y:he,z:ge}}else if(Z=G.exec(ee)){var me=parseFloat(Z[1]);if(parseFloat(Z[2])==0&&parseFloat(Z[3])==0||console.warn("Non-orthogonal delta matrix not currently supported in dx format"),ee=_[N+=1],(Z=G.exec(ee))==null)return void console.error("Parse error in dx delta matrix");var Me=parseFloat(Z[2]);if(parseFloat(Z[1])==0&&parseFloat(Z[3])==0||console.warn("Non-orthogonal delta matrix not currently supported in dx format"),ee=_[N+=1],(Z=G.exec(ee))==null)return void console.error("Parse error in dx delta matrix");var ue=parseFloat(Z[3]);parseFloat(Z[1])==0&&parseFloat(Z[2])==0||console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new m.Vector3(me,Me,ue)}else if(Z=j.exec(ee)){var P=parseFloat(Z[1]),ce=parseFloat(Z[2]),se=parseFloat(Z[3]);this.origin=new m.Vector3(P,ce,se)}else if(Z=q.exec(ee))break}if(N+=1,this.size&&this.origin&&this.unit&&this.size){var X=_.splice(N).join(" ").split(/[\s\r]+/);this.data=Float32Array.from(X,parseFloat)}else console.error("Error parsing dx format")},b=b.toLowerCase(),/\.gz$/.test(b)){b=b.replace(/\.gz$/,"");try{this[b]&&this.isbinary.has(b)?(typeof M=="string"&&(M=(0,h.base64ToArray)(M)),M=(0,y.inflate)(M)):M=new TextDecoder("utf-8").decode((0,y.inflate)(M))}catch(ne){console.error(ne)}}if(this[b]&&(this.isbinary.has(b)&&typeof M=="string"&&(M=(0,h.base64ToArray)(M)),this[b](M)),I){if(I.negate)for(let ne=0,Z=this.data.length;ne<Z;ne++)this.data[ne]=-this.data[ne];if(I.normalize){var O=0;for(let ne=0,Z=this.data.length;ne<Z;ne++)O+=this.data[ne];var T=O/this.data.length;O=0;for(let ne=0,Z=this.data.length;ne<Z;ne++){var L=this.data[ne]-T;O+=L*L}var Q=O/this.data.length;for(let ne=0,Z=this.data.length;ne<Z;ne++)this.data[ne]=(this.data[ne]-T)/Q}}}getIndex(M,b,I){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new m.Matrix4().getInverse(this.matrix));var O=new m.Vector3(M,b,I);M=(O=O.applyMatrix4(this.inversematrix)).x,b=O.y,I=O.z}else M-=this.origin.x,b-=this.origin.y,I-=this.origin.z,M/=this.unit.x,b/=this.unit.y,I/=this.unit.z;return M=Math.round(M),b=Math.round(b),I=Math.round(I),M<0||M>=this.size.x||b<0||b>=this.size.y||I<0||I>=this.size.z?-1:M*this.size.y*this.size.z+b*this.size.z+I}getVal(M,b,I){let O=this.getIndex(M,b,I);return O<0?0:this.data[O]}cube(M){var b=M.split(/\r?\n/);if(!(b.length<6)){var I=(0,u.CUBE)(M,{}).modelData[0].cryst,O=b[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),T=parseFloat(O[0]),L=Math.abs(T);this.origin=I.origin,this.size=I.size,this.unit=I.unit,this.matrix=I.matrix4;var Q=6;T<0&&Q++;var ne=b.splice(L+Q).join(" "),Z=(ne=ne.replace(/^\s+/,"")).split(/[\s\r]+/);this.data=Float32Array.from(Z,parseFloat)}}ccp4(M){var b={};M=new Int8Array(M);var I=new Int32Array(M.buffer,0,56),O=new Float32Array(M.buffer,0,56),T=new DataView(M.buffer);if(b.MAP=String.fromCharCode(T.getUint8(208),T.getUint8(209),T.getUint8(210),T.getUint8(211)),b.MACHST=[T.getUint8(212),T.getUint8(213)],b.MACHST[0]===17&&b.MACHST[1]===17)for(var L=M.byteLength,Q=0;Q<L;Q+=4)T.setFloat32(Q,T.getFloat32(Q),!0);b.NX=I[0],b.NY=I[1],b.NZ=I[2],b.MODE=I[3],b.NXSTART=I[4],b.NYSTART=I[5],b.NZSTART=I[6],b.MX=I[7],b.MY=I[8],b.MZ=I[9],b.xlen=O[10],b.ylen=O[11],b.zlen=O[12],b.alpha=O[13],b.beta=O[14],b.gamma=O[15],b.MAPC=I[16],b.MAPR=I[17],b.MAPS=I[18],b.DMIN=O[19],b.DMAX=O[20],b.DMEAN=O[21],b.ISPG=I[22],b.NSYMBT=I[23],b.LSKFLG=I[24],b.originX=O[49],b.originY=O[50],b.originZ=O[51],b.ARMS=O[54];var ne=b,Z=[ne.xlen,0,0],_=[ne.ylen*Math.cos(Math.PI/180*ne.gamma),ne.ylen*Math.sin(Math.PI/180*ne.gamma),0],F=[ne.zlen*Math.cos(Math.PI/180*ne.beta),ne.zlen*(Math.cos(Math.PI/180*ne.alpha)-Math.cos(Math.PI/180*ne.gamma)*Math.cos(Math.PI/180*ne.beta))/Math.sin(Math.PI/180*ne.gamma),0];F[2]=Math.sqrt(ne.zlen*ne.zlen*Math.sin(Math.PI/180*ne.beta)*Math.sin(Math.PI/180*ne.beta)-F[1]*F[1]);var j=[0,Z,_,F],G=[0,ne.MX,ne.MY,ne.MZ],q=[0,ne.MAPC,ne.MAPR,ne.MAPS];this.matrix=new m.Matrix4,this.matrix.set(j[q[1]][0]/G[q[1]],j[q[2]][0]/G[q[2]],j[q[3]][0]/G[q[3]],0,j[q[1]][1]/G[q[1]],j[q[2]][1]/G[q[2]],j[q[3]][1]/G[q[3]],0,j[q[1]][2]/G[q[1]],j[q[2]][2]/G[q[2]],j[q[3]][2]/G[q[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new m.Matrix4().makeTranslation(ne.NXSTART+ne.originX,ne.NYSTART+ne.originY,ne.NZSTART+ne.originZ)),this.origin=new m.Vector3(0,0,0),this.unit=new m.Vector3(1,1,1),this.size={x:b.NX,y:b.NY,z:b.NZ},this.dimensionorder=[b.MAPC,b.MAPR,b.MAPS];var N=new Float32Array(M.buffer,1024+b.NSYMBT),ee=b.NX,Ce=b.NY,he=b.NZ;this.data=new Float32Array(ee*Ce*he);for(let ge=0;ge<ee;ge++)for(let me=0;me<Ce;me++)for(let Me=0;Me<he;Me++)this.data[(ge*Ce+me)*he+Me]=N[(Me*Ce+me)*ee+ge]}}},864:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(546),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(848),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(222),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(75);function extend(i,n){for(var a in n)n.hasOwnProperty(a)&&n[a]!==void 0&&(i[a]=n[a]);return i}function deepCopy(i){let n,a,h;if(i==null)return{};if(typeof i!="object"||i===null)return i;for(h in n=Array.isArray(i)?[]:{},i)a=i[h],n[h]=deepCopy(a);return n}function isNumeric(i){var n=typeof i;return(n==="number"||n==="string")&&!isNaN(i-parseFloat(i))}function isEmptyObject(i){return Object.keys(i).length===0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?(console.warn("Invalid callback provided."),()=>{}):callback}function adjustVolumeStyle(i){i&&(!i.volformat||i.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData||(i.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(i.voldata,i.volformat)),i.volscheme&&(i.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(i.volscheme)))}function getExtent(i,n){var a,h,m,z,u,y,p,w,M,b,I=!n;if(a=h=m=9999,z=u=y=-9999,p=w=M=b=0,i.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var O=0;O<i.length;O++){var T=i[O];if(T!==void 0&&isFinite(T.x)&&isFinite(T.y)&&isFinite(T.z)&&(b++,p+=T.x,w+=T.y,M+=T.z,a=a<T.x?a:T.x,h=h<T.y?h:T.y,m=m<T.z?m:T.z,z=z>T.x?z:T.x,u=u>T.y?u:T.y,y=y>T.z?y:T.z,T.symmetries&&I))for(var L=0;L<T.symmetries.length;L++)b++,p+=T.symmetries[L].x,w+=T.symmetries[L].y,M+=T.symmetries[L].z,a=a<T.symmetries[L].x?a:T.symmetries[L].x,h=h<T.symmetries[L].y?h:T.symmetries[L].y,m=m<T.symmetries[L].z?m:T.symmetries[L].z,z=z>T.symmetries[L].x?z:T.symmetries[L].x,u=u>T.symmetries[L].y?u:T.symmetries[L].y,y=y>T.symmetries[L].z?y:T.symmetries[L].z}return[[a,h,m],[z,u,y],[p/b,w/b,M/b]]}function getPropertyRange(i,n){for(var a=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,m=0,z=i.length;m<z;m++){var u=getAtomProperty(i[m],n);u!=null&&(u<a&&(a=u),u>h&&(h=u))}return isFinite(a)||isFinite(h)?isFinite(a)?isFinite(h)||(h=a):a=h:a=h=0,[a,h]}class PausableTimer{constructor(n,a,h){this.total_time_run=0,this.fn=n,this.arg=h,this.countdown=a,this.start_time=new Date().getTime(),this.ident=setTimeout(n,a,h)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(i){for(var n=window.atob(i),a=n.length,h=new Uint8Array(a),m=0;m<a;m++)h[m]=n.charCodeAt(m);return h}function getAtomProperty(i,n){var a=null;return i.properties&&i.properties[n]!==void 0?a=i.properties[n]:i[n]!==void 0&&(a=i[n]),a}function mergeGeos(i,n){var a=n.geometry;a!==void 0&&i.geometryGroups.push(a.geometryGroups[0])}function specStringToObject(i){if(typeof i=="object"||i===void 0||i==null)return i;try{return JSON.parse(i)}catch{}var n=function(I){return isNumeric(I)?Math.floor(parseFloat(I))==parseInt(I)||I.indexOf(".")>=0?parseFloat(I):parseInt(I):I==="true"||I!=="false"&&I},a={};if((i=i.replace(/%7E/g,"~"))==="all")return a;for(var h=i.split(";"),m=0;m<h.length;m++){var z=h[m].split(":"),u=z[0],y={},p=z[1];if(p)if((p=p.replace(/~/g,"=")).indexOf("=")!==-1)for(var w=p.split(","),M=0;M<w.length;M++){var b=w[M].split("=",2);y[b[0]]=n(b[1])}else y=p.indexOf(",")!==-1?p.split(","):n(p);a[u]=y}return a}function checkStatus(i){if(!i.ok)throw new Error(`HTTP ${i.status} - ${i.statusText}`);return i}function get(i,n){var a=fetch(i).then(checkStatus).then(h=>h.text());return n?a.then(n):a}function getbin(i,n,a,h){var m;return m=a=="POST"?fetch(i,{method:"POST",body:h}).then(z=>checkStatus(z)).then(z=>z.arrayBuffer()):fetch(i).then(z=>checkStatus(z)).then(z=>z.arrayBuffer()),n?m.then(n):m}function download(i,n,a,h){var m="",z="",u="",y=null,p=n.addModel();if(i.indexOf(":")<0&&(i=i.length==4?"pdb:"+i:isNaN(i)?"url:"+i:"cid:"+i),i.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),i="bcif:"+i.slice(5)),i.substring(0,5)==="bcif:")i=i.substring(5).toUpperCase(),u="https://models.rcsb.org/"+i+".bcif.gz",a&&a.noComputeSecondaryStructure===void 0&&(a.noComputeSecondaryStructure=!0),y=new Promise(function(M){getbin(u).then(function(b){p.addMolData(b,"bcif.gz",a),n.zoomTo(),n.render(),M(p)},function(){console.error("fetch of "+u+" failed.")})});else{if(i.substring(0,4)==="pdb:"){if(m="bcif",a&&a.format&&(m=a.format),a&&a.noComputeSecondaryStructure===void 0&&(a.noComputeSecondaryStructure=!0),!(i=i.substring(4).toUpperCase()).match(/^[1-9][A-Za-z0-9]{3}$/))return void alert("Wrong PDB ID");m=="bcif"?u="https://models.rcsb.org/"+i.toUpperCase()+".bcif.gz":(z=a&&a.pdbUri?a.pdbUri:"https://files.rcsb.org/view/",u=z+i+"."+m)}else if(i.substring(0,4)=="cid:"){if(m="sdf",!(i=i.substring(4)).match(/^[0-9]+$/))return void alert("Wrong Compound ID");u="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+i+"/SDF?record_type=3d"}else i.substring(0,4)=="url:"&&(u=i.substring(4),m=u);var w=function(M){p.addMolData(M,m,a),n.zoomTo(),n.render()};y=new Promise(function(M){m=="bcif"?getbin(u).then(function(b){w(b),M(p)}).catch(function(){z=a&&a.pdbUri?a.pdbUri:"https://files.rcsb.org/view/",u=z+i+".pdb",m="pdb",console.warn("falling back to pdb format"),get(u).then(function(b){w(b),M(p)}).catch(function(b){w(""),M(p),console.error("fetch of "+u+" failed: "+b.statusText)})}):get(u).then(function(b){w(b),M(p)}).catch(function(b){w(""),M(p),console.error("fetch of "+u+" failed: "+b.statusText)})})}return h?(y.then(function(M){h(M)}),p):y}function getColorFromStyle(i,n){let a=n.colorscheme;if(_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[a]!==void 0)a=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[a];else if(typeof a=="string"&&a.endsWith("Carbon")){let z=a.substring(0,a.lastIndexOf("Carbon")).toLowerCase();if(_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[z]!==void 0){let u=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);u.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[z],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[a]={prop:"elem",map:u},a=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[a]}}let h=i.color;if(n.color!==void 0&&n.color!="spectrum"&&(h=n.color),a!==void 0){let z,u;if(_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[a]!==void 0)a=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[a],a[i[a.prop]]!==void 0&&(h=a.map[i[a.prop]]);else if(a[i[a.prop]]!==void 0)h=a.map[i[a.prop]];else if(a.prop!==void 0&&a.gradient!==void 0){z=a.prop;var m=a.gradient;m instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(m=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(a));let y=m.range()||[-1,1];u=getAtomProperty(i,z),u!=null&&(h=m.valueToHex(u,y))}else a.prop!==void 0&&a.map!==void 0?(z=a.prop,u=getAtomProperty(i,z),a.map[u]!==void 0&&(h=a.map[u])):n.colorscheme[i.elem]!==void 0?h=n.colorscheme[i.elem]:console.warn("Could not interpret colorscheme "+a)}else n.colorfunc!==void 0&&(h=n.colorfunc(i));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(h)}function getElement(i){let n=i;return typeof i=="string"?n=document.querySelector("#"+i):typeof i=="object"&&i.get&&(n=i.get(0)),n}function inflateString(i,n=!0){let a;return a=typeof i=="string"?new TextEncoder().encode(i):new Uint8Array(i),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(a,{to:n?"string":null})}},865:(i,n,a)=>{a.r(n),a.d(n,{CUBE:()=>u});var h=a(378),m=a(392);const z={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"};function u(y,p){p=p||{};const w=[[]];let M=y.split(/\r?\n/);const b=p.assignBonds===void 0||p.assignBonds;if(M.length<6)return w;let I=M[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const O=Math.abs(parseFloat(I[0]));let T={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const L=T.origin=new h.Vector3(parseFloat(I[1]),parseFloat(I[2]),parseFloat(I[3]));I=M[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),I=M[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const Q=I[0]>0?.529177:1;L.multiplyScalar(Q);const ne=Math.abs(I[0]),Z=new h.Vector3(parseFloat(I[1]),parseFloat(I[2]),parseFloat(I[3])).multiplyScalar(Q);I=M[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const _=Math.abs(I[0]),F=new h.Vector3(parseFloat(I[1]),parseFloat(I[2]),parseFloat(I[3])).multiplyScalar(Q);I=M[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const j=Math.abs(I[0]),G=new h.Vector3(parseFloat(I[1]),parseFloat(I[2]),parseFloat(I[3])).multiplyScalar(Q);if(T.size={x:ne,y:_,z:j},T.unit=new h.Vector3(Z.x,F.y,G.z),Z.y!=0||Z.z!=0||F.x!=0||F.z!=0||G.x!=0||G.y!=0){T.matrix4=new h.Matrix4(Z.x,F.x,G.x,0,Z.y,F.y,G.y,0,Z.z,F.z,G.z,0,0,0,0,1);let ge=new h.Matrix4().makeTranslation(L.x,L.y,L.z);T.matrix4=T.matrix4.multiplyMatrices(ge,T.matrix4),T.matrix=T.matrix4.matrix3FromTopLeft(),T.origin=new h.Vector3(0,0,0),T.unit=new h.Vector3(1,1,1)}w.modelData=[{cryst:T}],M=M.splice(6,O);for(var q=w[w.length-1].length,N=q+M.length,ee=q;ee<N;++ee){var Ce={};Ce.serial=ee;var he=M[ee-q].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");Ce.elem=z[he[0]],Ce.x=parseFloat(he[2])*Q,Ce.y=parseFloat(he[3])*Q,Ce.z=parseFloat(he[4])*Q,Ce.hetflag=!0,Ce.bonds=[],Ce.bondOrder=[],Ce.properties={},w[w.length-1].push(Ce)}if(b)for(let ge=0;ge<w.length;ge++)(0,m.assignBonds)(w[ge],p);return w}},972:(i,n,a)=>{var h=a(981),m=!0,z=!0;try{String.fromCharCode.apply(null,[0])}catch{m=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{z=!1}for(var u=new h.Buf8(256),y=0;y<256;y++)u[y]=y>=252?6:y>=248?5:y>=240?4:y>=224?3:y>=192?2:1;function p(w,M){if(M<65534&&(w.subarray&&z||!w.subarray&&m))return String.fromCharCode.apply(null,h.shrinkBuf(w,M));for(var b="",I=0;I<M;I++)b+=String.fromCharCode(w[I]);return b}u[254]=u[254]=1,n.string2buf=function(w){var M,b,I,O,T,L=w.length,Q=0;for(O=0;O<L;O++)(64512&(b=w.charCodeAt(O)))==55296&&O+1<L&&(64512&(I=w.charCodeAt(O+1)))==56320&&(b=65536+(b-55296<<10)+(I-56320),O++),Q+=b<128?1:b<2048?2:b<65536?3:4;for(M=new h.Buf8(Q),T=0,O=0;T<Q;O++)(64512&(b=w.charCodeAt(O)))==55296&&O+1<L&&(64512&(I=w.charCodeAt(O+1)))==56320&&(b=65536+(b-55296<<10)+(I-56320),O++),b<128?M[T++]=b:b<2048?(M[T++]=192|b>>>6,M[T++]=128|63&b):b<65536?(M[T++]=224|b>>>12,M[T++]=128|b>>>6&63,M[T++]=128|63&b):(M[T++]=240|b>>>18,M[T++]=128|b>>>12&63,M[T++]=128|b>>>6&63,M[T++]=128|63&b);return M},n.buf2binstring=function(w){return p(w,w.length)},n.binstring2buf=function(w){for(var M=new h.Buf8(w.length),b=0,I=M.length;b<I;b++)M[b]=w.charCodeAt(b);return M},n.buf2string=function(w,M){var b,I,O,T,L=M||w.length,Q=new Array(2*L);for(I=0,b=0;b<L;)if((O=w[b++])<128)Q[I++]=O;else if((T=u[O])>4)Q[I++]=65533,b+=T-1;else{for(O&=T===2?31:T===3?15:7;T>1&&b<L;)O=O<<6|63&w[b++],T--;T>1?Q[I++]=65533:O<65536?Q[I++]=O:(O-=65536,Q[I++]=55296|O>>10&1023,Q[I++]=56320|1023&O)}return p(Q,I)},n.utf8border=function(w,M){var b;for((M=M||w.length)>w.length&&(M=w.length),b=M-1;b>=0&&(192&w[b])==128;)b--;return b<0||b===0?M:b+u[w[b]]>M?b:M}},981:(i,n)=>{var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function h(u,y){return Object.prototype.hasOwnProperty.call(u,y)}n.assign=function(u){for(var y=Array.prototype.slice.call(arguments,1);y.length;){var p=y.shift();if(p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var w in p)h(p,w)&&(u[w]=p[w])}}return u},n.shrinkBuf=function(u,y){return u.length===y?u:u.subarray?u.subarray(0,y):(u.length=y,u)};var m={arraySet:function(u,y,p,w,M){if(y.subarray&&u.subarray)u.set(y.subarray(p,p+w),M);else for(var b=0;b<w;b++)u[M+b]=y[p+b]},flattenChunks:function(u){var y,p,w,M,b,I;for(w=0,y=0,p=u.length;y<p;y++)w+=u[y].length;for(I=new Uint8Array(w),M=0,y=0,p=u.length;y<p;y++)b=u[y],I.set(b,M),M+=b.length;return I}},z={arraySet:function(u,y,p,w,M){for(var b=0;b<w;b++)u[M+b]=y[p+b]},flattenChunks:function(u){return[].concat.apply([],u)}};n.setTyped=function(u){u?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,m)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,z))},n.setTyped(a)}},__webpack_module_cache__={};function __webpack_require__(i){var n=__webpack_module_cache__[i];if(n!==void 0)return n.exports;var a=__webpack_module_cache__[i]={exports:{}};return __webpack_modules__[i].call(a.exports,a,a.exports,__webpack_require__),a.exports}__webpack_require__.d=(i,n)=>{for(var a in n)__webpack_require__.o(n,a)&&!__webpack_require__.o(i,a)&&Object.defineProperty(i,a,{enumerable:!0,get:n[a]})},__webpack_require__.o=(i,n)=>Object.prototype.hasOwnProperty.call(i,n),__webpack_require__.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},__webpack_require__(16),__webpack_require__(185);var __webpack_exports__=__webpack_require__(307);return __webpack_exports__})(),module.exports=factory()})(_3DmolMin)),_3DmolMin.exports}require_3DmolMin();const covalentRadii={H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.61,Fe:1.52,Co:1.5,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,Pd:1.39,Ag:1.45,Cd:1.44,In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.75,Hf:1.87,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69},$3Dmol$1=window.$3Dmol;function mod(i,n){return(i%n+n)%n}function setCustomBondLengths(){function i(n,a){$3Dmol$1.setBondLength(n,a)}Object.keys(covalentRadii).forEach(n=>{i(n,1.05*covalentRadii[n])})}const Visualizer3dmol=reactExports.forwardRef(({viewerParams:i,cifText:n},a)=>{const h=reactExports.useRef(null),m=reactExports.useRef(null),z=reactExports.useRef("gldiv-"+(Math.random()+1).toString(36).substring(7));reactExports.useEffect(()=>{setCustomBondLengths()},[]);const u=()=>{if(m.current=h.current.addModel(),n){let w=$3Dmol$1.Parsers.CIF(n),M=w[0],b=w.modelData[0].cryst;m.current.setCrystData(b.a,b.b,b.c,b.alpha,b.beta,b.gamma);let I=m.current.modelData.cryst.matrix,O=new $3Dmol$1.Matrix3().getInverse3(I),T=[],L=[];M.forEach(Z=>{let _=new $3Dmol$1.Vector3(Z.x,Z.y,Z.z);if(i.packedCell){let F=_.clone().applyMatrix3(O);_=new $3Dmol$1.Vector3(mod(F.x,1),mod(F.y,1),mod(F.z,1)).applyMatrix3(I)}L.push({elem:Z.elem,x:_.x,y:_.y,z:_.z})});let Q=.03,ne=i.supercell;for(let Z=-1;Z<ne[0]+1;Z++)for(let _=-1;_<ne[1]+1;_++)for(let F=-1;F<ne[2]+1;F++){let j=new $3Dmol$1.Vector3(Z,_,F);if(j.applyMatrix3(I),Z==-1||Z==ne[0]||_==-1||_==ne[1]||F==-1||F==ne[2])if(i.packedCell)L.forEach(G=>{let q=new $3Dmol$1.Vector3(G.x,G.y,G.z);q.add(j);let N=q.clone().applyMatrix3(O);N.x>-Q&&N.x<ne[0]+Q&&N.y>-Q&&N.y<ne[1]+Q&&N.z>-Q&&N.z<ne[2]+Q&&T.push({elem:G.elem,x:q.x,y:q.y,z:q.z})});else continue;else L.forEach(G=>{T.push({elem:G.elem,x:G.x+j.x,y:G.y+j.y,z:G.z+j.z})})}m.current.addAtoms(T)}},y=()=>{h.current.removeAllModels(),u();let w={sphere:{scale:.3,colorscheme:"Jmol"}};i.vdwRadius&&(w.sphere.scale=1),i.bonds&&(w.stick={radius:.15,colorscheme:"Jmol"}),h.current.setStyle(w),h.current.addUnitCell(m.current),m.current.assignBonds(),h.current.removeAllLabels(),i.atomLabels&&m.current.atoms.forEach(M=>{h.current.addLabel(M.elem,{position:{x:M.x,y:M.y,z:M.z},fontColor:"black",bold:!0,fontSize:18,showBackground:!1,backgroundOpacity:1,inFront:!0},null,!0)}),h.current.zoomTo(),h.current.zoom(1.4),h.current.render()},p=(w,M)=>{w=="camera"&&(M=="x"&&h.current.setView([0,0,0,0,-.5,-.5,-.5,.5]),M=="y"&&h.current.setView([0,0,0,0,.5,.5,.5,.5]),M=="z"&&h.current.setView([0,0,0,0,0,0,0,1]),h.current.zoomTo(),h.current.zoom(1.4))};return reactExports.useImperativeHandle(a,()=>({handleEvent:p})),reactExports.useEffect(()=>{let w={backgroundColor:"white",orthographic:!0};h.current=$3Dmol$1.createViewer(z.current,w),y()},[]),reactExports.useEffect(()=>{h.current&&y()},[i,n]),jsxRuntimeExports.jsx("div",{id:z.current,className:"gldiv",children:"No data!"})});Visualizer3dmol.displayName="Visualizer3dmol";const StructureWindow=({mouseEnabled:i,setMouseEnabledState:n,visualizerRef:a,viewerParams:h,cifText:m})=>{let z="structure-window";i||(z+=" disable-mouse");let u="Click to interact",y="mouse-disabled-note";return i&&(y="mouse-disabled-note on"),jsxRuntimeExports.jsxs("div",{className:"structure-window-outer",children:[jsxRuntimeExports.jsx("div",{className:"structure-window-click-handler",onClick:()=>n(!0),children:jsxRuntimeExports.jsx("div",{className:z,children:jsxRuntimeExports.jsx(Visualizer3dmol,{ref:a,viewerParams:h,cifText:m})})}),jsxRuntimeExports.jsx("div",{className:y,onClick:()=>n(!i),children:u})]})},StructureVisualizer=i=>{const[n,a]=reactExports.useState({supercell:i.initSupercell||[2,2,2],bonds:!0,packedCell:!0,atomLabels:!1,vdwRadius:!1}),[h,m]=reactExports.useState(!1),z=reactExports.useRef(null),u=reactExports.useRef(null);reactExports.useEffect(()=>{const M=b=>{u&&!u.current.contains(b.target)&&m(!1)};return document.addEventListener("mousedown",M),()=>{document.removeEventListener("mousedown",M)}},[]);const y=M=>{m(M)},p=(M,b)=>{a(I=>({...I,[M]:b}))},w=(M,b)=>{z.current.handleEvent(M,b)};return jsxRuntimeExports.jsxs("div",{ref:u,className:"structure-visualizer",children:[jsxRuntimeExports.jsx(StructureWindow,{visualizerRef:z,viewerParams:n,cifText:i.cifText,mouseEnabled:h,setMouseEnabledState:y}),jsxRuntimeExports.jsx(ControlBox,{viewerParams:n,onViewerParamChange:p,onViewerEvent:w})]})};function DownloadIcon({size:i=14,className:n=""}){return jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[jsxRuntimeExports.jsx("path",{d:"M12 15V3"}),jsxRuntimeExports.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),jsxRuntimeExports.jsx("path",{d:"m7 10 5 5 5-5"})]})}function NextIcon({size:i=14,className:n=""}){return jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,hegiht:i,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:jsxRuntimeExports.jsx("path",{d:"m9 18 6-6-6-6"})})}function PreviousIcon({size:i=14,className:n=""}){return jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,hegiht:i,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:jsxRuntimeExports.jsx("path",{d:"m15 18-6-6 6-6"})})}function FirstIcon({size:i=14,className:n=""}){return jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,hegiht:i,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[jsxRuntimeExports.jsx("path",{d:"m17 18-6-6 6-6"}),jsxRuntimeExports.jsx("path",{d:"M7 6v12"})]})}function LastIcon({size:i=14,className:n=""}){return jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,hegiht:i,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[jsxRuntimeExports.jsx("path",{d:"m7 18 6-6-6-6"}),jsxRuntimeExports.jsx("path",{d:"M17 6v12"})]})}var ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array;function create$1(){var i=new ARRAY_TYPE(9);return ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function fromValues$1(i,n,a,h,m,z,u,y,p){var w=new ARRAY_TYPE(9);return w[0]=i,w[1]=n,w[2]=a,w[3]=h,w[4]=m,w[5]=z,w[6]=u,w[7]=y,w[8]=p,w}function invert(i,n){var a=n[0],h=n[1],m=n[2],z=n[3],u=n[4],y=n[5],p=n[6],w=n[7],M=n[8],b=M*u-y*w,I=-M*z+y*p,O=w*z-u*p,T=a*b+h*I+m*O;return T?(T=1/T,i[0]=b*T,i[1]=(-M*h+m*w)*T,i[2]=(y*h-m*u)*T,i[3]=I*T,i[4]=(M*a-m*p)*T,i[5]=(-y*a+m*z)*T,i[6]=O*T,i[7]=(-w*a+h*p)*T,i[8]=(u*a-h*z)*T,i):null}function create(){var i=new ARRAY_TYPE(3);return ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function length(i){var n=i[0],a=i[1],h=i[2];return Math.sqrt(n*n+a*a+h*h)}function fromValues(i,n,a){var h=new ARRAY_TYPE(3);return h[0]=i,h[1]=n,h[2]=a,h}function dot(i,n){return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]}function transformMat3(i,n,a){var h=n[0],m=n[1],z=n[2];return i[0]=h*a[0]+m*a[3]+z*a[6],i[1]=h*a[1]+m*a[4]+z*a[7],i[2]=h*a[2]+m*a[5]+z*a[8],i}(function(){var i=create();return function(n,a,h,m,z,u){var y,p;for(a||(a=3),h||(h=0),m?p=Math.min(m*a+h,n.length):p=n.length,y=h;y<p;y+=a)i[0]=n[y],i[1]=n[y+1],i[2]=n[y+2],z(i,i,u),n[y]=i[0],n[y+1]=i[1],n[y+2]=i[2];return n}})();function vecLength(i){return length(i)}function radToDeg$1(i){return i*180/Math.PI}function cartesianToFractional(i,n){const a=fromValues$1(n[0][0],n[1][0],n[2][0],n[0][1],n[1][1],n[2][1],n[0][2],n[1][2],n[2][2]),h=create$1();if(!invert(h,a))throw new Error("Singular lattice matrix");return i.map(m=>{const z=fromValues(m.x,m.y,m.z),u=create();return transformMat3(u,z,h),{element:m.element,x:u[0],y:u[1],z:u[2]}})}function latticeMatrixToCIFParams(i){const n=fromValues(...i[0]),a=fromValues(...i[1]),h=fromValues(...i[2]),m=vecLength(n),z=vecLength(a),u=vecLength(h),y=radToDeg$1(Math.acos(dot(a,h)/(z*u))),p=radToDeg$1(Math.acos(dot(n,h)/(m*u))),w=radToDeg$1(Math.acos(dot(n,a)/(m*z)));return{a:m,b:z,c:u,alpha:y,beta:p,gamma:w}}function generateCIFfromMatrix(i){const{lattice:n,sites:a}=i,h=cartesianToFractional(a,n),{a:m,b:z,c:u,alpha:y,beta:p,gamma:w}=latticeMatrixToCIFParams(n);let M=`data_generated_structure
_symmetry_space_group_name_H-M   'P 1'
_cell_length_a   ${m.toFixed(6)}
_cell_length_b   ${z.toFixed(6)}
_cell_length_c   ${u.toFixed(6)}
_cell_angle_alpha   ${y.toFixed(6)}
_cell_angle_beta    ${p.toFixed(6)}
_cell_angle_gamma   ${w.toFixed(6)}

loop_
_atom_site_label
_atom_site_type_symbol
_atom_site_fract_x
_atom_site_fract_y
_atom_site_fract_z
`;return h.forEach((b,I)=>{M+=`${b.element}${I+1} ${b.element} ${b.x.toFixed(6)} ${b.y.toFixed(6)} ${b.z.toFixed(6)}
`}),console.log("cif",M),M}function generateXYZ(i){const{lattice:n,sites:a}=i,h=a.length,m=n.flat().map(u=>u.toFixed(6)).join(" ");let z=`${h}
`;return z+=`Lattice="${m}" Properties=species:S:1:pos:R:3
`,a.forEach(u=>{z+=`${u.element} ${u.x.toFixed(6)} ${u.y.toFixed(6)} ${u.z.toFixed(6)}
`}),z}function generatePOSCAR(i){const{lattice:n,sites:a}=i,h=[...new Set(a.map(y=>y.element))],m=h.map(y=>a.filter(p=>p.element===y).length),z=n.map(y=>y.map(p=>p.toFixed(6)).join(" ")).join(`
`),u=h.flatMap(y=>a.filter(p=>p.element===y).map(p=>`${p.x.toFixed(6)} ${p.y.toFixed(6)} ${p.z.toFixed(6)}`));return["Generated structure from OPTIMADE CLIENT","1.0",z,h.join(" "),m.join(" "),"Cartesian",...u].join(`
`)}function generateXSF(i){const{lattice:n,sites:a}=i;let h=`CRYSTAL
PRIMVEC
`;return n.forEach(m=>{h+=m.map(z=>z.toFixed(6)).join(" ")+`
`}),h+=`PRIMCOORD
${a.length} 1
`,a.forEach(m=>{h+=`${m.element} ${m.x.toFixed(6)} ${m.y.toFixed(6)} ${m.z.toFixed(6)}
`}),h}const defaultFormats=[{format:"json",label:"JSON"},{format:"cif",label:"CIF"},{format:"xyz",label:"XYZ"},{format:"xsf",label:"XSF"},{format:"poscar",label:"VASP"}];function downloadFile(i,n){const a=new Blob([i],{type:"text/plain"}),h=URL.createObjectURL(a),m=document.createElement("a");m.href=h,m.download=n,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(h)}function StructureDownload({OptimadeStructure:i,download_formats:n}){const[a,h]=reactExports.useState(!1),m=reactExports.useRef(null),z=n||defaultFormats,u=i.attributes.lattice_vectors,y=i?.attributes?.cartesian_site_positions||[],p=i.attributes.species_at_sites,w=y.map((I,O)=>({element:p[O],x:I[0],y:I[1],z:I[2]})),M={lattice:u,sites:w},b=I=>{let O="",T="structure";I==="cif"?(O=generateCIFfromMatrix(M),T+=".cif"):I==="xyz"?(O=generateXYZ(M),T+=".xyz"):I==="poscar"?(O=generatePOSCAR(M),T+=".vasp"):I==="xsf"?(O=generateXSF(M),T+=".xsf"):I==="json"&&(O=JSON.stringify(i,null,2),T+=".json"),O&&downloadFile(O,T),h(!1)};return reactExports.useEffect(()=>{const I=O=>{m.current&&!m.current.contains(O.target)&&h(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]),jsxRuntimeExports.jsxs("div",{className:"relative inline-block",ref:m,children:[jsxRuntimeExports.jsx("div",{onClick:()=>h(I=>!I),className:"flex items-center gap-1 px-2 py-2 text-sm bg-blue-600 text-white rounded-sm hover:bg-blue-700 cursor-pointer",title:"Download",children:jsxRuntimeExports.jsx(DownloadIcon,{})}),a&&jsxRuntimeExports.jsx("div",{className:"absolute right-0 mt-1 bg-white rounded-sm shadow-sm ring-1 ring-slate-700 z-100",children:jsxRuntimeExports.jsx("ul",{className:"list-none p-0 m-0",children:z.map(({format:I,label:O})=>jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("button",{onClick:()=>b(I),className:"block w-full text-left px-3 py-1.5 text-sm text-slate-800 hover:bg-gray-100 hover:cursor-pointer",children:O})},I))})})]})}function StructureViewerWithDownload({OptimadeStructure:i,className:n=""}){const a=i.attributes.lattice_vectors,h=i?.attributes?.cartesian_site_positions||null,m=i.attributes.species_at_sites;let z=[];h&&(z=h.map((p,w)=>({element:m[w],x:p[0],y:p[1],z:p[2]})));const u={lattice:a,sites:z},y=reactExports.useMemo(()=>generateCIFfromMatrix(u),[u]);return h?jsxRuntimeExports.jsxs("div",{className:`relative rounded-lg w-full min-h-[450px] ${n}`,children:[jsxRuntimeExports.jsx("div",{className:"w-full h-[450px]",children:jsxRuntimeExports.jsx(StructureVisualizer,{cifText:y},y)}),jsxRuntimeExports.jsx("div",{className:"absolute top-2 right-2 z-10",children:jsxRuntimeExports.jsx(StructureDownload,{OptimadeStructure:i})})]}):jsxRuntimeExports.jsx("div",{className:`relative rounded-sm w-full px-20 min-h-[450px] ${n} flex items-center justify-center border-1 border-slate-500`,children:jsxRuntimeExports.jsx("div",{className:"text-red-500 text-center",children:"Malformed data found - skipping the crystal structure rendering."})})}function QEInputButton({cifText:i}){const n="https://qeinputgenerator.materialscloud.io",a=async()=>{if(!i){alert("No CIF data available");return}try{const h=new FormData;h.append("fileformat","cif-ase"),h.append("structurefile",new Blob([i],{type:"text/plain;charset=utf-8"}),"structure.cif");const m=await fetch(`${n}/compute/upload_structure/`,{method:"POST",body:h});if(!m.ok)throw new Error(`Upload failed: ${m.statusText}`);const z=await m.json();z.redirect?window.open(`${n}${z.redirect}`,"_blank"):alert("Unexpected response from server")}catch(h){console.error(h),alert("Failed to upload structure.")}};return jsxRuntimeExports.jsx("button",{onClick:a,disabled:!i,title:"Use the chosen structure in the QE Input Generator Tool",className:"px-2 py-1 md:px-4 md:py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:bg-gray-400 text-sm md:text-base",children:"Use in QE Input Generator"})}function ResultViewer({selectedResult:i}){const n=i?.attributes?.lattice_vectors??[],a=i?.attributes?.cartesian_site_positions??[],h=i?.attributes?.species_at_sites??[],m=a.map((y,p)=>({element:h[p],x:y[0],y:y[1],z:y[2]})),z=reactExports.useMemo(()=>({lattice:n,sites:m}),[n,m]),u=reactExports.useMemo(()=>generateCIFfromMatrix(z),[z]);return jsxRuntimeExports.jsxs("div",{className:"w-full mt-2 md:mt-4 flex flex-col",children:[i&&jsxRuntimeExports.jsxs("div",{className:"@container w-full flex flex-col md:flex-row gap-2 md:gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-full md:w-1/2",children:jsxRuntimeExports.jsx(StructureViewerWithDownload,{OptimadeStructure:i,cifText:u})}),jsxRuntimeExports.jsxs("div",{className:"w-full md:w-1/2 bg-slate-100 rounded shadow border p-2 min-h-48 md:h-[450px] h-[200px] overflow-auto text-xs",children:[jsxRuntimeExports.jsx("p",{className:"text-sm md:text-md pb-1 md:pb-2",children:"OPTIMADE JSON RESPONSE"}),jsxRuntimeExports.jsx(JsonView,{data:i,compactTopLevel:!0,shouldExpandNode:y=>y<2,style:{backgroundColor:""}})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-2 md:mt-4 flex justify-center",children:jsxRuntimeExports.jsx(QEInputButton,{cifText:u})})]})}function ResultsDropdown({results:i,resultsLoading:n,selectedResult:a,setSelectedResult:h}){return jsxRuntimeExports.jsxs("div",{className:"w-full mb-4 relative",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select a result"}),jsxRuntimeExports.jsx("select",{className:`${slateDropdown} w-full`,value:a?.id||"",onChange:m=>{const z=i?.data?.find(u=>u.id===m.target.value);z&&h(z)},disabled:n||!i?.data?.length,children:i?.data?.length?i.data.map(m=>jsxRuntimeExports.jsx("option",{value:m.id,children:`${m.attributes?.chemical_formula_descriptive||"Unknown"} (${m.id})`},m.id)):jsxRuntimeExports.jsx("option",{value:"",children:"No results for current query"})}),n&&jsxRuntimeExports.jsx("div",{className:"absolute right-5 top-1/2 bg-white bg-opacity-50 pointer-events-none",children:jsxRuntimeExports.jsx("div",{className:"w-5 h-5 border-2 border-t-2 border-gray-400 border-t-blue-500 rounded-full animate-spin"})})]})}function ProviderInfo({queryUrl:i}){const[n,a]=reactExports.useState(null),[h,m]=reactExports.useState([]),[z,u]=reactExports.useState(!1);return reactExports.useEffect(()=>{if(!i)return;u(!0),a(null),m([]);async function y(){try{const{customProps:p,error:w}=await getInfo({providerUrl:i});w&&m([w]),p&&a(p),console.log("cP",p)}catch(p){m([p])}finally{u(!1)}}y()},[i]),i?jsxRuntimeExports.jsxs("div",{className:"w-full mt-4",children:[z&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center p-4 w-full bg-slate-50 border rounded",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 border-2 border-t-2 border-gray-400 border-t-blue-500 rounded-full animate-spin mr-2"}),jsxRuntimeExports.jsx("span",{className:"text-gray-500",children:"Loading provider info"})]}),h.length>0&&!z&&jsxRuntimeExports.jsxs("div",{className:"bg-red-100 border border-red-500 text-red-700 px-4 py-2 rounded mb-4 w-full",children:[jsxRuntimeExports.jsx("strong",{children:"Failed to fetch provider info:"}),jsxRuntimeExports.jsx("ul",{className:"list-disc pl-5",children:h.map((y,p)=>jsxRuntimeExports.jsx("li",{children:y.message},p))})]}),n&&!z&&jsxRuntimeExports.jsxs("div",{className:"w-full py-2 px-4 border rounded bg-slate-50 max-h-72 overflow-auto",children:[jsxRuntimeExports.jsx("h4",{className:"text-center font-semibold mb-2 text-xs sm:text-sm md:text-base",children:"Custom attributes in selected database"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-[8fr_17fr_2fr] gap-y-0.5 gap-x-2",children:[jsxRuntimeExports.jsx("div",{className:"font-semibold truncate text-[9px] sm:text-[11px] md:text-[13px]",children:"Field"}),jsxRuntimeExports.jsx("div",{className:"font-semibold text-[9px] sm:text-[11px] md:text-[13px]",children:"Description"}),jsxRuntimeExports.jsx("div",{className:"font-semibold truncate text-[9px] sm:text-[11px] md:text-[13px]",children:"Unit"}),Object.entries(n).map(([y,p])=>jsxRuntimeExports.jsxs(React.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"break-words text-[9px] sm:text-[11px] md:text-[13px]",children:y}),jsxRuntimeExports.jsx("div",{className:"break-words text-[9px] sm:text-[11px] md:text-[13px]",children:p.description||"-"}),jsxRuntimeExports.jsx("div",{className:"break-words text-[9px] sm:text-[11px] md:text-[13px]",children:p.unit||"-"})]},y))]})]})]}):null}function PaginationHandler({currentPage:i,totalPages:n,resultsLoading:a,metaData:h,onPageChange:m}){if(!n||n<1)return null;const z="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 hover:cursor-pointer disabled:opacity-50 disabled:cursor-default";return jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-1 mt-4",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-700 text-sm text-center w-full md:w-auto",children:`Filtered results: ${h.data_returned} of ${h.data_available} | Page ${i} of ${n}`}),jsxRuntimeExports.jsx("button",{onClick:()=>m(1),disabled:i===1||a,className:z,children:jsxRuntimeExports.jsx(FirstIcon,{})}),jsxRuntimeExports.jsx("button",{onClick:()=>m(i-1),disabled:i===1||a,className:z,children:jsxRuntimeExports.jsx(PreviousIcon,{})}),jsxRuntimeExports.jsx("button",{onClick:()=>m(i+1),disabled:i===n||a,className:z,children:jsxRuntimeExports.jsx(NextIcon,{})}),jsxRuntimeExports.jsx("button",{onClick:()=>m(n),disabled:i===n||a,className:z,children:jsxRuntimeExports.jsx(LastIcon,{})})]})}const LayoutGroupContext=reactExports.createContext({});function useConstant(i){const n=reactExports.useRef(null);return n.current===null&&(n.current=i()),n.current}const isBrowser=typeof window<"u",useIsomorphicLayoutEffect=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,PresenceContext=reactExports.createContext(null);function addUniqueItem(i,n){i.indexOf(n)===-1&&i.push(n)}function removeItem(i,n){const a=i.indexOf(n);a>-1&&i.splice(a,1)}const clamp=(i,n,a)=>a>n?n:a<i?i:a;let invariant=()=>{};const MotionGlobalConfig={},isNumericalString=i=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(i);function isObject(i){return typeof i=="object"&&i!==null}const isZeroValueString=i=>/^0[^.\s]+$/u.test(i);function memo(i){let n;return()=>(n===void 0&&(n=i()),n)}const noop=i=>i,combineFunctions=(i,n)=>a=>n(i(a)),pipe=(...i)=>i.reduce(combineFunctions),progress=(i,n,a)=>{const h=n-i;return h===0?1:(a-i)/h};class SubscriptionManager{constructor(){this.subscriptions=[]}add(n){return addUniqueItem(this.subscriptions,n),()=>removeItem(this.subscriptions,n)}notify(n,a,h){const m=this.subscriptions.length;if(m)if(m===1)this.subscriptions[0](n,a,h);else for(let z=0;z<m;z++){const u=this.subscriptions[z];u&&u(n,a,h)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const secondsToMilliseconds=i=>i*1e3,millisecondsToSeconds=i=>i/1e3;function velocityPerSecond(i,n){return n?i*(1e3/n):0}const calcBezier=(i,n,a)=>(((1-3*a+3*n)*i+(3*a-6*n))*i+3*n)*i,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(i,n,a,h,m){let z,u,y=0;do u=n+(a-n)/2,z=calcBezier(u,h,m)-i,z>0?a=u:n=u;while(Math.abs(z)>subdivisionPrecision&&++y<subdivisionMaxIterations);return u}function cubicBezier(i,n,a,h){if(i===n&&a===h)return noop;const m=z=>binarySubdivide(z,0,1,i,a);return z=>z===0||z===1?z:calcBezier(m(z),n,h)}const mirrorEasing=i=>n=>n<=.5?i(2*n)/2:(2-i(2*(1-n)))/2,reverseEasing=i=>n=>1-i(1-n),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=i=>(i*=2)<1?.5*backIn(i):.5*(2-Math.pow(2,-10*(i-1))),circIn=i=>1-Math.sin(Math.acos(i)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=i=>Array.isArray(i)&&typeof i[0]!="number",isBezierDefinition=i=>Array.isArray(i)&&typeof i[0]=="number",easingLookup={linear:noop,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},isValidEasing=i=>typeof i=="string",easingDefinitionToFunction=i=>{if(isBezierDefinition(i)){invariant(i.length===4);const[n,a,h,m]=i;return cubicBezier(n,a,h,m)}else if(isValidEasing(i))return easingLookup[i];return i},stepsOrder=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function createRenderStep(i,n){let a=new Set,h=new Set,m=!1,z=!1;const u=new WeakSet;let y={delta:0,timestamp:0,isProcessing:!1};function p(M){u.has(M)&&(w.schedule(M),i()),M(y)}const w={schedule:(M,b=!1,I=!1)=>{const T=I&&m?a:h;return b&&u.add(M),T.has(M)||T.add(M),M},cancel:M=>{h.delete(M),u.delete(M)},process:M=>{if(y=M,m){z=!0;return}m=!0,[a,h]=[h,a],a.forEach(p),a.clear(),m=!1,z&&(z=!1,w.process(M))}};return w}const maxElapsed=40;function createRenderBatcher(i,n){let a=!1,h=!0;const m={delta:0,timestamp:0,isProcessing:!1},z=()=>a=!0,u=stepsOrder.reduce((_,F)=>(_[F]=createRenderStep(z),_),{}),{setup:y,read:p,resolveKeyframes:w,preUpdate:M,update:b,preRender:I,render:O,postRender:T}=u,L=()=>{const _=MotionGlobalConfig.useManualTiming?m.timestamp:performance.now();a=!1,MotionGlobalConfig.useManualTiming||(m.delta=h?1e3/60:Math.max(Math.min(_-m.timestamp,maxElapsed),1)),m.timestamp=_,m.isProcessing=!0,y.process(m),p.process(m),w.process(m),M.process(m),b.process(m),I.process(m),O.process(m),T.process(m),m.isProcessing=!1,a&&n&&(h=!1,i(L))},Q=()=>{a=!0,h=!0,m.isProcessing||i(L)};return{schedule:stepsOrder.reduce((_,F)=>{const j=u[F];return _[F]=(G,q=!1,N=!1)=>(a||Q(),j.schedule(G,q,N)),_},{}),cancel:_=>{for(let F=0;F<stepsOrder.length;F++)u[stepsOrder[F]].cancel(_)},state:m,steps:u}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop,!0);let now;function clearTime(){now=void 0}const time={now:()=>(now===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now),set:i=>{now=i,queueMicrotask(clearTime)}},checkStringStartsWith=i=>n=>typeof n=="string"&&n.startsWith(i),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=i=>startsAsVariableToken(i)?singleCssVariableRegex.test(i.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,number={test:i=>typeof i=="number",parse:parseFloat,transform:i=>i},alpha={...number,transform:i=>clamp(0,1,i)},scale={...number,default:1},sanitize=i=>Math.round(i*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(i){return i==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(i,n)=>a=>!!(typeof a=="string"&&singleColorRegex.test(a)&&a.startsWith(i)||n&&!isNullish(a)&&Object.prototype.hasOwnProperty.call(a,n)),splitColor=(i,n,a)=>h=>{if(typeof h!="string")return h;const[m,z,u,y]=h.match(floatRegex);return{[i]:parseFloat(m),[n]:parseFloat(z),[a]:parseFloat(u),alpha:y!==void 0?parseFloat(y):1}},clampRgbUnit=i=>clamp(0,255,i),rgbUnit={...number,transform:i=>Math.round(clampRgbUnit(i))},rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:i,green:n,blue:a,alpha:h=1})=>"rgba("+rgbUnit.transform(i)+", "+rgbUnit.transform(n)+", "+rgbUnit.transform(a)+", "+sanitize(alpha.transform(h))+")"};function parseHex(i){let n="",a="",h="",m="";return i.length>5?(n=i.substring(1,3),a=i.substring(3,5),h=i.substring(5,7),m=i.substring(7,9)):(n=i.substring(1,2),a=i.substring(2,3),h=i.substring(3,4),m=i.substring(4,5),n+=n,a+=a,h+=h,m+=m),{red:parseInt(n,16),green:parseInt(a,16),blue:parseInt(h,16),alpha:m?parseInt(m,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},createUnitType=i=>({test:n=>typeof n=="string"&&n.endsWith(i)&&n.split(" ").length===1,parse:parseFloat,transform:n=>`${n}${i}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:i=>percent.parse(i)/100,transform:i=>percent.transform(i*100)},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:i,saturation:n,lightness:a,alpha:h=1})=>"hsla("+Math.round(i)+", "+percent.transform(sanitize(n))+", "+percent.transform(sanitize(a))+", "+sanitize(alpha.transform(h))+")"},color={test:i=>rgba.test(i)||hex.test(i)||hsla.test(i),parse:i=>rgba.test(i)?rgba.parse(i):hsla.test(i)?hsla.parse(i):hex.parse(i),transform:i=>typeof i=="string"?i:i.hasOwnProperty("red")?rgba.transform(i):hsla.transform(i),getAnimatableNone:i=>{const n=color.parse(i);return n.alpha=0,color.transform(n)}},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(i){return isNaN(i)&&typeof i=="string"&&(i.match(floatRegex)?.length||0)+(i.match(colorRegex)?.length||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(i){const n=i.toString(),a=[],h={color:[],number:[],var:[]},m=[];let z=0;const y=n.replace(complexRegex,p=>(color.test(p)?(h.color.push(z),m.push(COLOR_TOKEN),a.push(color.parse(p))):p.startsWith(VAR_FUNCTION_TOKEN)?(h.var.push(z),m.push(VAR_TOKEN),a.push(p)):(h.number.push(z),m.push(NUMBER_TOKEN),a.push(parseFloat(p))),++z,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:a,split:y,indexes:h,types:m}}function parseComplexValue(i){return analyseComplexValue(i).values}function createTransformer(i){const{split:n,types:a}=analyseComplexValue(i),h=n.length;return m=>{let z="";for(let u=0;u<h;u++)if(z+=n[u],m[u]!==void 0){const y=a[u];y===NUMBER_TOKEN?z+=sanitize(m[u]):y===COLOR_TOKEN?z+=color.transform(m[u]):z+=m[u]}return z}}const convertNumbersToZero=i=>typeof i=="number"?0:color.test(i)?color.getAnimatableNone(i):i;function getAnimatableNone$1(i){const n=parseComplexValue(i);return createTransformer(i)(n.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1};function hueToRgb(i,n,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?i+(n-i)*6*a:a<1/2?n:a<2/3?i+(n-i)*(2/3-a)*6:i}function hslaToRgba({hue:i,saturation:n,lightness:a,alpha:h}){i/=360,n/=100,a/=100;let m=0,z=0,u=0;if(!n)m=z=u=a;else{const y=a<.5?a*(1+n):a+n-a*n,p=2*a-y;m=hueToRgb(p,y,i+1/3),z=hueToRgb(p,y,i),u=hueToRgb(p,y,i-1/3)}return{red:Math.round(m*255),green:Math.round(z*255),blue:Math.round(u*255),alpha:h}}function mixImmediate(i,n){return a=>a>0?n:i}const mixNumber$1=(i,n,a)=>i+(n-i)*a,mixLinearColor=(i,n,a)=>{const h=i*i,m=a*(n*n-h)+h;return m<0?0:Math.sqrt(m)},colorTypes=[hex,rgba,hsla],getColorType=i=>colorTypes.find(n=>n.test(i));function asRGBA(i){const n=getColorType(i);if(!n)return!1;let a=n.parse(i);return n===hsla&&(a=hslaToRgba(a)),a}const mixColor=(i,n)=>{const a=asRGBA(i),h=asRGBA(n);if(!a||!h)return mixImmediate(i,n);const m={...a};return z=>(m.red=mixLinearColor(a.red,h.red,z),m.green=mixLinearColor(a.green,h.green,z),m.blue=mixLinearColor(a.blue,h.blue,z),m.alpha=mixNumber$1(a.alpha,h.alpha,z),rgba.transform(m))},invisibleValues=new Set(["none","hidden"]);function mixVisibility(i,n){return invisibleValues.has(i)?a=>a<=0?i:n:a=>a>=1?n:i}function mixNumber(i,n){return a=>mixNumber$1(i,n,a)}function getMixer(i){return typeof i=="number"?mixNumber:typeof i=="string"?isCSSVariableToken(i)?mixImmediate:color.test(i)?mixColor:mixComplex:Array.isArray(i)?mixArray:typeof i=="object"?color.test(i)?mixColor:mixObject:mixImmediate}function mixArray(i,n){const a=[...i],h=a.length,m=i.map((z,u)=>getMixer(z)(z,n[u]));return z=>{for(let u=0;u<h;u++)a[u]=m[u](z);return a}}function mixObject(i,n){const a={...i,...n},h={};for(const m in a)i[m]!==void 0&&n[m]!==void 0&&(h[m]=getMixer(i[m])(i[m],n[m]));return m=>{for(const z in h)a[z]=h[z](m);return a}}function matchOrder(i,n){const a=[],h={color:0,var:0,number:0};for(let m=0;m<n.values.length;m++){const z=n.types[m],u=i.indexes[z][h[z]],y=i.values[u]??0;a[m]=y,h[z]++}return a}const mixComplex=(i,n)=>{const a=complex.createTransformer(n),h=analyseComplexValue(i),m=analyseComplexValue(n);return h.indexes.var.length===m.indexes.var.length&&h.indexes.color.length===m.indexes.color.length&&h.indexes.number.length>=m.indexes.number.length?invisibleValues.has(i)&&!m.values.length||invisibleValues.has(n)&&!h.values.length?mixVisibility(i,n):pipe(mixArray(matchOrder(h,m),m.values),a):mixImmediate(i,n)};function mix(i,n,a){return typeof i=="number"&&typeof n=="number"&&typeof a=="number"?mixNumber$1(i,n,a):getMixer(i)(i,n)}const frameloopDriver=i=>{const n=({timestamp:a})=>i(a);return{start:(a=!0)=>frame.update(n,a),stop:()=>cancelFrame(n),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generateLinearEasing=(i,n,a=10)=>{let h="";const m=Math.max(Math.round(n/a),2);for(let z=0;z<m;z++)h+=Math.round(i(z/(m-1))*1e4)/1e4+", ";return`linear(${h.substring(0,h.length-2)})`},maxGeneratorDuration=2e4;function calcGeneratorDuration(i){let n=0;const a=50;let h=i.next(n);for(;!h.done&&n<maxGeneratorDuration;)n+=a,h=i.next(n);return n>=maxGeneratorDuration?1/0:n}function createGeneratorEasing(i,n=100,a){const h=a({...i,keyframes:[0,n]}),m=Math.min(calcGeneratorDuration(h),maxGeneratorDuration);return{type:"keyframes",ease:z=>h.next(m*z).value/n,duration:millisecondsToSeconds(m)}}const velocitySampleDuration=5;function calcGeneratorVelocity(i,n,a){const h=Math.max(n-velocitySampleDuration,0);return velocityPerSecond(a-i(h),n-h)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:i=springDefaults.duration,bounce:n=springDefaults.bounce,velocity:a=springDefaults.velocity,mass:h=springDefaults.mass}){let m,z,u=1-n;u=clamp(springDefaults.minDamping,springDefaults.maxDamping,u),i=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(i)),u<1?(m=w=>{const M=w*u,b=M*i,I=M-a,O=calcAngularFreq(w,u),T=Math.exp(-b);return safeMin-I/O*T},z=w=>{const b=w*u*i,I=b*a+a,O=Math.pow(u,2)*Math.pow(w,2)*i,T=Math.exp(-b),L=calcAngularFreq(Math.pow(w,2),u);return(-m(w)+safeMin>0?-1:1)*((I-O)*T)/L}):(m=w=>{const M=Math.exp(-w*i),b=(w-a)*i+1;return-safeMin+M*b},z=w=>{const M=Math.exp(-w*i),b=(a-w)*(i*i);return M*b});const y=5/i,p=approximateRoot(m,z,y);if(i=secondsToMilliseconds(i),isNaN(p))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:i};{const w=Math.pow(p,2)*h;return{stiffness:w,damping:u*2*Math.sqrt(h*w),duration:i}}}const rootIterations=12;function approximateRoot(i,n,a){let h=a;for(let m=1;m<rootIterations;m++)h=h-i(h)/n(h);return h}function calcAngularFreq(i,n){return i*Math.sqrt(1-n*n)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(i,n){return n.some(a=>i[a]!==void 0)}function getSpringOptions(i){let n={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...i};if(!isSpringType(i,physicsKeys)&&isSpringType(i,durationKeys))if(i.visualDuration){const a=i.visualDuration,h=2*Math.PI/(a*1.2),m=h*h,z=2*clamp(.05,1,1-(i.bounce||0))*Math.sqrt(m);n={...n,mass:springDefaults.mass,stiffness:m,damping:z}}else{const a=findSpring(i);n={...n,...a,mass:springDefaults.mass},n.isResolvedFromDuration=!0}return n}function spring(i=springDefaults.visualDuration,n=springDefaults.bounce){const a=typeof i!="object"?{visualDuration:i,keyframes:[0,1],bounce:n}:i;let{restSpeed:h,restDelta:m}=a;const z=a.keyframes[0],u=a.keyframes[a.keyframes.length-1],y={done:!1,value:z},{stiffness:p,damping:w,mass:M,duration:b,velocity:I,isResolvedFromDuration:O}=getSpringOptions({...a,velocity:-millisecondsToSeconds(a.velocity||0)}),T=I||0,L=w/(2*Math.sqrt(p*M)),Q=u-z,ne=millisecondsToSeconds(Math.sqrt(p/M)),Z=Math.abs(Q)<5;h||(h=Z?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),m||(m=Z?springDefaults.restDelta.granular:springDefaults.restDelta.default);let _;if(L<1){const j=calcAngularFreq(ne,L);_=G=>{const q=Math.exp(-L*ne*G);return u-q*((T+L*ne*Q)/j*Math.sin(j*G)+Q*Math.cos(j*G))}}else if(L===1)_=j=>u-Math.exp(-ne*j)*(Q+(T+ne*Q)*j);else{const j=ne*Math.sqrt(L*L-1);_=G=>{const q=Math.exp(-L*ne*G),N=Math.min(j*G,300);return u-q*((T+L*ne*Q)*Math.sinh(N)+j*Q*Math.cosh(N))/j}}const F={calculatedDuration:O&&b||null,next:j=>{const G=_(j);if(O)y.done=j>=b;else{let q=j===0?T:0;L<1&&(q=j===0?secondsToMilliseconds(T):calcGeneratorVelocity(_,j,G));const N=Math.abs(q)<=h,ee=Math.abs(u-G)<=m;y.done=N&&ee}return y.value=y.done?u:G,y},toString:()=>{const j=Math.min(calcGeneratorDuration(F),maxGeneratorDuration),G=generateLinearEasing(q=>F.next(j*q).value,j,30);return j+"ms "+G},toTransition:()=>{}};return F}spring.applyToOptions=i=>{const n=createGeneratorEasing(i,100,spring);return i.ease=n.ease,i.duration=secondsToMilliseconds(n.duration),i.type="keyframes",i};function inertia({keyframes:i,velocity:n=0,power:a=.8,timeConstant:h=325,bounceDamping:m=10,bounceStiffness:z=500,modifyTarget:u,min:y,max:p,restDelta:w=.5,restSpeed:M}){const b=i[0],I={done:!1,value:b},O=N=>y!==void 0&&N<y||p!==void 0&&N>p,T=N=>y===void 0?p:p===void 0||Math.abs(y-N)<Math.abs(p-N)?y:p;let L=a*n;const Q=b+L,ne=u===void 0?Q:u(Q);ne!==Q&&(L=ne-b);const Z=N=>-L*Math.exp(-N/h),_=N=>ne+Z(N),F=N=>{const ee=Z(N),Ce=_(N);I.done=Math.abs(ee)<=w,I.value=I.done?ne:Ce};let j,G;const q=N=>{O(I.value)&&(j=N,G=spring({keyframes:[I.value,T(I.value)],velocity:calcGeneratorVelocity(_,N,I.value),damping:m,stiffness:z,restDelta:w,restSpeed:M}))};return q(0),{calculatedDuration:null,next:N=>{let ee=!1;return!G&&j===void 0&&(ee=!0,F(N),q(N)),j!==void 0&&N>=j?G.next(N-j):(!ee&&F(N),I)}}}function createMixers(i,n,a){const h=[],m=a||MotionGlobalConfig.mix||mix,z=i.length-1;for(let u=0;u<z;u++){let y=m(i[u],i[u+1]);if(n){const p=Array.isArray(n)?n[u]||noop:n;y=pipe(p,y)}h.push(y)}return h}function interpolate(i,n,{clamp:a=!0,ease:h,mixer:m}={}){const z=i.length;if(invariant(z===n.length),z===1)return()=>n[0];if(z===2&&n[0]===n[1])return()=>n[1];const u=i[0]===i[1];i[0]>i[z-1]&&(i=[...i].reverse(),n=[...n].reverse());const y=createMixers(n,h,m),p=y.length,w=M=>{if(u&&M<i[0])return n[0];let b=0;if(p>1)for(;b<i.length-2&&!(M<i[b+1]);b++);const I=progress(i[b],i[b+1],M);return y[b](I)};return a?M=>w(clamp(i[0],i[z-1],M)):w}function fillOffset(i,n){const a=i[i.length-1];for(let h=1;h<=n;h++){const m=progress(0,n,h);i.push(mixNumber$1(a,1,m))}}function defaultOffset(i){const n=[0];return fillOffset(n,i.length-1),n}function convertOffsetToTimes(i,n){return i.map(a=>a*n)}function defaultEasing(i,n){return i.map(()=>n||easeInOut).splice(0,i.length-1)}function keyframes({duration:i=300,keyframes:n,times:a,ease:h="easeInOut"}){const m=isEasingArray(h)?h.map(easingDefinitionToFunction):easingDefinitionToFunction(h),z={done:!1,value:n[0]},u=convertOffsetToTimes(a&&a.length===n.length?a:defaultOffset(n),i),y=interpolate(u,n,{ease:Array.isArray(m)?m:defaultEasing(n,m)});return{calculatedDuration:i,next:p=>(z.value=y(p),z.done=p>=i,z)}}const isNotNull$1=i=>i!==null;function getFinalKeyframe$1(i,{repeat:n,repeatType:a="loop"},h,m=1){const z=i.filter(isNotNull$1),y=m<0||n&&a!=="loop"&&n%2===1?0:z.length-1;return!y||h===void 0?z[y]:h}const transitionTypeMap={decay:inertia,inertia,tween:keyframes,keyframes,spring};function replaceTransitionType(i){typeof i.type=="string"&&(i.type=transitionTypeMap[i.type])}class WithPromise{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(n=>{this.resolve=n})}notifyFinished(){this.resolve()}then(n,a){return this.finished.then(n,a)}}const percentToProgress=i=>i/100;class JSAnimation extends WithPromise{constructor(n){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:a}=this.options;a&&a.updatedAt!==time.now()&&this.tick(time.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=n,this.initAnimation(),this.play(),n.autoplay===!1&&this.pause()}initAnimation(){const{options:n}=this;replaceTransitionType(n);const{type:a=keyframes,repeat:h=0,repeatDelay:m=0,repeatType:z,velocity:u=0}=n;let{keyframes:y}=n;const p=a||keyframes;p!==keyframes&&typeof y[0]!="number"&&(this.mixKeyframes=pipe(percentToProgress,mix(y[0],y[1])),y=[0,100]);const w=p({...n,keyframes:y});z==="mirror"&&(this.mirroredGenerator=p({...n,keyframes:[...y].reverse(),velocity:-u})),w.calculatedDuration===null&&(w.calculatedDuration=calcGeneratorDuration(w));const{calculatedDuration:M}=w;this.calculatedDuration=M,this.resolvedDuration=M+m,this.totalDuration=this.resolvedDuration*(h+1)-m,this.generator=w}updateTime(n){const a=Math.round(n-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=a}tick(n,a=!1){const{generator:h,totalDuration:m,mixKeyframes:z,mirroredGenerator:u,resolvedDuration:y,calculatedDuration:p}=this;if(this.startTime===null)return h.next(0);const{delay:w=0,keyframes:M,repeat:b,repeatType:I,repeatDelay:O,type:T,onUpdate:L,finalKeyframe:Q}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,n):this.speed<0&&(this.startTime=Math.min(n-m/this.speed,this.startTime)),a?this.currentTime=n:this.updateTime(n);const ne=this.currentTime-w*(this.playbackSpeed>=0?1:-1),Z=this.playbackSpeed>=0?ne<0:ne>m;this.currentTime=Math.max(ne,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=m);let _=this.currentTime,F=h;if(b){const N=Math.min(this.currentTime,m)/y;let ee=Math.floor(N),Ce=N%1;!Ce&&N>=1&&(Ce=1),Ce===1&&ee--,ee=Math.min(ee,b+1),!!(ee%2)&&(I==="reverse"?(Ce=1-Ce,O&&(Ce-=O/y)):I==="mirror"&&(F=u)),_=clamp(0,1,Ce)*y}const j=Z?{done:!1,value:M[0]}:F.next(_);z&&(j.value=z(j.value));let{done:G}=j;!Z&&p!==null&&(G=this.playbackSpeed>=0?this.currentTime>=m:this.currentTime<=0);const q=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&G);return q&&T!==inertia&&(j.value=getFinalKeyframe$1(M,this.options,Q,this.speed)),L&&L(j.value),q&&this.finish(),j}then(n,a){return this.finished.then(n,a)}get duration(){return millisecondsToSeconds(this.calculatedDuration)}get iterationDuration(){const{delay:n=0}=this.options||{};return this.duration+millisecondsToSeconds(n)}get time(){return millisecondsToSeconds(this.currentTime)}set time(n){n=secondsToMilliseconds(n),this.currentTime=n,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=n:this.driver&&(this.startTime=this.driver.now()-n/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(n){this.updateTime(time.now());const a=this.playbackSpeed!==n;this.playbackSpeed=n,a&&(this.time=millisecondsToSeconds(this.currentTime))}play(){if(this.isStopped)return;const{driver:n=frameloopDriver,startTime:a}=this.options;this.driver||(this.driver=n(m=>this.tick(m))),this.options.onPlay?.();const h=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=h):this.holdTime!==null?this.startTime=h-this.holdTime:this.startTime||(this.startTime=a??h),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(time.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(n){return this.startTime=0,this.tick(n,!0)}attachTimeline(n){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),n.observe(this)}}function fillWildcards(i){for(let n=1;n<i.length;n++)i[n]??(i[n]=i[n-1])}const radToDeg=i=>i*180/Math.PI,rotate=i=>{const n=radToDeg(Math.atan2(i[1],i[0]));return rebaseAngle(n)},matrix2dParsers={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:i=>(Math.abs(i[0])+Math.abs(i[3]))/2,rotate,rotateZ:rotate,skewX:i=>radToDeg(Math.atan(i[1])),skewY:i=>radToDeg(Math.atan(i[2])),skew:i=>(Math.abs(i[1])+Math.abs(i[2]))/2},rebaseAngle=i=>(i=i%360,i<0&&(i+=360),i),rotateZ=rotate,scaleX=i=>Math.sqrt(i[0]*i[0]+i[1]*i[1]),scaleY=i=>Math.sqrt(i[4]*i[4]+i[5]*i[5]),matrix3dParsers={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX,scaleY,scale:i=>(scaleX(i)+scaleY(i))/2,rotateX:i=>rebaseAngle(radToDeg(Math.atan2(i[6],i[5]))),rotateY:i=>rebaseAngle(radToDeg(Math.atan2(-i[2],i[0]))),rotateZ,rotate:rotateZ,skewX:i=>radToDeg(Math.atan(i[4])),skewY:i=>radToDeg(Math.atan(i[1])),skew:i=>(Math.abs(i[1])+Math.abs(i[4]))/2};function defaultTransformValue(i){return i.includes("scale")?1:0}function parseValueFromTransform(i,n){if(!i||i==="none")return defaultTransformValue(n);const a=i.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let h,m;if(a)h=matrix3dParsers,m=a;else{const y=i.match(/^matrix\(([-\d.e\s,]+)\)$/u);h=matrix2dParsers,m=y}if(!m)return defaultTransformValue(n);const z=h[n],u=m[1].split(",").map(convertTransformToNumber);return typeof z=="function"?z(u):u[z]}const readTransformValue=(i,n)=>{const{transform:a="none"}=getComputedStyle(i);return parseValueFromTransform(a,n)};function convertTransformToNumber(i){return parseFloat(i.trim())}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),isNumOrPxType=i=>i===number||i===px,transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(i=>!transformKeys.has(i));function removeNonTranslationalTransform(i){const n=[];return nonTranslationalTransformKeys.forEach(a=>{const h=i.getValue(a);h!==void 0&&(n.push([a,h.get()]),h.set(a.startsWith("scale")?1:0))}),n}const positionalValues={width:({x:i},{paddingLeft:n="0",paddingRight:a="0"})=>i.max-i.min-parseFloat(n)-parseFloat(a),height:({y:i},{paddingTop:n="0",paddingBottom:a="0"})=>i.max-i.min-parseFloat(n)-parseFloat(a),top:(i,{top:n})=>parseFloat(n),left:(i,{left:n})=>parseFloat(n),bottom:({y:i},{top:n})=>parseFloat(n)+(i.max-i.min),right:({x:i},{left:n})=>parseFloat(n)+(i.max-i.min),x:(i,{transform:n})=>parseValueFromTransform(n,"x"),y:(i,{transform:n})=>parseValueFromTransform(n,"y")};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1,isForced=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const i=Array.from(toResolve).filter(h=>h.needsMeasurement),n=new Set(i.map(h=>h.element)),a=new Map;n.forEach(h=>{const m=removeNonTranslationalTransform(h);m.length&&(a.set(h,m),h.render())}),i.forEach(h=>h.measureInitialState()),n.forEach(h=>{h.render();const m=a.get(h);m&&m.forEach(([z,u])=>{h.getValue(z)?.set(u)})}),i.forEach(h=>h.measureEndState()),i.forEach(h=>{h.suspendedScrollY!==void 0&&window.scrollTo(0,h.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(i=>i.complete(isForced)),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(i=>{i.readKeyframes(),i.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){isForced=!0,readAllKeyframes(),measureAllKeyframes(),isForced=!1}class KeyframeResolver{constructor(n,a,h,m,z,u=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...n],this.onComplete=a,this.name=h,this.motionValue=m,this.element=z,this.isAsync=u}scheduleResolve(){this.state="scheduled",this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:n,name:a,element:h,motionValue:m}=this;if(n[0]===null){const z=m?.get(),u=n[n.length-1];if(z!==void 0)n[0]=z;else if(h&&a){const y=h.readValue(a,u);y!=null&&(n[0]=y)}n[0]===void 0&&(n[0]=u),m&&z===void 0&&m.set(n[0])}fillWildcards(n)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(n=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,n),toResolve.delete(this)}cancel(){this.state==="scheduled"&&(toResolve.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const isCSSVar=i=>i.startsWith("--");function setStyle(i,n,a){isCSSVar(n)?i.style.setProperty(n,a):i.style[n]=a}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0),supportsFlags={};function memoSupports(i,n){const a=memo(i);return()=>supportsFlags[n]??a()}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cubicBezierAsString=([i,n,a,h])=>`cubic-bezier(${i}, ${n}, ${a}, ${h})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(i,n){if(i)return typeof i=="function"?supportsLinearEasing()?generateLinearEasing(i,n):"ease-out":isBezierDefinition(i)?cubicBezierAsString(i):Array.isArray(i)?i.map(a=>mapEasingToNativeEasing(a,n)||supportedWaapiEasing.easeOut):supportedWaapiEasing[i]}function startWaapiAnimation(i,n,a,{delay:h=0,duration:m=300,repeat:z=0,repeatType:u="loop",ease:y="easeOut",times:p}={},w=void 0){const M={[n]:a};p&&(M.offset=p);const b=mapEasingToNativeEasing(y,m);Array.isArray(b)&&(M.easing=b);const I={delay:h,duration:m,easing:Array.isArray(b)?"linear":b,fill:"both",iterations:z+1,direction:u==="reverse"?"alternate":"normal"};return w&&(I.pseudoElement=w),i.animate(M,I)}function isGenerator(i){return typeof i=="function"&&"applyToOptions"in i}function applyGeneratorOptions({type:i,...n}){return isGenerator(i)&&supportsLinearEasing()?i.applyToOptions(n):(n.duration??(n.duration=300),n.ease??(n.ease="easeOut"),n)}class NativeAnimation extends WithPromise{constructor(n){if(super(),this.finishedTime=null,this.isStopped=!1,!n)return;const{element:a,name:h,keyframes:m,pseudoElement:z,allowFlatten:u=!1,finalKeyframe:y,onComplete:p}=n;this.isPseudoElement=!!z,this.allowFlatten=u,this.options=n,invariant(typeof n.type!="string");const w=applyGeneratorOptions(n);this.animation=startWaapiAnimation(a,h,m,w,z),w.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!z){const M=getFinalKeyframe$1(m,this.options,y,this.speed);this.updateMotionValue?this.updateMotionValue(M):setStyle(a,h,M),this.animation.cancel()}p?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:n}=this;n==="idle"||n==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const n=this.animation.effect?.getComputedTiming?.().duration||0;return millisecondsToSeconds(Number(n))}get iterationDuration(){const{delay:n=0}=this.options||{};return this.duration+millisecondsToSeconds(n)}get time(){return millisecondsToSeconds(Number(this.animation.currentTime)||0)}set time(n){this.finishedTime=null,this.animation.currentTime=secondsToMilliseconds(n)}get speed(){return this.animation.playbackRate}set speed(n){n<0&&(this.finishedTime=null),this.animation.playbackRate=n}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(n){this.animation.startTime=n}attachTimeline({timeline:n,observe:a}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,n&&supportsScrollTimeline()?(this.animation.timeline=n,noop):a(this)}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(i){return i in unsupportedEasingFunctions}function replaceStringEasing(i){typeof i.ease=="string"&&isUnsupportedEase(i.ease)&&(i.ease=unsupportedEasingFunctions[i.ease])}const sampleDelta=10;class NativeAnimationExtended extends NativeAnimation{constructor(n){replaceStringEasing(n),replaceTransitionType(n),super(n),n.startTime&&(this.startTime=n.startTime),this.options=n}updateMotionValue(n){const{motionValue:a,onUpdate:h,onComplete:m,element:z,...u}=this.options;if(!a)return;if(n!==void 0){a.set(n);return}const y=new JSAnimation({...u,autoplay:!1}),p=secondsToMilliseconds(this.finishedTime??this.time);a.setWithVelocity(y.sample(p-sampleDelta).value,y.sample(p).value,sampleDelta),y.stop()}}const isAnimatable=(i,n)=>n==="zIndex"?!1:!!(typeof i=="number"||Array.isArray(i)||typeof i=="string"&&(complex.test(i)||i==="0")&&!i.startsWith("url("));function hasKeyframesChanged(i){const n=i[0];if(i.length===1)return!0;for(let a=0;a<i.length;a++)if(i[a]!==n)return!0}function canAnimate(i,n,a,h){const m=i[0];if(m===null)return!1;if(n==="display"||n==="visibility")return!0;const z=i[i.length-1],u=isAnimatable(m,n),y=isAnimatable(z,n);return!u||!y?!1:hasKeyframesChanged(i)||(a==="spring"||isGenerator(a))&&h}function makeAnimationInstant(i){i.duration=0,i.type="keyframes"}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]),supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function supportsBrowserAnimation(i){const{motionValue:n,name:a,repeatDelay:h,repeatType:m,damping:z,type:u}=i;if(!(n?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:p,transformTemplate:w}=n.owner.getProps();return supportsWaapi()&&a&&acceleratedValues.has(a)&&(a!=="transform"||!w)&&!p&&!h&&m!=="mirror"&&z!==0&&u!=="inertia"}const MAX_RESOLVE_DELAY=40;class AsyncMotionValueAnimation extends WithPromise{constructor({autoplay:n=!0,delay:a=0,type:h="keyframes",repeat:m=0,repeatDelay:z=0,repeatType:u="loop",keyframes:y,name:p,motionValue:w,element:M,...b}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=time.now();const I={autoplay:n,delay:a,type:h,repeat:m,repeatDelay:z,repeatType:u,name:p,motionValue:w,element:M,...b},O=M?.KeyframeResolver||KeyframeResolver;this.keyframeResolver=new O(y,(T,L,Q)=>this.onKeyframesResolved(T,L,I,!Q),p,w,M),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(n,a,h,m){this.keyframeResolver=void 0;const{name:z,type:u,velocity:y,delay:p,isHandoff:w,onUpdate:M}=h;this.resolvedAt=time.now(),canAnimate(n,z,u,y)||((MotionGlobalConfig.instantAnimations||!p)&&M?.(getFinalKeyframe$1(n,h,a)),n[0]=n[n.length-1],makeAnimationInstant(h),h.repeat=0);const I={startTime:m?this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:a,...h,keyframes:n},O=!w&&supportsBrowserAnimation(I)?new NativeAnimationExtended({...I,element:I.motionValue.owner.current}):new JSAnimation(I);O.finished.then(()=>this.notifyFinished()).catch(noop),this.pendingTimeline&&(this.stopTimeline=O.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=O}get finished(){return this._animation?this.animation.finished:this._finished}then(n,a){return this.finished.finally(n).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),flushKeyframeResolvers()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(n){this.animation.time=n}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(n){this.animation.speed=n}get startTime(){return this.animation.startTime}attachTimeline(n){return this._animation?this.stopTimeline=this.animation.attachTimeline(n):this.pendingTimeline=n,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(i){const n=splitCSSVariableRegex.exec(i);if(!n)return[,];const[,a,h,m]=n;return[`--${a??h}`,m]}function getVariableValue(i,n,a=1){const[h,m]=parseCSSVariable(i);if(!h)return;const z=window.getComputedStyle(n).getPropertyValue(h);if(z){const u=z.trim();return isNumericalString(u)?parseFloat(u):u}return isCSSVariableToken(m)?getVariableValue(m,n,a+1):m}function getValueTransition(i,n){return i?.[n]??i?.default??i}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]),auto={test:i=>i==="auto",parse:i=>i},testValueType=i=>n=>n.test(i),dimensionValueTypes=[number,px,percent,degrees,vw,vh,auto],findDimensionValueType=i=>dimensionValueTypes.find(testValueType(i));function isNone(i){return typeof i=="number"?i===0:i!==null?i==="none"||i==="0"||isZeroValueString(i):!0}const maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(i){const[n,a]=i.slice(0,-1).split("(");if(n==="drop-shadow")return i;const[h]=a.match(floatRegex)||[];if(!h)return i;const m=a.replace(h,"");let z=maxDefaults.has(n)?1:0;return h!==a&&(z*=100),n+"("+z+m+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:i=>{const n=i.match(functionRegex);return n?n.map(applyDefaultFilter).join(" "):i}},int={...number,transform:Math.round},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,backgroundPositionX:px,backgroundPositionY:px,...transformValueTypes,zIndex:int,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},defaultValueTypes={...numberValueTypes,color,backgroundColor:color,outlineColor:color,fill:color,stroke:color,borderColor:color,borderTopColor:color,borderRightColor:color,borderBottomColor:color,borderLeftColor:color,filter,WebkitFilter:filter},getDefaultValueType=i=>defaultValueTypes[i];function getAnimatableNone(i,n){let a=getDefaultValueType(i);return a!==filter&&(a=complex),a.getAnimatableNone?a.getAnimatableNone(n):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(i,n,a){let h=0,m;for(;h<i.length&&!m;){const z=i[h];typeof z=="string"&&!invalidTemplates.has(z)&&analyseComplexValue(z).values.length&&(m=i[h]),h++}if(m&&a)for(const z of n)i[z]=getAnimatableNone(a,m)}class DOMKeyframesResolver extends KeyframeResolver{constructor(n,a,h,m,z){super(n,a,h,m,z,!0)}readKeyframes(){const{unresolvedKeyframes:n,element:a,name:h}=this;if(!a||!a.current)return;super.readKeyframes();for(let p=0;p<n.length;p++){let w=n[p];if(typeof w=="string"&&(w=w.trim(),isCSSVariableToken(w))){const M=getVariableValue(w,a.current);M!==void 0&&(n[p]=M),p===n.length-1&&(this.finalKeyframe=w)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(h)||n.length!==2)return;const[m,z]=n,u=findDimensionValueType(m),y=findDimensionValueType(z);if(u!==y)if(isNumOrPxType(u)&&isNumOrPxType(y))for(let p=0;p<n.length;p++){const w=n[p];typeof w=="string"&&(n[p]=parseFloat(w))}else positionalValues[h]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:n,name:a}=this,h=[];for(let m=0;m<n.length;m++)(n[m]===null||isNone(n[m]))&&h.push(m);h.length&&makeNoneKeyframesAnimatable(n,h,a)}measureInitialState(){const{element:n,unresolvedKeyframes:a,name:h}=this;if(!n||!n.current)return;h==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[h](n.measureViewportBox(),window.getComputedStyle(n.current)),a[0]=this.measuredOrigin;const m=a[a.length-1];m!==void 0&&n.getValue(h,m).jump(m,!1)}measureEndState(){const{element:n,name:a,unresolvedKeyframes:h}=this;if(!n||!n.current)return;const m=n.getValue(a);m&&m.jump(this.measuredOrigin,!1);const z=h.length-1,u=h[z];h[z]=positionalValues[a](n.measureViewportBox(),window.getComputedStyle(n.current)),u!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=u),this.removedTransforms?.length&&this.removedTransforms.forEach(([y,p])=>{n.getValue(y).set(p)}),this.resolveNoneKeyframes()}}function resolveElements(i,n,a){if(i instanceof EventTarget)return[i];if(typeof i=="string"){let h=document;const m=a?.[i]??h.querySelectorAll(i);return m?Array.from(m):[]}return Array.from(i)}const getValueAsType=(i,n)=>n&&typeof i=="number"?n.transform(i):i;function isHTMLElement(i){return isObject(i)&&"offsetHeight"in i}const MAX_VELOCITY_DELTA=30,isFloat=i=>!isNaN(parseFloat(i));class MotionValue{constructor(n,a={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=h=>{const m=time.now();if(this.updatedAt!==m&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(h),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const z of this.dependents)z.dirty()},this.hasAnimated=!1,this.setCurrent(n),this.owner=a.owner}setCurrent(n){this.current=n,this.updatedAt=time.now(),this.canTrackVelocity===null&&n!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(n=this.current){this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt}onChange(n){return this.on("change",n)}on(n,a){this.events[n]||(this.events[n]=new SubscriptionManager);const h=this.events[n].add(a);return n==="change"?()=>{h(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:h}clearListeners(){for(const n in this.events)this.events[n].clear()}attach(n,a){this.passiveEffect=n,this.stopPassiveEffect=a}set(n){this.passiveEffect?this.passiveEffect(n,this.updateAndNotify):this.updateAndNotify(n)}setWithVelocity(n,a,h){this.set(a),this.prev=void 0,this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt-h}jump(n,a=!0){this.updateAndNotify(n),this.prev=n,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(n){this.dependents||(this.dependents=new Set),this.dependents.add(n)}removeDependent(n){this.dependents&&this.dependents.delete(n)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const n=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||n-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(n){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=n(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(i,n){return new MotionValue(i,n)}const{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function setDragLock(i){return i==="x"||i==="y"?isDragging[i]?null:(isDragging[i]=!0,()=>{isDragging[i]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}function setupGesture(i,n){const a=resolveElements(i),h=new AbortController,m={passive:!0,...n,signal:h.signal};return[a,m,()=>h.abort()]}function isValidHover(i){return!(i.pointerType==="touch"||isDragActive())}function hover(i,n,a={}){const[h,m,z]=setupGesture(i,a),u=y=>{if(!isValidHover(y))return;const{target:p}=y,w=n(p,y);if(typeof w!="function"||!p)return;const M=b=>{isValidHover(b)&&(w(b),p.removeEventListener("pointerleave",M))};p.addEventListener("pointerleave",M,m)};return h.forEach(y=>{y.addEventListener("pointerenter",u,m)}),z}const isNodeOrChild=(i,n)=>n?i===n?!0:isNodeOrChild(i,n.parentElement):!1,isPrimaryPointer=i=>i.pointerType==="mouse"?typeof i.button!="number"||i.button<=0:i.isPrimary!==!1,focusableElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(i){return focusableElements.has(i.tagName)||i.tabIndex!==-1}const isPressing=new WeakSet;function filterEvents(i){return n=>{n.key==="Enter"&&i(n)}}function firePointerEvent(i,n){i.dispatchEvent(new PointerEvent("pointer"+n,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(i,n)=>{const a=i.currentTarget;if(!a)return;const h=filterEvents(()=>{if(isPressing.has(a))return;firePointerEvent(a,"down");const m=filterEvents(()=>{firePointerEvent(a,"up")}),z=()=>firePointerEvent(a,"cancel");a.addEventListener("keyup",m,n),a.addEventListener("blur",z,n)});a.addEventListener("keydown",h,n),a.addEventListener("blur",()=>a.removeEventListener("keydown",h),n)};function isValidPressEvent(i){return isPrimaryPointer(i)&&!isDragActive()}function press(i,n,a={}){const[h,m,z]=setupGesture(i,a),u=y=>{const p=y.currentTarget;if(!isValidPressEvent(y))return;isPressing.add(p);const w=n(p,y),M=(O,T)=>{window.removeEventListener("pointerup",b),window.removeEventListener("pointercancel",I),isPressing.has(p)&&isPressing.delete(p),isValidPressEvent(O)&&typeof w=="function"&&w(O,{success:T})},b=O=>{M(O,p===window||p===document||a.useGlobalTarget||isNodeOrChild(p,O.target))},I=O=>{M(O,!1)};window.addEventListener("pointerup",b,m),window.addEventListener("pointercancel",I,m)};return h.forEach(y=>{(a.useGlobalTarget?window:y).addEventListener("pointerdown",u,m),isHTMLElement(y)&&(y.addEventListener("focus",w=>enableKeyboardPress(w,m)),!isElementKeyboardAccessible(y)&&!y.hasAttribute("tabindex")&&(y.tabIndex=0))}),z}function isSVGElement(i){return isObject(i)&&"ownerSVGElement"in i}function isSVGSVGElement(i){return isSVGElement(i)&&i.tagName==="svg"}const isMotionValue=i=>!!(i&&i.getVelocity),valueTypes=[...dimensionValueTypes,color,complex],findValueType=i=>valueTypes.find(testValueType(i)),MotionConfigContext=reactExports.createContext({transformPagePoint:i=>i,isStatic:!1,reducedMotion:"never"});function setRef(i,n){if(typeof i=="function")return i(n);i!=null&&(i.current=n)}function composeRefs(...i){return n=>{let a=!1;const h=i.map(m=>{const z=setRef(m,n);return!a&&typeof z=="function"&&(a=!0),z});if(a)return()=>{for(let m=0;m<h.length;m++){const z=h[m];typeof z=="function"?z():setRef(i[m],null)}}}}function useComposedRefs(...i){return reactExports.useCallback(composeRefs(...i),i)}class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate(n){const a=this.props.childRef.current;if(a&&n.isPresent&&!this.props.isPresent){const h=a.offsetParent,m=isHTMLElement(h)&&h.offsetWidth||0,z=this.props.sizeRef.current;z.height=a.offsetHeight||0,z.width=a.offsetWidth||0,z.top=a.offsetTop,z.left=a.offsetLeft,z.right=m-z.width-z.left}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:i,isPresent:n,anchorX:a,root:h}){const m=reactExports.useId(),z=reactExports.useRef(null),u=reactExports.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:y}=reactExports.useContext(MotionConfigContext),p=useComposedRefs(z,i?.ref);return reactExports.useInsertionEffect(()=>{const{width:w,height:M,top:b,left:I,right:O}=u.current;if(n||!z.current||!w||!M)return;const T=a==="left"?`left: ${I}`:`right: ${O}`;z.current.dataset.motionPopId=m;const L=document.createElement("style");y&&(L.nonce=y);const Q=h??document.head;return Q.appendChild(L),L.sheet&&L.sheet.insertRule(`
          [data-motion-pop-id="${m}"] {
            position: absolute !important;
            width: ${w}px !important;
            height: ${M}px !important;
            ${T}px !important;
            top: ${b}px !important;
          }
        `),()=>{Q.contains(L)&&Q.removeChild(L)}},[n]),jsxRuntimeExports.jsx(PopChildMeasure,{isPresent:n,childRef:z,sizeRef:u,children:reactExports.cloneElement(i,{ref:p})})}const PresenceChild=({children:i,initial:n,isPresent:a,onExitComplete:h,custom:m,presenceAffectsLayout:z,mode:u,anchorX:y,root:p})=>{const w=useConstant(newChildrenMap),M=reactExports.useId();let b=!0,I=reactExports.useMemo(()=>(b=!1,{id:M,initial:n,isPresent:a,custom:m,onExitComplete:O=>{w.set(O,!0);for(const T of w.values())if(!T)return;h&&h()},register:O=>(w.set(O,!1),()=>w.delete(O))}),[a,w,h]);return z&&b&&(I={...I}),reactExports.useMemo(()=>{w.forEach((O,T)=>w.set(T,!1))},[a]),reactExports.useEffect(()=>{!a&&!w.size&&h&&h()},[a]),u==="popLayout"&&(i=jsxRuntimeExports.jsx(PopChild,{isPresent:a,anchorX:y,root:p,children:i})),jsxRuntimeExports.jsx(PresenceContext.Provider,{value:I,children:i})};function newChildrenMap(){return new Map}function usePresence(i=!0){const n=reactExports.useContext(PresenceContext);if(n===null)return[!0,null];const{isPresent:a,onExitComplete:h,register:m}=n,z=reactExports.useId();reactExports.useEffect(()=>{if(i)return m(z)},[i]);const u=reactExports.useCallback(()=>i&&h&&h(z),[z,h,i]);return!a&&h?[!1,u]:[!0]}const getChildKey=i=>i.key||"";function onlyElements(i){const n=[];return reactExports.Children.forEach(i,a=>{reactExports.isValidElement(a)&&n.push(a)}),n}const AnimatePresence=({children:i,custom:n,initial:a=!0,onExitComplete:h,presenceAffectsLayout:m=!0,mode:z="sync",propagate:u=!1,anchorX:y="left",root:p})=>{const[w,M]=usePresence(u),b=reactExports.useMemo(()=>onlyElements(i),[i]),I=u&&!w?[]:b.map(getChildKey),O=reactExports.useRef(!0),T=reactExports.useRef(b),L=useConstant(()=>new Map),[Q,ne]=reactExports.useState(b),[Z,_]=reactExports.useState(b);useIsomorphicLayoutEffect(()=>{O.current=!1,T.current=b;for(let G=0;G<Z.length;G++){const q=getChildKey(Z[G]);I.includes(q)?L.delete(q):L.get(q)!==!0&&L.set(q,!1)}},[Z,I.length,I.join("-")]);const F=[];if(b!==Q){let G=[...b];for(let q=0;q<Z.length;q++){const N=Z[q],ee=getChildKey(N);I.includes(ee)||(G.splice(q,0,N),F.push(N))}return z==="wait"&&F.length&&(G=F),_(onlyElements(G)),ne(b),null}const{forceRender:j}=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:Z.map(G=>{const q=getChildKey(G),N=u&&!w?!1:b===Z||I.includes(q),ee=()=>{if(L.has(q))L.set(q,!0);else return;let Ce=!0;L.forEach(he=>{he||(Ce=!1)}),Ce&&(j?.(),_(T.current),u&&M?.(),h&&h())};return jsxRuntimeExports.jsx(PresenceChild,{isPresent:N,initial:!O.current||a?void 0:!1,custom:n,presenceAffectsLayout:m,mode:z,root:p,onExitComplete:N?void 0:ee,anchorX:y,children:G},q)})})},LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const i in featureProps)featureDefinitions[i]={isEnabled:n=>featureProps[i].some(a=>!!n[a])};function loadFeatures(i){for(const n in i)featureDefinitions[n]={...featureDefinitions[n],...i[n]}}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(i){return i.startsWith("while")||i.startsWith("drag")&&i!=="draggable"||i.startsWith("layout")||i.startsWith("onTap")||i.startsWith("onPan")||i.startsWith("onLayout")||validMotionProps.has(i)}let shouldForward=i=>!isValidMotionProp(i);function loadExternalIsValidProp(i){typeof i=="function"&&(shouldForward=n=>n.startsWith("on")?!isValidMotionProp(n):i(n))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(i,n,a){const h={};for(const m in i)m==="values"&&typeof i.values=="object"||(shouldForward(m)||a===!0&&isValidMotionProp(m)||!n&&!isValidMotionProp(m)||i.draggable&&m.startsWith("onDrag"))&&(h[m]=i[m]);return h}const MotionContext=reactExports.createContext({});function isAnimationControls(i){return i!==null&&typeof i=="object"&&typeof i.start=="function"}function isVariantLabel(i){return typeof i=="string"||Array.isArray(i)}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(i){return isAnimationControls(i.animate)||variantProps.some(n=>isVariantLabel(i[n]))}function isVariantNode(i){return!!(isControllingVariants(i)||i.variants)}function getCurrentTreeVariants(i,n){if(isControllingVariants(i)){const{initial:a,animate:h}=i;return{initial:a===!1||isVariantLabel(a)?a:void 0,animate:isVariantLabel(h)?h:void 0}}return i.inherit!==!1?n:{}}function useCreateMotionContext(i){const{initial:n,animate:a}=getCurrentTreeVariants(i,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:n,animate:a}),[variantLabelsAsDependency(n),variantLabelsAsDependency(a)])}function variantLabelsAsDependency(i){return Array.isArray(i)?i.join(" "):i}const scaleCorrectors={};function addScaleCorrector(i){for(const n in i)scaleCorrectors[n]=i[n],isCSSVariableName(n)&&(scaleCorrectors[n].isCSSVariable=!0)}function isForcedMotionValue(i,{layout:n,layoutId:a}){return transformProps.has(i)||i.startsWith("origin")||(n||a!==void 0)&&(!!scaleCorrectors[i]||i==="opacity")}const translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(i,n,a){let h="",m=!0;for(let z=0;z<numTransforms;z++){const u=transformPropOrder[z],y=i[u];if(y===void 0)continue;let p=!0;if(typeof y=="number"?p=y===(u.startsWith("scale")?1:0):p=parseFloat(y)===0,!p||a){const w=getValueAsType(y,numberValueTypes[u]);if(!p){m=!1;const M=translateAlias[u]||u;h+=`${M}(${w}) `}a&&(n[u]=w)}}return h=h.trim(),a?h=a(n,m?"":h):m&&(h="none"),h}function buildHTMLStyles(i,n,a){const{style:h,vars:m,transformOrigin:z}=i;let u=!1,y=!1;for(const p in n){const w=n[p];if(transformProps.has(p)){u=!0;continue}else if(isCSSVariableName(p)){m[p]=w;continue}else{const M=getValueAsType(w,numberValueTypes[p]);p.startsWith("origin")?(y=!0,z[p]=M):h[p]=M}}if(n.transform||(u||a?h.transform=buildTransform(n,i.transform,a):h.transform&&(h.transform="none")),y){const{originX:p="50%",originY:w="50%",originZ:M=0}=z;h.transformOrigin=`${p} ${w} ${M}`}}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(i,n,a){for(const h in n)!isMotionValue(n[h])&&!isForcedMotionValue(h,a)&&(i[h]=n[h])}function useInitialMotionValues({transformTemplate:i},n){return reactExports.useMemo(()=>{const a=createHtmlRenderState();return buildHTMLStyles(a,n,i),Object.assign({},a.vars,a.style)},[n])}function useStyle(i,n){const a=i.style||{},h={};return copyRawValuesOnly(h,a,i),Object.assign(h,useInitialMotionValues(i,n)),h}function useHTMLProps(i,n){const a={},h=useStyle(i,n);return i.drag&&i.dragListener!==!1&&(a.draggable=!1,h.userSelect=h.WebkitUserSelect=h.WebkitTouchCallout="none",h.touchAction=i.drag===!0?"none":`pan-${i.drag==="x"?"y":"x"}`),i.tabIndex===void 0&&(i.onTap||i.onTapStart||i.whileTap)&&(a.tabIndex=0),a.style=h,a}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(i,n,a=1,h=0,m=!0){i.pathLength=1;const z=m?dashKeys:camelKeys;i[z.offset]=px.transform(-h);const u=px.transform(n),y=px.transform(a);i[z.array]=`${u} ${y}`}function buildSVGAttrs(i,{attrX:n,attrY:a,attrScale:h,pathLength:m,pathSpacing:z=1,pathOffset:u=0,...y},p,w,M){if(buildHTMLStyles(i,y,w),p){i.style.viewBox&&(i.attrs.viewBox=i.style.viewBox);return}i.attrs=i.style,i.style={};const{attrs:b,style:I}=i;b.transform&&(I.transform=b.transform,delete b.transform),(I.transform||b.transformOrigin)&&(I.transformOrigin=b.transformOrigin??"50% 50%",delete b.transformOrigin),I.transform&&(I.transformBox=M?.transformBox??"fill-box",delete b.transformBox),n!==void 0&&(b.x=n),a!==void 0&&(b.y=a),h!==void 0&&(b.scale=h),m!==void 0&&buildSVGPath(b,m,z,u,!1)}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=i=>typeof i=="string"&&i.toLowerCase()==="svg";function useSVGProps(i,n,a,h){const m=reactExports.useMemo(()=>{const z=createSvgRenderState();return buildSVGAttrs(z,n,isSVGTag(h),i.transformTemplate,i.style),{...z.attrs,style:{...z.style}}},[n]);if(i.style){const z={};copyRawValuesOnly(z,i.style,i),m.style={...z,...m.style}}return m}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(i){return typeof i!="string"||i.includes("-")?!1:!!(lowercaseSVGElements.indexOf(i)>-1||/[A-Z]/u.test(i))}function useRender(i,n,a,{latestValues:h},m,z=!1){const y=(isSVGComponent(i)?useSVGProps:useHTMLProps)(n,h,m,i),p=filterProps(n,typeof i=="string",z),w=i!==reactExports.Fragment?{...p,...y,ref:a}:{},{children:M}=n,b=reactExports.useMemo(()=>isMotionValue(M)?M.get():M,[M]);return reactExports.createElement(i,{...w,children:b})}function getValueState(i){const n=[{},{}];return i?.values.forEach((a,h)=>{n[0][h]=a.get(),n[1][h]=a.getVelocity()}),n}function resolveVariantFromProps(i,n,a,h){if(typeof n=="function"){const[m,z]=getValueState(h);n=n(a!==void 0?a:i.custom,m,z)}if(typeof n=="string"&&(n=i.variants&&i.variants[n]),typeof n=="function"){const[m,z]=getValueState(h);n=n(a!==void 0?a:i.custom,m,z)}return n}function resolveMotionValue(i){return isMotionValue(i)?i.get():i}function makeState({scrapeMotionValuesFromProps:i,createRenderState:n},a,h,m){return{latestValues:makeLatestValues(a,h,m,i),renderState:n()}}function makeLatestValues(i,n,a,h){const m={},z=h(i,{});for(const I in z)m[I]=resolveMotionValue(z[I]);let{initial:u,animate:y}=i;const p=isControllingVariants(i),w=isVariantNode(i);n&&w&&!p&&i.inherit!==!1&&(u===void 0&&(u=n.initial),y===void 0&&(y=n.animate));let M=a?a.initial===!1:!1;M=M||u===!1;const b=M?y:u;if(b&&typeof b!="boolean"&&!isAnimationControls(b)){const I=Array.isArray(b)?b:[b];for(let O=0;O<I.length;O++){const T=resolveVariantFromProps(i,I[O]);if(T){const{transitionEnd:L,transition:Q,...ne}=T;for(const Z in ne){let _=ne[Z];if(Array.isArray(_)){const F=M?_.length-1:0;_=_[F]}_!==null&&(m[Z]=_)}for(const Z in L)m[Z]=L[Z]}}}return m}const makeUseVisualState=i=>(n,a)=>{const h=reactExports.useContext(MotionContext),m=reactExports.useContext(PresenceContext),z=()=>makeState(i,n,h,m);return a?z():useConstant(z)};function scrapeMotionValuesFromProps$1(i,n,a){const{style:h}=i,m={};for(const z in h)(isMotionValue(h[z])||n.style&&isMotionValue(n.style[z])||isForcedMotionValue(z,i)||a?.getValue(z)?.liveStyle!==void 0)&&(m[z]=h[z]);return m}const useHTMLVisualState=makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState});function scrapeMotionValuesFromProps(i,n,a){const h=scrapeMotionValuesFromProps$1(i,n,a);for(const m in i)if(isMotionValue(i[m])||isMotionValue(n[m])){const z=transformPropOrder.indexOf(m)!==-1?"attr"+m.charAt(0).toUpperCase()+m.substring(1):m;h[z]=i[m]}return h}const useSVGVisualState=makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState}),motionComponentSymbol=Symbol.for("motionComponentSymbol");function isRefObject(i){return i&&typeof i=="object"&&Object.prototype.hasOwnProperty.call(i,"current")}function useMotionRef(i,n,a){return reactExports.useCallback(h=>{h&&i.onMount&&i.onMount(h),n&&(h?n.mount(h):n.unmount()),a&&(typeof a=="function"?a(h):isRefObject(a)&&(a.current=h))},[n])}const camelToDash=i=>i.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),SwitchLayoutGroupContext=reactExports.createContext({});function useVisualElement(i,n,a,h,m){const{visualElement:z}=reactExports.useContext(MotionContext),u=reactExports.useContext(LazyContext),y=reactExports.useContext(PresenceContext),p=reactExports.useContext(MotionConfigContext).reducedMotion,w=reactExports.useRef(null);h=h||u.renderer,!w.current&&h&&(w.current=h(i,{visualState:n,parent:z,props:a,presenceContext:y,blockInitialAnimation:y?y.initial===!1:!1,reducedMotionConfig:p}));const M=w.current,b=reactExports.useContext(SwitchLayoutGroupContext);M&&!M.projection&&m&&(M.type==="html"||M.type==="svg")&&createProjectionNode$1(w.current,a,m,b);const I=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{M&&I.current&&M.update(a,y)});const O=a[optimizedAppearDataAttribute],T=reactExports.useRef(!!O&&!window.MotionHandoffIsComplete?.(O)&&window.MotionHasOptimisedAnimation?.(O));return useIsomorphicLayoutEffect(()=>{M&&(I.current=!0,window.MotionIsMounted=!0,M.updateFeatures(),M.scheduleRenderMicrotask(),T.current&&M.animationState&&M.animationState.animateChanges())}),reactExports.useEffect(()=>{M&&(!T.current&&M.animationState&&M.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(O)}),T.current=!1),M.enteringChildren=void 0)}),M}function createProjectionNode$1(i,n,a,h){const{layoutId:m,layout:z,drag:u,dragConstraints:y,layoutScroll:p,layoutRoot:w,layoutCrossfade:M}=n;i.projection=new a(i.latestValues,n["data-framer-portal-id"]?void 0:getClosestProjectingNode(i.parent)),i.projection.setOptions({layoutId:m,layout:z,alwaysMeasureLayout:!!u||y&&isRefObject(y),visualElement:i,animationType:typeof z=="string"?z:"both",initialPromotionConfig:h,crossfade:M,layoutScroll:p,layoutRoot:w})}function getClosestProjectingNode(i){if(i)return i.options.allowProjection!==!1?i.projection:getClosestProjectingNode(i.parent)}function createMotionComponent(i,{forwardMotionProps:n=!1}={},a,h){a&&loadFeatures(a);const m=isSVGComponent(i)?useSVGVisualState:useHTMLVisualState;function z(y,p){let w;const M={...reactExports.useContext(MotionConfigContext),...y,layoutId:useLayoutId(y)},{isStatic:b}=M,I=useCreateMotionContext(y),O=m(y,b);if(!b&&isBrowser){useStrictMode();const T=getProjectionFunctionality(M);w=T.MeasureLayout,I.visualElement=useVisualElement(i,O,M,h,T.ProjectionNode)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:I,children:[w&&I.visualElement?jsxRuntimeExports.jsx(w,{visualElement:I.visualElement,...M}):null,useRender(i,y,useMotionRef(O,I.visualElement,p),O,b,n)]})}z.displayName=`motion.${typeof i=="string"?i:`create(${i.displayName??i.name??""})`}`;const u=reactExports.forwardRef(z);return u[motionComponentSymbol]=i,u}function useLayoutId({layoutId:i}){const n=reactExports.useContext(LayoutGroupContext).id;return n&&i!==void 0?n+"-"+i:i}function useStrictMode(i,n){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(i){const{drag:n,layout:a}=featureDefinitions;if(!n&&!a)return{};const h={...n,...a};return{MeasureLayout:n?.isEnabled(i)||a?.isEnabled(i)?h.MeasureLayout:void 0,ProjectionNode:h.ProjectionNode}}function createMotionProxy(i,n){if(typeof Proxy>"u")return createMotionComponent;const a=new Map,h=(z,u)=>createMotionComponent(z,u,i,n),m=(z,u)=>h(z,u);return new Proxy(m,{get:(z,u)=>u==="create"?h:(a.has(u)||a.set(u,createMotionComponent(u,void 0,i,n)),a.get(u))})}function convertBoundingBoxToBox({top:i,left:n,right:a,bottom:h}){return{x:{min:n,max:a},y:{min:i,max:h}}}function convertBoxToBoundingBox({x:i,y:n}){return{top:n.min,right:i.max,bottom:n.max,left:i.min}}function transformBoxPoints(i,n){if(!n)return i;const a=n({x:i.left,y:i.top}),h=n({x:i.right,y:i.bottom});return{top:a.y,left:a.x,bottom:h.y,right:h.x}}function isIdentityScale(i){return i===void 0||i===1}function hasScale({scale:i,scaleX:n,scaleY:a}){return!isIdentityScale(i)||!isIdentityScale(n)||!isIdentityScale(a)}function hasTransform(i){return hasScale(i)||has2DTranslate(i)||i.z||i.rotate||i.rotateX||i.rotateY||i.skewX||i.skewY}function has2DTranslate(i){return is2DTranslate(i.x)||is2DTranslate(i.y)}function is2DTranslate(i){return i&&i!=="0%"}function scalePoint(i,n,a){const h=i-a,m=n*h;return a+m}function applyPointDelta(i,n,a,h,m){return m!==void 0&&(i=scalePoint(i,m,h)),scalePoint(i,a,h)+n}function applyAxisDelta(i,n=0,a=1,h,m){i.min=applyPointDelta(i.min,n,a,h,m),i.max=applyPointDelta(i.max,n,a,h,m)}function applyBoxDelta(i,{x:n,y:a}){applyAxisDelta(i.x,n.translate,n.scale,n.originPoint),applyAxisDelta(i.y,a.translate,a.scale,a.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(i,n,a,h=!1){const m=a.length;if(!m)return;n.x=n.y=1;let z,u;for(let y=0;y<m;y++){z=a[y],u=z.projectionDelta;const{visualElement:p}=z.options;p&&p.props.style&&p.props.style.display==="contents"||(h&&z.options.layoutScroll&&z.scroll&&z!==z.root&&transformBox(i,{x:-z.scroll.offset.x,y:-z.scroll.offset.y}),u&&(n.x*=u.x.scale,n.y*=u.y.scale,applyBoxDelta(i,u)),h&&hasTransform(z.latestValues)&&transformBox(i,z.latestValues))}n.x<TREE_SCALE_SNAP_MAX&&n.x>TREE_SCALE_SNAP_MIN&&(n.x=1),n.y<TREE_SCALE_SNAP_MAX&&n.y>TREE_SCALE_SNAP_MIN&&(n.y=1)}function translateAxis(i,n){i.min=i.min+n,i.max=i.max+n}function transformAxis(i,n,a,h,m=.5){const z=mixNumber$1(i.min,i.max,m);applyAxisDelta(i,n,a,z,h)}function transformBox(i,n){transformAxis(i.x,n.x,n.scaleX,n.scale,n.originX),transformAxis(i.y,n.y,n.scaleY,n.scale,n.originY)}function measureViewportBox(i,n){return convertBoundingBoxToBox(transformBoxPoints(i.getBoundingClientRect(),n))}function measurePageBox(i,n,a){const h=measureViewportBox(i,a),{scroll:m}=n;return m&&(translateAxis(h.x,m.offset.x),translateAxis(h.y,m.offset.y)),h}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()}),prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const i=window.matchMedia("(prefers-reduced-motion)"),n=()=>prefersReducedMotion.current=i.matches;i.addEventListener("change",n),n()}else prefersReducedMotion.current=!1}const visualElementStore=new WeakMap;function updateMotionValuesFromProps(i,n,a){for(const h in n){const m=n[h],z=a[h];if(isMotionValue(m))i.addValue(h,m);else if(isMotionValue(z))i.addValue(h,motionValue(m,{owner:i}));else if(z!==m)if(i.hasValue(h)){const u=i.getValue(h);u.liveStyle===!0?u.jump(m):u.hasAnimated||u.set(m)}else{const u=i.getStaticValue(h);i.addValue(h,motionValue(u!==void 0?u:m,{owner:i}))}}for(const h in a)n[h]===void 0&&i.removeValue(h);return n}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps(n,a,h){return{}}constructor({parent:n,props:a,presenceContext:h,reducedMotionConfig:m,blockInitialAnimation:z,visualState:u},y={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const I=time.now();this.renderScheduledAt<I&&(this.renderScheduledAt=I,frame.render(this.render,!1,!0))};const{latestValues:p,renderState:w}=u;this.latestValues=p,this.baseTarget={...p},this.initialValues=a.initial?{...p}:{},this.renderState=w,this.parent=n,this.props=a,this.presenceContext=h,this.depth=n?n.depth+1:0,this.reducedMotionConfig=m,this.options=y,this.blockInitialAnimation=!!z,this.isControllingVariants=isControllingVariants(a),this.isVariantNode=isVariantNode(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(n&&n.current);const{willChange:M,...b}=this.scrapeMotionValuesFromProps(a,{},this);for(const I in b){const O=b[I];p[I]!==void 0&&isMotionValue(O)&&O.set(p[I])}}mount(n){this.current=n,visualElementStore.set(n,this),this.projection&&!this.projection.instance&&this.projection.mount(n),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,h)=>this.bindToMotionValue(h,a)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const a=this.features[n];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(n){this.children.add(n),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(n)}removeChild(n){this.children.delete(n),this.enteringChildren&&this.enteringChildren.delete(n)}bindToMotionValue(n,a){this.valueSubscriptions.has(n)&&this.valueSubscriptions.get(n)();const h=transformProps.has(n);h&&this.onBindTransform&&this.onBindTransform();const m=a.on("change",u=>{this.latestValues[n]=u,this.props.onUpdate&&frame.preRender(this.notifyUpdate),h&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let z;window.MotionCheckAppearSync&&(z=window.MotionCheckAppearSync(this,n,a)),this.valueSubscriptions.set(n,()=>{m(),z&&z(),a.owner&&a.stop()})}sortNodePosition(n){return!this.current||!this.sortInstanceNodePosition||this.type!==n.type?0:this.sortInstanceNodePosition(this.current,n.current)}updateFeatures(){let n="animation";for(n in featureDefinitions){const a=featureDefinitions[n];if(!a)continue;const{isEnabled:h,Feature:m}=a;if(!this.features[n]&&m&&h(this.props)&&(this.features[n]=new m(this)),this.features[n]){const z=this.features[n];z.isMounted?z.update():(z.mount(),z.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(n){return this.latestValues[n]}setStaticValue(n,a){this.latestValues[n]=a}update(n,a){(n.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=n,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let h=0;h<propEventHandlers.length;h++){const m=propEventHandlers[h];this.propEventSubscriptions[m]&&(this.propEventSubscriptions[m](),delete this.propEventSubscriptions[m]);const z="on"+m,u=n[z];u&&(this.propEventSubscriptions[m]=this.on(m,u))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(n,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(n){return this.props.variants?this.props.variants[n]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(n){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(n),()=>a.variantChildren.delete(n)}addValue(n,a){const h=this.values.get(n);a!==h&&(h&&this.removeValue(n),this.bindToMotionValue(n,a),this.values.set(n,a),this.latestValues[n]=a.get())}removeValue(n){this.values.delete(n);const a=this.valueSubscriptions.get(n);a&&(a(),this.valueSubscriptions.delete(n)),delete this.latestValues[n],this.removeValueFromRenderState(n,this.renderState)}hasValue(n){return this.values.has(n)}getValue(n,a){if(this.props.values&&this.props.values[n])return this.props.values[n];let h=this.values.get(n);return h===void 0&&a!==void 0&&(h=motionValue(a===null?void 0:a,{owner:this}),this.addValue(n,h)),h}readValue(n,a){let h=this.latestValues[n]!==void 0||!this.current?this.latestValues[n]:this.getBaseTargetFromProps(this.props,n)??this.readValueFromInstance(this.current,n,this.options);return h!=null&&(typeof h=="string"&&(isNumericalString(h)||isZeroValueString(h))?h=parseFloat(h):!findValueType(h)&&complex.test(a)&&(h=getAnimatableNone(n,a)),this.setBaseTarget(n,isMotionValue(h)?h.get():h)),isMotionValue(h)?h.get():h}setBaseTarget(n,a){this.baseTarget[n]=a}getBaseTarget(n){const{initial:a}=this.props;let h;if(typeof a=="string"||typeof a=="object"){const z=resolveVariantFromProps(this.props,a,this.presenceContext?.custom);z&&(h=z[n])}if(a&&h!==void 0)return h;const m=this.getBaseTargetFromProps(this.props,n);return m!==void 0&&!isMotionValue(m)?m:this.initialValues[n]!==void 0&&h===void 0?void 0:this.baseTarget[n]}on(n,a){return this.events[n]||(this.events[n]=new SubscriptionManager),this.events[n].add(a)}notify(n,...a){this.events[n]&&this.events[n].notify(...a)}scheduleRenderMicrotask(){microtask.render(this.render)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(n,a){return n.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(n,a){return n.style?n.style[a]:void 0}removeValueFromRenderState(n,{vars:a,style:h}){delete a[n],delete h[n]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:n}=this.props;isMotionValue(n)&&(this.childSubscription=n.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function renderHTML(i,{style:n,vars:a},h,m){const z=i.style;let u;for(u in n)z[u]=n[u];m?.applyProjectionStyles(z,h);for(u in a)z.setProperty(u,a[u])}function getComputedStyle$1(i){return window.getComputedStyle(i)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(n,a){if(transformProps.has(a))return this.projection?.isProjecting?defaultTransformValue(a):readTransformValue(n,a);{const h=getComputedStyle$1(n),m=(isCSSVariableName(a)?h.getPropertyValue(a):h[a])||0;return typeof m=="string"?m.trim():m}}measureInstanceViewportBox(n,{transformPagePoint:a}){return measureViewportBox(n,a)}build(n,a,h){buildHTMLStyles(n,a,h.transformTemplate)}scrapeMotionValuesFromProps(n,a,h){return scrapeMotionValuesFromProps$1(n,a,h)}}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(i,n,a,h){renderHTML(i,n,void 0,h);for(const m in n.attrs)i.setAttribute(camelCaseAttributes.has(m)?m:camelToDash(m),n.attrs[m])}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(n,a){return n[a]}readValueFromInstance(n,a){if(transformProps.has(a)){const h=getDefaultValueType(a);return h&&h.default||0}return a=camelCaseAttributes.has(a)?a:camelToDash(a),n.getAttribute(a)}scrapeMotionValuesFromProps(n,a,h){return scrapeMotionValuesFromProps(n,a,h)}build(n,a,h){buildSVGAttrs(n,a,this.isSVGTag,h.transformTemplate,h.style)}renderInstance(n,a,h,m){renderSVG(n,a,h,m)}mount(n){this.isSVGTag=isSVGTag(n.tagName),super.mount(n)}}const createDomVisualElement=(i,n)=>isSVGComponent(i)?new SVGVisualElement(n):new HTMLVisualElement(n,{allowProjection:i!==reactExports.Fragment});function resolveVariant(i,n,a){const h=i.getProps();return resolveVariantFromProps(h,n,a!==void 0?a:h.custom,i)}const isKeyframesTarget=i=>Array.isArray(i);function setMotionValue(i,n,a){i.hasValue(n)?i.getValue(n).set(a):i.addValue(n,motionValue(a))}function resolveFinalValueInKeyframes(i){return isKeyframesTarget(i)?i[i.length-1]||0:i}function setTarget(i,n){const a=resolveVariant(i,n);let{transitionEnd:h={},transition:m={},...z}=a||{};z={...z,...h};for(const u in z){const y=resolveFinalValueInKeyframes(z[u]);setMotionValue(i,u,y)}}function isWillChangeMotionValue(i){return!!(isMotionValue(i)&&i.add)}function addValueToWillChange(i,n){const a=i.getValue("willChange");if(isWillChangeMotionValue(a))return a.add(n);if(!a&&MotionGlobalConfig.WillChange){const h=new MotionGlobalConfig.WillChange("auto");i.addValue("willChange",h),h.add(n)}}function getOptimisedAppearId(i){return i.props[optimizedAppearDataAttribute]}const isNotNull=i=>i!==null;function getFinalKeyframe(i,{repeat:n,repeatType:a="loop"},h){const m=i.filter(isNotNull),z=n&&a!=="loop"&&n%2===1?0:m.length-1;return m[z]}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=i=>({type:"spring",stiffness:550,damping:i===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(i,{keyframes:n})=>n.length>2?keyframesTransition:transformProps.has(i)?i.startsWith("scale")?criticallyDampedSpring(n[1]):underDampedSpring:ease;function isTransitionDefined({when:i,delay:n,delayChildren:a,staggerChildren:h,staggerDirection:m,repeat:z,repeatType:u,repeatDelay:y,from:p,elapsed:w,...M}){return!!Object.keys(M).length}const animateMotionValue=(i,n,a,h={},m,z)=>u=>{const y=getValueTransition(h,i)||{},p=y.delay||h.delay||0;let{elapsed:w=0}=h;w=w-secondsToMilliseconds(p);const M={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:n.getVelocity(),...y,delay:-w,onUpdate:I=>{n.set(I),y.onUpdate&&y.onUpdate(I)},onComplete:()=>{u(),y.onComplete&&y.onComplete()},name:i,motionValue:n,element:z?void 0:m};isTransitionDefined(y)||Object.assign(M,getDefaultTransition(i,M)),M.duration&&(M.duration=secondsToMilliseconds(M.duration)),M.repeatDelay&&(M.repeatDelay=secondsToMilliseconds(M.repeatDelay)),M.from!==void 0&&(M.keyframes[0]=M.from);let b=!1;if((M.type===!1||M.duration===0&&!M.repeatDelay)&&(makeAnimationInstant(M),M.delay===0&&(b=!0)),(MotionGlobalConfig.instantAnimations||MotionGlobalConfig.skipAnimations)&&(b=!0,makeAnimationInstant(M),M.delay=0),M.allowFlatten=!y.type&&!y.ease,b&&!z&&n.get()!==void 0){const I=getFinalKeyframe(M.keyframes,y);if(I!==void 0){frame.update(()=>{M.onUpdate(I),M.onComplete()});return}}return y.isSync?new JSAnimation(M):new AsyncMotionValueAnimation(M)};function shouldBlockAnimation({protectedKeys:i,needsAnimating:n},a){const h=i.hasOwnProperty(a)&&n[a]!==!0;return n[a]=!1,h}function animateTarget(i,n,{delay:a=0,transitionOverride:h,type:m}={}){let{transition:z=i.getDefaultTransition(),transitionEnd:u,...y}=n;h&&(z=h);const p=[],w=m&&i.animationState&&i.animationState.getState()[m];for(const M in y){const b=i.getValue(M,i.latestValues[M]??null),I=y[M];if(I===void 0||w&&shouldBlockAnimation(w,M))continue;const O={delay:a,...getValueTransition(z||{},M)},T=b.get();if(T!==void 0&&!b.isAnimating&&!Array.isArray(I)&&I===T&&!O.velocity)continue;let L=!1;if(window.MotionHandoffAnimation){const ne=getOptimisedAppearId(i);if(ne){const Z=window.MotionHandoffAnimation(ne,M,frame);Z!==null&&(O.startTime=Z,L=!0)}}addValueToWillChange(i,M),b.start(animateMotionValue(M,b,I,i.shouldReduceMotion&&positionalKeys.has(M)?{type:!1}:O,i,L));const Q=b.animation;Q&&p.push(Q)}return u&&Promise.all(p).then(()=>{frame.update(()=>{u&&setTarget(i,u)})}),p}function calcChildStagger(i,n,a,h=0,m=1){const z=Array.from(i).sort((w,M)=>w.sortNodePosition(M)).indexOf(n),u=i.size,y=(u-1)*h;return typeof a=="function"?a(z,u):m===1?z*h:y-z*h}function animateVariant(i,n,a={}){const h=resolveVariant(i,n,a.type==="exit"?i.presenceContext?.custom:void 0);let{transition:m=i.getDefaultTransition()||{}}=h||{};a.transitionOverride&&(m=a.transitionOverride);const z=h?()=>Promise.all(animateTarget(i,h,a)):()=>Promise.resolve(),u=i.variantChildren&&i.variantChildren.size?(p=0)=>{const{delayChildren:w=0,staggerChildren:M,staggerDirection:b}=m;return animateChildren(i,n,p,w,M,b,a)}:()=>Promise.resolve(),{when:y}=m;if(y){const[p,w]=y==="beforeChildren"?[z,u]:[u,z];return p().then(()=>w())}else return Promise.all([z(),u(a.delay)])}function animateChildren(i,n,a=0,h=0,m=0,z=1,u){const y=[];for(const p of i.variantChildren)p.notify("AnimationStart",n),y.push(animateVariant(p,n,{...u,delay:a+(typeof h=="function"?0:h)+calcChildStagger(i.variantChildren,p,h,m,z)}).then(()=>p.notify("AnimationComplete",n)));return Promise.all(y)}function animateVisualElement(i,n,a={}){i.notify("AnimationStart",n);let h;if(Array.isArray(n)){const m=n.map(z=>animateVariant(i,z,a));h=Promise.all(m)}else if(typeof n=="string")h=animateVariant(i,n,a);else{const m=typeof n=="function"?resolveVariant(i,n,a.custom):n;h=Promise.all(animateTarget(i,m,a))}return h.then(()=>{i.notify("AnimationComplete",n)})}function shallowCompare(i,n){if(!Array.isArray(n))return!1;const a=n.length;if(a!==i.length)return!1;for(let h=0;h<a;h++)if(n[h]!==i[h])return!1;return!0}const numVariantProps=variantProps.length;function getVariantContext(i){if(!i)return;if(!i.isControllingVariants){const a=i.parent?getVariantContext(i.parent)||{}:{};return i.props.initial!==void 0&&(a.initial=i.props.initial),a}const n={};for(let a=0;a<numVariantProps;a++){const h=variantProps[a],m=i.props[h];(isVariantLabel(m)||m===!1)&&(n[h]=m)}return n}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(i){return n=>Promise.all(n.map(({animation:a,options:h})=>animateVisualElement(i,a,h)))}function createAnimationState(i){let n=animateList(i),a=createState(),h=!0;const m=p=>(w,M)=>{const b=resolveVariant(i,M,p==="exit"?i.presenceContext?.custom:void 0);if(b){const{transition:I,transitionEnd:O,...T}=b;w={...w,...T,...O}}return w};function z(p){n=p(i)}function u(p){const{props:w}=i,M=getVariantContext(i.parent)||{},b=[],I=new Set;let O={},T=1/0;for(let Q=0;Q<numAnimationTypes;Q++){const ne=reversePriorityOrder[Q],Z=a[ne],_=w[ne]!==void 0?w[ne]:M[ne],F=isVariantLabel(_),j=ne===p?Z.isActive:null;j===!1&&(T=Q);let G=_===M[ne]&&_!==w[ne]&&F;if(G&&h&&i.manuallyAnimateOnMount&&(G=!1),Z.protectedKeys={...O},!Z.isActive&&j===null||!_&&!Z.prevProp||isAnimationControls(_)||typeof _=="boolean")continue;const q=checkVariantsDidChange(Z.prevProp,_);let N=q||ne===p&&Z.isActive&&!G&&F||Q>T&&F,ee=!1;const Ce=Array.isArray(_)?_:[_];let he=Ce.reduce(m(ne),{});j===!1&&(he={});const{prevResolvedValues:ge={}}=Z,me={...ge,...he},Me=ce=>{N=!0,I.has(ce)&&(ee=!0,I.delete(ce)),Z.needsAnimating[ce]=!0;const se=i.getValue(ce);se&&(se.liveStyle=!1)};for(const ce in me){const se=he[ce],X=ge[ce];if(O.hasOwnProperty(ce))continue;let Re=!1;isKeyframesTarget(se)&&isKeyframesTarget(X)?Re=!shallowCompare(se,X):Re=se!==X,Re?se!=null?Me(ce):I.add(ce):se!==void 0&&I.has(ce)?Me(ce):Z.protectedKeys[ce]=!0}Z.prevProp=_,Z.prevResolvedValues=he,Z.isActive&&(O={...O,...he}),h&&i.blockInitialAnimation&&(N=!1);const ue=G&&q;N&&(!ue||ee)&&b.push(...Ce.map(ce=>{const se={type:ne};if(typeof ce=="string"&&h&&!ue&&i.manuallyAnimateOnMount&&i.parent){const{parent:X}=i,Re=resolveVariant(X,ce);if(X.enteringChildren&&Re){const{delayChildren:fe}=Re.transition||{};se.delay=calcChildStagger(X.enteringChildren,i,fe)}}return{animation:ce,options:se}}))}if(I.size){const Q={};if(typeof w.initial!="boolean"){const ne=resolveVariant(i,Array.isArray(w.initial)?w.initial[0]:w.initial);ne&&ne.transition&&(Q.transition=ne.transition)}I.forEach(ne=>{const Z=i.getBaseTarget(ne),_=i.getValue(ne);_&&(_.liveStyle=!0),Q[ne]=Z??null}),b.push({animation:Q})}let L=!!b.length;return h&&(w.initial===!1||w.initial===w.animate)&&!i.manuallyAnimateOnMount&&(L=!1),h=!1,L?n(b):Promise.resolve()}function y(p,w){if(a[p].isActive===w)return Promise.resolve();i.variantChildren?.forEach(b=>b.animationState?.setActive(p,w)),a[p].isActive=w;const M=u(p);for(const b in a)a[b].protectedKeys={};return M}return{animateChanges:u,setActive:y,setAnimateFunction:z,getState:()=>a,reset:()=>{a=createState()}}}function checkVariantsDidChange(i,n){return typeof n=="string"?n!==i:Array.isArray(n)?!shallowCompare(n,i):!1}function createTypeState(i=!1){return{isActive:i,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor(n){this.isMounted=!1,this.node=n}update(){}}class AnimationFeature extends Feature{constructor(n){super(n),n.animationState||(n.animationState=createAnimationState(n))}updateAnimationControlsSubscription(){const{animate:n}=this.node.getProps();isAnimationControls(n)&&(this.unmountControls=n.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:n}=this.node.getProps(),{animate:a}=this.node.prevProps||{};n!==a&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:n,onExitComplete:a}=this.node.presenceContext,{isPresent:h}=this.node.prevPresenceContext||{};if(!this.node.animationState||n===h)return;const m=this.node.animationState.setActive("exit",!n);a&&!n&&m.then(()=>{a(this.id)})}mount(){const{register:n,onExitComplete:a}=this.node.presenceContext||{};a&&a(this.id),n&&(this.unmount=n(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function addDomEvent(i,n,a,h={passive:!0}){return i.addEventListener(n,a,h),()=>i.removeEventListener(n,a)}function extractEventInfo(i){return{point:{x:i.pageX,y:i.pageY}}}const addPointerInfo=i=>n=>isPrimaryPointer(n)&&i(n,extractEventInfo(n));function addPointerEvent(i,n,a,h){return addDomEvent(i,n,addPointerInfo(a),h)}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(i){return i.max-i.min}function isNear(i,n,a){return Math.abs(i-n)<=a}function calcAxisDelta(i,n,a,h=.5){i.origin=h,i.originPoint=mixNumber$1(n.min,n.max,i.origin),i.scale=calcLength(a)/calcLength(n),i.translate=mixNumber$1(a.min,a.max,i.origin)-i.originPoint,(i.scale>=SCALE_MIN&&i.scale<=SCALE_MAX||isNaN(i.scale))&&(i.scale=1),(i.translate>=TRANSLATE_MIN&&i.translate<=TRANSLATE_MAX||isNaN(i.translate))&&(i.translate=0)}function calcBoxDelta(i,n,a,h){calcAxisDelta(i.x,n.x,a.x,h?h.originX:void 0),calcAxisDelta(i.y,n.y,a.y,h?h.originY:void 0)}function calcRelativeAxis(i,n,a){i.min=a.min+n.min,i.max=i.min+calcLength(n)}function calcRelativeBox(i,n,a){calcRelativeAxis(i.x,n.x,a.x),calcRelativeAxis(i.y,n.y,a.y)}function calcRelativeAxisPosition(i,n,a){i.min=n.min-a.min,i.max=i.min+calcLength(n)}function calcRelativePosition(i,n,a){calcRelativeAxisPosition(i.x,n.x,a.x),calcRelativeAxisPosition(i.y,n.y,a.y)}function eachAxis(i){return[i("x"),i("y")]}const getContextWindow=({current:i})=>i?i.ownerDocument.defaultView:null,distance=(i,n)=>Math.abs(i-n);function distance2D(i,n){const a=distance(i.x,n.x),h=distance(i.y,n.y);return Math.sqrt(a**2+h**2)}class PanSession{constructor(n,a,{transformPagePoint:h,contextWindow:m=window,dragSnapToOrigin:z=!1,distanceThreshold:u=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const I=getPanInfo(this.lastMoveEventInfo,this.history),O=this.startEvent!==null,T=distance2D(I.offset,{x:0,y:0})>=this.distanceThreshold;if(!O&&!T)return;const{point:L}=I,{timestamp:Q}=frameData;this.history.push({...L,timestamp:Q});const{onStart:ne,onMove:Z}=this.handlers;O||(ne&&ne(this.lastMoveEvent,I),this.startEvent=this.lastMoveEvent),Z&&Z(this.lastMoveEvent,I)},this.handlePointerMove=(I,O)=>{this.lastMoveEvent=I,this.lastMoveEventInfo=transformPoint(O,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(I,O)=>{this.end();const{onEnd:T,onSessionEnd:L,resumeAnimation:Q}=this.handlers;if(this.dragSnapToOrigin&&Q&&Q(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ne=getPanInfo(I.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(O,this.transformPagePoint),this.history);this.startEvent&&T&&T(I,ne),L&&L(I,ne)},!isPrimaryPointer(n))return;this.dragSnapToOrigin=z,this.handlers=a,this.transformPagePoint=h,this.distanceThreshold=u,this.contextWindow=m||window;const y=extractEventInfo(n),p=transformPoint(y,this.transformPagePoint),{point:w}=p,{timestamp:M}=frameData;this.history=[{...w,timestamp:M}];const{onSessionStart:b}=a;b&&b(n,getPanInfo(p,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(n){this.handlers=n}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(i,n){return n?{point:n(i.point)}:i}function subtractPoint(i,n){return{x:i.x-n.x,y:i.y-n.y}}function getPanInfo({point:i},n){return{point:i,delta:subtractPoint(i,lastDevicePoint(n)),offset:subtractPoint(i,startDevicePoint(n)),velocity:getVelocity(n,.1)}}function startDevicePoint(i){return i[0]}function lastDevicePoint(i){return i[i.length-1]}function getVelocity(i,n){if(i.length<2)return{x:0,y:0};let a=i.length-1,h=null;const m=lastDevicePoint(i);for(;a>=0&&(h=i[a],!(m.timestamp-h.timestamp>secondsToMilliseconds(n)));)a--;if(!h)return{x:0,y:0};const z=millisecondsToSeconds(m.timestamp-h.timestamp);if(z===0)return{x:0,y:0};const u={x:(m.x-h.x)/z,y:(m.y-h.y)/z};return u.x===1/0&&(u.x=0),u.y===1/0&&(u.y=0),u}function applyConstraints(i,{min:n,max:a},h){return n!==void 0&&i<n?i=h?mixNumber$1(n,i,h.min):Math.max(i,n):a!==void 0&&i>a&&(i=h?mixNumber$1(a,i,h.max):Math.min(i,a)),i}function calcRelativeAxisConstraints(i,n,a){return{min:n!==void 0?i.min+n:void 0,max:a!==void 0?i.max+a-(i.max-i.min):void 0}}function calcRelativeConstraints(i,{top:n,left:a,bottom:h,right:m}){return{x:calcRelativeAxisConstraints(i.x,a,m),y:calcRelativeAxisConstraints(i.y,n,h)}}function calcViewportAxisConstraints(i,n){let a=n.min-i.min,h=n.max-i.max;return n.max-n.min<i.max-i.min&&([a,h]=[h,a]),{min:a,max:h}}function calcViewportConstraints(i,n){return{x:calcViewportAxisConstraints(i.x,n.x),y:calcViewportAxisConstraints(i.y,n.y)}}function calcOrigin(i,n){let a=.5;const h=calcLength(i),m=calcLength(n);return m>h?a=progress(n.min,n.max-h,i.min):h>m&&(a=progress(i.min,i.max-m,n.min)),clamp(0,1,a)}function rebaseAxisConstraints(i,n){const a={};return n.min!==void 0&&(a.min=n.min-i.min),n.max!==void 0&&(a.max=n.max-i.min),a}const defaultElastic=.35;function resolveDragElastic(i=defaultElastic){return i===!1?i=0:i===!0&&(i=defaultElastic),{x:resolveAxisElastic(i,"left","right"),y:resolveAxisElastic(i,"top","bottom")}}function resolveAxisElastic(i,n,a){return{min:resolvePointElastic(i,n),max:resolvePointElastic(i,a)}}function resolvePointElastic(i,n){return typeof i=="number"?i:i[n]||0}const elementDragControls=new WeakMap;class VisualElementDragControls{constructor(n){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=n}start(n,{snapToCursor:a=!1,distanceThreshold:h}={}){const{presenceContext:m}=this.visualElement;if(m&&m.isPresent===!1)return;const z=b=>{const{dragSnapToOrigin:I}=this.getProps();I?this.pauseAnimation():this.stopAnimation(),a&&this.snapToCursor(extractEventInfo(b).point)},u=(b,I)=>{const{drag:O,dragPropagation:T,onDragStart:L}=this.getProps();if(O&&!T&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(O),!this.openDragLock))return;this.latestPointerEvent=b,this.latestPanInfo=I,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(ne=>{let Z=this.getAxisMotionValue(ne).get()||0;if(percent.test(Z)){const{projection:_}=this.visualElement;if(_&&_.layout){const F=_.layout.layoutBox[ne];F&&(Z=calcLength(F)*(parseFloat(Z)/100))}}this.originPoint[ne]=Z}),L&&frame.postRender(()=>L(b,I)),addValueToWillChange(this.visualElement,"transform");const{animationState:Q}=this.visualElement;Q&&Q.setActive("whileDrag",!0)},y=(b,I)=>{this.latestPointerEvent=b,this.latestPanInfo=I;const{dragPropagation:O,dragDirectionLock:T,onDirectionLock:L,onDrag:Q}=this.getProps();if(!O&&!this.openDragLock)return;const{offset:ne}=I;if(T&&this.currentDirection===null){this.currentDirection=getCurrentDirection(ne),this.currentDirection!==null&&L&&L(this.currentDirection);return}this.updateAxis("x",I.point,ne),this.updateAxis("y",I.point,ne),this.visualElement.render(),Q&&Q(b,I)},p=(b,I)=>{this.latestPointerEvent=b,this.latestPanInfo=I,this.stop(b,I),this.latestPointerEvent=null,this.latestPanInfo=null},w=()=>eachAxis(b=>this.getAnimationState(b)==="paused"&&this.getAxisMotionValue(b).animation?.play()),{dragSnapToOrigin:M}=this.getProps();this.panSession=new PanSession(n,{onSessionStart:z,onStart:u,onMove:y,onSessionEnd:p,resumeAnimation:w},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:M,distanceThreshold:h,contextWindow:getContextWindow(this.visualElement)})}stop(n,a){const h=n||this.latestPointerEvent,m=a||this.latestPanInfo,z=this.isDragging;if(this.cancel(),!z||!m||!h)return;const{velocity:u}=m;this.startAnimation(u);const{onDragEnd:y}=this.getProps();y&&frame.postRender(()=>y(h,m))}cancel(){this.isDragging=!1;const{projection:n,animationState:a}=this.visualElement;n&&(n.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:h}=this.getProps();!h&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(n,a,h){const{drag:m}=this.getProps();if(!h||!shouldDrag(n,m,this.currentDirection))return;const z=this.getAxisMotionValue(n);let u=this.originPoint[n]+h[n];this.constraints&&this.constraints[n]&&(u=applyConstraints(u,this.constraints[n],this.elastic[n])),z.set(u)}resolveConstraints(){const{dragConstraints:n,dragElastic:a}=this.getProps(),h=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,m=this.constraints;n&&isRefObject(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&h?this.constraints=calcRelativeConstraints(h.layoutBox,n):this.constraints=!1,this.elastic=resolveDragElastic(a),m!==this.constraints&&h&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(z=>{this.constraints!==!1&&this.getAxisMotionValue(z)&&(this.constraints[z]=rebaseAxisConstraints(h.layoutBox[z],this.constraints[z]))})}resolveRefConstraints(){const{dragConstraints:n,onMeasureDragConstraints:a}=this.getProps();if(!n||!isRefObject(n))return!1;const h=n.current,{projection:m}=this.visualElement;if(!m||!m.layout)return!1;const z=measurePageBox(h,m.root,this.visualElement.getTransformPagePoint());let u=calcViewportConstraints(m.layout.layoutBox,z);if(a){const y=a(convertBoxToBoundingBox(u));this.hasMutatedConstraints=!!y,y&&(u=convertBoundingBoxToBox(y))}return u}startAnimation(n){const{drag:a,dragMomentum:h,dragElastic:m,dragTransition:z,dragSnapToOrigin:u,onDragTransitionEnd:y}=this.getProps(),p=this.constraints||{},w=eachAxis(M=>{if(!shouldDrag(M,a,this.currentDirection))return;let b=p&&p[M]||{};u&&(b={min:0,max:0});const I=m?200:1e6,O=m?40:1e7,T={type:"inertia",velocity:h?n[M]:0,bounceStiffness:I,bounceDamping:O,timeConstant:750,restDelta:1,restSpeed:10,...z,...b};return this.startAxisValueAnimation(M,T)});return Promise.all(w).then(y)}startAxisValueAnimation(n,a){const h=this.getAxisMotionValue(n);return addValueToWillChange(this.visualElement,n),h.start(animateMotionValue(n,h,0,a,this.visualElement,!1))}stopAnimation(){eachAxis(n=>this.getAxisMotionValue(n).stop())}pauseAnimation(){eachAxis(n=>this.getAxisMotionValue(n).animation?.pause())}getAnimationState(n){return this.getAxisMotionValue(n).animation?.state}getAxisMotionValue(n){const a=`_drag${n.toUpperCase()}`,h=this.visualElement.getProps(),m=h[a];return m||this.visualElement.getValue(n,(h.initial?h.initial[n]:void 0)||0)}snapToCursor(n){eachAxis(a=>{const{drag:h}=this.getProps();if(!shouldDrag(a,h,this.currentDirection))return;const{projection:m}=this.visualElement,z=this.getAxisMotionValue(a);if(m&&m.layout){const{min:u,max:y}=m.layout.layoutBox[a];z.set(n[a]-mixNumber$1(u,y,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:n,dragConstraints:a}=this.getProps(),{projection:h}=this.visualElement;if(!isRefObject(a)||!h||!this.constraints)return;this.stopAnimation();const m={x:0,y:0};eachAxis(u=>{const y=this.getAxisMotionValue(u);if(y&&this.constraints!==!1){const p=y.get();m[u]=calcOrigin({min:p,max:p},this.constraints[u])}});const{transformTemplate:z}=this.visualElement.getProps();this.visualElement.current.style.transform=z?z({},""):"none",h.root&&h.root.updateScroll(),h.updateLayout(),this.resolveConstraints(),eachAxis(u=>{if(!shouldDrag(u,n,null))return;const y=this.getAxisMotionValue(u),{min:p,max:w}=this.constraints[u];y.set(mixNumber$1(p,w,m[u]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const n=this.visualElement.current,a=addPointerEvent(n,"pointerdown",p=>{const{drag:w,dragListener:M=!0}=this.getProps();w&&M&&this.start(p)}),h=()=>{const{dragConstraints:p}=this.getProps();isRefObject(p)&&p.current&&(this.constraints=this.resolveRefConstraints())},{projection:m}=this.visualElement,z=m.addEventListener("measure",h);m&&!m.layout&&(m.root&&m.root.updateScroll(),m.updateLayout()),frame.read(h);const u=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),y=m.addEventListener("didUpdate",(({delta:p,hasLayoutChanged:w})=>{this.isDragging&&w&&(eachAxis(M=>{const b=this.getAxisMotionValue(M);b&&(this.originPoint[M]+=p[M].translate,b.set(b.get()+p[M].translate))}),this.visualElement.render())}));return()=>{u(),a(),z(),y&&y()}}getProps(){const n=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:h=!1,dragPropagation:m=!1,dragConstraints:z=!1,dragElastic:u=defaultElastic,dragMomentum:y=!0}=n;return{...n,drag:a,dragDirectionLock:h,dragPropagation:m,dragConstraints:z,dragElastic:u,dragMomentum:y}}}function shouldDrag(i,n,a){return(n===!0||n===i)&&(a===null||a===i)}function getCurrentDirection(i,n=10){let a=null;return Math.abs(i.y)>n?a="y":Math.abs(i.x)>n&&(a="x"),a}class DragGesture extends Feature{constructor(n){super(n),this.removeGroupControls=noop,this.removeListeners=noop,this.controls=new VisualElementDragControls(n)}mount(){const{dragControls:n}=this.node.getProps();n&&(this.removeGroupControls=n.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=i=>(n,a)=>{i&&frame.postRender(()=>i(n,a))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop}onPointerDown(n){this.session=new PanSession(n,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:n,onPanStart:a,onPan:h,onPanEnd:m}=this.node.getProps();return{onSessionStart:asyncHandler(n),onStart:asyncHandler(a),onMove:h,onEnd:(z,u)=>{delete this.session,m&&frame.postRender(()=>m(z,u))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",n=>this.onPointerDown(n))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(i,n){return n.max===n.min?0:i/(n.max-n.min)*100}const correctBorderRadius={correct:(i,n)=>{if(!n.target)return i;if(typeof i=="string")if(px.test(i))i=parseFloat(i);else return i;const a=pixelsToPercent(i,n.target.x),h=pixelsToPercent(i,n.target.y);return`${a}% ${h}%`}},correctBoxShadow={correct:(i,{treeScale:n,projectionDelta:a})=>{const h=i,m=complex.parse(i);if(m.length>5)return h;const z=complex.createTransformer(i),u=typeof m[0]!="number"?1:0,y=a.x.scale*n.x,p=a.y.scale*n.y;m[0+u]/=y,m[1+u]/=p;const w=mixNumber$1(y,p,.5);return typeof m[2+u]=="number"&&(m[2+u]/=w),typeof m[3+u]=="number"&&(m[3+u]/=w),z(m)}};let hasTakenAnySnapshot=!1;class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:n,layoutGroup:a,switchLayoutGroup:h,layoutId:m}=this.props,{projection:z}=n;addScaleCorrector(defaultScaleCorrectors),z&&(a.group&&a.group.add(z),h&&h.register&&m&&h.register(z),hasTakenAnySnapshot&&z.root.didUpdate(),z.addEventListener("animationComplete",()=>{this.safeToRemove()}),z.setOptions({...z.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(n){const{layoutDependency:a,visualElement:h,drag:m,isPresent:z}=this.props,{projection:u}=h;return u&&(u.isPresent=z,hasTakenAnySnapshot=!0,m||n.layoutDependency!==a||a===void 0||n.isPresent!==z?u.willUpdate():this.safeToRemove(),n.isPresent!==z&&(z?u.promote():u.relegate()||frame.postRender(()=>{const y=u.getStack();(!y||!y.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:n}=this.props.visualElement;n&&(n.root.didUpdate(),microtask.postRender(()=>{!n.currentAnimation&&n.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:n,layoutGroup:a,switchLayoutGroup:h}=this.props,{projection:m}=n;hasTakenAnySnapshot=!0,m&&(m.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(m),h&&h.deregister&&h.deregister(m))}safeToRemove(){const{safeToRemove:n}=this.props;n&&n()}render(){return null}}function MeasureLayout(i){const[n,a]=usePresence(),h=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...i,layoutGroup:h,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:n,safeToRemove:a})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function animateSingleValue(i,n,a){const h=isMotionValue(i)?i:motionValue(i);return h.start(animateMotionValue("",h,n,a)),h.animation}const compareByDepth=(i,n)=>i.depth-n.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(n){addUniqueItem(this.children,n),this.isDirty=!0}remove(n){removeItem(this.children,n),this.isDirty=!0}forEach(n){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(n)}}function delay(i,n){const a=time.now(),h=({timestamp:m})=>{const z=m-a;z>=n&&(cancelFrame(h),i(z-n))};return frame.setup(h,!0),()=>cancelFrame(h)}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=i=>typeof i=="string"?parseFloat(i):i,isPx=i=>typeof i=="number"||px.test(i);function mixValues(i,n,a,h,m,z){m?(i.opacity=mixNumber$1(0,a.opacity??1,easeCrossfadeIn(h)),i.opacityExit=mixNumber$1(n.opacity??1,0,easeCrossfadeOut(h))):z&&(i.opacity=mixNumber$1(n.opacity??1,a.opacity??1,h));for(let u=0;u<numBorders;u++){const y=`border${borders[u]}Radius`;let p=getRadius(n,y),w=getRadius(a,y);if(p===void 0&&w===void 0)continue;p||(p=0),w||(w=0),p===0||w===0||isPx(p)===isPx(w)?(i[y]=Math.max(mixNumber$1(asNumber(p),asNumber(w),h),0),(percent.test(w)||percent.test(p))&&(i[y]+="%")):i[y]=w}(n.rotate||a.rotate)&&(i.rotate=mixNumber$1(n.rotate||0,a.rotate||0,h))}function getRadius(i,n){return i[n]!==void 0?i[n]:i.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop);function compress(i,n,a){return h=>h<i?0:h>n?1:a(progress(i,n,h))}function copyAxisInto(i,n){i.min=n.min,i.max=n.max}function copyBoxInto(i,n){copyAxisInto(i.x,n.x),copyAxisInto(i.y,n.y)}function copyAxisDeltaInto(i,n){i.translate=n.translate,i.scale=n.scale,i.originPoint=n.originPoint,i.origin=n.origin}function removePointDelta(i,n,a,h,m){return i-=n,i=scalePoint(i,1/a,h),m!==void 0&&(i=scalePoint(i,1/m,h)),i}function removeAxisDelta(i,n=0,a=1,h=.5,m,z=i,u=i){if(percent.test(n)&&(n=parseFloat(n),n=mixNumber$1(u.min,u.max,n/100)-u.min),typeof n!="number")return;let y=mixNumber$1(z.min,z.max,h);i===z&&(y-=n),i.min=removePointDelta(i.min,n,a,y,m),i.max=removePointDelta(i.max,n,a,y,m)}function removeAxisTransforms(i,n,[a,h,m],z,u){removeAxisDelta(i,n[a],n[h],n[m],n.scale,z,u)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(i,n,a,h){removeAxisTransforms(i.x,n,xKeys,a?a.x:void 0,h?h.x:void 0),removeAxisTransforms(i.y,n,yKeys,a?a.y:void 0,h?h.y:void 0)}function isAxisDeltaZero(i){return i.translate===0&&i.scale===1}function isDeltaZero(i){return isAxisDeltaZero(i.x)&&isAxisDeltaZero(i.y)}function axisEquals(i,n){return i.min===n.min&&i.max===n.max}function boxEquals(i,n){return axisEquals(i.x,n.x)&&axisEquals(i.y,n.y)}function axisEqualsRounded(i,n){return Math.round(i.min)===Math.round(n.min)&&Math.round(i.max)===Math.round(n.max)}function boxEqualsRounded(i,n){return axisEqualsRounded(i.x,n.x)&&axisEqualsRounded(i.y,n.y)}function aspectRatio(i){return calcLength(i.x)/calcLength(i.y)}function axisDeltaEquals(i,n){return i.translate===n.translate&&i.scale===n.scale&&i.originPoint===n.originPoint}class NodeStack{constructor(){this.members=[]}add(n){addUniqueItem(this.members,n),n.scheduleRender()}remove(n){if(removeItem(this.members,n),n===this.prevLead&&(this.prevLead=void 0),n===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(n){const a=this.members.findIndex(m=>n===m);if(a===0)return!1;let h;for(let m=a;m>=0;m--){const z=this.members[m];if(z.isPresent!==!1){h=z;break}}return h?(this.promote(h),!0):!1}promote(n,a){const h=this.lead;if(n!==h&&(this.prevLead=h,this.lead=n,n.show(),h)){h.instance&&h.scheduleRender(),n.scheduleRender(),n.resumeFrom=h,a&&(n.resumeFrom.preserveOpacity=!0),h.snapshot&&(n.snapshot=h.snapshot,n.snapshot.latestValues=h.animationValues||h.latestValues),n.root&&n.root.isUpdating&&(n.isLayoutDirty=!0);const{crossfade:m}=n.options;m===!1&&h.hide()}}exitAnimationComplete(){this.members.forEach(n=>{const{options:a,resumingFrom:h}=n;a.onExitComplete&&a.onExitComplete(),h&&h.options.onExitComplete&&h.options.onExitComplete()})}scheduleRender(){this.members.forEach(n=>{n.instance&&n.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(i,n,a){let h="";const m=i.x.translate/n.x,z=i.y.translate/n.y,u=a?.z||0;if((m||z||u)&&(h=`translate3d(${m}px, ${z}px, ${u}px) `),(n.x!==1||n.y!==1)&&(h+=`scale(${1/n.x}, ${1/n.y}) `),a){const{transformPerspective:w,rotate:M,rotateX:b,rotateY:I,skewX:O,skewY:T}=a;w&&(h=`perspective(${w}px) ${h}`),M&&(h+=`rotate(${M}deg) `),b&&(h+=`rotateX(${b}deg) `),I&&(h+=`rotateY(${I}deg) `),O&&(h+=`skewX(${O}deg) `),T&&(h+=`skewY(${T}deg) `)}const y=i.x.scale*n.x,p=i.y.scale*n.y;return(y!==1||p!==1)&&(h+=`scale(${y}, ${p})`),h||"none"}const transformAxes=["","X","Y","Z"],animationTarget=1e3;let id=0;function resetDistortingTransform(i,n,a,h){const{latestValues:m}=n;m[i]&&(a[i]=m[i],n.setStaticValue(i,0),h&&(h[i]=0))}function cancelTreeOptimisedTransformAnimations(i){if(i.hasCheckedOptimisedAppear=!0,i.root===i)return;const{visualElement:n}=i.options;if(!n)return;const a=getOptimisedAppearId(n);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:m,layoutId:z}=i.options;window.MotionCancelOptimisedAnimation(a,"transform",frame,!(m||z))}const{parent:h}=i;h&&!h.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(h)}function createProjectionNode({attachResizeListener:i,defaultParent:n,measureScroll:a,checkIsScrollRoot:h,resetTransform:m}){return class{constructor(u={},y=n?.()){this.id=id++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=u,this.root=y?y.root||y:this,this.path=y?[...y.path,y]:[],this.parent=y,this.depth=y?y.depth+1:0;for(let p=0;p<this.path.length;p++)this.path[p].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(u,y){return this.eventHandlers.has(u)||this.eventHandlers.set(u,new SubscriptionManager),this.eventHandlers.get(u).add(y)}notifyListeners(u,...y){const p=this.eventHandlers.get(u);p&&p.notify(...y)}hasListeners(u){return this.eventHandlers.has(u)}mount(u){if(this.instance)return;this.isSVG=isSVGElement(u)&&!isSVGSVGElement(u),this.instance=u;const{layoutId:y,layout:p,visualElement:w}=this.options;if(w&&!w.current&&w.mount(u),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(p||y)&&(this.isLayoutDirty=!0),i){let M,b=0;const I=()=>this.root.updateBlockedByResize=!1;frame.read(()=>{b=window.innerWidth}),i(u,()=>{const O=window.innerWidth;O!==b&&(b=O,this.root.updateBlockedByResize=!0,M&&M(),M=delay(I,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation)))})}y&&this.root.registerSharedNode(y,this),this.options.animate!==!1&&w&&(y||p)&&this.addEventListener("didUpdate",({delta:M,hasLayoutChanged:b,hasRelativeLayoutChanged:I,layout:O})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const T=this.options.transition||w.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:L,onLayoutAnimationComplete:Q}=w.getProps(),ne=!this.targetLayout||!boxEqualsRounded(this.targetLayout,O),Z=!b&&I;if(this.options.layoutRoot||this.resumeFrom||Z||b&&(ne||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const _={...getValueTransition(T,"layout"),onPlay:L,onComplete:Q};(w.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_),this.setAnimationOrigin(M,Z)}else b||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=O})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const u=this.getStack();u&&u.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:u}=this.options;return u&&u.getProps().transformTemplate}willUpdate(u=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let M=0;M<this.path.length;M++){const b=this.path[M];b.shouldResetTransform=!0,b.updateScroll("snapshot"),b.options.layoutRoot&&b.willUpdate(!1)}const{layoutId:y,layout:p}=this.options;if(y===void 0&&!p)return;const w=this.getTransformTemplate();this.prevTransformTemplateValue=w?w(this.latestValues,""):void 0,this.updateSnapshot(),u&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(clearIsLayoutDirty);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate)):this.nodes.forEach(clearIsLayoutDirty),this.clearAllSnapshots();const y=time.now();frameData.delta=clamp(0,1e3/60,y-frameData.timestamp),frameData.timestamp=y,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!calcLength(this.snapshot.measuredBox.x)&&!calcLength(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let p=0;p<this.path.length;p++)this.path[p].updateScroll();const u=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:y}=this.options;y&&y.notify("LayoutMeasure",this.layout.layoutBox,u?u.layoutBox:void 0)}updateScroll(u="measure"){let y=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===u&&(y=!1),y&&this.instance){const p=h(this.instance);this.scroll={animationId:this.root.animationId,phase:u,isRoot:p,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:p}}}resetTransform(){if(!m)return;const u=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,y=this.projectionDelta&&!isDeltaZero(this.projectionDelta),p=this.getTransformTemplate(),w=p?p(this.latestValues,""):void 0,M=w!==this.prevTransformTemplateValue;u&&this.instance&&(y||hasTransform(this.latestValues)||M)&&(m(this.instance,w),this.shouldResetTransform=!1,this.scheduleRender())}measure(u=!0){const y=this.measurePageBox();let p=this.removeElementScroll(y);return u&&(p=this.removeTransform(p)),roundBox(p),{animationId:this.root.animationId,measuredBox:y,layoutBox:p,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:u}=this.options;if(!u)return createBox();const y=u.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(checkNodeWasScrollRoot))){const{scroll:w}=this.root;w&&(translateAxis(y.x,w.offset.x),translateAxis(y.y,w.offset.y))}return y}removeElementScroll(u){const y=createBox();if(copyBoxInto(y,u),this.scroll?.wasRoot)return y;for(let p=0;p<this.path.length;p++){const w=this.path[p],{scroll:M,options:b}=w;w!==this.root&&M&&b.layoutScroll&&(M.wasRoot&&copyBoxInto(y,u),translateAxis(y.x,M.offset.x),translateAxis(y.y,M.offset.y))}return y}applyTransform(u,y=!1){const p=createBox();copyBoxInto(p,u);for(let w=0;w<this.path.length;w++){const M=this.path[w];!y&&M.options.layoutScroll&&M.scroll&&M!==M.root&&transformBox(p,{x:-M.scroll.offset.x,y:-M.scroll.offset.y}),hasTransform(M.latestValues)&&transformBox(p,M.latestValues)}return hasTransform(this.latestValues)&&transformBox(p,this.latestValues),p}removeTransform(u){const y=createBox();copyBoxInto(y,u);for(let p=0;p<this.path.length;p++){const w=this.path[p];if(!w.instance||!hasTransform(w.latestValues))continue;hasScale(w.latestValues)&&w.updateSnapshot();const M=createBox(),b=w.measurePageBox();copyBoxInto(M,b),removeBoxTransforms(y,w.latestValues,w.snapshot?w.snapshot.layoutBox:void 0,M)}return hasTransform(this.latestValues)&&removeBoxTransforms(y,this.latestValues),y}setTargetDelta(u){this.targetDelta=u,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(u){this.options={...this.options,...u,crossfade:u.crossfade!==void 0?u.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(u=!1){const y=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=y.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=y.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=y.isSharedProjectionDirty);const p=!!this.resumingFrom||this!==y;if(!(u||p&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:M,layoutId:b}=this.options;if(!(!this.layout||!(M||b))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const I=this.getClosestProjectingParent();I&&I.layout&&this.animationProgress!==1?(this.relativeParent=I,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,I.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const I=this.getClosestProjectingParent();I&&!!I.resumingFrom==!!this.resumingFrom&&!I.options.layoutScroll&&I.target&&this.animationProgress!==1?(this.relativeParent=I,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,I.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const u=this.getLead(),y=!!this.resumingFrom||this!==u;let p=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(p=!1),y&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(p=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(p=!1),p)return;const{layout:w,layoutId:M}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(w||M))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const b=this.treeScale.x,I=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,y),u.layout&&!u.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(u.target=u.layout.layoutBox,u.targetWithTransforms=createBox());const{target:O}=u;if(!O){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,O,this.latestValues),(this.treeScale.x!==b||this.treeScale.y!==I||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",O))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(u=!0){if(this.options.visualElement?.scheduleRender(),u){const y=this.getStack();y&&y.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(u,y=!1){const p=this.snapshot,w=p?p.latestValues:{},M={...this.latestValues},b=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!y;const I=createBox(),O=p?p.source:void 0,T=this.layout?this.layout.source:void 0,L=O!==T,Q=this.getStack(),ne=!Q||Q.members.length<=1,Z=!!(L&&!ne&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let _;this.mixTargetDelta=F=>{const j=F/1e3;mixAxisDelta(b.x,u.x,j),mixAxisDelta(b.y,u.y,j),this.setTargetDelta(b),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(I,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,I,j),_&&boxEquals(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=createBox()),copyBoxInto(_,this.relativeTarget)),L&&(this.animationValues=M,mixValues(M,w,this.latestValues,j,Z,ne)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=j},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(u){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=motionValue(0)),this.currentAnimation=animateSingleValue(this.motionValue,[0,1e3],{...u,velocity:0,isSync:!0,onUpdate:y=>{this.mixTargetDelta(y),u.onUpdate&&u.onUpdate(y)},onStop:()=>{},onComplete:()=>{u.onComplete&&u.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const u=this.getStack();u&&u.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const u=this.getLead();let{targetWithTransforms:y,target:p,layout:w,latestValues:M}=u;if(!(!y||!p||!w)){if(this!==u&&this.layout&&w&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,w.layoutBox)){p=this.target||createBox();const b=calcLength(this.layout.layoutBox.x);p.x.min=u.target.x.min,p.x.max=p.x.min+b;const I=calcLength(this.layout.layoutBox.y);p.y.min=u.target.y.min,p.y.max=p.y.min+I}copyBoxInto(y,p),transformBox(y,M),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,y,M)}}registerSharedNode(u,y){this.sharedNodes.has(u)||this.sharedNodes.set(u,new NodeStack),this.sharedNodes.get(u).add(y);const w=y.options.initialPromotionConfig;y.promote({transition:w?w.transition:void 0,preserveFollowOpacity:w&&w.shouldPreserveFollowOpacity?w.shouldPreserveFollowOpacity(y):void 0})}isLead(){const u=this.getStack();return u?u.lead===this:!0}getLead(){const{layoutId:u}=this.options;return u?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:u}=this.options;return u?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:u}=this.options;if(u)return this.root.sharedNodes.get(u)}promote({needsReset:u,transition:y,preserveFollowOpacity:p}={}){const w=this.getStack();w&&w.promote(this,p),u&&(this.projectionDelta=void 0,this.needsReset=!0),y&&this.setOptions({transition:y})}relegate(){const u=this.getStack();return u?u.relegate(this):!1}resetSkewAndRotation(){const{visualElement:u}=this.options;if(!u)return;let y=!1;const{latestValues:p}=u;if((p.z||p.rotate||p.rotateX||p.rotateY||p.rotateZ||p.skewX||p.skewY)&&(y=!0),!y)return;const w={};p.z&&resetDistortingTransform("z",u,w,this.animationValues);for(let M=0;M<transformAxes.length;M++)resetDistortingTransform(`rotate${transformAxes[M]}`,u,w,this.animationValues),resetDistortingTransform(`skew${transformAxes[M]}`,u,w,this.animationValues);u.render();for(const M in w)u.setStaticValue(M,w[M]),this.animationValues&&(this.animationValues[M]=w[M]);u.scheduleRender()}applyProjectionStyles(u,y){if(!this.instance||this.isSVG)return;if(!this.isVisible){u.visibility="hidden";return}const p=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,u.visibility="",u.opacity="",u.pointerEvents=resolveMotionValue(y?.pointerEvents)||"",u.transform=p?p(this.latestValues,""):"none";return}const w=this.getLead();if(!this.projectionDelta||!this.layout||!w.target){this.options.layoutId&&(u.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,u.pointerEvents=resolveMotionValue(y?.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(u.transform=p?p({},""):"none",this.hasProjected=!1);return}u.visibility="";const M=w.animationValues||w.latestValues;this.applyTransformsToTarget();let b=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,M);p&&(b=p(M,b)),u.transform=b;const{x:I,y:O}=this.projectionDelta;u.transformOrigin=`${I.origin*100}% ${O.origin*100}% 0`,w.animationValues?u.opacity=w===this?M.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:M.opacityExit:u.opacity=w===this?M.opacity!==void 0?M.opacity:"":M.opacityExit!==void 0?M.opacityExit:0;for(const T in scaleCorrectors){if(M[T]===void 0)continue;const{correct:L,applyTo:Q,isCSSVariable:ne}=scaleCorrectors[T],Z=b==="none"?M[T]:L(M[T],w);if(Q){const _=Q.length;for(let F=0;F<_;F++)u[Q[F]]=Z}else ne?this.options.visualElement.renderState.vars[T]=Z:u[T]=Z}this.options.layoutId&&(u.pointerEvents=w===this?resolveMotionValue(y?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(u=>u.currentAnimation?.stop()),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(i){i.updateLayout()}function notifyLayoutUpdate(i){const n=i.resumeFrom?.snapshot||i.snapshot;if(i.isLead()&&i.layout&&n&&i.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:h}=i.layout,{animationType:m}=i.options,z=n.source!==i.layout.source;m==="size"?eachAxis(M=>{const b=z?n.measuredBox[M]:n.layoutBox[M],I=calcLength(b);b.min=a[M].min,b.max=b.min+I}):shouldAnimatePositionOnly(m,n.layoutBox,a)&&eachAxis(M=>{const b=z?n.measuredBox[M]:n.layoutBox[M],I=calcLength(a[M]);b.max=b.min+I,i.relativeTarget&&!i.currentAnimation&&(i.isProjectionDirty=!0,i.relativeTarget[M].max=i.relativeTarget[M].min+I)});const u=createDelta();calcBoxDelta(u,a,n.layoutBox);const y=createDelta();z?calcBoxDelta(y,i.applyTransform(h,!0),n.measuredBox):calcBoxDelta(y,a,n.layoutBox);const p=!isDeltaZero(u);let w=!1;if(!i.resumeFrom){const M=i.getClosestProjectingParent();if(M&&!M.resumeFrom){const{snapshot:b,layout:I}=M;if(b&&I){const O=createBox();calcRelativePosition(O,n.layoutBox,b.layoutBox);const T=createBox();calcRelativePosition(T,a,I.layoutBox),boxEqualsRounded(O,T)||(w=!0),M.options.layoutRoot&&(i.relativeTarget=T,i.relativeTargetOrigin=O,i.relativeParent=M)}}}i.notifyListeners("didUpdate",{layout:a,snapshot:n,delta:y,layoutDelta:u,hasLayoutChanged:p,hasRelativeLayoutChanged:w})}else if(i.isLead()){const{onExitComplete:a}=i.options;a&&a()}i.options.transition=void 0}function propagateDirtyNodes(i){i.parent&&(i.isProjecting()||(i.isProjectionDirty=i.parent.isProjectionDirty),i.isSharedProjectionDirty||(i.isSharedProjectionDirty=!!(i.isProjectionDirty||i.parent.isProjectionDirty||i.parent.isSharedProjectionDirty)),i.isTransformDirty||(i.isTransformDirty=i.parent.isTransformDirty))}function cleanDirtyNodes(i){i.isProjectionDirty=i.isSharedProjectionDirty=i.isTransformDirty=!1}function clearSnapshot(i){i.clearSnapshot()}function clearMeasurements(i){i.clearMeasurements()}function clearIsLayoutDirty(i){i.isLayoutDirty=!1}function resetTransformStyle(i){const{visualElement:n}=i.options;n&&n.getProps().onBeforeLayoutMeasure&&n.notify("BeforeLayoutMeasure"),i.resetTransform()}function finishAnimation(i){i.finishAnimation(),i.targetDelta=i.relativeTarget=i.target=void 0,i.isProjectionDirty=!0}function resolveTargetDelta(i){i.resolveTargetDelta()}function calcProjection(i){i.calcProjection()}function resetSkewAndRotation(i){i.resetSkewAndRotation()}function removeLeadSnapshots(i){i.removeLeadSnapshot()}function mixAxisDelta(i,n,a){i.translate=mixNumber$1(n.translate,0,a),i.scale=mixNumber$1(n.scale,1,a),i.origin=n.origin,i.originPoint=n.originPoint}function mixAxis(i,n,a,h){i.min=mixNumber$1(n.min,a.min,h),i.max=mixNumber$1(n.max,a.max,h)}function mixBox(i,n,a,h){mixAxis(i.x,n.x,a.x,h),mixAxis(i.y,n.y,a.y,h)}function hasOpacityCrossfade(i){return i.animationValues&&i.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=i=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(i),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop;function roundAxis(i){i.min=roundPoint(i.min),i.max=roundPoint(i.max)}function roundBox(i){roundAxis(i.x),roundAxis(i.y)}function shouldAnimatePositionOnly(i,n,a){return i==="position"||i==="preserve-aspect"&&!isNear(aspectRatio(n),aspectRatio(a),.2)}function checkNodeWasScrollRoot(i){return i!==i.root&&i.scroll?.wasRoot}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(i,n)=>addDomEvent(i,"resize",n),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:i=>({x:i.scrollLeft,y:i.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const i=new DocumentProjectionNode({});i.mount(window),i.setOptions({layoutScroll:!0}),rootProjectionNode.current=i}return rootProjectionNode.current},resetTransform:(i,n)=>{i.style.transform=n!==void 0?n:"none"},checkIsScrollRoot:i=>window.getComputedStyle(i).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(i,n,a){const{props:h}=i;i.animationState&&h.whileHover&&i.animationState.setActive("whileHover",a==="Start");const m="onHover"+a,z=h[m];z&&frame.postRender(()=>z(n,extractEventInfo(n)))}class HoverGesture extends Feature{mount(){const{current:n}=this.node;n&&(this.unmount=hover(n,(a,h)=>(handleHoverEvent(this.node,h,"Start"),m=>handleHoverEvent(this.node,m,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let n=!1;try{n=this.node.current.matches(":focus-visible")}catch{n=!0}!n||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(i,n,a){const{props:h}=i;if(i.current instanceof HTMLButtonElement&&i.current.disabled)return;i.animationState&&h.whileTap&&i.animationState.setActive("whileTap",a==="Start");const m="onTap"+(a==="End"?"":a),z=h[m];z&&frame.postRender(()=>z(n,extractEventInfo(n)))}class PressGesture extends Feature{mount(){const{current:n}=this.node;n&&(this.unmount=press(n,(a,h)=>(handlePressEvent(this.node,h,"Start"),(m,{success:z})=>handlePressEvent(this.node,m,z?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=i=>{const n=observerCallbacks.get(i.target);n&&n(i)},fireAllObserverCallbacks=i=>{i.forEach(fireObserverCallback)};function initIntersectionObserver({root:i,...n}){const a=i||document;observers.has(a)||observers.set(a,{});const h=observers.get(a),m=JSON.stringify(n);return h[m]||(h[m]=new IntersectionObserver(fireAllObserverCallbacks,{root:i,...n})),h[m]}function observeIntersection(i,n,a){const h=initIntersectionObserver(n);return observerCallbacks.set(i,a),h.observe(i),()=>{observerCallbacks.delete(i),h.unobserve(i)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:n={}}=this.node.getProps(),{root:a,margin:h,amount:m="some",once:z}=n,u={root:a?a.current:void 0,rootMargin:h,threshold:typeof m=="number"?m:thresholdNames[m]},y=p=>{const{isIntersecting:w}=p;if(this.isInView===w||(this.isInView=w,z&&!w&&this.hasEnteredView))return;w&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",w);const{onViewportEnter:M,onViewportLeave:b}=this.node.getProps(),I=w?M:b;I&&I(p)};return observeIntersection(this.node.current,u,y)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:n,prevProps:a}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(n,a))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:i={}},{viewport:n={}}={}){return a=>i[a]!==n[a]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},featureBundle={...animations,...gestureAnimations,...drag,...layout},motion=createMotionProxy(featureBundle,createDomVisualElement);function OptimadeClient(){const[i,n]=reactExports.useState([]),[a,h]=reactExports.useState(""),[m,z]=reactExports.useState(""),[u,y]=reactExports.useState(1),[p,w]=reactExports.useState(null),[M,b]=reactExports.useState(null),[I,O]=reactExports.useState(!1),[T,L]=reactExports.useState(1),[Q,ne]=reactExports.useState({data_returned:0,data_available:0});reactExports.useEffect(()=>{(async()=>{try{const F=await getProvidersList(void 0,["exmpl","matcloud"]);n(F.data)}catch(F){console.error("Error fetching providers:",F)}})()},[]);const Z=reactExports.useCallback(async()=>{if(a){O(!0);try{const _=await getStructures({providerUrl:a,filter:m,page:u});b(_);const F=_?.meta??{data_returned:0,data_available:0};ne(F),L(Math.max(1,Math.ceil((F.data_returned??0)/20))),w(_?.data[0]||null)}catch(_){console.error("Error fetching structures:",_),w(null)}finally{O(!1)}}},[a,m,u]);return reactExports.useEffect(()=>{Z()},[Z]),jsxRuntimeExports.jsxs("div",{className:"min-h-screen flex flex-col items-center px-0.5",children:[jsxRuntimeExports.jsx(OptimadeHeader,{}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center w-full max-w-3xl",children:[jsxRuntimeExports.jsx("div",{className:"mt-4",children:jsxRuntimeExports.jsx(DatabaseSelector,{providers:i,onQueryUrlChange:_=>{_!==a&&(h(_),y(1))}})}),jsxRuntimeExports.jsxs("div",{className:"pt-2 text-sm md:text-base",children:["Query Url:"," ",a?jsxRuntimeExports.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:a}):"None"]}),jsxRuntimeExports.jsx("div",{className:"pb-4 px-0.5 w-full",children:jsxRuntimeExports.jsx(ProviderInfo,{queryUrl:a})}),jsxRuntimeExports.jsx(AnimatePresence,{children:a&&jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3,ease:"easeInOut"},className:"w-full p-4 border rounded bg-slate-50",children:jsxRuntimeExports.jsx(OptimadeFilters,{onSubmit:_=>{z(_),y(1)}})})}),a&&jsxRuntimeExports.jsxs("div",{className:"px-2 w-full",children:[I&&jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center h-[800px]",children:jsxRuntimeExports.jsx("div",{className:"w-16 h-16 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}),jsxRuntimeExports.jsx("div",{className:"border-b border-slate-300 py-2"}),!I&&!p&&m&&jsxRuntimeExports.jsxs("div",{className:"my-4 w-full rounded bg-yellow-100 border border-yellow-400 text-yellow-800 px-3 py-3 text-sm",children:[jsxRuntimeExports.jsx("strong",{className:"font-semibold",children:"Warning: "}),"No results returned for this query. The server may not be responsive Try to relax the filters, check the syntax of the query or the server may be unresponsive.",jsxRuntimeExports.jsxs("p",{className:"text-xs text-center pt-2",children:["Attempted Query:"," ",jsxRuntimeExports.jsx("a",{href:`${a}/structures?filter=${encodeURIComponent(m)}`,target:"_blank",rel:"noopener noreferrer",className:"underline text-blue-700 hover:text-blue-900 break-all",children:`${a}/structures?filter=${m}`})]})]}),!I&&M&&p&&jsxRuntimeExports.jsxs("div",{className:"py-1 md:py-2 ",children:[jsxRuntimeExports.jsx(ResultsDropdown,{results:M,resultsLoading:I,selectedResult:p,setSelectedResult:w}),jsxRuntimeExports.jsx(ResultViewer,{selectedResult:p}),jsxRuntimeExports.jsx(PaginationHandler,{currentPage:u,totalPages:T,resultsLoading:I,metaData:Q,onPageChange:y})]})]})]})]})}function App(){return jsxRuntimeExports.jsx(OptimadeClient,{})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
