(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const v of document.querySelectorAll('link[rel="modulepreload"]'))u(v);new MutationObserver(v=>{for(const x of v)if(x.type==="childList")for(const b of x.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&u(b)}).observe(document,{childList:!0,subtree:!0});function r(v){const x={};return v.integrity&&(x.integrity=v.integrity),v.referrerPolicy&&(x.referrerPolicy=v.referrerPolicy),v.crossOrigin==="use-credentials"?x.credentials="include":v.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function u(v){if(v.ep)return;v.ep=!0;const x=r(v);fetch(v.href,x)}})();var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var jsxRuntime$1={exports:{}},reactJsxRuntime_production_min$1={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var n=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),b=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),k=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),R=Symbol.iterator;function P(N){return N===null||typeof N!="object"?null:(N=R&&N[R]||N["@@iterator"],typeof N=="function"?N:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,a={};function s(N,J,ae){this.props=N,this.context=J,this.refs=a,this.updater=ae||T}s.prototype.isReactComponent={},s.prototype.setState=function(N,J){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,J,"setState")},s.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function c(){}c.prototype=s.prototype;function w(N,J,ae){this.props=N,this.context=J,this.refs=a,this.updater=ae||T}var _=w.prototype=new c;_.constructor=w,C(_,s.prototype),_.isPureReactComponent=!0;var M=Array.isArray,l=Object.prototype.hasOwnProperty,h={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function E(N,J,ae){var se,he={},pe=null,de=null;if(J!=null)for(se in J.ref!==void 0&&(de=J.ref),J.key!==void 0&&(pe=""+J.key),J)l.call(J,se)&&!S.hasOwnProperty(se)&&(he[se]=J[se]);var ue=arguments.length-2;if(ue===1)he.children=ae;else if(1<ue){for(var ge=Array(ue),Re=0;Re<ue;Re++)ge[Re]=arguments[Re+2];he.children=ge}if(N&&N.defaultProps)for(se in ue=N.defaultProps,ue)he[se]===void 0&&(he[se]=ue[se]);return{$$typeof:n,type:N,key:pe,ref:de,props:he,_owner:h.current}}function F(N,J){return{$$typeof:n,type:N.type,key:J,ref:N.ref,props:N.props,_owner:N._owner}}function D(N){return typeof N=="object"&&N!==null&&N.$$typeof===n}function L(N){var J={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(ae){return J[ae]})}var V=/\/+/g;function O(N,J){return typeof N=="object"&&N!==null&&N.key!=null?L(""+N.key):J.toString(36)}function W(N,J,ae,se,he){var pe=typeof N;(pe==="undefined"||pe==="boolean")&&(N=null);var de=!1;if(N===null)de=!0;else switch(pe){case"string":case"number":de=!0;break;case"object":switch(N.$$typeof){case n:case t:de=!0}}if(de)return de=N,he=he(de),N=se===""?"."+O(de,0):se,M(he)?(ae="",N!=null&&(ae=N.replace(V,"$&/")+"/"),W(he,J,ae,"",function(Re){return Re})):he!=null&&(D(he)&&(he=F(he,ae+(!he.key||de&&de.key===he.key?"":(""+he.key).replace(V,"$&/")+"/")+N)),J.push(he)),1;if(de=0,se=se===""?".":se+":",M(N))for(var ue=0;ue<N.length;ue++){pe=N[ue];var ge=se+O(pe,ue);de+=W(pe,J,ae,ge,he)}else if(ge=P(N),typeof ge=="function")for(N=ge.call(N),ue=0;!(pe=N.next()).done;)pe=pe.value,ge=se+O(pe,ue++),de+=W(pe,J,ae,ge,he);else if(pe==="object")throw J=String(N),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.");return de}function H(N,J,ae){if(N==null)return N;var se=[],he=0;return W(N,se,"","",function(pe){return J.call(ae,pe,he++)}),se}function q(N){if(N._status===-1){var J=N._result;J=J(),J.then(function(ae){(N._status===0||N._status===-1)&&(N._status=1,N._result=ae)},function(ae){(N._status===0||N._status===-1)&&(N._status=2,N._result=ae)}),N._status===-1&&(N._status=0,N._result=J)}if(N._status===1)return N._result.default;throw N._result}var U={current:null},B={transition:null},Y={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:B,ReactCurrentOwner:h};function X(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:H,forEach:function(N,J,ae){H(N,function(){J.apply(this,arguments)},ae)},count:function(N){var J=0;return H(N,function(){J++}),J},toArray:function(N){return H(N,function(J){return J})||[]},only:function(N){if(!D(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},react_production_min.Component=s,react_production_min.Fragment=r,react_production_min.Profiler=v,react_production_min.PureComponent=w,react_production_min.StrictMode=u,react_production_min.Suspense=y,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y,react_production_min.act=X,react_production_min.cloneElement=function(N,J,ae){if(N==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+N+".");var se=C({},N.props),he=N.key,pe=N.ref,de=N._owner;if(J!=null){if(J.ref!==void 0&&(pe=J.ref,de=h.current),J.key!==void 0&&(he=""+J.key),N.type&&N.type.defaultProps)var ue=N.type.defaultProps;for(ge in J)l.call(J,ge)&&!S.hasOwnProperty(ge)&&(se[ge]=J[ge]===void 0&&ue!==void 0?ue[ge]:J[ge])}var ge=arguments.length-2;if(ge===1)se.children=ae;else if(1<ge){ue=Array(ge);for(var Re=0;Re<ge;Re++)ue[Re]=arguments[Re+2];se.children=ue}return{$$typeof:n,type:N.type,key:he,ref:pe,props:se,_owner:de}},react_production_min.createContext=function(N){return N={$$typeof:b,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},N.Provider={$$typeof:x,_context:N},N.Consumer=N},react_production_min.createElement=E,react_production_min.createFactory=function(N){var J=E.bind(null,N);return J.type=N,J},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(N){return{$$typeof:p,render:N}},react_production_min.isValidElement=D,react_production_min.lazy=function(N){return{$$typeof:g,_payload:{_status:-1,_result:N},_init:q}},react_production_min.memo=function(N,J){return{$$typeof:k,type:N,compare:J===void 0?null:J}},react_production_min.startTransition=function(N){var J=B.transition;B.transition={};try{N()}finally{B.transition=J}},react_production_min.unstable_act=X,react_production_min.useCallback=function(N,J){return U.current.useCallback(N,J)},react_production_min.useContext=function(N){return U.current.useContext(N)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(N){return U.current.useDeferredValue(N)},react_production_min.useEffect=function(N,J){return U.current.useEffect(N,J)},react_production_min.useId=function(){return U.current.useId()},react_production_min.useImperativeHandle=function(N,J,ae){return U.current.useImperativeHandle(N,J,ae)},react_production_min.useInsertionEffect=function(N,J){return U.current.useInsertionEffect(N,J)},react_production_min.useLayoutEffect=function(N,J){return U.current.useLayoutEffect(N,J)},react_production_min.useMemo=function(N,J){return U.current.useMemo(N,J)},react_production_min.useReducer=function(N,J,ae){return U.current.useReducer(N,J,ae)},react_production_min.useRef=function(N){return U.current.useRef(N)},react_production_min.useState=function(N){return U.current.useState(N)},react_production_min.useSyncExternalStore=function(N,J,ae){return U.current.useSyncExternalStore(N,J,ae)},react_production_min.useTransition=function(){return U.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min$1;function requireReactJsxRuntime_production_min$1(){if(hasRequiredReactJsxRuntime_production_min$1)return reactJsxRuntime_production_min$1;hasRequiredReactJsxRuntime_production_min$1=1;var n=requireReact(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,v=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x={key:!0,ref:!0,__self:!0,__source:!0};function b(p,y,k){var g,R={},P=null,T=null;k!==void 0&&(P=""+k),y.key!==void 0&&(P=""+y.key),y.ref!==void 0&&(T=y.ref);for(g in y)u.call(y,g)&&!x.hasOwnProperty(g)&&(R[g]=y[g]);if(p&&p.defaultProps)for(g in y=p.defaultProps,y)R[g]===void 0&&(R[g]=y[g]);return{$$typeof:t,type:p,key:P,ref:T,props:R,_owner:v.current}}return reactJsxRuntime_production_min$1.Fragment=r,reactJsxRuntime_production_min$1.jsx=b,reactJsxRuntime_production_min$1.jsxs=b,reactJsxRuntime_production_min$1}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime$1.exports=requireReactJsxRuntime_production_min$1()),jsxRuntime$1.exports}var jsxRuntimeExports$1=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(n){function t(B,Y){var X=B.length;B.push(Y);e:for(;0<X;){var N=X-1>>>1,J=B[N];if(0<v(J,Y))B[N]=Y,B[X]=J,X=N;else break e}}function r(B){return B.length===0?null:B[0]}function u(B){if(B.length===0)return null;var Y=B[0],X=B.pop();if(X!==Y){B[0]=X;e:for(var N=0,J=B.length,ae=J>>>1;N<ae;){var se=2*(N+1)-1,he=B[se],pe=se+1,de=B[pe];if(0>v(he,X))pe<J&&0>v(de,he)?(B[N]=de,B[pe]=X,N=pe):(B[N]=he,B[se]=X,N=se);else if(pe<J&&0>v(de,X))B[N]=de,B[pe]=X,N=pe;else break e}}return Y}function v(B,Y){var X=B.sortIndex-Y.sortIndex;return X!==0?X:B.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var x=performance;n.unstable_now=function(){return x.now()}}else{var b=Date,p=b.now();n.unstable_now=function(){return b.now()-p}}var y=[],k=[],g=1,R=null,P=3,T=!1,C=!1,a=!1,s=typeof setTimeout=="function"?setTimeout:null,c=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(B){for(var Y=r(k);Y!==null;){if(Y.callback===null)u(k);else if(Y.startTime<=B)u(k),Y.sortIndex=Y.expirationTime,t(y,Y);else break;Y=r(k)}}function M(B){if(a=!1,_(B),!C)if(r(y)!==null)C=!0,q(l);else{var Y=r(k);Y!==null&&U(M,Y.startTime-B)}}function l(B,Y){C=!1,a&&(a=!1,c(E),E=-1),T=!0;var X=P;try{for(_(Y),R=r(y);R!==null&&(!(R.expirationTime>Y)||B&&!L());){var N=R.callback;if(typeof N=="function"){R.callback=null,P=R.priorityLevel;var J=N(R.expirationTime<=Y);Y=n.unstable_now(),typeof J=="function"?R.callback=J:R===r(y)&&u(y),_(Y)}else u(y);R=r(y)}if(R!==null)var ae=!0;else{var se=r(k);se!==null&&U(M,se.startTime-Y),ae=!1}return ae}finally{R=null,P=X,T=!1}}var h=!1,S=null,E=-1,F=5,D=-1;function L(){return!(n.unstable_now()-D<F)}function V(){if(S!==null){var B=n.unstable_now();D=B;var Y=!0;try{Y=S(!0,B)}finally{Y?O():(h=!1,S=null)}}else h=!1}var O;if(typeof w=="function")O=function(){w(V)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,H=W.port2;W.port1.onmessage=V,O=function(){H.postMessage(null)}}else O=function(){s(V,0)};function q(B){S=B,h||(h=!0,O())}function U(B,Y){E=s(function(){B(n.unstable_now())},Y)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_continueExecution=function(){C||T||(C=!0,q(l))},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return P},n.unstable_getFirstCallbackNode=function(){return r(y)},n.unstable_next=function(B){switch(P){case 1:case 2:case 3:var Y=3;break;default:Y=P}var X=P;P=Y;try{return B()}finally{P=X}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(B,Y){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var X=P;P=B;try{return Y()}finally{P=X}},n.unstable_scheduleCallback=function(B,Y,X){var N=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?N+X:N):X=N,B){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=X+J,B={id:g++,callback:Y,priorityLevel:B,startTime:X,expirationTime:J,sortIndex:-1},X>N?(B.sortIndex=X,t(k,B),r(y)===null&&B===r(k)&&(a?(c(E),E=-1):a=!0,U(M,X-N))):(B.sortIndex=J,t(y,B),C||T||(C=!0,q(l))),B},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(B){var Y=P;return function(){var X=P;P=Y;try{return B.apply(this,arguments)}finally{P=X}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var n=requireReact(),t=requireScheduler();function r(e){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+e,f=1;f<arguments.length;f++)o+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+e+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=new Set,v={};function x(e,o){b(e,o),b(e+"Capture",o)}function b(e,o){for(v[e]=o,e=0;e<o.length;e++)u.add(o[e])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),y=Object.prototype.hasOwnProperty,k=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},R={};function P(e){return y.call(R,e)?!0:y.call(g,e)?!1:k.test(e)?R[e]=!0:(g[e]=!0,!1)}function T(e,o,f,I){if(f!==null&&f.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return I?!1:f!==null?!f.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function C(e,o,f,I){if(o===null||typeof o>"u"||T(e,o,f,I))return!0;if(I)return!1;if(f!==null)switch(f.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function a(e,o,f,I,j,$,te){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=I,this.attributeNamespace=j,this.mustUseProperty=f,this.propertyName=e,this.type=o,this.sanitizeURL=$,this.removeEmptyString=te}var s={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){s[e]=new a(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var o=e[0];s[o]=new a(o,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){s[e]=new a(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){s[e]=new a(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){s[e]=new a(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){s[e]=new a(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){s[e]=new a(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){s[e]=new a(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){s[e]=new a(e,5,!1,e.toLowerCase(),null,!1,!1)});var c=/[\-:]([a-z])/g;function w(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var o=e.replace(c,w);s[o]=new a(o,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var o=e.replace(c,w);s[o]=new a(o,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var o=e.replace(c,w);s[o]=new a(o,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){s[e]=new a(e,1,!1,e.toLowerCase(),null,!1,!1)}),s.xlinkHref=new a("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){s[e]=new a(e,1,!1,e.toLowerCase(),null,!0,!0)});function _(e,o,f,I){var j=s.hasOwnProperty(o)?s[o]:null;(j!==null?j.type!==0:I||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(C(o,f,j,I)&&(f=null),I||j===null?P(o)&&(f===null?e.removeAttribute(o):e.setAttribute(o,""+f)):j.mustUseProperty?e[j.propertyName]=f===null?j.type===3?!1:"":f:(o=j.attributeName,I=j.attributeNamespace,f===null?e.removeAttribute(o):(j=j.type,f=j===3||j===4&&f===!0?"":""+f,I?e.setAttributeNS(I,o,f):e.setAttribute(o,f))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),h=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),L=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),U=Symbol.for("react.offscreen"),B=Symbol.iterator;function Y(e){return e===null||typeof e!="object"?null:(e=B&&e[B]||e["@@iterator"],typeof e=="function"?e:null)}var X=Object.assign,N;function J(e){if(N===void 0)try{throw Error()}catch(f){var o=f.stack.trim().match(/\n( *(at )?)/);N=o&&o[1]||""}return`
`+N+e}var ae=!1;function se(e,o){if(!e||ae)return"";ae=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Ve){var I=Ve}Reflect.construct(e,[],o)}else{try{o.call()}catch(Ve){I=Ve}e.call(o.prototype)}else{try{throw Error()}catch(Ve){I=Ve}e()}}catch(Ve){if(Ve&&I&&typeof Ve.stack=="string"){for(var j=Ve.stack.split(`
`),$=I.stack.split(`
`),te=j.length-1,fe=$.length-1;1<=te&&0<=fe&&j[te]!==$[fe];)fe--;for(;1<=te&&0<=fe;te--,fe--)if(j[te]!==$[fe]){if(te!==1||fe!==1)do if(te--,fe--,0>fe||j[te]!==$[fe]){var be=`
`+j[te].replace(" at new "," at ");return e.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",e.displayName)),be}while(1<=te&&0<=fe);break}}}finally{ae=!1,Error.prepareStackTrace=f}return(e=e?e.displayName||e.name:"")?J(e):""}function he(e){switch(e.tag){case 5:return J(e.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 2:case 15:return e=se(e.type,!1),e;case 11:return e=se(e.type.render,!1),e;case 1:return e=se(e.type,!0),e;default:return""}}function pe(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case h:return"Portal";case F:return"Profiler";case E:return"StrictMode";case O:return"Suspense";case W:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case L:return(e.displayName||"Context")+".Consumer";case D:return(e._context.displayName||"Context")+".Provider";case V:var o=e.render;return e=e.displayName,e||(e=o.displayName||o.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case H:return o=e.displayName||null,o!==null?o:pe(e.type)||"Memo";case q:o=e._payload,e=e._init;try{return pe(e(o))}catch{}}return null}function de(e){var o=e.type;switch(e.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=o.render,e=e.displayName||e.name||"",o.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(o);case 8:return o===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function ue(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ge(e){var o=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Re(e){var o=ge(e)?"checked":"value",f=Object.getOwnPropertyDescriptor(e.constructor.prototype,o),I=""+e[o];if(!e.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var j=f.get,$=f.set;return Object.defineProperty(e,o,{configurable:!0,get:function(){return j.call(this)},set:function(te){I=""+te,$.call(this,te)}}),Object.defineProperty(e,o,{enumerable:f.enumerable}),{getValue:function(){return I},setValue:function(te){I=""+te},stopTracking:function(){e._valueTracker=null,delete e[o]}}}}function Ge(e){e._valueTracker||(e._valueTracker=Re(e))}function We(e){if(!e)return!1;var o=e._valueTracker;if(!o)return!0;var f=o.getValue(),I="";return e&&(I=ge(e)?e.checked?"true":"false":e.value),e=I,e!==f?(o.setValue(e),!0):!1}function Oe(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function me(e,o){var f=o.checked;return X({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??e._wrapperState.initialChecked})}function Fe(e,o){var f=o.defaultValue==null?"":o.defaultValue,I=o.checked!=null?o.checked:o.defaultChecked;f=ue(o.value!=null?o.value:f),e._wrapperState={initialChecked:I,initialValue:f,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function qe(e,o){o=o.checked,o!=null&&_(e,"checked",o,!1)}function Qe(e,o){qe(e,o);var f=ue(o.value),I=o.type;if(f!=null)I==="number"?(f===0&&e.value===""||e.value!=f)&&(e.value=""+f):e.value!==""+f&&(e.value=""+f);else if(I==="submit"||I==="reset"){e.removeAttribute("value");return}o.hasOwnProperty("value")?ot(e,o.type,f):o.hasOwnProperty("defaultValue")&&ot(e,o.type,ue(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(e.defaultChecked=!!o.defaultChecked)}function st(e,o,f){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var I=o.type;if(!(I!=="submit"&&I!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+e._wrapperState.initialValue,f||o===e.value||(e.value=o),e.defaultValue=o}f=e.name,f!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,f!==""&&(e.name=f)}function ot(e,o,f){(o!=="number"||Oe(e.ownerDocument)!==e)&&(f==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+f&&(e.defaultValue=""+f))}var Ke=Array.isArray;function Je(e,o,f,I){if(e=e.options,o){o={};for(var j=0;j<f.length;j++)o["$"+f[j]]=!0;for(f=0;f<e.length;f++)j=o.hasOwnProperty("$"+e[f].value),e[f].selected!==j&&(e[f].selected=j),j&&I&&(e[f].defaultSelected=!0)}else{for(f=""+ue(f),o=null,j=0;j<e.length;j++){if(e[j].value===f){e[j].selected=!0,I&&(e[j].defaultSelected=!0);return}o!==null||e[j].disabled||(o=e[j])}o!==null&&(o.selected=!0)}}function Xe(e,o){if(o.dangerouslySetInnerHTML!=null)throw Error(r(91));return X({},o,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ne(e,o){var f=o.value;if(f==null){if(f=o.children,o=o.defaultValue,f!=null){if(o!=null)throw Error(r(92));if(Ke(f)){if(1<f.length)throw Error(r(93));f=f[0]}o=f}o==null&&(o=""),f=o}e._wrapperState={initialValue:ue(f)}}function Ue(e,o){var f=ue(o.value),I=ue(o.defaultValue);f!=null&&(f=""+f,f!==e.value&&(e.value=f),o.defaultValue==null&&e.defaultValue!==f&&(e.defaultValue=f)),I!=null&&(e.defaultValue=""+I)}function ft(e){var o=e.textContent;o===e._wrapperState.initialValue&&o!==""&&o!==null&&(e.value=o)}function ut(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ee(e,o){return e==null||e==="http://www.w3.org/1999/xhtml"?ut(o):e==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ie,oe=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,f,I,j){MSApp.execUnsafeLocalFunction(function(){return e(o,f,I,j)})}:e})(function(e,o){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=o;else{for(ie=ie||document.createElement("div"),ie.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=ie.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;o.firstChild;)e.appendChild(o.firstChild)}});function we(e,o){if(o){var f=e.firstChild;if(f&&f===e.lastChild&&f.nodeType===3){f.nodeValue=o;return}}e.textContent=o}var Se={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},He=["Webkit","ms","Moz","O"];Object.keys(Se).forEach(function(e){He.forEach(function(o){o=o+e.charAt(0).toUpperCase()+e.substring(1),Se[o]=Se[e]})});function Be(e,o,f){return o==null||typeof o=="boolean"||o===""?"":f||typeof o!="number"||o===0||Se.hasOwnProperty(e)&&Se[e]?(""+o).trim():o+"px"}function K(e,o){e=e.style;for(var f in o)if(o.hasOwnProperty(f)){var I=f.indexOf("--")===0,j=Be(f,o[f],I);f==="float"&&(f="cssFloat"),I?e.setProperty(f,j):e[f]=j}}var xe=X({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Me(e,o){if(o){if(xe[e]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(r(137,e));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(r(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(r(61))}if(o.style!=null&&typeof o.style!="object")throw Error(r(62))}}function $e(e,o){if(e.indexOf("-")===-1)return typeof o.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function je(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Z=null,De=null,rt=null;function G(e){if(e=Fn(e)){if(typeof Z!="function")throw Error(r(280));var o=e.stateNode;o&&(o=ys(o),Z(e.stateNode,e.type,o))}}function Te(e){De?rt?rt.push(e):rt=[e]:De=e}function Ee(){if(De){var e=De,o=rt;if(rt=De=null,G(e),o)for(e=0;e<o.length;e++)G(o[e])}}function re(e,o){return e(o)}function ve(){}var ke=!1;function ct(e,o,f){if(ke)return e(o,f);ke=!0;try{return re(e,o,f)}finally{ke=!1,(De!==null||rt!==null)&&(ve(),Ee())}}function lt(e,o){var f=e.stateNode;if(f===null)return null;var I=ys(f);if(I===null)return null;f=I[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(I=!I.disabled)||(e=e.type,I=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!I;break e;default:e=!1}if(e)return null;if(f&&typeof f!="function")throw Error(r(231,o,typeof f));return f}var dt=!1;if(p)try{var yt={};Object.defineProperty(yt,"passive",{get:function(){dt=!0}}),window.addEventListener("test",yt,yt),window.removeEventListener("test",yt,yt)}catch{dt=!1}function ir(e,o,f,I,j,$,te,fe,be){var Ve=Array.prototype.slice.call(arguments,3);try{o.apply(f,Ve)}catch(et){this.onError(et)}}var At=!1,Mt=null,Pt=!1,Qt=null,Kt={onError:function(e){At=!0,Mt=e}};function Kr(e,o,f,I,j,$,te,fe,be){At=!1,Mt=null,ir.apply(Kt,arguments)}function ai(e,o,f,I,j,$,te,fe,be){if(Kr.apply(this,arguments),At){if(At){var Ve=Mt;At=!1,Mt=null}else throw Error(r(198));Pt||(Pt=!0,Qt=Ve)}}function Lt(e){var o=e,f=e;if(e.alternate)for(;o.return;)o=o.return;else{e=o;do o=e,(o.flags&4098)!==0&&(f=o.return),e=o.return;while(e)}return o.tag===3?f:null}function Wt(e){if(e.tag===13){var o=e.memoizedState;if(o===null&&(e=e.alternate,e!==null&&(o=e.memoizedState)),o!==null)return o.dehydrated}return null}function qt(e){if(Lt(e)!==e)throw Error(r(188))}function wr(e){var o=e.alternate;if(!o){if(o=Lt(e),o===null)throw Error(r(188));return o!==e?null:e}for(var f=e,I=o;;){var j=f.return;if(j===null)break;var $=j.alternate;if($===null){if(I=j.return,I!==null){f=I;continue}break}if(j.child===$.child){for($=j.child;$;){if($===f)return qt(j),e;if($===I)return qt(j),o;$=$.sibling}throw Error(r(188))}if(f.return!==I.return)f=j,I=$;else{for(var te=!1,fe=j.child;fe;){if(fe===f){te=!0,f=j,I=$;break}if(fe===I){te=!0,I=j,f=$;break}fe=fe.sibling}if(!te){for(fe=$.child;fe;){if(fe===f){te=!0,f=$,I=j;break}if(fe===I){te=!0,I=$,f=j;break}fe=fe.sibling}if(!te)throw Error(r(189))}}if(f.alternate!==I)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?e:o}function dr(e){return e=wr(e),e!==null?Nr(e):null}function Nr(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var o=Nr(e);if(o!==null)return o;e=e.sibling}return null}var gn=t.unstable_scheduleCallback,vn=t.unstable_cancelCallback,Wn=t.unstable_shouldYield,Gi=t.unstable_requestPaint,Jt=t.unstable_now,yn=t.unstable_getCurrentPriorityLevel,Ei=t.unstable_ImmediatePriority,Po=t.unstable_UserBlockingPriority,It=t.unstable_NormalPriority,li=t.unstable_LowPriority,Vr=t.unstable_IdlePriority,Hn=null,vr=null;function Ps(e){if(vr&&typeof vr.onCommitFiberRoot=="function")try{vr.onCommitFiberRoot(Hn,e,void 0,(e.current.flags&128)===128)}catch{}}var Rr=Math.clz32?Math.clz32:Ds,Is=Math.log,Fs=Math.LN2;function Ds(e){return e>>>=0,e===0?32:31-(Is(e)/Fs|0)|0}var Wr=64,ui=4194304;function nr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zr(e,o){var f=e.pendingLanes;if(f===0)return 0;var I=0,j=e.suspendedLanes,$=e.pingedLanes,te=f&268435455;if(te!==0){var fe=te&~j;fe!==0?I=nr(fe):($&=te,$!==0&&(I=nr($)))}else te=f&~j,te!==0?I=nr(te):$!==0&&(I=nr($));if(I===0)return 0;if(o!==0&&o!==I&&(o&j)===0&&(j=I&-I,$=o&-o,j>=$||j===16&&($&4194240)!==0))return o;if((I&4)!==0&&(I|=f&16),o=e.entangledLanes,o!==0)for(e=e.entanglements,o&=I;0<o;)f=31-Rr(o),j=1<<f,I|=e[f],o&=~j;return I}function Ai(e,o){switch(e){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ui(e,o){for(var f=e.suspendedLanes,I=e.pingedLanes,j=e.expirationTimes,$=e.pendingLanes;0<$;){var te=31-Rr($),fe=1<<te,be=j[te];be===-1?((fe&f)===0||(fe&I)!==0)&&(j[te]=Ai(fe,o)):be<=o&&(e.expiredLanes|=fe),$&=~fe}}function zs(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ci(){var e=Wr;return Wr<<=1,(Wr&4194240)===0&&(Wr=64),e}function $n(e){for(var o=[],f=0;31>f;f++)o.push(e);return o}function Dr(e,o,f){e.pendingLanes|=o,o!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,o=31-Rr(o),e[o]=f}function Va(e,o){var f=e.pendingLanes&~o;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=o,e.mutableReadLanes&=o,e.entangledLanes&=o,o=e.entanglements;var I=e.eventTimes;for(e=e.expirationTimes;0<f;){var j=31-Rr(f),$=1<<j;o[j]=0,I[j]=-1,e[j]=-1,f&=~$}}function Hr(e,o){var f=e.entangledLanes|=o;for(e=e.entanglements;f;){var I=31-Rr(f),j=1<<I;j&o|e[I]&o&&(e[I]|=o),f&=~j}}var Rt=0;function Sr(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var jt,Ti,qn,Ls,Mi,Yn=!1,Wi=[],kr=null,di=null,hi=null,Cr=new Map,ei=new Map,fi=[],Ba="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hi(e,o){switch(e){case"focusin":case"focusout":kr=null;break;case"dragenter":case"dragleave":di=null;break;case"mouseover":case"mouseout":hi=null;break;case"pointerover":case"pointerout":Cr.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ei.delete(o.pointerId)}}function $i(e,o,f,I,j,$){return e===null||e.nativeEvent!==$?(e={blockedOn:o,domEventName:f,eventSystemFlags:I,nativeEvent:$,targetContainers:[j]},o!==null&&(o=Fn(o),o!==null&&Ti(o)),e):(e.eventSystemFlags|=I,o=e.targetContainers,j!==null&&o.indexOf(j)===-1&&o.push(j),e)}function Io(e,o,f,I,j){switch(o){case"focusin":return kr=$i(kr,e,o,f,I,j),!0;case"dragenter":return di=$i(di,e,o,f,I,j),!0;case"mouseover":return hi=$i(hi,e,o,f,I,j),!0;case"pointerover":var $=j.pointerId;return Cr.set($,$i(Cr.get($)||null,e,o,f,I,j)),!0;case"gotpointercapture":return $=j.pointerId,ei.set($,$i(ei.get($)||null,e,o,f,I,j)),!0}return!1}function Fo(e){var o=Li(e.target);if(o!==null){var f=Lt(o);if(f!==null){if(o=f.tag,o===13){if(o=Wt(f),o!==null){e.blockedOn=o,Mi(e.priority,function(){qn(f)});return}}else if(o===3&&f.stateNode.current.memoizedState.isDehydrated){e.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xn(e){if(e.blockedOn!==null)return!1;for(var o=e.targetContainers;0<o.length;){var f=js(e.domEventName,e.eventSystemFlags,o[0],e.nativeEvent);if(f===null){f=e.nativeEvent;var I=new f.constructor(f.type,f);ye=I,f.target.dispatchEvent(I),ye=null}else return o=Fn(f),o!==null&&Ti(o),e.blockedOn=f,!1;o.shift()}return!0}function Do(e,o,f){xn(e)&&f.delete(o)}function Ga(){Yn=!1,kr!==null&&xn(kr)&&(kr=null),di!==null&&xn(di)&&(di=null),hi!==null&&xn(hi)&&(hi=null),Cr.forEach(Do),ei.forEach(Do)}function _n(e,o){e.blockedOn===o&&(e.blockedOn=null,Yn||(Yn=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Ga)))}function bn(e){function o(j){return _n(j,e)}if(0<Wi.length){_n(Wi[0],e);for(var f=1;f<Wi.length;f++){var I=Wi[f];I.blockedOn===e&&(I.blockedOn=null)}}for(kr!==null&&_n(kr,e),di!==null&&_n(di,e),hi!==null&&_n(hi,e),Cr.forEach(o),ei.forEach(o),f=0;f<fi.length;f++)I=fi[f],I.blockedOn===e&&(I.blockedOn=null);for(;0<fi.length&&(f=fi[0],f.blockedOn===null);)Fo(f),f.blockedOn===null&&fi.shift()}var qi=M.ReactCurrentBatchConfig,Xn=!0;function Ua(e,o,f,I){var j=Rt,$=qi.transition;qi.transition=null;try{Rt=1,Os(e,o,f,I)}finally{Rt=j,qi.transition=$}}function Wa(e,o,f,I){var j=Rt,$=qi.transition;qi.transition=null;try{Rt=4,Os(e,o,f,I)}finally{Rt=j,qi.transition=$}}function Os(e,o,f,I){if(Xn){var j=js(e,o,f,I);if(j===null)lo(e,o,I,Jn,f),Hi(e,I);else if(Io(j,e,o,f,I))I.stopPropagation();else if(Hi(e,I),o&4&&-1<Ba.indexOf(e)){for(;j!==null;){var $=Fn(j);if($!==null&&jt($),$=js(e,o,f,I),$===null&&lo(e,o,I,Jn,f),$===j)break;j=$}j!==null&&I.stopPropagation()}else lo(e,o,I,null,f)}}var Jn=null;function js(e,o,f,I){if(Jn=null,e=je(I),e=Li(e),e!==null)if(o=Lt(e),o===null)e=null;else if(f=o.tag,f===13){if(e=Wt(o),e!==null)return e;e=null}else if(f===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;e=null}else o!==e&&(e=null);return Jn=e,null}function zo(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yn()){case Ei:return 1;case Po:return 4;case It:case li:return 16;case Vr:return 536870912;default:return 16}default:return 16}}var pi=null,Ri=null,Qn=null;function Lo(){if(Qn)return Qn;var e,o=Ri,f=o.length,I,j="value"in pi?pi.value:pi.textContent,$=j.length;for(e=0;e<f&&o[e]===j[e];e++);var te=f-e;for(I=1;I<=te&&o[f-I]===j[$-I];I++);return Qn=j.slice(e,1<I?1-I:void 0)}function Kn(e){var o=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&o===13&&(e=13)):e=o,e===10&&(e=13),32<=e||e===13?e:0}function ki(){return!0}function Ns(){return!1}function lr(e){function o(f,I,j,$,te){this._reactName=f,this._targetInst=j,this.type=I,this.nativeEvent=$,this.target=te,this.currentTarget=null;for(var fe in e)e.hasOwnProperty(fe)&&(f=e[fe],this[fe]=f?f($):$[fe]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?ki:Ns,this.isPropagationStopped=Ns,this}return X(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ki)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ki)},persist:function(){},isPersistent:ki}),o}var Yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vs=lr(Yi),wn=X({},Yi,{view:0,detail:0}),Ha=lr(wn),Pi,Bs,Xi,Sn=X({},wn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gs,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xi&&(Xi&&e.type==="mousemove"?(Pi=e.screenX-Xi.screenX,Bs=e.screenY-Xi.screenY):Bs=Pi=0,Xi=e),Pi)},movementY:function(e){return"movementY"in e?e.movementY:Bs}}),Oo=lr(Sn),$a=X({},Sn,{dataTransfer:0}),qa=lr($a),Ya=X({},wn,{relatedTarget:0}),Ji=lr(Ya),Xa=X({},Yi,{animationName:0,elapsedTime:0,pseudoElement:0}),Ja=lr(Xa),Qa=X({},Yi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ka=lr(Qa),Cn=X({},Yi,{data:0}),Zn=lr(Cn),Za={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},el={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rl(e){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(e):(e=tl[e])?!!o[e]:!1}function Gs(){return rl}var il=X({},wn,{key:function(e){if(e.key){var o=Za[e.key]||e.key;if(o!=="Unidentified")return o}return e.type==="keypress"?(e=Kn(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?el[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gs,charCode:function(e){return e.type==="keypress"?Kn(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Kn(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),nl=lr(il),es=X({},Sn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jo=lr(es),sl=X({},wn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gs}),Qi=lr(sl),No=X({},Yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vo=lr(No),Bo=X({},Sn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Us=lr(Bo),Go=[9,13,27,32],Ws=p&&"CompositionEvent"in window,En=null;p&&"documentMode"in document&&(En=document.documentMode);var ol=p&&"TextEvent"in window&&!En,Uo=p&&(!Ws||En&&8<En&&11>=En),Ki=" ",Wo=!1;function Hs(e,o){switch(e){case"keyup":return Go.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $s(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ii=!1;function al(e,o){switch(e){case"compositionend":return $s(o);case"keypress":return o.which!==32?null:(Wo=!0,Ki);case"textInput":return e=o.data,e===Ki&&Wo?null:e;default:return null}}function ts(e,o){if(Ii)return e==="compositionend"||!Ws&&Hs(e,o)?(e=Lo(),Qn=Ri=pi=null,Ii=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Uo&&o.locale!=="ko"?null:o.data;default:return null}}var Fi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ho(e){var o=e&&e.nodeName&&e.nodeName.toLowerCase();return o==="input"?!!Fi[e.type]:o==="textarea"}function $o(e,o,f,I){Te(I),o=ps(o,"onChange"),0<o.length&&(f=new Vs("onChange","change",null,f,I),e.push({event:f,listeners:o}))}var yr=null,Zi=null;function qo(e){fs(e,0)}function rs(e){var o=sn(e);if(We(o))return e}function Yo(e,o){if(e==="change")return o}var An=!1;if(p){var is;if(p){var ns="oninput"in document;if(!ns){var qs=document.createElement("div");qs.setAttribute("oninput","return;"),ns=typeof qs.oninput=="function"}is=ns}else is=!1;An=is&&(!document.documentMode||9<document.documentMode)}function Xs(){yr&&(yr.detachEvent("onpropertychange",Js),Zi=yr=null)}function Js(e){if(e.propertyName==="value"&&rs(Zi)){var o=[];$o(o,Zi,e,je(e)),ct(qo,o)}}function Xo(e,o,f){e==="focusin"?(Xs(),yr=o,Zi=f,yr.attachEvent("onpropertychange",Js)):e==="focusout"&&Xs()}function Jo(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return rs(Zi)}function Qo(e,o){if(e==="click")return rs(o)}function Ko(e,o){if(e==="input"||e==="change")return rs(o)}function ss(e,o){return e===o&&(e!==0||1/e===1/o)||e!==e&&o!==o}var sr=typeof Object.is=="function"?Object.is:ss;function Di(e,o){if(sr(e,o))return!0;if(typeof e!="object"||e===null||typeof o!="object"||o===null)return!1;var f=Object.keys(e),I=Object.keys(o);if(f.length!==I.length)return!1;for(I=0;I<f.length;I++){var j=f[I];if(!y.call(o,j)||!sr(e[j],o[j]))return!1}return!0}function Qs(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function os(e,o){var f=Qs(e);e=0;for(var I;f;){if(f.nodeType===3){if(I=e+f.textContent.length,e<=o&&I>=o)return{node:f,offset:o-e};e=I}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=Qs(f)}}function Ks(e,o){return e&&o?e===o?!0:e&&e.nodeType===3?!1:o&&o.nodeType===3?Ks(e,o.parentNode):"contains"in e?e.contains(o):e.compareDocumentPosition?!!(e.compareDocumentPosition(o)&16):!1:!1}function eo(){for(var e=window,o=Oe();o instanceof e.HTMLIFrameElement;){try{var f=typeof o.contentWindow.location.href=="string"}catch{f=!1}if(f)e=o.contentWindow;else break;o=Oe(e.document)}return o}function as(e){var o=e&&e.nodeName&&e.nodeName.toLowerCase();return o&&(o==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||o==="textarea"||e.contentEditable==="true")}function Zo(e){var o=eo(),f=e.focusedElem,I=e.selectionRange;if(o!==f&&f&&f.ownerDocument&&Ks(f.ownerDocument.documentElement,f)){if(I!==null&&as(f)){if(o=I.start,e=I.end,e===void 0&&(e=o),"selectionStart"in f)f.selectionStart=o,f.selectionEnd=Math.min(e,f.value.length);else if(e=(o=f.ownerDocument||document)&&o.defaultView||window,e.getSelection){e=e.getSelection();var j=f.textContent.length,$=Math.min(I.start,j);I=I.end===void 0?$:Math.min(I.end,j),!e.extend&&$>I&&(j=I,I=$,$=j),j=os(f,$);var te=os(f,I);j&&te&&(e.rangeCount!==1||e.anchorNode!==j.node||e.anchorOffset!==j.offset||e.focusNode!==te.node||e.focusOffset!==te.offset)&&(o=o.createRange(),o.setStart(j.node,j.offset),e.removeAllRanges(),$>I?(e.addRange(o),e.extend(te.node,te.offset)):(o.setEnd(te.node,te.offset),e.addRange(o)))}}for(o=[],e=f;e=e.parentNode;)e.nodeType===1&&o.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<o.length;f++)e=o[f],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ls=p&&"documentMode"in document&&11>=document.documentMode,ti=null,us=null,en=null,cs=!1;function to(e,o,f){var I=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;cs||ti==null||ti!==Oe(I)||(I=ti,"selectionStart"in I&&as(I)?I={start:I.selectionStart,end:I.selectionEnd}:(I=(I.ownerDocument&&I.ownerDocument.defaultView||window).getSelection(),I={anchorNode:I.anchorNode,anchorOffset:I.anchorOffset,focusNode:I.focusNode,focusOffset:I.focusOffset}),en&&Di(en,I)||(en=I,I=ps(us,"onSelect"),0<I.length&&(o=new Vs("onSelect","select",null,o,f),e.push({event:o,listeners:I}),o.target=ti)))}function Tn(e,o){var f={};return f[e.toLowerCase()]=o.toLowerCase(),f["Webkit"+e]="webkit"+o,f["Moz"+e]="moz"+o,f}var mi={animationend:Tn("Animation","AnimationEnd"),animationiteration:Tn("Animation","AnimationIteration"),animationstart:Tn("Animation","AnimationStart"),transitionend:Tn("Transition","TransitionEnd")},ds={},ro={};p&&(ro=document.createElement("div").style,"AnimationEvent"in window||(delete mi.animationend.animation,delete mi.animationiteration.animation,delete mi.animationstart.animation),"TransitionEvent"in window||delete mi.transitionend.transition);function Gt(e){if(ds[e])return ds[e];if(!mi[e])return e;var o=mi[e],f;for(f in o)if(o.hasOwnProperty(f)&&f in ro)return ds[e]=o[f];return e}var io=Gt("animationend"),no=Gt("animationiteration"),ea=Gt("animationstart"),ta=Gt("transitionend"),ra=new Map,so="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gi(e,o){ra.set(e,o),x(o,[e])}for(var ri=0;ri<so.length;ri++){var hs=so[ri],ia=hs.toLowerCase(),na=hs[0].toUpperCase()+hs.slice(1);gi(ia,"on"+na)}gi(io,"onAnimationEnd"),gi(no,"onAnimationIteration"),gi(ea,"onAnimationStart"),gi("dblclick","onDoubleClick"),gi("focusin","onFocus"),gi("focusout","onBlur"),gi(ta,"onTransitionEnd"),b("onMouseEnter",["mouseout","mouseover"]),b("onMouseLeave",["mouseout","mouseover"]),b("onPointerEnter",["pointerout","pointerover"]),b("onPointerLeave",["pointerout","pointerover"]),x("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),x("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),x("onBeforeInput",["compositionend","keypress","textInput","paste"]),x("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),x("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),x("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ll=new Set("cancel close invalid load scroll toggle".split(" ").concat(tn));function oo(e,o,f){var I=e.type||"unknown-event";e.currentTarget=f,ai(I,o,void 0,e),e.currentTarget=null}function fs(e,o){o=(o&4)!==0;for(var f=0;f<e.length;f++){var I=e[f],j=I.event;I=I.listeners;e:{var $=void 0;if(o)for(var te=I.length-1;0<=te;te--){var fe=I[te],be=fe.instance,Ve=fe.currentTarget;if(fe=fe.listener,be!==$&&j.isPropagationStopped())break e;oo(j,fe,Ve),$=be}else for(te=0;te<I.length;te++){if(fe=I[te],be=fe.instance,Ve=fe.currentTarget,fe=fe.listener,be!==$&&j.isPropagationStopped())break e;oo(j,fe,Ve),$=be}}}if(Pt)throw e=Qt,Pt=!1,Qt=null,e}function Ut(e,o){var f=o[In];f===void 0&&(f=o[In]=new Set);var I=e+"__bubble";f.has(I)||(sa(o,e,2,!1),f.add(I))}function ao(e,o,f){var I=0;o&&(I|=4),sa(f,e,I,o)}var Mn="_reactListening"+Math.random().toString(36).slice(2);function Rn(e){if(!e[Mn]){e[Mn]=!0,u.forEach(function(f){f!=="selectionchange"&&(ll.has(f)||ao(f,!1,e),ao(f,!0,e))});var o=e.nodeType===9?e:e.ownerDocument;o===null||o[Mn]||(o[Mn]=!0,ao("selectionchange",!1,o))}}function sa(e,o,f,I){switch(zo(o)){case 1:var j=Ua;break;case 4:j=Wa;break;default:j=Os}f=j.bind(null,o,f,e),j=void 0,!dt||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(j=!0),I?j!==void 0?e.addEventListener(o,f,{capture:!0,passive:j}):e.addEventListener(o,f,!0):j!==void 0?e.addEventListener(o,f,{passive:j}):e.addEventListener(o,f,!1)}function lo(e,o,f,I,j){var $=I;if((o&1)===0&&(o&2)===0&&I!==null)e:for(;;){if(I===null)return;var te=I.tag;if(te===3||te===4){var fe=I.stateNode.containerInfo;if(fe===j||fe.nodeType===8&&fe.parentNode===j)break;if(te===4)for(te=I.return;te!==null;){var be=te.tag;if((be===3||be===4)&&(be=te.stateNode.containerInfo,be===j||be.nodeType===8&&be.parentNode===j))return;te=te.return}for(;fe!==null;){if(te=Li(fe),te===null)return;if(be=te.tag,be===5||be===6){I=$=te;continue e}fe=fe.parentNode}}I=I.return}ct(function(){var Ve=$,et=je(f),it=[];e:{var Ze=ra.get(e);if(Ze!==void 0){var pt=Vs,gt=e;switch(e){case"keypress":if(Kn(f)===0)break e;case"keydown":case"keyup":pt=nl;break;case"focusin":gt="focus",pt=Ji;break;case"focusout":gt="blur",pt=Ji;break;case"beforeblur":case"afterblur":pt=Ji;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pt=Oo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pt=qa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pt=Qi;break;case io:case no:case ea:pt=Ja;break;case ta:pt=Vo;break;case"scroll":pt=Ha;break;case"wheel":pt=Us;break;case"copy":case"cut":case"paste":pt=Ka;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pt=jo}var vt=(o&4)!==0,or=!vt&&e==="scroll",Ie=vt?Ze!==null?Ze+"Capture":null:Ze;vt=[];for(var Ce=Ve,Le;Ce!==null;){Le=Ce;var at=Le.stateNode;if(Le.tag===5&&at!==null&&(Le=at,Ie!==null&&(at=lt(Ce,Ie),at!=null&&vt.push(kn(Ce,at,Le)))),or)break;Ce=Ce.return}0<vt.length&&(Ze=new pt(Ze,gt,null,f,et),it.push({event:Ze,listeners:vt}))}}if((o&7)===0){e:{if(Ze=e==="mouseover"||e==="pointerover",pt=e==="mouseout"||e==="pointerout",Ze&&f!==ye&&(gt=f.relatedTarget||f.fromElement)&&(Li(gt)||gt[Pr]))break e;if((pt||Ze)&&(Ze=et.window===et?et:(Ze=et.ownerDocument)?Ze.defaultView||Ze.parentWindow:window,pt?(gt=f.relatedTarget||f.toElement,pt=Ve,gt=gt?Li(gt):null,gt!==null&&(or=Lt(gt),gt!==or||gt.tag!==5&&gt.tag!==6)&&(gt=null)):(pt=null,gt=Ve),pt!==gt)){if(vt=Oo,at="onMouseLeave",Ie="onMouseEnter",Ce="mouse",(e==="pointerout"||e==="pointerover")&&(vt=jo,at="onPointerLeave",Ie="onPointerEnter",Ce="pointer"),or=pt==null?Ze:sn(pt),Le=gt==null?Ze:sn(gt),Ze=new vt(at,Ce+"leave",pt,f,et),Ze.target=or,Ze.relatedTarget=Le,at=null,Li(et)===Ve&&(vt=new vt(Ie,Ce+"enter",gt,f,et),vt.target=Le,vt.relatedTarget=or,at=vt),or=at,pt&&gt)t:{for(vt=pt,Ie=gt,Ce=0,Le=vt;Le;Le=rn(Le))Ce++;for(Le=0,at=Ie;at;at=rn(at))Le++;for(;0<Ce-Le;)vt=rn(vt),Ce--;for(;0<Le-Ce;)Ie=rn(Ie),Le--;for(;Ce--;){if(vt===Ie||Ie!==null&&vt===Ie.alternate)break t;vt=rn(vt),Ie=rn(Ie)}vt=null}else vt=null;pt!==null&&oa(it,Ze,pt,vt,!1),gt!==null&&or!==null&&oa(it,or,gt,vt,!0)}}e:{if(Ze=Ve?sn(Ve):window,pt=Ze.nodeName&&Ze.nodeName.toLowerCase(),pt==="select"||pt==="input"&&Ze.type==="file")var xt=Yo;else if(Ho(Ze))if(An)xt=Ko;else{xt=Jo;var Ct=Xo}else(pt=Ze.nodeName)&&pt.toLowerCase()==="input"&&(Ze.type==="checkbox"||Ze.type==="radio")&&(xt=Qo);if(xt&&(xt=xt(e,Ve))){$o(it,xt,f,et);break e}Ct&&Ct(e,Ze,Ve),e==="focusout"&&(Ct=Ze._wrapperState)&&Ct.controlled&&Ze.type==="number"&&ot(Ze,"number",Ze.value)}switch(Ct=Ve?sn(Ve):window,e){case"focusin":(Ho(Ct)||Ct.contentEditable==="true")&&(ti=Ct,us=Ve,en=null);break;case"focusout":en=us=ti=null;break;case"mousedown":cs=!0;break;case"contextmenu":case"mouseup":case"dragend":cs=!1,to(it,f,et);break;case"selectionchange":if(ls)break;case"keydown":case"keyup":to(it,f,et)}var Et;if(Ws)e:{switch(e){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else Ii?Hs(e,f)&&(Tt="onCompositionEnd"):e==="keydown"&&f.keyCode===229&&(Tt="onCompositionStart");Tt&&(Uo&&f.locale!=="ko"&&(Ii||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&Ii&&(Et=Lo()):(pi=et,Ri="value"in pi?pi.value:pi.textContent,Ii=!0)),Ct=ps(Ve,Tt),0<Ct.length&&(Tt=new Zn(Tt,e,null,f,et),it.push({event:Tt,listeners:Ct}),Et?Tt.data=Et:(Et=$s(f),Et!==null&&(Tt.data=Et)))),(Et=ol?al(e,f):ts(e,f))&&(Ve=ps(Ve,"onBeforeInput"),0<Ve.length&&(et=new Zn("onBeforeInput","beforeinput",null,f,et),it.push({event:et,listeners:Ve}),et.data=Et))}fs(it,o)})}function kn(e,o,f){return{instance:e,listener:o,currentTarget:f}}function ps(e,o){for(var f=o+"Capture",I=[];e!==null;){var j=e,$=j.stateNode;j.tag===5&&$!==null&&(j=$,$=lt(e,f),$!=null&&I.unshift(kn(e,$,j)),$=lt(e,o),$!=null&&I.push(kn(e,$,j))),e=e.return}return I}function rn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function oa(e,o,f,I,j){for(var $=o._reactName,te=[];f!==null&&f!==I;){var fe=f,be=fe.alternate,Ve=fe.stateNode;if(be!==null&&be===I)break;fe.tag===5&&Ve!==null&&(fe=Ve,j?(be=lt(f,$),be!=null&&te.unshift(kn(f,be,fe))):j||(be=lt(f,$),be!=null&&te.push(kn(f,be,fe)))),f=f.return}te.length!==0&&e.push({event:o,listeners:te})}var ul=/\r\n?/g,cl=/\u0000|\uFFFD/g;function aa(e){return(typeof e=="string"?e:""+e).replace(ul,`
`).replace(cl,"")}function ms(e,o,f){if(o=aa(o),aa(e)!==o&&f)throw Error(r(425))}function gs(){}var uo=null,co=null;function Br(e,o){return e==="textarea"||e==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var ho=typeof setTimeout=="function"?setTimeout:void 0,dl=typeof clearTimeout=="function"?clearTimeout:void 0,fo=typeof Promise=="function"?Promise:void 0,hl=typeof queueMicrotask=="function"?queueMicrotask:typeof fo<"u"?function(e){return fo.resolve(null).then(e).catch(fl)}:ho;function fl(e){setTimeout(function(){throw e})}function zi(e,o){var f=o,I=0;do{var j=f.nextSibling;if(e.removeChild(f),j&&j.nodeType===8)if(f=j.data,f==="/$"){if(I===0){e.removeChild(j),bn(o);return}I--}else f!=="$"&&f!=="$?"&&f!=="$!"||I++;f=j}while(f);bn(o)}function $r(e){for(;e!=null;e=e.nextSibling){var o=e.nodeType;if(o===1||o===3)break;if(o===8){if(o=e.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return e}function vs(e){e=e.previousSibling;for(var o=0;e;){if(e.nodeType===8){var f=e.data;if(f==="$"||f==="$!"||f==="$?"){if(o===0)return e;o--}else f==="/$"&&o++}e=e.previousSibling}return null}var nn=Math.random().toString(36).slice(2),Gr="__reactFiber$"+nn,Pn="__reactProps$"+nn,Pr="__reactContainer$"+nn,In="__reactEvents$"+nn,pl="__reactListeners$"+nn,ml="__reactHandles$"+nn;function Li(e){var o=e[Gr];if(o)return o;for(var f=e.parentNode;f;){if(o=f[Pr]||f[Gr]){if(f=o.alternate,o.child!==null||f!==null&&f.child!==null)for(e=vs(e);e!==null;){if(f=e[Gr])return f;e=vs(e)}return o}e=f,f=e.parentNode}return null}function Fn(e){return e=e[Gr]||e[Pr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function sn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(r(33))}function ys(e){return e[Pn]||null}var po=[],on=-1;function vi(e){return{current:e}}function Yt(e){0>on||(e.current=po[on],po[on]=null,on--)}function Ht(e,o){on++,po[on]=e.current,e.current=o}var yi={},hr=vi(yi),Er=vi(!1),xi=yi;function Oi(e,o){var f=e.type.contextTypes;if(!f)return yi;var I=e.stateNode;if(I&&I.__reactInternalMemoizedUnmaskedChildContext===o)return I.__reactInternalMemoizedMaskedChildContext;var j={},$;for($ in f)j[$]=o[$];return I&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=j),j}function xr(e){return e=e.childContextTypes,e!=null}function Dn(){Yt(Er),Yt(hr)}function mo(e,o,f){if(hr.current!==yi)throw Error(r(168));Ht(hr,o),Ht(Er,f)}function go(e,o,f){var I=e.stateNode;if(o=o.childContextTypes,typeof I.getChildContext!="function")return f;I=I.getChildContext();for(var j in I)if(!(j in o))throw Error(r(108,de(e)||"Unknown",j));return X({},f,I)}function zn(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||yi,xi=hr.current,Ht(hr,e),Ht(Er,Er.current),!0}function vo(e,o,f){var I=e.stateNode;if(!I)throw Error(r(169));f?(e=go(e,o,xi),I.__reactInternalMemoizedMergedChildContext=e,Yt(Er),Yt(hr),Ht(hr,e)):Yt(Er),Ht(Er,f)}var qr=null,xs=!1,A=!1;function Q(e){qr===null?qr=[e]:qr.push(e)}function z(e){xs=!0,Q(e)}function ne(){if(!A&&qr!==null){A=!0;var e=0,o=Rt;try{var f=qr;for(Rt=1;e<f.length;e++){var I=f[e];do I=I(!0);while(I!==null)}qr=null,xs=!1}catch(j){throw qr!==null&&(qr=qr.slice(e+1)),gn(Ei,ne),j}finally{Rt=o,A=!1}}return null}var le=[],ce=0,ze=null,Ae=0,ht=[],_e=0,Pe=null,Ft=1,nt="";function Ye(e,o){le[ce++]=Ae,le[ce++]=ze,ze=e,Ae=o}function $t(e,o,f){ht[_e++]=Ft,ht[_e++]=nt,ht[_e++]=Pe,Pe=e;var I=Ft;e=nt;var j=32-Rr(I)-1;I&=~(1<<j),f+=1;var $=32-Rr(o)+j;if(30<$){var te=j-j%5;$=(I&(1<<te)-1).toString(32),I>>=te,j-=te,Ft=1<<32-Rr(o)+j|f<<j|I,nt=$+e}else Ft=1<<$|f<<j|I,nt=e}function Xt(e){e.return!==null&&(Ye(e,1),$t(e,1,0))}function zt(e){for(;e===ze;)ze=le[--ce],le[ce]=null,Ae=le[--ce],le[ce]=null;for(;e===Pe;)Pe=ht[--_e],ht[_e]=null,nt=ht[--_e],ht[_e]=null,Ft=ht[--_e],ht[_e]=null}var bt=null,_t=null,tt=!1,wt=null;function tr(e,o){var f=Qr(5,null,null,0);f.elementType="DELETED",f.stateNode=o,f.return=e,o=e.deletions,o===null?(e.deletions=[f],e.flags|=16):o.push(f)}function Ot(e,o){switch(e.tag){case 5:var f=e.type;return o=o.nodeType!==1||f.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(e.stateNode=o,bt=e,_t=$r(o.firstChild),!0):!1;case 6:return o=e.pendingProps===""||o.nodeType!==3?null:o,o!==null?(e.stateNode=o,bt=e,_t=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(f=Pe!==null?{id:Ft,overflow:nt}:null,e.memoizedState={dehydrated:o,treeContext:f,retryLane:1073741824},f=Qr(18,null,null,0),f.stateNode=o,f.return=e,e.child=f,bt=e,_t=null,!0):!1;default:return!1}}function Dt(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Bt(e){if(tt){var o=_t;if(o){var f=o;if(!Ot(e,o)){if(Dt(e))throw Error(r(418));o=$r(f.nextSibling);var I=bt;o&&Ot(e,o)?tr(I,f):(e.flags=e.flags&-4097|2,tt=!1,bt=e)}}else{if(Dt(e))throw Error(r(418));e.flags=e.flags&-4097|2,tt=!1,bt=e}}}function St(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;bt=e}function kt(e){if(e!==bt)return!1;if(!tt)return St(e),tt=!0,!1;var o;if((o=e.tag!==3)&&!(o=e.tag!==5)&&(o=e.type,o=o!=="head"&&o!=="body"&&!Br(e.type,e.memoizedProps)),o&&(o=_t)){if(Dt(e))throw fr(),Error(r(418));for(;o;)tr(e,o),o=$r(o.nextSibling)}if(St(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(r(317));e:{for(e=e.nextSibling,o=0;e;){if(e.nodeType===8){var f=e.data;if(f==="/$"){if(o===0){_t=$r(e.nextSibling);break e}o--}else f!=="$"&&f!=="$!"&&f!=="$?"||o++}e=e.nextSibling}_t=null}}else _t=bt?$r(e.stateNode.nextSibling):null;return!0}function fr(){for(var e=_t;e;)e=$r(e.nextSibling)}function zr(){_t=bt=null,tt=!1}function _s(e){wt===null?wt=[e]:wt.push(e)}var bs=M.ReactCurrentBatchConfig;function _i(e,o,f){if(e=f.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(r(309));var I=f.stateNode}if(!I)throw Error(r(147,e));var j=I,$=""+e;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===$?o.ref:(o=function(te){var fe=j.refs;te===null?delete fe[$]:fe[$]=te},o._stringRef=$,o)}if(typeof e!="string")throw Error(r(284));if(!f._owner)throw Error(r(290,e))}return e}function la(e,o){throw e=Object.prototype.toString.call(o),Error(r(31,e==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":e))}function hu(e){var o=e._init;return o(e._payload)}function fu(e){function o(Ie,Ce){if(e){var Le=Ie.deletions;Le===null?(Ie.deletions=[Ce],Ie.flags|=16):Le.push(Ce)}}function f(Ie,Ce){if(!e)return null;for(;Ce!==null;)o(Ie,Ce),Ce=Ce.sibling;return null}function I(Ie,Ce){for(Ie=new Map;Ce!==null;)Ce.key!==null?Ie.set(Ce.key,Ce):Ie.set(Ce.index,Ce),Ce=Ce.sibling;return Ie}function j(Ie,Ce){return Ie=pn(Ie,Ce),Ie.index=0,Ie.sibling=null,Ie}function $(Ie,Ce,Le){return Ie.index=Le,e?(Le=Ie.alternate,Le!==null?(Le=Le.index,Le<Ce?(Ie.flags|=2,Ce):Le):(Ie.flags|=2,Ce)):(Ie.flags|=1048576,Ce)}function te(Ie){return e&&Ie.alternate===null&&(Ie.flags|=2),Ie}function fe(Ie,Ce,Le,at){return Ce===null||Ce.tag!==6?(Ce=ou(Le,Ie.mode,at),Ce.return=Ie,Ce):(Ce=j(Ce,Le),Ce.return=Ie,Ce)}function be(Ie,Ce,Le,at){var xt=Le.type;return xt===S?et(Ie,Ce,Le.props.children,at,Le.key):Ce!==null&&(Ce.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===q&&hu(xt)===Ce.type)?(at=j(Ce,Le.props),at.ref=_i(Ie,Ce,Le),at.return=Ie,at):(at=Ia(Le.type,Le.key,Le.props,null,Ie.mode,at),at.ref=_i(Ie,Ce,Le),at.return=Ie,at)}function Ve(Ie,Ce,Le,at){return Ce===null||Ce.tag!==4||Ce.stateNode.containerInfo!==Le.containerInfo||Ce.stateNode.implementation!==Le.implementation?(Ce=au(Le,Ie.mode,at),Ce.return=Ie,Ce):(Ce=j(Ce,Le.children||[]),Ce.return=Ie,Ce)}function et(Ie,Ce,Le,at,xt){return Ce===null||Ce.tag!==7?(Ce=Un(Le,Ie.mode,at,xt),Ce.return=Ie,Ce):(Ce=j(Ce,Le),Ce.return=Ie,Ce)}function it(Ie,Ce,Le){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return Ce=ou(""+Ce,Ie.mode,Le),Ce.return=Ie,Ce;if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case l:return Le=Ia(Ce.type,Ce.key,Ce.props,null,Ie.mode,Le),Le.ref=_i(Ie,null,Ce),Le.return=Ie,Le;case h:return Ce=au(Ce,Ie.mode,Le),Ce.return=Ie,Ce;case q:var at=Ce._init;return it(Ie,at(Ce._payload),Le)}if(Ke(Ce)||Y(Ce))return Ce=Un(Ce,Ie.mode,Le,null),Ce.return=Ie,Ce;la(Ie,Ce)}return null}function Ze(Ie,Ce,Le,at){var xt=Ce!==null?Ce.key:null;if(typeof Le=="string"&&Le!==""||typeof Le=="number")return xt!==null?null:fe(Ie,Ce,""+Le,at);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case l:return Le.key===xt?be(Ie,Ce,Le,at):null;case h:return Le.key===xt?Ve(Ie,Ce,Le,at):null;case q:return xt=Le._init,Ze(Ie,Ce,xt(Le._payload),at)}if(Ke(Le)||Y(Le))return xt!==null?null:et(Ie,Ce,Le,at,null);la(Ie,Le)}return null}function pt(Ie,Ce,Le,at,xt){if(typeof at=="string"&&at!==""||typeof at=="number")return Ie=Ie.get(Le)||null,fe(Ce,Ie,""+at,xt);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case l:return Ie=Ie.get(at.key===null?Le:at.key)||null,be(Ce,Ie,at,xt);case h:return Ie=Ie.get(at.key===null?Le:at.key)||null,Ve(Ce,Ie,at,xt);case q:var Ct=at._init;return pt(Ie,Ce,Le,Ct(at._payload),xt)}if(Ke(at)||Y(at))return Ie=Ie.get(Le)||null,et(Ce,Ie,at,xt,null);la(Ce,at)}return null}function gt(Ie,Ce,Le,at){for(var xt=null,Ct=null,Et=Ce,Tt=Ce=0,gr=null;Et!==null&&Tt<Le.length;Tt++){Et.index>Tt?(gr=Et,Et=null):gr=Et.sibling;var Vt=Ze(Ie,Et,Le[Tt],at);if(Vt===null){Et===null&&(Et=gr);break}e&&Et&&Vt.alternate===null&&o(Ie,Et),Ce=$(Vt,Ce,Tt),Ct===null?xt=Vt:Ct.sibling=Vt,Ct=Vt,Et=gr}if(Tt===Le.length)return f(Ie,Et),tt&&Ye(Ie,Tt),xt;if(Et===null){for(;Tt<Le.length;Tt++)Et=it(Ie,Le[Tt],at),Et!==null&&(Ce=$(Et,Ce,Tt),Ct===null?xt=Et:Ct.sibling=Et,Ct=Et);return tt&&Ye(Ie,Tt),xt}for(Et=I(Ie,Et);Tt<Le.length;Tt++)gr=pt(Et,Ie,Tt,Le[Tt],at),gr!==null&&(e&&gr.alternate!==null&&Et.delete(gr.key===null?Tt:gr.key),Ce=$(gr,Ce,Tt),Ct===null?xt=gr:Ct.sibling=gr,Ct=gr);return e&&Et.forEach(function(mn){return o(Ie,mn)}),tt&&Ye(Ie,Tt),xt}function vt(Ie,Ce,Le,at){var xt=Y(Le);if(typeof xt!="function")throw Error(r(150));if(Le=xt.call(Le),Le==null)throw Error(r(151));for(var Ct=xt=null,Et=Ce,Tt=Ce=0,gr=null,Vt=Le.next();Et!==null&&!Vt.done;Tt++,Vt=Le.next()){Et.index>Tt?(gr=Et,Et=null):gr=Et.sibling;var mn=Ze(Ie,Et,Vt.value,at);if(mn===null){Et===null&&(Et=gr);break}e&&Et&&mn.alternate===null&&o(Ie,Et),Ce=$(mn,Ce,Tt),Ct===null?xt=mn:Ct.sibling=mn,Ct=mn,Et=gr}if(Vt.done)return f(Ie,Et),tt&&Ye(Ie,Tt),xt;if(Et===null){for(;!Vt.done;Tt++,Vt=Le.next())Vt=it(Ie,Vt.value,at),Vt!==null&&(Ce=$(Vt,Ce,Tt),Ct===null?xt=Vt:Ct.sibling=Vt,Ct=Vt);return tt&&Ye(Ie,Tt),xt}for(Et=I(Ie,Et);!Vt.done;Tt++,Vt=Le.next())Vt=pt(Et,Ie,Tt,Vt.value,at),Vt!==null&&(e&&Vt.alternate!==null&&Et.delete(Vt.key===null?Tt:Vt.key),Ce=$(Vt,Ce,Tt),Ct===null?xt=Vt:Ct.sibling=Vt,Ct=Vt);return e&&Et.forEach(function(pd){return o(Ie,pd)}),tt&&Ye(Ie,Tt),xt}function or(Ie,Ce,Le,at){if(typeof Le=="object"&&Le!==null&&Le.type===S&&Le.key===null&&(Le=Le.props.children),typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case l:e:{for(var xt=Le.key,Ct=Ce;Ct!==null;){if(Ct.key===xt){if(xt=Le.type,xt===S){if(Ct.tag===7){f(Ie,Ct.sibling),Ce=j(Ct,Le.props.children),Ce.return=Ie,Ie=Ce;break e}}else if(Ct.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===q&&hu(xt)===Ct.type){f(Ie,Ct.sibling),Ce=j(Ct,Le.props),Ce.ref=_i(Ie,Ct,Le),Ce.return=Ie,Ie=Ce;break e}f(Ie,Ct);break}else o(Ie,Ct);Ct=Ct.sibling}Le.type===S?(Ce=Un(Le.props.children,Ie.mode,at,Le.key),Ce.return=Ie,Ie=Ce):(at=Ia(Le.type,Le.key,Le.props,null,Ie.mode,at),at.ref=_i(Ie,Ce,Le),at.return=Ie,Ie=at)}return te(Ie);case h:e:{for(Ct=Le.key;Ce!==null;){if(Ce.key===Ct)if(Ce.tag===4&&Ce.stateNode.containerInfo===Le.containerInfo&&Ce.stateNode.implementation===Le.implementation){f(Ie,Ce.sibling),Ce=j(Ce,Le.children||[]),Ce.return=Ie,Ie=Ce;break e}else{f(Ie,Ce);break}else o(Ie,Ce);Ce=Ce.sibling}Ce=au(Le,Ie.mode,at),Ce.return=Ie,Ie=Ce}return te(Ie);case q:return Ct=Le._init,or(Ie,Ce,Ct(Le._payload),at)}if(Ke(Le))return gt(Ie,Ce,Le,at);if(Y(Le))return vt(Ie,Ce,Le,at);la(Ie,Le)}return typeof Le=="string"&&Le!==""||typeof Le=="number"?(Le=""+Le,Ce!==null&&Ce.tag===6?(f(Ie,Ce.sibling),Ce=j(Ce,Le),Ce.return=Ie,Ie=Ce):(f(Ie,Ce),Ce=ou(Le,Ie.mode,at),Ce.return=Ie,Ie=Ce),te(Ie)):f(Ie,Ce)}return or}var ws=fu(!0),pu=fu(!1),ua=vi(null),ca=null,Ss=null,gl=null;function vl(){gl=Ss=ca=null}function yl(e){var o=ua.current;Yt(ua),e._currentValue=o}function xl(e,o,f){for(;e!==null;){var I=e.alternate;if((e.childLanes&o)!==o?(e.childLanes|=o,I!==null&&(I.childLanes|=o)):I!==null&&(I.childLanes&o)!==o&&(I.childLanes|=o),e===f)break;e=e.return}}function Cs(e,o){ca=e,gl=Ss=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&o)!==0&&(Lr=!0),e.firstContext=null)}function Yr(e){var o=e._currentValue;if(gl!==e)if(e={context:e,memoizedValue:o,next:null},Ss===null){if(ca===null)throw Error(r(308));Ss=e,ca.dependencies={lanes:0,firstContext:e}}else Ss=Ss.next=e;return o}var Ln=null;function _l(e){Ln===null?Ln=[e]:Ln.push(e)}function mu(e,o,f,I){var j=o.interleaved;return j===null?(f.next=f,_l(o)):(f.next=j.next,j.next=f),o.interleaved=f,ji(e,I)}function ji(e,o){e.lanes|=o;var f=e.alternate;for(f!==null&&(f.lanes|=o),f=e,e=e.return;e!==null;)e.childLanes|=o,f=e.alternate,f!==null&&(f.childLanes|=o),f=e,e=e.return;return f.tag===3?f.stateNode:null}var an=!1;function bl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gu(e,o){e=e.updateQueue,o.updateQueue===e&&(o.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ni(e,o){return{eventTime:e,lane:o,tag:0,payload:null,callback:null,next:null}}function ln(e,o,f){var I=e.updateQueue;if(I===null)return null;if(I=I.shared,(Nt&2)!==0){var j=I.pending;return j===null?o.next=o:(o.next=j.next,j.next=o),I.pending=o,ji(e,f)}return j=I.interleaved,j===null?(o.next=o,_l(I)):(o.next=j.next,j.next=o),I.interleaved=o,ji(e,f)}function da(e,o,f){if(o=o.updateQueue,o!==null&&(o=o.shared,(f&4194240)!==0)){var I=o.lanes;I&=e.pendingLanes,f|=I,o.lanes=f,Hr(e,f)}}function vu(e,o){var f=e.updateQueue,I=e.alternate;if(I!==null&&(I=I.updateQueue,f===I)){var j=null,$=null;if(f=f.firstBaseUpdate,f!==null){do{var te={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};$===null?j=$=te:$=$.next=te,f=f.next}while(f!==null);$===null?j=$=o:$=$.next=o}else j=$=o;f={baseState:I.baseState,firstBaseUpdate:j,lastBaseUpdate:$,shared:I.shared,effects:I.effects},e.updateQueue=f;return}e=f.lastBaseUpdate,e===null?f.firstBaseUpdate=o:e.next=o,f.lastBaseUpdate=o}function ha(e,o,f,I){var j=e.updateQueue;an=!1;var $=j.firstBaseUpdate,te=j.lastBaseUpdate,fe=j.shared.pending;if(fe!==null){j.shared.pending=null;var be=fe,Ve=be.next;be.next=null,te===null?$=Ve:te.next=Ve,te=be;var et=e.alternate;et!==null&&(et=et.updateQueue,fe=et.lastBaseUpdate,fe!==te&&(fe===null?et.firstBaseUpdate=Ve:fe.next=Ve,et.lastBaseUpdate=be))}if($!==null){var it=j.baseState;te=0,et=Ve=be=null,fe=$;do{var Ze=fe.lane,pt=fe.eventTime;if((I&Ze)===Ze){et!==null&&(et=et.next={eventTime:pt,lane:0,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null});e:{var gt=e,vt=fe;switch(Ze=o,pt=f,vt.tag){case 1:if(gt=vt.payload,typeof gt=="function"){it=gt.call(pt,it,Ze);break e}it=gt;break e;case 3:gt.flags=gt.flags&-65537|128;case 0:if(gt=vt.payload,Ze=typeof gt=="function"?gt.call(pt,it,Ze):gt,Ze==null)break e;it=X({},it,Ze);break e;case 2:an=!0}}fe.callback!==null&&fe.lane!==0&&(e.flags|=64,Ze=j.effects,Ze===null?j.effects=[fe]:Ze.push(fe))}else pt={eventTime:pt,lane:Ze,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null},et===null?(Ve=et=pt,be=it):et=et.next=pt,te|=Ze;if(fe=fe.next,fe===null){if(fe=j.shared.pending,fe===null)break;Ze=fe,fe=Ze.next,Ze.next=null,j.lastBaseUpdate=Ze,j.shared.pending=null}}while(!0);if(et===null&&(be=it),j.baseState=be,j.firstBaseUpdate=Ve,j.lastBaseUpdate=et,o=j.shared.interleaved,o!==null){j=o;do te|=j.lane,j=j.next;while(j!==o)}else $===null&&(j.shared.lanes=0);Nn|=te,e.lanes=te,e.memoizedState=it}}function yu(e,o,f){if(e=o.effects,o.effects=null,e!==null)for(o=0;o<e.length;o++){var I=e[o],j=I.callback;if(j!==null){if(I.callback=null,I=f,typeof j!="function")throw Error(r(191,j));j.call(I)}}}var yo={},bi=vi(yo),xo=vi(yo),_o=vi(yo);function On(e){if(e===yo)throw Error(r(174));return e}function wl(e,o){switch(Ht(_o,o),Ht(xo,e),Ht(bi,yo),e=o.nodeType,e){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:ee(null,"");break;default:e=e===8?o.parentNode:o,o=e.namespaceURI||null,e=e.tagName,o=ee(o,e)}Yt(bi),Ht(bi,o)}function Es(){Yt(bi),Yt(xo),Yt(_o)}function xu(e){On(_o.current);var o=On(bi.current),f=ee(o,e.type);o!==f&&(Ht(xo,e),Ht(bi,f))}function Sl(e){xo.current===e&&(Yt(bi),Yt(xo))}var Zt=vi(0);function fa(e){for(var o=e;o!==null;){if(o.tag===13){var f=o.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Cl=[];function El(){for(var e=0;e<Cl.length;e++)Cl[e]._workInProgressVersionPrimary=null;Cl.length=0}var pa=M.ReactCurrentDispatcher,Al=M.ReactCurrentBatchConfig,jn=0,er=null,ur=null,pr=null,ma=!1,bo=!1,wo=0,zc=0;function Ar(){throw Error(r(321))}function Tl(e,o){if(o===null)return!1;for(var f=0;f<o.length&&f<e.length;f++)if(!sr(e[f],o[f]))return!1;return!0}function Ml(e,o,f,I,j,$){if(jn=$,er=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,pa.current=e===null||e.memoizedState===null?Nc:Vc,e=f(I,j),bo){$=0;do{if(bo=!1,wo=0,25<=$)throw Error(r(301));$+=1,pr=ur=null,o.updateQueue=null,pa.current=Bc,e=f(I,j)}while(bo)}if(pa.current=ya,o=ur!==null&&ur.next!==null,jn=0,pr=ur=er=null,ma=!1,o)throw Error(r(300));return e}function Rl(){var e=wo!==0;return wo=0,e}function wi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pr===null?er.memoizedState=pr=e:pr=pr.next=e,pr}function Xr(){if(ur===null){var e=er.alternate;e=e!==null?e.memoizedState:null}else e=ur.next;var o=pr===null?er.memoizedState:pr.next;if(o!==null)pr=o,ur=e;else{if(e===null)throw Error(r(310));ur=e,e={memoizedState:ur.memoizedState,baseState:ur.baseState,baseQueue:ur.baseQueue,queue:ur.queue,next:null},pr===null?er.memoizedState=pr=e:pr=pr.next=e}return pr}function So(e,o){return typeof o=="function"?o(e):o}function kl(e){var o=Xr(),f=o.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=e;var I=ur,j=I.baseQueue,$=f.pending;if($!==null){if(j!==null){var te=j.next;j.next=$.next,$.next=te}I.baseQueue=j=$,f.pending=null}if(j!==null){$=j.next,I=I.baseState;var fe=te=null,be=null,Ve=$;do{var et=Ve.lane;if((jn&et)===et)be!==null&&(be=be.next={lane:0,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null}),I=Ve.hasEagerState?Ve.eagerState:e(I,Ve.action);else{var it={lane:et,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null};be===null?(fe=be=it,te=I):be=be.next=it,er.lanes|=et,Nn|=et}Ve=Ve.next}while(Ve!==null&&Ve!==$);be===null?te=I:be.next=fe,sr(I,o.memoizedState)||(Lr=!0),o.memoizedState=I,o.baseState=te,o.baseQueue=be,f.lastRenderedState=I}if(e=f.interleaved,e!==null){j=e;do $=j.lane,er.lanes|=$,Nn|=$,j=j.next;while(j!==e)}else j===null&&(f.lanes=0);return[o.memoizedState,f.dispatch]}function Pl(e){var o=Xr(),f=o.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=e;var I=f.dispatch,j=f.pending,$=o.memoizedState;if(j!==null){f.pending=null;var te=j=j.next;do $=e($,te.action),te=te.next;while(te!==j);sr($,o.memoizedState)||(Lr=!0),o.memoizedState=$,o.baseQueue===null&&(o.baseState=$),f.lastRenderedState=$}return[$,I]}function _u(){}function bu(e,o){var f=er,I=Xr(),j=o(),$=!sr(I.memoizedState,j);if($&&(I.memoizedState=j,Lr=!0),I=I.queue,Il(Cu.bind(null,f,I,e),[e]),I.getSnapshot!==o||$||pr!==null&&pr.memoizedState.tag&1){if(f.flags|=2048,Co(9,Su.bind(null,f,I,j,o),void 0,null),mr===null)throw Error(r(349));(jn&30)!==0||wu(f,o,j)}return j}function wu(e,o,f){e.flags|=16384,e={getSnapshot:o,value:f},o=er.updateQueue,o===null?(o={lastEffect:null,stores:null},er.updateQueue=o,o.stores=[e]):(f=o.stores,f===null?o.stores=[e]:f.push(e))}function Su(e,o,f,I){o.value=f,o.getSnapshot=I,Eu(o)&&Au(e)}function Cu(e,o,f){return f(function(){Eu(o)&&Au(e)})}function Eu(e){var o=e.getSnapshot;e=e.value;try{var f=o();return!sr(e,f)}catch{return!0}}function Au(e){var o=ji(e,1);o!==null&&oi(o,e,1,-1)}function Tu(e){var o=wi();return typeof e=="function"&&(e=e()),o.memoizedState=o.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:e},o.queue=e,e=e.dispatch=jc.bind(null,er,e),[o.memoizedState,e]}function Co(e,o,f,I){return e={tag:e,create:o,destroy:f,deps:I,next:null},o=er.updateQueue,o===null?(o={lastEffect:null,stores:null},er.updateQueue=o,o.lastEffect=e.next=e):(f=o.lastEffect,f===null?o.lastEffect=e.next=e:(I=f.next,f.next=e,e.next=I,o.lastEffect=e)),e}function Mu(){return Xr().memoizedState}function ga(e,o,f,I){var j=wi();er.flags|=e,j.memoizedState=Co(1|o,f,void 0,I===void 0?null:I)}function va(e,o,f,I){var j=Xr();I=I===void 0?null:I;var $=void 0;if(ur!==null){var te=ur.memoizedState;if($=te.destroy,I!==null&&Tl(I,te.deps)){j.memoizedState=Co(o,f,$,I);return}}er.flags|=e,j.memoizedState=Co(1|o,f,$,I)}function Ru(e,o){return ga(8390656,8,e,o)}function Il(e,o){return va(2048,8,e,o)}function ku(e,o){return va(4,2,e,o)}function Pu(e,o){return va(4,4,e,o)}function Iu(e,o){if(typeof o=="function")return e=e(),o(e),function(){o(null)};if(o!=null)return e=e(),o.current=e,function(){o.current=null}}function Fu(e,o,f){return f=f!=null?f.concat([e]):null,va(4,4,Iu.bind(null,o,e),f)}function Fl(){}function Du(e,o){var f=Xr();o=o===void 0?null:o;var I=f.memoizedState;return I!==null&&o!==null&&Tl(o,I[1])?I[0]:(f.memoizedState=[e,o],e)}function zu(e,o){var f=Xr();o=o===void 0?null:o;var I=f.memoizedState;return I!==null&&o!==null&&Tl(o,I[1])?I[0]:(e=e(),f.memoizedState=[e,o],e)}function Lu(e,o,f){return(jn&21)===0?(e.baseState&&(e.baseState=!1,Lr=!0),e.memoizedState=f):(sr(f,o)||(f=ci(),er.lanes|=f,Nn|=f,e.baseState=!0),o)}function Lc(e,o){var f=Rt;Rt=f!==0&&4>f?f:4,e(!0);var I=Al.transition;Al.transition={};try{e(!1),o()}finally{Rt=f,Al.transition=I}}function Ou(){return Xr().memoizedState}function Oc(e,o,f){var I=hn(e);if(f={lane:I,action:f,hasEagerState:!1,eagerState:null,next:null},ju(e))Nu(o,f);else if(f=mu(e,o,f,I),f!==null){var j=Fr();oi(f,e,I,j),Vu(f,o,I)}}function jc(e,o,f){var I=hn(e),j={lane:I,action:f,hasEagerState:!1,eagerState:null,next:null};if(ju(e))Nu(o,j);else{var $=e.alternate;if(e.lanes===0&&($===null||$.lanes===0)&&($=o.lastRenderedReducer,$!==null))try{var te=o.lastRenderedState,fe=$(te,f);if(j.hasEagerState=!0,j.eagerState=fe,sr(fe,te)){var be=o.interleaved;be===null?(j.next=j,_l(o)):(j.next=be.next,be.next=j),o.interleaved=j;return}}catch{}finally{}f=mu(e,o,j,I),f!==null&&(j=Fr(),oi(f,e,I,j),Vu(f,o,I))}}function ju(e){var o=e.alternate;return e===er||o!==null&&o===er}function Nu(e,o){bo=ma=!0;var f=e.pending;f===null?o.next=o:(o.next=f.next,f.next=o),e.pending=o}function Vu(e,o,f){if((f&4194240)!==0){var I=o.lanes;I&=e.pendingLanes,f|=I,o.lanes=f,Hr(e,f)}}var ya={readContext:Yr,useCallback:Ar,useContext:Ar,useEffect:Ar,useImperativeHandle:Ar,useInsertionEffect:Ar,useLayoutEffect:Ar,useMemo:Ar,useReducer:Ar,useRef:Ar,useState:Ar,useDebugValue:Ar,useDeferredValue:Ar,useTransition:Ar,useMutableSource:Ar,useSyncExternalStore:Ar,useId:Ar,unstable_isNewReconciler:!1},Nc={readContext:Yr,useCallback:function(e,o){return wi().memoizedState=[e,o===void 0?null:o],e},useContext:Yr,useEffect:Ru,useImperativeHandle:function(e,o,f){return f=f!=null?f.concat([e]):null,ga(4194308,4,Iu.bind(null,o,e),f)},useLayoutEffect:function(e,o){return ga(4194308,4,e,o)},useInsertionEffect:function(e,o){return ga(4,2,e,o)},useMemo:function(e,o){var f=wi();return o=o===void 0?null:o,e=e(),f.memoizedState=[e,o],e},useReducer:function(e,o,f){var I=wi();return o=f!==void 0?f(o):o,I.memoizedState=I.baseState=o,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:o},I.queue=e,e=e.dispatch=Oc.bind(null,er,e),[I.memoizedState,e]},useRef:function(e){var o=wi();return e={current:e},o.memoizedState=e},useState:Tu,useDebugValue:Fl,useDeferredValue:function(e){return wi().memoizedState=e},useTransition:function(){var e=Tu(!1),o=e[0];return e=Lc.bind(null,e[1]),wi().memoizedState=e,[o,e]},useMutableSource:function(){},useSyncExternalStore:function(e,o,f){var I=er,j=wi();if(tt){if(f===void 0)throw Error(r(407));f=f()}else{if(f=o(),mr===null)throw Error(r(349));(jn&30)!==0||wu(I,o,f)}j.memoizedState=f;var $={value:f,getSnapshot:o};return j.queue=$,Ru(Cu.bind(null,I,$,e),[e]),I.flags|=2048,Co(9,Su.bind(null,I,$,f,o),void 0,null),f},useId:function(){var e=wi(),o=mr.identifierPrefix;if(tt){var f=nt,I=Ft;f=(I&~(1<<32-Rr(I)-1)).toString(32)+f,o=":"+o+"R"+f,f=wo++,0<f&&(o+="H"+f.toString(32)),o+=":"}else f=zc++,o=":"+o+"r"+f.toString(32)+":";return e.memoizedState=o},unstable_isNewReconciler:!1},Vc={readContext:Yr,useCallback:Du,useContext:Yr,useEffect:Il,useImperativeHandle:Fu,useInsertionEffect:ku,useLayoutEffect:Pu,useMemo:zu,useReducer:kl,useRef:Mu,useState:function(){return kl(So)},useDebugValue:Fl,useDeferredValue:function(e){var o=Xr();return Lu(o,ur.memoizedState,e)},useTransition:function(){var e=kl(So)[0],o=Xr().memoizedState;return[e,o]},useMutableSource:_u,useSyncExternalStore:bu,useId:Ou,unstable_isNewReconciler:!1},Bc={readContext:Yr,useCallback:Du,useContext:Yr,useEffect:Il,useImperativeHandle:Fu,useInsertionEffect:ku,useLayoutEffect:Pu,useMemo:zu,useReducer:Pl,useRef:Mu,useState:function(){return Pl(So)},useDebugValue:Fl,useDeferredValue:function(e){var o=Xr();return ur===null?o.memoizedState=e:Lu(o,ur.memoizedState,e)},useTransition:function(){var e=Pl(So)[0],o=Xr().memoizedState;return[e,o]},useMutableSource:_u,useSyncExternalStore:bu,useId:Ou,unstable_isNewReconciler:!1};function ii(e,o){if(e&&e.defaultProps){o=X({},o),e=e.defaultProps;for(var f in e)o[f]===void 0&&(o[f]=e[f]);return o}return o}function Dl(e,o,f,I){o=e.memoizedState,f=f(I,o),f=f==null?o:X({},o,f),e.memoizedState=f,e.lanes===0&&(e.updateQueue.baseState=f)}var xa={isMounted:function(e){return(e=e._reactInternals)?Lt(e)===e:!1},enqueueSetState:function(e,o,f){e=e._reactInternals;var I=Fr(),j=hn(e),$=Ni(I,j);$.payload=o,f!=null&&($.callback=f),o=ln(e,$,j),o!==null&&(oi(o,e,j,I),da(o,e,j))},enqueueReplaceState:function(e,o,f){e=e._reactInternals;var I=Fr(),j=hn(e),$=Ni(I,j);$.tag=1,$.payload=o,f!=null&&($.callback=f),o=ln(e,$,j),o!==null&&(oi(o,e,j,I),da(o,e,j))},enqueueForceUpdate:function(e,o){e=e._reactInternals;var f=Fr(),I=hn(e),j=Ni(f,I);j.tag=2,o!=null&&(j.callback=o),o=ln(e,j,I),o!==null&&(oi(o,e,I,f),da(o,e,I))}};function Bu(e,o,f,I,j,$,te){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(I,$,te):o.prototype&&o.prototype.isPureReactComponent?!Di(f,I)||!Di(j,$):!0}function Gu(e,o,f){var I=!1,j=yi,$=o.contextType;return typeof $=="object"&&$!==null?$=Yr($):(j=xr(o)?xi:hr.current,I=o.contextTypes,$=(I=I!=null)?Oi(e,j):yi),o=new o(f,$),e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=xa,e.stateNode=o,o._reactInternals=e,I&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=j,e.__reactInternalMemoizedMaskedChildContext=$),o}function Uu(e,o,f,I){e=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(f,I),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(f,I),o.state!==e&&xa.enqueueReplaceState(o,o.state,null)}function zl(e,o,f,I){var j=e.stateNode;j.props=f,j.state=e.memoizedState,j.refs={},bl(e);var $=o.contextType;typeof $=="object"&&$!==null?j.context=Yr($):($=xr(o)?xi:hr.current,j.context=Oi(e,$)),j.state=e.memoizedState,$=o.getDerivedStateFromProps,typeof $=="function"&&(Dl(e,o,$,f),j.state=e.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof j.getSnapshotBeforeUpdate=="function"||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(o=j.state,typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount(),o!==j.state&&xa.enqueueReplaceState(j,j.state,null),ha(e,f,j,I),j.state=e.memoizedState),typeof j.componentDidMount=="function"&&(e.flags|=4194308)}function As(e,o){try{var f="",I=o;do f+=he(I),I=I.return;while(I);var j=f}catch($){j=`
Error generating stack: `+$.message+`
`+$.stack}return{value:e,source:o,stack:j,digest:null}}function Ll(e,o,f){return{value:e,source:null,stack:f??null,digest:o??null}}function Ol(e,o){try{console.error(o.value)}catch(f){setTimeout(function(){throw f})}}var Gc=typeof WeakMap=="function"?WeakMap:Map;function Wu(e,o,f){f=Ni(-1,f),f.tag=3,f.payload={element:null};var I=o.value;return f.callback=function(){Aa||(Aa=!0,Kl=I),Ol(e,o)},f}function Hu(e,o,f){f=Ni(-1,f),f.tag=3;var I=e.type.getDerivedStateFromError;if(typeof I=="function"){var j=o.value;f.payload=function(){return I(j)},f.callback=function(){Ol(e,o)}}var $=e.stateNode;return $!==null&&typeof $.componentDidCatch=="function"&&(f.callback=function(){Ol(e,o),typeof I!="function"&&(cn===null?cn=new Set([this]):cn.add(this));var te=o.stack;this.componentDidCatch(o.value,{componentStack:te!==null?te:""})}),f}function $u(e,o,f){var I=e.pingCache;if(I===null){I=e.pingCache=new Gc;var j=new Set;I.set(o,j)}else j=I.get(o),j===void 0&&(j=new Set,I.set(o,j));j.has(f)||(j.add(f),e=rd.bind(null,e,o,f),o.then(e,e))}function qu(e){do{var o;if((o=e.tag===13)&&(o=e.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return e;e=e.return}while(e!==null);return null}function Yu(e,o,f,I,j){return(e.mode&1)===0?(e===o?e.flags|=65536:(e.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(o=Ni(-1,1),o.tag=2,ln(f,o,1))),f.lanes|=1),e):(e.flags|=65536,e.lanes=j,e)}var Uc=M.ReactCurrentOwner,Lr=!1;function Ir(e,o,f,I){o.child=e===null?pu(o,null,f,I):ws(o,e.child,f,I)}function Xu(e,o,f,I,j){f=f.render;var $=o.ref;return Cs(o,j),I=Ml(e,o,f,I,$,j),f=Rl(),e!==null&&!Lr?(o.updateQueue=e.updateQueue,o.flags&=-2053,e.lanes&=~j,Vi(e,o,j)):(tt&&f&&Xt(o),o.flags|=1,Ir(e,o,I,j),o.child)}function Ju(e,o,f,I,j){if(e===null){var $=f.type;return typeof $=="function"&&!su($)&&$.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(o.tag=15,o.type=$,Qu(e,o,$,I,j)):(e=Ia(f.type,null,I,o,o.mode,j),e.ref=o.ref,e.return=o,o.child=e)}if($=e.child,(e.lanes&j)===0){var te=$.memoizedProps;if(f=f.compare,f=f!==null?f:Di,f(te,I)&&e.ref===o.ref)return Vi(e,o,j)}return o.flags|=1,e=pn($,I),e.ref=o.ref,e.return=o,o.child=e}function Qu(e,o,f,I,j){if(e!==null){var $=e.memoizedProps;if(Di($,I)&&e.ref===o.ref)if(Lr=!1,o.pendingProps=I=$,(e.lanes&j)!==0)(e.flags&131072)!==0&&(Lr=!0);else return o.lanes=e.lanes,Vi(e,o,j)}return jl(e,o,f,I,j)}function Ku(e,o,f){var I=o.pendingProps,j=I.children,$=e!==null?e.memoizedState:null;if(I.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ht(Ms,Ur),Ur|=f;else{if((f&1073741824)===0)return e=$!==null?$.baseLanes|f:f,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:e,cachePool:null,transitions:null},o.updateQueue=null,Ht(Ms,Ur),Ur|=e,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},I=$!==null?$.baseLanes:f,Ht(Ms,Ur),Ur|=I}else $!==null?(I=$.baseLanes|f,o.memoizedState=null):I=f,Ht(Ms,Ur),Ur|=I;return Ir(e,o,j,f),o.child}function Zu(e,o){var f=o.ref;(e===null&&f!==null||e!==null&&e.ref!==f)&&(o.flags|=512,o.flags|=2097152)}function jl(e,o,f,I,j){var $=xr(f)?xi:hr.current;return $=Oi(o,$),Cs(o,j),f=Ml(e,o,f,I,$,j),I=Rl(),e!==null&&!Lr?(o.updateQueue=e.updateQueue,o.flags&=-2053,e.lanes&=~j,Vi(e,o,j)):(tt&&I&&Xt(o),o.flags|=1,Ir(e,o,f,j),o.child)}function ec(e,o,f,I,j){if(xr(f)){var $=!0;zn(o)}else $=!1;if(Cs(o,j),o.stateNode===null)ba(e,o),Gu(o,f,I),zl(o,f,I,j),I=!0;else if(e===null){var te=o.stateNode,fe=o.memoizedProps;te.props=fe;var be=te.context,Ve=f.contextType;typeof Ve=="object"&&Ve!==null?Ve=Yr(Ve):(Ve=xr(f)?xi:hr.current,Ve=Oi(o,Ve));var et=f.getDerivedStateFromProps,it=typeof et=="function"||typeof te.getSnapshotBeforeUpdate=="function";it||typeof te.UNSAFE_componentWillReceiveProps!="function"&&typeof te.componentWillReceiveProps!="function"||(fe!==I||be!==Ve)&&Uu(o,te,I,Ve),an=!1;var Ze=o.memoizedState;te.state=Ze,ha(o,I,te,j),be=o.memoizedState,fe!==I||Ze!==be||Er.current||an?(typeof et=="function"&&(Dl(o,f,et,I),be=o.memoizedState),(fe=an||Bu(o,f,fe,I,Ze,be,Ve))?(it||typeof te.UNSAFE_componentWillMount!="function"&&typeof te.componentWillMount!="function"||(typeof te.componentWillMount=="function"&&te.componentWillMount(),typeof te.UNSAFE_componentWillMount=="function"&&te.UNSAFE_componentWillMount()),typeof te.componentDidMount=="function"&&(o.flags|=4194308)):(typeof te.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=I,o.memoizedState=be),te.props=I,te.state=be,te.context=Ve,I=fe):(typeof te.componentDidMount=="function"&&(o.flags|=4194308),I=!1)}else{te=o.stateNode,gu(e,o),fe=o.memoizedProps,Ve=o.type===o.elementType?fe:ii(o.type,fe),te.props=Ve,it=o.pendingProps,Ze=te.context,be=f.contextType,typeof be=="object"&&be!==null?be=Yr(be):(be=xr(f)?xi:hr.current,be=Oi(o,be));var pt=f.getDerivedStateFromProps;(et=typeof pt=="function"||typeof te.getSnapshotBeforeUpdate=="function")||typeof te.UNSAFE_componentWillReceiveProps!="function"&&typeof te.componentWillReceiveProps!="function"||(fe!==it||Ze!==be)&&Uu(o,te,I,be),an=!1,Ze=o.memoizedState,te.state=Ze,ha(o,I,te,j);var gt=o.memoizedState;fe!==it||Ze!==gt||Er.current||an?(typeof pt=="function"&&(Dl(o,f,pt,I),gt=o.memoizedState),(Ve=an||Bu(o,f,Ve,I,Ze,gt,be)||!1)?(et||typeof te.UNSAFE_componentWillUpdate!="function"&&typeof te.componentWillUpdate!="function"||(typeof te.componentWillUpdate=="function"&&te.componentWillUpdate(I,gt,be),typeof te.UNSAFE_componentWillUpdate=="function"&&te.UNSAFE_componentWillUpdate(I,gt,be)),typeof te.componentDidUpdate=="function"&&(o.flags|=4),typeof te.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof te.componentDidUpdate!="function"||fe===e.memoizedProps&&Ze===e.memoizedState||(o.flags|=4),typeof te.getSnapshotBeforeUpdate!="function"||fe===e.memoizedProps&&Ze===e.memoizedState||(o.flags|=1024),o.memoizedProps=I,o.memoizedState=gt),te.props=I,te.state=gt,te.context=be,I=Ve):(typeof te.componentDidUpdate!="function"||fe===e.memoizedProps&&Ze===e.memoizedState||(o.flags|=4),typeof te.getSnapshotBeforeUpdate!="function"||fe===e.memoizedProps&&Ze===e.memoizedState||(o.flags|=1024),I=!1)}return Nl(e,o,f,I,$,j)}function Nl(e,o,f,I,j,$){Zu(e,o);var te=(o.flags&128)!==0;if(!I&&!te)return j&&vo(o,f,!1),Vi(e,o,$);I=o.stateNode,Uc.current=o;var fe=te&&typeof f.getDerivedStateFromError!="function"?null:I.render();return o.flags|=1,e!==null&&te?(o.child=ws(o,e.child,null,$),o.child=ws(o,null,fe,$)):Ir(e,o,fe,$),o.memoizedState=I.state,j&&vo(o,f,!0),o.child}function tc(e){var o=e.stateNode;o.pendingContext?mo(e,o.pendingContext,o.pendingContext!==o.context):o.context&&mo(e,o.context,!1),wl(e,o.containerInfo)}function rc(e,o,f,I,j){return zr(),_s(j),o.flags|=256,Ir(e,o,f,I),o.child}var Vl={dehydrated:null,treeContext:null,retryLane:0};function Bl(e){return{baseLanes:e,cachePool:null,transitions:null}}function ic(e,o,f){var I=o.pendingProps,j=Zt.current,$=!1,te=(o.flags&128)!==0,fe;if((fe=te)||(fe=e!==null&&e.memoizedState===null?!1:(j&2)!==0),fe?($=!0,o.flags&=-129):(e===null||e.memoizedState!==null)&&(j|=1),Ht(Zt,j&1),e===null)return Bt(o),e=o.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((o.mode&1)===0?o.lanes=1:e.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(te=I.children,e=I.fallback,$?(I=o.mode,$=o.child,te={mode:"hidden",children:te},(I&1)===0&&$!==null?($.childLanes=0,$.pendingProps=te):$=Fa(te,I,0,null),e=Un(e,I,f,null),$.return=o,e.return=o,$.sibling=e,o.child=$,o.child.memoizedState=Bl(f),o.memoizedState=Vl,e):Gl(o,te));if(j=e.memoizedState,j!==null&&(fe=j.dehydrated,fe!==null))return Wc(e,o,te,I,fe,j,f);if($){$=I.fallback,te=o.mode,j=e.child,fe=j.sibling;var be={mode:"hidden",children:I.children};return(te&1)===0&&o.child!==j?(I=o.child,I.childLanes=0,I.pendingProps=be,o.deletions=null):(I=pn(j,be),I.subtreeFlags=j.subtreeFlags&14680064),fe!==null?$=pn(fe,$):($=Un($,te,f,null),$.flags|=2),$.return=o,I.return=o,I.sibling=$,o.child=I,I=$,$=o.child,te=e.child.memoizedState,te=te===null?Bl(f):{baseLanes:te.baseLanes|f,cachePool:null,transitions:te.transitions},$.memoizedState=te,$.childLanes=e.childLanes&~f,o.memoizedState=Vl,I}return $=e.child,e=$.sibling,I=pn($,{mode:"visible",children:I.children}),(o.mode&1)===0&&(I.lanes=f),I.return=o,I.sibling=null,e!==null&&(f=o.deletions,f===null?(o.deletions=[e],o.flags|=16):f.push(e)),o.child=I,o.memoizedState=null,I}function Gl(e,o){return o=Fa({mode:"visible",children:o},e.mode,0,null),o.return=e,e.child=o}function _a(e,o,f,I){return I!==null&&_s(I),ws(o,e.child,null,f),e=Gl(o,o.pendingProps.children),e.flags|=2,o.memoizedState=null,e}function Wc(e,o,f,I,j,$,te){if(f)return o.flags&256?(o.flags&=-257,I=Ll(Error(r(422))),_a(e,o,te,I)):o.memoizedState!==null?(o.child=e.child,o.flags|=128,null):($=I.fallback,j=o.mode,I=Fa({mode:"visible",children:I.children},j,0,null),$=Un($,j,te,null),$.flags|=2,I.return=o,$.return=o,I.sibling=$,o.child=I,(o.mode&1)!==0&&ws(o,e.child,null,te),o.child.memoizedState=Bl(te),o.memoizedState=Vl,$);if((o.mode&1)===0)return _a(e,o,te,null);if(j.data==="$!"){if(I=j.nextSibling&&j.nextSibling.dataset,I)var fe=I.dgst;return I=fe,$=Error(r(419)),I=Ll($,I,void 0),_a(e,o,te,I)}if(fe=(te&e.childLanes)!==0,Lr||fe){if(I=mr,I!==null){switch(te&-te){case 4:j=2;break;case 16:j=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:j=32;break;case 536870912:j=268435456;break;default:j=0}j=(j&(I.suspendedLanes|te))!==0?0:j,j!==0&&j!==$.retryLane&&($.retryLane=j,ji(e,j),oi(I,e,j,-1))}return nu(),I=Ll(Error(r(421))),_a(e,o,te,I)}return j.data==="$?"?(o.flags|=128,o.child=e.child,o=nd.bind(null,e),j._reactRetry=o,null):(e=$.treeContext,_t=$r(j.nextSibling),bt=o,tt=!0,wt=null,e!==null&&(ht[_e++]=Ft,ht[_e++]=nt,ht[_e++]=Pe,Ft=e.id,nt=e.overflow,Pe=o),o=Gl(o,I.children),o.flags|=4096,o)}function nc(e,o,f){e.lanes|=o;var I=e.alternate;I!==null&&(I.lanes|=o),xl(e.return,o,f)}function Ul(e,o,f,I,j){var $=e.memoizedState;$===null?e.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:I,tail:f,tailMode:j}:($.isBackwards=o,$.rendering=null,$.renderingStartTime=0,$.last=I,$.tail=f,$.tailMode=j)}function sc(e,o,f){var I=o.pendingProps,j=I.revealOrder,$=I.tail;if(Ir(e,o,I.children,f),I=Zt.current,(I&2)!==0)I=I&1|2,o.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=o.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&nc(e,f,o);else if(e.tag===19)nc(e,f,o);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===o)break e;for(;e.sibling===null;){if(e.return===null||e.return===o)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}I&=1}if(Ht(Zt,I),(o.mode&1)===0)o.memoizedState=null;else switch(j){case"forwards":for(f=o.child,j=null;f!==null;)e=f.alternate,e!==null&&fa(e)===null&&(j=f),f=f.sibling;f=j,f===null?(j=o.child,o.child=null):(j=f.sibling,f.sibling=null),Ul(o,!1,j,f,$);break;case"backwards":for(f=null,j=o.child,o.child=null;j!==null;){if(e=j.alternate,e!==null&&fa(e)===null){o.child=j;break}e=j.sibling,j.sibling=f,f=j,j=e}Ul(o,!0,f,null,$);break;case"together":Ul(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function ba(e,o){(o.mode&1)===0&&e!==null&&(e.alternate=null,o.alternate=null,o.flags|=2)}function Vi(e,o,f){if(e!==null&&(o.dependencies=e.dependencies),Nn|=o.lanes,(f&o.childLanes)===0)return null;if(e!==null&&o.child!==e.child)throw Error(r(153));if(o.child!==null){for(e=o.child,f=pn(e,e.pendingProps),o.child=f,f.return=o;e.sibling!==null;)e=e.sibling,f=f.sibling=pn(e,e.pendingProps),f.return=o;f.sibling=null}return o.child}function Hc(e,o,f){switch(o.tag){case 3:tc(o),zr();break;case 5:xu(o);break;case 1:xr(o.type)&&zn(o);break;case 4:wl(o,o.stateNode.containerInfo);break;case 10:var I=o.type._context,j=o.memoizedProps.value;Ht(ua,I._currentValue),I._currentValue=j;break;case 13:if(I=o.memoizedState,I!==null)return I.dehydrated!==null?(Ht(Zt,Zt.current&1),o.flags|=128,null):(f&o.child.childLanes)!==0?ic(e,o,f):(Ht(Zt,Zt.current&1),e=Vi(e,o,f),e!==null?e.sibling:null);Ht(Zt,Zt.current&1);break;case 19:if(I=(f&o.childLanes)!==0,(e.flags&128)!==0){if(I)return sc(e,o,f);o.flags|=128}if(j=o.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),Ht(Zt,Zt.current),I)break;return null;case 22:case 23:return o.lanes=0,Ku(e,o,f)}return Vi(e,o,f)}var oc,Wl,ac,lc;oc=function(e,o){for(var f=o.child;f!==null;){if(f.tag===5||f.tag===6)e.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===o)break;for(;f.sibling===null;){if(f.return===null||f.return===o)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Wl=function(){},ac=function(e,o,f,I){var j=e.memoizedProps;if(j!==I){e=o.stateNode,On(bi.current);var $=null;switch(f){case"input":j=me(e,j),I=me(e,I),$=[];break;case"select":j=X({},j,{value:void 0}),I=X({},I,{value:void 0}),$=[];break;case"textarea":j=Xe(e,j),I=Xe(e,I),$=[];break;default:typeof j.onClick!="function"&&typeof I.onClick=="function"&&(e.onclick=gs)}Me(f,I);var te;f=null;for(Ve in j)if(!I.hasOwnProperty(Ve)&&j.hasOwnProperty(Ve)&&j[Ve]!=null)if(Ve==="style"){var fe=j[Ve];for(te in fe)fe.hasOwnProperty(te)&&(f||(f={}),f[te]="")}else Ve!=="dangerouslySetInnerHTML"&&Ve!=="children"&&Ve!=="suppressContentEditableWarning"&&Ve!=="suppressHydrationWarning"&&Ve!=="autoFocus"&&(v.hasOwnProperty(Ve)?$||($=[]):($=$||[]).push(Ve,null));for(Ve in I){var be=I[Ve];if(fe=j?.[Ve],I.hasOwnProperty(Ve)&&be!==fe&&(be!=null||fe!=null))if(Ve==="style")if(fe){for(te in fe)!fe.hasOwnProperty(te)||be&&be.hasOwnProperty(te)||(f||(f={}),f[te]="");for(te in be)be.hasOwnProperty(te)&&fe[te]!==be[te]&&(f||(f={}),f[te]=be[te])}else f||($||($=[]),$.push(Ve,f)),f=be;else Ve==="dangerouslySetInnerHTML"?(be=be?be.__html:void 0,fe=fe?fe.__html:void 0,be!=null&&fe!==be&&($=$||[]).push(Ve,be)):Ve==="children"?typeof be!="string"&&typeof be!="number"||($=$||[]).push(Ve,""+be):Ve!=="suppressContentEditableWarning"&&Ve!=="suppressHydrationWarning"&&(v.hasOwnProperty(Ve)?(be!=null&&Ve==="onScroll"&&Ut("scroll",e),$||fe===be||($=[])):($=$||[]).push(Ve,be))}f&&($=$||[]).push("style",f);var Ve=$;(o.updateQueue=Ve)&&(o.flags|=4)}},lc=function(e,o,f,I){f!==I&&(o.flags|=4)};function Eo(e,o){if(!tt)switch(e.tailMode){case"hidden":o=e.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?e.tail=null:f.sibling=null;break;case"collapsed":f=e.tail;for(var I=null;f!==null;)f.alternate!==null&&(I=f),f=f.sibling;I===null?o||e.tail===null?e.tail=null:e.tail.sibling=null:I.sibling=null}}function Tr(e){var o=e.alternate!==null&&e.alternate.child===e.child,f=0,I=0;if(o)for(var j=e.child;j!==null;)f|=j.lanes|j.childLanes,I|=j.subtreeFlags&14680064,I|=j.flags&14680064,j.return=e,j=j.sibling;else for(j=e.child;j!==null;)f|=j.lanes|j.childLanes,I|=j.subtreeFlags,I|=j.flags,j.return=e,j=j.sibling;return e.subtreeFlags|=I,e.childLanes=f,o}function $c(e,o,f){var I=o.pendingProps;switch(zt(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tr(o),null;case 1:return xr(o.type)&&Dn(),Tr(o),null;case 3:return I=o.stateNode,Es(),Yt(Er),Yt(hr),El(),I.pendingContext&&(I.context=I.pendingContext,I.pendingContext=null),(e===null||e.child===null)&&(kt(o)?o.flags|=4:e===null||e.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,wt!==null&&(tu(wt),wt=null))),Wl(e,o),Tr(o),null;case 5:Sl(o);var j=On(_o.current);if(f=o.type,e!==null&&o.stateNode!=null)ac(e,o,f,I,j),e.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!I){if(o.stateNode===null)throw Error(r(166));return Tr(o),null}if(e=On(bi.current),kt(o)){I=o.stateNode,f=o.type;var $=o.memoizedProps;switch(I[Gr]=o,I[Pn]=$,e=(o.mode&1)!==0,f){case"dialog":Ut("cancel",I),Ut("close",I);break;case"iframe":case"object":case"embed":Ut("load",I);break;case"video":case"audio":for(j=0;j<tn.length;j++)Ut(tn[j],I);break;case"source":Ut("error",I);break;case"img":case"image":case"link":Ut("error",I),Ut("load",I);break;case"details":Ut("toggle",I);break;case"input":Fe(I,$),Ut("invalid",I);break;case"select":I._wrapperState={wasMultiple:!!$.multiple},Ut("invalid",I);break;case"textarea":Ne(I,$),Ut("invalid",I)}Me(f,$),j=null;for(var te in $)if($.hasOwnProperty(te)){var fe=$[te];te==="children"?typeof fe=="string"?I.textContent!==fe&&($.suppressHydrationWarning!==!0&&ms(I.textContent,fe,e),j=["children",fe]):typeof fe=="number"&&I.textContent!==""+fe&&($.suppressHydrationWarning!==!0&&ms(I.textContent,fe,e),j=["children",""+fe]):v.hasOwnProperty(te)&&fe!=null&&te==="onScroll"&&Ut("scroll",I)}switch(f){case"input":Ge(I),st(I,$,!0);break;case"textarea":Ge(I),ft(I);break;case"select":case"option":break;default:typeof $.onClick=="function"&&(I.onclick=gs)}I=j,o.updateQueue=I,I!==null&&(o.flags|=4)}else{te=j.nodeType===9?j:j.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ut(f)),e==="http://www.w3.org/1999/xhtml"?f==="script"?(e=te.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof I.is=="string"?e=te.createElement(f,{is:I.is}):(e=te.createElement(f),f==="select"&&(te=e,I.multiple?te.multiple=!0:I.size&&(te.size=I.size))):e=te.createElementNS(e,f),e[Gr]=o,e[Pn]=I,oc(e,o,!1,!1),o.stateNode=e;e:{switch(te=$e(f,I),f){case"dialog":Ut("cancel",e),Ut("close",e),j=I;break;case"iframe":case"object":case"embed":Ut("load",e),j=I;break;case"video":case"audio":for(j=0;j<tn.length;j++)Ut(tn[j],e);j=I;break;case"source":Ut("error",e),j=I;break;case"img":case"image":case"link":Ut("error",e),Ut("load",e),j=I;break;case"details":Ut("toggle",e),j=I;break;case"input":Fe(e,I),j=me(e,I),Ut("invalid",e);break;case"option":j=I;break;case"select":e._wrapperState={wasMultiple:!!I.multiple},j=X({},I,{value:void 0}),Ut("invalid",e);break;case"textarea":Ne(e,I),j=Xe(e,I),Ut("invalid",e);break;default:j=I}Me(f,j),fe=j;for($ in fe)if(fe.hasOwnProperty($)){var be=fe[$];$==="style"?K(e,be):$==="dangerouslySetInnerHTML"?(be=be?be.__html:void 0,be!=null&&oe(e,be)):$==="children"?typeof be=="string"?(f!=="textarea"||be!=="")&&we(e,be):typeof be=="number"&&we(e,""+be):$!=="suppressContentEditableWarning"&&$!=="suppressHydrationWarning"&&$!=="autoFocus"&&(v.hasOwnProperty($)?be!=null&&$==="onScroll"&&Ut("scroll",e):be!=null&&_(e,$,be,te))}switch(f){case"input":Ge(e),st(e,I,!1);break;case"textarea":Ge(e),ft(e);break;case"option":I.value!=null&&e.setAttribute("value",""+ue(I.value));break;case"select":e.multiple=!!I.multiple,$=I.value,$!=null?Je(e,!!I.multiple,$,!1):I.defaultValue!=null&&Je(e,!!I.multiple,I.defaultValue,!0);break;default:typeof j.onClick=="function"&&(e.onclick=gs)}switch(f){case"button":case"input":case"select":case"textarea":I=!!I.autoFocus;break e;case"img":I=!0;break e;default:I=!1}}I&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Tr(o),null;case 6:if(e&&o.stateNode!=null)lc(e,o,e.memoizedProps,I);else{if(typeof I!="string"&&o.stateNode===null)throw Error(r(166));if(f=On(_o.current),On(bi.current),kt(o)){if(I=o.stateNode,f=o.memoizedProps,I[Gr]=o,($=I.nodeValue!==f)&&(e=bt,e!==null))switch(e.tag){case 3:ms(I.nodeValue,f,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ms(I.nodeValue,f,(e.mode&1)!==0)}$&&(o.flags|=4)}else I=(f.nodeType===9?f:f.ownerDocument).createTextNode(I),I[Gr]=o,o.stateNode=I}return Tr(o),null;case 13:if(Yt(Zt),I=o.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(tt&&_t!==null&&(o.mode&1)!==0&&(o.flags&128)===0)fr(),zr(),o.flags|=98560,$=!1;else if($=kt(o),I!==null&&I.dehydrated!==null){if(e===null){if(!$)throw Error(r(318));if($=o.memoizedState,$=$!==null?$.dehydrated:null,!$)throw Error(r(317));$[Gr]=o}else zr(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Tr(o),$=!1}else wt!==null&&(tu(wt),wt=null),$=!0;if(!$)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=f,o):(I=I!==null,I!==(e!==null&&e.memoizedState!==null)&&I&&(o.child.flags|=8192,(o.mode&1)!==0&&(e===null||(Zt.current&1)!==0?cr===0&&(cr=3):nu())),o.updateQueue!==null&&(o.flags|=4),Tr(o),null);case 4:return Es(),Wl(e,o),e===null&&Rn(o.stateNode.containerInfo),Tr(o),null;case 10:return yl(o.type._context),Tr(o),null;case 17:return xr(o.type)&&Dn(),Tr(o),null;case 19:if(Yt(Zt),$=o.memoizedState,$===null)return Tr(o),null;if(I=(o.flags&128)!==0,te=$.rendering,te===null)if(I)Eo($,!1);else{if(cr!==0||e!==null&&(e.flags&128)!==0)for(e=o.child;e!==null;){if(te=fa(e),te!==null){for(o.flags|=128,Eo($,!1),I=te.updateQueue,I!==null&&(o.updateQueue=I,o.flags|=4),o.subtreeFlags=0,I=f,f=o.child;f!==null;)$=f,e=I,$.flags&=14680066,te=$.alternate,te===null?($.childLanes=0,$.lanes=e,$.child=null,$.subtreeFlags=0,$.memoizedProps=null,$.memoizedState=null,$.updateQueue=null,$.dependencies=null,$.stateNode=null):($.childLanes=te.childLanes,$.lanes=te.lanes,$.child=te.child,$.subtreeFlags=0,$.deletions=null,$.memoizedProps=te.memoizedProps,$.memoizedState=te.memoizedState,$.updateQueue=te.updateQueue,$.type=te.type,e=te.dependencies,$.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),f=f.sibling;return Ht(Zt,Zt.current&1|2),o.child}e=e.sibling}$.tail!==null&&Jt()>Rs&&(o.flags|=128,I=!0,Eo($,!1),o.lanes=4194304)}else{if(!I)if(e=fa(te),e!==null){if(o.flags|=128,I=!0,f=e.updateQueue,f!==null&&(o.updateQueue=f,o.flags|=4),Eo($,!0),$.tail===null&&$.tailMode==="hidden"&&!te.alternate&&!tt)return Tr(o),null}else 2*Jt()-$.renderingStartTime>Rs&&f!==1073741824&&(o.flags|=128,I=!0,Eo($,!1),o.lanes=4194304);$.isBackwards?(te.sibling=o.child,o.child=te):(f=$.last,f!==null?f.sibling=te:o.child=te,$.last=te)}return $.tail!==null?(o=$.tail,$.rendering=o,$.tail=o.sibling,$.renderingStartTime=Jt(),o.sibling=null,f=Zt.current,Ht(Zt,I?f&1|2:f&1),o):(Tr(o),null);case 22:case 23:return iu(),I=o.memoizedState!==null,e!==null&&e.memoizedState!==null!==I&&(o.flags|=8192),I&&(o.mode&1)!==0?(Ur&1073741824)!==0&&(Tr(o),o.subtreeFlags&6&&(o.flags|=8192)):Tr(o),null;case 24:return null;case 25:return null}throw Error(r(156,o.tag))}function qc(e,o){switch(zt(o),o.tag){case 1:return xr(o.type)&&Dn(),e=o.flags,e&65536?(o.flags=e&-65537|128,o):null;case 3:return Es(),Yt(Er),Yt(hr),El(),e=o.flags,(e&65536)!==0&&(e&128)===0?(o.flags=e&-65537|128,o):null;case 5:return Sl(o),null;case 13:if(Yt(Zt),e=o.memoizedState,e!==null&&e.dehydrated!==null){if(o.alternate===null)throw Error(r(340));zr()}return e=o.flags,e&65536?(o.flags=e&-65537|128,o):null;case 19:return Yt(Zt),null;case 4:return Es(),null;case 10:return yl(o.type._context),null;case 22:case 23:return iu(),null;case 24:return null;default:return null}}var wa=!1,Mr=!1,Yc=typeof WeakSet=="function"?WeakSet:Set,mt=null;function Ts(e,o){var f=e.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(I){rr(e,o,I)}else f.current=null}function Hl(e,o,f){try{f()}catch(I){rr(e,o,I)}}var uc=!1;function Xc(e,o){if(uo=Xn,e=eo(),as(e)){if("selectionStart"in e)var f={start:e.selectionStart,end:e.selectionEnd};else e:{f=(f=e.ownerDocument)&&f.defaultView||window;var I=f.getSelection&&f.getSelection();if(I&&I.rangeCount!==0){f=I.anchorNode;var j=I.anchorOffset,$=I.focusNode;I=I.focusOffset;try{f.nodeType,$.nodeType}catch{f=null;break e}var te=0,fe=-1,be=-1,Ve=0,et=0,it=e,Ze=null;t:for(;;){for(var pt;it!==f||j!==0&&it.nodeType!==3||(fe=te+j),it!==$||I!==0&&it.nodeType!==3||(be=te+I),it.nodeType===3&&(te+=it.nodeValue.length),(pt=it.firstChild)!==null;)Ze=it,it=pt;for(;;){if(it===e)break t;if(Ze===f&&++Ve===j&&(fe=te),Ze===$&&++et===I&&(be=te),(pt=it.nextSibling)!==null)break;it=Ze,Ze=it.parentNode}it=pt}f=fe===-1||be===-1?null:{start:fe,end:be}}else f=null}f=f||{start:0,end:0}}else f=null;for(co={focusedElem:e,selectionRange:f},Xn=!1,mt=o;mt!==null;)if(o=mt,e=o.child,(o.subtreeFlags&1028)!==0&&e!==null)e.return=o,mt=e;else for(;mt!==null;){o=mt;try{var gt=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(gt!==null){var vt=gt.memoizedProps,or=gt.memoizedState,Ie=o.stateNode,Ce=Ie.getSnapshotBeforeUpdate(o.elementType===o.type?vt:ii(o.type,vt),or);Ie.__reactInternalSnapshotBeforeUpdate=Ce}break;case 3:var Le=o.stateNode.containerInfo;Le.nodeType===1?Le.textContent="":Le.nodeType===9&&Le.documentElement&&Le.removeChild(Le.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(at){rr(o,o.return,at)}if(e=o.sibling,e!==null){e.return=o.return,mt=e;break}mt=o.return}return gt=uc,uc=!1,gt}function Ao(e,o,f){var I=o.updateQueue;if(I=I!==null?I.lastEffect:null,I!==null){var j=I=I.next;do{if((j.tag&e)===e){var $=j.destroy;j.destroy=void 0,$!==void 0&&Hl(o,f,$)}j=j.next}while(j!==I)}}function Sa(e,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var f=o=o.next;do{if((f.tag&e)===e){var I=f.create;f.destroy=I()}f=f.next}while(f!==o)}}function $l(e){var o=e.ref;if(o!==null){var f=e.stateNode;switch(e.tag){case 5:e=f;break;default:e=f}typeof o=="function"?o(e):o.current=e}}function cc(e){var o=e.alternate;o!==null&&(e.alternate=null,cc(o)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(o=e.stateNode,o!==null&&(delete o[Gr],delete o[Pn],delete o[In],delete o[pl],delete o[ml])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function dc(e){return e.tag===5||e.tag===3||e.tag===4}function hc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||dc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ql(e,o,f){var I=e.tag;if(I===5||I===6)e=e.stateNode,o?f.nodeType===8?f.parentNode.insertBefore(e,o):f.insertBefore(e,o):(f.nodeType===8?(o=f.parentNode,o.insertBefore(e,f)):(o=f,o.appendChild(e)),f=f._reactRootContainer,f!=null||o.onclick!==null||(o.onclick=gs));else if(I!==4&&(e=e.child,e!==null))for(ql(e,o,f),e=e.sibling;e!==null;)ql(e,o,f),e=e.sibling}function Yl(e,o,f){var I=e.tag;if(I===5||I===6)e=e.stateNode,o?f.insertBefore(e,o):f.appendChild(e);else if(I!==4&&(e=e.child,e!==null))for(Yl(e,o,f),e=e.sibling;e!==null;)Yl(e,o,f),e=e.sibling}var _r=null,ni=!1;function un(e,o,f){for(f=f.child;f!==null;)fc(e,o,f),f=f.sibling}function fc(e,o,f){if(vr&&typeof vr.onCommitFiberUnmount=="function")try{vr.onCommitFiberUnmount(Hn,f)}catch{}switch(f.tag){case 5:Mr||Ts(f,o);case 6:var I=_r,j=ni;_r=null,un(e,o,f),_r=I,ni=j,_r!==null&&(ni?(e=_r,f=f.stateNode,e.nodeType===8?e.parentNode.removeChild(f):e.removeChild(f)):_r.removeChild(f.stateNode));break;case 18:_r!==null&&(ni?(e=_r,f=f.stateNode,e.nodeType===8?zi(e.parentNode,f):e.nodeType===1&&zi(e,f),bn(e)):zi(_r,f.stateNode));break;case 4:I=_r,j=ni,_r=f.stateNode.containerInfo,ni=!0,un(e,o,f),_r=I,ni=j;break;case 0:case 11:case 14:case 15:if(!Mr&&(I=f.updateQueue,I!==null&&(I=I.lastEffect,I!==null))){j=I=I.next;do{var $=j,te=$.destroy;$=$.tag,te!==void 0&&(($&2)!==0||($&4)!==0)&&Hl(f,o,te),j=j.next}while(j!==I)}un(e,o,f);break;case 1:if(!Mr&&(Ts(f,o),I=f.stateNode,typeof I.componentWillUnmount=="function"))try{I.props=f.memoizedProps,I.state=f.memoizedState,I.componentWillUnmount()}catch(fe){rr(f,o,fe)}un(e,o,f);break;case 21:un(e,o,f);break;case 22:f.mode&1?(Mr=(I=Mr)||f.memoizedState!==null,un(e,o,f),Mr=I):un(e,o,f);break;default:un(e,o,f)}}function pc(e){var o=e.updateQueue;if(o!==null){e.updateQueue=null;var f=e.stateNode;f===null&&(f=e.stateNode=new Yc),o.forEach(function(I){var j=sd.bind(null,e,I);f.has(I)||(f.add(I),I.then(j,j))})}}function si(e,o){var f=o.deletions;if(f!==null)for(var I=0;I<f.length;I++){var j=f[I];try{var $=e,te=o,fe=te;e:for(;fe!==null;){switch(fe.tag){case 5:_r=fe.stateNode,ni=!1;break e;case 3:_r=fe.stateNode.containerInfo,ni=!0;break e;case 4:_r=fe.stateNode.containerInfo,ni=!0;break e}fe=fe.return}if(_r===null)throw Error(r(160));fc($,te,j),_r=null,ni=!1;var be=j.alternate;be!==null&&(be.return=null),j.return=null}catch(Ve){rr(j,o,Ve)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)mc(o,e),o=o.sibling}function mc(e,o){var f=e.alternate,I=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(si(o,e),Si(e),I&4){try{Ao(3,e,e.return),Sa(3,e)}catch(vt){rr(e,e.return,vt)}try{Ao(5,e,e.return)}catch(vt){rr(e,e.return,vt)}}break;case 1:si(o,e),Si(e),I&512&&f!==null&&Ts(f,f.return);break;case 5:if(si(o,e),Si(e),I&512&&f!==null&&Ts(f,f.return),e.flags&32){var j=e.stateNode;try{we(j,"")}catch(vt){rr(e,e.return,vt)}}if(I&4&&(j=e.stateNode,j!=null)){var $=e.memoizedProps,te=f!==null?f.memoizedProps:$,fe=e.type,be=e.updateQueue;if(e.updateQueue=null,be!==null)try{fe==="input"&&$.type==="radio"&&$.name!=null&&qe(j,$),$e(fe,te);var Ve=$e(fe,$);for(te=0;te<be.length;te+=2){var et=be[te],it=be[te+1];et==="style"?K(j,it):et==="dangerouslySetInnerHTML"?oe(j,it):et==="children"?we(j,it):_(j,et,it,Ve)}switch(fe){case"input":Qe(j,$);break;case"textarea":Ue(j,$);break;case"select":var Ze=j._wrapperState.wasMultiple;j._wrapperState.wasMultiple=!!$.multiple;var pt=$.value;pt!=null?Je(j,!!$.multiple,pt,!1):Ze!==!!$.multiple&&($.defaultValue!=null?Je(j,!!$.multiple,$.defaultValue,!0):Je(j,!!$.multiple,$.multiple?[]:"",!1))}j[Pn]=$}catch(vt){rr(e,e.return,vt)}}break;case 6:if(si(o,e),Si(e),I&4){if(e.stateNode===null)throw Error(r(162));j=e.stateNode,$=e.memoizedProps;try{j.nodeValue=$}catch(vt){rr(e,e.return,vt)}}break;case 3:if(si(o,e),Si(e),I&4&&f!==null&&f.memoizedState.isDehydrated)try{bn(o.containerInfo)}catch(vt){rr(e,e.return,vt)}break;case 4:si(o,e),Si(e);break;case 13:si(o,e),Si(e),j=e.child,j.flags&8192&&($=j.memoizedState!==null,j.stateNode.isHidden=$,!$||j.alternate!==null&&j.alternate.memoizedState!==null||(Ql=Jt())),I&4&&pc(e);break;case 22:if(et=f!==null&&f.memoizedState!==null,e.mode&1?(Mr=(Ve=Mr)||et,si(o,e),Mr=Ve):si(o,e),Si(e),I&8192){if(Ve=e.memoizedState!==null,(e.stateNode.isHidden=Ve)&&!et&&(e.mode&1)!==0)for(mt=e,et=e.child;et!==null;){for(it=mt=et;mt!==null;){switch(Ze=mt,pt=Ze.child,Ze.tag){case 0:case 11:case 14:case 15:Ao(4,Ze,Ze.return);break;case 1:Ts(Ze,Ze.return);var gt=Ze.stateNode;if(typeof gt.componentWillUnmount=="function"){I=Ze,f=Ze.return;try{o=I,gt.props=o.memoizedProps,gt.state=o.memoizedState,gt.componentWillUnmount()}catch(vt){rr(I,f,vt)}}break;case 5:Ts(Ze,Ze.return);break;case 22:if(Ze.memoizedState!==null){yc(it);continue}}pt!==null?(pt.return=Ze,mt=pt):yc(it)}et=et.sibling}e:for(et=null,it=e;;){if(it.tag===5){if(et===null){et=it;try{j=it.stateNode,Ve?($=j.style,typeof $.setProperty=="function"?$.setProperty("display","none","important"):$.display="none"):(fe=it.stateNode,be=it.memoizedProps.style,te=be!=null&&be.hasOwnProperty("display")?be.display:null,fe.style.display=Be("display",te))}catch(vt){rr(e,e.return,vt)}}}else if(it.tag===6){if(et===null)try{it.stateNode.nodeValue=Ve?"":it.memoizedProps}catch(vt){rr(e,e.return,vt)}}else if((it.tag!==22&&it.tag!==23||it.memoizedState===null||it===e)&&it.child!==null){it.child.return=it,it=it.child;continue}if(it===e)break e;for(;it.sibling===null;){if(it.return===null||it.return===e)break e;et===it&&(et=null),it=it.return}et===it&&(et=null),it.sibling.return=it.return,it=it.sibling}}break;case 19:si(o,e),Si(e),I&4&&pc(e);break;case 21:break;default:si(o,e),Si(e)}}function Si(e){var o=e.flags;if(o&2){try{e:{for(var f=e.return;f!==null;){if(dc(f)){var I=f;break e}f=f.return}throw Error(r(160))}switch(I.tag){case 5:var j=I.stateNode;I.flags&32&&(we(j,""),I.flags&=-33);var $=hc(e);Yl(e,$,j);break;case 3:case 4:var te=I.stateNode.containerInfo,fe=hc(e);ql(e,fe,te);break;default:throw Error(r(161))}}catch(be){rr(e,e.return,be)}e.flags&=-3}o&4096&&(e.flags&=-4097)}function Jc(e,o,f){mt=e,gc(e)}function gc(e,o,f){for(var I=(e.mode&1)!==0;mt!==null;){var j=mt,$=j.child;if(j.tag===22&&I){var te=j.memoizedState!==null||wa;if(!te){var fe=j.alternate,be=fe!==null&&fe.memoizedState!==null||Mr;fe=wa;var Ve=Mr;if(wa=te,(Mr=be)&&!Ve)for(mt=j;mt!==null;)te=mt,be=te.child,te.tag===22&&te.memoizedState!==null?xc(j):be!==null?(be.return=te,mt=be):xc(j);for(;$!==null;)mt=$,gc($),$=$.sibling;mt=j,wa=fe,Mr=Ve}vc(e)}else(j.subtreeFlags&8772)!==0&&$!==null?($.return=j,mt=$):vc(e)}}function vc(e){for(;mt!==null;){var o=mt;if((o.flags&8772)!==0){var f=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Mr||Sa(5,o);break;case 1:var I=o.stateNode;if(o.flags&4&&!Mr)if(f===null)I.componentDidMount();else{var j=o.elementType===o.type?f.memoizedProps:ii(o.type,f.memoizedProps);I.componentDidUpdate(j,f.memoizedState,I.__reactInternalSnapshotBeforeUpdate)}var $=o.updateQueue;$!==null&&yu(o,$,I);break;case 3:var te=o.updateQueue;if(te!==null){if(f=null,o.child!==null)switch(o.child.tag){case 5:f=o.child.stateNode;break;case 1:f=o.child.stateNode}yu(o,te,f)}break;case 5:var fe=o.stateNode;if(f===null&&o.flags&4){f=fe;var be=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":be.autoFocus&&f.focus();break;case"img":be.src&&(f.src=be.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Ve=o.alternate;if(Ve!==null){var et=Ve.memoizedState;if(et!==null){var it=et.dehydrated;it!==null&&bn(it)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Mr||o.flags&512&&$l(o)}catch(Ze){rr(o,o.return,Ze)}}if(o===e){mt=null;break}if(f=o.sibling,f!==null){f.return=o.return,mt=f;break}mt=o.return}}function yc(e){for(;mt!==null;){var o=mt;if(o===e){mt=null;break}var f=o.sibling;if(f!==null){f.return=o.return,mt=f;break}mt=o.return}}function xc(e){for(;mt!==null;){var o=mt;try{switch(o.tag){case 0:case 11:case 15:var f=o.return;try{Sa(4,o)}catch(be){rr(o,f,be)}break;case 1:var I=o.stateNode;if(typeof I.componentDidMount=="function"){var j=o.return;try{I.componentDidMount()}catch(be){rr(o,j,be)}}var $=o.return;try{$l(o)}catch(be){rr(o,$,be)}break;case 5:var te=o.return;try{$l(o)}catch(be){rr(o,te,be)}}}catch(be){rr(o,o.return,be)}if(o===e){mt=null;break}var fe=o.sibling;if(fe!==null){fe.return=o.return,mt=fe;break}mt=o.return}}var Qc=Math.ceil,Ca=M.ReactCurrentDispatcher,Xl=M.ReactCurrentOwner,Jr=M.ReactCurrentBatchConfig,Nt=0,mr=null,ar=null,br=0,Ur=0,Ms=vi(0),cr=0,To=null,Nn=0,Ea=0,Jl=0,Mo=null,Or=null,Ql=0,Rs=1/0,Bi=null,Aa=!1,Kl=null,cn=null,Ta=!1,dn=null,Ma=0,Ro=0,Zl=null,Ra=-1,ka=0;function Fr(){return(Nt&6)!==0?Jt():Ra!==-1?Ra:Ra=Jt()}function hn(e){return(e.mode&1)===0?1:(Nt&2)!==0&&br!==0?br&-br:bs.transition!==null?(ka===0&&(ka=ci()),ka):(e=Rt,e!==0||(e=window.event,e=e===void 0?16:zo(e.type)),e)}function oi(e,o,f,I){if(50<Ro)throw Ro=0,Zl=null,Error(r(185));Dr(e,f,I),((Nt&2)===0||e!==mr)&&(e===mr&&((Nt&2)===0&&(Ea|=f),cr===4&&fn(e,br)),jr(e,I),f===1&&Nt===0&&(o.mode&1)===0&&(Rs=Jt()+500,xs&&ne()))}function jr(e,o){var f=e.callbackNode;Ui(e,o);var I=Zr(e,e===mr?br:0);if(I===0)f!==null&&vn(f),e.callbackNode=null,e.callbackPriority=0;else if(o=I&-I,e.callbackPriority!==o){if(f!=null&&vn(f),o===1)e.tag===0?z(bc.bind(null,e)):Q(bc.bind(null,e)),hl(function(){(Nt&6)===0&&ne()}),f=null;else{switch(Sr(I)){case 1:f=Ei;break;case 4:f=Po;break;case 16:f=It;break;case 536870912:f=Vr;break;default:f=It}f=Rc(f,_c.bind(null,e))}e.callbackPriority=o,e.callbackNode=f}}function _c(e,o){if(Ra=-1,ka=0,(Nt&6)!==0)throw Error(r(327));var f=e.callbackNode;if(ks()&&e.callbackNode!==f)return null;var I=Zr(e,e===mr?br:0);if(I===0)return null;if((I&30)!==0||(I&e.expiredLanes)!==0||o)o=Pa(e,I);else{o=I;var j=Nt;Nt|=2;var $=Sc();(mr!==e||br!==o)&&(Bi=null,Rs=Jt()+500,Bn(e,o));do try{ed();break}catch(fe){wc(e,fe)}while(!0);vl(),Ca.current=$,Nt=j,ar!==null?o=0:(mr=null,br=0,o=cr)}if(o!==0){if(o===2&&(j=zs(e),j!==0&&(I=j,o=eu(e,j))),o===1)throw f=To,Bn(e,0),fn(e,I),jr(e,Jt()),f;if(o===6)fn(e,I);else{if(j=e.current.alternate,(I&30)===0&&!Kc(j)&&(o=Pa(e,I),o===2&&($=zs(e),$!==0&&(I=$,o=eu(e,$))),o===1))throw f=To,Bn(e,0),fn(e,I),jr(e,Jt()),f;switch(e.finishedWork=j,e.finishedLanes=I,o){case 0:case 1:throw Error(r(345));case 2:Gn(e,Or,Bi);break;case 3:if(fn(e,I),(I&130023424)===I&&(o=Ql+500-Jt(),10<o)){if(Zr(e,0)!==0)break;if(j=e.suspendedLanes,(j&I)!==I){Fr(),e.pingedLanes|=e.suspendedLanes&j;break}e.timeoutHandle=ho(Gn.bind(null,e,Or,Bi),o);break}Gn(e,Or,Bi);break;case 4:if(fn(e,I),(I&4194240)===I)break;for(o=e.eventTimes,j=-1;0<I;){var te=31-Rr(I);$=1<<te,te=o[te],te>j&&(j=te),I&=~$}if(I=j,I=Jt()-I,I=(120>I?120:480>I?480:1080>I?1080:1920>I?1920:3e3>I?3e3:4320>I?4320:1960*Qc(I/1960))-I,10<I){e.timeoutHandle=ho(Gn.bind(null,e,Or,Bi),I);break}Gn(e,Or,Bi);break;case 5:Gn(e,Or,Bi);break;default:throw Error(r(329))}}}return jr(e,Jt()),e.callbackNode===f?_c.bind(null,e):null}function eu(e,o){var f=Mo;return e.current.memoizedState.isDehydrated&&(Bn(e,o).flags|=256),e=Pa(e,o),e!==2&&(o=Or,Or=f,o!==null&&tu(o)),e}function tu(e){Or===null?Or=e:Or.push.apply(Or,e)}function Kc(e){for(var o=e;;){if(o.flags&16384){var f=o.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var I=0;I<f.length;I++){var j=f[I],$=j.getSnapshot;j=j.value;try{if(!sr($(),j))return!1}catch{return!1}}}if(f=o.child,o.subtreeFlags&16384&&f!==null)f.return=o,o=f;else{if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function fn(e,o){for(o&=~Jl,o&=~Ea,e.suspendedLanes|=o,e.pingedLanes&=~o,e=e.expirationTimes;0<o;){var f=31-Rr(o),I=1<<f;e[f]=-1,o&=~I}}function bc(e){if((Nt&6)!==0)throw Error(r(327));ks();var o=Zr(e,0);if((o&1)===0)return jr(e,Jt()),null;var f=Pa(e,o);if(e.tag!==0&&f===2){var I=zs(e);I!==0&&(o=I,f=eu(e,I))}if(f===1)throw f=To,Bn(e,0),fn(e,o),jr(e,Jt()),f;if(f===6)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=o,Gn(e,Or,Bi),jr(e,Jt()),null}function ru(e,o){var f=Nt;Nt|=1;try{return e(o)}finally{Nt=f,Nt===0&&(Rs=Jt()+500,xs&&ne())}}function Vn(e){dn!==null&&dn.tag===0&&(Nt&6)===0&&ks();var o=Nt;Nt|=1;var f=Jr.transition,I=Rt;try{if(Jr.transition=null,Rt=1,e)return e()}finally{Rt=I,Jr.transition=f,Nt=o,(Nt&6)===0&&ne()}}function iu(){Ur=Ms.current,Yt(Ms)}function Bn(e,o){e.finishedWork=null,e.finishedLanes=0;var f=e.timeoutHandle;if(f!==-1&&(e.timeoutHandle=-1,dl(f)),ar!==null)for(f=ar.return;f!==null;){var I=f;switch(zt(I),I.tag){case 1:I=I.type.childContextTypes,I!=null&&Dn();break;case 3:Es(),Yt(Er),Yt(hr),El();break;case 5:Sl(I);break;case 4:Es();break;case 13:Yt(Zt);break;case 19:Yt(Zt);break;case 10:yl(I.type._context);break;case 22:case 23:iu()}f=f.return}if(mr=e,ar=e=pn(e.current,null),br=Ur=o,cr=0,To=null,Jl=Ea=Nn=0,Or=Mo=null,Ln!==null){for(o=0;o<Ln.length;o++)if(f=Ln[o],I=f.interleaved,I!==null){f.interleaved=null;var j=I.next,$=f.pending;if($!==null){var te=$.next;$.next=j,I.next=te}f.pending=I}Ln=null}return e}function wc(e,o){do{var f=ar;try{if(vl(),pa.current=ya,ma){for(var I=er.memoizedState;I!==null;){var j=I.queue;j!==null&&(j.pending=null),I=I.next}ma=!1}if(jn=0,pr=ur=er=null,bo=!1,wo=0,Xl.current=null,f===null||f.return===null){cr=1,To=o,ar=null;break}e:{var $=e,te=f.return,fe=f,be=o;if(o=br,fe.flags|=32768,be!==null&&typeof be=="object"&&typeof be.then=="function"){var Ve=be,et=fe,it=et.tag;if((et.mode&1)===0&&(it===0||it===11||it===15)){var Ze=et.alternate;Ze?(et.updateQueue=Ze.updateQueue,et.memoizedState=Ze.memoizedState,et.lanes=Ze.lanes):(et.updateQueue=null,et.memoizedState=null)}var pt=qu(te);if(pt!==null){pt.flags&=-257,Yu(pt,te,fe,$,o),pt.mode&1&&$u($,Ve,o),o=pt,be=Ve;var gt=o.updateQueue;if(gt===null){var vt=new Set;vt.add(be),o.updateQueue=vt}else gt.add(be);break e}else{if((o&1)===0){$u($,Ve,o),nu();break e}be=Error(r(426))}}else if(tt&&fe.mode&1){var or=qu(te);if(or!==null){(or.flags&65536)===0&&(or.flags|=256),Yu(or,te,fe,$,o),_s(As(be,fe));break e}}$=be=As(be,fe),cr!==4&&(cr=2),Mo===null?Mo=[$]:Mo.push($),$=te;do{switch($.tag){case 3:$.flags|=65536,o&=-o,$.lanes|=o;var Ie=Wu($,be,o);vu($,Ie);break e;case 1:fe=be;var Ce=$.type,Le=$.stateNode;if(($.flags&128)===0&&(typeof Ce.getDerivedStateFromError=="function"||Le!==null&&typeof Le.componentDidCatch=="function"&&(cn===null||!cn.has(Le)))){$.flags|=65536,o&=-o,$.lanes|=o;var at=Hu($,fe,o);vu($,at);break e}}$=$.return}while($!==null)}Ec(f)}catch(xt){o=xt,ar===f&&f!==null&&(ar=f=f.return);continue}break}while(!0)}function Sc(){var e=Ca.current;return Ca.current=ya,e===null?ya:e}function nu(){(cr===0||cr===3||cr===2)&&(cr=4),mr===null||(Nn&268435455)===0&&(Ea&268435455)===0||fn(mr,br)}function Pa(e,o){var f=Nt;Nt|=2;var I=Sc();(mr!==e||br!==o)&&(Bi=null,Bn(e,o));do try{Zc();break}catch(j){wc(e,j)}while(!0);if(vl(),Nt=f,Ca.current=I,ar!==null)throw Error(r(261));return mr=null,br=0,cr}function Zc(){for(;ar!==null;)Cc(ar)}function ed(){for(;ar!==null&&!Wn();)Cc(ar)}function Cc(e){var o=Mc(e.alternate,e,Ur);e.memoizedProps=e.pendingProps,o===null?Ec(e):ar=o,Xl.current=null}function Ec(e){var o=e;do{var f=o.alternate;if(e=o.return,(o.flags&32768)===0){if(f=$c(f,o,Ur),f!==null){ar=f;return}}else{if(f=qc(f,o),f!==null){f.flags&=32767,ar=f;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{cr=6,ar=null;return}}if(o=o.sibling,o!==null){ar=o;return}ar=o=e}while(o!==null);cr===0&&(cr=5)}function Gn(e,o,f){var I=Rt,j=Jr.transition;try{Jr.transition=null,Rt=1,td(e,o,f,I)}finally{Jr.transition=j,Rt=I}return null}function td(e,o,f,I){do ks();while(dn!==null);if((Nt&6)!==0)throw Error(r(327));f=e.finishedWork;var j=e.finishedLanes;if(f===null)return null;if(e.finishedWork=null,e.finishedLanes=0,f===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var $=f.lanes|f.childLanes;if(Va(e,$),e===mr&&(ar=mr=null,br=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||Ta||(Ta=!0,Rc(It,function(){return ks(),null})),$=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||$){$=Jr.transition,Jr.transition=null;var te=Rt;Rt=1;var fe=Nt;Nt|=4,Xl.current=null,Xc(e,f),mc(f,e),Zo(co),Xn=!!uo,co=uo=null,e.current=f,Jc(f),Gi(),Nt=fe,Rt=te,Jr.transition=$}else e.current=f;if(Ta&&(Ta=!1,dn=e,Ma=j),$=e.pendingLanes,$===0&&(cn=null),Ps(f.stateNode),jr(e,Jt()),o!==null)for(I=e.onRecoverableError,f=0;f<o.length;f++)j=o[f],I(j.value,{componentStack:j.stack,digest:j.digest});if(Aa)throw Aa=!1,e=Kl,Kl=null,e;return(Ma&1)!==0&&e.tag!==0&&ks(),$=e.pendingLanes,($&1)!==0?e===Zl?Ro++:(Ro=0,Zl=e):Ro=0,ne(),null}function ks(){if(dn!==null){var e=Sr(Ma),o=Jr.transition,f=Rt;try{if(Jr.transition=null,Rt=16>e?16:e,dn===null)var I=!1;else{if(e=dn,dn=null,Ma=0,(Nt&6)!==0)throw Error(r(331));var j=Nt;for(Nt|=4,mt=e.current;mt!==null;){var $=mt,te=$.child;if((mt.flags&16)!==0){var fe=$.deletions;if(fe!==null){for(var be=0;be<fe.length;be++){var Ve=fe[be];for(mt=Ve;mt!==null;){var et=mt;switch(et.tag){case 0:case 11:case 15:Ao(8,et,$)}var it=et.child;if(it!==null)it.return=et,mt=it;else for(;mt!==null;){et=mt;var Ze=et.sibling,pt=et.return;if(cc(et),et===Ve){mt=null;break}if(Ze!==null){Ze.return=pt,mt=Ze;break}mt=pt}}}var gt=$.alternate;if(gt!==null){var vt=gt.child;if(vt!==null){gt.child=null;do{var or=vt.sibling;vt.sibling=null,vt=or}while(vt!==null)}}mt=$}}if(($.subtreeFlags&2064)!==0&&te!==null)te.return=$,mt=te;else e:for(;mt!==null;){if($=mt,($.flags&2048)!==0)switch($.tag){case 0:case 11:case 15:Ao(9,$,$.return)}var Ie=$.sibling;if(Ie!==null){Ie.return=$.return,mt=Ie;break e}mt=$.return}}var Ce=e.current;for(mt=Ce;mt!==null;){te=mt;var Le=te.child;if((te.subtreeFlags&2064)!==0&&Le!==null)Le.return=te,mt=Le;else e:for(te=Ce;mt!==null;){if(fe=mt,(fe.flags&2048)!==0)try{switch(fe.tag){case 0:case 11:case 15:Sa(9,fe)}}catch(xt){rr(fe,fe.return,xt)}if(fe===te){mt=null;break e}var at=fe.sibling;if(at!==null){at.return=fe.return,mt=at;break e}mt=fe.return}}if(Nt=j,ne(),vr&&typeof vr.onPostCommitFiberRoot=="function")try{vr.onPostCommitFiberRoot(Hn,e)}catch{}I=!0}return I}finally{Rt=f,Jr.transition=o}}return!1}function Ac(e,o,f){o=As(f,o),o=Wu(e,o,1),e=ln(e,o,1),o=Fr(),e!==null&&(Dr(e,1,o),jr(e,o))}function rr(e,o,f){if(e.tag===3)Ac(e,e,f);else for(;o!==null;){if(o.tag===3){Ac(o,e,f);break}else if(o.tag===1){var I=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof I.componentDidCatch=="function"&&(cn===null||!cn.has(I))){e=As(f,e),e=Hu(o,e,1),o=ln(o,e,1),e=Fr(),o!==null&&(Dr(o,1,e),jr(o,e));break}}o=o.return}}function rd(e,o,f){var I=e.pingCache;I!==null&&I.delete(o),o=Fr(),e.pingedLanes|=e.suspendedLanes&f,mr===e&&(br&f)===f&&(cr===4||cr===3&&(br&130023424)===br&&500>Jt()-Ql?Bn(e,0):Jl|=f),jr(e,o)}function Tc(e,o){o===0&&((e.mode&1)===0?o=1:(o=ui,ui<<=1,(ui&130023424)===0&&(ui=4194304)));var f=Fr();e=ji(e,o),e!==null&&(Dr(e,o,f),jr(e,f))}function nd(e){var o=e.memoizedState,f=0;o!==null&&(f=o.retryLane),Tc(e,f)}function sd(e,o){var f=0;switch(e.tag){case 13:var I=e.stateNode,j=e.memoizedState;j!==null&&(f=j.retryLane);break;case 19:I=e.stateNode;break;default:throw Error(r(314))}I!==null&&I.delete(o),Tc(e,f)}var Mc;Mc=function(e,o,f){if(e!==null)if(e.memoizedProps!==o.pendingProps||Er.current)Lr=!0;else{if((e.lanes&f)===0&&(o.flags&128)===0)return Lr=!1,Hc(e,o,f);Lr=(e.flags&131072)!==0}else Lr=!1,tt&&(o.flags&1048576)!==0&&$t(o,Ae,o.index);switch(o.lanes=0,o.tag){case 2:var I=o.type;ba(e,o),e=o.pendingProps;var j=Oi(o,hr.current);Cs(o,f),j=Ml(null,o,I,e,j,f);var $=Rl();return o.flags|=1,typeof j=="object"&&j!==null&&typeof j.render=="function"&&j.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,xr(I)?($=!0,zn(o)):$=!1,o.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,bl(o),j.updater=xa,o.stateNode=j,j._reactInternals=o,zl(o,I,e,f),o=Nl(null,o,I,!0,$,f)):(o.tag=0,tt&&$&&Xt(o),Ir(null,o,j,f),o=o.child),o;case 16:I=o.elementType;e:{switch(ba(e,o),e=o.pendingProps,j=I._init,I=j(I._payload),o.type=I,j=o.tag=ad(I),e=ii(I,e),j){case 0:o=jl(null,o,I,e,f);break e;case 1:o=ec(null,o,I,e,f);break e;case 11:o=Xu(null,o,I,e,f);break e;case 14:o=Ju(null,o,I,ii(I.type,e),f);break e}throw Error(r(306,I,""))}return o;case 0:return I=o.type,j=o.pendingProps,j=o.elementType===I?j:ii(I,j),jl(e,o,I,j,f);case 1:return I=o.type,j=o.pendingProps,j=o.elementType===I?j:ii(I,j),ec(e,o,I,j,f);case 3:e:{if(tc(o),e===null)throw Error(r(387));I=o.pendingProps,$=o.memoizedState,j=$.element,gu(e,o),ha(o,I,null,f);var te=o.memoizedState;if(I=te.element,$.isDehydrated)if($={element:I,isDehydrated:!1,cache:te.cache,pendingSuspenseBoundaries:te.pendingSuspenseBoundaries,transitions:te.transitions},o.updateQueue.baseState=$,o.memoizedState=$,o.flags&256){j=As(Error(r(423)),o),o=rc(e,o,I,f,j);break e}else if(I!==j){j=As(Error(r(424)),o),o=rc(e,o,I,f,j);break e}else for(_t=$r(o.stateNode.containerInfo.firstChild),bt=o,tt=!0,wt=null,f=pu(o,null,I,f),o.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(zr(),I===j){o=Vi(e,o,f);break e}Ir(e,o,I,f)}o=o.child}return o;case 5:return xu(o),e===null&&Bt(o),I=o.type,j=o.pendingProps,$=e!==null?e.memoizedProps:null,te=j.children,Br(I,j)?te=null:$!==null&&Br(I,$)&&(o.flags|=32),Zu(e,o),Ir(e,o,te,f),o.child;case 6:return e===null&&Bt(o),null;case 13:return ic(e,o,f);case 4:return wl(o,o.stateNode.containerInfo),I=o.pendingProps,e===null?o.child=ws(o,null,I,f):Ir(e,o,I,f),o.child;case 11:return I=o.type,j=o.pendingProps,j=o.elementType===I?j:ii(I,j),Xu(e,o,I,j,f);case 7:return Ir(e,o,o.pendingProps,f),o.child;case 8:return Ir(e,o,o.pendingProps.children,f),o.child;case 12:return Ir(e,o,o.pendingProps.children,f),o.child;case 10:e:{if(I=o.type._context,j=o.pendingProps,$=o.memoizedProps,te=j.value,Ht(ua,I._currentValue),I._currentValue=te,$!==null)if(sr($.value,te)){if($.children===j.children&&!Er.current){o=Vi(e,o,f);break e}}else for($=o.child,$!==null&&($.return=o);$!==null;){var fe=$.dependencies;if(fe!==null){te=$.child;for(var be=fe.firstContext;be!==null;){if(be.context===I){if($.tag===1){be=Ni(-1,f&-f),be.tag=2;var Ve=$.updateQueue;if(Ve!==null){Ve=Ve.shared;var et=Ve.pending;et===null?be.next=be:(be.next=et.next,et.next=be),Ve.pending=be}}$.lanes|=f,be=$.alternate,be!==null&&(be.lanes|=f),xl($.return,f,o),fe.lanes|=f;break}be=be.next}}else if($.tag===10)te=$.type===o.type?null:$.child;else if($.tag===18){if(te=$.return,te===null)throw Error(r(341));te.lanes|=f,fe=te.alternate,fe!==null&&(fe.lanes|=f),xl(te,f,o),te=$.sibling}else te=$.child;if(te!==null)te.return=$;else for(te=$;te!==null;){if(te===o){te=null;break}if($=te.sibling,$!==null){$.return=te.return,te=$;break}te=te.return}$=te}Ir(e,o,j.children,f),o=o.child}return o;case 9:return j=o.type,I=o.pendingProps.children,Cs(o,f),j=Yr(j),I=I(j),o.flags|=1,Ir(e,o,I,f),o.child;case 14:return I=o.type,j=ii(I,o.pendingProps),j=ii(I.type,j),Ju(e,o,I,j,f);case 15:return Qu(e,o,o.type,o.pendingProps,f);case 17:return I=o.type,j=o.pendingProps,j=o.elementType===I?j:ii(I,j),ba(e,o),o.tag=1,xr(I)?(e=!0,zn(o)):e=!1,Cs(o,f),Gu(o,I,j),zl(o,I,j,f),Nl(null,o,I,!0,e,f);case 19:return sc(e,o,f);case 22:return Ku(e,o,f)}throw Error(r(156,o.tag))};function Rc(e,o){return gn(e,o)}function od(e,o,f,I){this.tag=e,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=I,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qr(e,o,f,I){return new od(e,o,f,I)}function su(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ad(e){if(typeof e=="function")return su(e)?1:0;if(e!=null){if(e=e.$$typeof,e===V)return 11;if(e===H)return 14}return 2}function pn(e,o){var f=e.alternate;return f===null?(f=Qr(e.tag,o,e.key,e.mode),f.elementType=e.elementType,f.type=e.type,f.stateNode=e.stateNode,f.alternate=e,e.alternate=f):(f.pendingProps=o,f.type=e.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=e.flags&14680064,f.childLanes=e.childLanes,f.lanes=e.lanes,f.child=e.child,f.memoizedProps=e.memoizedProps,f.memoizedState=e.memoizedState,f.updateQueue=e.updateQueue,o=e.dependencies,f.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},f.sibling=e.sibling,f.index=e.index,f.ref=e.ref,f}function Ia(e,o,f,I,j,$){var te=2;if(I=e,typeof e=="function")su(e)&&(te=1);else if(typeof e=="string")te=5;else e:switch(e){case S:return Un(f.children,j,$,o);case E:te=8,j|=8;break;case F:return e=Qr(12,f,o,j|2),e.elementType=F,e.lanes=$,e;case O:return e=Qr(13,f,o,j),e.elementType=O,e.lanes=$,e;case W:return e=Qr(19,f,o,j),e.elementType=W,e.lanes=$,e;case U:return Fa(f,j,$,o);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case D:te=10;break e;case L:te=9;break e;case V:te=11;break e;case H:te=14;break e;case q:te=16,I=null;break e}throw Error(r(130,e==null?e:typeof e,""))}return o=Qr(te,f,o,j),o.elementType=e,o.type=I,o.lanes=$,o}function Un(e,o,f,I){return e=Qr(7,e,I,o),e.lanes=f,e}function Fa(e,o,f,I){return e=Qr(22,e,I,o),e.elementType=U,e.lanes=f,e.stateNode={isHidden:!1},e}function ou(e,o,f){return e=Qr(6,e,null,o),e.lanes=f,e}function au(e,o,f){return o=Qr(4,e.children!==null?e.children:[],e.key,o),o.lanes=f,o.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},o}function ld(e,o,f,I,j){this.tag=o,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$n(0),this.expirationTimes=$n(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$n(0),this.identifierPrefix=I,this.onRecoverableError=j,this.mutableSourceEagerHydrationData=null}function lu(e,o,f,I,j,$,te,fe,be){return e=new ld(e,o,f,fe,be),o===1?(o=1,$===!0&&(o|=8)):o=0,$=Qr(3,null,null,o),e.current=$,$.stateNode=e,$.memoizedState={element:I,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},bl($),e}function ud(e,o,f){var I=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:I==null?null:""+I,children:e,containerInfo:o,implementation:f}}function kc(e){if(!e)return yi;e=e._reactInternals;e:{if(Lt(e)!==e||e.tag!==1)throw Error(r(170));var o=e;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(xr(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(r(171))}if(e.tag===1){var f=e.type;if(xr(f))return go(e,f,o)}return o}function Pc(e,o,f,I,j,$,te,fe,be){return e=lu(f,I,!0,e,j,$,te,fe,be),e.context=kc(null),f=e.current,I=Fr(),j=hn(f),$=Ni(I,j),$.callback=o??null,ln(f,$,j),e.current.lanes=j,Dr(e,j,I),jr(e,I),e}function Da(e,o,f,I){var j=o.current,$=Fr(),te=hn(j);return f=kc(f),o.context===null?o.context=f:o.pendingContext=f,o=Ni($,te),o.payload={element:e},I=I===void 0?null:I,I!==null&&(o.callback=I),e=ln(j,o,te),e!==null&&(oi(e,j,te,$),da(e,j,te)),te}function za(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ic(e,o){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var f=e.retryLane;e.retryLane=f!==0&&f<o?f:o}}function uu(e,o){Ic(e,o),(e=e.alternate)&&Ic(e,o)}function cd(){return null}var Fc=typeof reportError=="function"?reportError:function(e){console.error(e)};function cu(e){this._internalRoot=e}La.prototype.render=cu.prototype.render=function(e){var o=this._internalRoot;if(o===null)throw Error(r(409));Da(e,o,null,null)},La.prototype.unmount=cu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var o=e.containerInfo;Vn(function(){Da(null,e,null,null)}),o[Pr]=null}};function La(e){this._internalRoot=e}La.prototype.unstable_scheduleHydration=function(e){if(e){var o=Ls();e={blockedOn:null,target:e,priority:o};for(var f=0;f<fi.length&&o!==0&&o<fi[f].priority;f++);fi.splice(f,0,e),f===0&&Fo(e)}};function du(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Oa(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Dc(){}function dd(e,o,f,I,j){if(j){if(typeof I=="function"){var $=I;I=function(){var Ve=za(te);$.call(Ve)}}var te=Pc(o,I,e,0,null,!1,!1,"",Dc);return e._reactRootContainer=te,e[Pr]=te.current,Rn(e.nodeType===8?e.parentNode:e),Vn(),te}for(;j=e.lastChild;)e.removeChild(j);if(typeof I=="function"){var fe=I;I=function(){var Ve=za(be);fe.call(Ve)}}var be=lu(e,0,!1,null,null,!1,!1,"",Dc);return e._reactRootContainer=be,e[Pr]=be.current,Rn(e.nodeType===8?e.parentNode:e),Vn(function(){Da(o,be,f,I)}),be}function ja(e,o,f,I,j){var $=f._reactRootContainer;if($){var te=$;if(typeof j=="function"){var fe=j;j=function(){var be=za(te);fe.call(be)}}Da(o,te,e,j)}else te=dd(f,o,e,j,I);return za(te)}jt=function(e){switch(e.tag){case 3:var o=e.stateNode;if(o.current.memoizedState.isDehydrated){var f=nr(o.pendingLanes);f!==0&&(Hr(o,f|1),jr(o,Jt()),(Nt&6)===0&&(Rs=Jt()+500,ne()))}break;case 13:Vn(function(){var I=ji(e,1);if(I!==null){var j=Fr();oi(I,e,1,j)}}),uu(e,1)}},Ti=function(e){if(e.tag===13){var o=ji(e,134217728);if(o!==null){var f=Fr();oi(o,e,134217728,f)}uu(e,134217728)}},qn=function(e){if(e.tag===13){var o=hn(e),f=ji(e,o);if(f!==null){var I=Fr();oi(f,e,o,I)}uu(e,o)}},Ls=function(){return Rt},Mi=function(e,o){var f=Rt;try{return Rt=e,o()}finally{Rt=f}},Z=function(e,o,f){switch(o){case"input":if(Qe(e,f),o=f.name,f.type==="radio"&&o!=null){for(f=e;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<f.length;o++){var I=f[o];if(I!==e&&I.form===e.form){var j=ys(I);if(!j)throw Error(r(90));We(I),Qe(I,j)}}}break;case"textarea":Ue(e,f);break;case"select":o=f.value,o!=null&&Je(e,!!f.multiple,o,!1)}},re=ru,ve=Vn;var hd={usingClientEntryPoint:!1,Events:[Fn,sn,ys,Te,Ee,ru]},ko={findFiberByHostInstance:Li,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fd={bundleType:ko.bundleType,version:ko.version,rendererPackageName:ko.rendererPackageName,rendererConfig:ko.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=dr(e),e===null?null:e.stateNode},findFiberByHostInstance:ko.findFiberByHostInstance||cd,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Na=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Na.isDisabled&&Na.supportsFiber)try{Hn=Na.inject(fd),vr=Na}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hd,reactDom_production_min.createPortal=function(e,o){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!du(o))throw Error(r(200));return ud(e,o,null,f)},reactDom_production_min.createRoot=function(e,o){if(!du(e))throw Error(r(299));var f=!1,I="",j=Fc;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(I=o.identifierPrefix),o.onRecoverableError!==void 0&&(j=o.onRecoverableError)),o=lu(e,1,!1,null,null,f,!1,I,j),e[Pr]=o.current,Rn(e.nodeType===8?e.parentNode:e),new cu(o)},reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var o=e._reactInternals;if(o===void 0)throw typeof e.render=="function"?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=dr(o),e=e===null?null:e.stateNode,e},reactDom_production_min.flushSync=function(e){return Vn(e)},reactDom_production_min.hydrate=function(e,o,f){if(!Oa(o))throw Error(r(200));return ja(null,e,o,!0,f)},reactDom_production_min.hydrateRoot=function(e,o,f){if(!du(e))throw Error(r(405));var I=f!=null&&f.hydratedSources||null,j=!1,$="",te=Fc;if(f!=null&&(f.unstable_strictMode===!0&&(j=!0),f.identifierPrefix!==void 0&&($=f.identifierPrefix),f.onRecoverableError!==void 0&&(te=f.onRecoverableError)),o=Pc(o,null,e,1,f??null,j,!1,$,te),e[Pr]=o.current,Rn(e),I)for(e=0;e<I.length;e++)f=I[e],j=f._getVersion,j=j(f._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[f,j]:o.mutableSourceEagerHydrationData.push(f,j);return new La(o)},reactDom_production_min.render=function(e,o,f){if(!Oa(o))throw Error(r(200));return ja(null,e,o,!1,f)},reactDom_production_min.unmountComponentAtNode=function(e){if(!Oa(e))throw Error(r(40));return e._reactRootContainer?(Vn(function(){ja(null,null,e,!1,function(){e._reactRootContainer=null,e[Pr]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=ru,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,o,f,I){if(!Oa(f))throw Error(r(200));if(e==null||e._reactInternals===void 0)throw Error(r(38));return ja(e,o,f,!1,I)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var n=requireReactDom();return client.createRoot=n.createRoot,client.hydrateRoot=n.hydrateRoot,client}var clientExports=requireClient();async function getProvidersList(n="https://raw.githubusercontent.com/Materials-Consortia/providers/refs/heads/master/src/links/v1/providers.json",t=[]){async function r(x){const b=await fetch(x);if(!b.ok)throw new Error(`HTTP error! status: ${b.status}`);return await b.json()}let u;try{u=await r(n)}catch(x){console.warn("Remote fetch failed, falling back to cachedProviders.json:",x);try{u=await r("cachedProviders.json")}catch(b){throw console.error("Both remote and local fetches failed:",b),b}}const v=u.data.filter(x=>!t.includes(x.id));return{...u,data:v}}async function getProviderLinks(n){const t=v=>(v.data||[]).filter(x=>x.attributes?.link_type==="child"),r=[{name:"direct",url:`${n}/v1/links`},{name:"allorigins",url:`https://api.allorigins.win/raw?url=${encodeURIComponent(`${n}/v1/links`)}`},{name:"cors-anywhere",url:`https://cors-anywhere.com/${n}/v1/links`}];for(const{url:v,name:x}of r)try{const b=await fetch(v);if(!b.ok)continue;const p=await b.json();return{children:t(p),error:null}}catch{continue}const u=new Error("All fetch methods failed");return{children:[],error:u}}async function getInfo({providerUrl:n}){console.log(`${n}/v1/info`);const t=[{name:"direct",url:`${n}/v1/info/structures`},{name:"allorigins",url:`https://api.allorigins.win/raw?url=${encodeURIComponent(`${n}/v1/info/structures`)}`},{name:"cors-anywhere",url:`https://cors-anywhere.com/${n}/v1/info/structures`}];for(const{url:r,name:u}of t){console.log(r);try{const v=await fetch(r);if(!v.ok)continue;const x=await v.json(),b=x.data.properties,p=Object.fromEntries(Object.entries(x.data.properties).filter(([y,k])=>y.startsWith("_")));return console.log(p),{customProps:p,error:null}}catch{continue}}}async function getStructures({providerUrl:n,filter:t="",page:r=1,pageSize:u=20}){if(!n)throw new Error("Provider URL is required");const v=(r-1)*u,x=t?`?filter=${encodeURIComponent(t)}&page_offset=${v}`:`?page_offset=${v}`,b=[`${n}/v1/structures${x}`,`https://api.allorigins.win/raw?url=${encodeURIComponent(`${n}/v1/structures${x}`)}`,`https://cors-anywhere.com/${n}/v1/structures${x}`];for(const p of b)try{console.log("URL",p);const y=await fetch(p);if(!y.ok)continue;return await y.json()}catch{continue}throw new Error("All fetch methods failed for getStructures")}function OptimadeHeader(){return jsxRuntimeExports$1.jsx("div",{className:"flex justify-center py-4 bg-white shadow w-full",children:jsxRuntimeExports$1.jsx("img",{src:"optimade_logo.png",alt:"OptimadeLogo",className:"h-24 sm:h-32 w-auto object-contain"})})}var lodash_debounce,hasRequiredLodash_debounce;function requireLodash_debounce(){if(hasRequiredLodash_debounce)return lodash_debounce;hasRequiredLodash_debounce=1;var n="Expected a function",t=NaN,r="[object Symbol]",u=/^\s+|\s+$/g,v=/^[-+]0x[0-9a-f]+$/i,x=/^0b[01]+$/i,b=/^0o[0-7]+$/i,p=parseInt,y=typeof commonjsGlobal$1=="object"&&commonjsGlobal$1&&commonjsGlobal$1.Object===Object&&commonjsGlobal$1,k=typeof self=="object"&&self&&self.Object===Object&&self,g=y||k||Function("return this")(),R=Object.prototype,P=R.toString,T=Math.max,C=Math.min,a=function(){return g.Date.now()};function s(l,h,S){var E,F,D,L,V,O,W=0,H=!1,q=!1,U=!0;if(typeof l!="function")throw new TypeError(n);h=M(h)||0,c(S)&&(H=!!S.leading,q="maxWait"in S,D=q?T(M(S.maxWait)||0,h):D,U="trailing"in S?!!S.trailing:U);function B(de){var ue=E,ge=F;return E=F=void 0,W=de,L=l.apply(ge,ue),L}function Y(de){return W=de,V=setTimeout(J,h),H?B(de):L}function X(de){var ue=de-O,ge=de-W,Re=h-ue;return q?C(Re,D-ge):Re}function N(de){var ue=de-O,ge=de-W;return O===void 0||ue>=h||ue<0||q&&ge>=D}function J(){var de=a();if(N(de))return ae(de);V=setTimeout(J,X(de))}function ae(de){return V=void 0,U&&E?B(de):(E=F=void 0,L)}function se(){V!==void 0&&clearTimeout(V),W=0,E=O=F=V=void 0}function he(){return V===void 0?L:ae(a())}function pe(){var de=a(),ue=N(de);if(E=arguments,F=this,O=de,ue){if(V===void 0)return Y(O);if(q)return V=setTimeout(J,h),B(O)}return V===void 0&&(V=setTimeout(J,h)),L}return pe.cancel=se,pe.flush=he,pe}function c(l){var h=typeof l;return!!l&&(h=="object"||h=="function")}function w(l){return!!l&&typeof l=="object"}function _(l){return typeof l=="symbol"||w(l)&&P.call(l)==r}function M(l){if(typeof l=="number")return l;if(_(l))return t;if(c(l)){var h=typeof l.valueOf=="function"?l.valueOf():l;l=c(h)?h+"":h}if(typeof l!="string")return l===0?l:+l;l=l.replace(u,"");var S=x.test(l);return S||b.test(l)?p(l.slice(2),S?2:8):v.test(l)?t:+l}return lodash_debounce=s,lodash_debounce}var lodash_debounceExports=requireLodash_debounce();const debounce=getDefaultExportFromCjs(lodash_debounceExports),slateDropdown=`
 w-full border-2 border-slate-300
 bg-slate-200 py-1 px-3 rounded shadow hover:cursor-pointer
hover:bg-slate-300 disabled:cursor-not-allowed
 disabled:bg-gray-100`;function DatabaseSelector({providers:n,onQueryUrlChange:t}){const[r,u]=reactExports.useState(""),[v,x]=reactExports.useState([]),[b,p]=reactExports.useState(""),[y,k]=reactExports.useState(""),[g,R]=reactExports.useState(!1),P=debounce(T=>k(T),300);return reactExports.useEffect(()=>{if(!r||r==="__custom__"){x([]),p(""),t(y||"");return}async function T(){try{R(!0);const{children:C}=await getProviderLinks(r),a=C.map(s=>s.attributes||{});x(a),p("")}catch(C){console.error(C),x([]),p("")}finally{R(!1)}}T()},[r]),reactExports.useEffect(()=>{t(r==="__custom__"?y:b||"")},[r,b,y,t]),jsxRuntimeExports$1.jsxs("div",{className:"flex flex-col items-start space-y-2 w-full max-w-lg",children:[jsxRuntimeExports$1.jsxs("select",{className:slateDropdown,value:r,onChange:T=>u(T.target.value),children:[jsxRuntimeExports$1.jsx("option",{value:"",disabled:!0,children:"Select a provider"}),n.map(T=>jsxRuntimeExports$1.jsx("option",{value:T.attributes?.base_url||"",children:T.attributes?.name||T.id},T.attributes?.id||T.id)),jsxRuntimeExports$1.jsx("option",{value:"__custom__",children:"Custom endpoint"})]}),r==="__custom__"?jsxRuntimeExports$1.jsx("input",{type:"text",placeholder:"Enter custom URL",className:"min-w-96",onChange:T=>P(T.target.value)}):jsxRuntimeExports$1.jsx("select",{className:slateDropdown,value:b,onChange:T=>p(T.target.value),disabled:g,children:g?jsxRuntimeExports$1.jsx("option",{children:"Loading"}):jsxRuntimeExports$1.jsxs(jsxRuntimeExports$1.Fragment,{children:[jsxRuntimeExports$1.jsx("option",{value:"",disabled:!0,children:"Select a subdatabase"}),v.map(T=>jsxRuntimeExports$1.jsx("option",{value:T.base_url,children:T.name},T.id))]})})]})}const elements=[{num:1,sym:"H",row:1,col:1,group:"group1"},{num:2,sym:"He",row:1,col:18,group:"group18"},{num:3,sym:"Li",row:2,col:1,group:"group1"},{num:4,sym:"Be",row:2,col:2,group:"group2"},{num:5,sym:"B",row:2,col:13,group:"metalloid"},{num:6,sym:"C",row:2,col:14,group:"mainGroup"},{num:7,sym:"N",row:2,col:15,group:"mainGroup"},{num:8,sym:"O",row:2,col:16,group:"mainGroup"},{num:9,sym:"F",row:2,col:17,group:"group17"},{num:10,sym:"Ne",row:2,col:18,group:"group18"},{num:11,sym:"Na",row:3,col:1,group:"group1"},{num:12,sym:"Mg",row:3,col:2,group:"group2"},{num:13,sym:"Al",row:3,col:13,group:"postTransition"},{num:14,sym:"Si",row:3,col:14,group:"metalloid"},{num:15,sym:"P",row:3,col:15,group:"mainGroup"},{num:16,sym:"S",row:3,col:16,group:"mainGroup"},{num:17,sym:"Cl",row:3,col:17,group:"group17"},{num:18,sym:"Ar",row:3,col:18,group:"group18"},{num:19,sym:"K",row:4,col:1,group:"group1"},{num:20,sym:"Ca",row:4,col:2,group:"group2"},{num:21,sym:"Sc",row:4,col:3,group:"transition"},{num:22,sym:"Ti",row:4,col:4,group:"transition"},{num:23,sym:"V",row:4,col:5,group:"transition"},{num:24,sym:"Cr",row:4,col:6,group:"transition"},{num:25,sym:"Mn",row:4,col:7,group:"transition"},{num:26,sym:"Fe",row:4,col:8,group:"transition"},{num:27,sym:"Co",row:4,col:9,group:"transition"},{num:28,sym:"Ni",row:4,col:10,group:"transition"},{num:29,sym:"Cu",row:4,col:11,group:"transition"},{num:30,sym:"Zn",row:4,col:12,group:"transition"},{num:31,sym:"Ga",row:4,col:13,group:"postTransition"},{num:32,sym:"Ge",row:4,col:14,group:"metalloid"},{num:33,sym:"As",row:4,col:15,group:"metalloid"},{num:34,sym:"Se",row:4,col:16,group:"mainGroup"},{num:35,sym:"Br",row:4,col:17,group:"group17"},{num:36,sym:"Kr",row:4,col:18,group:"group18"},{num:37,sym:"Rb",row:5,col:1,group:"group1"},{num:38,sym:"Sr",row:5,col:2,group:"group2"},{num:39,sym:"Y",row:5,col:3,group:"transition"},{num:40,sym:"Zr",row:5,col:4,group:"transition"},{num:41,sym:"Nb",row:5,col:5,group:"transition"},{num:42,sym:"Mo",row:5,col:6,group:"transition"},{num:43,sym:"Tc",row:5,col:7,group:"transition"},{num:44,sym:"Ru",row:5,col:8,group:"transition"},{num:45,sym:"Rh",row:5,col:9,group:"transition"},{num:46,sym:"Pd",row:5,col:10,group:"transition"},{num:47,sym:"Ag",row:5,col:11,group:"transition"},{num:48,sym:"Cd",row:5,col:12,group:"transition"},{num:49,sym:"In",row:5,col:13,group:"postTransition"},{num:50,sym:"Sn",row:5,col:14,group:"postTransition"},{num:51,sym:"Sb",row:5,col:15,group:"metalloid"},{num:52,sym:"Te",row:5,col:16,group:"metalloid"},{num:53,sym:"I",row:5,col:17,group:"group17"},{num:54,sym:"Xe",row:5,col:18,group:"group18"},{num:55,sym:"Cs",row:6,col:1,group:"group1"},{num:56,sym:"Ba",row:6,col:2,group:"group2"},{num:72,sym:"Hf",row:6,col:4,group:"transition"},{num:73,sym:"Ta",row:6,col:5,group:"transition"},{num:74,sym:"W",row:6,col:6,group:"transition"},{num:75,sym:"Re",row:6,col:7,group:"transition"},{num:76,sym:"Os",row:6,col:8,group:"transition"},{num:77,sym:"Ir",row:6,col:9,group:"transition"},{num:78,sym:"Pt",row:6,col:10,group:"transition"},{num:79,sym:"Au",row:6,col:11,group:"transition"},{num:80,sym:"Hg",row:6,col:12,group:"transition"},{num:81,sym:"Tl",row:6,col:13,group:"postTransition"},{num:82,sym:"Pb",row:6,col:14,group:"postTransition"},{num:83,sym:"Bi",row:6,col:15,group:"postTransition"},{num:84,sym:"Po",row:6,col:16,group:"postTransition"},{num:85,sym:"At",row:6,col:17,group:"group17"},{num:86,sym:"Rn",row:6,col:18,group:"group18"},{num:87,sym:"Fr",row:7,col:1,group:"group1"},{num:88,sym:"Ra",row:7,col:2,group:"group2"},{num:104,sym:"Rf",row:7,col:4,group:"transition"},{num:105,sym:"Db",row:7,col:5,group:"transition"},{num:106,sym:"Sg",row:7,col:6,group:"transition"},{num:107,sym:"Bh",row:7,col:7,group:"transition"},{num:108,sym:"Hs",row:7,col:8,group:"transition"},{num:109,sym:"Mt",row:7,col:9,group:"bg-lime-200"},{num:110,sym:"Ds",row:7,col:10,group:"bg-lime-200"},{num:111,sym:"Rg",row:7,col:11,group:"bg-lime-200"},{num:112,sym:"Cn",row:7,col:12,group:"bg-lime-200"},{num:113,sym:"Nh",row:7,col:13,group:"bg-lime-200"},{num:114,sym:"Fl",row:7,col:14,group:"bg-lime-200"},{num:115,sym:"Mc",row:7,col:15,group:"bg-lime-200"},{num:116,sym:"Lv",row:7,col:16,group:"bg-lime-200"},{num:117,sym:"Ts",row:7,col:17,group:"bg-lime-200"},{num:118,sym:"Og",row:7,col:18,group:"bg-lime-200"},{num:57,sym:"La",row:12,col:3,group:"lanthanide"},{num:58,sym:"Ce",row:12,col:4,group:"lanthanide"},{num:59,sym:"Pr",row:12,col:5,group:"lanthanide"},{num:60,sym:"Nd",row:12,col:6,group:"lanthanide"},{num:61,sym:"Pm",row:12,col:7,group:"lanthanide"},{num:62,sym:"Sm",row:12,col:8,group:"lanthanide"},{num:63,sym:"Eu",row:12,col:9,group:"lanthanide"},{num:64,sym:"Gd",row:12,col:10,group:"lanthanide"},{num:65,sym:"Tb",row:12,col:11,group:"lanthanide"},{num:66,sym:"Dy",row:12,col:12,group:"lanthanide"},{num:67,sym:"Ho",row:12,col:13,group:"lanthanide"},{num:68,sym:"Er",row:12,col:14,group:"lanthanide"},{num:69,sym:"Tm",row:12,col:15,group:"lanthanide"},{num:70,sym:"Yb",row:12,col:16,group:"lanthanide"},{num:71,sym:"Lu",row:12,col:17,group:"lanthanide"},{num:89,sym:"Ac",row:13,col:3,group:"actinide"},{num:90,sym:"Th",row:13,col:4,group:"actinide"},{num:91,sym:"Pa",row:13,col:5,group:"actinide"},{num:92,sym:"U",row:13,col:6,group:"actinide"},{num:93,sym:"Np",row:13,col:7,group:"actinide"},{num:94,sym:"Pu",row:13,col:8,group:"actinide"},{num:95,sym:"Am",row:13,col:9,group:"actinide"},{num:96,sym:"Cm",row:13,col:10,group:"actinide"},{num:97,sym:"Bk",row:13,col:11,group:"actinide"},{num:98,sym:"Cf",row:13,col:12,group:"actinide"},{num:99,sym:"Es",row:13,col:13,group:"actinide"},{num:100,sym:"Fm",row:13,col:14,group:"actinide"},{num:101,sym:"Md",row:13,col:15,group:"actinide"},{num:102,sym:"No",row:13,col:16,group:"actinide"},{num:103,sym:"Lr",row:13,col:17,group:"actinide"}],defaultColors={group1:"bg-[#d7bbbb]",group2:"bg-[#d7cdbb]",group17:"bg-[#d7d9c2]",group18:"bg-[#d0d5ee]",transition:"bg-[#c4d0d8]",lanthanide:"bg-[#e5cbee]",actinide:"bg-[#aebcee]",metalloid:"bg-[#cdd9c2]",postTransition:"bg-[#c2c8d9]",mainGroup:"bg-[#d9c2ce]",default:"bg-gray-200"};function PTable({selected:n={},onSelectionChange:t,colors:r=defaultColors,selectedClassName:u="bg-green-400 border border-green-700 text-white scale-105",deselectedClassName:v="bg-red-400 border border-red-700 text-white scale-105",defaultBorderClassName:x="border border-slate-700",hoverClassName:b="transform transition-transform duration-100 hover:scale-105 hover:z-10"}){const p=k=>{if(!t)return;const g=((n[k]??0)+1)%3;t({[k]:g})},y=k=>{const g=n[k.sym]??0;let R=r[k.group]??r.default;return g===1?u:g===2?v:`${R} ${x}`};return jsxRuntimeExports$1.jsx("div",{className:"w-full max-w-full mx-auto p-0",children:jsxRuntimeExports$1.jsx("div",{className:"@container",children:jsxRuntimeExports$1.jsx("div",{className:"grid @gap-0.5 @sm:gap-1 w-full",style:{gridTemplateColumns:"repeat(18, minmax(0, 1fr))"},children:elements.map(k=>jsxRuntimeExports$1.jsx("div",{style:{gridColumn:k.col,gridRow:k.row},className:"relative w-full",children:jsxRuntimeExports$1.jsx("div",{className:"w-full aspect-square",children:jsxRuntimeExports$1.jsxs("button",{onClick:()=>p(k.sym),className:`flex flex-col justify-center items-center w-full h-full rounded-sm ${b} ${y(k)}`,children:[jsxRuntimeExports$1.jsx("span",{className:`
                      text-[0px] opacity-0
                      @sm:text-[0.3rem] @sm:opacity-100
                      @md:text-[0.5rem]
                      @lg:text-[0.7rem]
                      text-gray-700 leading-tight
                    `,children:k.num}),jsxRuntimeExports$1.jsx("span",{className:`
                      text-[0.55rem]
                      font-medium leading-none
                    `,style:{fontSize:"clamp(0.55rem, 2.5vw, 1.25rem)"},children:k.sym})]})})},k.sym))})})})}function QueryTextBox({value:n,onChange:t,placeholder:r="Enter filter",onSubmit:u,loading:v=!1}){return jsxRuntimeExports$1.jsx("div",{className:"space-y-2",children:jsxRuntimeExports$1.jsxs("form",{onSubmit:x=>{x.preventDefault(),u?.()},className:"flex gap-2",children:[jsxRuntimeExports$1.jsx("input",{type:"text",value:n,onChange:x=>t(x.target.value),placeholder:r,className:"flex-1 p-2 border border-gray-300 rounded shadow focus:outline-none focus:ring-2 focus:ring-blue-500"}),jsxRuntimeExports$1.jsx("button",{type:"submit",disabled:v,className:"px-4 py-2 bg-blue-500 text-white rounded shadow hover:bg-blue-600 disabled:opacity-50",children:v?"Loading":"Submit"})]})})}var lib={},Range={},utils={},types={},hasRequiredTypes;function requireTypes(){if(hasRequiredTypes)return types;hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0}),types.Direction=void 0;var n;return(function(t){t.Right="to right",t.Left="to left",t.Down="to bottom",t.Up="to top"})(n||(types.Direction=n={})),types}var hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,(function(n){var t=utils&&utils.__spreadArray||function(V,O,W){if(W||arguments.length===2)for(var H=0,q=O.length,U;H<q;H++)(U||!(H in O))&&(U||(U=Array.prototype.slice.call(O,0,H)),U[H]=O[H]);return V.concat(U||Array.prototype.slice.call(O))};Object.defineProperty(n,"__esModule",{value:!0}),n.isIOS=n.useThumbOverlap=n.assertUnreachable=n.voidFn=n.getTrackBackground=n.replaceAt=n.schd=n.translate=n.getClosestThumbIndex=n.translateThumbs=n.getPaddingAndBorder=n.getMargin=n.checkInitialOverlap=n.checkValuesAgainstBoundaries=n.checkBoundaries=n.isVertical=n.relativeValue=n.normalizeValue=n.isStepDivisible=n.isTouchEvent=n.getStepDecimals=void 0;var r=requireReact(),u=requireTypes(),v=function(V){var O=V.toString().split(".")[1];return O?O.length:0};n.getStepDecimals=v;function x(V){return V.touches&&V.touches.length||V.changedTouches&&V.changedTouches.length}n.isTouchEvent=x;function b(V,O,W){var H=(O-V)/W,q=8,U=Number(H.toFixed(q));return parseInt(U.toString(),10)===U}n.isStepDivisible=b;function p(V,O,W,H,q,U,B){var Y=1e11;if(V=Math.round(V*Y)/Y,!U){var X=B[O-1],N=B[O+1];if(X&&X>V)return X;if(N&&N<V)return N}if(V>H)return H;if(V<W)return W;var J=Math.floor(V*Y-W*Y)%Math.floor(q*Y),ae=Math.floor(V*Y-Math.abs(J)),se=J===0?V:ae/Y,he=Math.abs(J/Y)<q/2?se:se+q,pe=(0,n.getStepDecimals)(q);return parseFloat(he.toFixed(pe))}n.normalizeValue=p;function y(V,O,W){return(V-O)/(W-O)}n.relativeValue=y;function k(V){return V===u.Direction.Up||V===u.Direction.Down}n.isVertical=k;function g(V,O,W){if(O>=W)throw new RangeError("min (".concat(O,") is equal/bigger than max (").concat(W,")"));if(V<O)throw new RangeError("value (".concat(V,") is smaller than min (").concat(O,")"));if(V>W)throw new RangeError("value (".concat(V,") is bigger than max (").concat(W,")"))}n.checkBoundaries=g;function R(V,O,W){return V<O?O:V>W?W:V}n.checkValuesAgainstBoundaries=R;function P(V){if(!(V.length<2)&&!V.slice(1).every(function(O,W){return V[W]<=O}))throw new RangeError("values={[".concat(V,"]} needs to be sorted when allowOverlap={false}"))}n.checkInitialOverlap=P;function T(V){var O=window.getComputedStyle(V);return{top:parseInt(O["margin-top"],10),bottom:parseInt(O["margin-bottom"],10),left:parseInt(O["margin-left"],10),right:parseInt(O["margin-right"],10)}}n.getMargin=T;function C(V){var O=window.getComputedStyle(V);return{top:parseInt(O["padding-top"],10)+parseInt(O["border-top-width"],10),bottom:parseInt(O["padding-bottom"],10)+parseInt(O["border-bottom-width"],10),left:parseInt(O["padding-left"],10)+parseInt(O["border-left-width"],10),right:parseInt(O["padding-right"],10)+parseInt(O["border-right-width"],10)}}n.getPaddingAndBorder=C;function a(V,O,W){var H=W?-1:1;V.forEach(function(q,U){return c(q,H*O[U].x,O[U].y)})}n.translateThumbs=a;function s(V,O,W,H){for(var q=0,U=D(V[0],O,W,H),B=1;B<V.length;B++){var Y=D(V[B],O,W,H);Y<U&&(U=Y,q=B)}return q}n.getClosestThumbIndex=s;function c(V,O,W){V.style.transform="translate(".concat(O,"px, ").concat(W,"px)")}n.translate=c;var w=function(V){var O=[],W=null,H=function(){for(var q=[],U=0;U<arguments.length;U++)q[U]=arguments[U];O=q,!W&&(W=requestAnimationFrame(function(){W=null,V.apply(void 0,O)}))};return H};n.schd=w;function _(V,O,W){var H=V.slice(0);return H[O]=W,H}n.replaceAt=_;function M(V){var O=V.values,W=V.colors,H=V.min,q=V.max,U=V.direction,B=U===void 0?u.Direction.Right:U,Y=V.rtl,X=Y===void 0?!1:Y;X&&B===u.Direction.Right?B=u.Direction.Left:X&&u.Direction.Left&&(B=u.Direction.Right);var N=O.slice(0).sort(function(ae,se){return ae-se}).map(function(ae){return(ae-H)/(q-H)*100}),J=N.reduce(function(ae,se,he){return"".concat(ae,", ").concat(W[he]," ").concat(se,"%, ").concat(W[he+1]," ").concat(se,"%")},"");return"linear-gradient(".concat(B,", ").concat(W[0]," 0%").concat(J,", ").concat(W[W.length-1]," 100%)")}n.getTrackBackground=M;function l(){}n.voidFn=l;function h(V){throw new Error("Didn't expect to get here")}n.assertUnreachable=h;var S=function(V,O,W,H,q){q===void 0&&(q=function(B){return B});var U=Math.ceil(t([V],Array.from(V.children),!0).reduce(function(B,Y){var X=Math.ceil(Y.getBoundingClientRect().width);if(Y.innerText&&Y.innerText.includes(W)&&Y.childElementCount===0){var N=Y.cloneNode(!0);N.innerHTML=q(O.toFixed(H)),N.style.visibility="hidden",document.body.appendChild(N),X=Math.ceil(N.getBoundingClientRect().width),document.body.removeChild(N)}return X>B?X:B},V.getBoundingClientRect().width));return U},E=function(V,O,W,H,q,U,B){B===void 0&&(B=function(N){return N});var Y=[],X=function(N){var J=S(W[N],H[N],q,U,B),ae=O[N].x;O.forEach(function(se,he){var pe=se.x,de=S(W[he],H[he],q,U,B);N!==he&&(ae>=pe&&ae<=pe+de||ae+J>=pe&&ae+J<=pe+de)&&(Y.includes(he)||(Y.push(N),Y.push(he),Y=t(t([],Y,!0),[N,he],!1),X(he)))})};return X(V),Array.from(new Set(Y.sort()))},F=function(V,O,W,H,q,U){H===void 0&&(H=.1),q===void 0&&(q=" - "),U===void 0&&(U=function(he){return he});var B=(0,n.getStepDecimals)(H),Y=(0,r.useState)({}),X=Y[0],N=Y[1],J=(0,r.useState)(U(O[W].toFixed(B))),ae=J[0],se=J[1];return(0,r.useEffect)(function(){if(V){var he=V.getThumbs();if(he.length<1)return;var pe={},de=V.getOffsets(),ue=E(W,de,he,O,q,B,U),ge=U(O[W].toFixed(B));if(ue.length){var Re=ue.reduce(function(Fe,qe,Qe,st){return Fe.length?t(t([],Fe,!0),[de[st[Qe]].x],!1):[de[st[Qe]].x]},[]);if(Math.min.apply(Math,Re)===de[W].x){var Ge=[];ue.forEach(function(Fe){Ge.push(O[Fe].toFixed(B))}),ge=Array.from(new Set(Ge.sort(function(Fe,qe){return parseFloat(Fe)-parseFloat(qe)}))).map(U).join(q);var We=Math.min.apply(Math,Re),Oe=Math.max.apply(Math,Re),me=he[ue[Re.indexOf(Oe)]].getBoundingClientRect().width;pe.left="".concat(Math.abs(We-(Oe+me))/2,"px"),pe.transform="translate(-50%, 0)"}else pe.visibility="hidden"}se(ge),N(pe)}},[V,O]),[ae,X]};n.useThumbOverlap=F;function D(V,O,W,H){var q=V.getBoundingClientRect(),U=q.left,B=q.top,Y=q.width,X=q.height;return k(H)?Math.abs(W-(B+X/2)):Math.abs(O-(U+Y/2))}var L=function(){var V,O=((V=navigator.userAgentData)===null||V===void 0?void 0:V.platform)||navigator.platform;return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(O)||navigator.userAgent.includes("Mac")&&"ontouchend"in document};n.isIOS=L})(utils)),utils}var hasRequiredRange;function requireRange(){if(hasRequiredRange)return Range;hasRequiredRange=1;var n=Range&&Range.__extends||(function(){var R=function(P,T){return R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,a){C.__proto__=a}||function(C,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(C[s]=a[s])},R(P,T)};return function(P,T){if(typeof T!="function"&&T!==null)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");R(P,T);function C(){this.constructor=P}P.prototype=T===null?Object.create(T):(C.prototype=T.prototype,new C)}})(),t=Range&&Range.__createBinding||(Object.create?(function(R,P,T,C){C===void 0&&(C=T);var a=Object.getOwnPropertyDescriptor(P,T);(!a||("get"in a?!P.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return P[T]}}),Object.defineProperty(R,C,a)}):(function(R,P,T,C){C===void 0&&(C=T),R[C]=P[T]})),r=Range&&Range.__setModuleDefault||(Object.create?(function(R,P){Object.defineProperty(R,"default",{enumerable:!0,value:P})}):function(R,P){R.default=P}),u=Range&&Range.__importStar||function(R){if(R&&R.__esModule)return R;var P={};if(R!=null)for(var T in R)T!=="default"&&Object.prototype.hasOwnProperty.call(R,T)&&t(P,R,T);return r(P,R),P},v=Range&&Range.__spreadArray||function(R,P,T){if(T||arguments.length===2)for(var C=0,a=P.length,s;C<a;C++)(s||!(C in P))&&(s||(s=Array.prototype.slice.call(P,0,C)),s[C]=P[C]);return R.concat(s||Array.prototype.slice.call(P))};Object.defineProperty(Range,"__esModule",{value:!0});var x=u(requireReact()),b=requireUtils(),p=requireTypes(),y=["ArrowRight","ArrowUp","k","PageUp"],k=["ArrowLeft","ArrowDown","j","PageDown"],g=(function(R){n(P,R);function P(T){var C=R.call(this,T)||this;if(C.trackRef=x.createRef(),C.thumbRefs=[],C.state={draggedTrackPos:[-1,-1],draggedThumbIndex:-1,thumbZIndexes:new Array(C.props.values.length).fill(0).map(function(a,s){return s}),isChanged:!1,markOffsets:[]},C.getOffsets=function(){var a=C.props,s=a.direction,c=a.values,w=a.min,_=a.max,M=C.trackRef.current;if(!M)return console.warn("No track element found."),[];var l=M.getBoundingClientRect(),h=(0,b.getPaddingAndBorder)(M);return C.getThumbs().map(function(S,E){var F={x:0,y:0},D=S.getBoundingClientRect(),L=(0,b.getMargin)(S);switch(s){case p.Direction.Right:return F.x=(L.left+h.left)*-1,F.y=((D.height-l.height)/2+h.top)*-1,F.x+=l.width*(0,b.relativeValue)(c[E],w,_)-D.width/2,F;case p.Direction.Left:return F.x=(L.right+h.right)*-1,F.y=((D.height-l.height)/2+h.top)*-1,F.x+=l.width-l.width*(0,b.relativeValue)(c[E],w,_)-D.width/2,F;case p.Direction.Up:return F.x=((D.width-l.width)/2+L.left+h.left)*-1,F.y=-h.left,F.y+=l.height-l.height*(0,b.relativeValue)(c[E],w,_)-D.height/2,F;case p.Direction.Down:return F.x=((D.width-l.width)/2+L.left+h.left)*-1,F.y=-h.left,F.y+=l.height*(0,b.relativeValue)(c[E],w,_)-D.height/2,F;default:return(0,b.assertUnreachable)(s)}})},C.getThumbs=function(){return C.trackRef&&C.trackRef.current?Array.from(C.trackRef.current.children).filter(function(a){return a.hasAttribute("aria-valuenow")}):(console.warn("No thumbs found in the track container. Did you forget to pass & spread the `props` param in renderTrack?"),[])},C.getTargetIndex=function(a){return C.getThumbs().findIndex(function(s){return s===a.target||s.contains(a.target)})},C.addTouchEvents=function(a){document.addEventListener("touchmove",C.schdOnTouchMove,{passive:!1}),document.addEventListener("touchend",C.schdOnEnd,{passive:!1}),document.addEventListener("touchcancel",C.schdOnEnd,{passive:!1})},C.addMouseEvents=function(a){document.addEventListener("mousemove",C.schdOnMouseMove),document.addEventListener("mouseup",C.schdOnEnd)},C.onMouseDownTrack=function(a){var s;if(!(a.button!==0||(0,b.isIOS)()))if(a.persist(),a.preventDefault(),C.addMouseEvents(a.nativeEvent),C.props.values.length>1&&C.props.draggableTrack){if(C.thumbRefs.some(function(w){var _;return(_=w.current)===null||_===void 0?void 0:_.contains(a.target)}))return;C.setState({draggedTrackPos:[a.clientX,a.clientY]},function(){return C.onMove(a.clientX,a.clientY)})}else{var c=(0,b.getClosestThumbIndex)(C.thumbRefs.map(function(w){return w.current}),a.clientX,a.clientY,C.props.direction);(s=C.thumbRefs[c].current)===null||s===void 0||s.focus(),C.setState({draggedThumbIndex:c},function(){return C.onMove(a.clientX,a.clientY)})}},C.onResize=function(){(0,b.translateThumbs)(C.getThumbs(),C.getOffsets(),C.props.rtl),C.calculateMarkOffsets()},C.onTouchStartTrack=function(a){var s;if(a.persist(),C.addTouchEvents(a.nativeEvent),C.props.values.length>1&&C.props.draggableTrack){if(C.thumbRefs.some(function(w){var _;return(_=w.current)===null||_===void 0?void 0:_.contains(a.target)}))return;C.setState({draggedTrackPos:[a.touches[0].clientX,a.touches[0].clientY]},function(){return C.onMove(a.touches[0].clientX,a.touches[0].clientY)})}else{var c=(0,b.getClosestThumbIndex)(C.thumbRefs.map(function(w){return w.current}),a.touches[0].clientX,a.touches[0].clientY,C.props.direction);(s=C.thumbRefs[c].current)===null||s===void 0||s.focus(),C.setState({draggedThumbIndex:c},function(){return C.onMove(a.touches[0].clientX,a.touches[0].clientY)})}},C.onMouseOrTouchStart=function(a){if(!C.props.disabled){var s=(0,b.isTouchEvent)(a);if(!(!s&&a.button!==0)){var c=C.getTargetIndex(a);c!==-1&&(s?C.addTouchEvents(a):C.addMouseEvents(a),C.setState({draggedThumbIndex:c,thumbZIndexes:C.state.thumbZIndexes.map(function(w,_){return _===c?Math.max.apply(Math,C.state.thumbZIndexes):w<=C.state.thumbZIndexes[c]?w:w-1})}))}}},C.onMouseMove=function(a){a.preventDefault(),C.onMove(a.clientX,a.clientY)},C.onTouchMove=function(a){a.preventDefault(),C.onMove(a.touches[0].clientX,a.touches[0].clientY)},C.onKeyDown=function(a){var s=C.props,c=s.values,w=s.onChange,_=s.step,M=s.rtl,l=s.direction,h=C.state.isChanged,S=C.getTargetIndex(a.nativeEvent),E=M||l===p.Direction.Left||l===p.Direction.Down?-1:1;S!==-1&&(y.includes(a.key)?(a.preventDefault(),C.setState({draggedThumbIndex:S,isChanged:!0}),w((0,b.replaceAt)(c,S,C.normalizeValue(c[S]+E*(a.key==="PageUp"?_*10:_),S)))):k.includes(a.key)?(a.preventDefault(),C.setState({draggedThumbIndex:S,isChanged:!0}),w((0,b.replaceAt)(c,S,C.normalizeValue(c[S]-E*(a.key==="PageDown"?_*10:_),S)))):a.key==="Tab"?C.setState({draggedThumbIndex:-1},function(){h&&C.fireOnFinalChange()}):h&&C.fireOnFinalChange())},C.onKeyUp=function(a){var s=C.state.isChanged;C.setState({draggedThumbIndex:-1},function(){s&&C.fireOnFinalChange()})},C.onMove=function(a,s){var c=C.state,w=c.draggedThumbIndex,_=c.draggedTrackPos,M=C.props,l=M.direction,h=M.min,S=M.max,E=M.onChange,F=M.values,D=M.step,L=M.rtl;if(w===-1&&_[0]===-1&&_[1]===-1)return null;var V=C.trackRef.current;if(!V)return null;var O=V.getBoundingClientRect(),W=(0,b.isVertical)(l)?O.height:O.width;if(_[0]!==-1&&_[1]!==-1){var H=a-_[0],q=s-_[1],U=0;switch(l){case p.Direction.Right:case p.Direction.Left:U=H/W*(S-h);break;case p.Direction.Down:case p.Direction.Up:U=q/W*(S-h);break;default:(0,b.assertUnreachable)(l)}if(L&&(U*=-1),Math.abs(U)>=D/2){for(var B=0;B<C.thumbRefs.length;B++){if(F[B]===S&&Math.sign(U)===1||F[B]===h&&Math.sign(U)===-1)return;var Y=F[B]+U;Y>S?U=S-F[B]:Y<h&&(U=h-F[B])}for(var X=F.slice(0),B=0;B<C.thumbRefs.length;B++)X=(0,b.replaceAt)(X,B,C.normalizeValue(F[B]+U,B));C.setState({draggedTrackPos:[a,s]}),E(X)}}else{var N=0;switch(l){case p.Direction.Right:N=(a-O.left)/W*(S-h)+h;break;case p.Direction.Left:N=(W-(a-O.left))/W*(S-h)+h;break;case p.Direction.Down:N=(s-O.top)/W*(S-h)+h;break;case p.Direction.Up:N=(W-(s-O.top))/W*(S-h)+h;break;default:(0,b.assertUnreachable)(l)}L&&(N=S+h-N),Math.abs(F[w]-N)>=D/2&&E((0,b.replaceAt)(F,w,C.normalizeValue(N,w)))}},C.normalizeValue=function(a,s){var c=C.props,w=c.min,_=c.max,M=c.step,l=c.allowOverlap,h=c.values;return(0,b.normalizeValue)(a,s,w,_,M,l,h)},C.onEnd=function(a){if(a.preventDefault(),document.removeEventListener("mousemove",C.schdOnMouseMove),document.removeEventListener("touchmove",C.schdOnTouchMove),document.removeEventListener("mouseup",C.schdOnEnd),document.removeEventListener("touchend",C.schdOnEnd),document.removeEventListener("touchcancel",C.schdOnEnd),C.state.draggedThumbIndex===-1&&C.state.draggedTrackPos[0]===-1&&C.state.draggedTrackPos[1]===-1)return null;C.setState({draggedThumbIndex:-1,draggedTrackPos:[-1,-1]},function(){C.fireOnFinalChange()})},C.fireOnFinalChange=function(){C.setState({isChanged:!1});var a=C.props,s=a.onFinalChange,c=a.values;s&&s(c)},C.updateMarkRefs=function(a){if(!a.renderMark){C.numOfMarks=void 0,C.markRefs=void 0;return}C.numOfMarks=(a.max-a.min)/C.props.step,C.markRefs=[];for(var s=0;s<C.numOfMarks+1;s++)C.markRefs[s]=x.createRef()},C.calculateMarkOffsets=function(){if(!(!C.props.renderMark||!C.trackRef||!C.numOfMarks||!C.markRefs||C.trackRef.current===null)){for(var a=window.getComputedStyle(C.trackRef.current),s=parseInt(a.width,10),c=parseInt(a.height,10),w=parseInt(a.paddingLeft,10),_=parseInt(a.paddingTop,10),M=[],l=0;l<C.numOfMarks+1;l++){var h=9999,S=9999;if(C.markRefs[l].current){var E=C.markRefs[l].current.getBoundingClientRect();h=E.height,S=E.width}C.props.direction===p.Direction.Left||C.props.direction===p.Direction.Right?M.push([Math.round(s/C.numOfMarks*l+w-S/2),-Math.round((h-c)/2)]):M.push([Math.round(c/C.numOfMarks*l+_-h/2),-Math.round((S-s)/2)])}C.setState({markOffsets:M})}},T.step===0)throw new Error('"step" property should be a positive number');return C.schdOnMouseMove=(0,b.schd)(C.onMouseMove),C.schdOnTouchMove=(0,b.schd)(C.onTouchMove),C.schdOnEnd=(0,b.schd)(C.onEnd),C.thumbRefs=T.values.map(function(){return x.createRef()}),C.updateMarkRefs(T),C}return P.prototype.componentDidMount=function(){var T=this,C=this.props,a=C.values,s=C.min,c=C.step;this.resizeObserver=window.ResizeObserver?new window.ResizeObserver(this.onResize):{observe:function(){return window.addEventListener("resize",T.onResize)},unobserve:function(){return window.removeEventListener("resize",T.onResize)}},document.addEventListener("touchstart",this.onMouseOrTouchStart,{passive:!1}),document.addEventListener("mousedown",this.onMouseOrTouchStart,{passive:!1}),!this.props.allowOverlap&&(0,b.checkInitialOverlap)(this.props.values),this.props.values.forEach(function(w){return(0,b.checkBoundaries)(w,T.props.min,T.props.max)}),this.resizeObserver.observe(this.trackRef.current),(0,b.translateThumbs)(this.getThumbs(),this.getOffsets(),this.props.rtl),this.calculateMarkOffsets(),a.forEach(function(w){(0,b.isStepDivisible)(s,w,c)||console.warn("The `values` property is in conflict with the current `step`, `min`, and `max` properties. Please provide values that are accessible using the min, max, and step values.")})},P.prototype.componentDidUpdate=function(T,C){var a=this.props,s=a.max,c=a.min,w=a.step,_=a.values,M=a.rtl;(T.max!==s||T.min!==c||T.step!==w)&&this.updateMarkRefs(this.props),(0,b.translateThumbs)(this.getThumbs(),this.getOffsets(),M),(T.max!==s||T.min!==c||T.step!==w||C.markOffsets.length!==this.state.markOffsets.length)&&(this.calculateMarkOffsets(),_.forEach(function(l){(0,b.isStepDivisible)(c,l,w)||console.warn("The `values` property is in conflict with the current `step`, `min`, and `max` properties. Please provide values that are accessible using the min, max, and step values.")}))},P.prototype.componentWillUnmount=function(){var T={passive:!1};document.removeEventListener("mousedown",this.onMouseOrTouchStart,T),document.removeEventListener("mousemove",this.schdOnMouseMove),document.removeEventListener("touchmove",this.schdOnTouchMove),document.removeEventListener("touchstart",this.onMouseOrTouchStart),document.removeEventListener("mouseup",this.schdOnEnd),document.removeEventListener("touchend",this.schdOnEnd),this.resizeObserver.unobserve(this.trackRef.current)},P.prototype.render=function(){var T=this,C=this.props,a=C.label,s=C.labelledBy,c=C.renderTrack,w=C.renderThumb,_=C.renderMark,M=_===void 0?function(){return null}:_,l=C.values,h=C.min,S=C.max,E=C.allowOverlap,F=C.disabled,D=this.state,L=D.draggedThumbIndex,V=D.thumbZIndexes,O=D.markOffsets;return c({props:{style:{transform:"scale(1)",cursor:L>-1?"grabbing":this.props.draggableTrack?(0,b.isVertical)(this.props.direction)?"ns-resize":"ew-resize":l.length===1&&!F?"pointer":"inherit"},onMouseDown:F?b.voidFn:this.onMouseDownTrack,onTouchStart:F?b.voidFn:this.onTouchStartTrack,ref:this.trackRef},isDragged:this.state.draggedThumbIndex>-1,disabled:F,children:v(v([],O.map(function(W,H,q){return M({props:{style:T.props.direction===p.Direction.Left||T.props.direction===p.Direction.Right?{position:"absolute",left:"".concat(W[0],"px"),marginTop:"".concat(W[1],"px")}:{position:"absolute",top:"".concat(W[0],"px"),marginLeft:"".concat(W[1],"px")},key:"mark".concat(H),ref:T.markRefs[H]},index:H})}),!0),l.map(function(W,H){var q=T.state.draggedThumbIndex===H;return w({index:H,value:W,isDragged:q,props:{style:{position:"absolute",zIndex:V[H],cursor:F?"inherit":q?"grabbing":"grab",userSelect:"none",touchAction:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},key:H,tabIndex:F?void 0:0,"aria-valuemax":E?S:l[H+1]||S,"aria-valuemin":E?h:l[H-1]||h,"aria-valuenow":W,draggable:!1,ref:T.thumbRefs[H],"aria-label":a,"aria-labelledby":s,role:"slider",onKeyDown:F?b.voidFn:T.onKeyDown,onKeyUp:F?b.voidFn:T.onKeyUp}})}),!0)})},P.defaultProps={label:"Accessibility label",labelledBy:null,step:1,direction:p.Direction.Right,rtl:!1,disabled:!1,allowOverlap:!1,draggableTrack:!1,min:0,max:100},P})(x.Component);return Range.default=g,Range}var hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,(function(n){var t=lib&&lib.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(n,"__esModule",{value:!0}),n.checkValuesAgainstBoundaries=n.relativeValue=n.useThumbOverlap=n.Direction=n.getTrackBackground=n.Range=void 0;var r=t(requireRange());n.Range=r.default;var u=requireUtils();Object.defineProperty(n,"getTrackBackground",{enumerable:!0,get:function(){return u.getTrackBackground}}),Object.defineProperty(n,"useThumbOverlap",{enumerable:!0,get:function(){return u.useThumbOverlap}}),Object.defineProperty(n,"relativeValue",{enumerable:!0,get:function(){return u.relativeValue}}),Object.defineProperty(n,"checkValuesAgainstBoundaries",{enumerable:!0,get:function(){return u.checkValuesAgainstBoundaries}});var v=requireTypes();Object.defineProperty(n,"Direction",{enumerable:!0,get:function(){return v.Direction}})})(lib)),lib}var libExports=requireLib();function RangeSlider({title:n,value:t,onChange:r,min:u,max:v}){return jsxRuntimeExports$1.jsxs("div",{className:"my-4",children:[jsxRuntimeExports$1.jsx("label",{className:"block font mb-1",children:n}),jsxRuntimeExports$1.jsx(libExports.Range,{step:1,min:u,max:v,values:t,onChange:r,renderTrack:({props:x,children:b})=>jsxRuntimeExports$1.jsxs("div",{...x,className:"w-full h-2 bg-gray-300 rounded relative",children:[jsxRuntimeExports$1.jsx("div",{className:"absolute h-2 bg-blue-500 rounded",style:{left:`${(t[0]-u)/(v-u)*100}%`,width:`${(t[1]-t[0])/(v-u)*100}%`}}),b]}),renderThumb:({props:x})=>jsxRuntimeExports$1.jsx("div",{...x,className:"w-5 h-5 bg-white border border-gray-500 rounded-full"})}),jsxRuntimeExports$1.jsxs("div",{className:"flex justify-between text-sm mt-1.5",children:[jsxRuntimeExports$1.jsx("span",{children:t[0]}),jsxRuntimeExports$1.jsx("span",{children:t[1]})]})]})}function buildQueryString(n,t,r,u,v){const x=[],b=[],p=[];for(const[y,k]of Object.entries(r))k===1&&b.push(y),k===2&&p.push(y);return p.length&&x.push(`NOT elements HAS ANY ${p.map(y=>`"${y}"`).join(", ")}`),b.length&&x.push(`elements HAS ALL ${b.map(y=>`"${y}"`).join(", ")}`),u[0]!==n[0]&&x.push(`nelements>=${u[0]}`),u[1]!==n[1]&&x.push(`nelements<=${u[1]}`),v[0]!==t[0]&&x.push(`nsites>=${v[0]}`),v[1]!==t[1]&&x.push(`nsites<=${v[1]}`),x.join(" AND ")}function OptimadeFilters({initialFilter:n,onSubmit:t}){const[r,u]=reactExports.useState([1,118]),[v,x]=reactExports.useState([1,1e3]),[b,p]=reactExports.useState({}),[y,k]=reactExports.useState(!1),[g,R]=reactExports.useState(n||""),P=buildQueryString([1,118],[1,1e3],b,r,v),T=y?g:P,C=()=>{t(T)},a=()=>{k(s=>!s),y||(R(P),p({}),u([1,118]),x([1,1e3]))};return reactExports.useEffect(()=>{n&&R(n)},[n]),jsxRuntimeExports$1.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports$1.jsxs("div",{className:y?"opacity-50 pointer-events-none":"",children:[jsxRuntimeExports$1.jsx(PTable,{selected:b,onSelectionChange:s=>p(c=>({...c,...s}))}),jsxRuntimeExports$1.jsx(RangeSlider,{title:"Number of atoms",value:r,onChange:u,min:1,max:118}),jsxRuntimeExports$1.jsx(RangeSlider,{title:"Number of sites",value:v,onChange:x,min:0,max:1e3})]}),jsxRuntimeExports$1.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports$1.jsx("input",{id:"manual-mode-toggle",type:"checkbox",checked:y,onChange:a,className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),jsxRuntimeExports$1.jsx("label",{htmlFor:"manual-mode-toggle",className:"text-sm text-gray-700 select-none",children:"Unlock custom query"})]}),jsxRuntimeExports$1.jsx("div",{className:"pb-4",children:jsxRuntimeExports$1.jsx(QueryTextBox,{value:T,onChange:y?R:()=>{},onSubmit:C,placeholder:"Enter OPTIMADE filter"})})]})}const isBoolean=n=>typeof n=="boolean"||n instanceof Boolean,isNumber=n=>typeof n=="number"||n instanceof Number,isBigInt=n=>typeof n=="bigint"||n instanceof BigInt,isDate=n=>!!n&&n instanceof Date,isString=n=>typeof n=="string"||n instanceof String,isArray=n=>Array.isArray(n),isObject$1=n=>typeof n=="object"&&n!==null,isFunction=n=>!!n&&n instanceof Object&&typeof n=="function";function quoteString(n,t){return t===void 0&&(t=!1),!n||t?`"${n}"`:n}function quoteStringValue(n,t,r){return r?JSON.stringify(n):t?`"${n}"`:n}function ExpandableObject(n){let{field:t,value:r,data:u,lastElement:v,openBracket:x,closeBracket:b,level:p,style:y,shouldExpandNode:k,clickToExpandNode:g,outerRef:R,beforeExpandChange:P}=n;const T=reactExports.useRef(!1),[C,a]=reactExports.useState(()=>k(p,r,t)),s=reactExports.useRef(null);reactExports.useEffect(()=>{T.current?a(k(p,r,t)):T.current=!0},[k]);const c=reactExports.useId();if(u.length===0)return EmptyObject({field:t,openBracket:x,closeBracket:b,lastElement:v,style:y});const w=C?y.collapseIcon:y.expandIcon,_=C?y.ariaLables.collapseJson:y.ariaLables.expandJson,M=p+1,l=u.length-1,h=F=>{C!==F&&(!P||P({level:p,value:r,field:t,newExpandValue:F}))&&a(F)},S=F=>{if(F.key==="ArrowRight"||F.key==="ArrowLeft")F.preventDefault(),h(F.key==="ArrowRight");else if(F.key==="ArrowUp"||F.key==="ArrowDown"){F.preventDefault();const D=F.key==="ArrowUp"?-1:1;if(!R.current)return;const L=R.current.querySelectorAll("[role=button]");let V=-1;for(let W=0;W<L.length;W++)if(L[W].tabIndex===0){V=W;break}if(V<0)return;const O=(V+D+L.length)%L.length;L[V].tabIndex=-1,L[O].tabIndex=0,L[O].focus()}},E=()=>{var F;h(!C);const D=s.current;if(!D)return;const L=(F=R.current)===null||F===void 0?void 0:F.querySelector('[role=button][tabindex="0"]');L&&(L.tabIndex=-1),D.tabIndex=0,D.focus()};return reactExports.createElement("div",{className:y.basicChildStyle,role:"treeitem","aria-expanded":C,"aria-selected":void 0},reactExports.createElement("span",{className:w,onClick:E,onKeyDown:S,role:"button","aria-label":_,"aria-expanded":C,"aria-controls":C?c:void 0,ref:s,tabIndex:p===0?0:-1}),(t||t==="")&&(g?reactExports.createElement("span",{className:y.clickableLabel,onClick:E,onKeyDown:S},quoteString(t,y.quotesForFieldNames),":"):reactExports.createElement("span",{className:y.label},quoteString(t,y.quotesForFieldNames),":")),reactExports.createElement("span",{className:y.punctuation},x),C?reactExports.createElement("ul",{id:c,role:"group",className:y.childFieldsContainer},u.map((F,D)=>reactExports.createElement(DataRender,{key:F[0]||D,field:F[0],value:F[1],style:y,lastElement:D===l,level:M,shouldExpandNode:k,clickToExpandNode:g,beforeExpandChange:P,outerRef:R}))):reactExports.createElement("span",{className:y.collapsedContent,onClick:E,onKeyDown:S}),reactExports.createElement("span",{className:y.punctuation},b),!v&&reactExports.createElement("span",{className:y.punctuation},","))}function EmptyObject(n){let{field:t,openBracket:r,closeBracket:u,lastElement:v,style:x}=n;return reactExports.createElement("div",{className:x.basicChildStyle,role:"treeitem","aria-selected":void 0},(t||t==="")&&reactExports.createElement("span",{className:x.label},quoteString(t,x.quotesForFieldNames),":"),reactExports.createElement("span",{className:x.punctuation},r),reactExports.createElement("span",{className:x.punctuation},u),!v&&reactExports.createElement("span",{className:x.punctuation},","))}function JsonObject(n){let{field:t,value:r,style:u,lastElement:v,shouldExpandNode:x,clickToExpandNode:b,level:p,outerRef:y,beforeExpandChange:k}=n;return ExpandableObject({field:t,value:r,lastElement:v||!1,level:p,openBracket:"{",closeBracket:"}",style:u,shouldExpandNode:x,clickToExpandNode:b,data:Object.keys(r).map(g=>[g,r[g]]),outerRef:y,beforeExpandChange:k})}function JsonArray(n){let{field:t,value:r,style:u,lastElement:v,level:x,shouldExpandNode:b,clickToExpandNode:p,outerRef:y,beforeExpandChange:k}=n;return ExpandableObject({field:t,value:r,lastElement:v||!1,level:x,openBracket:"[",closeBracket:"]",style:u,shouldExpandNode:b,clickToExpandNode:p,data:r.map(g=>[void 0,g]),outerRef:y,beforeExpandChange:k})}function JsonPrimitiveValue(n){let{field:t,value:r,style:u,lastElement:v}=n,x,b=u.otherValue;return r===null?(x="null",b=u.nullValue):r===void 0?(x="undefined",b=u.undefinedValue):isString(r)?(x=quoteStringValue(r,!u.noQuotesForStringValues,u.stringifyStringValues),b=u.stringValue):isBoolean(r)?(x=r?"true":"false",b=u.booleanValue):isNumber(r)?(x=r.toString(),b=u.numberValue):isBigInt(r)?(x=`${r.toString()}n`,b=u.numberValue):isDate(r)?x=r.toISOString():isFunction(r)?x="function() { }":x=r.toString(),reactExports.createElement("div",{className:u.basicChildStyle,role:"treeitem","aria-selected":void 0},(t||t==="")&&reactExports.createElement("span",{className:u.label},quoteString(t,u.quotesForFieldNames),":"),reactExports.createElement("span",{className:b},x),!v&&reactExports.createElement("span",{className:u.punctuation},","))}function DataRender(n){const t=n.value;return isArray(t)?reactExports.createElement(JsonArray,Object.assign({},n)):isObject$1(t)&&!isDate(t)&&!isFunction(t)?reactExports.createElement(JsonObject,Object.assign({},n)):reactExports.createElement(JsonPrimitiveValue,Object.assign({},n))}var styles={"container-light":"_2IvMF _GzYRV","basic-element-style":"_2bkNM","child-fields-container":"_1BXBN","label-light":"_1MGIk","clickable-label-light":"_2YKJg _1MGIk _1MFti","punctuation-light":"_3uHL6 _3eOF8","value-null-light":"_2T6PJ","value-undefined-light":"_1Gho6","value-string-light":"_vGjyY","value-number-light":"_1bQdo","value-boolean-light":"_3zQKs","value-other-light":"_1xvuR","collapse-icon-light":"_oLqym _f10Tu _1MFti _1LId0","expand-icon-light":"_2AXVT _f10Tu _1MFti _1UmXx","collapsed-content-light":"_2KJWg _1pNG9 _1MFti"};const defaultAriaLables={collapseJson:"collapse JSON",expandJson:"expand JSON"},defaultStyles={container:styles["container-light"],basicChildStyle:styles["basic-element-style"],childFieldsContainer:styles["child-fields-container"],label:styles["label-light"],clickableLabel:styles["clickable-label-light"],nullValue:styles["value-null-light"],undefinedValue:styles["value-undefined-light"],stringValue:styles["value-string-light"],booleanValue:styles["value-boolean-light"],numberValue:styles["value-number-light"],otherValue:styles["value-other-light"],punctuation:styles["punctuation-light"],collapseIcon:styles["collapse-icon-light"],expandIcon:styles["expand-icon-light"],collapsedContent:styles["collapsed-content-light"],noQuotesForStringValues:!1,quotesForFieldNames:!1,ariaLables:defaultAriaLables,stringifyStringValues:!1},allExpanded=()=>!0,JsonView=n=>{let{data:t,style:r=defaultStyles,shouldExpandNode:u=allExpanded,clickToExpandNode:v=!1,beforeExpandChange:x,compactTopLevel:b,...p}=n;const y=reactExports.useRef(null);return reactExports.createElement("div",Object.assign({"aria-label":"JSON view"},p,{className:r.container,ref:y,role:"tree"}),b&&isObject$1(t)?Object.entries(t).map(k=>{let[g,R]=k;return reactExports.createElement(DataRender,{key:g,field:g,value:R,style:{...defaultStyles,...r},lastElement:!0,level:1,shouldExpandNode:u,clickToExpandNode:v,beforeExpandChange:x,outerRef:y})}):reactExports.createElement(DataRender,{value:t,style:{...defaultStyles,...r},lastElement:!0,level:0,shouldExpandNode:u,clickToExpandNode:v,outerRef:y,beforeExpandChange:x}))};var classnames={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var hasRequiredClassnames;function requireClassnames(){return hasRequiredClassnames||(hasRequiredClassnames=1,(function(n){(function(){var t={}.hasOwnProperty;function r(){for(var x="",b=0;b<arguments.length;b++){var p=arguments[b];p&&(x=v(x,u(p)))}return x}function u(x){if(typeof x=="string"||typeof x=="number")return x;if(typeof x!="object")return"";if(Array.isArray(x))return r.apply(null,x);if(x.toString!==Object.prototype.toString&&!x.toString.toString().includes("[native code]"))return x.toString();var b="";for(var p in x)t.call(x,p)&&x[p]&&(b=v(b,p));return b}function v(x,b){return b?x?x+" "+b:x+b:x}n.exports?(r.default=r,n.exports=r):window.classNames=r})()})(classnames)),classnames.exports}var classnamesExports=requireClassnames();const classNames=getDefaultExportFromCjs(classnamesExports),DEFAULT_BREAKPOINTS=["xxl","xl","lg","md","sm","xs"],DEFAULT_MIN_BREAKPOINT="xs",ThemeContext=reactExports.createContext({prefixes:{},breakpoints:DEFAULT_BREAKPOINTS,minBreakpoint:DEFAULT_MIN_BREAKPOINT}),{Consumer,Provider}=ThemeContext;function useBootstrapPrefix(n,t){const{prefixes:r}=reactExports.useContext(ThemeContext);return n||r[t]||t}function useBootstrapBreakpoints(){const{breakpoints:n}=reactExports.useContext(ThemeContext);return n}function useBootstrapMinBreakpoint(){const{minBreakpoint:n}=reactExports.useContext(ThemeContext);return n}var propTypes$2={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=n,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var n=requireReactPropTypesSecret();function t(){}function r(){}return r.resetWarningCache=t,factoryWithThrowingShims=function(){function u(b,p,y,k,g,R){if(R!==n){var P=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw P.name="Invariant Violation",P}}u.isRequired=u;function v(){return u}var x={array:u,bigint:u,bool:u,func:u,number:u,object:u,string:u,symbol:u,any:u,arrayOf:v,element:u,elementType:u,instanceOf:v,node:u,objectOf:v,oneOf:v,oneOfType:v,shape:v,exact:v,checkPropTypes:r,resetWarningCache:t};return x.PropTypes=x,x},factoryWithThrowingShims}var hasRequiredPropTypes;function requirePropTypes(){return hasRequiredPropTypes||(hasRequiredPropTypes=1,propTypes$2.exports=requireFactoryWithThrowingShims()()),propTypes$2.exports}var propTypesExports=requirePropTypes();const PropTypes=getDefaultExportFromCjs(propTypesExports),_excluded=["as","disabled"];function _objectWithoutPropertiesLoose(n,t){if(n==null)return{};var r={};for(var u in n)if({}.hasOwnProperty.call(n,u)){if(t.indexOf(u)>=0)continue;r[u]=n[u]}return r}function isTrivialHref(n){return!n||n.trim()==="#"}function useButtonProps({tagName:n,disabled:t,href:r,target:u,rel:v,role:x,onClick:b,tabIndex:p=0,type:y}){n||(r!=null||u!=null||v!=null?n="a":n="button");const k={tagName:n};if(n==="button")return[{type:y||"button",disabled:t},k];const g=P=>{if((t||n==="a"&&isTrivialHref(r))&&P.preventDefault(),t){P.stopPropagation();return}b?.(P)},R=P=>{P.key===" "&&(P.preventDefault(),g(P))};return n==="a"&&(r||(r="#"),t&&(r=void 0)),[{role:x??"button",disabled:void 0,tabIndex:t?void 0:p,href:r,target:n==="a"?u:void 0,"aria-disabled":t||void 0,rel:n==="a"?v:void 0,onClick:g,onKeyDown:R},k]}const Button$1=reactExports.forwardRef((n,t)=>{let{as:r,disabled:u}=n,v=_objectWithoutPropertiesLoose(n,_excluded);const[x,{tagName:b}]=useButtonProps(Object.assign({tagName:r,disabled:u},v));return jsxRuntimeExports$1.jsx(b,Object.assign({},v,x,{ref:t}))});Button$1.displayName="Button";const Button=reactExports.forwardRef(({as:n,bsPrefix:t,variant:r="primary",size:u,active:v=!1,disabled:x=!1,className:b,...p},y)=>{const k=useBootstrapPrefix(t,"btn"),[g,{tagName:R}]=useButtonProps({tagName:n,disabled:x,...p}),P=R;return jsxRuntimeExports$1.jsx(P,{...g,...p,ref:y,disabled:x,className:classNames(b,k,v&&"active",r&&`${k}-${r}`,u&&`${k}-${u}`,p.href&&x&&"disabled")})});Button.displayName="Button";function hasChildOfType(n,t){return reactExports.Children.toArray(n).some(r=>reactExports.isValidElement(r)&&r.type===t)}function useCol({as:n,bsPrefix:t,className:r,...u}){t=useBootstrapPrefix(t,"col");const v=useBootstrapBreakpoints(),x=useBootstrapMinBreakpoint(),b=[],p=[];return v.forEach(y=>{const k=u[y];delete u[y];let g,R,P;typeof k=="object"&&k!=null?{span:g,offset:R,order:P}=k:g=k;const T=y!==x?`-${y}`:"";g&&b.push(g===!0?`${t}${T}`:`${t}${T}-${g}`),P!=null&&p.push(`order${T}-${P}`),R!=null&&p.push(`offset${T}-${R}`)}),[{...u,className:classNames(r,...b,...p)},{as:n,bsPrefix:t,spans:b}]}const Col=reactExports.forwardRef((n,t)=>{const[{className:r,...u},{as:v="div",bsPrefix:x,spans:b}]=useCol(n);return jsxRuntimeExports$1.jsx(v,{...u,ref:t,className:classNames(r,!b.length&&x)})});Col.displayName="Col";const propTypes$1={type:PropTypes.string,tooltip:PropTypes.bool,as:PropTypes.elementType},Feedback=reactExports.forwardRef(({as:n="div",className:t,type:r="valid",tooltip:u=!1,...v},x)=>jsxRuntimeExports$1.jsx(n,{...v,ref:x,className:classNames(t,`${r}-${u?"tooltip":"feedback"}`)}));Feedback.displayName="Feedback";Feedback.propTypes=propTypes$1;const FormContext=reactExports.createContext({}),FormCheckInput=reactExports.forwardRef(({id:n,bsPrefix:t,className:r,type:u="checkbox",isValid:v=!1,isInvalid:x=!1,as:b="input",...p},y)=>{const{controlId:k}=reactExports.useContext(FormContext);return t=useBootstrapPrefix(t,"form-check-input"),jsxRuntimeExports$1.jsx(b,{...p,ref:y,type:u,id:n||k,className:classNames(r,t,v&&"is-valid",x&&"is-invalid")})});FormCheckInput.displayName="FormCheckInput";const FormCheckLabel=reactExports.forwardRef(({bsPrefix:n,className:t,htmlFor:r,...u},v)=>{const{controlId:x}=reactExports.useContext(FormContext);return n=useBootstrapPrefix(n,"form-check-label"),jsxRuntimeExports$1.jsx("label",{...u,ref:v,htmlFor:r||x,className:classNames(t,n)})});FormCheckLabel.displayName="FormCheckLabel";const FormCheck=reactExports.forwardRef(({id:n,bsPrefix:t,bsSwitchPrefix:r,inline:u=!1,reverse:v=!1,disabled:x=!1,isValid:b=!1,isInvalid:p=!1,feedbackTooltip:y=!1,feedback:k,feedbackType:g,className:R,style:P,title:T="",type:C="checkbox",label:a,children:s,as:c="input",...w},_)=>{t=useBootstrapPrefix(t,"form-check"),r=useBootstrapPrefix(r,"form-switch");const{controlId:M}=reactExports.useContext(FormContext),l=reactExports.useMemo(()=>({controlId:n||M}),[M,n]),h=!s&&a!=null&&a!==!1||hasChildOfType(s,FormCheckLabel),S=jsxRuntimeExports$1.jsx(FormCheckInput,{...w,type:C==="switch"?"checkbox":C,ref:_,isValid:b,isInvalid:p,disabled:x,as:c});return jsxRuntimeExports$1.jsx(FormContext.Provider,{value:l,children:jsxRuntimeExports$1.jsx("div",{style:P,className:classNames(R,h&&t,u&&`${t}-inline`,v&&`${t}-reverse`,C==="switch"&&r),children:s||jsxRuntimeExports$1.jsxs(jsxRuntimeExports$1.Fragment,{children:[S,h&&jsxRuntimeExports$1.jsx(FormCheckLabel,{title:T,children:a}),k&&jsxRuntimeExports$1.jsx(Feedback,{type:g,tooltip:y,children:k})]})})})});FormCheck.displayName="FormCheck";const FormCheck$1=Object.assign(FormCheck,{Input:FormCheckInput,Label:FormCheckLabel}),FormControl=reactExports.forwardRef(({bsPrefix:n,type:t,size:r,htmlSize:u,id:v,className:x,isValid:b=!1,isInvalid:p=!1,plaintext:y,readOnly:k,as:g="input",...R},P)=>{const{controlId:T}=reactExports.useContext(FormContext);return n=useBootstrapPrefix(n,"form-control"),jsxRuntimeExports$1.jsx(g,{...R,type:t,size:u,ref:P,readOnly:k,id:v||T,className:classNames(x,y?`${n}-plaintext`:n,r&&`${n}-${r}`,t==="color"&&`${n}-color`,b&&"is-valid",p&&"is-invalid")})});FormControl.displayName="FormControl";const FormControl$1=Object.assign(FormControl,{Feedback}),FormFloating=reactExports.forwardRef(({className:n,bsPrefix:t,as:r="div",...u},v)=>(t=useBootstrapPrefix(t,"form-floating"),jsxRuntimeExports$1.jsx(r,{ref:v,className:classNames(n,t),...u})));FormFloating.displayName="FormFloating";const FormGroup=reactExports.forwardRef(({controlId:n,as:t="div",...r},u)=>{const v=reactExports.useMemo(()=>({controlId:n}),[n]);return jsxRuntimeExports$1.jsx(FormContext.Provider,{value:v,children:jsxRuntimeExports$1.jsx(t,{...r,ref:u})})});FormGroup.displayName="FormGroup";const FormLabel=reactExports.forwardRef(({as:n="label",bsPrefix:t,column:r=!1,visuallyHidden:u=!1,className:v,htmlFor:x,...b},p)=>{const{controlId:y}=reactExports.useContext(FormContext);t=useBootstrapPrefix(t,"form-label");let k="col-form-label";typeof r=="string"&&(k=`${k} ${k}-${r}`);const g=classNames(v,t,u&&"visually-hidden",r&&k);return x=x||y,r?jsxRuntimeExports$1.jsx(Col,{ref:p,as:"label",className:g,htmlFor:x,...b}):jsxRuntimeExports$1.jsx(n,{ref:p,className:g,htmlFor:x,...b})});FormLabel.displayName="FormLabel";const FormRange=reactExports.forwardRef(({bsPrefix:n,className:t,id:r,...u},v)=>{const{controlId:x}=reactExports.useContext(FormContext);return n=useBootstrapPrefix(n,"form-range"),jsxRuntimeExports$1.jsx("input",{...u,type:"range",ref:v,className:classNames(t,n),id:r||x})});FormRange.displayName="FormRange";const FormSelect=reactExports.forwardRef(({bsPrefix:n,size:t,htmlSize:r,className:u,isValid:v=!1,isInvalid:x=!1,id:b,...p},y)=>{const{controlId:k}=reactExports.useContext(FormContext);return n=useBootstrapPrefix(n,"form-select"),jsxRuntimeExports$1.jsx("select",{...p,size:r,ref:y,className:classNames(u,n,t&&`${n}-${t}`,v&&"is-valid",x&&"is-invalid"),id:b||k})});FormSelect.displayName="FormSelect";const FormText=reactExports.forwardRef(({bsPrefix:n,className:t,as:r="small",muted:u,...v},x)=>(n=useBootstrapPrefix(n,"form-text"),jsxRuntimeExports$1.jsx(r,{...v,ref:x,className:classNames(t,n,u&&"text-muted")})));FormText.displayName="FormText";const Switch=reactExports.forwardRef((n,t)=>jsxRuntimeExports$1.jsx(FormCheck$1,{...n,ref:t,type:"switch"}));Switch.displayName="Switch";const Switch$1=Object.assign(Switch,{Input:FormCheck$1.Input,Label:FormCheck$1.Label}),FloatingLabel=reactExports.forwardRef(({bsPrefix:n,className:t,children:r,controlId:u,label:v,...x},b)=>(n=useBootstrapPrefix(n,"form-floating"),jsxRuntimeExports$1.jsxs(FormGroup,{ref:b,className:classNames(t,n),controlId:u,...x,children:[r,jsxRuntimeExports$1.jsx("label",{htmlFor:u,children:v})]})));FloatingLabel.displayName="FloatingLabel";const propTypes={_ref:PropTypes.any,validated:PropTypes.bool,as:PropTypes.elementType},Form=reactExports.forwardRef(({className:n,validated:t,as:r="form",...u},v)=>jsxRuntimeExports$1.jsx(r,{...u,ref:v,className:classNames(n,t&&"was-validated")}));Form.displayName="Form";Form.propTypes=propTypes;const Form$1=Object.assign(Form,{Group:FormGroup,Control:FormControl$1,Floating:FormFloating,Check:FormCheck$1,Switch:Switch$1,Label:FormLabel,Text:FormText,Range:FormRange,Select:FormSelect,FloatingLabel});var Zs=Object.defineProperty,Ys=(n,t,r)=>t in n?Zs(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ci=(n,t,r)=>(Ys(n,typeof t!="symbol"?t+"":t,r),r),commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},jsxRuntime={exports:{}},reactJsxRuntime_production_min={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var n=React,t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,v=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x={key:!0,ref:!0,__self:!0,__source:!0};function b(p,y,k){var g,R={},P=null,T=null;k!==void 0&&(P=""+k),y.key!==void 0&&(P=""+y.key),y.ref!==void 0&&(T=y.ref);for(g in y)u.call(y,g)&&!x.hasOwnProperty(g)&&(R[g]=y[g]);if(p&&p.defaultProps)for(g in y=p.defaultProps,y)R[g]===void 0&&(R[g]=y[g]);return{$$typeof:t,type:p,key:P,ref:T,props:R,_owner:v.current}}return reactJsxRuntime_production_min.Fragment=r,reactJsxRuntime_production_min.jsx=b,reactJsxRuntime_production_min.jsxs=b,reactJsxRuntime_production_min}jsxRuntime.exports=requireReactJsxRuntime_production_min();var jsxRuntimeExports=jsxRuntime.exports;class ControlBox extends React.Component{constructor(){super(...arguments),Ci(this,"handleSupercellChange",(t,r)=>{let u=this.props.viewerParams.supercell;u[t]=parseInt(r),this.props.onViewerParamChange("supercell",u)}),Ci(this,"handleOptionChange",t=>{this.props.onViewerParamChange(t,!this.props.viewerParams[t])}),Ci(this,"handleCameraEvent",t=>{this.props.onViewerEvent("camera",t)})}render(){return jsxRuntimeExports.jsxs("div",{className:"control-box",children:[jsxRuntimeExports.jsxs("div",{className:"control-box-row",children:[jsxRuntimeExports.jsxs("div",{className:"supercell-container",children:[jsxRuntimeExports.jsx(Form$1.Label,{children:"Supercell: "}),jsxRuntimeExports.jsx("div",{style:{display:"flex"},children:[0,1,2].map(t=>jsxRuntimeExports.jsx(Form$1.Control,{className:"supercell-input",type:"number",min:"1",max:"99",value:this.props.viewerParams.supercell[t],onChange:r=>this.handleSupercellChange(t,r.target.value)},t))})]}),jsxRuntimeExports.jsxs("div",{className:"camera-controls",children:[jsxRuntimeExports.jsx(Form$1.Label,{children:"Camera: "}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("x"),children:"x"}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("y"),children:"y"}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("z"),children:"z"})]})]}),jsxRuntimeExports.jsxs("div",{className:"control-box-row",style:{display:"flex"},children:[jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.bonds,onChange:()=>this.handleOptionChange("bonds"),label:"Bonds"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.packedCell,onChange:()=>this.handleOptionChange("packedCell"),label:"Packed cell"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.atomLabels,onChange:()=>this.handleOptionChange("atomLabels"),label:"Atom labels"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.spaceFilling,onChange:()=>this.handleOptionChange("vdwRadius"),label:"vdW radius"})]})]})}}var _3Dmol={exports:{}};/*!
 * 3dmol v2.3.0
 * JavaScript/TypeScript molecular visualization library
 * Author: David Koes and contributors
 */(function(module,exports){(function(n,t){module.exports=t()})(commonjsGlobal,()=>(()=>{var __webpack_modules__={"./node_modules/iobuffer/lib-esm/IOBuffer.js":((n,t,r)=>{r.r(t),r.d(t,{IOBuffer:()=>p});var u=r("./node_modules/iobuffer/lib-esm/text.browser.js");const v=1024*8,x=(()=>{const y=new Uint8Array(4),k=new Uint32Array(y.buffer);return!((k[0]=1)&y[0])})(),b={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class p{constructor(k=v,g={}){let R=!1;typeof k=="number"?k=new ArrayBuffer(k):(R=!0,this.lastWrittenByte=k.byteLength);const P=g.offset?g.offset>>>0:0,T=k.byteLength-P;let C=P;(ArrayBuffer.isView(k)||k instanceof p)&&(k.byteLength!==k.buffer.byteLength&&(C=k.byteOffset+P),k=k.buffer),R?this.lastWrittenByte=T:this.lastWrittenByte=0,this.buffer=k,this.length=T,this.byteLength=T,this.byteOffset=C,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,C,T),this._mark=0,this._marks=[]}available(k=1){return this.offset+k<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(k=1){return this.offset+=k,this}back(k=1){return this.offset-=k,this}seek(k){return this.offset=k,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const k=this._marks.pop();if(k===void 0)throw new Error("Mark stack empty");return this.seek(k),this}rewind(){return this.offset=0,this}ensureAvailable(k=1){if(!this.available(k)){const g=(this.offset+k)*2,R=new Uint8Array(g);R.set(new Uint8Array(this.buffer)),this.buffer=R.buffer,this.length=this.byteLength=g,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(k=1){return this.readArray(k,"uint8")}readArray(k,g){const R=b[g].BYTES_PER_ELEMENT*k,P=this.byteOffset+this.offset,T=this.buffer.slice(P,P+R);if(this.littleEndian===x&&g!=="uint8"&&g!=="int8"){const a=new Uint8Array(this.buffer.slice(P,P+R));a.reverse();const s=new b[g](a.buffer);return this.offset+=R,s.reverse(),s}const C=new b[g](T);return this.offset+=R,C}readInt16(){const k=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,k}readUint16(){const k=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,k}readInt32(){const k=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,k}readUint32(){const k=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,k}readFloat32(){const k=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,k}readFloat64(){const k=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,k}readBigInt64(){const k=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,k}readBigUint64(){const k=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,k}readChar(){return String.fromCharCode(this.readInt8())}readChars(k=1){let g="";for(let R=0;R<k;R++)g+=this.readChar();return g}readUtf8(k=1){return(0,u.decode)(this.readBytes(k))}decodeText(k=1,g="utf-8"){return(0,u.decode)(this.readBytes(k),g)}writeBoolean(k){return this.writeUint8(k?255:0),this}writeInt8(k){return this.ensureAvailable(1),this._data.setInt8(this.offset++,k),this._updateLastWrittenByte(),this}writeUint8(k){return this.ensureAvailable(1),this._data.setUint8(this.offset++,k),this._updateLastWrittenByte(),this}writeByte(k){return this.writeUint8(k)}writeBytes(k){this.ensureAvailable(k.length);for(let g=0;g<k.length;g++)this._data.setUint8(this.offset++,k[g]);return this._updateLastWrittenByte(),this}writeInt16(k){return this.ensureAvailable(2),this._data.setInt16(this.offset,k,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(k){return this.ensureAvailable(2),this._data.setUint16(this.offset,k,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(k){return this.ensureAvailable(4),this._data.setInt32(this.offset,k,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(k){return this.ensureAvailable(4),this._data.setUint32(this.offset,k,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(k){return this.ensureAvailable(4),this._data.setFloat32(this.offset,k,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(k){return this.ensureAvailable(8),this._data.setFloat64(this.offset,k,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(k){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,k,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(k){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,k,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(k){return this.writeUint8(k.charCodeAt(0))}writeChars(k){for(let g=0;g<k.length;g++)this.writeUint8(k.charCodeAt(g));return this}writeUtf8(k){return this.writeBytes((0,u.encode)(k))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}}),"./node_modules/iobuffer/lib-esm/text-encoding-polyfill.js":(function(){(function(n){if(n.TextEncoder&&n.TextDecoder)return!1;function t(u="utf-8"){if(u!=="utf-8")throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${u}') is invalid.`)}Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),t.prototype.encode=function(u,v={stream:!1}){if(v.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let x=0;const b=u.length;let p=0,y=Math.max(32,b+(b>>1)+7),k=new Uint8Array(y>>3<<3);for(;x<b;){let g=u.charCodeAt(x++);if(g>=55296&&g<=56319){if(x<b){const R=u.charCodeAt(x);(R&64512)===56320&&(++x,g=((g&1023)<<10)+(R&1023)+65536)}if(g>=55296&&g<=56319)continue}if(p+4>k.length){y+=8,y*=1+x/u.length*2,y=y>>3<<3;const R=new Uint8Array(y);R.set(k),k=R}if(g&4294967168)if(!(g&4294965248))k[p++]=g>>6&31|192;else if(!(g&4294901760))k[p++]=g>>12&15|224,k[p++]=g>>6&63|128;else if(!(g&4292870144))k[p++]=g>>18&7|240,k[p++]=g>>12&63|128,k[p++]=g>>6&63|128;else continue;else{k[p++]=g;continue}k[p++]=g&63|128}return k.slice(0,p)};function r(u="utf-8",v={fatal:!1}){if(u!=="utf-8")throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${u}') is invalid.`);if(v.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(r.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(r.prototype,"fatal",{value:!1}),Object.defineProperty(r.prototype,"ignoreBOM",{value:!1}),r.prototype.decode=function(u,v={stream:!1}){if(v.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const x=new Uint8Array(u);let b=0;const p=x.length,y=[];for(;b<p;){const k=x[b++];if(k===0)break;if(!(k&128))y.push(k);else if((k&224)===192){const g=x[b++]&63;y.push((k&31)<<6|g)}else if((k&240)===224){const g=x[b++]&63,R=x[b++]&63;y.push((k&31)<<12|g<<6|R)}else if((k&248)===240){const g=x[b++]&63,R=x[b++]&63,P=x[b++]&63;let T=(k&7)<<18|g<<12|R<<6|P;T>65535&&(T-=65536,y.push(T>>>10&1023|55296),T=56320|T&1023),y.push(T)}}return String.fromCharCode.apply(null,y)},n.TextEncoder=t,n.TextDecoder=r})(typeof window<"u"?window:typeof self<"u"?self:this)}),"./node_modules/iobuffer/lib-esm/text.browser.js":((n,t,r)=>{r.r(t),r.d(t,{decode:()=>u,encode:()=>x}),r("./node_modules/iobuffer/lib-esm/text-encoding-polyfill.js");function u(b,p="utf8"){return new TextDecoder(p).decode(b)}const v=new TextEncoder;function x(b){return v.encode(b)}}),"./node_modules/netcdfjs/lib-esm/data.js":((n,t,r)=>{r.r(t),r.d(t,{nonRecord:()=>v,record:()=>x});var u=r("./node_modules/netcdfjs/lib-esm/types.js");function v(b,p){const y=(0,u.str2num)(p.type),k=p.size/(0,u.num2bytes)(y),g=new Array(k);for(let R=0;R<k;R++)g[R]=(0,u.readType)(b,y,1);return g}function x(b,p,y){const k=(0,u.str2num)(p.type),g=p.size?p.size/(0,u.num2bytes)(k):1,R=y.length,P=new Array(R),T=y.recordStep;if(T)for(let C=0;C<R;C++){const a=b.offset;P[C]=(0,u.readType)(b,k,g),b.seek(a+T)}else throw new Error("recordDimension.recordStep is undefined");return P}}),"./node_modules/netcdfjs/lib-esm/header.js":((n,t,r)=>{r.r(t),r.d(t,{header:()=>g});var u=r("./node_modules/netcdfjs/lib-esm/types.js"),v=r("./node_modules/netcdfjs/lib-esm/utils.js");const x=0,b=10,p=11,y=12,k=0;function g(C,a){const s={version:a},c={length:C.readUint32()},w=R(C);Array.isArray(w)||(c.id=w.recordId,c.name=w.recordName,s.dimensions=w.dimensions),s.globalAttributes=P(C);const _=T(C,c?.id,a);return Array.isArray(_)||(s.variables=_.variables,c.recordStep=_.recordStep),s.recordDimension=c,s}function R(C){const a={};let s,c;const w=C.readUint32();let _;if(w===x)return(0,v.notNetcdf)(C.readUint32()!==x,"wrong empty tag for list of dimensions"),[];{(0,v.notNetcdf)(w!==b,"wrong tag for list of dimensions");const M=C.readUint32();_=new Array(M);for(let l=0;l<M;l++){const h=(0,v.readName)(C),S=C.readUint32();S===k&&(s=l,c=h),_[l]={name:h,size:S}}}return s!==void 0&&(a.recordId=s),c!==void 0&&(a.recordName=c),a.dimensions=_,a}function P(C){const a=C.readUint32();let s;if(a===x)return(0,v.notNetcdf)(C.readUint32()!==x,"wrong empty tag for list of attributes"),[];{(0,v.notNetcdf)(a!==y,"wrong tag for list of attributes");const c=C.readUint32();s=new Array(c);for(let w=0;w<c;w++){const _=(0,v.readName)(C),M=C.readUint32();(0,v.notNetcdf)(M<1||M>6,`non valid type ${M}`);const l=C.readUint32(),h=(0,u.readType)(C,M,l);(0,v.padding)(C),s[w]={name:_,type:(0,u.num2str)(M),value:h}}}return s}function T(C,a,s){const c=C.readUint32();let w=0,_;if(c===x)return(0,v.notNetcdf)(C.readUint32()!==x,"wrong empty tag for list of variables"),[];{(0,v.notNetcdf)(c!==p,"wrong tag for list of variables");const M=C.readUint32();_=new Array(M);for(let l=0;l<M;l++){const h=(0,v.readName)(C),S=C.readUint32(),E=new Array(S);for(let W=0;W<S;W++)E[W]=C.readUint32();const F=P(C),D=C.readUint32();(0,v.notNetcdf)(D<1&&D>6,`non valid type ${D}`);const L=C.readUint32();let V=C.readUint32();s===2&&((0,v.notNetcdf)(V>0,"offsets larger than 4GB not supported"),V=C.readUint32());let O=!1;typeof a<"u"&&E[0]===a&&(w+=L,O=!0),_[l]={name:h,dimensions:E,attributes:F,type:(0,u.num2str)(D),size:L,offset:V,record:O}}}return{variables:_,recordStep:w}}}),"./node_modules/netcdfjs/lib-esm/index.js":((n,t,r)=>{r.r(t),r.d(t,{NetCDFReader:()=>u.NetCDFReader});var u=r("./node_modules/netcdfjs/lib-esm/parser.js")}),"./node_modules/netcdfjs/lib-esm/parser.js":((n,t,r)=>{r.r(t),r.d(t,{NetCDFReader:()=>y});var u=r("./node_modules/iobuffer/lib-esm/IOBuffer.js"),v=r("./node_modules/netcdfjs/lib-esm/data.js"),x=r("./node_modules/netcdfjs/lib-esm/header.js"),b=r("./node_modules/netcdfjs/lib-esm/toString.js"),p=r("./node_modules/netcdfjs/lib-esm/utils.js");class y{constructor(g){this.toString=b.toString;const R=new u.IOBuffer(g);R.setBigEndian(),(0,p.notNetcdf)(R.readChars(3)!=="CDF","should start with CDF");const P=R.readByte();(0,p.notNetcdf)(P>2,"unknown version"),this.header=(0,x.header)(R,P),this.buffer=R}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(g){const R=this.globalAttributes.find(P=>P.name===g);return R?R.value:null}getDataVariableAsString(g){const R=this.getDataVariable(g);return R?R.join(""):null}get variables(){return this.header.variables}getDataVariable(g){let R;if(typeof g=="string"?R=this.header.variables.find(P=>P.name===g):R=g,R===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(R.offset),R.record?(0,v.record)(this.buffer,R,this.header.recordDimension):(0,v.nonRecord)(this.buffer,R)}dataVariableExists(g){return this.header.variables.find(R=>R.name===g)!==void 0}attributeExists(g){return this.globalAttributes.find(R=>R.name===g)!==void 0}}}),"./node_modules/netcdfjs/lib-esm/toString.js":((n,t,r)=>{r.r(t),r.d(t,{toString:()=>u});function u(){const v=[];v.push("DIMENSIONS");for(const b of this.dimensions)v.push(`  ${b.name.padEnd(30)} = size: ${b.size}`);v.push(""),v.push("GLOBAL ATTRIBUTES");for(const b of this.globalAttributes)v.push(`  ${b.name.padEnd(30)} = ${b.value}`);const x=JSON.parse(JSON.stringify(this.variables));v.push(""),v.push("VARIABLES:");for(const b of x){b.value=this.getDataVariable(b);let p=JSON.stringify(b.value);p.length>50&&(p=p.substring(0,50)),isNaN(b.value.length)||(p+=` (length: ${b.value.length})`),v.push(`  ${b.name.padEnd(30)} = ${p}`)}return v.join(`
`)}}),"./node_modules/netcdfjs/lib-esm/types.js":((n,t,r)=>{r.r(t),r.d(t,{num2bytes:()=>x,num2str:()=>v,readType:()=>y,str2num:()=>b});const u={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function v(g){switch(Number(g)){case u.BYTE:return"byte";case u.CHAR:return"char";case u.SHORT:return"short";case u.INT:return"int";case u.FLOAT:return"float";case u.DOUBLE:return"double";default:return"undefined"}}function x(g){switch(Number(g)){case u.BYTE:return 1;case u.CHAR:return 1;case u.SHORT:return 2;case u.INT:return 4;case u.FLOAT:return 4;case u.DOUBLE:return 8;default:return-1}}function b(g){switch(String(g)){case"byte":return u.BYTE;case"char":return u.CHAR;case"short":return u.SHORT;case"int":return u.INT;case"float":return u.FLOAT;case"double":return u.DOUBLE;default:return-1}}function p(g,R){if(g!==1){const P=new Array(g);for(let T=0;T<g;T++)P[T]=R();return P}else return R()}function y(g,R,P){switch(R){case u.BYTE:return Array.from(g.readBytes(P));case u.CHAR:return k(g.readChars(P));case u.SHORT:return p(P,g.readInt16.bind(g));case u.INT:return p(P,g.readInt32.bind(g));case u.FLOAT:return p(P,g.readFloat32.bind(g));case u.DOUBLE:return p(P,g.readFloat64.bind(g));default:throw new Error(`non valid type ${R}`)}}function k(g){return g.charCodeAt(g.length-1)===0?g.substring(0,g.length-1):g}}),"./node_modules/netcdfjs/lib-esm/utils.js":((n,t,r)=>{r.r(t),r.d(t,{notNetcdf:()=>u,padding:()=>v,readName:()=>x});function u(b,p){if(b)throw new TypeError(`Not a valid NetCDF v3.x file: ${p}`)}function v(b){b.offset%4!==0&&b.skip(4-b.offset%4)}function x(b){const p=b.readUint32(),y=b.readChars(p);return v(b),y}}),"./src/WebGL/shaders/lib/basic/basic.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;
    float fogFactor = smoothstep( fogNear, fogFar, depth );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
}`}),"./src/WebGL/shaders/lib/basic/basic.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`}),"./src/WebGL/shaders/lib/blur/blur.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`}),"./src/WebGL/shaders/lib/blur/blur.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/instanced/instanced.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`}),"./src/WebGL/shaders/lib/instanced/instanced.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`}),"./src/WebGL/shaders/lib/lambert/lambert.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}`}),"./src/WebGL/shaders/lib/lambert/lambert.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`}),"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`}),"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`}),"./src/WebGL/shaders/lib/outline/outline.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );
}


`}),"./src/WebGL/shaders/lib/outline/outline.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    gl_Position = projectionMatrix * mvPosition;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`}),"./src/WebGL/shaders/lib/screen/screen.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `}),"./src/WebGL/shaders/lib/screen/screen.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/screenaa/screenaa.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec3 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP).xyz;
    vec3 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP).xyz;
    vec3 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP).xyz;
    vec3 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP).xyz;
    vec3 rgbM  = texture2D(tex, fragCoord  * inverseVP).xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)).xyz +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5).xyz +
        texture2D(tex, fragCoord  + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, 1.0);
    else
        color = vec4(rgbB, 1.0);
    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        `}),"./src/WebGL/shaders/lib/screenaa/screenaa.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    float fogFactor = smoothstep( fogNear, fogFar, gl_FragDepthEXT/gl_FragCoord.w );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );


}

`}),"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`}),"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );
}


`}),"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);
    vec4 adjust = projectionMatrix* vec4(norm,normal.z,0.0); adjust.z = 0.0; adjust.w = 0.0;
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+adjust;
}

`}),"./src/WebGL/shaders/lib/sprite/sprite.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform int fogType;
uniform vec3 fogColor;
uniform float fogDensity;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogType > 0) {

        float depth = gl_FragCoord.z / gl_FragCoord.w;
        float fogFactor = 0.0;

        if (fogType == 1) {
            fogFactor = smoothstep(fogNear, fogFar, depth);
        }

        else {
            const float LOG2 = 1.442695;
            float fogFactor = exp2(- fogDensity * fogDensity * depth * depth * LOG2);
            fogFactor = 1.0 - clamp(fogFactor, 0.0, 1.0);
        }

        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);

    }
}

`}),"./src/WebGL/shaders/lib/sprite/sprite.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`}),"./src/WebGL/shaders/lib/ssao/ssao.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`}),"./src/WebGL/shaders/lib/ssao/ssao.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    float fogFactor = smoothstep( fogNear, fogFar, depth );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
}`}),"./src/WebGL/shaders/lib/stickimposter/stickimposter.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(projectionMatrix[3][3] == 0.0) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(projectionMatrix[3][3] == 0.0) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }
    vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
    mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`}),"./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`}),"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    to.xyz += normalize(to.xyz)*outlinePushback;
    pt.xyz += normalize(pt.xyz)*outlinePushback;

    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }
    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`}),"./src/WebGL/shaders/lib/volumetric/volumetric.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `}),"./src/WebGL/shaders/lib/volumetric/volumetric.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`}),"./src/GLDraw.ts":((n,t,r)=>{r.r(t),r.d(t,{CAP:()=>v,GLDraw:()=>x});var u=r("./src/WebGL/math/index.ts"),v;(function(b){b[b.NONE=0]="NONE",b[b.FLAT=1]="FLAT",b[b.ROUND=2]="ROUND"})(v||(v={}));var x;(function(b){function p(a,s,c){var w=Math.hypot(a,s),_,M,l,h,S;w<1e-4?(M=0,l=1):(M=-a/w,l=s/w),s=-M*a+l*s,_=Math.hypot(s,c),_<1e-4?(h=0,S=1):(h=c/_,S=s/_);var E=new Float32Array(9);return E[0]=l,E[1]=M,E[2]=0,E[3]=-M*S,E[4]=l*S,E[5]=h,E[6]=M*h,E[7]=-l*h,E[8]=S,E}class y{constructor(){this.cache={};let s=[],c=4,w=Math.pow(2,c),_=2,M=Math.pow(2,_),l=w/M,h;for(s[0]=new u.Vector3(-1,0,0),s[l]=new u.Vector3(0,0,1),s[l*2]=new u.Vector3(1,0,0),s[l*3]=new u.Vector3(0,0,-1),_=3;_<=c;_++){for(M=Math.pow(2,_-1),l=w/M,h=0;h<M-1;h++)s[l/2+h*l]=s[h*l].clone().add(s[(h+1)*l]).normalize();h=M-1,s[l/2+h*l]=s[h*l].clone().add(s[0]).normalize()}this.basisVectors=s}getVerticesForRadius(s,c,w){if(typeof this.cache<"u"&&this.cache[s]!==void 0&&this.cache[s][c+w]!==void 0)return this.cache[s][c+w];for(var _=this.basisVectors.length,M=[],l=[],h,S=0;S<_;S++)M.push(this.basisVectors[S].clone().multiplyScalar(s)),M.push(this.basisVectors[S].clone().multiplyScalar(s)),h=this.basisVectors[S].clone().normalize(),l.push(h),l.push(h);var E=[],F=10,D=_,L=0,V=Math.PI*2,O=0,W=Math.PI,H,q,U=!1,B=!1;for(q=0;q<=F;q++){U=q===0||q===F,B=q===F/2;var Y=[],X=[];for(H=0;H<=D;H++){if(B){var N=H<D?2*H:0;X.push(N+1),Y.push(N);continue}var J=H/D,ae=q/F;if(!U||H===0)if(H<D){var se=new u.Vector3;se.x=-s*Math.cos(L+J*V)*Math.sin(O+ae*W),c==1?se.y=0:se.y=s*Math.cos(O+ae*W),se.z=s*Math.sin(L+J*V)*Math.sin(O+ae*W),Math.abs(se.x)<1e-5&&(se.x=0),Math.abs(se.y)<1e-5&&(se.y=0),Math.abs(se.z)<1e-5&&(se.z=0),c==v.FLAT?(h=new u.Vector3(0,Math.cos(O+ae*W),0),h.normalize()):(h=new u.Vector3(se.x,se.y,se.z),h.normalize()),M.push(se),l.push(h),Y.push(M.length-1)}else Y.push(M.length-D);else U&&Y.push(M.length-1)}B&&E.push(X),E.push(Y)}var he={vertices:M,normals:l,verticesRows:E,w:D,h:F};return s in this.cache||(this.cache[s]={}),this.cache[s][c+w]=he,he}}var k=new y;function g(a,s,c,w,_,M=0,l=0){if(!s||!c)return;let h=function(ke){if(typeof ke=="string"){let ct=ke;return ct.toLowerCase()=="flat"?v.FLAT:ct.toLowerCase()=="round"?v.ROUND:v.NONE}else return ke};M=h(M),l=h(l);var S=l||M;_=_||{r:0,g:0,b:0};var E=p(c.x-s.x,c.y-s.y,c.z-s.z),F=k.getVerticesForRadius(w,l,"to"),D=F.w,L=F.h,V=S?L*D+2:2*D,O=a.updateGeoGroup(V),W=F.vertices,H=F.normals,q=F.verticesRows,U=q[L/2],B=q[L/2+1],Y=O.vertices,X,N,J,ae,se,he,pe=O.vertexArray,de=O.normalArray,ue=O.colorArray,ge=O.faceArray;for(J=0;J<D;++J){var Re=2*J;ae=E[0]*W[Re].x+E[3]*W[Re].y+E[6]*W[Re].z,se=E[1]*W[Re].x+E[4]*W[Re].y+E[7]*W[Re].z,he=E[5]*W[Re].y+E[8]*W[Re].z,X=3*(Y+Re),N=O.faceidx,pe[X]=ae+s.x,pe[X+1]=se+s.y,pe[X+2]=he+s.z,pe[X+3]=ae+c.x,pe[X+4]=se+c.y,pe[X+5]=he+c.z,de[X]=ae,de[X+3]=ae,de[X+1]=se,de[X+4]=se,de[X+2]=he,de[X+5]=he,ue[X]=_.r,ue[X+3]=_.r,ue[X+1]=_.g,ue[X+4]=_.g,ue[X+2]=_.b,ue[X+5]=_.b,ge[N]=B[J]+Y,ge[N+1]=B[J+1]+Y,ge[N+2]=U[J]+Y,ge[N+3]=U[J]+Y,ge[N+4]=B[J+1]+Y,ge[N+5]=U[J+1]+Y,O.faceidx+=6}if(S){var Ge=l?0:L/2,We=M?L+1:L/2+1,Oe,me,Fe,qe,Qe,st,ot,Ke,Je,Xe,Ne,Ue,ft,ut,ee,ie,oe,we,Se,He,Be,K,xe,Me,$e,ye,je,Z,De,rt,G,Te;for(se=Ge;se<We;se++)if(se!==L/2){var Ee=se<=L/2?c:s,re=k.getVerticesForRadius(w,l,"to"),ve=k.getVerticesForRadius(w,M,"from");for(Ee===c?(W=re.vertices,H=re.normals,q=re.verticesRows):Ee==s&&(W=ve.vertices,H=ve.normals,q=ve.verticesRows),ae=0;ae<D;ae++)N=O.faceidx,Oe=q[se][ae+1],De=(Oe+Y)*3,me=q[se][ae],rt=(me+Y)*3,Fe=q[se+1][ae],G=(Fe+Y)*3,qe=q[se+1][ae+1],Te=(qe+Y)*3,Qe=E[0]*W[Oe].x+E[3]*W[Oe].y+E[6]*W[Oe].z,st=E[0]*W[me].x+E[3]*W[me].y+E[6]*W[me].z,ot=E[0]*W[Fe].x+E[3]*W[Fe].y+E[6]*W[Fe].z,Ke=E[0]*W[qe].x+E[3]*W[qe].y+E[6]*W[qe].z,Je=E[1]*W[Oe].x+E[4]*W[Oe].y+E[7]*W[Oe].z,Xe=E[1]*W[me].x+E[4]*W[me].y+E[7]*W[me].z,Ne=E[1]*W[Fe].x+E[4]*W[Fe].y+E[7]*W[Fe].z,Ue=E[1]*W[qe].x+E[4]*W[qe].y+E[7]*W[qe].z,ft=E[5]*W[Oe].y+E[8]*W[Oe].z,ut=E[5]*W[me].y+E[8]*W[me].z,ee=E[5]*W[Fe].y+E[8]*W[Fe].z,ie=E[5]*W[qe].y+E[8]*W[qe].z,pe[De]=Qe+Ee.x,pe[rt]=st+Ee.x,pe[G]=ot+Ee.x,pe[Te]=Ke+Ee.x,pe[De+1]=Je+Ee.y,pe[rt+1]=Xe+Ee.y,pe[G+1]=Ne+Ee.y,pe[Te+1]=Ue+Ee.y,pe[De+2]=ft+Ee.z,pe[rt+2]=ut+Ee.z,pe[G+2]=ee+Ee.z,pe[Te+2]=ie+Ee.z,ue[De]=_.r,ue[rt]=_.r,ue[G]=_.r,ue[Te]=_.r,ue[De+1]=_.g,ue[rt+1]=_.g,ue[G+1]=_.g,ue[Te+1]=_.g,ue[De+2]=_.b,ue[rt+2]=_.b,ue[G+2]=_.b,ue[Te+2]=_.b,oe=E[0]*H[Oe].x+E[3]*H[Oe].y+E[6]*H[Oe].z,we=E[0]*H[me].x+E[3]*H[me].y+E[6]*H[me].z,Se=E[0]*H[Fe].x+E[3]*H[Fe].y+E[6]*H[Fe].z,He=E[0]*H[qe].x+E[3]*H[qe].y+E[6]*H[qe].z,Be=E[1]*H[Oe].x+E[4]*H[Oe].y+E[7]*H[Oe].z,K=E[1]*H[me].x+E[4]*H[me].y+E[7]*H[me].z,xe=E[1]*H[Fe].x+E[4]*H[Fe].y+E[7]*H[Fe].z,Me=E[1]*H[qe].x+E[4]*H[qe].y+E[7]*H[qe].z,$e=E[5]*H[Oe].y+E[8]*H[Oe].z,ye=E[5]*H[me].y+E[8]*H[me].z,je=E[5]*H[Fe].y+E[8]*H[Fe].z,Z=E[5]*H[qe].y+E[8]*H[qe].z,se===0?(de[De]=oe,de[G]=Se,de[Te]=He,de[De+1]=Be,de[G+1]=xe,de[Te+1]=Me,de[De+2]=$e,de[G+2]=je,de[Te+2]=Z,ge[N]=Oe+Y,ge[N+1]=Fe+Y,ge[N+2]=qe+Y,O.faceidx+=3):se===We-1?(de[De]=oe,de[rt]=we,de[G]=Se,de[De+1]=Be,de[rt+1]=K,de[G+1]=xe,de[De+2]=$e,de[rt+2]=ye,de[G+2]=je,ge[N]=Oe+Y,ge[N+1]=me+Y,ge[N+2]=Fe+Y,O.faceidx+=3):(de[De]=oe,de[rt]=we,de[Te]=He,de[De+1]=Be,de[rt+1]=K,de[Te+1]=Me,de[De+2]=$e,de[rt+2]=ye,de[Te+2]=Z,de[rt]=we,de[G]=Se,de[Te]=He,de[rt+1]=K,de[G+1]=xe,de[Te+1]=Me,de[rt+2]=ye,de[G+2]=je,de[Te+2]=Z,ge[N]=Oe+Y,ge[N+1]=me+Y,ge[N+2]=qe+Y,ge[N+3]=me+Y,ge[N+4]=Fe+Y,ge[N+5]=qe+Y,O.faceidx+=6)}}O.vertices+=V}b.drawCylinder=g;function R(a,s,c,w,_){if(!s||!c)return;_=_||{r:0,g:0,b:0};let M=new u.Vector3(c.x-s.x,c.y-s.y,c.z-s.z);var l=p(M.x,M.y,M.z);M=M.normalize();var h=k.basisVectors.length,S=k.basisVectors,E=h+2,F=a.updateGeoGroup(E),D=F.vertices,L,V,O,W,H,q,U=F.vertexArray,B=F.normalArray,Y=F.colorArray,X=F.faceArray;for(L=D*3,U[L]=s.x,U[L+1]=s.y,U[L+2]=s.z,B[L]=-M.x,B[L+1]=-M.y,B[L+2]=-M.z,Y[L]=_.r,Y[L+1]=_.g,Y[L+2]=_.b,U[L+3]=c.x,U[L+4]=c.y,U[L+5]=c.z,B[L+3]=M.x,B[L+4]=M.y,B[L+5]=M.z,Y[L+3]=_.r,Y[L+4]=_.g,Y[L+5]=_.b,L+=6,O=0;O<h;++O){var N=S[O].clone();N.multiplyScalar(w),W=l[0]*N.x+l[3]*N.y+l[6]*N.z,H=l[1]*N.x+l[4]*N.y+l[7]*N.z,q=l[5]*N.y+l[8]*N.z,U[L]=W+s.x,U[L+1]=H+s.y,U[L+2]=q+s.z,B[L]=W,B[L+1]=H,B[L+2]=q,Y[L]=_.r,Y[L+1]=_.g,Y[L+2]=_.b,L+=3}for(F.vertices+=h+2,V=F.faceidx,O=0;O<h;O++){var J=D+2+O,ae=D+2+(O+1)%h;X[V]=J,X[V+1]=ae,X[V+2]=D,V+=3,X[V]=J,X[V+1]=ae,X[V+2]=D+1,V+=3}F.faceidx+=6*h}b.drawCone=R;class P{constructor(){this.cache=new Map}getVerticesForRadius(s,c){c=c||2,this.cache.has(c)||this.cache.set(c,new Map);let w=this.cache.get(c);if(w.has(s))return w.get(s);var _={vertices:[],verticesRows:[],normals:[]},M=16*c,l=10*c;s<1&&(M=10*c,l=8*c);var h=0,S=Math.PI*2,E=0,F=Math.PI,D,L;for(L=0;L<=l;L++){let O=[];for(D=0;D<=M;D++){let W=D/M,H=L/l,q=-s*Math.cos(h+W*S)*Math.sin(E+H*F),U=s*Math.cos(E+H*F),B=s*Math.sin(h+W*S)*Math.sin(E+H*F);var V=new u.Vector3(q,U,B);V.normalize(),_.vertices.push({x:q,y:U,z:B}),_.normals.push(V),O.push(_.vertices.length-1)}_.verticesRows.push(O)}return w.set(s,_),_}}var T=new P;function C(a,s,c,w,_){var M=T.getVerticesForRadius(c,_),l=M.vertices,h=M.normals,S=a.updateGeoGroup(l.length),E=S.vertices,F=S.vertexArray,D=S.colorArray,L=S.faceArray,V=S.lineArray,O=S.normalArray;for(let q=0,U=l.length;q<U;++q){let B=3*(E+q),Y=l[q];F[B]=Y.x+s.x,F[B+1]=Y.y+s.y,F[B+2]=Y.z+s.z,D[B]=w.r,D[B+1]=w.g,D[B+2]=w.b}S.vertices+=l.length;let W=M.verticesRows,H=W.length-1;for(let q=0;q<H;q++){let U=W[q].length-1;for(let B=0;B<U;B++){let Y=S.faceidx,X=S.lineidx,N=W[q][B+1]+E,J=N*3,ae=W[q][B]+E,se=ae*3,he=W[q+1][B]+E,pe=he*3,de=W[q+1][B+1]+E,ue=de*3,ge=h[N-E],Re=h[ae-E],Ge=h[he-E],We=h[de-E];Math.abs(l[N-E].y)===c?(O[J]=ge.x,O[pe]=Ge.x,O[ue]=We.x,O[J+1]=ge.y,O[pe+1]=Ge.y,O[ue+1]=We.y,O[J+2]=ge.z,O[pe+2]=Ge.z,O[ue+2]=We.z,L[Y]=N,L[Y+1]=he,L[Y+2]=de,V[X]=N,V[X+1]=he,V[X+2]=N,V[X+3]=de,V[X+4]=he,V[X+5]=de,S.faceidx+=3,S.lineidx+=6):Math.abs(l[he-E].y)===c?(O[J]=ge.x,O[se]=Re.x,O[pe]=Ge.x,O[J+1]=ge.y,O[se+1]=Re.y,O[pe+1]=Ge.y,O[J+2]=ge.z,O[se+2]=Re.z,O[pe+2]=Ge.z,L[Y]=N,L[Y+1]=ae,L[Y+2]=he,V[X]=N,V[X+1]=ae,V[X+2]=N,V[X+3]=he,V[X+4]=ae,V[X+5]=he,S.faceidx+=3,S.lineidx+=6):(O[J]=ge.x,O[se]=Re.x,O[ue]=We.x,O[J+1]=ge.y,O[se+1]=Re.y,O[ue+1]=We.y,O[J+2]=ge.z,O[se+2]=Re.z,O[ue+2]=We.z,O[se]=Re.x,O[pe]=Ge.x,O[ue]=We.x,O[se+1]=Re.y,O[pe+1]=Ge.y,O[ue+1]=We.y,O[se+2]=Re.z,O[pe+2]=Ge.z,O[ue+2]=We.z,L[Y]=N,L[Y+1]=ae,L[Y+2]=de,L[Y+3]=ae,L[Y+4]=he,L[Y+5]=de,V[X]=N,V[X+1]=ae,V[X+2]=N,V[X+3]=de,V[X+4]=ae,V[X+5]=he,V[X+6]=he,V[X+7]=de,S.faceidx+=6,S.lineidx+=8)}}}b.drawSphere=C})(x||(x={}))}),"./src/GLModel.ts":((n,t,r)=>{r.r(t),r.d(t,{GLModel:()=>C});var u=r("./src/WebGL/index.ts"),v=r("./src/WebGL/shapes/index.ts"),x=r("./src/WebGL/math/index.ts"),b=r("./src/colors.ts"),p=r("./src/GLDraw.ts"),y=r("./src/glcartoon.ts"),k=r("./src/utilities.ts"),g=r("./src/Gradient.ts"),R=r("./src/parsers/index.ts"),P=r("./node_modules/netcdfjs/lib-esm/index.js"),T=r("./src/parsers/utils/assignBonds.ts");class C{static sameObj(s,c){return s&&c?JSON.stringify(s)==JSON.stringify(c):s==c}constructor(s,c){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new x.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=b.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=c||{},this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:b.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=s}getRadiusFromStyle(s,c){var w=this.defaultSphereRadius;if(typeof c.radius<"u")w=c.radius;else if(C.vdwRadii[s.elem])w=C.vdwRadii[s.elem];else if(s.elem.length>1){let _=s.elem;_=_[0].toUpperCase()+_[1].toLowerCase(),C.vdwRadii[_]&&(w=C.vdwRadii[_])}return typeof c.scale<"u"&&(w*=c.scale),w}drawAtomCross(s,c){if(s.style.cross){var w=s.style.cross;if(!w.hidden){var _=w.linewidth||C.defaultlineWidth;c[_]||(c[_]=new u.Geometry);var M=c[_].updateGeoGroup(6),l=this.getRadiusFromStyle(s,w),h=[[l,0,0],[-l,0,0],[0,l,0],[0,-l,0],[0,0,l],[0,0,-l]],S=s.clickable||s.hoverable;S&&s.intersectionShape===void 0&&(s.intersectionShape={sphere:[],cylinder:[],line:[]});for(var E=(0,k.getColorFromStyle)(s,w),F=M.vertexArray,D=M.colorArray,L=0;L<6;L++){var V=M.vertices*3;if(M.vertices++,F[V]=s.x+h[L][0],F[V+1]=s.y+h[L][1],F[V+2]=s.z+h[L][2],D[V]=E.r,D[V+1]=E.g,D[V+2]=E.b,S){var O=new x.Vector3(h[L][0],h[L][1],h[L][2]);O.multiplyScalar(.1),O.set(O.x+s.x,O.y+s.y,O.z+s.z),s.intersectionShape.line.push(O)}}}}}getGoodCross(s,c,w,_){for(var M=null,l=-1,h=0,S=s.bonds.length;h<S;h++)if(s.bonds[h]!=c.index){let F=s.bonds[h],D=this.atoms[F],L=new x.Vector3(D.x,D.y,D.z).clone();L.sub(w);let V=L.clone();V.cross(_);var E=V.lengthSq();if(E>l&&(l=E,M=V,l>.1))return M}return M}getSideBondV(s,c,w){var _,M,l,h,S,E=new x.Vector3(s.x,s.y,s.z),F=new x.Vector3(c.x,c.y,c.z),D=F.clone(),L=null;if(D.sub(E),s.bonds.length===1)c.bonds.length===1?(L=D.clone(),Math.abs(L.x)>1e-4?L.y+=1:L.x+=1):(_=(w+1)%c.bonds.length,M=c.bonds[_],l=this.atoms[M],l.index==s.index&&(_=(_+1)%c.bonds.length,M=c.bonds[_],l=this.atoms[M]),h=new x.Vector3(l.x,l.y,l.z),S=h.clone(),S.sub(E),L=S.clone(),L.cross(D));else if(L=this.getGoodCross(s,c,E,D),L.lengthSq()<.01){var V=this.getGoodCross(c,s,E,D);V!=null&&(L=V)}return L.lengthSq()<.01&&(L=D.clone(),Math.abs(L.x)>1e-4?L.y+=1:L.x+=1),L.cross(D),L.normalize(),L}addLine(s,c,w,_,M,l){s[w]=_.x,s[w+1]=_.y,s[w+2]=_.z,c[w]=l.r,c[w+1]=l.g,c[w+2]=l.b,s[w+3]=M.x,s[w+4]=M.y,s[w+5]=M.z,c[w+3]=l.r,c[w+4]=l.g,c[w+5]=l.b}drawBondLines(s,c,w){if(s.style.line){var _=s.style.line;if(!_.hidden){var M,l,h,S,E=_.linewidth||C.defaultlineWidth;w[E]||(w[E]=new u.Geometry);for(var F=w[E].updateGeoGroup(6*s.bonds.length),D=F.vertexArray,L=F.colorArray,V=0;V<s.bonds.length;V++){var O=s.bonds[V],W=c[O];if(W.style.line&&!(s.index>=W.index)){var H=new x.Vector3(s.x,s.y,s.z),q=new x.Vector3(W.x,W.y,W.z),U=H.clone().add(q).multiplyScalar(.5),B=!1,Y=s.clickable||s.hoverable,X=W.clickable||W.hoverable;(Y||X)&&(Y&&(s.intersectionShape===void 0&&(s.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),s.intersectionShape.line.push(H),s.intersectionShape.line.push(U)),X&&(W.intersectionShape===void 0&&(W.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),W.intersectionShape.line.push(U),W.intersectionShape.line.push(q)));var N=(0,k.getColorFromStyle)(s,s.style.line),J=(0,k.getColorFromStyle)(W,W.style.line);if(s.bondStyles&&s.bondStyles[V]){var ae=s.bondStyles[V];if(!ae.iswire)continue;ae.singleBond&&(B=!0),typeof ae.color1<"u"&&(N=b.CC.color(ae.color1)),typeof ae.color2<"u"&&(J=b.CC.color(ae.color2))}var se=F.vertices*3,he,pe;if(s.bondOrder[V]>1&&s.bondOrder[V]<4&&!B){var de=this.getSideBondV(s,W,V),ue=q.clone();ue.sub(H),s.bondOrder[V]==2?(de.multiplyScalar(.1),M=H.clone(),M.add(de),l=H.clone(),l.sub(de),h=M.clone(),h.add(ue),S=l.clone(),S.add(ue),N==J?(F.vertices+=4,this.addLine(D,L,se,M,h,N),this.addLine(D,L,se+6,l,S,N)):(F.vertices+=8,ue.multiplyScalar(.5),he=M.clone(),he.add(ue),pe=l.clone(),pe.add(ue),this.addLine(D,L,se,M,he,N),this.addLine(D,L,se+6,he,h,J),this.addLine(D,L,se+12,l,pe,N),this.addLine(D,L,se+18,pe,S,J))):s.bondOrder[V]==3&&(de.multiplyScalar(.1),M=H.clone(),M.add(de),l=H.clone(),l.sub(de),h=M.clone(),h.add(ue),S=l.clone(),S.add(ue),N==J?(F.vertices+=6,this.addLine(D,L,se,H,q,N),this.addLine(D,L,se+6,M,h,N),this.addLine(D,L,se+12,l,S,N)):(F.vertices+=12,ue.multiplyScalar(.5),he=M.clone(),he.add(ue),pe=l.clone(),pe.add(ue),this.addLine(D,L,se,H,U,N),this.addLine(D,L,se+6,U,q,J),this.addLine(D,L,se+12,M,he,N),this.addLine(D,L,se+18,he,h,J),this.addLine(D,L,se+24,l,pe,N),this.addLine(D,L,se+30,pe,S,J)))}else N==J?(F.vertices+=2,this.addLine(D,L,se,H,q,N)):(F.vertices+=4,this.addLine(D,L,se,H,U,N),this.addLine(D,L,se+6,U,q,J))}}}}}drawAtomSphere(s,c){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var _=(0,k.getColorFromStyle)(s,w),M=this.getRadiusFromStyle(s,w);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var l=new x.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new v.Sphere(l,M))}p.GLDraw.drawSphere(c,s,M,_)}}}drawAtomClickSphere(s){if(s.style.clicksphere){var c=s.style.clicksphere;if(!c.hidden){var w=this.getRadiusFromStyle(s,c);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var _=new x.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new v.Sphere(_,w))}}}}drawAtomInstanced(s,c){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var _=this.getRadiusFromStyle(s,w),M=(0,k.getColorFromStyle)(s,w),l=c.updateGeoGroup(1),h=l.vertices,S=h*3,E=l.vertexArray,F=l.colorArray,D=l.radiusArray;if(E[S]=s.x,E[S+1]=s.y,E[S+2]=s.z,F[S]=M.r,F[S+1]=M.g,F[S+2]=M.b,D[h]=_,(s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var L=new x.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new v.Sphere(L,_))}l.vertices+=1}}}drawSphereImposter(s,c,w,_){var M=s.updateGeoGroup(4),l,h=M.vertices,S=h*3,E=M.vertexArray,F=M.colorArray;for(l=0;l<4;l++)E[S+3*l]=c.x,E[S+3*l+1]=c.y,E[S+3*l+2]=c.z;var D=M.normalArray;for(l=0;l<4;l++)F[S+3*l]=_.r,F[S+3*l+1]=_.g,F[S+3*l+2]=_.b;D[S+0]=-w,D[S+1]=w,D[S+2]=0,D[S+3]=-w,D[S+4]=-w,D[S+5]=0,D[S+6]=w,D[S+7]=-w,D[S+8]=0,D[S+9]=w,D[S+10]=w,D[S+11]=0,M.vertices+=4;var L=M.faceArray,V=M.faceidx;L[V+0]=h,L[V+1]=h+1,L[V+2]=h+2,L[V+3]=h+2,L[V+4]=h+3,L[V+5]=h,M.faceidx+=6}drawAtomImposter(s,c){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var _=this.getRadiusFromStyle(s,w),M=(0,k.getColorFromStyle)(s,w);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var l=new x.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new v.Sphere(l,_))}this.drawSphereImposter(c,s,_,M)}}}calculateDashes(s,c,w,_,M){var l=Math.sqrt(Math.pow(s.x-c.x,2)+Math.pow(s.y-c.y,2)+Math.pow(s.z-c.z,2));w=Math.max(w,0),M=Math.max(M,0)+2*w,_=Math.max(_,.001),_+M>l&&(_=l,M=0);var h=Math.floor((l-_)/(_+M))+1,S=h*_;M=(l-S)/h;for(var E,F=new x.Vector3(s.x,s.y,s.z),D=new x.Vector3((c.x-s.x)/(l/M),(c.y-s.y)/(l/M),(c.z-s.z)/(l/M)),L=new x.Vector3((c.x-s.x)/(l/_),(c.y-s.y)/(l/_),(c.z-s.z)/(l/_)),V=[],O=0;O<h;O++)E=new x.Vector3(F.x+L.x,F.y+L.y,F.z+L.z),V.push({from:F,to:E}),F=new x.Vector3(E.x+D.x,E.y+D.y,E.z+D.z);return V}static drawStickImposter(s,c,w,_,M,l=0,h=0){for(var S=s.updateGeoGroup(4),E=S.vertices,F=E*3,D=S.vertexArray,L=S.colorArray,V=S.radiusArray,O=S.normalArray,W=M.r,H=M.g,q=M.b,U=function(J){var ae=-J;return ae==0&&(ae=-1e-4),ae},B=F,Y=0;Y<4;Y++)D[B]=c.x,O[B]=w.x,L[B]=W,B++,D[B]=c.y,O[B]=w.y,L[B]=H,B++,D[B]=c.z,O[B]=w.z,Y<2?L[B]=q:L[B]=U(q),B++;S.vertices+=4,V[E]=-_,V[E+1]=_,V[E+2]=-_,V[E+3]=_;var X=S.faceArray,N=S.faceidx;X[N+0]=E,X[N+1]=E+1,X[N+2]=E+2,X[N+3]=E+2,X[N+4]=E+3,X[N+5]=E,S.faceidx+=6}drawBondSticks(s,c,w){var _,M;if(s.style.stick){var l=s.style.stick;if(!l.hidden){var h=l.radius||this.defaultStickRadius,S=l.doubleBondScaling||.4,E=l.tripleBondScaling||.25,F=((_=l.dashedBondConfig)===null||_===void 0?void 0:_.dashLength)||.1,D=((M=l.dashedBondConfig)===null||M===void 0?void 0:M.gapLength)||.25,L=h,V=l.singleBonds||!1,O=l.dashedBonds||!1,W=0,H=0,q,U,B,Y,X,N,J,ae,se,he,pe,de=(0,k.getColorFromStyle)(s,l),ue,ge,Re;!s.capDrawn&&s.bonds.length<4&&(W=2);var Ge=xe=>{var Me=w.imposter?C.drawStickImposter:p.GLDraw.drawCylinder;return!O&&xe>=1?Me:($e,ye,je,Z,De,rt=0,G=0,Te=.1,Ee=.25)=>{var re=this.calculateDashes(ye,je,Z,Te,Ee);re.forEach(ve=>{Me($e,ve.from,ve.to,Z,De,rt,G)})}};for(B=0;B<s.bonds.length;B++){var We=Ge(s.bondOrder[B]),Oe=s.bonds[B],me=c[Oe];if(ue=ge=Re=null,s.index<me.index){var Fe=me.style;if(!Fe.stick||Fe.stick.hidden)continue;var qe=(0,k.getColorFromStyle)(me,Fe.stick);if(L=h,Y=V,s.bondStyles&&s.bondStyles[B]){if(X=s.bondStyles[B],X.iswire)continue;X.radius&&(L=X.radius),X.singleBond&&(Y=!0),typeof X.color1<"u"&&(de=b.CC.color(X.color1)),typeof X.color2<"u"&&(qe=b.CC.color(X.color2))}var Qe=new x.Vector3(s.x,s.y,s.z),st=new x.Vector3(me.x,me.y,me.z);if(s.bondOrder[B]<=1||Y||s.bondOrder[B]>3){if(s.bondOrder[B]<1&&(L*=s.bondOrder[B]),!me.capDrawn&&me.bonds.length<4&&(H=2),de!=qe?(ue=new x.Vector3().addVectors(Qe,st).multiplyScalar(.5),We(w,Qe,ue,L,de,W,0,F,D),We(w,ue,st,L,qe,0,H,F,D)):We(w,Qe,st,L,de,W,H,F,D),q=s.clickable||s.hoverable,U=me.clickable||me.hoverable,q||U){if(ue||(ue=new x.Vector3().addVectors(Qe,st).multiplyScalar(.5)),q){var ot=new v.Cylinder(Qe,ue,L),Ke=new v.Sphere(Qe,L);s.intersectionShape.cylinder.push(ot),s.intersectionShape.sphere.push(Ke)}if(U){var Je=new v.Cylinder(st,ue,L),Xe=new v.Sphere(st,L);me.intersectionShape.cylinder.push(Je),me.intersectionShape.sphere.push(Xe)}}}else if(s.bondOrder[B]>1){var Ne=0,Ue=0;L!=h&&(Ne=2,Ue=2);var ft=st.clone(),ut=null;ft.sub(Qe);var ee,ie,oe,we,Se;ut=this.getSideBondV(s,me,B),s.bondOrder[B]==2?(ee=L*S,ut.multiplyScalar(ee*1.5),ie=Qe.clone(),ie.add(ut),oe=Qe.clone(),oe.sub(ut),we=ie.clone(),we.add(ft),Se=oe.clone(),Se.add(ft),de!=qe?(ue=new x.Vector3().addVectors(ie,we).multiplyScalar(.5),ge=new x.Vector3().addVectors(oe,Se).multiplyScalar(.5),We(w,ie,ue,ee,de,Ne,0),We(w,ue,we,ee,qe,0,Ue),We(w,oe,ge,ee,de,Ne,0),We(w,ge,Se,ee,qe,0,Ue)):(We(w,ie,we,ee,de,Ne,Ue),We(w,oe,Se,ee,de,Ne,Ue)),q=s.clickable||s.hoverable,U=me.clickable||me.hoverable,(q||U)&&(ue||(ue=new x.Vector3().addVectors(ie,we).multiplyScalar(.5)),ge||(ge=new x.Vector3().addVectors(oe,Se).multiplyScalar(.5)),q&&(N=new v.Cylinder(ie,ue,ee),J=new v.Cylinder(oe,ge,ee),s.intersectionShape.cylinder.push(N),s.intersectionShape.cylinder.push(J)),U&&(se=new v.Cylinder(we,ue,ee),he=new v.Cylinder(Se,ge,ee),me.intersectionShape.cylinder.push(se),me.intersectionShape.cylinder.push(he)))):s.bondOrder[B]==3&&(ee=L*E,ut.cross(ft),ut.normalize(),ut.multiplyScalar(ee*3),ie=Qe.clone(),ie.add(ut),oe=Qe.clone(),oe.sub(ut),we=ie.clone(),we.add(ft),Se=oe.clone(),Se.add(ft),de!=qe?(ue=new x.Vector3().addVectors(ie,we).multiplyScalar(.5),ge=new x.Vector3().addVectors(oe,Se).multiplyScalar(.5),Re=new x.Vector3().addVectors(Qe,st).multiplyScalar(.5),We(w,ie,ue,ee,de,Ne,0),We(w,ue,we,ee,qe,0,Ue),We(w,Qe,Re,ee,de,W,0),We(w,Re,st,ee,qe,0,H),We(w,oe,ge,ee,de,Ne,0),We(w,ge,Se,ee,qe,0,Ue)):(We(w,ie,we,ee,de,Ne,Ue),We(w,Qe,st,ee,de,W,H),We(w,oe,Se,ee,de,Ne,Ue)),q=s.clickable||s.hoverable,U=me.clickable||me.hoverable,(q||U)&&(ue||(ue=new x.Vector3().addVectors(ie,we).multiplyScalar(.5)),ge||(ge=new x.Vector3().addVectors(oe,Se).multiplyScalar(.5)),Re||(Re=new x.Vector3().addVectors(Qe,st).multiplyScalar(.5)),q&&(N=new v.Cylinder(ie.clone(),ue.clone(),ee),J=new v.Cylinder(oe.clone(),ge.clone(),ee),ae=new v.Cylinder(Qe.clone(),Re.clone(),ee),s.intersectionShape.cylinder.push(N),s.intersectionShape.cylinder.push(J),s.intersectionShape.cylinder.push(ae)),U&&(se=new v.Cylinder(we.clone(),ue.clone(),ee),he=new v.Cylinder(Se.clone(),ge.clone(),ee),pe=new v.Cylinder(st.clone(),Re.clone(),ee),me.intersectionShape.cylinder.push(se),me.intersectionShape.cylinder.push(he),me.intersectionShape.cylinder.push(pe))))}}}var He=!1,Be=0,K=!1;for(B=0;B<s.bonds.length;B++)Y=V,s.bondStyles&&s.bondStyles[B]&&(X=s.bondStyles[B],X.singleBond&&(Y=!0),X.radius&&X.radius!=h&&(K=!0)),(Y||s.bondOrder[B]==1)&&Be++;K?Be>0&&(He=!0):Be==0&&(s.bonds.length>0||l.showNonBonded)&&(He=!0),He&&(L=h,w.imposter?this.drawSphereImposter(w.sphereGeometry,s,L,de):p.GLDraw.drawSphere(w,s,L,de))}}}createMolObj(s,c){c=c||{};var w=new u.Object3D,_=[],M={},l={},h=this.drawAtomSphere,S=null,E=null;c.supportsImposters?(h=this.drawAtomImposter,S=new u.Geometry(!0),S.imposter=!0,E=new u.Geometry(!0,!0),E.imposter=!0,E.sphereGeometry=new u.Geometry(!0),E.sphereGeometry.imposter=!0,E.drawnCaps={}):c.supportsAIA?(h=this.drawAtomInstanced,S=new u.Geometry(!1,!0,!0),S.instanced=!0,E=new u.Geometry(!0)):(S=new u.Geometry(!0),E=new u.Geometry(!0));var F,D,L,V,O={},W=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(F=0,L=s.length;F<L;F++){var H=s[F];if(H&&H.style){(H.clickable||H.hoverable)&&H.intersectionShape===void 0&&(H.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),V={line:void 0,cross:void 0,stick:void 0,sphere:void 0};for(D in V)H.style[D]?H.style[D].opacity?V[D]=parseFloat(H.style[D].opacity):V[D]=1:V[D]=void 0,O[D]?V[D]!=null&&O[D]!=V[D]&&(console.log("Warning: "+D+" opacity is ambiguous"),O[D]=1):O[D]=V[D];h.call(this,H,S),this.drawAtomClickSphere(H),this.drawAtomCross(H,l),this.drawBondLines(H,s,M),this.drawBondSticks(H,s,E),typeof H.style.cartoon<"u"&&!H.style.cartoon.hidden&&(H.style.cartoon.color==="spectrum"&&typeof H.resi=="number"&&!H.hetflag&&(H.resi<W[0]&&(W[0]=H.resi),H.resi>W[1]&&(W[1]=H.resi)),_.push(H))}}if(_.length>0&&(0,y.drawCartoon)(w,_,W,this.defaultCartoonQuality),S&&S.vertices>0){S.initTypedArrays();var q=null,U=null;S.imposter?q=new u.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):S.instanced?(U=new u.Geometry(!0),p.GLDraw.drawSphere(U,{x:0,y:0,z:0},1,new b.Color(.5,.5,.5)),U.initTypedArrays(),q=new u.InstancedMaterial({sphereMaterial:new u.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:U})):q=new u.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),O.sphere<1&&O.sphere>=0&&(q.transparent=!0,q.opacity=O.sphere),U=new u.Mesh(S,q),w.add(U)}if(E.vertices>0){var B=null,Y=null,X=E.sphereGeometry;(!X||typeof X.vertices>"u"||X.vertices==0)&&(X=null),E.initTypedArrays(),X&&X.initTypedArrays();var N={ambient:0,vertexColors:!0,reflectivity:0};E.imposter?(B=new u.StickImposterMaterial(N),Y=new u.SphereImposterMaterial(N)):(B=new u.MeshLambertMaterial(N),Y=new u.MeshLambertMaterial(N),B.wireframe&&(E.setUpWireframe(),X&&X.setUpWireframe())),O.stick<1&&O.stick>=0&&(B.transparent=!0,B.opacity=O.stick,Y.transparent=!0,Y.opacity=O.stick);var J=new u.Mesh(E,B);if(w.add(J),X){var ae=new u.Mesh(X,Y);w.add(ae)}}var se;for(F in M)if(M.hasOwnProperty(F)){se=F;var he=new u.LineBasicMaterial({linewidth:se,vertexColors:!0});O.line<1&&O.line>=0&&(he.transparent=!0,he.opacity=O.line),M[F].initTypedArrays();var pe=new u.Line(M[F],he,u.LineStyle.LinePieces);w.add(pe)}for(F in l)if(l.hasOwnProperty(F)){se=F;var de=new u.LineBasicMaterial({linewidth:se,vertexColors:!0});O.cross<1&&O.cross>=0&&(de.transparent=!0,de.opacity=O.cross),l[F].initTypedArrays();var ue=new u.Line(l[F],de,u.LineStyle.LinePieces);w.add(ue)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var ge=new u.Object3D,Re;for(Re=0;Re<this.modelData.symmetries.length;Re++){var Ge=new u.Object3D;Ge=w.clone(),Ge.matrix.copy(this.modelData.symmetries[Re]),Ge.matrixAutoUpdate=!1,ge.add(Ge)}return ge}return w}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(s){this.atoms=s.atoms,this.frames=s.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const s=this.modelData.cryst;this.modelData.cryst.matrix=(0,x.conversionMatrix3)(s.a,s.b,s.c,s.alpha,s.beta,s.gamma)}return this.modelData.cryst}else return null}setCrystData(s,c,w,_,M,l){s=s||1,c=c||1,w=w||1,_=_||90,M=M||90,l=l||90;const h=(0,x.conversionMatrix3)(s,c,w,_,M,l);this.modelData.cryst={a:s,b:c,c:w,alpha:_,beta:M,gamma:l,matrix:h}}setCrystMatrix(s){s=s||new x.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:s}}getSymmetries(){return typeof this.modelData.symmetries>"u"&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(s){typeof s>"u"?this.modelData.symmetries=[this.idMatrix]:this.modelData.symmetries=s}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(s,c,w,_){var M=c-s;return M<-w?c+_:M>w?c-_:c}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var s=this.box[0],c=this.box[1],w=this.box[2],_=s*.9,M=c*.9,l=w*.9,h=0;h<this.atomdfs.length;h++)for(var S=this.atomdfs[h],E=1;E<S.length;E++){var F=this.atoms[S[E][0]],D=this.atoms[S[E][1]];F.x=this.adjustCoord(D.x,F.x,_,s),F.y=this.adjustCoord(D.y,F.y,M,c),F.z=this.adjustCoord(D.z,F.z,l,w)}}setFrame(s,c){var w=this.getNumFrames();let _=this;return new Promise(function(M,l){if(w==0&&M(),(s<0||s>=w)&&(s=w-1),_.frames.url!=null){var h=_.frames.url;(0,k.getbin)(h+"/traj/frame/"+s+"/"+_.frames.path,void 0,"POST",void 0).then(function(S){for(var E=new Float32Array(S,44),F=0,D=0;D<_.atoms.length;D++)_.atoms[D].x=E[F++],_.atoms[D].y=E[F++],_.atoms[D].z=E[F++];_.box&&_.atomdfs&&_.adjustCoordinatesToBox(),M()}).catch(l)}else _.atoms=_.frames[s],M();_.molObj=null,_.modelDatas&&s<_.modelDatas.length&&(_.modelData=_.modelDatas[s],_.unitCellObjects&&c&&(c.removeUnitCell(_),c.addUnitCell(_)))})}addFrame(s){this.frames.push(s)}vibrate(s=10,c=1,w=!1,_,M){var l=0,h=s;w&&(l=-s,h=s),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),l<h&&(this.frames=[]),w&&(this.frames.origIndex=s);for(var S=l;S<h;S++){var E=[],F=this.frames.length;if(S==0&&!M){this.frames.push(this.atoms);continue}for(var D=0;D<this.atoms.length;D++){var L=(0,k.getAtomProperty)(this.atoms[D],"dx"),V=(0,k.getAtomProperty)(this.atoms[D],"dy"),O=(0,k.getAtomProperty)(this.atoms[D],"dz"),W=new x.Vector3(L,V,O),H=new x.Vector3(this.atoms[D].x,this.atoms[D].y,this.atoms[D].z),q=S*c/s;W.multiplyScalar(q),H.add(W);var U={};for(var B in this.atoms[D])U[B]=this.atoms[D][B];if(U.x=H.x,U.y=H.y,U.z=H.z,E.push(U),_&&M){var Y=(0,k.extend)({},M),X=new x.Vector3(L,V,O);if(X.multiplyScalar(c),X.add(H),Y.start=H,Y.end=X,Y.frame=F,!Y.color){var N=U.style.sphere;N||(N=U.style.stick),N||(N=U.style.line),Y.color=(0,k.getColorFromStyle)(U,N)}_.addArrow(Y)}}this.frames.push(E)}}setAtomDefaults(s){for(let c=0;c<s.length;c++){let w=s[c];w&&(w.style=w.style||(0,k.deepCopy)(C.defaultAtomStyle),w.color=w.color||this.ElementColors[w.elem]||this.defaultColor,w.model=this.id,(w.clickable||w.hoverable)&&(w.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(s,c,w={}){var _=C.parseMolData(s,c,w);this.dontDuplicateAtoms=!w.duplicateAssemblyAtoms;var M=_.modelData;if(M&&(Array.isArray(M)?(this.modelData=M[0],w.frames&&(this.modelDatas=M)):this.modelData=M),_.box?this.box=_.box:this.box=null,this.frames.length==0){for(let h=0;h<_.length;h++)_[h].length!=0&&this.frames.push(_[h]);this.frames[0]&&(this.atoms=this.frames[0])}else if(w.frames)for(let h=0;h<_.length;h++)this.frames.push(_[h]);else for(var l=0;l<_.length;l++)this.addAtoms(_[l]);for(let h=0;h<this.frames.length;h++)this.setAtomDefaults(this.frames[h]);w.vibrate&&w.vibrate.frames&&w.vibrate.amplitude&&this.vibrate(w.vibrate.frames,w.vibrate.amplitude),w.style&&this.setStyle({},w.style)}setDontDuplicateAtoms(s){this.dontDuplicateAtoms=s}setModelData(s){this.modelData=s}propertyMatches(s,c){if(s==c)return!0;if(typeof c=="string"&&typeof s=="number"){var w=c.match(/(-?\d+)\s*-\s*(-?\d+)/);if(w){var _=parseInt(w[1]),M=parseInt(w[2]);if(w&&s>=_&&s<=M)return!0}}return!1}static deepCopyAndCache(s,c){if(typeof s!="object"||s==null||s.__cache_created)return s;const w={};for(const _ in s){const M=s[_];if(Array.isArray(M)){w[_]=[];for(let l=0;l<M.length;l++)w[_].push(C.deepCopyAndCache(M[l],c))}else typeof M=="object"&&_!="properties"&&_!="model"?w[_]=C.deepCopyAndCache(M,c):w[_]=M;if(_=="and"||_=="or"){const l=[];for(const h of w[_]){const S=new Set;for(const E of c.selectedAtoms(h))S.add(E.index);l.push(S)}if(_=="and"){const h=function(E,F){const D=new Set;for(const L of F)E.has(L)&&D.add(L);return D};let S=new Set(l[0]);for(const E of l.splice(1))S=h(S,E);w[_].__cached_results=S}else if(_=="or"){const h=new Set;for(const S of l)for(const E of S)h.add(E);w[_].__cached_results=h}}}return w.__cache_created=!0,w}atomIsSelected(s,c){if(typeof c>"u")return!0;var w=!!c.invert,_=!0;for(var M in c)if(M=="and"||M=="or"||M=="not"){if(M=="not"){if(this.atomIsSelected(s,c[M])){_=!1;break}}else if(c[M].__cached_results===void 0&&(c=C.deepCopyAndCache(c,this)),_=c[M].__cached_results.has(s.index),!_)break}else if(M==="predicate"){if(!c.predicate(s)){_=!1;break}}else if(M=="properties"&&s[M]){for(var l in c.properties)if(!l.startsWith("__cache")){if(typeof s.properties[l]>"u"){_=!1;break}if(s.properties[l]!=c.properties[l]){_=!1;break}}}else if(c.hasOwnProperty(M)&&!C.ignoredKeys.has(M)&&!M.startsWith("__cache")){if(typeof s[M]>"u"){_=!1;break}var h=!1;if(M==="bonds"){var S=c[M];if(S!=s.bonds.length){_=!1;break}}else if(Array.isArray(c[M])){var E=c[M],F=s[M];for(let D=0;D<E.length;D++)if(this.propertyMatches(F,E[D])){h=!0;break}if(!h){_=!1;break}}else{let D=c[M];if(!this.propertyMatches(s[M],D)){_=!1;break}}}return w?!_:_}static squaredDistance(s,c){var w=c.x-s.x,_=c.y-s.y,M=c.z-s.z;return w*w+_*_+M*M}expandAtomList(s,c){if(c<=0)return s;for(var w=(0,k.getExtent)(s,void 0),_=[[],[],[]],M=0;M<3;M++)_[0][M]=w[0][M]-c,_[1][M]=w[1][M]+c,_[2][M]=w[2][M];var l=[];for(let F=0;F<this.atoms.length;F++){var h=this.atoms[F].x,S=this.atoms[F].y,E=this.atoms[F].z;h>=_[0][0]&&h<=_[1][0]&&S>=_[0][1]&&S<=_[1][1]&&E>=_[0][2]&&E<=_[1][2]&&(h>=w[0][0]&&h<=w[1][0]&&S>=w[0][1]&&S<=w[1][1]&&E>=w[0][2]&&E<=w[1][2]||l.push(this.atoms[F]))}return l}static getFloat(s){return typeof s=="number"?s:parseFloat(s)}selectedAtoms(s,c){var w=[];s=C.deepCopyAndCache(s||{},this),c||(c=this.atoms);for(var _=c.length,M=0;M<_;M++){var l=c[M];l&&this.atomIsSelected(l,s)&&w.push(l)}if(s.hasOwnProperty("expand")){const U=C.getFloat(s.expand);let B=this.expandAtomList(w,U),Y=w.length;const X=U*U;for(let N=0;N<B.length;N++)for(let J=0;J<Y;J++){var h=C.squaredDistance(B[N],w[J]);h<X&&h>0&&w.push(B[N])}}if(s.hasOwnProperty("within")&&s.within.hasOwnProperty("sel")&&s.within.hasOwnProperty("distance")){var S=this.selectedAtoms(s.within.sel,this.atoms),E={};const U=C.getFloat(s.within.distance),B=U*U;for(let Y=0;Y<S.length;Y++)for(let X=0;X<w.length;X++){let N=C.squaredDistance(S[Y],w[X]);N<B&&N>0&&(E[X]=1)}var F=[];if(s.within.invert)for(let Y=0;Y<w.length;Y++)E[Y]||F.push(w[Y]);else for(let Y in E)F.push(w[Y]);w=F}if(s.hasOwnProperty("byres")){var D={},L=[],V=[];for(let U=0;U<w.length;U++){let B=w[U];var O=B.chain,W=B.resi;if(D[O]===void 0&&(D[O]={}),B.hasOwnProperty("resi")&&D[O][W]===void 0){for(D[O][W]=!0,V.push(B);V.length>0;)if(B=V.pop(),O=B.chain,W=B.resi,L[B.index]===void 0){L[B.index]=!0;for(var H=0;H<B.bonds.length;H++){var q=this.atoms[B.bonds[H]];L[q.index]===void 0&&q.hasOwnProperty("resi")&&q.chain==O&&q.resi==W&&(V.push(q),w.push(q))}}}}}return w}addAtoms(s){this.molObj=null;var c=this.atoms.length,w=[],_;for(_=0;_<s.length;_++)typeof s[_].index>"u"&&(s[_].index=_),typeof s[_].serial>"u"&&(s[_].serial=_),w[s[_].index]=c+_;for(_=0;_<s.length;_++){var M=s[_],l=w[M.index],h=(0,k.extend)({},M);h.index=l,h.bonds=[],h.bondOrder=[],h.model=this.id,h.style=h.style||(0,k.deepCopy)(C.defaultAtomStyle),typeof h.color>"u"&&(h.color=this.ElementColors[h.elem]||this.defaultColor);for(var S=M.bonds?M.bonds.length:0,E=0;E<S;E++){var F=w[M.bonds[E]];typeof F<"u"&&(h.bonds.push(F),h.bondOrder.push(M.bondOrder?M.bondOrder[E]:1))}this.atoms.push(h)}}assignBonds(){(0,T.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(s){this.molObj=null;var c=[],w;for(w=0;w<s.length;w++)c[s[w].index]=!0;var _=[];for(w=0;w<this.atoms.length;w++){var M=this.atoms[w];c[M.index]||_.push(M)}this.atoms=[],this.addAtoms(_)}setStyle(s,c,w){typeof c>"u"&&typeof w>"u"&&(c=s,s={}),s=s,typeof c=="string"&&(c=(0,k.specStringToObject)(c));var _=!1,M=this,l=function(S){var E=M.selectedAtoms(s,S);for(let F=0;F<S.length;F++)S[F]&&(S[F].capDrawn=!1);for(let F=0;F<E.length;F++){_=!0,(E[F].clickable||E[F].hoverable)&&(E[F].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),w||(E[F].style={});for(let D in c)c.hasOwnProperty(D)&&(E[F].style[D]=E[F].style[D]||{},Object.assign(E[F].style[D],c[D]))}};if(s.frame!==void 0&&s.frame<this.frames.length){let S=s.frame;S<0&&(S=this.frames.length+S),l(this.frames[S])}else{l(this.atoms);for(var h=0;h<this.frames.length;h++)this.frames[h]!==this.atoms&&l(this.frames[h])}_&&(this.molObj=null)}setClickable(s,c,w){if(c=!!c,w=(0,k.makeFunction)(w),w===null){console.log("Callback is not a function");return}var _=this.selectedAtoms(s,this.atoms),M=_.length;for(let l=0;l<M;l++)_[l].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},_[l].clickable=c,w&&(_[l].callback=w);M>0&&(this.molObj=null)}setHoverable(s,c,w,_){if(c=!!c,w=(0,k.makeFunction)(w),_=(0,k.makeFunction)(_),w===null){console.log("Hover_callback is not a function");return}if(_===null){console.log("Unhover_callback is not a function");return}var M=this.selectedAtoms(s,this.atoms),l=M.length;for(let h=0;h<l;h++)M[h].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},M[h].hoverable=c,w&&(M[h].hover_callback=w),_&&(M[h].unhover_callback=_);l>0&&(this.molObj=null)}enableContextMenu(s,c){c=!!c;var w,_=this.selectedAtoms(s,this.atoms),M=_.length;for(w=0;w<M;w++)_[w].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},_[w].contextMenuEnabled=c;M>0&&(this.molObj=null)}setColorByElement(s,c){if(!(this.molObj!==null&&C.sameObj(c,this.lastColors))){this.lastColors=c;var w=this.selectedAtoms(s,w);w.length>0&&(this.molObj=null);for(var _=0;_<w.length;_++){var M=w[_];typeof c[M.elem]<"u"&&(M.color=c[M.elem])}}}setColorByProperty(s,c,w,_){var M,l,h=this.selectedAtoms(s,h);for(this.lastColors=null,h.length>0&&(this.molObj=null),typeof w=="string"&&typeof g.Gradient.builtinGradients[w]<"u"&&(w=new g.Gradient.builtinGradients[w]),w=w,_||(_=w.range()),_||(_=(0,k.getPropertyRange)(h,c)),M=0;M<h.length;M++){l=h[M];var S=(0,k.getAtomProperty)(l,c);S!=null&&(l.color=w.valueToHex(parseFloat(l.properties[c]),_))}}setColorByFunction(s,c){var w=this.selectedAtoms(s,w);if(typeof c=="function"){this.lastColors=null,w.length>0&&(this.molObj=null);for(let _=0;_<w.length;_++){let M=w[_];M.color=c(M)}}}toCDObject(s=!1){var c={a:[],b:[]};s&&(c.s=[]);for(let _=0;_<this.atoms.length;_++){let M={},l=this.atoms[_];if(M.x=l.x,M.y=l.y,M.z=l.z,l.elem!="C"&&(M.l=l.elem),s){for(var w=0;w<c.s.length&&JSON.stringify(l.style)!==JSON.stringify(c.s[w]);)w++;w===c.s.length&&c.s.push(l.style),w!==0&&(M.s=w)}c.a.push(M);for(let h=0;h<l.bonds.length;h++){let S=_,E=l.bonds[h];if(S>=E)continue;let F={b:S,e:E},D=l.bondOrder[h];D!=1&&(F.o=D),c.b.push(F)}}return c}globj(s,c){(this.molObj===null||c.regen)&&(this.molObj=this.createMolObj(this.atoms,c),this.renderedMolObj&&(s.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),s.add(this.renderedMolObj))}exportVRML(){var s=this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1});return s.vrml()}removegl(s){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),s.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(s,c,w,_){for(var M=this.selectedAtoms(c,M),l=(0,k.deepCopy)(_),h=0;h<M.length;h++){var S=M[h],E=null;typeof S[s]<"u"?E=String(S[s]):typeof S.properties[s]<"u"&&(E=String(S.properties[s])),E!=null&&(l.position=S,w.addLabel(E,l))}}addResLabels(s,c,w,_=!1){var M=[],l=function(S,E){for(var F=S.selectedAtoms(s,F),D={},L=0;L<F.length;L++){var V=F[L],O=V.chain,W=V.resn,H=V.resi,q=W+""+H;D[O]||(D[O]={}),D[O][q]||(D[O][q]=[]),D[O][q].push(V)}var U=(0,k.deepCopy)(w);for(let Y in D)if(D.hasOwnProperty(Y)){var B=D[Y];for(let X in B)if(B.hasOwnProperty(X)){let N=B[X],J=new x.Vector3(0,0,0);for(let se=0;se<N.length;se++){let he=N[se];J.x+=he.x,J.y+=he.y,J.z+=he.z}J.divideScalar(N.length),U.position=J,U.frame=E;let ae=c.addLabel(X,U,void 0,!0);M.push(ae)}}};if(_){var h=this.getNumFrames();let S=this.atoms;for(let E=0;E<h;E++)this.frames[E]&&(this.atoms=this.frames[E],l(this,E));this.atoms=S}else l(this);return M}setupDFS(){this.atomdfs=[];var s=this,c=new Int8Array(this.atoms.length);c.fill(0);for(var w=function(h,S,E){E.push([h,S]);var F=s.atoms[h];c[h]=1;for(var D=0;D<F.bonds.length;D++){var L=F.bonds[D];s.atoms[L]&&!c[L]&&w(L,h,E)}},_=0;_<this.atoms.length;_++){var M=this.atoms[_];if(M&&!c[_]){var l=[];w(_,-1,l),this.atomdfs.push(l)}}}setCoordinatesFromURL(s,c){this.frames=[];var w=this;return this.box&&this.setupDFS(),s.startsWith("http")||(s="http://"+s),(0,k.get)(s+"/traj/numframes/"+c,function(_){if(!isNaN(parseInt(_)))return w.frames.push(w.atoms),w.frames.numFrames=_,w.frames.url=s,w.frames.path=c,w.setFrame(0)})}setCoordinates(s,c){if(c=c||"",!s)return[];if(/\.gz$/.test(c)){c=c.replace(/\.gz$/,"");try{s=(0,k.inflateString)(s)}catch(D){console.log(D)}}var w={mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""};if(w.hasOwnProperty(c)){this.frames=[];for(var _=this.atoms.length,M=C.parseCrd(s,c),l=0;l<M.length;){for(var h=[],S=0;S<_;S++){var E={};for(var F in this.atoms[S])E[F]=this.atoms[S][F];h[S]=E,h[S].x=M[l++],h[S].y=M[l++],h[S].z=M[l++]}this.frames.push(h)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(s){}static parseCrd(s,c){var w=[],_=0;if(c=="pdb")for(var M=s.indexOf(`
ATOM`);M!=-1;){for(;s.slice(M,M+5)==`
ATOM`||s.slice(M,M+7)==`
HETATM`;)w[_++]=parseFloat(s.slice(M+31,M+39)),w[_++]=parseFloat(s.slice(M+39,M+47)),w[_++]=parseFloat(s.slice(M+47,M+55)),M=s.indexOf(`
`,M+54),s.slice(M,M+4)==`
TER`&&(M=s.indexOf(`
`,M+5));M=s.indexOf(`
ATOM`,M)}else if(c=="netcdf"){var l=new P.NetCDFReader(s);w=[].concat.apply([],l.getDataVariable("coordinates"))}else{if(c=="array"||Array.isArray(s))return s.flat(2);{let h=s.indexOf(`
`);c=="inpcrd"&&(h=s.indexOf(`
`,h+1)),s=s.slice(h+1),w=s.match(/\S+/g).map(parseFloat)}}return w}static parseMolData(s,c="",w){if(!s)return[];if(/\.gz$/.test(c)){c=c.replace(/\.gz$/,"");try{c.match(/bcif/i)?s=(0,k.inflateString)(s,!1):s=(0,k.inflateString)(s)}catch(l){console.log(l)}}typeof R.Parsers[c]>"u"&&(c=c.split(".").pop(),typeof R.Parsers[c]>"u"&&(console.log("Unknown format: "+c),s instanceof Uint8Array?c="bcif":s.match(/^@<TRIPOS>MOLECULE/gm)?c="mol2":s.match(/^data_/gm)&&s.match(/^loop_/gm)?c="cif":s.match(/^HETATM/gm)||s.match(/^ATOM/gm)?c="pdb":s.match(/ITEM: TIMESTEP/gm)?c="lammpstrj":s.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?c="sdf":s.match(/^%VERSION\s+VERSION_STAMP/gm)?c="prmtop":c="xyz",console.log("Best guess: "+c)));var _=R.Parsers[c],M=_(s,w);return M}}C.defaultAtomStyle={line:{}},C.defaultlineWidth=1,C.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},C.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"])}),"./src/GLShape.ts":((n,t,r)=>{r.r(t),r.d(t,{GLShape:()=>P,splitMesh:()=>T});var u=r("./src/WebGL/index.ts"),v=r("./src/WebGL/shapes/index.ts"),x=r("./src/WebGL/math/index.ts"),b=r("./src/colors.ts"),p=r("./src/ProteinSurface4.ts"),y=r("./src/VolumeData.ts"),k=r("./src/GLDraw.ts"),g=r("./src/glcartoon.ts"),R=r("./src/utilities.ts");class P{static finalizeGeo(a){var s=a.updateGeoGroup(0);s.vertices>0&&s.truncateArrayBuffers(!0,!0)}static updateColor(a,s){s=s||b.CC.color(s),a.colorsNeedUpdate=!0;var c,w,_;s.constructor!==Array&&(c=s.r,w=s.g,_=s.b);for(let M in a.geometryGroups){let l=a.geometryGroups[M],h=l.colorArray;for(let S=0,E=l.vertices;S<E;++S){if(s.constructor===Array){let F=s[S];c=F.r,w=F.g,_=F.b}h[S*3]=c,h[S*3+1]=w,h[S*3+2]=_}}}static drawArrow(a,s,c){var w=c.start,_=c.end,M=c.radius,l=c.radiusRatio,h=c.mid,S=c.midpos;if(!(w&&_))return;var E=s.updateGeoGroup(51),F=new x.Vector3(_.x,_.y,_.z).sub(w);if(S){let ye=F.length();S>0?h=S/ye:h=(ye+S)/ye}F.multiplyScalar(h);var D=new x.Vector3(w.x,w.y,w.z).add(F),L=F.clone().negate();let V=new x.Vector3(w.x,w.y,w.z);a.intersectionShape.cylinder.push(new v.Cylinder(V,D.clone(),M)),a.intersectionShape.sphere.push(new v.Sphere(V,M));var O=[];O[0]=F.clone(),Math.abs(O[0].x)>1e-4?O[0].y+=1:O[0].x+=1,O[0].cross(F),O[0].normalize(),O[4]=O[0].clone(),O[4].crossVectors(O[0],F),O[4].normalize(),O[8]=O[0].clone().negate(),O[12]=O[4].clone().negate(),O[2]=O[0].clone().add(O[4]).normalize(),O[6]=O[4].clone().add(O[8]).normalize(),O[10]=O[8].clone().add(O[12]).normalize(),O[14]=O[12].clone().add(O[0]).normalize(),O[1]=O[0].clone().add(O[2]).normalize(),O[3]=O[2].clone().add(O[4]).normalize(),O[5]=O[4].clone().add(O[6]).normalize(),O[7]=O[6].clone().add(O[8]).normalize(),O[9]=O[8].clone().add(O[10]).normalize(),O[11]=O[10].clone().add(O[12]).normalize(),O[13]=O[12].clone().add(O[14]).normalize(),O[15]=O[14].clone().add(O[0]).normalize();var W=E.vertices,H=E.vertexArray,q=E.faceArray,U=E.normalArray,B=E.lineArray,Y,X,N;for(X=0,N=O.length;X<N;++X){Y=3*(W+3*X);var J=O[X].clone().multiplyScalar(M).add(w),ae=O[X].clone().multiplyScalar(M).add(D),se=O[X].clone().multiplyScalar(M*l).add(D);if(H[Y]=J.x,H[Y+1]=J.y,H[Y+2]=J.z,H[Y+3]=ae.x,H[Y+4]=ae.y,H[Y+5]=ae.z,H[Y+6]=se.x,H[Y+7]=se.y,H[Y+8]=se.z,X>0){var he=H[Y-3],pe=H[Y-2],de=H[Y-1],ue=new x.Vector3(he,pe,de),ge=new x.Vector3(_.x,_.y,_.z),Re=D.clone(),Ge=new x.Vector3(se.x,se.y,se.z);a.intersectionShape.triangle.push(new v.Triangle(Ge,ge,ue)),a.intersectionShape.triangle.push(new v.Triangle(ue.clone(),Re,Ge.clone()))}}E.vertices+=48,Y=E.vertices*3,H[Y]=w.x,H[Y+1]=w.y,H[Y+2]=w.z,H[Y+3]=D.x,H[Y+4]=D.y,H[Y+5]=D.z,H[Y+6]=_.x,H[Y+7]=_.y,H[Y+8]=_.z,E.vertices+=3;var We,Oe,me,Fe,qe,Qe,st,ot,Ke,Je,Xe,Ne,Ue,ft,ut,ee,ie,oe,we,Se=E.vertices-3,He=E.vertices-2,Be=E.vertices-1,K=Se*3,xe=He*3,Me=Be*3;for(X=0,N=O.length-1;X<N;++X){var $e=W+3*X;Y=$e*3,Oe=E.faceidx,me=E.lineidx,Fe=$e,Je=Fe*3,qe=$e+1,Xe=qe*3,Qe=$e+2,Ne=Qe*3,st=$e+4,Ue=st*3,ot=$e+5,ft=ot*3,Ke=$e+3,ut=Ke*3,ee=ie=O[X],oe=we=O[X+1],U[Je]=ee.x,U[Xe]=ie.x,U[ut]=we.x,U[Je+1]=ee.y,U[Xe+1]=ie.y,U[ut+1]=we.y,U[Je+2]=ee.z,U[Xe+2]=ie.z,U[ut+2]=we.z,U[Xe]=ie.x,U[Ue]=oe.x,U[ut]=we.x,U[Xe+1]=ie.y,U[Ue+1]=oe.y,U[ut+1]=we.y,U[Xe+2]=ie.z,U[Ue+2]=oe.z,U[ut+2]=we.z,U[Ne]=ie.x,U[ft]=oe.x,U[Ne+1]=ie.y,U[ft+1]=oe.y,U[Ne+2]=ie.z,U[ft+2]=oe.z,q[Oe]=Fe,q[Oe+1]=qe,q[Oe+2]=Ke,q[Oe+3]=qe,q[Oe+4]=st,q[Oe+5]=Ke,q[Oe+6]=Fe,q[Oe+7]=Ke,q[Oe+8]=Se,q[Oe+9]=Qe,q[Oe+10]=He,q[Oe+11]=ot,q[Oe+12]=Qe,q[Oe+13]=Be,q[Oe+14]=ot,B[me]=Fe,B[me+1]=qe,B[me+2]=Fe,B[me+3]=Ke,B[me+4]=st,B[me+5]=Ke,B[me+6]=Fe,B[me+7]=Ke,B[me+8]=Qe,B[me+9]=qe,B[me+10]=Qe,B[me+11]=ot,B[me+12]=st,B[me+13]=ot,B[me+14]=Qe,B[me+15]=Be,B[me+16]=Qe,B[me+17]=ot,B[me+18]=Be,B[me+19]=ot,E.faceidx+=15,E.lineidx+=20}We=[W+45,W+46,W+1,W,W+47,W+2],Oe=E.faceidx,me=E.lineidx,Fe=We[0],Je=Fe*3,qe=We[1],Xe=qe*3,Qe=We[4],Ne=Qe*3,st=We[2],Ue=st*3,ot=We[5],ft=ot*3,Ke=We[3],ut=Ke*3,ee=ie=O[15],oe=we=O[0],U[Je]=ee.x,U[Xe]=ie.x,U[ut]=we.x,U[Je+1]=ee.y,U[Xe+1]=ie.y,U[ut+1]=we.y,U[Je+2]=ee.z,U[Xe+2]=ie.z,U[ut+2]=we.z,U[Xe]=ie.x,U[Ue]=oe.x,U[ut]=we.x,U[Xe+1]=ie.y,U[Ue+1]=oe.y,U[ut+1]=we.y,U[Xe+2]=ie.z,U[Ue+2]=oe.z,U[ut+2]=we.z,U[Ne]=ie.x,U[ft]=oe.x,U[Ne+1]=ie.y,U[ft+1]=oe.y,U[Ne+2]=ie.z,U[ft+2]=oe.z,F.normalize(),L.normalize(),U[K]=L.x,U[xe]=U[Me]=F.x,U[K+1]=L.y,U[xe+1]=U[Me+1]=F.y,U[K+2]=L.z,U[xe+2]=U[Me+2]=F.z,q[Oe]=Fe,q[Oe+1]=qe,q[Oe+2]=Ke,q[Oe+3]=qe,q[Oe+4]=st,q[Oe+5]=Ke,q[Oe+6]=Fe,q[Oe+7]=Ke,q[Oe+8]=Se,q[Oe+9]=Qe,q[Oe+10]=He,q[Oe+11]=ot,q[Oe+12]=Qe,q[Oe+13]=Be,q[Oe+14]=ot,B[me]=Fe,B[me+1]=qe,B[me+2]=Fe,B[me+3]=Ke,B[me+4]=st,B[me+5]=Ke,B[me+6]=Fe,B[me+7]=Ke,B[me+8]=Qe,B[me+9]=qe,B[me+10]=Qe,B[me+11]=ot,B[me+12]=st,B[me+13]=ot,B[me+14]=Qe,B[me+15]=Be,B[me+16]=Qe,B[me+17]=ot,B[me+18]=Be,B[me+19]=ot,E.faceidx+=15,E.lineidx+=20}static updateBoundingFromPoints(a,s,c,w){a.center.set(0,0,0);let _=1/0,M=1/0,l=1/0,h=-1/0,S=-1/0,E=-1/0;a.box&&(_=a.box.min.x,h=a.box.max.x,M=a.box.min.y,S=a.box.max.y,l=a.box.min.z,E=a.box.max.z);for(let V=0,O=w;V<O;V++){var F=c[V*3],D=c[V*3+1],L=c[V*3+2];F<_&&(_=F),D<M&&(M=D),L<l&&(l=L),F>h&&(h=F),D>S&&(S=D),L>E&&(E=L)}a.center.set((h+_)/2,(S+M)/2,(E+l)/2),a.radius=a.center.distanceTo({x:h,y:S,z:E}),a.box={min:{x:_,y:M,z:l},max:{x:h,y:S,z:E}}}static addCustomGeo(a,s,c,w,_){var M=s.addGeoGroup(),l=c.vertexArr,h=c.normalArr,S=c.faceArr;M.vertices=l.length,M.faceidx=S.length;var E,F,D,L,V,O,W,H,q,U=M.vertexArray,B=M.colorArray;for(w.constructor!==Array&&(H=w.r,q=w.g,L=w.b),O=0,W=M.vertices;O<W;++O)E=O*3,F=l[O],U[E]=F.x,U[E+1]=F.y,U[E+2]=F.z,w.constructor===Array&&(V=w[O],H=V.r,q=V.g,L=V.b),B[E]=H,B[E+1]=q,B[E+2]=L;if(_)for(O=0,W=M.faceidx/3;O<W;++O){E=O*3,D=S[E],L=S[E+1],V=S[E+2];var Y=new x.Vector3,X=new x.Vector3,N=new x.Vector3;a.intersectionShape.triangle.push(new v.Triangle(Y.copy(l[D]),X.copy(l[L]),N.copy(l[V])))}if(_){var J=new x.Vector3(0,0,0),ae=0;for(let pe=0;pe<s.geometryGroups.length;pe++)J.add(s.geometryGroups[pe].getCentroid()),ae++;J.divideScalar(ae),P.updateBoundingFromPoints(a.boundingSphere,{centroid:J},U,M.vertices)}if(M.faceArray=new Uint16Array(S),M.truncateArrayBuffers(!0,!0),h.length<M.vertices)M.setNormals();else{var se=M.normalArray=new Float32Array(M.vertices*3),he;for(O=0,W=M.vertices;O<W;++O)E=O*3,he=h[O],se[E]=he.x,se[E+1]=he.y,se[E+2]=he.z}M.setLineIndices(),M.lineidx=M.lineArray.length}static updateFromStyle(a,s){typeof s.color<"u"?(a.color=s.color||new b.Color,s.color instanceof b.Color||(a.color=b.CC.color(s.color))):a.color=b.CC.color(0),a.wireframe=!!s.wireframe,a.opacity=s.alpha?(0,x.clamp)(s.alpha,0,1):1,typeof s.opacity<"u"&&(a.opacity=(0,x.clamp)(s.opacity,0,1)),a.side=s.side!==void 0?s.side:u.DoubleSide,a.linewidth=typeof s.linewidth>"u"?1:s.linewidth,a.clickable=!!s.clickable,a.callback=(0,R.makeFunction)(s.callback),a.hoverable=!!s.hoverable,a.hover_callback=(0,R.makeFunction)(s.hover_callback),a.unhover_callback=(0,R.makeFunction)(s.unhover_callback),a.contextMenuEnabled=!!s.contextMenuEnabled,a.hidden=s.hidden,a.frame=s.frame}constructor(a){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=u.DoubleSide,this.stylespec=a||{},this.boundingSphere=new v.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},P.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new u.Geometry(!0),this.linegeo=new u.Geometry(!0)}updateStyle(a){for(var s in a)this.stylespec[s]=a[s];if(P.updateFromStyle(this,this.stylespec),a.voldata&&a.volscheme){(0,R.adjustVolumeStyle)(a);const c=a.volscheme,w=a.voldata,_=b.CC,M=c.range()||[-1,1];this.geo.setColors(function(l,h,S){let E=w.getVal(l,h,S);return _.color(c.valueToHex(E,M))}),delete this.color}}addCustom(a){a.vertexArr=a.vertexArr||[],a.faceArr=a.faceArr||[],a.normalArr=a.normalArr||[],P.drawCustom(this,this.geo,a)}addSphere(a){a.center||(a.center=new x.Vector3(0,0,0)),a.radius=a.radius?(0,x.clamp)(a.radius,0,1/0):1.5,a.color=b.CC.color(a.color),this.intersectionShape.sphere.push(new v.Sphere(a.center,a.radius)),k.GLDraw.drawSphere(this.geo,a.center,a.radius,a.color,a.quality),this.components.push({centroid:new x.Vector3(a.center.x,a.center.y,a.center.z)});var s=this.geo.updateGeoGroup(0);P.updateBoundingFromPoints(this.boundingSphere,this.components,s.vertexArray,s.vertices)}addBox(a){var s=a.dimensions||{w:1,h:1,d:1},c;typeof s.w=="number"?c={x:s.w,y:0,z:0}:c=s.w;var w;typeof s.h=="number"?w={x:0,y:s.h,z:0}:w=s.h;var _;typeof s.d=="number"?_={x:0,y:0,z:s.d}:_=s.d;var M=a.corner;M==null&&(a.center!==void 0?M={x:a.center.x-.5*(c.x+w.x+_.x),y:a.center.y-.5*(c.y+w.y+_.y),z:a.center.z-.5*(c.z+w.z+_.z)}:M={x:0,y:0,z:0});var l=[{x:M.x,y:M.y,z:M.z},{x:M.x+c.x,y:M.y+c.y,z:M.z+c.z},{x:M.x+w.x,y:M.y+w.y,z:M.z+w.z},{x:M.x+c.x+w.x,y:M.y+c.y+w.y,z:M.z+c.z+w.z},{x:M.x+_.x,y:M.y+_.y,z:M.z+_.z},{x:M.x+c.x+_.x,y:M.y+c.y+_.y,z:M.z+c.z+_.z},{x:M.x+w.x+_.x,y:M.y+w.y+_.y,z:M.z+w.z+_.z},{x:M.x+c.x+w.x+_.x,y:M.y+c.y+w.y+_.y,z:M.z+c.z+w.z+_.z}],h=[],S=[];h.splice(h.length,0,l[0],l[1],l[2],l[3]),S.splice(S.length,0,0,2,1,1,2,3);var E=4;h.splice(h.length,0,l[2],l[3],l[6],l[7]),S.splice(S.length,0,E+0,E+2,E+1,E+1,E+2,E+3),E+=4,h.splice(h.length,0,l[4],l[5],l[0],l[1]),S.splice(S.length,0,E+0,E+2,E+1,E+1,E+2,E+3),E+=4,h.splice(h.length,0,l[6],l[7],l[4],l[5]),S.splice(S.length,0,E+0,E+2,E+1,E+1,E+2,E+3),E+=4,h.splice(h.length,0,l[3],l[1],l[7],l[5]),S.splice(S.length,0,E+0,E+2,E+1,E+1,E+2,E+3),E+=4,h.splice(h.length,0,l[2],l[6],l[0],l[4]),S.splice(S.length,0,E+0,E+2,E+1,E+1,E+2,E+3),E+=4;var F=(0,R.extend)({},a);F.vertexArr=h,F.faceArr=S,F.normalArr=[],P.drawCustom(this,this.geo,F);var D=new x.Vector3;this.components.push({centroid:D.addVectors(l[0],l[7]).multiplyScalar(.5)});var L=this.geo.updateGeoGroup(0);P.updateBoundingFromPoints(this.boundingSphere,this.components,L.vertexArray,L.vertices)}addCylinder(a){var s,c;a.start?s=new x.Vector3(a.start.x||0,a.start.y||0,a.start.z||0):s=new x.Vector3(0,0,0),a.end?(c=new x.Vector3(a.end.x,a.end.y||0,a.end.z||0),typeof c.x>"u"&&(c.x=3)):c=new x.Vector3(0,0,0);var w=a.radius||.1,_=b.CC.color(a.color);this.intersectionShape.cylinder.push(new v.Cylinder(s,c,w)),k.GLDraw.drawCylinder(this.geo,s,c,w,_,a.fromCap,a.toCap);var M=new x.Vector3;this.components.push({centroid:M.addVectors(s,c).multiplyScalar(.5)});var l=this.geo.updateGeoGroup(0);P.updateBoundingFromPoints(this.boundingSphere,this.components,l.vertexArray,l.vertices)}addDashedCylinder(a){a.dashLength=a.dashLength||.25,a.gapLength=a.gapLength||.25;var s;a.start?s=new x.Vector3(a.start.x||0,a.start.y||0,a.start.z||0):s=new x.Vector3(0,0,0);var c;a.end?(c=new x.Vector3(a.end.x,a.end.y||0,a.end.z||0),typeof c.x>"u"&&(c.x=3)):c=new x.Vector3(3,0,0);for(var w=a.radius||.1,_=b.CC.color(a.color),M=Math.sqrt(Math.pow(s.x-c.x,2)+Math.pow(s.y-c.y,2)+Math.pow(s.z-c.z,2)),l=M/(a.gapLength+a.dashLength),h=new x.Vector3(a.start.x||0,a.start.y||0,a.start.z||0),S=new x.Vector3(a.end.x,a.end.y||0,a.end.z||0),E=new x.Vector3((c.x-s.x)/(M/a.gapLength),(c.y-s.y)/(M/a.gapLength),(c.z-s.z)/(M/a.gapLength)),F=new x.Vector3((c.x-s.x)/(M/a.dashLength),(c.y-s.y)/(M/a.dashLength),(c.z-s.z)/(M/a.dashLength)),D=0;D<l;D++)S=new x.Vector3(h.x+F.x,h.y+F.y,h.z+F.z),this.intersectionShape.cylinder.push(new v.Cylinder(h,S,w)),k.GLDraw.drawCylinder(this.geo,h,S,w,_,a.fromCap,a.toCap),h=new x.Vector3(S.x+E.x,S.y+E.y,S.z+E.z);var L=new x.Vector3;this.components.push({centroid:L.addVectors(s,c).multiplyScalar(.5)});var V=this.geo.updateGeoGroup(0);P.updateBoundingFromPoints(this.boundingSphere,this.components,V.vertexArray,V.vertices)}addCurve(a){a.points=a.points||[],a.smooth=a.smooth||10,typeof a.fromCap>"u"&&(a.fromCap=2),typeof a.toCap>"u"&&(a.toCap=2);var s=(0,g.subdivide_spline)(a.points,a.smooth);if(s.length<3){console.log("Too few points in addCurve");return}var c=a.radius||.1,w=b.CC.color(a.color),_=0,M=s.length-1,l=s[0].distanceTo(s[1]),h=Math.ceil(2*c/l);if(a.toArrow){M-=h;let D={start:s[M],end:s[s.length-1],radius:c,color:w,mid:1e-4};this.addArrow(D)}if(a.fromArrow){_+=h;let D={start:s[_],end:s[0],radius:c,color:w,mid:1e-4};this.addArrow(D)}for(var S=Math.ceil(s.length/2),E={radius:c,color:w,fromCap:2,toCap:2},F=_;F<M;F++)E.start=s[F],E.end=s[F+1],E.fromCap=2,E.toCap=2,F<S?(E.fromCap=2,E.toCap=0):F>S?(E.fromCap=0,E.toCap=2):(E.fromCap=2,E.toCap=2),this.addCylinder(E)}addLine(a){var s,c;a.start?s=new x.Vector3(a.start.x||0,a.start.y||0,a.start.z||0):s=new x.Vector3(0,0,0),a.end?(c=new x.Vector3(a.end.x,a.end.y||0,a.end.z||0),typeof c.x>"u"&&(c.x=3)):c=new x.Vector3(3,0,0);var w=this.geo.updateGeoGroup(2),_=w.vertices,M=_*3,l=w.vertexArray;l[M]=s.x,l[M+1]=s.y,l[M+2]=s.z,l[M+3]=c.x,l[M+4]=c.y,l[M+5]=c.z,w.vertices+=2;var h=w.lineArray,S=w.lineidx;h[S]=_,h[S+1]=_+1,w.lineidx+=2;var E=new x.Vector3;this.components.push({centroid:E.addVectors(s,c).multiplyScalar(.5)}),w=this.geo.updateGeoGroup(0),P.updateBoundingFromPoints(this.boundingSphere,this.components,w.vertexArray,w.vertices)}addArrow(a){if(a.start?a.start=new x.Vector3(a.start.x||0,a.start.y||0,a.start.z||0):a.start=new x.Vector3(0,0,0),a.dir instanceof x.Vector3&&typeof a.length=="number"){var s=a.dir.clone().multiplyScalar(a.length).add(a.start);a.end=s}else a.end?(a.end=new x.Vector3(a.end.x,a.end.y||0,a.end.z||0),typeof a.end.x>"u"&&(a.end.x=3)):a.end=new x.Vector3(3,0,0);a.radius=a.radius||.1,a.radiusRatio=a.radiusRatio||1.618034,a.mid=0<a.mid&&a.mid<1?a.mid:.618034,P.drawArrow(this,this.geo,a);var c=new x.Vector3;this.components.push({centroid:c.addVectors(a.start,a.end).multiplyScalar(.5)});var w=this.geo.updateGeoGroup(0);P.updateBoundingFromPoints(this.boundingSphere,this.components,w.vertexArray,w.vertices)}static distance_from(a,s){return Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2)+Math.pow(a.z-s.z,2))}static inSelectedRegion(a,s,c){for(var w=0;w<s.length;w++)if(P.distance_from(s[w],a)<=c)return!0;return!1}addIsosurface(a,s,c,w){var _=s.isoval!==void 0&&typeof s.isoval=="number"?s.isoval:0,M=!!s.voxel,l=s.smoothness===void 0?1:s.smoothness,h=a.size.x,S=a.size.y,E=a.size.z,F=new Int16Array(h*S*E),D=a.data,L,V;for(L=0,V=F.length;L<V;++L)F[L]=-1;var O=new Uint8Array(h*S*E);for(L=0,V=D.length;L<V;++L){var W=_>=0?D[L]-_:_-D[L];W>0&&(O[L]|=P.ISDONE)}var H=[],q=[];p.MarchingCube.march(O,H,q,{fulltable:!0,voxel:M,unitCube:a.unit,origin:a.origin,matrix:a.matrix,nX:h,nY:S,nZ:E}),!M&&l>0&&p.MarchingCube.laplacianSmooth(l,H,q);var U=[],B=[],Y=[];if(s.selectedRegion&&s.coords===void 0&&(s.coords=s.selectedRegion),s.coords===void 0&&s.selection!==void 0&&(w?s.coords=w.selectedAtoms(s.selection):console.log("addIsosurface needs viewer is selection provided.")),s.coords!==void 0){var X=s.coords[0].x,N=s.coords[0].y,J=s.coords[0].z,ae=s.coords[0].x,se=s.coords[0].y,he=s.coords[0].z;for(let me=0;me<s.coords.length;me++)s.coords[me].x>X?X=s.coords[me].x:s.coords[me].x<ae&&(ae=s.coords[me].x),s.coords[me].y>N?N=s.coords[me].y:s.coords[me].y<se&&(se=s.coords[me].y),s.coords[me].z>J?J=s.coords[me].z:s.coords[me].z<he&&(he=s.coords[me].z);var pe=2;s.radius!==void 0&&(pe=s.radius),s.selectedOffset!==void 0&&(pe=s.selectedOffset),s.seldist!==void 0&&(pe=s.seldist),ae-=pe,X+=pe,se-=pe,N+=pe,he-=pe,J+=pe;for(let me=0;me<H.length;me++)H[me].x>ae&&H[me].x<X&&H[me].y>se&&H[me].y<N&&H[me].z>he&&H[me].z<J&&P.inSelectedRegion(H[me],s.coords,pe)?(U.push(B.length),B.push(H[me])):U.push(-1);for(let me=0;me+2<q.length;me+=3)U[q[me]]!==-1&&U[q[me+1]]!==-1&&U[q[me+2]]!==-1&&(Y.push(q[me]-(q[me]-U[q[me]])),Y.push(q[me+1]-(q[me+1]-U[q[me+1]])),Y.push(q[me+2]-(q[me+2]-U[q[me+2]])));H=B,q=Y}P.drawCustom(this,this.geo,{vertexArr:H,faceArr:q,normalArr:[],clickable:s.clickable,hoverable:s.hoverable}),this.updateStyle(s);var de=new x.Vector3(a.origin.x,a.origin.y,a.origin.z),ue=new x.Vector3(a.size.x*a.unit.x,a.size.y*a.unit.y,a.size.z*a.unit.z),ge=new x.Vector3(0,0,0),Re=de.clone(),Ge=de.clone().add(ue);for(let me=0;me<H.length;me++)ge.add(H[me]),Re.max(H[me]),Ge.min(H[me]);ge.divideScalar(H.length);var We=ge.distanceTo(Ge),Oe=ge.distanceTo(Re);this.boundingSphere.center=ge,this.boundingSphere.radius=Math.max(We,Oe),typeof c=="function"&&c()}addVolumetricData(a,s,c){a=new y.VolumeData(a,s),this.addIsosurface(a,c)}finalize(){return P.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj(a){if(this.renderedShapeObj&&(a.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){P.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),typeof this.color<"u"&&P.updateColor(this.geo,this.color),this.shapeObj=new u.Object3D;var s=null;this.side==u.DoubleSide?s=new u.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:u.Coloring.VertexColors}):s=new u.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:u.Coloring.VertexColors});var c=new u.Mesh(this.geo,s);if(this.shapeObj.add(c),this.linegeo&&this.linegeo.vertices>0){var w=new u.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),_=new u.Line(this.linegeo,w,u.LineStyle.LinePieces);this.shapeObj.add(_)}this.renderedShapeObj=this.shapeObj.clone(),a.add(this.renderedShapeObj)}}removegl(a){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),a.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}P.ISDONE=2,P.drawCustom=function(C,a,s){var c=s,w=c.vertexArr,_=c.faceArr;(w.length===0||_.length===0)&&console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var M=s.color;typeof M>"u"&&(M=C.color),M=b.CC.color(M);for(var l=T(c),h=0,S=l.length;h<S;h++)P.addCustomGeo(C,a,l[h],l[h].colorArr?l[h].colorArr:M,s.clickable)};function T(C){var a=64e3;if(C.vertexArr.length<a)return[C];var s=[{vertexArr:[],normalArr:[],faceArr:[]}];C.colorArr&&(s.colorArr=[]);var c=[],w=[],_=0,M=C.faceArr;for(let h=0,S=M.length;h<S;h+=3){let E=s[_];for(let F=0;F<3;F++){var l=M[h+F];c[l]!==_&&(c[l]=_,w[l]=E.vertexArr.length,E.vertexArr.push(C.vertexArr[l]),C.normalArr&&C.normalArr[l]&&E.normalArr.push(C.normalArr[l]),C.colorArr&&C.colorArr[l]&&E.colorArr.push(C.colorArr[l])),E.faceArr.push(w[l])}E.vertexArr.length>=a&&(s.push({vertexArr:[],normalArr:[],faceArr:[]}),C.colorArr&&(s.colorArr=[]),_++)}return s}}),"./src/GLViewer.ts":((n,t,r)=>{r.r(t),r.d(t,{CONTEXTS_PER_VIEWPORT:()=>a,GLViewer:()=>s,createStereoViewer:()=>_,createViewer:()=>c,createViewerGrid:()=>w});var u=r("./src/WebGL/index.ts"),v=r("./src/WebGL/math/index.ts"),x=r("./src/colors.ts"),b=r("./src/utilities.ts"),p=r("./src/Gradient.ts"),y=r("./src/GLModel.ts"),k=r("./src/Label.ts"),g=r("./src/GLShape.ts"),R=r("./src/VolumeData.ts"),P=r("./src/ProteinSurface4.ts"),T=r("./src/VolumetricRender.ts"),C=r("./node_modules/upng-js/UPNG.js");const a=16;class s{getWidth(){let l=this.container,h=l.offsetWidth;if(h==0&&l.style.display==="none"){let S=l.style.position,E=l.style.visibility;l.style.display="block",l.style.visibility="hidden",l.style.position="absolute",h=l.offsetWidth,l.style.display="none",l.style.visibility=E,l.style.position=S}return h}getHeight(){let l=this.container,h=l.offsetHeight;if(h==0&&l.style.display==="none"){let S=l.style.position,E=l.style.visibility;l.style.display="block",l.style.visibility="hidden",l.style.position="absolute",h=l.offsetHeight,l.style.display="none",l.style.visibility=E,l.style.position=S}return h}setupRenderer(){this.renderer=new u.Renderer({antialias:this.config.antialias,preserveDrawingBuffer:!0,premultipliedAlpha:!1,id:this.config.id,row:this.config.row,col:this.config.col,rows:this.config.rows,cols:this.config.cols,canvas:this.config.canvas,containerWidth:this.WIDTH,containerHeight:this.HEIGHT,ambientOcclusion:this.config.ambientOcclusion,outline:this.config.outline}),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new u.Scene,this.scene.fog=new u.Fog(this.bgColor,100,200),this.modelGroup=new u.Object3D,this.rotationGroup=new u.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new v.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var l=new u.Light(16777215);l.position=new v.Vector3(.2,.2,1).normalize(),l.intensity=1,this.scene.add(l)}_handleLostContext(l){const h=function(S){const E=S.getBoundingClientRect();return!(E.right<0||E.bottom<0||E.top>(window.innerHeight||document.documentElement.clientHeight)||E.left>(window.innerWidth||document.documentElement.clientWidth))};if(h(this.container)){let S=0;for(let E of document.getElementsByTagName("canvas"))if(h(E)&&E._3dmol_viewer!=null&&(E._3dmol_viewer.resize(),S+=1,S>=a))break}}initContainer(l){this.container=l,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var l=0;for(let S in this.surfaces)if(this.surfaces.hasOwnProperty(S)){var h=parseInt(S);isNaN(h)||h>l&&(l=h)}return l+1}setSlabAndFog(){let l=this.camera.position.z-this.rotationGroup.position.z;l<1&&(l=1),this.camera.near=l+this.slabNear,this.camera.near<1&&(this.camera.near=1),this.camera.far=l+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=l*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.far,this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(l){if(this.renderer.setViewport(),!!this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!l&&this.linkedViewers.length>0))for(var h=this._viewer.getView(),S=0;S<this.linkedViewers.length;S++){var E=this.linkedViewers[S];E.setView(h,!0)}}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let l=0,h=this.models.length;l<h;l++){let S=this.models[l];if(S){let E=S.selectedAtoms({clickable:!0}),F=S.selectedAtoms({hoverable:!0}),D=S.selectedAtoms({contextMenuEnabled:!0});for(let L=0;L<F.length;L++)this.hoverables.push(F[L]);for(let L=0;L<E.length;L++)this.clickables.push(E[L]);for(let L=0;L<D.length;L++)this.contextMenuEnabledObjects.push(D[L])}}for(let l=0,h=this.shapes.length;l<h;l++){let S=this.shapes[l];S&&S.clickable&&this.clickables.push(S),S&&S.hoverable&&this.hoverables.push(S),S&&S.contextMenuEnabled&&this.contextMenuEnabledObjects.push(S)}}handleClickSelection(l,h,S){let E=this.targetedObjects(l,h,this.clickables);if(E.length){var F=E[0].clickable;F.callback!==void 0&&(typeof F.callback!="function"&&(F.callback=(0,b.makeFunction)(F.callback)),typeof F.callback=="function"&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(F)&&this.userContextMenuHandler||F.callback(F,this._viewer,S,this.container,E)))}}canvasOffset(){let l=this.glDOM,h=l.getBoundingClientRect(),S=l.ownerDocument,E=S.documentElement,F=S.defaultView;return{top:h.top+F.pageYOffset-E.clientTop,left:h.left+F.pageXOffset-E.clientLeft}}setHover(l,h,S){this.current_hover!=l&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,b.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,h,this.container,S)),this.current_hover=l,l&&l.hover_callback!==void 0&&(typeof l.hover_callback!="function"&&(l.hover_callback=(0,b.makeFunction)(l.hover_callback)),typeof l.hover_callback=="function"&&l.hover_callback(l,this._viewer,h,this.container,S)))}handleHoverSelection(l,h,S){if(this.hoverables.length==0)return;let E=this.targetedObjects(l,h,this.hoverables);if(E.length){var F=E[0].clickable;this.setHover(F,S,E),this.current_hover=F}else this.setHover(null)}handleHoverContinue(l,h){let S=this.targetedObjects(l,h,this.hoverables);(S.length==0||S[0]===void 0)&&this.setHover(null),S[0]!==void 0&&S[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(l,{allowTolerance:h=l.targetTouches,tolerance:S=5}={}){const E=this.getX(l),F=this.getY(l);if(h){const D=Math.abs(E-this.mouseStartX),L=Math.abs(F-this.mouseStartY);return D<=S&&L<=S}else return E===this.mouseStartX&&F===this.mouseStartY}calcTouchDistance(l){var h=l.targetTouches[0].pageX-l.targetTouches[1].pageX,S=l.targetTouches[0].pageY-l.targetTouches[1].pageY;return Math.hypot(h,S)}getX(l){var h=l.pageX;return h==null&&(h=l.pageX),l.targetTouches&&l.targetTouches[0]?h=l.targetTouches[0].pageX:l.changedTouches&&l.changedTouches[0]&&(h=l.changedTouches[0].pageX),h}getY(l){var h=l.pageY;return h==null&&(h=l.pageY),l.targetTouches&&l.targetTouches[0]?h=l.targetTouches[0].pageY:l.changedTouches&&l.changedTouches[0]&&(h=l.changedTouches[0].pageY),h}isInViewer(l,h){if(this.viewers!=null){var S=this.WIDTH/this.cols,E=this.HEIGHT/this.rows,F=this.canvasOffset(),D=l-F.left,L=h-F.top,V=this.rows-Math.floor(L/E)-1,O=Math.floor(D/S);if(V!=this.row||O!=this.col)return!1}return!0}adjustZoomToLimits(l){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let h=this.CAMERA_Z-this.config.lowerZoomLimit;l>h&&(l=h)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let h=this.CAMERA_Z-this.config.upperZoomLimit;l<h&&(l=h)}return l>this.CAMERA_Z-1&&(l=this.CAMERA_Z-1),l}static slerp(l,h,S){if(S==1)return h.clone();if(S==0)return l.clone();let E=l.x*h.x+l.y*h.y+l.z*h.z+l.w*h.w;if(E>.9995){let H=new v.Quaternion(l.x+S*(h.x-l.x),l.y+S*(h.y-l.y),l.z+S*(h.z-l.z),l.w+S*(h.w-l.w));return H.normalize(),H}E<0&&(h=h.clone().multiplyScalar(-1),E=-E),E>1?E=1:E<-1&&(E=-1);var F=Math.acos(E),D=F*S,L=h.clone();L.sub(l.clone().multiplyScalar(E)),L.normalize();var V=Math.cos(D),O=Math.sin(D),W=new v.Quaternion(l.x*V+L.x*O,l.y*V+L.y*O,l.z*V+L.z*O,l.w*V+L.w*O);return W.normalize(),W}constructor(l,h={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.slabNear=-50,this.slabFar=50,this.cq=new v.Quaternion(0,0,0,1),this.dq=new v.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=h,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=x.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",typeof this.config.backgroundColor<"u"&&(this.bgColor=x.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,typeof this.config.camerax<"u"&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=l,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new u.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new v.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new v.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new u.Raycaster(new v.Vector3(0,0,0),new v.Vector3(0,0,0)),this.projector=new u.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=x.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),typeof window.ResizeObserver<"u"&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),typeof window.IntersectionObserver<"u"){let S=(E,F)=>{E.forEach(D=>{D.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(S),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(S){console.log("error with glviewer callback: "+S)}}targetedObjects(l,h,S){var E={x:l,y:h,z:-1};return Array.isArray(S)||(S=this.selectedAtoms(S)),S.length==0?[]:(this.raycaster.setFromCamera(E,this.camera),this.raycaster.intersectObjects(this.modelGroup,S))}modelToScreen(l){let h=!1;Array.isArray(l)||(l=[l],h=!0);let S=this.renderer.getXRatio(),E=this.renderer.getYRatio(),F=this.col,D=this.row,L=F*(this.WIDTH/S),V=(E-D-1)*(this.HEIGHT/E),O=[],W=this.canvasOffset();return l.forEach(H=>{let q=new v.Vector3(H.x,H.y,H.z);q.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector(q,this.camera);let U=this.WIDTH/S*(q.x+1)/2+W.left+L,B=-(this.HEIGHT/E)*(q.y-1)/2+W.top+V;O.push({x:U,y:B})}),h&&(O=O[0]),O}screenOffsetToModel(l,h,S){var E=l/this.WIDTH,F=h/this.HEIGHT,D=S===void 0?this.rotationGroup.position.z:S,L=this.rotationGroup.quaternion,V=new v.Vector3(0,0,D);return this.projector.projectVector(V,this.camera),V.x+=E*2,V.y-=F*2,this.projector.unprojectVector(V,this.camera),V.z=0,V.applyQuaternion(L),V}screenToModelDistance(l,h){let S=this.canvasOffset(),E=new v.Vector3(h.x,h.y,h.z);E.applyMatrix4(this.modelGroup.matrixWorld);let F=E.clone();this.projector.projectVector(E,this.camera);let D=new v.Vector3((l.x-S.left)*2/this.WIDTH-1,(l.y-S.top)*2/-this.HEIGHT+1,E.z);return this.projector.unprojectVector(D,this.camera),D.distanceTo(F)}setViewChangeCallback(l){(typeof l=="function"||l==null)&&(this.viewChangeCallback=l)}setStateChangeCallback(l){(typeof l=="function"||l==null)&&(this.stateChangeCallback=l)}getConfig(){return this.config}setConfig(l){this.config=l,l.ambientOcclusion&&this.renderer.enableAmbientOcclusion(l.ambientOcclusion)}getInternalState(){var l={models:[],surfaces:[],shapes:[],labels:[]};for(let h=0;h<this.models.length;h++)this.models[h]&&(l.models[h]=this.models[h].getInternalState());return l}setInternalState(l){this.clear();var h=l.models;for(let S=0;S<h.length;S++)h[S]&&(this.models[S]=new y.GLModel(S),this.models[S].setInternalState(h[S]));this.render()}setZoomLimits(l,h){typeof l<"u"&&(this.config.lowerZoomLimit=l),h&&(this.config.upperZoomLimit=h),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(l){l.fov!==void 0&&(this.fov=l.fov,this.camera.fov=this.fov),l.z!==void 0&&(this.CAMERA_Z=l.z,this.camera.z=this.CAMERA_Z),l.orthographic!==void 0&&(this.camera.ortho=l.orthographic)}_handleMouseDown(l){if(l.preventDefault(),!this.scene)return;var h=this.getX(l),S=this.getY(l);if(h===void 0)return;this.isDragging=!0,this.mouseButton=l.which,this.mouseStartX=h,this.mouseStartY=S,this.touchHold=!0,this.touchDistanceStart=0,l.targetTouches&&l.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(l)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let E=this;l.targetTouches&&l.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(E.touchHold==!0){E.glDOM=E.renderer.domElement;const F=l.targetTouches[0],D=new PointerEvent("contextmenu",Object.assign(Object.assign({},l),{pageX:F.pageX,pageY:F.pageY,screenX:F.screenX,screenY:F.screenY,clientX:F.clientX,clientY:F.clientY}));E.glDOM.dispatchEvent(D)}},this.longTouchDuration))}_handleMouseUp(l){if(this.touchHold=!1,this.isDragging&&this.scene){var h=this.getX(l),S=this.getY(l);if(this.closeEnoughForClick(l)&&this.isInViewer(h,S)){let E=this.mouseXY(h,S);this.handleClickSelection(E.x,E.y,l)}}this.isDragging=!1}_handleMouseScroll(l){if(l.preventDefault(),!!this.scene){var h=this.getX(l),S=this.getY(l);if(h!==void 0&&!(!this.control_all&&!this.isInViewer(h,S))){var E=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,F=1;if(l.ctrlKey&&(F=-1),l.detail)this.rotationGroup.position.z+=F*E*l.detail/10;else if(l.wheelDelta){let D=l.wheelDelta*600/(l.wheelDelta+600);this.rotationGroup.position.z-=F*E*D/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(l){let h=this;return l=l||1,new Promise(function(S){let E=0,F=h.viewChangeCallback,D=[],L=[],V=Date.now();h.viewChangeCallback=function(){L.push(Date.now()-V),V=Date.now(),D.push(new Promise(O=>{h.getCanvas().toBlob(function(W){W.arrayBuffer().then(O)},"image/png")})),E+=1,E==l&&(h.viewChangeCallback=F,Promise.all(D).then(O=>{let W=[];for(let X=0;X<O.length;X++){let N=(0,C.decode)(O[X]);W.push((0,C.toRGBA8)(N)[0])}let H=h.getCanvas().width,q=h.getCanvas().height,U=(0,C.encode)(W,H,q,0,L),B=new Blob([U],{type:"image/png"}),Y=new FileReader;Y.onload=function(X){S(X.target.result)},Y.readAsDataURL(B)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(l){this.hoverDuration=l}mouseXY(l,h){let S=this.canvasOffset(),E=this.renderer.getXRatio(),F=this.renderer.getYRatio(),D=this.col,L=this.row,V=D*(this.WIDTH/E),O=(F-L-1)*(this.HEIGHT/F),W=(l-S.left-V)/(this.WIDTH/E)*2-1,H=-((h-S.top-O)/(this.HEIGHT/F))*2+1;return{x:W,y:H}}_handleMouseMove(l){clearTimeout(this.hoverTimeout),l.preventDefault();let h=this.getX(l),S=this.getY(l);if(h===void 0)return;let E=this.renderer.getXRatio(),F=this.renderer.getYRatio(),D=this.mouseXY(h,S),L=this;this.current_hover!==null&&this.handleHoverContinue(D.x,D.y);var V=0;if(!(!this.control_all&&!this.isInViewer(h,S))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){L.handleHoverSelection(D.x,D.y,l)},this.hoverDuration)),!!this.isDragging)){l.targetTouches&&(l.targetTouches.length>1||l.targetTouches.length===1&&!this.closeEnoughForClick(l))&&clearTimeout(this.longTouchTimeout);var O=(h-this.mouseStartX)/this.WIDTH,W=(S-this.mouseStartY)/this.HEIGHT;if(this.touchDistanceStart!=0&&l.targetTouches&&l.targetTouches.length==2){var H=this.calcTouchDistance(l);V=2,W=(H-this.touchDistanceStart)*2/(this.WIDTH+this.HEIGHT)}else l.targetTouches&&l.targetTouches.length==3&&(V=1);O*=E,W*=F;var q=Math.hypot(O,W),U;if(V==3||this.mouseButton==3&&l.ctrlKey)this.slabNear=this.cslabNear+O*100,this.slabFar=this.cslabFar-W*100;else if(V==2||this.mouseButton==3||l.shiftKey)U=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,U<80&&(U=80),this.rotationGroup.position.z=this.cz+W*U,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(V==1||this.mouseButton==2||l.ctrlKey){var B=this.screenOffsetToModel(E*(h-this.mouseStartX),F*(S-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,B)}else if((V===0||this.mouseButton==1)&&q!==0){var Y=Math.sin(q*Math.PI)/q;this.dq.x=Math.cos(q*Math.PI),this.dq.y=0,this.dq.z=Y*O,this.dq.w=-Y*W,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(l){if(l.preventDefault(),this.closeEnoughForClick(l)){var E=this.mouseStartX,F=this.mouseStartY,S=this.canvasOffset();let D=this.mouseXY(E,F),L=D.x,V=D.y,O=this.targetedObjects(L,V,this.contextMenuEnabledObjects);var h=null;O.length&&(h=O[0].clickable);var S=this.canvasOffset(),E=this.mouseStartX-S.left,F=this.mouseStartY-S.top;this.userContextMenuHandler&&(this.userContextMenuHandler(h,E,F,O,l),this.isDragging=!1)}}setContainer(l){let h=(0,b.getElement)(l)||this.container;return this.initContainer(h),this}setBackgroundColor(l,h){(typeof h>"u"||h<0||h>1)&&(h=1);var S=x.CC.color(l);return this.scene.fog.color=S,this.bgColor=S.getHex(),this.renderer.setClearColorHex(S.getHex(),h),this.show(),this}setProjection(l){this.camera.ortho=l==="orthographic",this.setSlabAndFog()}setViewStyle(l){if(l=l||{},l.style=l.style||"",l.style.includes("outline")){var h={};l.color&&(h.color=x.CC.color(l.color)),l.width&&(h.width=l.width),this.renderer.enableOutline(h)}else this.renderer.disableOutline();if(l.style.includes("ambientOcclusion")){var h={};l.strength&&(h.strength=l.strength),l.radius&&(h.radius=l.radius),this.renderer.enableAmbientOcclusion(h)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(l){return this.WIDTH=l||this.WIDTH,this.updateSize(),this}setHeight(l){return this.HEIGHT=l||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let l=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let h=!1,S=this.container.querySelector("canvas");S&&S!=this.renderer.getCanvas()?this.config.canvas=S:(S.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,h=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),l=!0,h&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),l){let h=this.renderer.supportedExtensions();if(h.regen=!0,this.viewers)for(let S=0,E=this.viewers.length;S<E;S++)for(let F=0,D=this.viewers[S].length;F<D;F++)this.viewers[S][F].render(null,h);this._viewer.render(null,h)}else this.show();return this}getModel(l){return l===void 0?this.models.length==0?null:this.models[this.models.length-1]:l instanceof y.GLModel?l:l in this.models?this.models[l]:this.models.length==0?null:this.models[this.models.length-1]}spin(l,h=1){if(clearInterval(this.spinInterval),typeof l>"u"&&(l="y"),typeof l=="boolean")if(l)l="y";else return;Array.isArray(l)&&(l={x:l[0],y:l[1],z:l[2]});var S=this;this.spinInterval=setInterval(function(){!S.getCanvas().isConnected&&S.renderer.isLost()&&clearInterval(S.spinInterval),S.rotate(1*h,l)},25)}animateMotion(l,h,S,E,F,D){var L=20,V=Math.ceil(l/L);V<1&&(V=1),this.incAnim();var O={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(h){let q=new Array(V);for(let X=0;X<V;X++){let N=(X+1)/V,J={mpos:O.mpos,rz:O.rz,rot:O.rot};J.mpos=S.clone().sub(O.mpos).multiplyScalar(N).add(O.mpos),J.rz=O.rz+N*(E-O.rz),J.rot=s.slerp(O.rot,F,N),J.cam=D.clone().sub(O.cam).multiplyScalar(N).add(O.cam),q[X]=J}let U=0,B=this,Y=function(){var X=q[U];U+=1,B.modelGroup.position=X.mpos,B.rotationGroup.position.z=X.rz,B.rotationGroup.quaternion=X.rot,B.camera.lookAt(X.cam),U<q.length?setTimeout(Y,L):B.decAnim(),B.show()};setTimeout(Y,L)}else{var W={};let q=1/V;if(S&&(W.mpos=S.clone().sub(O.mpos).multiplyScalar(q)),typeof E<"u"&&E!=null&&(W.rz=q*(E-O.rz)),F){var H=s.slerp(O.rot,F,q);W.rot=O.rot.clone().inverse().multiply(H)}D&&(W.cam=D.clone().sub(O.cam).multiplyScalar(q));let U=0,B=this,Y=function(){U+=1,W.mpos&&B.modelGroup.position.add(W.mpos),W.rz&&(B.rotationGroup.position.z+=W.rz),W.rot&&B.rotationGroup.quaternion.multiply(W.rot),W.cam&&(B.lookingAt.add(W.cam),B.camera.lookAt(B.lookingAt)),U<V?setTimeout(Y,L):B.decAnim(),B.show()};setTimeout(Y,L)}}rotate(l,h="y",S=0,E=!1){if(h=="x"?h={x:1,y:0,z:0}:h=="y"?h={x:0,y:1,z:0}:h=="z"&&(h={x:0,y:0,z:1}),h=="vx"?h={vx:1,vy:0,vz:0}:h=="vy"?h={vx:0,vy:1,vz:0}:h=="vz"&&(h={vx:0,vy:0,vz:1}),typeof h.vx<"u"){var F=new v.Vector3(h.vx,h.vy,h.vz);F.applyQuaternion(this.rotationGroup.quaternion),h={x:F.x,y:F.y,z:F.z}}var D=function(W){var H=Math.sin(W/2),q=Math.cos(W/2),U=0,B=0,Y=0;return U=h.x*H,B=h.y*H,Y=h.z*H,new v.Quaternion(U,B,Y,q).normalize()},L=Math.PI*l/180,V=D(L);if(S){var O=new v.Quaternion().copy(this.rotationGroup.quaternion).multiply(V);this.animateMotion(S,E,this.modelGroup.position,this.rotationGroup.position.z,O,this.lookingAt)}else this.rotationGroup.quaternion.multiply(V),this.show();return this}surfacesFinished(){for(var l in this.surfaces)if(!this.surfaces[l][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var l=this.modelGroup.position,h=this.rotationGroup.quaternion;return[l.x,l.y,l.z,this.rotationGroup.position.z,h.x,h.y,h.z,h.w]}setView(l,h){return l===void 0||!(l instanceof Array||l.length!==8)?this:!this.modelGroup||!this.rotationGroup?this:(this.modelGroup.position.x=l[0],this.modelGroup.position.y=l[1],this.modelGroup.position.z=l[2],this.rotationGroup.position.z=l[3],this.rotationGroup.quaternion.x=l[4],this.rotationGroup.quaternion.y=l[5],this.rotationGroup.quaternion.z=l[6],this.rotationGroup.quaternion.w=l[7],typeof l[8]<"u"&&(this.rotationGroup.position.x=l[8],this.rotationGroup.position.y=l[9]),this.show(h),this)}render(l,h){this.renderer.setViewport(),this.updateClickables();var S=this.getView();this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState());var E,F;for(h||(h=this.renderer.supportedExtensions()),E=0;E<this.models.length;E++)this.models[E]&&this.models[E].globj(this.modelGroup,h);for(E=0;E<this.shapes.length;E++)this.shapes[E]&&(typeof this.shapes[E].frame>"u"||this.viewer_frame<0||this.shapes[E].frame<0||this.shapes[E].frame==this.viewer_frame?this.shapes[E].globj(this.modelGroup,h):this.shapes[E].removegl(this.modelGroup));for(E=0;E<this.labels.length;E++)h.regen&&(this.labels[E].dispose(),this.modelGroup.remove(this.labels[E].sprite),this.labels[E].setContext(),this.modelGroup.add(this.labels[E].sprite)),this.labels[E]&&typeof this.labels[E].frame<"u"&&this.labels[E].frame>=0&&(this.modelGroup.remove(this.labels[E].sprite),(this.viewer_frame<0||this.labels[E].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[E].sprite));for(E in this.surfaces)if(this.surfaces.hasOwnProperty(E)){var D=this.surfaces[E];for(F=0;F<D.length;F++)if(D.hasOwnProperty(F)){var L=D[F].geo;if(!D[F].finished||h.regen){L.verticesNeedUpdate=!0,L.elementsNeedUpdate=!0,L.normalsNeedUpdate=!0,L.colorsNeedUpdate=!0,L.buffersNeedUpdate=!0,L.boundingSphere=null,D[F].mat.needsUpdate=!0,D[F].done&&(D[F].finished=!0),D[F].lastGL&&this.modelGroup.remove(D[F].lastGL);var V=null;if(D[F].mat instanceof u.LineBasicMaterial?V=new u.Line(L,D[F].mat):V=new u.Mesh(L,D[F].mat),D[F].mat.transparent&&D[F].mat.opacity==0?V.visible=!1:V.visible=!0,D[F].symmetries.length>1||D[F].symmetries.length==1&&!D[F].symmetries[F].isIdentity()){var O,W=new u.Object3D;for(O=0;O<D[F].symmetries.length;O++){var H=V.clone();H.matrix=D[F].symmetries[O],H.matrixAutoUpdate=!1,W.add(H)}D[F].lastGL=W,this.modelGroup.add(W)}else D[F].lastGL=V,this.modelGroup.add(V)}}}return this.setView(S),typeof l=="function"&&l(this),this}getModelList(l){let h=[];if(typeof l>"u"||typeof l.model>"u")for(let E=0;E<this.models.length;E++)this.models[E]&&h.push(this.models[E]);else{let E=l.model;Array.isArray(E)||(E=[E]);for(let F=0;F<E.length;F++)if(typeof E[F]=="number"){var S=E[F];S<0&&(S+=this.models.length),h.push(this.models[S])}else h.push(E[F])}return h}getAtomsFromSel(l){var h=[];typeof l>"u"&&(l={});var S=this.getModelList(l);for(let E=0;E<S.length;E++)h=h.concat(S[E].selectedAtoms(l));return h}atomIsSelected(l,h){typeof h>"u"&&(h={});for(var S=this.getModelList(h),E=0;E<S.length;E++)if(S[E].atomIsSelected(l,h))return!0;return!1}selectedAtoms(l){return this.getAtomsFromSel(l)}getUniqueValues(l,h){typeof h>"u"&&(h={});var S=this.getAtomsFromSel(h),E={};for(var F in S)if(S[F].hasOwnProperty(l)){var D=S[F][l];E[D]=!0}return Object.keys(E)}pdbData(l){for(var h=this.getAtomsFromSel(l),S="",E=0,F=h.length;E<F;++E)S+=h[E].pdbline+`
`;return S}zoom(l=2,h=0,S=!1){var E=(this.CAMERA_Z-this.rotationGroup.position.z)/l,F=this.CAMERA_Z-E;return h>0?this.animateMotion(h,S,this.modelGroup.position,this.adjustZoomToLimits(F),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(F),this.show()),this}translate(l,h,S=0,E=!1){var F=l/this.WIDTH,D=h/this.HEIGHT,L=new v.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(L,this.camera),L.x-=F,L.y-=D,this.projector.unprojectVector(L,this.camera),L.z=0;var V=this.lookingAt.clone().add(L);return S>0?this.animateMotion(S,E,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,V):(this.lookingAt=V,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(l,h,S=0,E=!1){var F=this.screenOffsetToModel(l,h),D=this.modelGroup.position.clone().add(F);return S>0?this.animateMotion(S,E,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=D,this.show()),this}fitSlab(l){l=l||{};var h=this.getAtomsFromSel(l),S=(0,b.getExtent)(h),E=S[1][0]-S[0][0],F=S[1][1]-S[0][1],D=S[1][2]-S[0][2],L=Math.hypot(E,F,D);return L<5&&(L=5),this.slabNear=-L/1.9,this.slabFar=L/2,this}center(l={},h=0,S=!1){var E,F,D=this.getAtomsFromSel(l),L=(0,b.getExtent)(D);(0,b.isEmptyObject)(l)?(this.shapes.forEach(N=>{if(N&&N.boundingSphere&&N.boundingSphere.center){var J=N.boundingSphere.center,ae=N.boundingSphere.radius;ae>0?(D.push(new v.Vector3(J.x+ae,J.y,J.z)),D.push(new v.Vector3(J.x-ae,J.y,J.z)),D.push(new v.Vector3(J.x,J.y+ae,J.z)),D.push(new v.Vector3(J.x,J.y-ae,J.z)),D.push(new v.Vector3(J.x,J.y,J.z+ae)),D.push(new v.Vector3(J.x,J.y,J.z-ae))):D.push(J)}}),L=(0,b.getExtent)(D),E=D,F=L):(E=this.getAtomsFromSel({}),F=(0,b.getExtent)(E));var V=new v.Vector3(L[2][0],L[2][1],L[2][2]),O=F[1][0]-F[0][0],W=F[1][1]-F[0][1],H=F[1][2]-F[0][2],q=Math.hypot(O,W,H);q<5&&(q=5),this.slabNear=-q/1.9,this.slabFar=q/2,O=L[1][0]-L[0][0],W=L[1][1]-L[0][1],H=L[1][2]-L[0][2],q=Math.hypot(O,W,H),q<5&&(q=5);for(var U=25,B=0;B<D.length;B++)if(D[B]){var Y=V.distanceToSquared(D[B]);Y>U&&(U=Y)}q=Math.sqrt(U)*2;var X=V.clone().multiplyScalar(-1);return h>0?this.animateMotion(h,S,X,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=X,this.show()),this}zoomTo(l={},h=0,S=!1){let E=this.getAtomsFromSel(l),F=(0,b.getExtent)(E),D=F;if((0,b.isEmptyObject)(l)){let J=E&&E.length;if(this.shapes.forEach(ae=>{if(ae&&ae.boundingSphere){if(ae.boundingSphere.box){let pe=ae.boundingSphere.box;E.push(new v.Vector3(pe.min.x,pe.min.y,pe.min.z)),E.push(new v.Vector3(pe.max.x,pe.max.y,pe.max.z))}else if(ae.boundingSphere.center){var se=ae.boundingSphere.center,he=ae.boundingSphere.radius;he>0?(E.push(new v.Vector3(se.x+he,se.y,se.z)),E.push(new v.Vector3(se.x-he,se.y,se.z)),E.push(new v.Vector3(se.x,se.y+he,se.z)),E.push(new v.Vector3(se.x,se.y-he,se.z)),E.push(new v.Vector3(se.x,se.y,se.z+he)),E.push(new v.Vector3(se.x,se.y,se.z-he))):E.push(se)}}}),D=(0,b.getExtent)(E),!J)for(let ae=0;ae<3;ae++)F[2][ae]=(D[0][ae]+D[1][ae])/2}else{let J=this.getAtomsFromSel({});D=(0,b.getExtent)(J)}var L=new v.Vector3(F[2][0],F[2][1],F[2][2]),V=D[1][0]-D[0][0],O=D[1][1]-D[0][1],W=D[1][2]-D[0][2],H=Math.hypot(V,O,W);H<5&&(H=5),this.slabNear=-H/1.9,this.slabFar=H/2,Object.keys(l).length===0&&(this.slabNear=Math.min(-H*2,-50),this.slabFar=Math.max(H*2,50));var q=this.config.minimumZoomToDistance||5;V=F[1][0]-F[0][0],O=F[1][1]-F[0][1],W=F[1][2]-F[0][2],H=Math.hypot(V,O,W),H<q&&(H=q);for(var U=q*q,B=0;B<E.length;B++)if(E[B]){var Y=L.distanceToSquared(E[B]);Y>U&&(U=Y)}H=Math.sqrt(U)*2;var X=L.clone().multiplyScalar(-1),N=-(H*.5/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return N=this.adjustZoomToLimits(N),h>0?this.animateMotion(h,S,X,N,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=X,this.rotationGroup.position.z=N,this.show()),this}setSlab(l,h){this.slabNear=l,this.slabFar=h}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(l,h={},S,E=!1){if(S){var F=(0,b.getExtent)(this.getAtomsFromSel(S));h.position={x:F[2][0],y:F[2][1],z:F[2][2]}}var D=new k.Label(l,h);return D.setContext(),this.modelGroup.add(D.sprite),this.labels.push(D),E||this.show(),D}addResLabels(l,h,S=!1){let E=this.labels.length;return this.applyToModels("addResLabels",l,this,h,S),this.show(),this.labels.slice(E)}addPropertyLabels(l,h,S){return this.applyToModels("addPropertyLabels",l,h,this,S),this.show(),this}removeLabel(l){for(var h=0;h<this.labels.length;h++)if(this.labels[h]==l){this.labels.splice(h,1),l.dispose(),this.modelGroup.remove(l.sprite);break}return this.show(),this}removeAllLabels(){for(var l=0;l<this.labels.length;l++)this.labels[l]&&this.labels[l].sprite&&this.modelGroup.remove(this.labels[l].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}setLabelStyle(l,h){return this.modelGroup.remove(l.sprite),l.dispose(),l.stylespec=h,l.setContext(),this.modelGroup.add(l.sprite),this.show(),l}setLabelText(l,h){return this.modelGroup.remove(l.sprite),l.dispose(),l.text=h,l.setContext(),this.modelGroup.add(l.sprite),this.show(),l}addShape(l){l=l||{};var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,this.shapes.push(h),h}removeShape(l){if(!l)return this;for(l.removegl(this.modelGroup),delete this.shapes[l.shapePosition];this.shapes.length>0&&typeof this.shapes[this.shapes.length-1]>"u";)this.shapes.pop();return this}removeAllShapes(){for(var l=0;l<this.shapes.length;l++){var h=this.shapes[l];h&&h.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(l){if(l.hasOwnProperty("x")&&l.hasOwnProperty("y")&&l.hasOwnProperty("z"))return l;var h=this.getAtomsFromSel(l);if(h.length==0)return{x:0,y:0,z:0};var S=(0,b.getExtent)(h);return{x:S[0][0]+(S[1][0]-S[0][0])/2,y:S[0][1]+(S[1][1]-S[0][1])/2,z:S[0][2]+(S[1][2]-S[0][2])/2}}addSphere(l){l=l||{},l.center=this.getSelectionCenter(l.center);var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,h.addSphere(l),this.shapes.push(h),h.finalize(),h}addBox(l={}){l.corner!=null&&(l.corner=this.getSelectionCenter(l.corner)),l.center!=null&&(l.center=this.getSelectionCenter(l.center));var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,h.addBox(l),this.shapes.push(h),h.finalize(),h}addArrow(l={}){l.start=this.getSelectionCenter(l.start),l.end=this.getSelectionCenter(l.end);var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,h.addArrow(l),this.shapes.push(h),h.finalize(),h}addCylinder(l={}){l.start=this.getSelectionCenter(l.start),l.end=this.getSelectionCenter(l.end);var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,l.dashed?h.addDashedCylinder(l):h.addCylinder(l),this.shapes.push(h),h.finalize(),h}addCurve(l={}){var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,h.addCurve(l),this.shapes.push(h),h.finalize(),h}addLine(l={}){l.start=this.getSelectionCenter(l.start),l.end=this.getSelectionCenter(l.end),l.wireframe=!0;var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,l.dashed?h=this.addLineDashed(l,h):h.addLine(l),this.shapes.push(h),h.finalize(),h}addUnitCell(l,h){l=this.getModel(l),h=h||{alabel:"a",blabel:"b",clabel:"c"},h.box=h.box||{},h.astyle=h.astyle||{color:"red",radius:.1,midpos:-1},h.bstyle=h.bstyle||{color:"green",radius:.1,midpos:-1},h.cstyle=h.cstyle||{color:"blue",radius:.1,midpos:-1},h.alabelstyle=h.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},h.blabelstyle=h.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},h.clabelstyle=h.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},l.unitCellObjects&&this.removeUnitCell(l),l.unitCellObjects={shapes:[],labels:[]};var S=l.getCrystData(),E=null;if(S){if(S.matrix)E=S.matrix;else{var F=S.a,D=S.b,L=S.c,V=S.alpha,O=S.beta,W=S.gamma;V=V*Math.PI/180,O=O*Math.PI/180,W=W*Math.PI/180;var H,q,U;H=Math.cos(O),q=(Math.cos(V)-Math.cos(O)*Math.cos(W))/Math.sin(W),U=Math.sqrt(Math.max(0,1-H*H-q*q)),E=new v.Matrix3(F,D*Math.cos(W),L*H,0,D*Math.sin(W),L*q,0,0,L*U)}var B=[new v.Vector3(0,0,0),new v.Vector3(1,0,0),new v.Vector3(0,1,0),new v.Vector3(0,0,1),new v.Vector3(1,1,0),new v.Vector3(0,1,1),new v.Vector3(1,0,1),new v.Vector3(1,1,1)];if(S.matrix4)for(let X=0;X<B.length;X++)S.size&&B[X].multiplyVectors(B[X],S.size),B[X]=B[X].applyMatrix4(S.matrix4);else for(let X=0;X<B.length;X++)B[X]=B[X].applyMatrix3(E);if(h.box&&!h.box.hidden){h.box.wireframe=!0;var Y=new g.GLShape(h.box);Y.shapePosition=this.shapes.length,Y.addLine({start:B[0],end:B[1]}),Y.addLine({start:B[0],end:B[2]}),Y.addLine({start:B[1],end:B[4]}),Y.addLine({start:B[2],end:B[4]}),Y.addLine({start:B[0],end:B[3]}),Y.addLine({start:B[3],end:B[5]}),Y.addLine({start:B[2],end:B[5]}),Y.addLine({start:B[1],end:B[6]}),Y.addLine({start:B[4],end:B[7]}),Y.addLine({start:B[6],end:B[7]}),Y.addLine({start:B[3],end:B[6]}),Y.addLine({start:B[5],end:B[7]}),this.shapes.push(Y),l.unitCellObjects.shapes.push(Y),Y.finalize()}if(!h.astyle.hidden){h.astyle.start=B[0],h.astyle.end=B[1];let X=this.addArrow(h.astyle);l.unitCellObjects.shapes.push(X)}if(!h.bstyle.hidden){h.bstyle.start=B[0],h.bstyle.end=B[2];let X=this.addArrow(h.bstyle);l.unitCellObjects.shapes.push(X)}if(!h.cstyle.hidden){h.cstyle.start=B[0],h.cstyle.end=B[3];let X=this.addArrow(h.cstyle);l.unitCellObjects.shapes.push(X)}if(h.alabel){h.alabelstyle.position=B[1];let X=this.addLabel(h.alabel,h.alabelstyle);l.unitCellObjects.labels.push(X)}if(h.blabel){h.blabelstyle.position=B[2];let X=this.addLabel(h.blabel,h.blabelstyle);l.unitCellObjects.labels.push(X)}if(h.clabel){h.clabelstyle.position=B[3];let X=this.addLabel(h.clabel,h.clabelstyle);l.unitCellObjects.labels.push(X)}}}removeUnitCell(l){if(l=this.getModel(l),l.unitCellObjects){let h=this;l.unitCellObjects.shapes.forEach(function(S){h.removeShape(S)}),l.unitCellObjects.labels.forEach(function(S){h.removeLabel(S)})}delete l.unitCellObjects}replicateUnitCell(l=3,h=l,S=h,E,F,D){E=this.getModel(E);let L=E.getCrystData();if(L){const V=E.selectedAtoms({}),O=L.matrix;let W=function(q){return q%2==0?-q/2:Math.ceil(q/2)};l<=1&&h<=1&&S<=1&&(D=!0,l=h=S=3);let H=function(q,U,B){return!1};if(D){const q=new v.Matrix3().getInverse3(O);H=function(U,B,Y){let X=new v.Vector3(U,B,Y).applyMatrix3(q);return!(X.x>-1e-4&&X.x<1.0001&&X.y>-1e-4&&X.y<1.0001&&X.z>-1e-4&&X.z<1.0001)}}for(let q=0;q<l;q++)for(let U=0;U<h;U++)for(let B=0;B<S;B++){if(q==0&&U==0&&B==0)continue;let Y=new v.Vector3(W(q),W(U),W(B));Y.applyMatrix3(O);let X=[];for(let N=0;N<V.length;N++){let J=V[N].x+Y.x,ae=V[N].y+Y.y,se=V[N].z+Y.z;if(H(J,ae,se))continue;let he={};for(let pe in V[N])he[pe]=V[N][pe];he.x=J,he.y=ae,he.z=se,X.push(he)}E.addAtoms(X)}F&&E.assignBonds()}}addLineDashed(l,h){l.dashLength=l.dashLength||.5,l.gapLength=l.gapLength||.5;var S;l.start?S=new v.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):S=new v.Vector3(0,0,0);var E;l.end?E=new v.Vector3(l.end.x,l.end.y||0,l.end.z||0):E=new v.Vector3(0,0,0);var F=new v.Vector3,D=new v.Vector3,L=new v.Vector3,V,O,W,H=S.clone(),q=0;for(F.subVectors(E,S),V=F.length(),F.normalize(),D=F.clone(),L=F.clone(),D.multiplyScalar(l.dashLength),L.multiplyScalar(l.gapLength),O=D.length(),W=L.length();q<V;){if(q+O>V){l.start=S,l.end=E,h.addLine(l);break}H.addVectors(S,D),l.start=S,l.end=H,h.addLine(l),S=H.clone(),q+=O,H.addVectors(S,L),S=H.clone(),q+=W}return h.finalize(),h}addCustom(l){l=l||{};var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,h.addCustom(l),this.shapes.push(h),h.finalize(),h}addVolumetricData(l,h,S={}){var E=new R.VolumeData(l,h);return S.hasOwnProperty("transferfn")?this.addVolumetricRender(E,S):this.addIsosurface(E,S)}addIsosurface(l,h={},S){var E=new g.GLShape(h);return E.shapePosition=this.shapes.length,E.addIsosurface(l,h,S,this),this.shapes.push(E),E}addVolumetricRender(l,h){h=h||{};var S=new T.GLVolumetricRender(l,h,this);return S.shapePosition=this.shapes.length,this.shapes.push(S),S}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(l){l?this.scene.fog=new u.Fog(this.bgColor,100,200):(this.config.disableFog=!0,this.show())}setFrame(l){this.viewer_frame=l;let h=this;return new Promise(function(S){var E=h.models.map(function(F){return F.setFrame(l,h)});Promise.all(E).then(function(){S()})})}getFrame(){return this.viewer_frame}getNumFrames(){var l=0;for(let h=0;h<this.models.length;h++)this.models[h].getNumFrames()>l&&(l=this.models[h].getNumFrames());for(let h=0;h<this.shapes.length;h++)this.shapes[h].frame&&this.shapes[h].frame>=l&&(l=this.shapes[h].frame+1);for(let h=0;h<this.labels.length;h++)this.labels[h].frame&&this.labels[h].frame>=l&&(l=this.labels[h].frame+1);return l}animate(l){this.incAnim();var h=100,S="forward",E=1/0;l=l||{},l.interval&&(h=l.interval),l.loop&&(S=l.loop),l.reps&&(E=l.reps);var F=this.getNumFrames(),D=this,L=0;l.startFrame&&(L=l.startFrame%F);var V=1;l.step&&(V=l.step,E/=V);var O=0,W=F*E,H=new Date,q,U,B=function(Y){H=new Date,Y=="forward"?D.setFrame(L).then(function(){L=(L+V)%F,q()}):Y=="backward"?D.setFrame(F-1-L).then(function(){L=(L+V)%F,q()}):D.setFrame(L).then(function(){L+=V,V*=L%(F-1)==0?-1:1,q()})};return q=function(){if(D.render(),!D.getCanvas().isConnected)D.stopAnimate();else if(++O>=W||!D.isAnimated())U.cancel(),D.animationTimers.delete(U),D.decAnim();else{var Y=h-(new Date().getTime()-H.getTime());Y=Y>0?Y:0,D.animationTimers.delete(U),U=new b.PausableTimer(B,Y,S),D.animationTimers.add(U)}},U=new b.PausableTimer(B,0,S),this.animationTimers.add(U),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(l){l.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(l){l.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(l){l.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(l){return l&&!l.defaultcolors?(l.defaultcolors=this.defaultcolors,l.cartoonQuality=l.cartoonQuality||this.config.cartoonQuality):typeof l>"u"&&(l={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),l}addModel(l,h="",S){S=this.getModelOpt(S);var E=new y.GLModel(this.models.length,S);return E.addMolData(l,h,S),this.models.push(E),E}addModels(l,h,S){S=this.getModelOpt(S),S.multimodel=!0,S.frames=!0;for(var E=y.GLModel.parseMolData(l,h,S),F=0;F<E.length;F++){var D=new y.GLModel(this.models.length,S);D.setAtomDefaults(E[F]),D.addFrame(E[F]),D.setFrame(0),E.modelData&&D.setModelData(E.modelData[F]),D.setDontDuplicateAtoms(!S.duplicateAssemblyAtoms),this.models.push(D)}return this.models}addModelsAsFrames(l,h,S){S=this.getModelOpt(S),S.multimodel=!0,S.frames=!0;var E=new y.GLModel(this.models.length,S);return E.addMolData(l,h,S),this.models.push(E),E}addAsOneMolecule(l,h,S){S=this.getModelOpt(S),S.multimodel=!0,S.onemol=!0;var E=new y.GLModel(this.models.length,S);return E.addMolData(l,h,S),this.models.push(E),E}removeModel(l){if(l=this.getModel(l),!!l){for(l.removegl(this.modelGroup),delete this.models[l.getID()];this.models.length>0&&typeof this.models[this.models.length-1]>"u";)this.models.pop();return this}}removeAllModels(){for(var l=0;l<this.models.length;l++){var h=this.models[l];h&&h.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(l,h){var S={};return h===void 0?S.m=this.models.map(function(E){return E.toCDObject(l)}):S.m=[this.models[h].toCDObject()],JSON.stringify(S)}exportVRML(){var l=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new u.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var h=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=l,h}createModelFrom(l,h=!1){for(var S=new y.GLModel(this.models.length,this.defaultcolors),E=0;E<this.models.length;E++)if(this.models[E]){var F=this.models[E].selectedAtoms(l);S.addAtoms(F),h&&this.models[E].removeAtoms(F)}return this.models.push(S),S}applyToModels(l,h,S,E,F,D,L){for(var V=this.getModelList(h),O=0;O<V.length;O++)V[O][l](h,S,E,F,D,L)}setStyle(l,h){return typeof h>"u"&&(h=l,l={}),this.applyToModels("setStyle",l,h,!1),this}addStyle(l,h){return typeof h>"u"&&(h=l,l={}),this.applyToModels("setStyle",l,h,!0),this}setClickable(l,h,S){return this.applyToModels("setClickable",l,h,S),this}setHoverable(l,h,S,E){return this.applyToModels("setHoverable",l,h,S,E),this}enableContextMenu(l,h){return this.applyToModels("enableContextMenu",l,h),this}vibrate(l,h,S,E){return this.applyToModels("vibrate",l,h,S,this,E),this}setColorByProperty(l,h,S,E){return this.applyToModels("setColorByProperty",l,h,S,E),this}setColorByElement(l,h){return this.applyToModels("setColorByElement",l,h),this}static getAtomsWithin(l,h){var S=[];for(let F=0;F<l.length;F++){var E=l[F];typeof E>"u"||E.x<h[0][0]||E.x>h[1][0]||E.y<h[0][1]||E.y>h[1][1]||E.z<h[0][2]||E.z>h[1][2]||S.push(E)}return S}static volume(l){var h=l[1][0]-l[0][0],S=l[1][1]-l[0][1],E=l[1][2]-l[0][2];return h*S*E}carveUpExtent(l,h,S){let E=[],F={};for(let H=0,q=h.length;H<q;H++)F[h[H].index]=H;let D=function(H){let q=[];for(let U=0,B=H.length;U<B;U++)H[U].index in F&&q.push(F[H[U].index]);return q},L=function(H){let q=[];return q[0]=[H[0][0],H[0][1],H[0][2]],q[1]=[H[1][0],H[1][1],H[1][2]],q},V=function(H){if(s.volume(H)<s.maxVolume)return[H];var q=H[1][0]-H[0][0],U=H[1][1]-H[0][1],B=H[1][2]-H[0][2],Y;q>U&&q>B?Y=0:U>q&&U>B?Y=1:Y=2;var X=L(H),N=L(H),J=(H[1][Y]-H[0][Y])/2+H[0][Y];X[1][Y]=J,N[0][Y]=J;var ae=V(X),se=V(N);return ae.concat(se)},O=V(l),W=6;for(let H=0,q=O.length;H<q;H++){let U=L(O[H]);U[0][0]-=W,U[0][1]-=W,U[0][2]-=W,U[1][0]+=W,U[1][1]+=W,U[1][2]+=W;let B=s.getAtomsWithin(h,U),Y=s.getAtomsWithin(S,O[H]);E.push({extent:O[H],atoms:D(B),toshow:D(Y)})}return E}static generateSurfaceMesh(l,h,S){var E=new u.Geometry(!0),F=E.updateGeoGroup(0),D=[];for(let We=0,Oe=l.length;We<Oe;We++){var L=l[We];L&&(typeof L.surfaceColor<"u"?D[We]=L.surfaceColor:L.color&&(D[We]=x.CC.color(L.color)))}var V=F.vertexArray,O=h.vertices;for(let We=0,Oe=O.length;We<Oe;We++){let me=F.vertices*3;V[me]=O[We].x,V[me+1]=O[We].y,V[me+2]=O[We].z,F.vertices++}var W=F.colorArray;if(S.voldata&&S.volscheme){var H=S.volscheme,q=S.voldata,U=H.range()||[-1,1];for(let We=0,Oe=O.length;We<Oe;We++){let me=q.getVal(O[We].x,O[We].y,O[We].z),Fe=x.CC.color(H.valueToHex(me,U)),qe=We*3;W[qe]=Fe.r,W[qe+1]=Fe.g,W[qe+2]=Fe.b}}else if(D.length>0)for(let We=0,Oe=O.length;We<Oe;We++){let me=O[We].atomid,Fe=We*3;W[Fe]=D[me].r,W[Fe+1]=D[me].g,W[Fe+2]=D[me].b}var B=h.faces;F.faceidx=B.length,E.initTypedArrays();var Y=F.vertexArray,X=F.normalArray,N,J,ae,se;for(let We=0,Oe=B.length;We<Oe;We+=3){var he=B[We],pe=B[We+1],de=B[We+2],ue=he*3,ge=pe*3,Re=de*3;N=new v.Vector3(Y[ue],Y[ue+1],Y[ue+2]),J=new v.Vector3(Y[ge],Y[ge+1],Y[ge+2]),ae=new v.Vector3(Y[Re],Y[Re+1],Y[Re+2]),ae.subVectors(ae,J),N.subVectors(N,J),ae.cross(N),se=ae,se.normalize(),X[ue]+=se.x,X[ge]+=se.x,X[Re]+=se.x,X[ue+1]+=se.y,X[ge+1]+=se.y,X[Re+1]+=se.y,X[ue+2]+=se.z,X[ge+2]+=se.z,X[Re+2]+=se.z}F.faceArray=new Uint16Array(B);var Ge=new u.Mesh(E,S);return Ge}static generateMeshSyncHelper(l,h,S,E,F,D){var L=new P.ProteinSurface;return L.initparm(h,l!==1,D),L.fillvoxels(F,S),L.buildboundary(),(l==P.SurfaceType.SES||l==P.SurfaceType.MS)&&(L.fastdistancemap(),L.boundingatom(!1),L.fillvoxelswaals(F,S)),L.marchingcube(l),L.getFacesAndVertices(E)}static getMatWithStyle(l){let h=null;l.onesided?h=new u.MeshLambertMaterial:h=new u.MeshDoubleLambertMaterial,h.vertexColors=u.Coloring.VertexColors;for(var S in l)S==="color"||S==="map"||l.hasOwnProperty(S)&&(h[S]=l[S]);return l.opacity!==void 0&&(l.opacity===1?h.transparent=!1:h.transparent=!0),h}addMesh(l){var h={geo:l.geometry,mat:l.material,done:!0,finished:!1},S=this.nextSurfID();return this.surfaces[S]=h,S}static shallowCopy(l){var h=[];let S=l.length;for(let E=0;E<S;E++)h[E]=(0,b.extend)({},l[E]);return h}addSurface(l,h={},S={},E,F,D){let L=this.nextSurfID(),V=null,O=this,W=P.SurfaceType.VDW;typeof l=="string"?s.surfaceTypeMap[l.toUpperCase()]!==void 0?W=s.surfaceTypeMap[l]:console.log("Surface type : "+l+" is not recognized"):typeof l=="number"&&(W=l);var H=null,q=null,U=s.shallowCopy(this.getAtomsFromSel(S));E?H=s.shallowCopy(this.getAtomsFromSel(E)):H=U,(0,b.adjustVolumeStyle)(h);var B=!1,Y;for(Y=0;Y<this.models.length;Y++)if(this.models[Y]){var X=this.models[Y].getSymmetries();if(X.length>1||X.length==1&&!X[0].isIdentity()){B=!0;break}}var N=function(de,ue,ge){F?q=s.shallowCopy(O.getAtomsFromSel(F)):q=ge;var Re,Ge=(0,b.getExtent)(ge,!0);if(h.map&&h.map.prop){var We=h.map.prop;let Ne=(0,p.getGradient)(h.map.scheme||h.map.gradient||new p.Gradient.RWB),Ue=Ne.range();Ue||(Ue=(0,b.getPropertyRange)(ge,We)),h.colorscheme={prop:We,gradient:Ne}}for(let Ne=0,Ue=ue.length;Ne<Ue;Ne++)Re=ue[Ne],Re.surfaceColor=(0,b.getColorFromStyle)(Re,h);var Oe=s.volume(Ge),me=O.carveUpExtent(Ge,ue,ge);if(q&&q.length&&q.length>0){var Fe=(0,b.getExtent)(q,!0),qe=function(Ne,Ue){var ft=function(ie,oe){var we=ie.extent,Se=we[1][0]-we[0][0],He=we[1][1]-we[0][1],Be=we[1][2]-we[0][2],K=Se-oe[2][0];K*=K;var xe=He-oe[2][1];xe*=xe;var Me=Be-oe[2][2];return Me*=Me,K+xe+Me},ut=ft(Ne,Fe),ee=ft(Ue,Fe);return ut-ee};me.sort(qe)}var Qe=[];for(let Ne=0,Ue=ue.length;Ne<Ue;Ne++)Re=ue[Ne],Qe[Ne]={x:Re.x,y:Re.y,z:Re.z,serial:Ne,elem:Re.elem};var st=!!P.syncSurface;if(st){var ot=function(Ne){return new Promise(function(Ue){for(var ft=s.generateMeshSyncHelper(W,me[Ne].extent,me[Ne].atoms,me[Ne].toshow,Qe,Oe),ut=(0,g.splitMesh)({vertexArr:ft.vertices,faceArr:ft.faces}),ee=0,ie=ut.length;ee<ie;ee++){ft={vertices:ut[ee].vertexArr,faces:ut[ee].faceArr};var oe=s.generateSurfaceMesh(ue,ft,V);(0,b.mergeGeos)(de.geo,oe)}O.render(),Ue()})},Ke=[];for(let Ne=0;Ne<me.length;Ne++)Ke.push(ot(Ne));return Promise.all(Ke).then(function(){return de.done=!0,Promise.resolve(L)})}else{var Je=[];W<0&&(W=0);for(let Ne=0,Ue=s.numWorkers;Ne<Ue;Ne++){var Xe=new Worker($3Dmol.SurfaceWorker);Je.push(Xe),Xe.postMessage({type:-1,atoms:Qe,volume:Oe})}return new Promise(function(Ne,Ue){var ft=0,ut=function(){!Je||!Je.length||Je.forEach(function(we){we&&we.terminate&&we.terminate()})},ee=function(we){for(var Se=(0,g.splitMesh)({vertexArr:we.data.vertices,faceArr:we.data.faces}),He=0,Be=Se.length;He<Be;He++){var K={vertices:Se[He].vertexArr,faces:Se[He].faceArr},xe=s.generateSurfaceMesh(ue,K,V);(0,b.mergeGeos)(de.geo,xe)}O.render(),ft++,ft==me.length&&(de.done=!0,ut(),Ne(L))},ie=function(we){ut(),console.log(we.message+" ("+we.filename+":"+we.lineno+")"),Ue(we)};for(let we=0;we<me.length;we++){var oe=Je[we%Je.length];oe.onmessage=ee,oe.onerror=ie,oe.postMessage({type:W,expandedExtent:me[we].extent,extendedAtoms:me[we].atoms,atomsToShow:me[we].toshow})}})}};h=h||{},V=s.getMatWithStyle(h);var J=[];J.style=h,J.atomsel=S,J.allsel=E,J.focus=F;var ae=null;if(B){var se={},he={};for(Y=0;Y<this.models.length;Y++)se[Y]=[],he[Y]=[];for(Y=0;Y<H.length;Y++)se[H[Y].model].push(H[Y]);for(Y=0;Y<U.length;Y++)he[U[Y].model].push(U[Y]);var pe=[];for(Y=0;Y<this.models.length;Y++)he[Y].length>0&&(J.push({geo:new u.Geometry(!0),mat:V,done:!1,finished:!1,symmetries:this.models[Y].getSymmetries()}),pe.push(N(J[J.length-1],se[Y],he[Y])));ae=Promise.all(pe)}else J.push({geo:new u.Geometry(!0),mat:V,done:!1,finished:!1,symmetries:[new v.Matrix4]}),ae=N(J[J.length-1],H,U);return this.surfaces[L]=J,ae.surfid=L,D&&typeof D=="function"?(ae.then(function(de){D(de)}),L):ae}setSurfaceMaterialStyle(l,h){if((0,b.adjustVolumeStyle)(h),this.surfaces[l]){var S=this.surfaces[l];S.style=h;for(var E=0;E<S.length;E++){var F=S[E].mat=s.getMatWithStyle(h);if(S[E].mat.side=u.FrontSide,h.color){S[E].mat.color=h.color,S[E].geo.colorsNeedUpdate=!0;const D=x.CC.color(h.color);S[E].geo.setColors(function(){return D})}else if(F.voldata&&F.volscheme){const D=F.volscheme,L=F.voldata,V=x.CC,O=D.range()||[-1,1];S[E].geo.setColors(function(W,H,q){let U=L.getVal(W,H,q);return V.color(D.valueToHex(U,O))})}S[E].finished=!1}}return this}getSurface(l){return this.surfaces[l]}removeSurface(l){for(var h=this.surfaces[l],S=0;S<h.length;S++)h[S]&&h[S].lastGL&&(h[S].geo!==void 0&&h[S].geo.dispose(),h[S].mat!==void 0&&h[S].mat.dispose(),this.modelGroup.remove(h[S].lastGL));return delete this.surfaces[l],this.show(),this}removeAllSurfaces(){for(var l in this.surfaces)if(this.surfaces.hasOwnProperty(l)){for(var h=this.surfaces[l],S=0;S<h.length;S++)h[S]&&h[S].lastGL&&(h[S].geo!==void 0&&h[S].geo.dispose(),h[S].mat!==void 0&&h[S].mat.dispose(),this.modelGroup.remove(h[S].lastGL));delete this.surfaces[l]}return this.show(),this}jmolMoveTo(){var l=this.modelGroup.position,h="center { "+-l.x+" "+-l.y+" "+-l.z+" }; ",S=this.rotationGroup.quaternion;return h+="moveto .5 quaternion { "+S.x+" "+S.y+" "+S.z+" "+S.w+" };",h}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(l,h){h=h||{};var S=this.getAtomsFromSel(h);if(typeof l=="function")for(let D=0,L=S.length;D<L;D++){let V=S[D];l(V)}else for(let D=0,L=S.length;D<L;D++){var E=S[D];for(let V=0,O=l.length;V<O;V++){let W=l[V];if(W.props)for(var F in W.props)W.props.hasOwnProperty(F)&&this.atomIsSelected(E,W)&&(E.properties||(E.properties={}),E.properties[F]=W.props[F])}}return this}linkViewer(l){return this.linkedViewers.push(l),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(l){this.rotationGroup.position.z=this.CAMERA_Z-l}setAutoEyeSeparation(l,h){var S=this.getPerceivedDistance();return h||(h=5),l||this.camera.position.x>0?this.camera.position.x=S*Math.tan(Math.PI/180*h):this.camera.position.x=-S*Math.tan(Math.PI/180*h),this.camera.lookAt(new v.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(l){this.config.cartoonQuality=l}}s.numWorkers=4,s.maxVolume=64e3,s.surfaceTypeMap={VDW:P.SurfaceType.VDW,MS:P.SurfaceType.MS,SAS:P.SurfaceType.SAS,SES:P.SurfaceType.SES};function c(M,l){if(M=(0,b.getElement)(M),!!M){l=l||{};try{var h=new s(M,l);return h}catch(S){throw"error creating viewer: "+S}}}function w(M,l={},h={}){if(M=(0,b.getElement)(M),!!M){var S=[],E=document.createElement("canvas");h.rows=l.rows,h.cols=l.cols,h.control_all=l.control_all!=null?l.control_all:!1,M.appendChild(E);try{for(var F=0;F<l.rows;F++){for(var D=[],L=0;L<l.cols;L++){h.row=F,h.col=L,h.canvas=E,h.viewers=S,h.control_all=l.control_all;var V=c(M,(0,b.extend)({},h));D.push(V)}S.unshift(D)}}catch(O){throw"error creating viewer grid: "+O}return S}}function _(M){var l=this;if(M=(0,b.getElement)(M),!!M){var h=w(M,{rows:1,cols:2,control_all:!0});this.glviewer1=h[0][0],this.glviewer2=h[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var S=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(F){return typeof l.glviewer1[F]=="function"}),E=0;E<S.length;E++)this[S[E]]=(function(F){return function(){var D=this.glviewer1[F].apply(this.glviewer1,arguments),L=this.glviewer2[F].apply(this.glviewer2,arguments);return[D,L]}})(S[E]);this.setCoordinates=function(F,D,L){for(var V=0;V<F.length;V++)F[V].setCoordinates(D,L)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(F){this.glviewer1.render(),this.glviewer2.render(),F&&F(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}}),"./src/Gradient.ts":((n,t,r)=>{r.r(t),r.d(t,{CustomLinear:()=>g,Gradient:()=>P,GradientType:()=>v,ROYGB:()=>y,RWB:()=>p,Sinebow:()=>k,builtinGradients:()=>R,getGradient:()=>b,normalizeValue:()=>x});var u=r("./src/colors.ts");class v{}function x(T,C,a){return C>=T?(a<T&&(a=T),a>C&&(a=C),{lo:T,hi:C,val:a}):(a>T&&(a=T),a<C&&(a=C),a=T-a+C,{lo:C,hi:T,val:a})}function b(T){if(T instanceof v)return T;if(T.gradient!==void 0&&R[T.gradient]){let C=T.min===void 0?-1:T.min,a=T.max===void 0?1:T.max;return T.mid===void 0?T.colors===void 0?new R[T.gradient](C,a):new R[T.gradient](C,a,T.colors):new R[T.gradient](C,a,T.mid)}else if(typeof T.gradient=="string"&&T.gradient.startsWith("linear_")){let C=T.gradient.split("_");C.shift();let a=T.min===void 0?-1:T.min,s=T.max===void 0?1:T.max;return new g(a,s,C)}return T}class p extends v{constructor(C,a,s){super(),this.gradient="RWB",this.mult=1,this.mid=s,this.min=C,this.max=a,typeof a>"u"&&Array.isArray(C)&&C.length>=2?(this.max=C[1],this.min=C[0]):C&&a&&!Array.isArray(C)&&(this.min=C,this.max=a)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(C,a){var s,c;if(C=this.mult*C,a?(s=a[0],c=a[1]):(s=this.min,c=this.max),C===void 0)return 16777215;var w=x(s,c,C);s=w.lo,c=w.hi,C=w.val;var _=(c+s)/2;a&&typeof a[2]<"u"?_=a[2]:typeof this.mid<"u"?_=this.mid:_=(s+c)/2;var M,l;return C<_?(M=Math.floor(255*Math.sqrt((C-s)/(_-s))),l=16711680+256*M+M,l):C>_?(M=Math.floor(255*Math.sqrt(1-(C-_)/(c-_))),l=65536*M+256*M+255,l):16777215}}class y extends v{constructor(C,a){super(),this.gradient="ROYGB",this.mult=1,this.min=C,this.max=a,typeof a>"u"&&Array.isArray(C)&&C.length>=2?(this.max=C[1],this.min=C[0]):C&&a&&!Array.isArray(C)&&(this.min=C,this.max=a)}valueToHex(C,a){var s,c;if(C=this.mult*C,a?(s=a[0],c=a[1]):(s=this.min,c=this.max),typeof C>"u")return 16777215;var w=x(s,c,C);s=w.lo,c=w.hi,C=w.val;var _=(s+c)/2,M=(s+_)/2,l=(_+c)/2,h,S;return C<M?(h=Math.floor(255*Math.sqrt((C-s)/(M-s))),S=16711680+256*h+0,S):C<_?(h=Math.floor(255*Math.sqrt(1-(C-M)/(_-M))),S=65536*h+65280+0,S):C<l?(h=Math.floor(255*Math.sqrt((C-_)/(l-_))),S=65280+1*h,S):(h=Math.floor(255*Math.sqrt(1-(C-l)/(c-l))),S=0+256*h+255,S)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class k extends v{constructor(C,a){super(),this.gradient="Sinebow",this.mult=1,this.min=C,this.max=a,typeof a>"u"&&Array.isArray(C)&&C.length>=2&&(this.max=C[1],this.min=C[0]),a<C&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(C,a){var s,c;if(C=this.mult*C,a?(s=a[0],c=a[1]):(s=this.min,c=this.max),typeof C>"u")return 16777215;var w=P.normalizeValue(s,c,C);s=w.lo,c=w.hi,C=w.val;var _=(C-s)/(c-s),M=5*_/6+.5,l=Math.sin(Math.PI*M);l*=l*255;var h=Math.sin(Math.PI*(M+1/3));h*=h*255;var S=Math.sin(Math.PI*(M+2/3));return S*=S*255,65536*Math.floor(l)+256*Math.floor(S)+1*Math.floor(h)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class g extends v{constructor(C,a,s){super(),this.gradient="linear",this.colors=new Array;var c;if(Array.isArray(C)&&C.length>=2?(this.max=C[1],this.min=C[0],c=a):(this.min=C,this.max=a,c=s),c)for(let w of c)this.colors.push(u.CC.color(w));else this.colors.push(u.CC.color(0))}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(C,a){var s,c;if(a?(s=a[0],c=a[1]):(s=this.min,c=this.max),C===void 0)return 16777215;var w=x(s,c,C);s=w.lo,c=w.hi,C=w.val;let _=this.colors.length,M=(c-s)/_,l=Math.min(Math.floor((C-s)/M),_-1),h=Math.min(l+1,_-1),S=(C-s-l*M)/M,E=this.colors[l],F=this.colors[h];return new u.Color(E.r+S*(F.r-E.r),E.g+S*(F.g-E.g),E.b+S*(F.b-E.b)).getHex()}}const R={rwb:p,RWB:p,roygb:y,ROYGB:y,sinebow:k,linear:g};class P extends v{valueToHex(C,a){return 0}range(){return null}}P.RWB=p,P.ROYGB=y,P.Sinebow=k,P.CustomLinear=g,P.builtinGradients=R,P.normalizeValue=x,P.getGradient=b}),"./src/Label.ts":((n,t,r)=>{r.r(t),r.d(t,{Label:()=>k,LabelCount:()=>b});var u=r("./src/WebGL/index.ts"),v=r("./src/Gradient.ts"),x=r("./src/colors.ts");let b=0;function p(g,R,P,T,C,a,s){g.beginPath(),g.moveTo(R+a,P),g.lineTo(R+T-a,P),g.quadraticCurveTo(R+T,P,R+T,P+a),g.lineTo(R+T,P+C-a),g.quadraticCurveTo(R+T,P+C,R+T-a,P+C),g.lineTo(R+a,P+C),g.quadraticCurveTo(R,P+C,R,P+C-a),g.lineTo(R,P+a),g.quadraticCurveTo(R,P,R+a,P),g.closePath(),g.fill(),s&&g.stroke()}function y(g,R,P){var T=P;return typeof g<"u"&&(g instanceof x.Color?T=g.scaled():(T=x.CC.color(g),typeof T.scaled<"u"&&(T=T.scaled()))),typeof R<"u"&&(T.a=parseFloat(R)),T}class k{constructor(R,P){this.id=b++,this.stylespec=P||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new u.Sprite,this.text=R,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}setContext(){var R=this.stylespec,P=typeof R.useScreen>"u"?!1:R.useScreen,T=R.showBackground;(T==="0"||T==="false")&&(T=!1),typeof T>"u"&&(T=!0);var C=R.font?R.font:"sans-serif",a=parseInt(R.fontSize)?parseInt(R.fontSize):18,s=y(R.fontColor,R.fontOpacity,{r:255,g:255,b:255,a:1}),c=R.padding?R.padding:4,w=R.borderThickness?R.borderThickness:0,_=y(R.backgroundColor,R.backgroundOpacity,{r:0,g:0,b:0,a:1}),M=y(R.borderColor,R.borderOpacity,_),l=R.position?R.position:{x:-10,y:1,z:1},h=R.inFront!==void 0?R.inFront:!0;(h==="false"||h==="0")&&(h=!1);var S=R.alignment||u.SpriteAlignment.topLeft;typeof S=="string"&&S in u.SpriteAlignment&&(S=u.SpriteAlignment[S]);var E="";R.bold&&(E="bold "),this.context.font=E+a+"px  "+C;var F=this.context.measureText(this.text),D=F.width;T||(w=0);var L=D+2.5*w+2*c,V=a*1.25+2*w+2*c;if(R.backgroundImage){var O=R.backgroundImage,W=R.backgroundWidth?R.backgroundWidth:O.width,H=R.backgroundHeight?R.backgroundHeight:O.height;W>L&&(L=W),H>V&&(V=H)}if(this.canvas.width=L,this.canvas.height=V,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),E="",R.bold&&(E="bold "),this.context.font=E+a+"px  "+C,this.context.fillStyle="rgba("+_.r+","+_.g+","+_.b+","+_.a+")",this.context.strokeStyle="rgba("+M.r+","+M.g+","+M.b+","+M.a+")",R.backgroundGradient){let U=this.context.createLinearGradient(0,V/2,L,V/2),B=v.Gradient.getGradient(R.backgroundGradient),Y=B.range(),X=-1,N=1;Y&&(X=Y[0],N=Y[1]);let J=N-X;for(let ae=0;ae<1.01;ae+=.1){let se=y(B.valueToHex(X+J*ae)),he="rgba("+se.r+","+se.g+","+se.b+","+se.a+")";U.addColorStop(ae,he)}this.context.fillStyle=U}this.context.lineWidth=w,T&&p(this.context,w,w,L-2*w,V-2*w,6,w>0),R.backgroundImage&&this.context.drawImage(O,0,0,L,V),this.context.fillStyle="rgba("+s.r+","+s.g+","+s.b+","+s.a+")",this.context.fillText(this.text,w+c,a+w+c,D);var q=new u.Texture(this.canvas);q.needsUpdate=!0,this.sprite.material=new u.SpriteMaterial({map:q,useScreenCoordinates:P,alignment:S,depthTest:!h,screenOffset:R.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(l.x,l.y,l.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}}),"./src/ProteinSurface4.ts":((n,t,r)=>{r.r(t),r.d(t,{MarchingCube:()=>y,MarchingCubeInitializer:()=>p,PointGrid:()=>k,ProteinSurface:()=>g,SurfaceType:()=>v,setSyncSurface:()=>b,syncSurface:()=>x});var u=r("./src/WebGL/math/index.ts"),v;(function(R){R[R.VDW=1]="VDW",R[R.MS=2]="MS",R[R.SAS=3]="SAS",R[R.SES=4]="SES"})(v||(v={}));var x=!1;function b(R){x=R}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&(x=!0);class p{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(P,T,C,a){let s=!!a.fulltable,c=a.hasOwnProperty("origin")&&a.origin.hasOwnProperty("x")?a.origin:{x:0,y:0,z:0},w=!!a.voxel,_=a.matrix,M=a.nX||0,l=a.nY||0,h=a.nZ||0,S=a.scale||1,E=null;a.unitCube?E=a.unitCube:E={x:S,y:S,z:S};let F=new Int32Array(M*l*h),D,L;for(D=0,L=F.length;D<L;++D)F[D]=-1;let V=function(q,U,B,Y,X,N){let J={x:0,y:0,z:0},ae=!!(Y&1<<X),se=!!(Y&1<<N),he=X;if(!ae&&se&&(he=N),he&1&&B++,he&2&&U++,he&4&&q++,_){let de=new u.Vector3(q,U,B);de=de.applyMatrix4(_),J={x:de.x,y:de.y,z:de.z}}else J.x=c.x+E.x*q,J.y=c.y+E.y*U,J.z=c.z+E.z*B;let pe=(l*q+U)*h+B;return w?(T.push(J),T.length-1):(F[pe]<0&&(F[pe]=T.length,T.push(J)),F[pe])},O=new Int32Array(12),W=s?this.edgeTable2:this.edgeTable,H=s?this.triTable2:this.triTable;for(D=0;D<M-1;++D)for(let q=0;q<l-1;++q)for(let U=0;U<h-1;++U){let B=0;for(let N=0;N<8;++N){let J=(l*(D+((N&4)>>2))+q+((N&2)>>1))*h+U+(N&1),ae=!!(P[J]&this.ISDONE);B|=ae<<N}if(B===0||B===255)continue;let Y=W[B];if(Y===0)continue;let X=H[B];Y&1&&(O[0]=V(D,q,U,B,0,1)),Y&2&&(O[1]=V(D,q,U,B,1,3)),Y&4&&(O[2]=V(D,q,U,B,3,2)),Y&8&&(O[3]=V(D,q,U,B,2,0)),Y&16&&(O[4]=V(D,q,U,B,4,5)),Y&32&&(O[5]=V(D,q,U,B,5,7)),Y&64&&(O[6]=V(D,q,U,B,7,6)),Y&128&&(O[7]=V(D,q,U,B,6,4)),Y&256&&(O[8]=V(D,q,U,B,0,4)),Y&512&&(O[9]=V(D,q,U,B,1,5)),Y&1024&&(O[10]=V(D,q,U,B,3,7)),Y&2048&&(O[11]=V(D,q,U,B,2,6));for(let N=0;N<X.length;N+=3){let J=O[X[N]],ae=O[X[N+1]],se=O[X[N+2]];w&&N>=3&&(T.push(T[J]),J=T.length-1,T.push(T[ae]),ae=T.length-1,T.push(T[se]),se=T.length-1),C.push(J),C.push(ae),C.push(se)}}}laplacianSmooth(P,T,C){let a=new Array(T.length),s,c,w,_,M;for(s=0,c=T.length;s<c;s++)a[s]={x:0,y:0,z:0};let l=new Array(20),h;for(s=0;s<20;s++)l[s]=new Array(T.length);for(s=0,c=T.length;s<c;s++)l[0][s]=0;for(s=0,c=C.length/3;s<c;s++){let F=s*3,D=s*3+1,L=s*3+2;for(h=!0,w=0,_=l[0][C[F]];w<_;w++)if(C[D]==l[w+1][C[F]]){h=!1;break}for(h&&(l[0][C[F]]++,l[l[0][C[F]]][C[F]]=C[D]),h=!0,w=0,_=l[0][C[F]];w<_;w++)if(C[L]==l[w+1][C[F]]){h=!1;break}for(h&&(l[0][C[F]]++,l[l[0][C[F]]][C[F]]=C[L]),h=!0,w=0,_=l[0][C[D]];w<_;w++)if(C[F]==l[w+1][C[D]]){h=!1;break}for(h&&(l[0][C[D]]++,l[l[0][C[D]]][C[D]]=C[F]),h=!0,w=0,_=l[0][C[D]];w<_;w++)if(C[L]==l[w+1][C[D]]){h=!1;break}for(h&&(l[0][C[D]]++,l[l[0][C[D]]][C[D]]=C[L]),h=!0,w=0;w<l[0][C[L]];w++)if(C[F]==l[w+1][C[L]]){h=!1;break}for(h&&(l[0][C[L]]++,l[l[0][C[L]]][C[L]]=C[F]),h=!0,w=0,_=l[0][C[L]];w<_;w++)if(C[D]==l[w+1][C[L]]){h=!1;break}h&&(l[0][C[L]]++,l[l[0][C[L]]][C[L]]=C[D])}let S=1,E=.5;for(M=0;M<P;M++){for(s=0,c=T.length;s<c;s++)if(l[0][s]<3)a[s].x=T[s].x,a[s].y=T[s].y,a[s].z=T[s].z;else if(l[0][s]==3||l[0][s]==4){for(a[s].x=0,a[s].y=0,a[s].z=0,w=0,_=l[0][s];w<_;w++)a[s].x+=T[l[w+1][s]].x,a[s].y+=T[l[w+1][s]].y,a[s].z+=T[l[w+1][s]].z;a[s].x+=E*T[s].x,a[s].y+=E*T[s].y,a[s].z+=E*T[s].z,a[s].x/=E+l[0][s],a[s].y/=E+l[0][s],a[s].z/=E+l[0][s]}else{for(a[s].x=0,a[s].y=0,a[s].z=0,w=0,_=l[0][s];w<_;w++)a[s].x+=T[l[w+1][s]].x,a[s].y+=T[l[w+1][s]].y,a[s].z+=T[l[w+1][s]].z;a[s].x+=S*T[s].x,a[s].y+=S*T[s].y,a[s].z+=S*T[s].z,a[s].x/=S+l[0][s],a[s].y/=S+l[0][s],a[s].z/=S+l[0][s]}for(s=0,c=T.length;s<c;s++)T[s].x=a[s].x,T[s].y=a[s].y,T[s].z=a[s].z}}}let y=new p;class k{constructor(P,T,C){this.data=new Int32Array(P*T*C*3),this.width=T,this.height=C}set(P,T,C,a){let s=((P*this.width+T)*this.height+C)*3;this.data[s]=a.ix,this.data[s+1]=a.iy,this.data[s+2]=a.iz}get(P,T,C){let a=((P*this.width+T)*this.height+C)*3;return{ix:this.data[a],iy:this.data[a+1],iz:this.data[a+2]}}}class g{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],g.MarchingCube||(g.MarchingCube=new p)}getVDWIndex(P){return!P.elem||typeof this.vdwRadii[P.elem]>"u"?"X":P.elem}getFacesAndVertices(P){let T={};for(let s=0,c=P.length;s<c;s++)T[P[s]]=!0;let C=this.verts;for(let s=0,c=C.length;s<c;s++)C[s].x=C[s].x/this.scaleFactor-this.ptranx,C[s].y=C[s].y/this.scaleFactor-this.ptrany,C[s].z=C[s].z/this.scaleFactor-this.ptranz;let a=[];for(let s=0,c=this.faces.length;s<c;s+=3){let w=this.faces[s],_=this.faces[s+1],M=this.faces[s+2],l=C[w].atomid,h=C[_].atomid,S=C[M].atomid,E=l;h<E&&(E=h),S<E&&(E=S),T[E]&&w!==_&&_!==M&&w!==M&&(a.push(w),a.push(_),a.push(M))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:C,faces:a}}initparm(P,T,C){C>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let a=1/this.scaleFactor*5.5;this.pminx=P[0][0],this.pmaxx=P[1][0],this.pminy=P[0][1],this.pmaxy=P[1][1],this.pminz=P[0][2],this.pmaxz=P[1][2],T?(this.pminx-=this.probeRadius+a,this.pminy-=this.probeRadius+a,this.pminz-=this.probeRadius+a,this.pmaxx+=this.probeRadius+a,this.pmaxy+=this.probeRadius+a,this.pmaxz+=this.probeRadius+a):(this.pminx-=a,this.pminy-=a,this.pminz-=a,this.pmaxx+=a,this.pmaxy+=a,this.pmaxz+=a),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(T),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(P){let T={};for(const C in this.vdwRadii){let a=this.vdwRadii[C];P?T[C]=(a+this.probeRadius)*this.scaleFactor+.5:T[C]=a*this.scaleFactor+.5;let s=T[C]*T[C];this.widxz[C]=Math.floor(T[C])+1,this.depty[C]=new Int32Array(this.widxz[C]*this.widxz[C]);let c=0;for(let w=0;w<this.widxz[C];w++)for(let _=0;_<this.widxz[C];_++){let M=w*w+_*_;if(M>s)this.depty[C][c]=-1;else{let l=Math.sqrt(s-M);this.depty[C][c]=Math.floor(l)}c++}}}fillvoxels(P,T){for(let C=0,a=this.vpBits.length;C<a;C++)this.vpBits[C]=0,this.vpDistance[C]=-1,this.vpAtomID[C]=-1;for(let C in T){let a=P[T[C]];a!==void 0&&this.fillAtom(a,P)}for(let C=0,a=this.vpBits.length;C<a;C++)this.vpBits[C]&this.INOUT&&(this.vpBits[C]|=this.ISDONE)}fillAtom(P,T){let C=Math.floor(.5+this.scaleFactor*(P.x+this.ptranx)),a=Math.floor(.5+this.scaleFactor*(P.y+this.ptrany)),s=Math.floor(.5+this.scaleFactor*(P.z+this.ptranz)),c=this.getVDWIndex(P),w=0,_=this.pWidth*this.pHeight;for(let M=0,l=this.widxz[c];M<l;M++)for(let h=0;h<l;h++){if(this.depty[c][w]!=-1){for(let S=-1;S<2;S++)for(let E=-1;E<2;E++)for(let F=-1;F<2;F++)if(S!==0&&E!==0&&F!==0){let D=S*M,L=F*h;for(let V=0;V<=this.depty[c][w];V++){let O=V*E,W=C+D,H=a+O,q=s+L;if(W<0||H<0||q<0||W>=this.pLength||H>=this.pWidth||q>=this.pHeight)continue;let U=W*_+H*this.pHeight+q;if(!(this.vpBits[U]&this.INOUT))this.vpBits[U]|=this.INOUT,this.vpAtomID[U]=P.serial;else{let B=T[this.vpAtomID[U]];if(B.serial!=P.serial){let Y=C+D-Math.floor(.5+this.scaleFactor*(B.x+this.ptranx)),X=a+O-Math.floor(.5+this.scaleFactor*(B.y+this.ptrany)),N=s+L-Math.floor(.5+this.scaleFactor*(B.z+this.ptranz));D*D+O*O+L*L<Y*Y+X*X+N*N&&(this.vpAtomID[U]=P.serial)}}}}}w++}}fillvoxelswaals(P,T){for(let C=0,a=this.vpBits.length;C<a;C++)this.vpBits[C]&=~this.ISDONE;for(let C in T){let a=P[T[C]];a!==void 0&&this.fillAtomWaals(a,P)}}fillAtomWaals(P,T){let C=0,a=Math.floor(.5+this.scaleFactor*(P.x+this.ptranx)),s=Math.floor(.5+this.scaleFactor*(P.y+this.ptrany)),c=Math.floor(.5+this.scaleFactor*(P.z+this.ptranz)),w=this.getVDWIndex(P),_=this.pWidth*this.pHeight;for(let M=0,l=this.widxz[w];M<l;M++)for(let h=0;h<l;h++){if(this.depty[w][C]!=-1){for(let S=-1;S<2;S++)for(let E=-1;E<2;E++)for(let F=-1;F<2;F++)if(S!==0&&E!==0&&F!==0){let D=S*M,L=F*h;for(let V=0;V<=this.depty[w][C];V++){let O=V*E,W=a+D,H=s+O,q=c+L;if(W<0||H<0||q<0||W>=this.pLength||H>=this.pWidth||q>=this.pHeight)continue;let U=W*_+H*this.pHeight+q;if(!(this.vpBits[U]&this.ISDONE))this.vpBits[U]|=this.ISDONE,this.vpAtomID[U]=P.serial;else{let B=T[this.vpAtomID[U]];if(B.serial!=P.serial){let Y=a+D-Math.floor(.5+this.scaleFactor*(B.x+this.ptranx)),X=s+O-Math.floor(.5+this.scaleFactor*(B.y+this.ptrany)),N=c+L-Math.floor(.5+this.scaleFactor*(B.z+this.ptranz));D*D+O*O+L*L<Y*Y+X*X+N*N&&(this.vpAtomID[U]=P.serial)}}}}}C++}}buildboundary(){let P=this.pWidth*this.pHeight;for(let T=0;T<this.pLength;T++)for(let C=0;C<this.pHeight;C++)for(let a=0;a<this.pWidth;a++){let s=T*P+a*this.pHeight+C;if(this.vpBits[s]&this.INOUT){let c=0;for(;c<26;){let w=T+this.nb[c][0],_=C+this.nb[c][2],M=a+this.nb[c][1];if(w>-1&&w<this.pLength&&M>-1&&M<this.pWidth&&_>-1&&_<this.pHeight&&!(this.vpBits[w*P+M*this.pHeight+_]&this.INOUT)){this.vpBits[s]|=this.ISBOUND;break}else c++}}}}fastdistancemap(){let P=new k(this.pLength,this.pWidth,this.pHeight),T=this.pWidth*this.pHeight,C=this.cutRadius*this.cutRadius,a=[],s=[],c;for(let M=0;M<this.pLength;M++)for(let l=0;l<this.pWidth;l++)for(let h=0;h<this.pHeight;h++)if(c=M*T+l*this.pHeight+h,this.vpBits[c]&=~this.ISDONE,this.vpBits[c]&this.INOUT&&this.vpBits[c]&this.ISBOUND){let S={ix:M,iy:l,iz:h};P.set(M,l,h,S),a.push(S),this.vpDistance[c]=0,this.vpBits[c]|=this.ISDONE,this.vpBits[c]&=~this.ISBOUND}do{s=this.fastoneshell(a,P),a=[];for(let M=0,l=s.length;M<l;M++)c=T*s[M].ix+this.pHeight*s[M].iy+s[M].iz,this.vpBits[c]&=~this.ISBOUND,this.vpDistance[c]<=1.0404*C&&a.push({ix:s[M].ix,iy:s[M].iy,iz:s[M].iz})}while(a.length!==0);a=[],s=[],P=null;let w=this.scaleFactor-.5;w<0&&(w=0);let _=C-.5/(.1+w);for(let M=0;M<this.pLength;M++)for(let l=0;l<this.pWidth;l++)for(let h=0;h<this.pHeight;h++)c=M*T+l*this.pHeight+h,this.vpBits[c]&=~this.ISBOUND,this.vpBits[c]&this.INOUT&&(!(this.vpBits[c]&this.ISDONE)||this.vpBits[c]&this.ISDONE&&this.vpDistance[c]>=_)&&(this.vpBits[c]|=this.ISBOUND)}fastoneshell(P,T){let C,a,s,c,w,_,M,l,h,S=[];if(P.length===0)return S;let E={ix:-1,iy:-1,iz:-1},F=this.pWidth*this.pHeight;for(let D=0,L=P.length;D<L;D++){C=P[D].ix,a=P[D].iy,s=P[D].iz,l=T.get(C,a,s);for(let V=0;V<6;V++)E.ix=C+this.nb[V][0],E.iy=a+this.nb[V][1],E.iz=s+this.nb[V][2],E.ix<this.pLength&&E.ix>-1&&E.iy<this.pWidth&&E.iy>-1&&E.iz<this.pHeight&&E.iz>-1&&(h=E.ix*F+this.pHeight*E.iy+E.iz,this.vpBits[h]&this.INOUT&&!(this.vpBits[h]&this.ISDONE)?(T.set(E.ix,E.iy,s+this.nb[V][2],l),c=E.ix-l.ix,w=E.iy-l.iy,_=E.iz-l.iz,M=c*c+w*w+_*_,this.vpDistance[h]=M,this.vpBits[h]|=this.ISDONE,this.vpBits[h]|=this.ISBOUND,S.push({ix:E.ix,iy:E.iy,iz:E.iz})):this.vpBits[h]&this.INOUT&&this.vpBits[h]&this.ISDONE&&(c=E.ix-l.ix,w=E.iy-l.iy,_=E.iz-l.iz,M=c*c+w*w+_*_,M<this.vpDistance[h]&&(T.set(E.ix,E.iy,E.iz,l),this.vpDistance[h]=M,this.vpBits[h]&this.ISBOUND||(this.vpBits[h]|=this.ISBOUND,S.push({ix:E.ix,iy:E.iy,iz:E.iz})))))}for(let D=0,L=P.length;D<L;D++){C=P[D].ix,a=P[D].iy,s=P[D].iz,l=T.get(C,a,s);for(let V=6;V<18;V++)E.ix=C+this.nb[V][0],E.iy=a+this.nb[V][1],E.iz=s+this.nb[V][2],E.ix<this.pLength&&E.ix>-1&&E.iy<this.pWidth&&E.iy>-1&&E.iz<this.pHeight&&E.iz>-1&&(h=E.ix*F+this.pHeight*E.iy+E.iz,this.vpBits[h]&this.INOUT&&!(this.vpBits[h]&this.ISDONE)?(T.set(E.ix,E.iy,s+this.nb[V][2],l),c=E.ix-l.ix,w=E.iy-l.iy,_=E.iz-l.iz,M=c*c+w*w+_*_,this.vpDistance[h]=M,this.vpBits[h]|=this.ISDONE,this.vpBits[h]|=this.ISBOUND,S.push({ix:E.ix,iy:E.iy,iz:E.iz})):this.vpBits[h]&this.INOUT&&this.vpBits[h]&this.ISDONE&&(c=E.ix-l.ix,w=E.iy-l.iy,_=E.iz-l.iz,M=c*c+w*w+_*_,M<this.vpDistance[h]&&(T.set(E.ix,E.iy,E.iz,l),this.vpDistance[h]=M,this.vpBits[h]&this.ISBOUND||(this.vpBits[h]|=this.ISBOUND,S.push({ix:E.ix,iy:E.iy,iz:E.iz})))))}for(let D=0,L=P.length;D<L;D++){C=P[D].ix,a=P[D].iy,s=P[D].iz,l=T.get(C,a,s);for(let V=18;V<26;V++)E.ix=C+this.nb[V][0],E.iy=a+this.nb[V][1],E.iz=s+this.nb[V][2],E.ix<this.pLength&&E.ix>-1&&E.iy<this.pWidth&&E.iy>-1&&E.iz<this.pHeight&&E.iz>-1&&(h=E.ix*F+this.pHeight*E.iy+E.iz,this.vpBits[h]&this.INOUT&&!(this.vpBits[h]&this.ISDONE)?(T.set(E.ix,E.iy,s+this.nb[V][2],l),c=E.ix-l.ix,w=E.iy-l.iy,_=E.iz-l.iz,M=c*c+w*w+_*_,this.vpDistance[h]=M,this.vpBits[h]|=this.ISDONE,this.vpBits[h]|=this.ISBOUND,S.push({ix:E.ix,iy:E.iy,iz:E.iz})):this.vpBits[h]&this.INOUT&&this.vpBits[h]&this.ISDONE&&(c=E.ix-l.ix,w=E.iy-l.iy,_=E.iz-l.iz,M=c*c+w*w+_*_,M<this.vpDistance[h]&&(T.set(E.ix,E.iy,E.iz,l),this.vpDistance[h]=M,this.vpBits[h]&this.ISBOUND||(this.vpBits[h]|=this.ISBOUND,S.push({ix:E.ix,iy:E.iy,iz:E.iz})))))}return S}marchingcubeinit(P){for(let T=0,C=this.vpBits.length;T<C;T++)P==1?this.vpBits[T]&=~this.ISBOUND:P==4?(this.vpBits[T]&=~this.ISDONE,this.vpBits[T]&this.ISBOUND&&(this.vpBits[T]|=this.ISDONE),this.vpBits[T]&=~this.ISBOUND):P==2?this.vpBits[T]&this.ISBOUND&&this.vpBits[T]&this.ISDONE?this.vpBits[T]&=~this.ISBOUND:this.vpBits[T]&this.ISBOUND&&!(this.vpBits[T]&this.ISDONE)&&(this.vpBits[T]|=this.ISDONE):P==3&&(this.vpBits[T]&=~this.ISBOUND)}marchingcube(P){this.marchingcubeinit(P),this.verts=[],this.faces=[],g.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let T=this.pWidth*this.pHeight;for(let C=0,a=this.verts.length;C<a;C++)this.verts[C].atomid=this.vpAtomID[this.verts[C].x*T+this.pHeight*this.verts[C].y+this.verts[C].z];g.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}g.MarchingCube=new p}),"./src/VolumeData.ts":((n,t,r)=>{r.r(t),r.d(t,{VolumeData:()=>y});var u=r("./src/utilities.ts"),v=r("./src/WebGL/math/index.ts"),x=r("./src/parsers/VASP.ts"),b=r("./src/parsers/CUBE.ts"),p=r("./node_modules/pako/dist/pako.esm.mjs");class y{constructor(g,R,P){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(c){var w=c/(this.size.y*this.size.z),_=c%(this.size.y*this.size.z),M=c%this.size.z;return w*=this.unit.x,_*=this.unit.y,M*=this.unit.z,w+=this.origin.x,_+=this.origin.y,M+=this.origin.z,{x:w,y:_,z:M}},this.vasp=function(c){var w=c.replace(/^\s+/,"").split(/[\n\r]/),_=(0,x.VASP)(c)[0],M=_.length;if(M==0){console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),this.data=[];return}var l=1.889725992,h=.036749309,S=parseFloat(w[1]),E;E=w[2].replace(/^\s+/,"").split(/\s+/);var F=new v.Vector3(parseFloat(E[0]),parseFloat(E[1]),parseFloat(E[2])).multiplyScalar(S*l);E=w[3].replace(/^\s+/,"").split(/\s+/);var D=new v.Vector3(parseFloat(E[0]),parseFloat(E[1]),parseFloat(E[2])).multiplyScalar(S*l);E=w[4].replace(/^\s+/,"").split(/\s+/);var L=new v.Vector3(parseFloat(E[0]),parseFloat(E[1]),parseFloat(E[2])).multiplyScalar(S*l),V=F.x*(D.y*L.z-L.y*D.z)-D.x*(F.y*L.z-L.y*F.z)+L.x*(F.y*D.z-D.y*F.z);V=Math.abs(V)/Math.pow(l,3);var O=1/V;w.splice(0,8+M+1);var W=w[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),H=Math.abs(parseFloat(W[0])),q=Math.abs(parseFloat(W[1])),U=Math.abs(parseFloat(W[2])),B=this.origin=new v.Vector3(0,0,0);this.size={x:H,y:q,z:U},this.unit=new v.Vector3(F.x,D.y,L.z),F=F.multiplyScalar(1/(l*H)),D=D.multiplyScalar(1/(l*q)),L=L.multiplyScalar(1/(l*U)),(F.y!=0||F.z!=0||D.x!=0||D.z!=0||L.x!=0||L.y!=0)&&(this.matrix=new v.Matrix4(F.x,D.x,L.x,0,F.y,D.y,L.y,0,F.z,D.z,L.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new v.Matrix4().makeTranslation(B.x,B.y,B.z)),this.origin=new v.Vector3(0,0,0),this.unit=new v.Vector3(1,1,1)),w.splice(0,1);var Y=w.join(" ");Y=Y.replace(/^\s+/,"");var X=Y.split(/[\s\r]+/);X.splice(H*q*U+1);for(var N=Float32Array.from(X,parseFloat),J=0;J<N.length;J++)N[J]=N[J]*O*h;this.data=N},this.dx=function(c){var w=c.split(/[\n\r]+/),_,M=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,l=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,h=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,S=/data follows/,E=0;for(E=0;E<w.length;E++){var F=w[E];if(_=M.exec(F)){var D=parseInt(_[1]),L=parseInt(_[2]),V=parseInt(_[3]);this.size={x:D,y:L,z:V}}else if(_=h.exec(F)){var O=parseFloat(_[1]);if((parseFloat(_[2])!=0||parseFloat(_[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),E+=1,F=w[E],_=h.exec(F),_==null){console.error("Parse error in dx delta matrix");return}var W=parseFloat(_[2]);if((parseFloat(_[1])!=0||parseFloat(_[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),E+=1,F=w[E],_=h.exec(F),_==null){console.error("Parse error in dx delta matrix");return}var H=parseFloat(_[3]);(parseFloat(_[1])!=0||parseFloat(_[2])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new v.Vector3(O,W,H)}else if(_=l.exec(F)){var q=parseFloat(_[1]),U=parseFloat(_[2]),B=parseFloat(_[3]);this.origin=new v.Vector3(q,U,B)}else if(_=S.exec(F))break}if(E+=1,!this.size||!this.origin||!this.unit||!this.size){console.error("Error parsing dx format");return}var Y=w.splice(E).join(" "),X=Y.split(/[\s\r]+/);this.data=Float32Array.from(X,parseFloat)},R=R.toLowerCase(),/\.gz$/.test(R)){R=R.replace(/\.gz$/,"");try{this[R]&&this.isbinary.has(R)?(typeof g=="string"&&(g=(0,u.base64ToArray)(g)),g=(0,p.inflate)(g)):g=new TextDecoder("utf-8").decode((0,p.inflate)(g))}catch(c){console.error(c)}}if(this[R]&&(this.isbinary.has(R)&&typeof g=="string"&&(g=(0,u.base64ToArray)(g)),this[R](g)),P){if(P.negate)for(let c=0,w=this.data.length;c<w;c++)this.data[c]=-this.data[c];if(P.normalize){var T=0;for(let c=0,w=this.data.length;c<w;c++)T+=this.data[c];var C=T/this.data.length;T=0;for(let c=0,w=this.data.length;c<w;c++){var a=this.data[c]-C;T+=a*a}var s=T/this.data.length;for(let c=0,w=this.data.length;c<w;c++)this.data[c]=(this.data[c]-C)/s}}}getIndex(g,R,P){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new v.Matrix4().getInverse(this.matrix));var T=new v.Vector3(g,R,P);T=T.applyMatrix4(this.inversematrix),g=T.x,R=T.y,P=T.z}else g-=this.origin.x,R-=this.origin.y,P-=this.origin.z,g/=this.unit.x,R/=this.unit.y,P/=this.unit.z;return g=Math.round(g),R=Math.round(R),P=Math.round(P),g<0||g>=this.size.x||R<0||R>=this.size.y||P<0||P>=this.size.z?-1:g*this.size.y*this.size.z+R*this.size.z+P}getVal(g,R,P){let T=this.getIndex(g,R,P);return T<0?0:this.data[T]}cube(g){var R=g.split(/\r?\n/);if(!(R.length<6)){var P=(0,b.CUBE)(g,{}).modelData[0].cryst,T=R[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),C=parseFloat(T[0]),a=Math.abs(C);this.origin=P.origin,this.size=P.size,this.unit=P.unit,this.matrix=P.matrix4;var s=6;C<0&&s++;var c=R.splice(a+s).join(" ");c=c.replace(/^\s+/,"");var w=c.split(/[\s\r]+/);this.data=Float32Array.from(w,parseFloat)}}ccp4(g){var R={};g=new Int8Array(g);var P=new Int32Array(g.buffer,0,56),T=new Float32Array(g.buffer,0,56),C=new DataView(g.buffer);if(R.MAP=String.fromCharCode(C.getUint8(208),C.getUint8(209),C.getUint8(210),C.getUint8(211)),R.MACHST=[C.getUint8(212),C.getUint8(213)],R.MACHST[0]===17&&R.MACHST[1]===17)for(var a=g.byteLength,s=0;s<a;s+=4)C.setFloat32(s,C.getFloat32(s),!0);R.NX=P[0],R.NY=P[1],R.NZ=P[2],R.MODE=P[3],R.NXSTART=P[4],R.NYSTART=P[5],R.NZSTART=P[6],R.MX=P[7],R.MY=P[8],R.MZ=P[9],R.xlen=T[10],R.ylen=T[11],R.zlen=T[12],R.alpha=T[13],R.beta=T[14],R.gamma=T[15],R.MAPC=P[16],R.MAPR=P[17],R.MAPS=P[18],R.DMIN=T[19],R.DMAX=T[20],R.DMEAN=T[21],R.ISPG=P[22],R.NSYMBT=P[23],R.LSKFLG=P[24],R.originX=T[49],R.originY=T[50],R.originZ=T[51],R.ARMS=T[54];var c=R,w=[c.xlen,0,0],_=[c.ylen*Math.cos(Math.PI/180*c.gamma),c.ylen*Math.sin(Math.PI/180*c.gamma),0],M=[c.zlen*Math.cos(Math.PI/180*c.beta),c.zlen*(Math.cos(Math.PI/180*c.alpha)-Math.cos(Math.PI/180*c.gamma)*Math.cos(Math.PI/180*c.beta))/Math.sin(Math.PI/180*c.gamma),0];M[2]=Math.sqrt(c.zlen*c.zlen*Math.sin(Math.PI/180*c.beta)*Math.sin(Math.PI/180*c.beta)-M[1]*M[1]);var l=[0,w,_,M],h=[0,c.MX,c.MY,c.MZ],S=[0,c.MAPC,c.MAPR,c.MAPS];this.matrix=new v.Matrix4,this.matrix.set(l[S[1]][0]/h[S[1]],l[S[2]][0]/h[S[2]],l[S[3]][0]/h[S[3]],0,l[S[1]][1]/h[S[1]],l[S[2]][1]/h[S[2]],l[S[3]][1]/h[S[3]],0,l[S[1]][2]/h[S[1]],l[S[2]][2]/h[S[2]],l[S[3]][2]/h[S[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new v.Matrix4().makeTranslation(c.NXSTART+c.originX,c.NYSTART+c.originY,c.NZSTART+c.originZ)),this.origin=new v.Vector3(0,0,0),this.unit=new v.Vector3(1,1,1),this.size={x:R.NX,y:R.NY,z:R.NZ},this.dimensionorder=[R.MAPC,R.MAPR,R.MAPS];var E=new Float32Array(g.buffer,1024+R.NSYMBT),F=R.NX,D=R.NY,L=R.NZ;this.data=new Float32Array(F*D*L);for(let V=0;V<F;V++)for(let O=0;O<D;O++)for(let W=0;W<L;W++)this.data[(V*D+O)*L+W]=E[(W*D+O)*F+V]}}}),"./src/VolumetricRender.ts":((n,t,r)=>{r.r(t),r.d(t,{GLVolumetricRender:()=>y});var u=r("./src/WebGL/shapes/index.ts"),v=r("./src/WebGL/math/index.ts"),x=r("./src/WebGL/index.ts"),b=r("./src/colors.ts"),p=r("./src/GLShape.ts");class y{static interpolateArray(g,R){function P(M,l,h){return M+(l-M)*h}var T=[],C=(g.length-1)/(R-1);T[0]=g[0];for(var a=1;a<R-1;a++){var s=a*C,c=Math.floor(s),w=Math.ceil(s),_=s-c;T[a]=P(g[c],g[w],_)}return T[R-1]=g[g.length-1],T}constructor(g,R,P){this.hidden=!1,this.boundingSphere=new u.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,R=R||{};var T=Object.assign([],R.transferfn);this.subsamples=R.subsamples||5;let C=256;T.forEach(function(D){D.value=parseFloat(D.value)}),T.sort(function(D,L){return D.value-L.value}),this.min=T[0].value,T.length==0&&T.push(T[0]),this.max=T[T.length-1].value;var a,s,c,w,_,M,l,h,S,E;for(let D=0;D<T.length-1;D++)if(c=b.CC.color(T[D].color),w=b.CC.color(T[D+1].color),S=T[D].opacity,E=T[D+1].opacity,a=Math.floor((T[D].value-this.min)*C/(this.max-this.min)),s=Math.floor((T[D+1].value-this.min)*C/(this.max-this.min)),a!=s){_=y.interpolateArray([c.r*255,w.r*255],s-a),M=y.interpolateArray([c.g*255,w.g*255],s-a),l=y.interpolateArray([c.b*255,w.b*255],s-a),h=y.interpolateArray([S*255,E*255],s-a);for(let L=0;L<_.length;L++)this.transferfunctionbuffer.push(_[L]),this.transferfunctionbuffer.push(M[L]),this.transferfunctionbuffer.push(l[L]),this.transferfunctionbuffer.push(h[L])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),g.matrix){let D=new v.Vector3(0,0,0),L=new v.Vector3(g.size.x,g.size.y,g.size.z),V=new v.Vector3(1,1,1);D.applyMatrix4(g.matrix),L.applyMatrix4(g.matrix),V.applyMatrix4(g.matrix).sub(D),this.extent=[[D.x,D.y,D.z],[L.x,L.y,L.z]];for(let q=1;q<7;q++)L.x=q&1?g.size.x:0,L.y=q&2?g.size.y:0,L.z=q&4?g.size.z:0,L.applyMatrix4(g.matrix),this.extent[0][0]=Math.min(this.extent[0][0],L.x),this.extent[0][1]=Math.min(this.extent[0][1],L.y),this.extent[0][2]=Math.min(this.extent[0][2],L.z),this.extent[1][0]=Math.max(this.extent[1][0],L.x),this.extent[1][1]=Math.max(this.extent[1][1],L.y),this.extent[1][2]=Math.max(this.extent[1][2],L.z);let O=L.x-D.x,W=L.y-D.y,H=L.z-D.z;this.maxdepth=Math.sqrt(O*O+W*W+H*H),this.minunit=Math.min(Math.min(V.x,V.y),V.z),this.texmatrix=new v.Matrix4().identity().scale({x:g.size.x,y:g.size.y,z:g.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(g.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new v.Matrix4().identity();let D=g.unit.x*g.size.x,L=g.unit.y*g.size.y,V=g.unit.z*g.size.z;this.texmatrix.makeTranslation(-g.origin.x/D,-g.origin.y/L,-g.origin.z/V),this.texmatrix.scale({x:1/D,y:1/L,z:1/V}),this.minunit=Math.min(Math.min(g.unit.x,g.unit.y),g.unit.z),this.extent=[[g.origin.x,g.origin.y,g.origin.z],[g.origin.x+D,g.origin.y+L,g.origin.z+V]],this.maxdepth=Math.sqrt(D*D+L*L+V*V)}var F=new p.GLShape({});if(F.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=F.finalize(),this.boundingSphere.center=new v.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,R.coords===void 0&&R.selection!==void 0&&(P?R.coords=P.selectedAtoms(R.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),R.coords!==void 0&&R.seldist!==void 0){let D=new Uint8Array(g.data.length),L=R.seldist,V=L*L;for(let O=0,W=R.coords.length;O<W;O++){let H=R.coords[O],q=H.x-L,U=H.y-L,B=H.z-L,Y=H.x+L,X=H.y+L,N=H.z+L;if(g.getIndex(q,U,B)>=0||g.getIndex(Y,X,N)>=0)for(let J=q;J<Y;J+=this.minunit)for(let ae=U;ae<X;ae+=this.minunit)for(let se=B;se<N;se+=this.minunit){let he=g.getIndex(J,ae,se);he>=0&&!D[he]&&(J-H.x)*(J-H.x)+(ae-H.y)*(ae-H.y)+(se-H.z)*(se-H.z)<V&&(D[he]=1)}}for(let O=0,W=g.data.length;O<W;O++)D[O]==0&&(g.data[O]=1/0)}this.data=g}globj(g){if(this.renderedShapeObj&&(g.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new x.Object3D;var R=null,P=new x.Texture(this.data,!0),T=new x.Texture(this.transferfunctionbuffer,!1);P.needsUpdate=!0,T.needsUpdate=!0,T.flipY=!1,R=new x.VolumetricMaterial({transferfn:T,transfermin:this.min,transfermax:this.max,map:P,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var C=new x.Mesh(this.geo,R);this.shapeObj.add(C),this.renderedShapeObj=this.shapeObj.clone(),g.add(this.renderedShapeObj)}}removegl(g){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),g.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}}),"./src/WebGL/Camera.ts":((n,t,r)=>{r.r(t),r.d(t,{Camera:()=>x});var u=r("./src/WebGL/core/index.ts"),v=r("./src/WebGL/math/index.ts");class x extends u.Object3D{constructor(p=50,y=1,k=.1,g=2e3,R=!1){super(),this.projectionMatrix=new v.Matrix4,this.projectionMatrixInverse=new v.Matrix4,this.matrixWorldInverse=new v.Matrix4,this.fov=p,this.aspect=y,this.near=k,this.far=g;var P=this.position.z;this.right=P*Math.tan(Math.PI/180*p),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!R,this.updateProjectionMatrix()}lookAt(p){this.matrix.lookAt(this.position,p,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof v.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}}),"./src/WebGL/Fog.ts":((n,t,r)=>{r.r(t),r.d(t,{Fog:()=>v});var u=r("./src/colors.ts");class v{constructor(b,p=1,y=1e3){this.name="",this.color=new u.Color(b),this.near=p,this.far=y}clone(){return new v(this.color.getHex(),this.near,this.far)}}}),"./src/WebGL/Renderer.ts":((n,t,r)=>{r.r(t),r.d(t,{Renderer:()=>T});var u=r("./src/WebGL/Camera.ts"),v=r("./src/WebGL/constants/Sides.ts"),x=r("./src/WebGL/constants/TextureConstants.ts"),b=r("./src/WebGL/core/index.ts"),p=r("./src/colors.ts"),y=r("./src/WebGL/materials/index.ts"),k=r("./src/WebGL/math/index.ts"),g=r("./src/WebGL/objects/index.ts"),R=r("./src/WebGL/shaders/index.ts"),P=r("./src/WebGL/SpritePlugin.ts");class T{constructor(a){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new k.Vector3,this._worldInverse=new k.Matrix4,this._projInverse=new k.Matrix4,this._textureMatrix=new k.Matrix4,this._fullProjModelMatrix=new k.Matrix4,this._fullProjModelMatrixInv=new k.Matrix4,this._direction=new k.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new P.SpritePlugin,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,a=a||{},this.row=a.row,this.col=a.col,this.rows=a.rows,this.cols=a.cols,this._canvas=a.canvas!==void 0?a.canvas:document.createElement("canvas"),this._precision=a.precision!==void 0?a.precision:"highp",this._alpha=a.alpha!==void 0?a.alpha:!0,this._premultipliedAlpha=a.premultipliedAlpha!==void 0?a.premultipliedAlpha:!0,this._antialias=a.antialias!==void 0?a.antialias:!1,this._preserveDrawingBuffer=a.preserveDrawingBuffer!==void 0?a.preserveDrawingBuffer:!1,this._clearColor=a.clearColor!==void 0?new p.Color(a.clearColor):new p.Color(0),this._clearAlpha=a.clearAlpha!==void 0?a.clearAlpha:0,this._outlineMaterial=new y.MeshOutlineMaterial(a.outline),this._outlineSphereImposterMaterial=new y.SphereImposterOutlineMaterial(a.outline),this._outlineStickImposterMaterial=new y.StickImposterOutlineMaterial(a.outline),this._outlineEnabled=!!a.outline,this._AOEnabled=!!a.ambientOcclusion,a.ambientOcclusion&&typeof a.ambientOcclusion.strength<"u"&&(this._AOstrength=parseFloat(a.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),a.ambientOcclusion&&typeof a.ambientOcclusion.radius<"u"&&(this._AOradius=parseFloat(a.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=a.id,!(a.containerWidth==0||a.containerHeight==0)&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(a,s){this._clearColor.setHex(a),this._clearAlpha=s,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(a){this._outlineMaterial=new y.MeshOutlineMaterial(a),this._outlineSphereImposterMaterial=new y.SphereImposterOutlineMaterial(a),this._outlineStickImposterMaterial=new y.StickImposterOutlineMaterial(a),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(a){a&&(a.strength&&(this._AOstrength=a.strength),a.scale&&(this._AOradius=a.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var a=this._canvas.width/this.cols,s=this._canvas.height/this.rows;this._viewportWidth=a,this._viewportHeight=s,this.isLost()||(this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(a*this.col,s*this.row,a,s),this._gl.viewport(a*this.col,s*this.row,a,s))}}setSize(a,s){if(this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._antialias&&this.devicePixelRatio<2&&(this.devicePixelRatio*=2),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var c=a/this.cols,w=s/this.rows;this._canvas.width=a*this.devicePixelRatio,this._canvas.height=s*this.devicePixelRatio,this._viewportWidth=c*this.devicePixelRatio,this._viewportHeight=w*this.devicePixelRatio,this._canvas.style.width=a+"px",this._canvas.style.height=s+"px",this.setViewport()}else this._viewportWidth=this._canvas.width=a*this.devicePixelRatio,this._viewportHeight=this._canvas.height=s*this.devicePixelRatio,this._canvas.style.width=a+"px",this._canvas.style.height=s+"px",this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight);this.initFrameBuffer()}clear(a,s,c){var w=0;(a===void 0||a)&&(w|=this._gl.COLOR_BUFFER_BIT),(s===void 0||s)&&(w|=this._gl.DEPTH_BUFFER_BIT),(c===void 0||c)&&(w|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(w)}setMaterialFaces(a,s){var c=a.side===v.DoubleSide,w=a.side===v.BackSide;a.imposter||(w=s?!w:w),this._oldDoubleSided!==c&&(c?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=c),this._oldFlipSided!==w&&(w?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=w),this._gl.cullFace(this._gl.BACK)}setDepthTest(a){this._oldDepthTest!==a&&(a?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=a)}setDepthWrite(a){this._oldDepthWrite!==a&&(this._gl.depthMask(a),this._oldDepthWrite=a)}setBlending(a){a?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(a,s,c,w){a.addEventListener("dispose",this.onMaterialDispose.bind(this));var _,M;if(M=a.shaderID,M){var l=R.ShaderLib[M];a.vertexShader=l.vertexShader,a.fragmentShader=l.fragmentShader,a.uniforms=R.ShaderUtils.clone(l.uniforms),a.shaded&&a.makeShaded(this.SHADE_TEXTURE)}_={wireframe:a.wireframe,fragdepth:a.imposter,volumetric:a.volumetric,shaded:a.shaded},a.program=this.buildProgram(a.fragmentShader,a.vertexShader,a.uniforms,_)}renderBuffer(a,s,c,w,_,M){if(w.visible){var l,h;if(l=this.setProgram(a,s,c,w,M,this),!!l){h=l.attributes;var S=!1,E=w.wireframe?1:0,F=_.id*16777215+l.id*2+E;F!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=F,S=!0),S&&(this.disableAttributes(),h.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_.__webglVertexBuffer),this.enableAttribute(h.position),this._gl.vertexAttribPointer(h.position,3,this._gl.FLOAT,!1,0,0)),h.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_.__webglColorBuffer),this.enableAttribute(h.color),this._gl.vertexAttribPointer(h.color,3,this._gl.FLOAT,!1,0,0)),h.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_.__webglNormalBuffer),this.enableAttribute(h.normal),this._gl.vertexAttribPointer(h.normal,3,this._gl.FLOAT,!1,0,0)),h.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_.__webglOffsetBuffer),this.enableAttribute(h.offset),this._gl.vertexAttribPointer(h.offset,3,this._gl.FLOAT,!1,0,0)),h.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_.__webglRadiusBuffer),this.enableAttribute(h.radius),this._gl.vertexAttribPointer(h.radius,1,this._gl.FLOAT,!1,0,0)));var D,L;if(M instanceof g.Mesh){if(w.shaderID==="instanced"){var V=w.sphere.geometryGroups[0];S&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,V.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,V.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,_.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,V.faceArray,this._gl.STATIC_DRAW)),D=V.faceidx,this._extInstanced.vertexAttribDivisorANGLE(h.offset,1),this._extInstanced.vertexAttribDivisorANGLE(h.radius,1),this._extInstanced.vertexAttribDivisorANGLE(h.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,D,this._gl.UNSIGNED_SHORT,0,_.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(h.offset,0),this._extInstanced.vertexAttribDivisorANGLE(h.radius,0),this._extInstanced.vertexAttribDivisorANGLE(h.color,0)}else w.wireframe?(L=_.lineidx,this.setLineWidth(w.wireframeLinewidth),S&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,_.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,L,this._gl.UNSIGNED_SHORT,0)):(D=_.faceidx,S&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,_.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,D,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=D,this.info.render.faces+=D/3}else M instanceof g.Line&&(L=_.vertices,this.setLineWidth(w.linewidth),this._gl.drawArrays(this._gl.LINES,0,L),this.info.render.calls++)}}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(a,s,c){let w=a.__lights,_=a.fog,M=[];for(let S=0,E=a.__webglObjects.length;S<E;S++){let F=a.__webglObjects[S];F.render&&F[c]&&M.push(F)}if(M.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(a.__webglObjects,!0,c+"Depth",s,w,_,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let l=this._AOshader.uniforms;this._gl.uniform1f(l.total_strength,this._AOstrength),this._gl.uniform1f(l.radius,this._AOradius),this._fullProjModelMatrix=new k.Matrix4,this._fullProjModelMatrixInv=new k.Matrix4;let h=M[0].object;this._fullProjModelMatrix.multiplyMatrices(s.projectionMatrix,h._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(l.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(l.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(a,s){if(!(s instanceof u.Camera)){console.error("Renderer.render: camera is not an instance of Camera.");return}var c,w,_,M,l,h=a.__lights,S=a.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&a.updateMatrixWorld(),s.parent===void 0&&s.updateMatrixWorld(),s.matrixWorldInverse.getInverse(s.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(a),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),l=a.__webglObjects;let E=!1,F=this._AOEnabled;for(c=0,w=l.length;c<w;c++)_=l[c],M=_.object,_.render=!1,M.visible&&(this.setupMatrices(M,s),this.unrollBufferMaterial(_),_.render=!0,_.volumetric&&(E=!0),_.hasAO&&(F=!0));this.setBlending(!1),F&&this.setShading(a,s,"opaque"),this.renderObjects(a.__webglObjects,!0,"opaque",s,h,S,!1),F&&this.clearShading(),this.renderSprites(a,s,!1),this.renderObjects(a.__webglObjects,!0,"transparentDepth",s,h,S,!0),this.renderObjects(a.__webglObjects,!1,"transparent",s,h,S,!0),E&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(a.__webglObjects,!1,"volumetric",s,h,S,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(a,s,!0)}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let a=this._viewportWidth,s=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,a,s),this._gl.viewport(0,0,a,s),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,a,s,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,a,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,a,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,a,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let a=this._viewportWidth,s=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,a,s),this._gl.viewport(0,0,a,s),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var c=this._antialias?R.ShaderLib.screenaa:R.ShaderLib.screen;this._screenshader=this.buildProgram(c.fragmentShader,c.vertexShader,c.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition");var w=[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1];this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(w),this._gl.STATIC_DRAW);let _=R.ShaderLib.ssao;this._AOshader=this.buildProgram(_.fragmentShader,_.vertexShader,_.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let M=R.ShaderLib.blur;this._blurshader=this.buildProgram(M.fragmentShader,M.vertexShader,M.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(a){if(a.__webglObjects||(a.__webglObjects=[],a.__webglObjectsImmediate=[],a.__webglSprites=[],a.__webglFlares=[]),a.__objectsAdded.length){for(;a.__objectsAdded.length;)this.addObject(a.__objectsAdded[0],a),a.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;a.__objectsRemoved.length;)this.removeObject(a.__objectsRemoved[0],a),a.__objectsRemoved.splice(0,1);for(var s=0,c=a.__webglObjects.length;s<c;s++)this.updateObject(a.__webglObjects[s].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(a,s){(a==null||s==null)&&(a=this._canvas.width,s=this._canvas.height);var c=a/s;if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var w=a/this.cols,_=s/this.rows;c=w/_}return c}setTexture(a,s,c){if(a.needsUpdate){a.__webglInit||(a.__webglInit=!0,a.addEventListener("dispose",this.onTextureDispose.bind(this)),a.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+s);var w=c?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(w,a.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,a.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,a.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,a.unpackAlignment);var _=this.paramToGL(a.format),M=this.paramToGL(a.type);if(c)this.setTextureParameters(this._gl.TEXTURE_3D,a),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,a.image.size.z,a.image.size.y,a.image.size.x,0,this._gl.RED,this._gl.FLOAT,a.image.data);else{var l=a.image,h=l.width,S=l.height;typeof h>"u"&&(h=l.length,_==this._gl.RGBA&&(h/=4),S=1),this.setTextureParameters(this._gl.TEXTURE_2D,a),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,_,_,M,a.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,_,h,S,0,_,M,a.image)}a.needsUpdate=!1,a.onUpdate&&a.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+s),c?this._gl.bindTexture(this._gl.TEXTURE_3D,a.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,a.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(a){this._enabledAttributes[a]||(this._gl.enableVertexAttribArray(a),this._enabledAttributes[a]=!0)}disableAttributes(){for(let a in this._enabledAttributes)this._enabledAttributes[a]&&(this._gl.disableVertexAttribArray(a),this._enabledAttributes[a]=!1)}setPolygonOffset(a,s,c){this._oldPolygonOffset!==a&&(a?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(a){a!==this._oldLineWidth&&(this._gl.lineWidth(a),this._oldLineWidth=a)}deallocateGeometry(a){if(a.__webglInit=void 0,a.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(a.__webglVertexBuffer),a.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(a.__webglColorBuffer),a.geometryGroups!==void 0)for(var s=0,c=a.groups;s<c;s++){var w=a.geometryGroups[s];w.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(w.__webglVertexBuffer),w.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(w.__webglColorBuffer),w.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(w.__webglNormalBuffer),w.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(w.__webglFaceBuffer),w.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(w.__webglLineBuffer)}}deallocateMaterial(a){var s=a.program;if(s!==void 0){a.program=void 0;var c,w,_,M=!1;for(c=0,w=this._programs.length;c<w;c++)if(_=this._programs[c],_.program===s){_.usedTimes--,_.usedTimes===0&&(M=!0);break}if(M===!0){var l=[];for(c=0,w=this._programs.length;c<w;c++)_=this._programs[c],_.program!==s&&l.push(_);this._programs=l,this._gl.deleteProgram(s),this.info.memory.programs--}}}deallocateTexture(a){if(a.image&&a.image.__webglTextureCube)this._gl.deleteTexture(a.image.__webglTextureCube);else{if(!a.__webglInit)return;a.__webglInit=!1,this._gl.deleteTexture(a.__webglTexture)}}onGeometryDispose(a){var s=a.target;s.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(s),this.info.memory.geometries--}onTextureDispose(a){var s=a.target;s.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(s),this.info.memory.textures--}onMaterialDispose(a){var s=a.target;s.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(s)}getShader(a,s){var c;return!this.isWebGL1()&&!s.startsWith("#version")&&(s=s.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),a=="fragment"?s=s.replace(/varying/g,"in"):s=s.replace(/varying/g,"out"),s=s.replace(/attribute/g,"in"),s=s.replace(/texture2D/g,"texture"),s=s.replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;"),s=s.replace(/gl_FragColor/g,"glFragColor"),s=`#version 300 es
`+s),a==="fragment"?c=this._gl.createShader(this._gl.FRAGMENT_SHADER):a==="vertex"&&(c=this._gl.createShader(this._gl.VERTEX_SHADER)),c==null?null:(this._gl.shaderSource(c,s),this._gl.compileShader(c),this._gl.getShaderParameter(c,this._gl.COMPILE_STATUS)?c:(console.error(this._gl.getShaderInfoLog(c)),console.error("could not initialize shader"),null))}buildProgram(a,s,c,w){var _,M,l,h,S=[];S.push(a),S.push(s);for(_ in w)S.push(_),S.push(w[_]);for(h=S.join(),_=0,M=this._programs.length;_<M;_++){var E=this._programs[_];if(E.code===h)return E.usedTimes++,E.program}if(this.isWebGL1()&&w.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if(l=this._gl.createProgram(),l==null)return null;var F=this._precision,D="precision "+F+" float;",L=[w.volumetric?"#version 300 es":"",D].join(`
`),V=[w.volumetric?"#version 300 es":"",w.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",w.shaded?"#define SHADED 1":"",w.wireframe?"#define WIREFRAME 1":"",D].join(`
`),O=this.getShader("fragment",V+a),W=this.getShader("vertex",L+s);W!=null&&this._gl.attachShader(l,W),O!=null&&this._gl.attachShader(l,O),this._gl.linkProgram(l),this._gl.getProgramParameter(l,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),l.uniforms={},l.attributes={};var H,q,U;H=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix"];for(q in c)H.push(q);for(U=0;U<H.length;U++){var B=H[U];l.uniforms[B]=this._gl.getUniformLocation(l,B)}for(H=["position","normal","color","lineDistance","offset","radius"],U=0;U<H.length;U++){var Y=H[U];l.attributes[Y]=this._gl.getAttribLocation(l,Y)}return l.id=this._programs_counter++,this._programs.push({program:l,code:h,usedTimes:1}),this.info.memory.programs=this._programs.length,l}setProgram(a,s,c,w,_,M){if(w.needsUpdate&&(w.program&&this.deallocateMaterial(w),this.initMaterial(w,s,c,_),w.needsUpdate=!1),w.program==null)return null;var l=!1,h=w.program,S=h.uniforms,E=w.uniforms;if(h!=this._currentProgram&&(this._gl.useProgram(h),this._currentProgram=h,l=!0),w.id!=this._currentMaterialId&&(this._currentMaterialId=w.id,l=!0),a!=this._currentCamera&&(this._currentCamera=a,l=!0),S.projectionMatrix&&this._gl.uniformMatrix4fv(S.projectionMatrix,!1,a.projectionMatrix.elements),S.modelViewMatrix&&this._gl.uniformMatrix4fv(S.modelViewMatrix,!1,_._modelViewMatrix.elements),S.normalMatrix&&this._gl.uniformMatrix3fv(S.normalMatrix,!1,_._normalMatrix.elements),S.projinv&&(this._projInverse.getInverse(a.projectionMatrix),this._gl.uniformMatrix4fv(S.projinv,!1,this._projInverse.elements)),S.viewMatrix&&this._gl.uniformMatrix4fv(S.viewMatrix,!1,a.matrixWorldInverse.elements),l){if(E.fogColor.value=c.color,E.fogNear.value=c.near,E.fogFar.value=c.far,w.shaderID.startsWith("lambert")||w.shaderID==="instanced"||w.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(h,s),this._lightsNeedUpdate=!1),E.directionalLightColor.value=this._lights.directional.colors,E.directionalLightDirection.value=this._lights.directional.positions;else if(w.shaderID.endsWith("outline"))E.outlineColor.value=w.outlineColor,E.outlineWidth.value=w.outlineWidth,E.outlinePushback.value=w.outlinePushback;else if(w.shaderID==="volumetric"){_._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(_._modelViewMatrix),this._projInverse.getInverse(a.projectionMatrix),this._textureMatrix.multiplyMatrices(_.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(S.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(S.projinv,!1,this._projInverse.elements);let F=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);E.step.value=_.material.unit*F,E.maxdepth.value=_.material.maxdepth*F,E.transfermax.value=_.material.transfermax,E.transfermin.value=_.material.transfermin,E.subsamples.value=_.material.subsamples,M.setTexture(_.material.transferfn,4,!1),M.setTexture(_.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}E.opacity.value=w.opacity,this.loadMaterialUniforms(S,E)}return E.shading&&(E.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),h}loadMaterialUniforms(a,s){var c,w,_,M;for(c in s)a[c]&&(w=s[c].type,_=s[c].value,M=a[c],w==="f"?this._gl.uniform1f(M,_):w==="i"?this._gl.uniform1i(M,_):w==="fv"?this._gl.uniform3fv(M,_):w==="c"?this._gl.uniform3f(M,_.r,_.g,_.b):w==="f4"&&this._gl.uniform4f(M,_[0],_[1],_[2],_[3]))}addObject(a,s){var c,w,_,M;if(!a.__webglInit&&(a.__webglInit=!0,a._modelViewMatrix=new k.Matrix4,a._normalMatrix=new k.Matrix3,a.geometry!==void 0&&a.geometry.__webglInit===void 0&&(a.geometry.__webglInit=!0,a.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),a instanceof g.Mesh||a instanceof g.Line))for(_=a.geometry,c=0,w=_.geometryGroups.length;c<w;c++)M=_.geometryGroups[c],M.id=this._geometryGroupCounter++,M.__webglVertexBuffer||(a instanceof g.Mesh?(this.createMeshBuffers(M),_.elementsNeedUpdate=!0,_.normalsNeedUpdate=!0):a instanceof g.Line&&this.createLineBuffers(M),_.verticesNeedUpdate=!0,_.colorsNeedUpdate=!0);if(!a.__webglActive){if(a instanceof g.Mesh||a instanceof g.Line)for(_=a.geometry,c=0,w=_.geometryGroups.length;c<w;c++)M=_.geometryGroups[c],this.addBuffer(s.__webglObjects,M,a);else a instanceof g.Sprite&&s.__webglSprites.push(a);a.__webglActive=!0}}updateObject(a){var s=a.geometry,c;if(a instanceof g.Mesh||a instanceof g.Line){for(var w=0,_=s.geometryGroups.length;w<_;w++)c=s.geometryGroups[w],(s.verticesNeedUpdate||s.elementsNeedUpdate||s.colorsNeedUpdate||s.normalsNeedUpdate)&&this.setBuffers(c,this._gl.STATIC_DRAW);s.verticesNeedUpdate=!1,s.elementsNeedUpdate=!1,s.normalsNeedUpdate=!1,s.colorsNeedUpdate=!1,s.buffersNeedUpdate=!1}}removeObject(a,s){a instanceof g.Mesh||a instanceof g.Line?this.removeInstances(s.__webglObjects,a):a instanceof g.Sprite&&this.removeInstancesDirect(s.__webglSprites,a),a.__webglActive=!1}removeInstances(a,s){for(var c=a.length-1;c>=0;--c)a[c].object===s&&a.splice(c,1)}removeInstancesDirect(a,s){for(var c=a.length-1;c>=0;--c)a[c]===s&&a.splice(c,1)}unrollBufferMaterial(a){var s=a.object,c=s.material;if(c.volumetric)a.opaque=null,a.transparent=null,a.volumetric=c;else if(c.transparent){if(a.opaque=null,a.volumetric=null,a.transparent=c,!c.wireframe){let w=c.clone();w.opacity=0,a.transparentDepth=w}}else{if(a.opaque=c,a.transparent=null,a.volumetric=null,!c.wireframe){let w=c.clone();w.opacity=0,a.opaqueDepth=w}c.hasAO&&(a.hasAO=!0),(this._AOEnabled||a.hasAO)&&(a.opaqueShaded=c.clone(),a.opaqueShaded.shaded=!0)}}setBuffers(a,s){var c=a.vertexArray,w=a.colorArray;if(a.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,a.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,c,s)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,a.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,c,s)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,a.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,w,s),a.normalArray&&a.__webglNormalBuffer!==void 0){var _=a.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,a.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,_,s)}if(a.radiusArray&&a.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,a.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,a.radiusArray,s)),a.faceArray&&a.__webglFaceBuffer!==void 0){var M=a.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,a.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,M,s)}if(a.lineArray&&a.__webglLineBuffer!==void 0){var l=a.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,a.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,l,s)}}createMeshBuffers(a){a.radiusArray&&(a.__webglRadiusBuffer=this._gl.createBuffer()),a.useOffset&&(a.__webglOffsetBuffer=this._gl.createBuffer()),a.__webglVertexBuffer=this._gl.createBuffer(),a.__webglNormalBuffer=this._gl.createBuffer(),a.__webglColorBuffer=this._gl.createBuffer(),a.__webglFaceBuffer=this._gl.createBuffer(),a.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(a){a.__webglVertexBuffer=this._gl.createBuffer(),a.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(a,s,c){a.push({buffer:s,object:c,opaque:null,transparent:null})}setupMatrices(a,s){a._modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,a.matrixWorld),a._normalMatrix.getInverse(a._modelViewMatrix),a._normalMatrix.transpose()}filterFallback(a){return this._gl.LINEAR}setTextureParameters(a,s){a==this._gl.TEXTURE_2D?(this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(a,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(s.magFilter)),this._gl.texParameteri(a,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(s.minFilter))):(this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(a,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(a,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(a,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(a,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(a){return a===x.UnsignedByteType?this._gl.UNSIGNED_BYTE:a===x.RGBAFormat?this._gl.RGBA:a===x.NearestFilter?this._gl.NEAREST:0}setupLights(a,s){var c,w,_,M=0,l=0,h=0,S,E,F=this._lights,D=F.directional.colors,L=F.directional.positions,V=0,O=0;for(c=0,w=s.length;c<w;c++)if(_=s[c],S=_.color,E=_.intensity,_ instanceof b.Light){if(this._direction.getPositionFromMatrix(_.matrixWorld),this._vector3.getPositionFromMatrix(_.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;L[O]=this._direction.x,L[O+1]=this._direction.y,L[O+2]=this._direction.z,D[O]=S.r*E,D[O+1]=S.g*E,D[O+2]=S.b*E,O+=3,V++}F.ambient[0]=M,F.ambient[1]=l,F.ambient[2]=h,F.directional.length=V}initGL(){try{if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context.";var a=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(a[6])}catch(s){console.error(s)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearColor(0,0,0,1),this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(a,s,c,w,_,M,l){var h,S,E,F,D,L,V;s?(D=a.length-1,L=-1,V=-1):(D=0,L=a.length,V=1);for(var O=D;O!==L;O+=V)if(h=a[O],h.render){if(S=h.object,E=h.buffer,F=h[c],(h.hasAO||this._AOEnabled)&&h[c+"Shaded"]&&(F=h[c+"Shaded"]),!F)continue;l&&this.setBlending(!0),this.setDepthTest(F.depthTest),this.setDepthWrite(F.depthWrite),this.setPolygonOffset(F.polygonOffset,F.polygonOffsetFactor,F.polygonOffsetUnits);var W=S._modelViewMatrix.isReflected();if(this.setMaterialFaces(F,W),this.renderBuffer(w,_,M,F,E,S),(this._outlineEnabled||F.outline)&&!F.wireframe&&F.shaderID!=="basic"&&F.opacity!==0){let H=this._outlineMaterial;F.shaderID=="sphereimposter"?H=this._outlineSphereImposterMaterial:F.shaderID=="stickimposter"&&(H=this._outlineStickImposterMaterial),this.renderBuffer(w,_,M,H,E,S)}}}renderSprites(a,s,c){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(a,s,this._currentWidth,this._currentHeight,c),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}}),"./src/WebGL/SpritePlugin.ts":((n,t,r)=>{r.r(t),r.d(t,{SpritePlugin:()=>v});var u=r("./src/WebGL/shaders/index.ts");class v{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(p){this.gl=p.context,this.renderer=p,this.precision=p.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var y=0;this.sprite.vertices[y++]=-1,this.sprite.vertices[y++]=-1,this.sprite.vertices[y++]=0,this.sprite.vertices[y++]=0,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=-1,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=0,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=-1,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=0,this.sprite.vertices[y++]=1,y=0,this.sprite.faces[y++]=0,this.sprite.faces[y++]=1,this.sprite.faces[y++]=2,this.sprite.faces[y++]=0,this.sprite.faces[y++]=2,this.sprite.faces[y++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(u.ShaderLib.sprite,this.precision||1),this.sprite.attributes={};const k={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),k.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),k.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),k.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),k.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),k.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),k.color=this.gl.getUniformLocation(this.sprite.program,"color"),k.map=this.gl.getUniformLocation(this.sprite.program,"map"),k.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),k.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),k.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),k.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),k.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),k.fogType=this.gl.getUniformLocation(this.sprite.program,"fogType"),k.fogDensity=this.gl.getUniformLocation(this.sprite.program,"fogDensity"),k.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),k.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),k.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),k.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=k}render(p,y,k,g,R){var P,T,C,a,s,c,w,_,M,l;if(!this.gl)throw new Error("WebGLRenderer not initialized");let h=[];(P=p?.__webglSprites)===null||P===void 0||P.forEach(ae=>{(R&&ae.material.depthTest==!1||!R&&ae.material.depthTest)&&h.push(ae)});let S=h.length;if(!S)return;const E=this.sprite.attributes,F=this.sprite.uniforms;if(!F)throw new Error("Uniforms not defined");var D=k*.5,L=g*.5;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(E.position),this.gl.enableVertexAttribArray(E.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(E.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(E.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(F.projectionMatrix,!1,y.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(F.map,0);var V=0,O=0,W=p.fog;W?(this.gl.uniform3f(F.fogColor,W.color.r,W.color.g,W.color.b),this.gl.uniform1f(F.fogNear,W.near),this.gl.uniform1f(F.fogFar,W.far),this.gl.uniform1i(F.fogType,1),V=1,O=1):(this.gl.uniform1i(F.fogType,0),V=0,O=0);var H;let q,U,B,Y,X=[];for(H=0;H<S;H++)q=h[H],U=q.material,U&&(U.depthTest==!1&&!R||!q.visible||U.opacity===0||(U.useScreenCoordinates?q.z=-q.position.z:(q._modelViewMatrix.multiplyMatrices(y.matrixWorldInverse,q.matrixWorld),q.z=-q._modelViewMatrix.elements[14])));for(h.sort(x),H=0;H<S;H++)if(q=h[H],U=q.material,!!U&&!(!q.visible||U.opacity===0)&&U.map&&U.map.image&&U.map.image.width){this.gl.uniform1f(F?.alphaTest||null,U.alphaTest);var N=U.map.image.width,J=U.map.image.height;X[0]=N*this.renderer.devicePixelRatio/k,X[1]=J*this.renderer.devicePixelRatio/g,U.useScreenCoordinates===!0?(this.gl.uniform1i(F.useScreenCoordinates,1),this.gl.uniform3f(F.screenPosition,(q.position.x*this.renderer.devicePixelRatio-D)/D,(L-q.position.y*this.renderer.devicePixelRatio)/L,Math.max(0,Math.min(1,q.position.z)))):(this.gl.uniform1i(F.useScreenCoordinates,0),this.gl.uniformMatrix4fv(F.modelViewMatrix,!1,q._modelViewMatrix.elements)),p.fog&&U.fog?Y=O:Y=0,V!==Y&&(this.gl.uniform1i(F.fogType,Y),V=Y),B=1/(U.scaleByViewport?g:1),X[0]*=B*q.scale.x,X[1]*=B*q.scale.y;let ae=(T=U?.alignment)===null||T===void 0?void 0:T.x,se=(C=U?.alignment)===null||C===void 0?void 0:C.y;U.screenOffset&&(ae=(ae||0)+2*U.screenOffset.x/N,se=(se||0)+2*U.screenOffset.y/J),this.gl.uniform2f(F.uvScale,((a=U?.uvScale)===null||a===void 0?void 0:a.x)||1,((s=U?.uvScale)===null||s===void 0?void 0:s.y)||1),this.gl.uniform2f(F.uvOffset,((c=U?.uvOffset)===null||c===void 0?void 0:c.x)||0,((w=U?.uvOffset)===null||w===void 0?void 0:w.y)||0),this.gl.uniform2f(F.alignment,ae||0,se||0),this.gl.uniform1f(F.opacity,U.opacity),this.gl.uniform3f(F.color,((_=U?.color)===null||_===void 0?void 0:_.r)||0,((M=U?.color)===null||M===void 0?void 0:M.g)||0,((l=U?.color)===null||l===void 0?void 0:l.b)||0),this.gl.uniform1f(F.rotation,q.rotation),this.gl.uniform2fv(F.scale,X),this.renderer.setDepthTest(U.depthTest),this.renderer.setDepthWrite(U.depthWrite),this.renderer.setTexture(U.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(p,y){if(!this.gl)throw new Error("WebGL Rendering context not found");var k=this.gl.createProgram();if(!k)throw new Error("Error creating webgl program");var g=this.gl.createShader(this.gl.FRAGMENT_SHADER),R=this.gl.createShader(this.gl.VERTEX_SHADER);if(!g)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!R)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var P="precision "+y+` float;
`;if(this.gl.shaderSource(g,P+p.fragmentShader),this.gl.shaderSource(R,P+p.vertexShader),this.gl.compileShader(g),this.gl.compileShader(R),!this.gl.getShaderParameter(g,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(R,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(g)} 
      ${this.gl.getShaderInfoLog(R)}`);return this.gl.attachShader(k,g),this.gl.attachShader(k,R),this.gl.linkProgram(k),this.gl.getProgramParameter(k,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),k}}function x(b,p){return b.z!==p.z?p.z-b.z:p.id-b.id}}),"./src/WebGL/constants/Coloring.ts":((n,t,r)=>{r.r(t),r.d(t,{Coloring:()=>u});var u;(function(v){v[v.NoColors=0]="NoColors",v[v.FaceColors=1]="FaceColors",v[v.VertexColors=2]="VertexColors"})(u||(u={}))}),"./src/WebGL/constants/Shading.ts":((n,t,r)=>{r.r(t),r.d(t,{Shading:()=>u});var u;(function(v){v[v.NoShading=0]="NoShading",v[v.FlatShading=1]="FlatShading",v[v.SmoothShading=2]="SmoothShading"})(u||(u={}))}),"./src/WebGL/constants/Sides.ts":((n,t,r)=>{r.r(t),r.d(t,{BackSide:()=>v,DoubleSide:()=>x,FrontSide:()=>u});const u=0,v=1,x=2}),"./src/WebGL/constants/SpriteAlignment.ts":((n,t,r)=>{r.r(t),r.d(t,{SpriteAlignment:()=>v});var u=r("./src/WebGL/math/index.ts");const v={topLeft:new u.Vector2(1,-1),topCenter:new u.Vector2(0,-1),topRight:new u.Vector2(-1,-1),centerLeft:new u.Vector2(1,0),center:new u.Vector2(0,0),centerRight:new u.Vector2(-1,0),bottomLeft:new u.Vector2(1,1),bottomCenter:new u.Vector2(0,1),bottomRight:new u.Vector2(-1,1)}}),"./src/WebGL/constants/TextureConstants.ts":((n,t,r)=>{r.r(t),r.d(t,{ClampToEdgeWrapping:()=>u,FloatType:()=>y,LinearFilter:()=>v,LinearMipMapLinearFilter:()=>b,NearestFilter:()=>x,R32Format:()=>R,RFormat:()=>g,RGBAFormat:()=>k,UnsignedByteType:()=>p});const u=1001,v=1006,x=1007,b=1008,p=1009,y=1010,k=1021,g=1022,R=1023}),"./src/WebGL/constants/TextureOperations.ts":((n,t,r)=>{r.r(t),r.d(t,{TextureOperations:()=>u});var u;(function(v){v[v.MultiplyOperation=0]="MultiplyOperation",v[v.MixOperation=1]="MixOperation",v[v.AddOperation=2]="AddOperation"})(u||(u={}))}),"./src/WebGL/constants/index.ts":((n,t,r)=>{r.r(t),r.d(t,{BackSide:()=>v.BackSide,ClampToEdgeWrapping:()=>p.ClampToEdgeWrapping,Coloring:()=>u.Coloring,DoubleSide:()=>v.DoubleSide,FloatType:()=>p.FloatType,FrontSide:()=>v.FrontSide,LinearFilter:()=>p.LinearFilter,LinearMipMapLinearFilter:()=>p.LinearMipMapLinearFilter,NearestFilter:()=>p.NearestFilter,R32Format:()=>p.R32Format,RFormat:()=>p.RFormat,RGBAFormat:()=>p.RGBAFormat,Shading:()=>x.Shading,SpriteAlignment:()=>b.SpriteAlignment,TextureOperations:()=>y.TextureOperations,UnsignedByteType:()=>p.UnsignedByteType});var u=r("./src/WebGL/constants/Coloring.ts"),v=r("./src/WebGL/constants/Sides.ts"),x=r("./src/WebGL/constants/Shading.ts"),b=r("./src/WebGL/constants/SpriteAlignment.ts"),p=r("./src/WebGL/constants/TextureConstants.ts"),y=r("./src/WebGL/constants/TextureOperations.ts")}),"./src/WebGL/core/EventDispatcher.ts":((n,t,r)=>{r.r(t),r.d(t,{EventDispatcher:()=>u});class u{constructor(){this.listeners={}}dispatchEvent(x){var b=this.listeners[x.type];if(b!==void 0){x.target=this;for(var p=0,y=b.length;p<y;p++)b[p].call(this,x)}}removeEventListener(x,b){if(!b)this.listeners[x]=[];else{var p=this.listeners[x].indexOf(b);p!==-1&&this.listeners[x].splice(p,1)}}addEventListener(x,b){this.listeners[x]===void 0&&(this.listeners[x]=[]),this.listeners[x].indexOf(b)===-1&&this.listeners[x].push(b)}}}),"./src/WebGL/core/Geometry.ts":((n,t,r)=>{r.r(t),r.d(t,{Geometry:()=>k,GeometryGroup:()=>y,GeometryIDCount:()=>g});var u=r("./src/WebGL/materials/LineBasicMaterial.ts"),v=r("./src/WebGL/core/EventDispatcher.ts"),x=r("./src/WebGL/math/index.ts"),b=r("./src/colors.ts");const p=65535;class y{constructor(P=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=P}setColors(P){var T=this.vertexArray,C=this.colorArray;if(!T)throw new Error("vertex array not initialized");if(!C)throw new Error("color array not initialized");if(T.length!=C.length){console.log("Cannot re-color geometry group due to mismatched lengths.");return}for(var a=0;a<T.length;a+=3){var s=P(T[a],T[a+1],T[a+2]);s instanceof b.Color||(s=b.CC.color(s)),C[a]=s.r,C[a+1]=s.g,C[a+2]=s.b}}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var P=new x.Vector3,T,C,a,s,c=0;c<this.vertices;++c)T=c*3,C=this.vertexArray[T],a=this.vertexArray[T+1],s=this.vertexArray[T+2],P.x+=C,P.y+=a,P.z+=s;return P.divideScalar(this.vertices),P}setNormals(){var P=this.faceArray,T=this.vertexArray,C=this.normalArray;if(!(!this.vertices||!this.faceidx)){if(!P)throw new Error("face array not initialized");if(!T)throw new Error("vertex array not initialized");if(!C)throw new Error("normal array not initialized");for(var a,s,c,w,_,M,l,h=0;h<P.length/3;++h)a=P[h*3]*3,s=P[h*3+1]*3,c=P[h*3+2]*3,w=new x.Vector3(T[a],T[a+1],T[a+2]),_=new x.Vector3(T[s],T[s+1],T[s+2]),M=new x.Vector3(T[c],T[c+1],T[c+2]),w.subVectors(w,_),M.subVectors(M,_),M.cross(w),l=M,l.normalize(),C[a]+=l.x,C[s]+=l.x,C[c]+=l.x,C[a+1]+=l.y,C[s+1]+=l.y,C[c+1]+=l.y,C[a+2]+=l.z,C[s+2]+=l.z,C[c+2]+=l.z}}setLineIndices(){if(this.faceidx&&!(this.lineArray&&this.lineArray.length==this.faceidx*2&&this.lineidx==this.faceidx*2)){var P=this.faceArray,T=this.lineArray=new Uint16Array(this.faceidx*2);if(this.lineidx=this.faceidx*2,!P)throw new Error("face array not initialized");for(var C=0;C<this.faceidx/3;++C){var a=C*3,s=a*2,c=P[a],w=P[a+1],_=P[a+2];T[s]=c,T[s+1]=w,T[s+2]=c,T[s+3]=_,T[s+4]=w,T[s+5]=_}}}vrml(P,T){var C,a,s,c,w,_,M,l,h,S,E,F,D,L,V,O,W,H,q="";if(q+=P+`Shape {
`+P+` appearance Appearance {
`+P+`  material Material {
`+P+"   diffuseColor "+((C=T?.color)===null||C===void 0?void 0:C.r)+" "+((a=T?.color)===null||a===void 0?void 0:a.g)+" "+((s=T?.color)===null||s===void 0?void 0:s.b)+`
`,T.wireframe&&this.colorArray){let B=this.colorArray;q+=P+"    emissiveColor "+B[0]+" "+B[1]+" "+B[2]+`
`}T!=null&&T.transparent&&(q+=P+"   transparency "+(1-T.opacity)+`
`),q+=P+`  }
`,q+=P+` }
`;var U=P;if(P+=" ",T instanceof u.LineBasicMaterial||T.wireframe){q+=P+`geometry IndexedLineSet {
`+P+` colorPerVertex TRUE
`+P+` coord Coordinate {
`+P+`  point [
`;let B,Y,X;for(let N=0;N<this.vertices;++N){let J=N*3;B=(c=this.vertexArray)===null||c===void 0?void 0:c[J],Y=(w=this.vertexArray)===null||w===void 0?void 0:w[J+1],X=(_=this.vertexArray)===null||_===void 0?void 0:_[J+2],q+=P+"   "+B+" "+Y+" "+X+`,
`}if(q+=P+`  ]
`,q+=P+` }
`,this.colorArray&&!T.wireframe){q+=P+` color Color {
`+P+`  color [
`;for(let N=0;N<this.vertices;++N){let J=N*3;B=this.colorArray[J],Y=this.colorArray[J+1],X=this.colorArray[J+2],q+=P+"   "+B+" "+Y+" "+X+`,
`}q+=P+`  ]
`,q+=P+` }
`}if(q+=P+` coordIndex [
`,T.wireframe&&this.faceArray)for(let N=0;N<this.faceidx;N+=3)B=(M=this.faceArray)===null||M===void 0?void 0:M[N],Y=(l=this.faceArray)===null||l===void 0?void 0:l[N+1],X=(h=this.faceArray)===null||h===void 0?void 0:h[N+2],q+=P+"  "+B+", "+Y+", "+X+`, -1,
`;else for(let N=0;N<this.vertices-1;N+=2)q+=P+"  "+N+", "+(N+1)+`, -1,
`;q+=P+` ]
`,q+=P+`}
`}else{q+=P+`geometry IndexedFaceSet {
`+P+` colorPerVertex TRUE
`+P+` normalPerVertex TRUE
`+P+` solid FALSE
`,q+=P+` coord Coordinate {
`+P+`  point [
`;let B,Y,X;for(let N=0;N<this.vertices;++N){let J=N*3;B=(S=this.vertexArray)===null||S===void 0?void 0:S[J],Y=(E=this.vertexArray)===null||E===void 0?void 0:E[J+1],X=(F=this.vertexArray)===null||F===void 0?void 0:F[J+2],q+=P+"   "+B+" "+Y+" "+X+`,
`}q+=P+`  ]
`,q+=P+` }
`,q+=P+` normal Normal {
`+P+`  vector [
`;for(let N=0;N<this.vertices;++N){let J=N*3;B=(D=this.normalArray)===null||D===void 0?void 0:D[J],Y=(L=this.normalArray)===null||L===void 0?void 0:L[J+1],X=(V=this.normalArray)===null||V===void 0?void 0:V[J+2],q+=P+"   "+B+" "+Y+" "+X+`,
`}if(q+=P+`  ]
`,q+=P+` }
`,this.colorArray){q+=P+` color Color {
`+P+`  color [
`;for(let N=0;N<this.vertices;++N){let J=N*3;B=this.colorArray[J],Y=this.colorArray[J+1],X=this.colorArray[J+2],q+=P+"   "+B+" "+Y+" "+X+`,
`}q+=P+`  ]
`,q+=P+` }
`}q+=P+` coordIndex [
`;for(let N=0;N<this.faceidx;N+=3)B=(O=this.faceArray)===null||O===void 0?void 0:O[N],Y=(W=this.faceArray)===null||W===void 0?void 0:W[N+1],X=(H=this.faceArray)===null||H===void 0?void 0:H[N+2],q+=P+"  "+B+", "+Y+", "+X+`, -1,
`;q+=P+` ]
`,q+=P+`}
`}return q+=U+"}",q}truncateArrayBuffers(P=!0,T=!1){var C=this.vertexArray,a=this.colorArray,s=this.normalArray,c=this.faceArray,w=this.lineArray,_=this.radiusArray;this.vertexArray=C?.subarray(0,this.vertices*3)||null,this.colorArray=a?.subarray(0,this.vertices*3)||null,P?(this.normalArray=s?.subarray(0,this.vertices*3)||null,this.faceArray=c?.subarray(0,this.faceidx)||null,this.lineidx>0?this.lineArray=w?.subarray(0,this.lineidx)||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),_&&(this.radiusArray=_.subarray(0,this.vertices)),T&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class k extends v.EventDispatcher{constructor(P=!1,T=!1,C=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=g++,this.mesh=P,this.radii=T,this.offset=C}updateGeoGroup(P=0){var T,C=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!C||C.vertices+P>(((T=C?.vertexArray)===null||T===void 0?void 0:T.length)||0)/3)&&(C=this.addGeoGroup()),C}vrml(P,T){for(var C="",a=this.geometryGroups.length,s=0;s<a;s++){var c=this.geometryGroups[s];C+=c.vrml(P,T)+`,
`}return C}addGeoGroup(){var P=new y(this.geometryGroups.length);return this.geometryGroups.push(P),this.groups=this.geometryGroups.length,P.vertexArray=new Float32Array(p*3),P.colorArray=new Float32Array(p*3),this.mesh&&(P.normalArray=new Float32Array(p*3),P.faceArray=new Uint16Array(p*6),P.lineArray=new Uint16Array(p*6)),this.radii&&(P.radiusArray=new Float32Array(p)),P.useOffset=this.offset,P}setUpNormals(...P){for(var T=0;T<this.groups;T++){var C=this.geometryGroups[T];C.setNormals(...P)}}setColors(...P){for(var T=this.geometryGroups.length,C=0;C<T;C++){var a=this.geometryGroups[C];a.setColors(...P)}}setUpWireframe(...P){for(var T=0;T<this.groups;T++){var C=this.geometryGroups[T];C.setLineIndices(...P)}}initTypedArrays(){for(var P=0;P<this.groups;P++){var T=this.geometryGroups[P];T.__inittedArrays!==!0&&T.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var P=0,T=0;T<this.groups;T++)P+=this.geometryGroups[T].vertices;return P}}let g=0}),"./src/WebGL/core/Object3D.ts":((n,t,r)=>{r.r(t),r.d(t,{Light:()=>y,Object3D:()=>b,Object3DIDCount:()=>x,Scene:()=>p});var u=r("./src/WebGL/math/index.ts"),v=r("./src/colors.ts");let x=0;class b{constructor(){this.id=x++,this.name="",this.children=[],this.position=new u.Vector3,this.rotation=new u.Vector3,this.matrix=new u.Matrix4,this.matrixWorld=new u.Matrix4,this.quaternion=new u.Quaternion,this.eulerOrder="XYZ",this.up=new u.Vector3(0,1,0),this.scale=new u.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(g){this.matrix.lookAt(g,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof u.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(g){if(g===this){console.error("Can't add $3Dmol.Object3D to itself");return}g.parent=this,this.children.push(g);for(var R=this;R.parent!==void 0;)R=R.parent;R!==void 0&&R instanceof p&&R.__addObject(g)}remove(g){var R=this.children.indexOf(g);if(R!==-1){g.parent=void 0,this.children.splice(R,1);for(var P=this;P.parent!==void 0;)P=P.parent;P!==void 0&&P instanceof p&&P.__removeObject(g)}}vrml(g){g||(g=" ");var R=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),P=0,T=0,C=0;if(R!=0){let c=Math.sin(R/2);P=this.quaternion.x/c,T=this.quaternion.y/c,C=this.quaternion.z/c}var a=g+`Transform {
`+g+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+g+" rotation "+P+" "+T+" "+C+" "+R+`
`+g+` children [
`;this.geometry&&(a+=this.geometry.vrml(g,this.material));for(var s=0;s<this.children.length;s++)a+=this.children[s].vrml(g+" ")+`,
`;return a+=` ]
`,a+="}",a}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof u.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),(this.scale.x!==1||this.scale.y!==1||this.scale.z!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(g){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||g===!0)&&(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var R=0;R<this.children.length;R++)this.children[R].updateMatrixWorld(!0)}clone(g){g===void 0&&(g=new b),g.name=this.name,g.up.copy(this.up),g.position.copy(this.position),g.rotation instanceof u.Vector3&&this.rotation instanceof u.Vector3?g.rotation.copy(this.rotation):g.rotation=this.rotation,g.eulerOrder=this.eulerOrder,g.scale.copy(this.scale),g.rotationAutoUpdate=this.rotationAutoUpdate,g.matrix.copy(this.matrix),g.matrixWorld.copy(this.matrixWorld),g.quaternion.copy(this.quaternion),g.matrixAutoUpdate=this.matrixAutoUpdate,g.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,g.useQuaternion=this.useQuaternion,g.visible=this.visible;for(var R=0;R<this.children.length;R++){var P=this.children[R];g.add(P.clone())}return g}setVisible(g){this.visible=g;for(var R=0;R<this.children.length;R++){var P=this.children[R];P.setVisible(g)}}}class p extends b{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(g){if(g instanceof y)this.__lights.indexOf(g)===-1&&this.__lights.push(g),g.target&&g.target.parent===void 0&&this.add(g.target);else if(this.__objects.indexOf(g)===-1){this.__objects.push(g),this.__objectsAdded.push(g);var R=this.__objectsRemoved.indexOf(g);R!==-1&&this.__objectsRemoved.splice(R,1)}for(var P=0;P<g.children.length;P++)this.__addObject(g.children[P])}__removeObject(g){var R;if(g instanceof y)R=this.__lights.indexOf(g),R!==-1&&this.__lights.splice(R,1);else if(R=this.__objects.indexOf(g),R!==-1){this.__objects.splice(R,1),this.__objectsRemoved.push(g);var P=this.__objectsAdded.indexOf(g);P!==-1&&this.__objectsAdded.splice(R,1)}for(var T=0;T<g.children.length;T++)this.__removeObject(g.children[T])}}class y extends b{constructor(g,R=1){super(),this.position=new u.Vector3(0,1,0),this.target=new b,this.castShadow=!1,this.onlyShadow=!1,this.color=new v.Color(g),this.intensity=R}}}),"./src/WebGL/core/Projector.ts":((n,t,r)=>{r.r(t),r.d(t,{Projector:()=>x});var u=r("./src/WebGL/math/index.ts");const v=new u.Matrix4;class x{static unprojectVector(p,y){return y.projectionMatrixInverse.getInverse(y.projectionMatrix),v.multiplyMatrices(y.matrixWorld,y.projectionMatrixInverse),p.applyProjection(v)}static projectVector(p,y){return y.matrixWorldInverse.getInverse(y.matrixWorld),v.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),p.applyProjection(v)}projectVector(p,y){return x.projectVector(p,y)}unprojectVector(p,y){return x.unprojectVector(p,y)}}}),"./src/WebGL/core/Raycaster.ts":((n,t,r)=>{r.r(t),r.d(t,{Raycaster:()=>p,intersectObject:()=>c});var u=r("./src/WebGL/math/index.ts"),v=r("./src/WebGL/shapes/index.ts");const x=(w,_)=>w.distance-_.distance,b=new u.Matrix4;class p{constructor(_,M,l,h){this.precision=1e-4,this.linePrecision=.2,this.ray=new u.Ray(_,M),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=h||0,this.far=l||1/0}set(_,M){this.ray.set(_,M)}setFromCamera(_,M){M.ortho?(this.ray.origin.set(_.x,_.y,(M.near+M.far)/(M.near-M.far)).unproject(M),this.ray.direction.set(0,0,-1).transformDirection(M.matrixWorld)):(this.ray.origin.setFromMatrixPosition(M.matrixWorld),this.ray.direction.set(_.x,_.y,_.z),M.projectionMatrixInverse.getInverse(M.projectionMatrix),b.multiplyMatrices(M.matrixWorld,M.projectionMatrixInverse),this.ray.direction.applyProjection(b),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(_,M){for(var l=[],h=0,S=M.length;h<S;h++)c(_,M[h],this,l);return l.sort(x),l}}const y=w=>Math.min(Math.max(w,-1),1);var k=new v.Sphere,g=new v.Cylinder,R=new v.Triangle,P=new u.Vector3,T=new u.Vector3,C=new u.Vector3,a=new u.Vector3,s=new u.Vector3;function c(w,_,M,l){if(s.getPositionFromMatrix(w.matrixWorld),_.intersectionShape===void 0)return l;var h=_.intersectionShape,S=M.linePrecision;S*=w.matrixWorld.getMaxScaleOnAxis();var E=S*S;if(_.boundingSphere!==void 0&&_.boundingSphere instanceof v.Sphere&&(k.copy(_.boundingSphere),k.applyMatrix4(w.matrixWorld),!M.ray.isIntersectionSphere(k)))return l;var F,D,L,V,O,W,H,q,U,B,Y,X,N,J;for(F=0,D=h.triangle.length;F<D;F++)if(h.triangle[F]instanceof v.Triangle){if(R.copy(h.triangle[F]),R.applyMatrix4(w.matrixWorld),L=R.getNormal(),V=M.ray.direction.dot(L),V>=0||(P.subVectors(R.a,M.ray.origin),H=L.dot(P)/V,H<0))continue;T.copy(M.ray.direction).multiplyScalar(H).add(M.ray.origin),T.sub(R.a),C.copy(R.b).sub(R.a),a.copy(R.c).sub(R.a);var ae=C.dot(a),se=C.lengthSq(),he=a.lengthSq();if(X=(se*T.dot(a)-ae*T.dot(C))/(se*he-ae*ae),X<0||X>1||(Y=(T.dot(C)-X*ae)/se,Y<0||Y>1||Y+X>1))continue;l.push({clickable:_,distance:H})}for(F=0,D=h.cylinder.length;F<D;F++)if(h.cylinder[F]instanceof v.Cylinder){if(g.copy(h.cylinder[F]),g.applyMatrix4(w.matrixWorld),P.subVectors(g.c1,M.ray.origin),O=P.dot(g.direction),W=P.dot(M.ray.direction),V=y(M.ray.direction.dot(g.direction)),U=1-V*V,U===0)continue;N=(V*W-O)/U,J=(W-V*O)/U,T.copy(g.direction).multiplyScalar(N).add(g.c1),C.copy(M.ray.direction).multiplyScalar(J).add(M.ray.origin),q=a.subVectors(T,C).lengthSq();var pe=g.radius*g.radius;if(q<=pe){if(B=(V*O-W)*(V*O-W)-U*(P.lengthSq()-O*O-pe),B<=0?X=H=Math.sqrt(q):X=H=(W-V*O-Math.sqrt(B))/U,Y=V*X-O,Y<0||Y*Y>g.lengthSq()||X<0)continue;l.push({clickable:_,distance:H})}}for(F=0,D=h.line.length;F<D;F+=2){T.copy(h.line[F]),T.applyMatrix4(w.matrixWorld),C.copy(h.line[F+1]),C.applyMatrix4(w.matrixWorld),a.subVectors(C,T);var de=a.lengthSq();a.normalize(),P.subVectors(T,M.ray.origin);var ue=P.dot(a);W=P.dot(M.ray.direction),V=y(M.ray.direction.dot(a)),U=1-V*V,U!==0&&(N=(V*W-ue)/U,J=(W-V*ue)/U,T.add(a.multiplyScalar(N)),C.copy(M.ray.direction).multiplyScalar(J).add(M.ray.origin),q=a.subVectors(C,T).lengthSq(),q<E&&N*N<de&&l.push({clickable:_,distance:J}))}for(F=0,D=h.sphere.length;F<D;F++)if(h.sphere[F]instanceof v.Sphere&&(k.copy(h.sphere[F]),k.applyMatrix4(w.matrixWorld),M.ray.isIntersectionSphere(k))){T.subVectors(k.center,M.ray.origin);var ge=T.dot(M.ray.direction);if(B=ge*ge-(T.lengthSq()-k.radius*k.radius),ge<0)return l;B<=0?H=ge:H=ge-Math.sqrt(B),l.push({clickable:_,distance:H})}return l}}),"./src/WebGL/core/Texture.ts":((n,t,r)=>{r.r(t),r.d(t,{Texture:()=>p,TextureIdCount:()=>y});var u=r("./src/WebGL/constants/TextureConstants.ts"),v=r("./src/WebGL/math/index.ts"),x=r("./src/WebGL/core/EventDispatcher.ts"),b=r("./src/WebGL/core/UVMapping.ts");class p extends x.EventDispatcher{constructor(g,R){super(),this.id=y++,this.name="",this.image=g,this.mapping=new b.UVMapping,this.wrapS=u.ClampToEdgeWrapping,this.wrapT=u.ClampToEdgeWrapping,this.anisotropy=1,R?(this.format=u.RFormat,this.type=u.FloatType,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=u.NearestFilter,this.minFilter=u.NearestFilter):(this.format=u.RGBAFormat,this.type=u.UnsignedByteType,this.offset=new v.Vector2(0,0),this.repeat=new v.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=u.LinearFilter,this.minFilter=u.LinearMipMapLinearFilter),this.needsUpdate=!1,this.onUpdate=null}clone(g=new p){return g.image=this.image,g.mapping=this.mapping,g.wrapS=this.wrapS,g.wrapT=this.wrapT,g.magFilter=this.magFilter,g.minFilter=this.minFilter,g.anisotropy=this.anisotropy,g.format=this.format,g.type=this.type,g.offset.copy(this.offset),g.repeat.copy(this.repeat),g.premultiplyAlpha=this.premultiplyAlpha,g.flipY=this.flipY,g.unpackAlignment=this.unpackAlignment,g}dispose(){this.dispatchEvent({type:"dispose"})}}let y=0}),"./src/WebGL/core/UVMapping.ts":((n,t,r)=>{r.r(t),r.d(t,{UVMapping:()=>u});class u{}}),"./src/WebGL/core/index.ts":((n,t,r)=>{r.r(t),r.d(t,{EventDispatcher:()=>u.EventDispatcher,Geometry:()=>v.Geometry,GeometryGroup:()=>v.GeometryGroup,GeometryIDCount:()=>v.GeometryIDCount,Light:()=>x.Light,Object3D:()=>x.Object3D,Object3DIDCount:()=>x.Object3DIDCount,Projector:()=>b.Projector,Raycaster:()=>p.Raycaster,Scene:()=>x.Scene,Texture:()=>y.Texture,TextureIdCount:()=>y.TextureIdCount,UVMapping:()=>k.UVMapping,intersectObject:()=>p.intersectObject});var u=r("./src/WebGL/core/EventDispatcher.ts"),v=r("./src/WebGL/core/Geometry.ts"),x=r("./src/WebGL/core/Object3D.ts"),b=r("./src/WebGL/core/Projector.ts"),p=r("./src/WebGL/core/Raycaster.ts"),y=r("./src/WebGL/core/Texture.ts"),k=r("./src/WebGL/core/UVMapping.ts")}),"./src/WebGL/index.ts":((n,t,r)=>{r.r(t),r.d(t,{BackSide:()=>u.BackSide,Camera:()=>g.Camera,ClampToEdgeWrapping:()=>u.ClampToEdgeWrapping,Coloring:()=>u.Coloring,Cylinder:()=>k.Cylinder,DoubleSide:()=>u.DoubleSide,EventDispatcher:()=>v.EventDispatcher,FloatType:()=>u.FloatType,Fog:()=>R.Fog,FrontSide:()=>u.FrontSide,Geometry:()=>v.Geometry,GeometryGroup:()=>v.GeometryGroup,GeometryIDCount:()=>v.GeometryIDCount,ImposterMaterial:()=>x.ImposterMaterial,InstancedMaterial:()=>x.InstancedMaterial,Light:()=>v.Light,Line:()=>p.Line,LineBasicMaterial:()=>x.LineBasicMaterial,LineStyle:()=>p.LineStyle,LinearFilter:()=>u.LinearFilter,LinearMipMapLinearFilter:()=>u.LinearMipMapLinearFilter,Material:()=>x.Material,MaterialIdCount:()=>x.MaterialIdCount,Matrix3:()=>b.Matrix3,Matrix4:()=>b.Matrix4,Mesh:()=>p.Mesh,MeshDoubleLambertMaterial:()=>x.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>x.MeshLambertMaterial,MeshOutlineMaterial:()=>x.MeshOutlineMaterial,NearestFilter:()=>u.NearestFilter,Object3D:()=>v.Object3D,Object3DIDCount:()=>v.Object3DIDCount,Projector:()=>v.Projector,Quaternion:()=>b.Quaternion,R32Format:()=>u.R32Format,RFormat:()=>u.RFormat,RGBAFormat:()=>u.RGBAFormat,Ray:()=>b.Ray,Raycaster:()=>v.Raycaster,Renderer:()=>P.Renderer,Scene:()=>v.Scene,ShaderLib:()=>y.ShaderLib,ShaderUtils:()=>y.ShaderUtils,Shading:()=>u.Shading,Sphere:()=>k.Sphere,SphereImposterMaterial:()=>x.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>x.SphereImposterOutlineMaterial,Sprite:()=>p.Sprite,SpriteAlignment:()=>u.SpriteAlignment,SpriteMaterial:()=>x.SpriteMaterial,SpritePlugin:()=>T.SpritePlugin,StickImposterMaterial:()=>x.StickImposterMaterial,StickImposterOutlineMaterial:()=>x.StickImposterOutlineMaterial,Texture:()=>v.Texture,TextureIdCount:()=>v.TextureIdCount,TextureOperations:()=>u.TextureOperations,Triangle:()=>k.Triangle,UVMapping:()=>v.UVMapping,UnsignedByteType:()=>u.UnsignedByteType,Vector2:()=>b.Vector2,Vector3:()=>b.Vector3,VolumetricMaterial:()=>x.VolumetricMaterial,basic:()=>y.basic,clamp:()=>b.clamp,clone:()=>y.clone,conversionMatrix3:()=>b.conversionMatrix3,degToRad:()=>b.degToRad,instanced:()=>y.instanced,intersectObject:()=>v.intersectObject,lambert:()=>y.lambert,lambertdouble:()=>y.lambertdouble,outline:()=>y.outline,screen:()=>y.screen,screenaa:()=>y.screenaa,sphereimposter:()=>y.sphereimposter,sphereimposteroutline:()=>y.sphereimposteroutline,sprite:()=>y.sprite,stickimposter:()=>y.stickimposter,stickimposteroutline:()=>y.stickimposteroutline,volumetric:()=>y.volumetric});var u=r("./src/WebGL/constants/index.ts"),v=r("./src/WebGL/core/index.ts"),x=r("./src/WebGL/materials/index.ts"),b=r("./src/WebGL/math/index.ts"),p=r("./src/WebGL/objects/index.ts"),y=r("./src/WebGL/shaders/index.ts"),k=r("./src/WebGL/shapes/index.ts"),g=r("./src/WebGL/Camera.ts"),R=r("./src/WebGL/Fog.ts"),P=r("./src/WebGL/Renderer.ts"),T=r("./src/WebGL/SpritePlugin.ts")}),"./src/WebGL/materials/ImposterMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{ImposterMaterial:()=>y});var u=r("./src/WebGL/constants/Coloring.ts"),v=r("./src/WebGL/constants/Shading.ts"),x=r("./src/colors.ts"),b=r("./src/WebGL/math/index.ts"),p=r("./src/WebGL/materials/Material.ts");class y extends p.Material{constructor(g){super(),this.color=new x.Color(16777215),this.ambient=new x.Color(1048575),this.emissive=new x.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new b.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=v.Shading.SmoothShading,this.shaderID=null,this.vertexColors=u.Coloring.NoColors,this.skinning=!1,this.setValues(g)}clone(g=new y){return super.clone.call(this,g),g.color.copy(this.color),g.ambient.copy(this.ambient),g.emissive.copy(this.emissive),g.wrapAround=this.wrapAround,g.wrapRGB.copy(this.wrapRGB),g.map=this.map,g.lightMap=this.lightMap,g.specularMap=this.specularMap,g.envMap=this.envMap,g.combine=this.combine,g.reflectivity=this.reflectivity,g.refractionRatio=this.refractionRatio,g.fog=this.fog,g.shading=this.shading,g.shaderID=this.shaderID,g.vertexColors=this.vertexColors,g.skinning=this.skinning,g.morphTargets=this.morphTargets,g.morphNormals=this.morphNormals,g}}}),"./src/WebGL/materials/InstancedMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{InstancedMaterial:()=>y});var u=r("./src/WebGL/constants/Coloring.ts"),v=r("./src/WebGL/constants/Shading.ts"),x=r("./src/colors.ts"),b=r("./src/WebGL/math/index.ts"),p=r("./src/WebGL/materials/Material.ts");class y extends p.Material{constructor(g){super(),this.color=new x.Color(16777215),this.ambient=new x.Color(1048575),this.emissive=new x.Color(0),this.wrapAround=!1,this.wrapRGB=new b.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=v.Shading.SmoothShading,this.shaderID="instanced",this.vertexColors=u.Coloring.NoColors,this.skinning=!1,this.sphere=null,this.setValues(g)}clone(g=new y){return super.clone.call(this,g),g.color.copy(this.color),g.ambient.copy(this.ambient),g.emissive.copy(this.emissive),g.wrapAround=this.wrapAround,g.wrapRGB.copy(this.wrapRGB),g.map=this.map,g.lightMap=this.lightMap,g.specularMap=this.specularMap,g.envMap=this.envMap,g.combine=this.combine,g.reflectivity=this.reflectivity,g.refractionRatio=this.refractionRatio,g.fog=this.fog,g.shading=this.shading,g.shaderID=this.shaderID,g.vertexColors=this.vertexColors,g.skinning=this.skinning,g.morphTargets=this.morphTargets,g.morphNormals=this.morphNormals,g.sphere=this.sphere,g}}}),"./src/WebGL/materials/LineBasicMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{LineBasicMaterial:()=>x});var u=r("./src/colors.ts"),v=r("./src/WebGL/materials/Material.ts");class x extends v.Material{constructor(p){super(),this.color=new u.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(p)}clone(p=new x){return super.clone.call(this,p),p.color.copy(this.color),p}}}),"./src/WebGL/materials/Material.ts":((n,t,r)=>{r.r(t),r.d(t,{Material:()=>p,MaterialIdCount:()=>y});var u=r("./src/WebGL/constants/Sides.ts"),v=r("./src/WebGL/core/index.ts"),x=r("./src/WebGL/math/index.ts"),b=r("./src/colors.ts");class p extends v.EventDispatcher{constructor(){super(...arguments),this.id=y++,this.name="",this.side=u.FrontSide,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(g={}){if(g!==void 0)for(var R in g){var P=g[R];if(P===void 0){console.warn("$3Dmol.Material: '"+R+"' parameter is undefined.");continue}if(R in this){var T=this[R];T instanceof b.Color&&P instanceof b.Color?T.copy(P):T instanceof b.Color?T.set(P):T instanceof x.Vector3&&P instanceof x.Vector3?T.copy(P):this[R]=P}}}clone(g=new p){return g.name=this.name,g.side=this.side,g.opacity=this.opacity,g.transparent=this.transparent,g.depthTest=this.depthTest,g.depthWrite=this.depthWrite,g.polygonOffset=this.polygonOffset,g.polygonOffsetFactor=this.polygonOffsetFactor,g.polygonOffsetUnits=this.polygonOffsetUnits,g.alphaTest=this.alphaTest,g.overdraw=this.overdraw,g.visible=this.visible,g}makeShaded(g){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:g},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let y=0}),"./src/WebGL/materials/MeshDoubleLambertMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{MeshDoubleLambertMaterial:()=>x});var u=r("./src/WebGL/constants/Sides.ts"),v=r("./src/WebGL/materials/MeshLambertMaterial.ts");class x extends v.MeshLambertMaterial{constructor(p){super(p),this.shaderID="lambertdouble",this.side=u.DoubleSide,this.outline=!1}clone(p=new x){return super.clone.call(this,p),p}}}),"./src/WebGL/materials/MeshLambertMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{MeshLambertMaterial:()=>y});var u=r("./src/WebGL/constants/Coloring.ts"),v=r("./src/WebGL/constants/Shading.ts"),x=r("./src/WebGL/materials/Material.ts"),b=r("./src/colors.ts"),p=r("./src/WebGL/math/index.ts");class y extends x.Material{constructor(g){super(),this.color=new b.Color(16777215),this.ambient=new b.Color(1048575),this.emissive=new b.Color(0),this.wrapAround=!1,this.wrapRGB=new p.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=v.Shading.SmoothShading,this.shaderID="lambert",this.vertexColors=u.Coloring.NoColors,this.skinning=!1,this.setValues(g)}clone(g=new y){return super.clone.call(this,g),g.color.copy(this.color),g.ambient.copy(this.ambient),g.emissive.copy(this.emissive),g.wrapAround=this.wrapAround,g.wrapRGB.copy(this.wrapRGB),g.map=this.map,g.lightMap=this.lightMap,g.specularMap=this.specularMap,g.envMap=this.envMap,g.combine=this.combine,g.reflectivity=this.reflectivity,g.refractionRatio=this.refractionRatio,g.fog=this.fog,g.shading=this.shading,g.shaderID=this.shaderID,g.vertexColors=this.vertexColors,g.skinning=this.skinning,g.morphTargets=this.morphTargets,g.morphNormals=this.morphNormals,g}}}),"./src/WebGL/materials/MeshOutlineMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{MeshOutlineMaterial:()=>x});var u=r("./src/colors.ts"),v=r("./src/WebGL/materials/Material.ts");class x extends v.Material{constructor(p){super(),p=p||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=p.color||new u.Color(0,0,0),this.outlineWidth=p.width||.1,this.outlinePushback=p.pushback||1}clone(p=new x){return super.clone.call(this,p),p.fog=this.fog,p.shaderID=this.shaderID,p.wireframe=this.wireframe,p}}}),"./src/WebGL/materials/SphereImposterMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{SphereImposterMaterial:()=>v});var u=r("./src/WebGL/materials/ImposterMaterial.ts");class v extends u.ImposterMaterial{constructor(b){super(b),this.shaderID="sphereimposter",this.setValues(b)}clone(b=new v){return super.clone.call(this,b),b}}}),"./src/WebGL/materials/SphereImposterOutlineMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{SphereImposterOutlineMaterial:()=>x});var u=r("./src/colors.ts"),v=r("./src/WebGL/materials/ImposterMaterial.ts");class x extends v.ImposterMaterial{constructor(p){super(p),p=p||{},this.shaderID="sphereimposteroutline",this.outlineColor=p.color||new u.Color(0,0,0),this.outlineWidth=p.width||.1,this.outlinePushback=p.pushback||1,this.setValues(p)}clone(p=new x){return super.clone.call(this,p),p.outlineColor=this.outlineColor,p.outlineWidth=this.outlineWidth,p.outlinePushback=this.outlinePushback,p}}}),"./src/WebGL/materials/SpriteMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{SpriteMaterial:()=>y});var u=r("./src/WebGL/constants/SpriteAlignment.ts"),v=r("./src/WebGL/core/Texture.ts"),x=r("./src/colors.ts"),b=r("./src/WebGL/math/index.ts"),p=r("./src/WebGL/materials/Material.ts");class y extends p.Material{constructor(g){super(),this.color=new x.Color(16777215),this.map=new v.Texture,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new b.Vector2(0,0),this.uvScale=new b.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=u.SpriteAlignment.center.clone(),this.setValues(g),g=g||{},g.depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),g.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),g.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(g=new y){return super.clone.call(this,g),g.color.copy(this.color),g.map=this.map,g.useScreenCoordinates=this.useScreenCoordinates,g.screenOffset=this.screenOffset,g.sizeAttenuation=this.sizeAttenuation,g.scaleByViewport=this.scaleByViewPort,g.alignment.copy(this.alignment),g.uvOffset.copy(this.uvOffset),g}}}),"./src/WebGL/materials/StickImposterMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{StickImposterMaterial:()=>v});var u=r("./src/WebGL/materials/ImposterMaterial.ts");class v extends u.ImposterMaterial{constructor(b){super(b),this.shaderID="stickimposter",this.setValues(b)}clone(b=new v){return super.clone.call(this,b),b}}}),"./src/WebGL/materials/StickImposterOutlineMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{StickImposterOutlineMaterial:()=>x});var u=r("./src/colors.ts"),v=r("./src/WebGL/materials/ImposterMaterial.ts");class x extends v.ImposterMaterial{constructor(p={}){super(p),this.shaderID="stickimposteroutline",this.outlineColor=new u.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,p.color&&(this.outlineColor=p.color),p.width&&(this.outlineWidth=p.width),p.pushback&&(this.outlinePushback=p.pushback),this.setValues(p)}clone(p=new x){return super.clone.call(this,p),p.outlineColor=this.outlineColor,p.outlineWidth=this.outlineWidth,p.outlinePushback=this.outlinePushback,p}}}),"./src/WebGL/materials/VolumetricMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{VolumetricMaterial:()=>b});var u=r("./src/WebGL/constants/Sides.ts"),v=r("./src/colors.ts"),x=r("./src/WebGL/materials/Material.ts");class b extends x.Material{constructor(y){super(),this.transparent=!1,this.volumetric=!0,this.color=new v.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=u.FrontSide,this.setValues(y)}clone(y=new b){return super.clone.call(this,y),y.transparent=this.transparent,y.volumetric=this.volumetric,y.color=this.color,y.transferfn=this.transferfn,y.map=this.map,y.extent=this.extent,y.maxdepth=this.maxdepth,y.unit=this.unit,y.texmatrix=this.texmatrix,y.transfermin=this.transfermin,y.transfermax=this.transfermax,y.subsamples=this.subsamples,y.shaderID=this.shaderID,y.side=this.side,y}}}),"./src/WebGL/materials/index.ts":((n,t,r)=>{r.r(t),r.d(t,{ImposterMaterial:()=>u.ImposterMaterial,InstancedMaterial:()=>v.InstancedMaterial,LineBasicMaterial:()=>x.LineBasicMaterial,Material:()=>b.Material,MaterialIdCount:()=>b.MaterialIdCount,MeshDoubleLambertMaterial:()=>p.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>y.MeshLambertMaterial,MeshOutlineMaterial:()=>k.MeshOutlineMaterial,SphereImposterMaterial:()=>g.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>R.SphereImposterOutlineMaterial,SpriteMaterial:()=>P.SpriteMaterial,StickImposterMaterial:()=>T.StickImposterMaterial,StickImposterOutlineMaterial:()=>C.StickImposterOutlineMaterial,VolumetricMaterial:()=>a.VolumetricMaterial});var u=r("./src/WebGL/materials/ImposterMaterial.ts"),v=r("./src/WebGL/materials/InstancedMaterial.ts"),x=r("./src/WebGL/materials/LineBasicMaterial.ts"),b=r("./src/WebGL/materials/Material.ts"),p=r("./src/WebGL/materials/MeshDoubleLambertMaterial.ts"),y=r("./src/WebGL/materials/MeshLambertMaterial.ts"),k=r("./src/WebGL/materials/MeshOutlineMaterial.ts"),g=r("./src/WebGL/materials/SphereImposterMaterial.ts"),R=r("./src/WebGL/materials/SphereImposterOutlineMaterial.ts"),P=r("./src/WebGL/materials/SpriteMaterial.ts"),T=r("./src/WebGL/materials/StickImposterMaterial.ts"),C=r("./src/WebGL/materials/StickImposterOutlineMaterial.ts"),a=r("./src/WebGL/materials/VolumetricMaterial.ts")}),"./src/WebGL/math/Quaternion.ts":((n,t,r)=>{r.r(t),r.d(t,{Quaternion:()=>u});class u{constructor(x,b,p,y){this.x=x||0,this.y=b||0,this.z=p||0,this.w=y!==void 0?y:1}set(x,b,p,y){return this.x=x,this.y=b,this.z=p,this.w=y,this}copy(x){return this.x=x.x,this.y=x.y,this.z=x.z,this.w=x.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let x=this.length();return x===0?(this.x=0,this.y=0,this.z=0,this.w=1):(x=1/x,this.x*=x,this.y*=x,this.z*=x,this.w*=x),this}multiply(x){return this.multiplyQuaternions(this,x)}multiplyScalar(x){return this.x*=x,this.y*=x,this.z*=x,this.w*=x,this}multiplyQuaternions(x,b){const p=x.x,y=x.y,k=x.z,g=x.w,R=b.x,P=b.y,T=b.z,C=b.w;return this.x=p*C+g*R+y*T-k*P,this.y=y*C+g*P+k*R-p*T,this.z=k*C+g*T+p*P-y*R,this.w=g*C-p*R-y*P-k*T,this}sub(x){return this.x-=x.x,this.y-=x.y,this.z-=x.z,this.w-=x.w,this}clone(){return new u(this.x,this.y,this.z,this.w)}setFromEuler(x){const b=Math.cos(x.x/2),p=Math.cos(x.y/2),y=Math.cos(x.z/2),k=Math.sin(x.x/2),g=Math.sin(x.y/2),R=Math.sin(x.z/2);return this.x=k*p*y+b*g*R,this.y=b*g*y-k*p*R,this.z=b*p*R+k*g*y,this.w=b*p*y-k*g*R,this}}}),"./src/WebGL/math/Vector2.ts":((n,t,r)=>{r.r(t),r.d(t,{Vector2:()=>u});class u{constructor(x,b){this.x=x||0,this.y=b||0}set(x,b){return this.x=x,this.y=b,this}subVectors(x,b){return this.x=x.x-b.x,this.y=x.y-b.y,this}copy(x){return this.x=x.x,this.y=x.y,this}clone(){return new u(this.x,this.y)}}}),"./src/WebGL/math/index.ts":((n,t,r)=>{r.r(t),r.d(t,{Matrix3:()=>y.Matrix3,Matrix4:()=>y.Matrix4,Quaternion:()=>u.Quaternion,Ray:()=>y.Ray,Vector2:()=>v.Vector2,Vector3:()=>y.Vector3,clamp:()=>x.clamp,conversionMatrix3:()=>b.conversionMatrix3,degToRad:()=>p.degToRad});var u=r("./src/WebGL/math/Quaternion.ts"),v=r("./src/WebGL/math/Vector2.ts"),x=r("./src/WebGL/math/utils/clamp.ts"),b=r("./src/WebGL/math/utils/conversionMatrix3.ts"),p=r("./src/WebGL/math/utils/degToRad.ts"),y=r("./src/WebGL/math/math.ts")}),"./src/WebGL/math/math.ts":((n,t,r)=>{r.r(t),r.d(t,{Matrix3:()=>P,Matrix4:()=>g,Ray:()=>T,Vector3:()=>R});var u=r("./src/WebGL/math/utils/degToRad.ts"),v=r("./src/WebGL/math/utils/clamp.ts"),x,b,p,y,k;class g{constructor(a=1,s=0,c=0,w=0,_=0,M=1,l=0,h=0,S=0,E=0,F=1,D=0,L=0,V=0,O=0,W=1){typeof a<"u"&&typeof a!="number"?this.elements=new Float32Array(a):(this.elements=new Float32Array(16),this.elements[0]=a,this.elements[4]=s,this.elements[8]=c,this.elements[12]=w,this.elements[1]=_,this.elements[5]=M,this.elements[9]=l,this.elements[13]=h,this.elements[2]=S,this.elements[6]=E,this.elements[10]=F,this.elements[14]=D,this.elements[3]=L,this.elements[7]=V,this.elements[11]=O,this.elements[15]=W)}makeScale(a,s,c){throw new Error("Method not implemented.")}set(a,s,c,w,_,M,l,h,S,E,F,D,L,V,O,W){const H=this.elements;return H[0]=a,H[4]=s,H[8]=c,H[12]=w,H[1]=_,H[5]=M,H[9]=l,H[13]=h,H[2]=S,H[6]=E,H[10]=F,H[14]=D,H[3]=L,H[7]=V,H[11]=O,H[15]=W,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(a){const s=a.elements;return this.set(s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14],s[3],s[7],s[11],s[15]),this}matrix3FromTopLeft(){const a=this.elements;return new P(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10])}setRotationFromEuler(a,s){const c=this.elements,{x:w,y:_,z:M}=a,l=Math.cos(w),h=Math.sin(w),S=Math.cos(_),E=Math.sin(_),F=Math.cos(M),D=Math.sin(M);if(s===void 0||s==="XYZ"){const L=l*F,V=l*D,O=h*F,W=h*D;c[0]=S*F,c[4]=-S*D,c[8]=E,c[1]=V+O*E,c[5]=L-W*E,c[9]=-h*S,c[2]=W-L*E,c[6]=O+V*E,c[10]=l*S}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${s}`);return this}setRotationFromQuaternion(a){const s=this.elements,{x:c,y:w,z:_,w:M}=a,l=c+c,h=w+w,S=_+_,E=c*l,F=c*h,D=c*S,L=w*h,V=w*S,O=_*S,W=M*l,H=M*h,q=M*S;return s[0]=1-(L+O),s[4]=F-q,s[8]=D+H,s[1]=F+q,s[5]=1-(E+O),s[9]=V-W,s[2]=D-H,s[6]=V+W,s[10]=1-(E+L),this}multiplyMatrices(a,s){const c=a.elements,w=s.elements,_=this.elements,M=c[0],l=c[4],h=c[8],S=c[12],E=c[1],F=c[5],D=c[9],L=c[13],V=c[2],O=c[6],W=c[10],H=c[14],q=c[3],U=c[7],B=c[11],Y=c[15],X=w[0],N=w[4],J=w[8],ae=w[12],se=w[1],he=w[5],pe=w[9],de=w[13],ue=w[2],ge=w[6],Re=w[10],Ge=w[14],We=w[3],Oe=w[7],me=w[11],Fe=w[15];return _[0]=M*X+l*se+h*ue+S*We,_[4]=M*N+l*he+h*ge+S*Oe,_[8]=M*J+l*pe+h*Re+S*me,_[12]=M*ae+l*de+h*Ge+S*Fe,_[1]=E*X+F*se+D*ue+L*We,_[5]=E*N+F*he+D*ge+L*Oe,_[9]=E*J+F*pe+D*Re+L*me,_[13]=E*ae+F*de+D*Ge+L*Fe,_[2]=V*X+O*se+W*ue+H*We,_[6]=V*N+O*he+W*ge+H*Oe,_[10]=V*J+O*pe+W*Re+H*me,_[14]=V*ae+O*de+W*Ge+H*Fe,_[3]=q*X+U*se+B*ue+Y*We,_[7]=q*N+U*he+B*ge+Y*Oe,_[11]=q*J+U*pe+B*Re+Y*me,_[15]=q*ae+U*de+B*Ge+Y*Fe,this}multiplyScalar(a){const s=this.elements;return s[0]*=a,s[4]*=a,s[8]*=a,s[12]*=a,s[1]*=a,s[5]*=a,s[9]*=a,s[13]*=a,s[2]*=a,s[6]*=a,s[10]*=a,s[14]*=a,s[3]*=a,s[7]*=a,s[11]*=a,s[15]*=a,this}makeTranslation(a,s,c){return this.set(1,0,0,a,0,1,0,s,0,0,1,c,0,0,0,1),this}snap(a){const s=Math.pow(10,4),c=this.elements;for(let w=0;w<16;w++){const _=Math.round(c[w]);_===Math.round(c[w]*s)/s&&(c[w]=_)}return this}transpose(){const a=this.elements;let s;return s=a[1],a[1]=a[4],a[4]=s,s=a[2],a[2]=a[8],a[8]=s,s=a[6],a[6]=a[9],a[9]=s,s=a[3],a[3]=a[12],a[12]=s,s=a[7],a[7]=a[13],a[13]=s,s=a[11],a[11]=a[14],a[14]=s,this}setPosition(a){const s=this.elements;return s[12]=a.x,s[13]=a.y,s[14]=a.z,this}translate(a){const s=this.elements;return s[12]+=a.x,s[13]+=a.y,s[14]+=a.z,this}getInverse(a,s){const c=this.elements,w=a.elements,_=w[0],M=w[4],l=w[8],h=w[12],S=w[1],E=w[5],F=w[9],D=w[13],L=w[2],V=w[6],O=w[10],W=w[14],H=w[3],q=w[7],U=w[11],B=w[15];c[0]=F*W*q-D*O*q+D*V*U-E*W*U-F*V*B+E*O*B,c[4]=h*O*q-l*W*q-h*V*U+M*W*U+l*V*B-M*O*B,c[8]=l*D*q-h*F*q+h*E*U-M*D*U-l*E*B+M*F*B,c[12]=h*F*V-l*D*V-h*E*O+M*D*O+l*E*W-M*F*W,c[1]=D*O*H-F*W*H-D*L*U+S*W*U+F*L*B-S*O*B,c[5]=l*W*H-h*O*H+h*L*U-_*W*U-l*L*B+_*O*B,c[9]=h*F*H-l*D*H-h*S*U+_*D*U+l*S*B-_*F*B,c[13]=l*D*L-h*F*L+h*S*O-_*D*O-l*S*W+_*F*W,c[2]=E*W*H-D*V*H+D*L*q-S*W*q-E*L*B+S*V*B,c[6]=h*V*H-M*W*H-h*L*q+_*W*q+M*L*B-_*V*B,c[10]=M*D*H-h*E*H+h*S*q-_*D*q-M*S*B+_*E*B,c[14]=h*E*L-M*D*L-h*S*V+_*D*V+M*S*W-_*E*W,c[3]=F*V*H-E*O*H-F*L*q+S*O*q+E*L*U-S*V*U,c[7]=M*O*H-l*V*H+l*L*q-_*O*q-M*L*U+_*V*U,c[11]=l*E*H-M*F*H-l*S*q+_*F*q+M*S*U-_*E*U,c[15]=M*F*L-l*E*L+l*S*V-_*F*V-M*S*O+_*E*O;const Y=_*c[0]+S*c[4]+L*c[8]+H*c[12];if(Y===0){const X="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(s)throw new Error(X);return console.warn(X),this.identity(),this}return this.multiplyScalar(1/Y),this}isReflected(){const a=this.elements,s=a[0],c=a[4],w=a[8],_=a[1],M=a[5],l=a[9],h=a[2],S=a[6],E=a[10];return s*M*E+_*S*w+h*c*l-h*M*w-_*c*E-s*S*l<0}scale(a){const s=this.elements,{x:c}=a,{y:w}=a,{z:_}=a;return s[0]*=c,s[4]*=w,s[8]*=_,s[1]*=c,s[5]*=w,s[9]*=_,s[2]*=c,s[6]*=w,s[10]*=_,s[3]*=c,s[7]*=w,s[11]*=_,this}getMaxScaleOnAxis(){const a=this.elements,s=a[0]*a[0]+a[1]*a[1]+a[2]*a[2],c=a[4]*a[4]+a[5]*a[5]+a[6]*a[6],w=a[8]*a[8]+a[9]*a[9]+a[10]*a[10];return Math.sqrt(Math.max(s,Math.max(c,w)))}makeFrustum(a,s,c,w,_,M){const l=this.elements,h=2*_/(s-a),S=2*_/(w-c),E=(s+a)/(s-a),F=(w+c)/(w-c),D=-(M+_)/(M-_),L=-2*M*_/(M-_);return l[0]=h,l[4]=0,l[8]=E,l[12]=0,l[1]=0,l[5]=S,l[9]=F,l[13]=0,l[2]=0,l[6]=0,l[10]=D,l[14]=L,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makePerspective(a,s,c,w){const _=c*Math.tan((0,u.degToRad)(a*.5)),M=-_,l=M*s,h=_*s;return this.makeFrustum(l,h,M,_,c,w)}makeOrthographic(a,s,c,w,_,M){const l=this.elements,h=1/(s-a),S=1/(c-w),E=1/(M-_),F=(s+a)*h,D=(c+w)*S,L=(M+_)*E;return l[0]=2*h,l[4]=0,l[8]=0,l[12]=-F,l[1]=0,l[5]=2*S,l[9]=0,l[13]=-D,l[2]=0,l[6]=0,l[10]=-2*E,l[14]=-L,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}isEqual(a){const s=a.elements,c=this.elements;return c[0]===s[0]&&c[4]===s[4]&&c[8]===s[8]&&c[12]===s[12]&&c[1]===s[1]&&c[5]===s[5]&&c[9]===s[9]&&c[13]===s[13]&&c[2]===s[2]&&c[6]===s[6]&&c[10]===s[10]&&c[14]===s[14]&&c[3]===s[3]&&c[7]===s[7]&&c[11]===s[11]&&c[15]===s[15]}clone(){const a=this.elements;return new g(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}isIdentity(){const a=this.elements;return a[0]===1&&a[4]===0&&a[8]===0&&a[12]===0&&a[1]===0&&a[5]===1&&a[9]===0&&a[13]===0&&a[2]===0&&a[6]===0&&a[10]===1&&a[14]===0&&a[3]===0&&a[7]===0&&a[11]===0&&a[15]===1}isNearlyIdentity(a){return this.clone().snap(a).isIdentity()}getScale(a){const s=this.elements;return a=a||new R,p.set(s[0],s[1],s[2]),y.set(s[4],s[5],s[6]),k.set(s[8],s[9],s[10]),a.x=p.length(),a.y=y.length(),a.z=k.length(),a}lookAt(a,s,c){const w=this.elements;return k.subVectors(a,s).normalize(),k.length()===0&&(k.z=1),p.crossVectors(c,k).normalize(),p.length()===0&&(k.x+=1e-4,p.crossVectors(c,k).normalize()),y.crossVectors(k,p),w[0]=p.x,w[4]=y.x,w[8]=k.x,w[1]=p.y,w[5]=y.y,w[9]=k.y,w[2]=p.z,w[6]=y.z,w[10]=k.z,this}compose(a,s,c){const w=this.elements;return x.identity(),x.setRotationFromQuaternion(s),b.makeScale(c.x,c.y,c.z),this.multiplyMatrices(x,b),w[12]=a.x,w[13]=a.y,w[14]=a.z,this}}x=new g,b=new g;class R{constructor(a,s,c){this.x=a||0,this.y=s||0,this.z=c||0,this.atomid=void 0}set(a,s,c){return this.x=a,this.y=s,this.z=c,this}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this}addVectors(a,s){return this.x=a.x+s.x,this.y=a.y+s.y,this.z=a.z+s.z,this}multiplyVectors(a,s){return this.x=a.x*s.x,this.y=a.y*s.y,this.z=a.z*s.z,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this}subVectors(a,s){return this.x=a.x-s.x,this.y=a.y-s.y,this.z=a.z-s.z,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this}divideScalar(a){return a!==0?(this.x/=a,this.y/=a,this.z/=a):(this.x=0,this.y=0,this.z=0),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const s=this.x-a.x,c=this.y-a.y,w=this.z-a.z;return s*s+c*c+w*w}applyMatrix3(a){const{x:s}=this,{y:c}=this,{z:w}=this,_=a.elements;return this.x=_[0]*s+_[3]*c+_[6]*w,this.y=_[1]*s+_[4]*c+_[7]*w,this.z=_[2]*s+_[5]*c+_[8]*w,this}applyMatrix4(a){const{x:s}=this,{y:c}=this,{z:w}=this,_=a.elements;return this.x=_[0]*s+_[4]*c+_[8]*w+_[12],this.y=_[1]*s+_[5]*c+_[9]*w+_[13],this.z=_[2]*s+_[6]*c+_[10]*w+_[14],this}applyProjection(a){const{x:s}=this,{y:c}=this,{z:w}=this,_=a.elements,M=_[3]*s+_[7]*c+_[11]*w+_[15];return this.x=(_[0]*s+_[4]*c+_[8]*w+_[12])/M,this.y=(_[1]*s+_[5]*c+_[9]*w+_[13])/M,this.z=(_[2]*s+_[6]*c+_[10]*w+_[14])/M,this}applyQuaternion(a){const{x:s}=this,{y:c}=this,{z:w}=this,_=a.x,M=a.y,l=a.z,h=a.w,S={};S.x=2*(c*l-w*M),S.y=2*(w*_-s*l),S.z=2*(s*M-c*_);const E={};return E.x=S.y*l-S.z*M,E.y=S.z*_-S.x*l,E.z=S.x*M-S.y*_,this.x=s+h*S.x+E.x,this.y=c+h*S.y+E.y,this.z=w+h*S.z+E.z,this}negate(){return this.multiplyScalar(-1)}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross(a){const{x:s}=this,{y:c}=this,{z:w}=this;return this.x=c*a.z-w*a.y,this.y=w*a.x-s*a.z,this.z=s*a.y-c*a.x,this}crossVectors(a,s){return this.x=a.y*s.z-a.z*s.y,this.y=a.z*s.x-a.x*s.z,this.z=a.x*s.y-a.y*s.x,this}equals(a){return this.x==a.x&&this.y==a.y&&this.z==a.z}getPositionFromMatrix(a){return this.x=a.elements[12],this.y=a.elements[13],this.z=a.elements[14],this}setEulerFromRotationMatrix(a,s){const c=a.elements,w=c[0],_=c[4],M=c[8],l=c[5],h=c[9],S=c[6],E=c[10];return s===void 0||s==="XYZ"?(this.y=Math.asin((0,v.clamp)(M,-1,1)),Math.abs(M)<.99999?(this.x=Math.atan2(-h,E),this.z=Math.atan2(-_,w)):(this.x=Math.atan2(S,l),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${s}`),this}rotateAboutVector(a,s){a.normalize();const c=Math.cos(s),w=Math.sin(s),_=this.clone().multiplyScalar(c),M=a.clone().cross(this).multiplyScalar(w),l=a.clone().multiplyScalar(a.clone().dot(this)).multiplyScalar(1-c),h=_.add(M).add(l);return this.x=h.x,this.y=h.y,this.z=h.z,this}setFromMatrixPosition(a){const s=a.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}transformDirection(a){const{x:s}=this,{y:c}=this,{z:w}=this,_=a.elements;return this.x=_[0]*s+_[4]*c+_[8]*w,this.y=_[1]*s+_[5]*c+_[9]*w,this.z=_[2]*s+_[6]*c+_[10]*w,this.normalize()}clone(){return new R(this.x,this.y,this.z)}unproject(a){const s=x;return s.multiplyMatrices(a.matrixWorld,s.getInverse(a.projectionMatrix)),this.applyMatrix4(s)}}p=new R,y=new R,k=new R;class P{constructor(a=1,s=0,c=0,w=0,_=1,M=0,l=0,h=0,S=1){this.elements=new Float32Array(9),this.set(a,s,c,w,_,M,l,h,S)}set(a,s,c,w,_,M,l,h,S){const E=this.elements;return E[0]=a,E[3]=s,E[6]=c,E[1]=w,E[4]=_,E[7]=M,E[2]=l,E[5]=h,E[8]=S,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(a){const s=a.elements;this.set(s[0],s[3],s[6],s[1],s[4],s[7],s[2],s[5],s[8])}multiplyScalar(a){const s=this.elements;return s[0]*=a,s[3]*=a,s[6]*=a,s[1]*=a,s[4]*=a,s[7]*=a,s[2]*=a,s[5]*=a,s[8]*=a,this}getInverse3(a){const s=a.elements,c=this.elements;c[0]=s[4]*s[8]-s[5]*s[7],c[3]=s[6]*s[5]-s[3]*s[8],c[6]=s[3]*s[7]-s[6]*s[4],c[1]=s[7]*s[2]-s[1]*s[8],c[4]=s[0]*s[8]-s[6]*s[2],c[7]=s[1]*s[6]-s[0]*s[7],c[2]=s[1]*s[5]-s[2]*s[4],c[5]=s[2]*s[3]-s[0]*s[5],c[8]=s[0]*s[4]-s[1]*s[3];const w=s[0]*c[0]+s[3]*c[1]+s[6]*c[2];return this.multiplyScalar(1/w),this}getInverse(a,s){const c=a.elements,w=this.elements;w[0]=c[10]*c[5]-c[6]*c[9],w[1]=-c[10]*c[1]+c[2]*c[9],w[2]=c[6]*c[1]-c[2]*c[5],w[3]=-c[10]*c[4]+c[6]*c[8],w[4]=c[10]*c[0]-c[2]*c[8],w[5]=-c[6]*c[0]+c[2]*c[4],w[6]=c[9]*c[4]-c[5]*c[8],w[7]=-c[9]*c[0]+c[1]*c[8],w[8]=c[5]*c[0]-c[1]*c[4];const _=c[0]*w[0]+c[1]*w[3]+c[2]*w[6];if(_===0){const M="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(s)throw new Error(M);return console.warn(M),this.identity(),this}return this.multiplyScalar(1/_),this}getDeterminant(){const a=this.elements;return a[0]*a[4]*a[8]+a[1]*a[5]*a[6]+a[2]*a[3]*a[7]-a[2]*a[4]*a[6]-a[1]*a[3]*a[8]-a[0]*a[5]*a[7]}transpose(){let a;const s=this.elements;return a=s[1],s[1]=s[3],s[3]=a,a=s[2],s[2]=s[6],s[6]=a,a=s[5],s[5]=s[7],s[7]=a,this}clone(){const a=this.elements;return new P(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}getMatrix4(){const a=this.elements;return new g(a[0],a[3],a[6],0,a[1],a[4],a[7],0,a[2],a[5],a[8],0)}}class T{constructor(a,s){this.origin=a!==void 0?a:new R,this.direction=s!==void 0?s:new R}set(a,s){return this.origin.copy(a),this.direction.copy(s),this}copy(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this}at(a,s){return(s||new R).copy(this.direction).multiplyScalar(a).add(this.origin)}recast(a){const s=p;return this.origin.copy(this.at(a,s)),this}closestPointToPoint(a,s){const c=s||new R;c.subVectors(a,this.origin);const w=c.dot(this.direction);return c.copy(this.direction).multiplyScalar(w).add(this.origin)}distanceToPoint(a){const s=p,c=s.subVectors(a,this.origin).dot(this.direction);return s.copy(this.direction).multiplyScalar(c).add(this.origin),s.distanceTo(a)}isIntersectionCylinder(){}isIntersectionSphere(a){return this.distanceToPoint(a.center)<=a.radius}isIntersectionPlane(a){return a.normal.dot(this.direction)!==0||a.distanceToPoint(this.origin)===0}distanceToPlane(a){const s=a.normal.dot(this.direction);return s===0?a.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot(a.normal)+a.constant)/s}intersectPlane(a,s){const c=this.distanceToPlane(a);if(c!==void 0)return this.at(c,s)}applyMatrix4(a){return this.direction.add(this.origin).applyMatrix4(a),this.origin.applyMatrix4(a),this.direction.sub(this.origin),this}clone(){return new T().copy(this)}}}),"./src/WebGL/math/utils/clamp.ts":((n,t,r)=>{r.r(t),r.d(t,{clamp:()=>u});function u(v,x,b){return Math.min(Math.max(v,x),b)}}),"./src/WebGL/math/utils/conversionMatrix3.ts":((n,t,r)=>{r.r(t),r.d(t,{conversionMatrix3:()=>v});var u=r("./src/WebGL/math/math.ts");function v(x,b,p,y,k,g){y=y*Math.PI/180,k=k*Math.PI/180,g=g*Math.PI/180;const R=s=>s*s,P=Math.cos(y),T=Math.cos(k),C=Math.cos(g),a=Math.sin(g);return new u.Matrix3(x,b*C,p*T,0,b*a,p*(P-T*C)/a,0,0,p*Math.sqrt(1-R(P)-R(T)-R(C)+2*P*T*C)/a)}}),"./src/WebGL/math/utils/degToRad.ts":((n,t,r)=>{r.r(t),r.d(t,{degToRad:()=>v});const u=Math.PI/180;function v(x){return x*u}}),"./src/WebGL/objects/Line.ts":((n,t,r)=>{r.r(t),r.d(t,{Line:()=>b,LineStyle:()=>x});var u=r("./src/WebGL/materials/index.ts"),v=r("./src/WebGL/core/index.ts"),x;(function(p){p[p.LineStrip=0]="LineStrip",p[p.LinePieces=1]="LinePieces"})(x||(x={}));class b extends v.Object3D{constructor(y,k=new u.LineBasicMaterial({color:Math.random()*16777215}),g=x.LineStrip){super(),this.geometry=y,this.material=k,this.type=g}clone(y=new b(this.geometry,this.material,this.type)){return super.clone.call(this,y),y}}}),"./src/WebGL/objects/Mesh.ts":((n,t,r)=>{r.r(t),r.d(t,{Mesh:()=>v});var u=r("./src/WebGL/core/index.ts");class v extends u.Object3D{constructor(b,p){super(),this.geometry=b,this.material=p}clone(b){return b===void 0&&(b=new v(this.geometry,this.material)),super.clone.call(this,b),b}}}),"./src/WebGL/objects/Sprite.ts":((n,t,r)=>{r.r(t),r.d(t,{Sprite:()=>x});var u=r("./src/WebGL/materials/index.ts"),v=r("./src/WebGL/core/index.ts");class x extends v.Object3D{constructor(p=new u.SpriteMaterial){super(),this.material=p,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),(this.scale.x!==1||this.scale.y!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(p=new x(this.material)){return v.Object3D.prototype.clone.call(this,p),p}}}),"./src/WebGL/objects/index.ts":((n,t,r)=>{r.r(t),r.d(t,{Line:()=>u.Line,LineStyle:()=>u.LineStyle,Mesh:()=>v.Mesh,Sprite:()=>x.Sprite});var u=r("./src/WebGL/objects/Line.ts"),v=r("./src/WebGL/objects/Mesh.ts"),x=r("./src/WebGL/objects/Sprite.ts")}),"./src/WebGL/shaders/ShaderType.ts":((n,t,r)=>{r.r(t)}),"./src/WebGL/shaders/index.ts":((n,t,r)=>{r.r(t),r.d(t,{ShaderLib:()=>u.ShaderLib,ShaderUtils:()=>v.ShaderUtils,basic:()=>u.basic,clone:()=>v.clone,instanced:()=>u.instanced,lambert:()=>u.lambert,lambertdouble:()=>u.lambertdouble,outline:()=>u.outline,screen:()=>u.screen,screenaa:()=>u.screenaa,sphereimposter:()=>u.sphereimposter,sphereimposteroutline:()=>u.sphereimposteroutline,sprite:()=>u.sprite,stickimposter:()=>u.stickimposter,stickimposteroutline:()=>u.stickimposteroutline,volumetric:()=>u.volumetric});var u=r("./src/WebGL/shaders/lib/index.ts"),v=r("./src/WebGL/shaders/utils/index.ts");r("./src/WebGL/shaders/ShaderType.ts")}),"./src/WebGL/shaders/lib/basic/index.ts":((n,t,r)=>{r.r(t),r.d(t,{basic:()=>b});var u=r("./src/WebGL/shaders/lib/basic/uniforms.ts"),v=r("./src/WebGL/shaders/lib/basic/basic.frag"),x=r("./src/WebGL/shaders/lib/basic/basic.vert");const b={vertexShader:x.default.replace("#define GLSLIFY 1",""),fragmentShader:v.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/basic/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}}}),"./src/WebGL/shaders/lib/blur/index.ts":((n,t,r)=>{r.r(t),r.d(t,{blur:()=>b});var u=r("./src/WebGL/shaders/lib/blur/uniforms.ts"),v=r("./src/WebGL/shaders/lib/blur/blur.frag"),x=r("./src/WebGL/shaders/lib/blur/blur.vert");const b={fragmentShader:v.default,vertexShader:x.default,uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/blur/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>u});const u={}}),"./src/WebGL/shaders/lib/index.ts":((n,t,r)=>{r.r(t),r.d(t,{ShaderLib:()=>w,basic:()=>u.basic,instanced:()=>v.instanced,lambert:()=>x.lambert,lambertdouble:()=>b.lambertdouble,outline:()=>p.outline,screen:()=>y.screen,screenaa:()=>k.screenaa,sphereimposter:()=>g.sphereimposter,sphereimposteroutline:()=>R.sphereimposteroutline,sprite:()=>P.sprite,stickimposter:()=>T.stickimposter,stickimposteroutline:()=>C.stickimposteroutline,volumetric:()=>a.volumetric});var u=r("./src/WebGL/shaders/lib/basic/index.ts"),v=r("./src/WebGL/shaders/lib/instanced/index.ts"),x=r("./src/WebGL/shaders/lib/lambert/index.ts"),b=r("./src/WebGL/shaders/lib/lambertdouble/index.ts"),p=r("./src/WebGL/shaders/lib/outline/index.ts"),y=r("./src/WebGL/shaders/lib/screen/index.ts"),k=r("./src/WebGL/shaders/lib/screenaa/index.ts"),g=r("./src/WebGL/shaders/lib/sphereimposter/index.ts"),R=r("./src/WebGL/shaders/lib/sphereimposteroutline/index.ts"),P=r("./src/WebGL/shaders/lib/sprite/index.ts"),T=r("./src/WebGL/shaders/lib/stickimposter/index.ts"),C=r("./src/WebGL/shaders/lib/stickimposteroutline/index.ts"),a=r("./src/WebGL/shaders/lib/volumetric/index.ts"),s=r("./src/WebGL/shaders/lib/ssao/index.ts"),c=r("./src/WebGL/shaders/lib/blur/index.ts");const w={basic:u.basic,blur:c.blur,instanced:v.instanced,lambert:x.lambert,lambertdouble:b.lambertdouble,outline:p.outline,screen:y.screen,screenaa:k.screenaa,ssao:s.ssao,sphereimposter:g.sphereimposter,sphereimposteroutline:R.sphereimposteroutline,sprite:P.sprite,stickimposter:T.stickimposter,stickimposteroutline:C.stickimposteroutline,volumetric:a.volumetric}}),"./src/WebGL/shaders/lib/instanced/index.ts":((n,t,r)=>{r.r(t),r.d(t,{instanced:()=>b});var u=r("./src/WebGL/shaders/lib/instanced/uniforms.ts"),v=r("./src/WebGL/shaders/lib/instanced/instanced.frag"),x=r("./src/WebGL/shaders/lib/instanced/instanced.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:x.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/instanced/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/lambert/index.ts":((n,t,r)=>{r.r(t),r.d(t,{lambert:()=>b});var u=r("./src/WebGL/shaders/lib/lambert/uniforms.ts"),v=r("./src/WebGL/shaders/lib/lambert/lambert.frag"),x=r("./src/WebGL/shaders/lib/lambert/lambert.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:x.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/lambert/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/lambertdouble/index.ts":((n,t,r)=>{r.r(t),r.d(t,{lambertdouble:()=>b});var u=r("./src/WebGL/shaders/lib/lambertdouble/uniforms.ts"),v=r("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag"),x=r("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:x.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/lambertdouble/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/outline/index.ts":((n,t,r)=>{r.r(t),r.d(t,{outline:()=>b});var u=r("./src/WebGL/shaders/lib/outline/uniforms.ts"),v=r("./src/WebGL/shaders/lib/outline/outline.frag"),x=r("./src/WebGL/shaders/lib/outline/outline.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:x.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/outline/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new u.Color(0,0,0)},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/screen/index.ts":((n,t,r)=>{r.r(t),r.d(t,{screen:()=>b});var u=r("./src/WebGL/shaders/lib/screen/uniforms.ts"),v=r("./src/WebGL/shaders/lib/screen/screen.frag"),x=r("./src/WebGL/shaders/lib/screen/screen.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:x.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/screen/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>u});const u={}}),"./src/WebGL/shaders/lib/screenaa/index.ts":((n,t,r)=>{r.r(t),r.d(t,{screenaa:()=>b});var u=r("./src/WebGL/shaders/lib/screenaa/uniforms.ts"),v=r("./src/WebGL/shaders/lib/screenaa/screenaa.frag"),x=r("./src/WebGL/shaders/lib/screenaa/screenaa.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:x.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/screenaa/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>u});const u={}}),"./src/WebGL/shaders/lib/sphereimposter/index.ts":((n,t,r)=>{r.r(t),r.d(t,{sphereimposter:()=>b});var u=r("./src/WebGL/shaders/lib/sphereimposter/uniforms.ts"),v=r("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag"),x=r("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert");const b={vertexShader:x.default.replace("#define GLSLIFY 1",""),fragmentShader:v.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/sphereimposter/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/sphereimposteroutline/index.ts":((n,t,r)=>{r.r(t),r.d(t,{sphereimposteroutline:()=>b});var u=r("./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts"),v=r("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag"),x=r("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:x.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new u.Color(0,0,0)},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/sprite/index.ts":((n,t,r)=>{r.r(t),r.d(t,{sprite:()=>b});var u=r("./src/WebGL/shaders/lib/sprite/uniforms.ts"),v=r("./src/WebGL/shaders/lib/sprite/sprite.frag"),x=r("./src/WebGL/shaders/lib/sprite/sprite.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:x.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/sprite/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>u});const u={}}),"./src/WebGL/shaders/lib/ssao/index.ts":((n,t,r)=>{r.r(t),r.d(t,{ssao:()=>b});var u=r("./src/WebGL/shaders/lib/ssao/uniforms.ts"),v=r("./src/WebGL/shaders/lib/ssao/ssao.frag"),x=r("./src/WebGL/shaders/lib/ssao/ssao.vert");const b={fragmentShader:v.default,vertexShader:x.default,uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/ssao/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>u});const u={total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}}),"./src/WebGL/shaders/lib/stickimposter/index.ts":((n,t,r)=>{r.r(t),r.d(t,{stickimposter:()=>p});var u=r("./src/WebGL/shaders/lib/stickimposter/uniforms.ts"),v=r("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),x=r("./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag"),b=r("./src/WebGL/shaders/lib/stickimposter/stickimposter.vert");const p={fragmentShader:[v.default,x.default].join(`
`),vertexShader:b.default,uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/stickimposter/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/stickimposteroutline/index.ts":((n,t,r)=>{r.r(t),r.d(t,{stickimposteroutline:()=>b});var u=r("./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts"),v=r("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),x=r("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert");const b={fragmentShader:v.default+"gl_FragColor = vec4(color,1.0);}",vertexShader:x.default,uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new u.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/volumetric/index.ts":((n,t,r)=>{r.r(t),r.d(t,{volumetric:()=>b});var u=r("./src/WebGL/shaders/lib/volumetric/uniforms.ts"),v=r("./src/WebGL/shaders/lib/volumetric/volumetric.frag"),x=r("./src/WebGL/shaders/lib/volumetric/volumetric.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:x.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/volumetric/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}}}),"./src/WebGL/shaders/utils/clone.ts":((n,t,r)=>{r.r(t),r.d(t,{clone:()=>v});var u=r("./src/colors.ts");function v(x){let b={};for(const y in x){b[y]={},b[y].type=x[y].type;var p=x[y].value;p instanceof u.Color?b[y].value=p.clone():typeof p=="number"?b[y].value=p:p instanceof Array?b[y].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return b}}),"./src/WebGL/shaders/utils/index.ts":((n,t,r)=>{r.r(t),r.d(t,{ShaderUtils:()=>v,clone:()=>u.clone});var u=r("./src/WebGL/shaders/utils/clone.ts");const v={clone:u.clone}}),"./src/WebGL/shapes/Cylinder.ts":((n,t,r)=>{r.r(t),r.d(t,{Cylinder:()=>x});var u=r("./src/WebGL/math/index.ts");let v=new u.Vector3;class x{constructor(p=new u.Vector3,y=new u.Vector3,k=0){this.c1=p,this.c2=y,this.radius=k,this.direction=new u.Vector3().subVectors(this.c2,this.c1).normalize()}copy(p){return this.c1.copy(p.c1),this.c2.copy(p.c2),this.direction.copy(p.direction),this.radius=p.radius,this}lengthSq(){return v.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(p){return this.direction.add(this.c1).applyMatrix4(p),this.c1.applyMatrix4(p),this.c2.applyMatrix4(p),this.direction.sub(this.c1).normalize(),this.radius=this.radius*p.getMaxScaleOnAxis(),this}}}),"./src/WebGL/shapes/Sphere.ts":((n,t,r)=>{r.r(t),r.d(t,{Sphere:()=>v});var u=r("./src/WebGL/math/index.ts");class v{constructor(b={x:0,y:0,z:0},p=0){this.center=new u.Vector3(b.x,b.y,b.z),this.radius=p}set(b,p){return this.center.copy(b),this.radius=p,this}copy(b){return this.center.copy(b.center),this.radius=b.radius,this}applyMatrix4(b){return this.center.applyMatrix4(b),this.radius=this.radius*b.getMaxScaleOnAxis(),this}translate(b){return this.center.add(b),this}equals(b){return b.center.equals(this.center)&&b.radius===this.radius}clone(){return new v().copy(this)}}}),"./src/WebGL/shapes/Triangle.ts":((n,t,r)=>{r.r(t),r.d(t,{Triangle:()=>x});var u=r("./src/WebGL/math/index.ts");const v=new u.Vector3;class x{constructor(p=new u.Vector3,y=new u.Vector3,k=new u.Vector3){this.a=p,this.b=y,this.c=k}copy(p){return this.a.copy(p.a),this.b.copy(p.b),this.c.copy(p.c),this}applyMatrix4(p){return this.a.applyMatrix4(p),this.b.applyMatrix4(p),this.c.applyMatrix4(p),this}getNormal(){var p=this.a.clone();return p.sub(this.b),v.subVectors(this.c,this.b),p.cross(v),p.normalize(),p}}}),"./src/WebGL/shapes/index.ts":((n,t,r)=>{r.r(t),r.d(t,{Cylinder:()=>v.Cylinder,Sphere:()=>u.Sphere,Triangle:()=>x.Triangle});var u=r("./src/WebGL/shapes/Sphere.ts"),v=r("./src/WebGL/shapes/Cylinder.ts"),x=r("./src/WebGL/shapes/Triangle.ts")}),"./src/autoload.ts":((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{autoinit:()=>autoinit,autoload:()=>autoload,processing_autoinit:()=>processing_autoinit,viewers:()=>viewers});var _GLViewer__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/GLViewer.ts"),_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/ProteinSurface4.ts"),_utilities__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utilities.ts"),_colors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/colors.ts"),autoinit=!1,processing_autoinit=!1,viewers={};function autoload(viewer,callback){var i,dataname,type;if(document.querySelector(".viewer_3Dmoljs")!=null&&(autoinit=!0),autoinit){processing_autoinit=!0,viewer=viewer??null;var nviewers=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(viewerdiv=>{var datauri=[],datatypes=[],uri="";viewerdiv.style.position=="static"&&(viewerdiv.style.position="relative");var UI=null;if(type=null,viewerdiv.dataset.pdb)datauri.push("https://files.rcsb.org/view/"+viewerdiv.dataset.pdb+".pdb"),datatypes.push("pdb");else if(viewerdiv.dataset.cid)datatypes.push("sdf"),datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+viewerdiv.dataset.cid+"/SDF?record_type=3d");else if(viewerdiv.dataset.href||viewerdiv.dataset.url){if(viewerdiv.dataset.href?uri=viewerdiv.dataset.href:uri=viewerdiv.dataset.url,datauri.push(uri),type=uri.substring(uri.lastIndexOf(".")+1),type=="gz"){let n=uri.substring(0,uri.lastIndexOf(".")).lastIndexOf(".");type=uri.substring(n+1)}datatypes.push(type);var molName=uri.substring(uri.lastIndexOf("/")+1,uri.lastIndexOf("."));molName=="/"&&(molName=uri.substring(uri.lastIndexOf("/")+1)),viewerdiv.dataset[datatypes[datatypes.length-1]]=molName}let divdata=viewerdiv.dataset;for(i in divdata)i.substring(0,3)==="pdb"&&i!=="pdb"?(datauri.push("https://files.rcsb.org/view/"+divdata[i]+".pdb"),datatypes.push("pdb")):i.substring(0,4)==="href"&&i!=="href"?(uri=divdata[i],datauri.push(uri),datatypes.push(uri.substring(uri.lastIndexOf(".")+1))):i.substring(0,3)==="cid"&&i!=="cid"&&(datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+divdata[i]+"/SDF?record_type=3d"),datatypes.push("sdf"));var options={};viewerdiv.dataset.options&&(options=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.options));var bgcolor=_colors__WEBPACK_IMPORTED_MODULE_3__.CC.color(viewerdiv.dataset.backgroundcolor),bgalpha=viewerdiv.dataset.backgroundalpha;bgalpha=bgalpha==null?1:parseFloat(bgalpha);var style={line:{}};viewerdiv.dataset.style&&(style=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.style));var select={};viewerdiv.dataset.select&&(select=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.select));var selectstylelist=[],surfaces=[],labels=[],zoomto={},spin=null,d=viewerdiv.dataset,stylere=/style(.+)/,surfre=/surface(.*)/,reslabre=/labelres(.*)/,keys=[];for(dataname in d)Object.prototype.hasOwnProperty.call(d,dataname)&&keys.push(dataname);for(keys.sort(),i=0;i<keys.length;i++){dataname=keys[i];var m=stylere.exec(dataname),selname,newsel,styleobj;m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),selectstylelist.push([newsel,styleobj])),m=surfre.exec(dataname),m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),surfaces.push([newsel,styleobj])),m=reslabre.exec(dataname),m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),labels.push([newsel,styleobj])),dataname=="zoomto"&&(zoomto=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname])),dataname=="spin"&&(spin=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]))}var applyStyles=function(n){for(n.setStyle(select,style),UI&&UI.createSelectionAndStyle(select,style),i=0;i<selectstylelist.length;i++){let t=selectstylelist[i][0]||{},r=selectstylelist[i][1]||{line:{}};n.setStyle(t,r),UI&&UI.createSelectionAndStyle(select,style)}for(i=0;i<surfaces.length;i++){let t=surfaces[i][0]||{},r=surfaces[i][1]||{};UI?n.addSurface(_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__.SurfaceType.VDW,r,t,t).then(u=>{UI.loadSurface("VDW",t,r,u)}):n.addSurface(_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__.SurfaceType.VDW,r,t,t)}for(i=0;i<labels.length;i++){let t=labels[i][0]||{},r=labels[i][1]||{};n.addResLabels(t,r)}n.render(),n.zoomTo(zoomto),spin&&n.spin(spin.axis,spin.speed)};let glviewer=viewer;try{var config=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.config)||{};config.backgroundColor===void 0&&(config.backgroundColor=bgcolor),config.backgroundAlpha===void 0&&(config.backgroundAlpha=bgalpha),glviewer==null?glviewer=viewers[viewerdiv.id||nviewers++]=(0,_GLViewer__WEBPACK_IMPORTED_MODULE_0__.createViewer)(viewerdiv,config):(glviewer.setBackgroundColor(bgcolor,bgalpha),glviewer.setConfig(config),UI&&UI.initiateUI()),viewerdiv.dataset.ui&&$3Dmol.StateManager&&(UI=new $3Dmol.StateManager(glviewer))}catch(n){console.log(n),viewerdiv.textContent="WebGL appears to be disabled."}if(datauri.length!=0){let i=0,process=((viewerdiv,glviewer)=>function(moldata){uri=datauri[i];var type=viewerdiv.dataset.type||viewerdiv.dataset.datatype||datatypes[i];if(glviewer.addModel(moldata,type,options),UI){var modelName=viewerdiv.dataset[datatypes[i]];UI.setModelTitle(modelName)}if(i+=1,i<datauri.length)(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.get)(datauri[i]).then(process);else{if(applyStyles(glviewer),viewerdiv.dataset.callback){var runres=eval(viewerdiv.dataset.callback);typeof runres=="function"&&runres(glviewer)}processing_autoinit=!1,callback&&callback(glviewer)}})(viewerdiv,glviewer);type&&type.endsWith("gz")?(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.getbin)(datauri[0]).then(process):(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.get)(datauri[0]).then(process)}else{if(viewerdiv.dataset.element){var moldataid="#"+viewerdiv.dataset.element,molelem=document.querySelector(moldataid),moldata=molelem?molelem.textContent:"";type=viewerdiv.dataset.type||viewerdiv.dataset.datatype,glviewer.addModel(moldata,type,options)}if(applyStyles(glviewer),viewerdiv.dataset.callback){var runres=eval(viewerdiv.dataset.callback);typeof runres=="function"&&runres(glviewer)}processing_autoinit=!1,callback&&callback(glviewer)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&autoload()}}),"./src/colors.ts":((n,t,r)=>{r.r(t),r.d(t,{CC:()=>v,Color:()=>u,builtinColorSchemes:()=>R,chains:()=>g,elementColors:()=>y,htmlColors:()=>x,residues:()=>k,ssColors:()=>b});class u{constructor(T,C,a){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof T=="number"?(this.r=T||0,this.g=C||0,this.b=a||0,this):this.set(T||0)}set(T){return T instanceof u?T.clone():(typeof T=="number"?this.setHex(T):typeof T=="object"&&(this.r=T?.r||0,this.g=T?.g||0,this.b=T?.b||0),this)}setHex(T){return T=Math.floor(T),this.r=(T>>16&255)/255,this.g=(T>>8&255)/255,this.b=(T&255)/255,this}getHex(){var T=Math.round(this.r*255),C=Math.round(this.g*255),a=Math.round(this.b*255);return T<<16|C<<8|a}clone(){return new u(this.r,this.g,this.b)}copy(T){return this.r=T.r,this.g=T.g,this.b=T.b,this}scaled(){var T={};return T.r=Math.round(this.r*255),T.g=Math.round(this.g*255),T.b=Math.round(this.b*255),T.a=1,T}}class v{static color(T){if(!T)return v.cache[0];if(T instanceof u)return T;if(typeof T=="number"&&typeof v.cache[T]<"u")return v.cache[T];if(T&&Array.isArray(T))return T.map(v.color);let C=v.getHex(T),a=new u(C);return v.cache[C]=a,a}static getHex(T){var C;if(Array.isArray(T))return T.map(v.getHex);if(typeof T=="string"){let a=T;if(!isNaN(parseInt(a)))return parseInt(a);if(a=a.trim(),a.length==4&&a[0]=="#"&&(a="#"+a[1]+a[1]+a[2]+a[2]+a[3]+a[3]),a.length==7&&a[0]=="#")return parseInt(a.substring(1),16);let s=v.rgbRegEx.exec(a);if(s){s[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let c=0;for(let w=2;w<5;w++){c*=256;let _=s[w].endsWith("%")?255*parseFloat(s[w])/100:parseFloat(s[w]);c+=Math.round(_)}return c}return((C=window?.$3Dmol)===null||C===void 0?void 0:C.htmlColors[T.toLowerCase()])||0}return T}}v.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,v.cache={0:new u(0)};const x={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},b={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},p={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},y={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:p,defaultColors:Object.assign({},p),greenCarbon:Object.assign(Object.assign({},p),{C:65280}),cyanCarbon:Object.assign(Object.assign({},p),{C:65535}),magentaCarbon:Object.assign(Object.assign({},p),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},p),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},p),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},p),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},p),{C:8388736}),blueCarbon:Object.assign(Object.assign({},p),{C:255})},k={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},g={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},R={ssPyMol:{prop:"ss",map:b.pyMol},ssJmol:{prop:"ss",map:b.Jmol},Jmol:{prop:"elem",map:y.Jmol},amino:{prop:"resn",map:k.amino},shapely:{prop:"resn",map:k.shapely},nucleic:{prop:"resn",map:k.nucleic},chain:{prop:"chain",map:g.atom},rasmol:{prop:"elem",map:y.rasmol},default:{prop:"elem",map:y.defaultColors},greenCarbon:{prop:"elem",map:y.greenCarbon},chainHetatm:{prop:"chain",map:g.hetatm},cyanCarbon:{prop:"elem",map:y.cyanCarbon},magentaCarbon:{prop:"elem",map:y.magentaCarbon},purpleCarbon:{prop:"elem",map:y.purpleCarbon},whiteCarbon:{prop:"elem",map:y.whiteCarbon},orangeCarbon:{prop:"elem",map:y.orangeCarbon},yellowCarbon:{prop:"elem",map:y.yellowCarbon},blueCarbon:{prop:"elem",map:y.blueCarbon}}}),"./src/glcartoon.ts":((n,t,r)=>{r.r(t),r.d(t,{drawCartoon:()=>V,subdivide_spline:()=>g});var u=r("./src/WebGL/math/index.ts"),v=r("./src/WebGL/shapes/index.ts"),x=r("./src/WebGL/index.ts"),b=r("./src/Gradient.ts"),p=r("./src/colors.ts"),y=r("./src/GLDraw.ts"),k=r("./src/utilities.ts");function g(O,W){var H=[],q=O;q=[],q.push(O[0]);var U,B,Y,X,N,J,ae,se,he;for(U=1,B=O.length-1;U<B;U++)if(N=O[U],J=O[U+1],N.smoothen){var pe=new u.Vector3((N.x+J.x)/2,(N.y+J.y)/2,(N.z+J.z)/2);pe.atom=N.atom,q.push(pe)}else q.push(N);for(q.push(O[O.length-1]),U=-1,Y=q.length;U<=Y-3;U++)if(X=q[U===-1?0:U],N=q[U+1],J=q[U+2],ae=q[U===Y-3?Y-1:U+3],se=new u.Vector3().subVectors(J,X).multiplyScalar(.5),he=new u.Vector3().subVectors(ae,N).multiplyScalar(.5),!J.skip)for(var de=0;de<W;de++){var ue=1/W*de,ge=N.x+ue*se.x+ue*ue*(-3*N.x+3*J.x-2*se.x-he.x)+ue*ue*ue*(2*N.x-2*J.x+se.x+he.x),Re=N.y+ue*se.y+ue*ue*(-3*N.y+3*J.y-2*se.y-he.y)+ue*ue*ue*(2*N.y-2*J.y+se.y+he.y),Ge=N.z+ue*se.z+ue*ue*(-3*N.z+3*J.z-2*se.z-he.z)+ue*ue*ue*(2*N.z-2*J.z+se.z+he.z),We=new u.Vector3(ge,Re,Ge);de<W/2?We.atom=N.atom:We.atom=J.atom,H.push(We)}return H.push(q[q.length-1]),H}const R=.5,P=1.3,T=.8,C=.4,a=.4;function s(O,W,H,q){for(var U,B,Y,X,N=0,J=W.length;N<J;N++){X=Math.round(N*(q.length-1)/J),Y=p.CC.color(q[X]);var ae=O.updateGeoGroup(2),se=ae.vertexArray,he=ae.colorArray,pe=ae.faceArray;U=ae.vertices,B=U*3,se[B]=W[N].x,se[B+1]=W[N].y,se[B+2]=W[N].z,se[B+3]=H[N].x,se[B+4]=H[N].y,se[B+5]=H[N].z;for(var de=0;de<6;++de)he[B+3*de]=Y.r,he[B+1+3*de]=Y.g,he[B+2+3*de]=Y.b;if(N>0){var ue=[U,U+1,U-1,U-2],ge=ae.faceidx;pe[ge]=ue[0],pe[ge+1]=ue[1],pe[ge+2]=ue[3],pe[ge+3]=ue[1],pe[ge+4]=ue[2],pe[ge+5]=ue[3],ae.faceidx+=6}ae.vertices+=2}}function c(O,W,H,q,U,B,Y){var X,N,J,ae;if(J=W.length,J<2||W[0].length<2)return;for(X=0;X<J;X++)W[X]=g(W[X],q);if(ae=W[0].length,!U)return s(O,W[0],W[J-1],H);var se,he,pe,de,ue,ge,Re=[],Ge=[],We=[];for(N=0;N<J;N++)Re.push(.25+1.5*Math.sqrt((J-1)*N-Math.pow(N,2))/(J-1)),Ge.push(.5),We.push(2*(Math.pow(N/J,2)-N/J)+.6);var Oe=[];for(N=0;N<J*2-1;N++)Oe[N]=[N,N+1,N+1-2*J,N-2*J];Oe[J*2-1]=[N,N+1-2*J,N+1-4*J,N-2*J];var me,Fe,qe,Qe,st,ot,Ke,Je,Xe,Ne;let Ue=O.updateGeoGroup();for(X=0;X<ae;X++){let ie=O.groups,oe=!1;Ue=O.updateGeoGroup(2*J),ie!=O.groups&&X>0&&(X=X-1,oe=!0),ot=Math.round(X*(H.length-1)/ae),st=p.CC.color(H[ot]),ue=pe,ge=de,pe=[],de=[],se=[],W[0][X].atom!==void 0&&(Qe=W[0][X].atom,Y==="oval"?he=Re:Y==="rectangle"?he=Ge:Y==="parabola"&&(he=We)),he||(he=Ge);var ft,ut;for(N=0;N<J;N++)X<ae-1?ft=W[N][X+1].clone().sub(W[N][X]):ft=W[N][X-1].clone().sub(W[N][X]).negate(),N<J-1?ut=W[N+1][X].clone().sub(W[N][X]):ut=W[N-1][X].clone().sub(W[N][X]).negate(),se[N]=ut.cross(ft).normalize().multiplyScalar(U*he[N]);for(N=0;N<J;N++)pe[N]=W[N][X].clone().add(se[N].clone().negate());for(N=0;N<J;N++)de[N]=W[N][X].clone().add(se[N]);for(Ke=Ue.vertexArray,Je=Ue.colorArray,Xe=Ue.faceArray,me=Ue.vertices,Fe=me*3,N=0;N<J;N++)Ke[Fe+3*N+0]=pe[N].x,Ke[Fe+3*N+1]=pe[N].y,Ke[Fe+3*N+2]=pe[N].z;for(N=0;N<J;N++)Ke[Fe+3*N+0+3*J]=de[J-1-N].x,Ke[Fe+3*N+1+3*J]=de[J-1-N].y,Ke[Fe+3*N+2+3*J]=de[J-1-N].z;for(N=0;N<2*J;++N)Je[Fe+3*N+0]=st.r,Je[Fe+3*N+1]=st.g,Je[Fe+3*N+2]=st.b;if(X>0&&!oe){for(N=0;N<J*2;N++)Ne=[me+Oe[N][0],me+Oe[N][1],me+Oe[N][2],me+Oe[N][3]],qe=Ue.faceidx,Xe[qe]=Ne[0],Xe[qe+1]=Ne[1],Xe[qe+2]=Ne[3],Xe[qe+3]=Ne[1],Xe[qe+4]=Ne[2],Xe[qe+5]=Ne[3],Ue.faceidx+=6;if(Qe.clickable||Qe.hoverable){var ee=[];ee.push(new v.Triangle(ue[0],pe[0],pe[J-1])),ee.push(new v.Triangle(ue[0],pe[J-1],ue[J-1])),ee.push(new v.Triangle(ue[J-1],pe[J-1],de[J-1])),ee.push(new v.Triangle(ue[J-1],de[J-1],ge[J-1])),ee.push(new v.Triangle(de[0],ge[0],ge[J-1])),ee.push(new v.Triangle(de[J-1],de[0],ge[J-1])),ee.push(new v.Triangle(pe[0],ue[0],ge[0])),ee.push(new v.Triangle(de[0],pe[0],ge[0]));for(N in ee)Qe.intersectionShape.triangle.push(ee[N])}}Ue.vertices+=2*J}for(Ke=Ue.vertexArray,Je=Ue.colorArray,Xe=Ue.faceArray,me=Ue.vertices,Fe=me*3,qe=Ue.faceidx,X=0;X<J-1;X++)Ne=[X,X+1,2*J-2-X,2*J-1-X],qe=Ue.faceidx,Xe[qe]=Ne[0],Xe[qe+1]=Ne[1],Xe[qe+2]=Ne[3],Xe[qe+3]=Ne[1],Xe[qe+4]=Ne[2],Xe[qe+5]=Ne[3],Ue.faceidx+=6;for(X=0;X<J-1;X++)Ne=[me-1-X,me-2-X,me-2*J+X+1,me-2*J+X],qe=Ue.faceidx,Xe[qe]=Ne[0],Xe[qe+1]=Ne[1],Xe[qe+2]=Ne[3],Xe[qe+3]=Ne[1],Xe[qe+4]=Ne[2],Xe[qe+5]=Ne[3],Ue.faceidx+=6}function w(O,W,H,q,U,B){if(!(W.length<2)){var Y,X;if(Y=W[0],X=W[W.length-1],Y=g(Y,q),X=g(X,q),!U)return s(O,Y,X,H);var N=[],J,ae,se,he,pe,de=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],ue,ge,Re,Ge,We,Oe,me,Fe,qe,Qe,st,ot,Ke,Je,Xe,Ne,Ue;for(Fe=0,qe=Y.length;Fe<qe;Fe++){if(We=Math.round(Fe*(H.length-1)/qe),Ge=p.CC.color(H[We]),N.push(ae=Y[Fe]),N.push(ae),N.push(se=X[Fe]),N.push(se),Fe<qe-1){var ft=Y[Fe+1].clone().sub(Y[Fe]),ut=X[Fe].clone().sub(Y[Fe]);J=ut.cross(ft).normalize().multiplyScalar(U)}for(N.push(he=Y[Fe].clone().add(J)),N.push(he),N.push(pe=X[Fe].clone().add(J)),N.push(pe),ae.atom!==void 0&&(Oe=ae.atom),Je=O.updateGeoGroup(8),Xe=Je.vertexArray,Ne=Je.colorArray,Ue=Je.faceArray,ue=Je.vertices,ge=ue*3,Xe[ge]=ae.x,Xe[ge+1]=ae.y,Xe[ge+2]=ae.z,Xe[ge+3]=ae.x,Xe[ge+4]=ae.y,Xe[ge+5]=ae.z,Xe[ge+6]=se.x,Xe[ge+7]=se.y,Xe[ge+8]=se.z,Xe[ge+9]=se.x,Xe[ge+10]=se.y,Xe[ge+11]=se.z,Xe[ge+12]=he.x,Xe[ge+13]=he.y,Xe[ge+14]=he.z,Xe[ge+15]=he.x,Xe[ge+16]=he.y,Xe[ge+17]=he.z,Xe[ge+18]=pe.x,Xe[ge+19]=pe.y,Xe[ge+20]=pe.z,Xe[ge+21]=pe.x,Xe[ge+22]=pe.y,Xe[ge+23]=pe.z,Qe=0;Qe<8;++Qe)Ne[ge+3*Qe]=Ge.r,Ne[ge+1+3*Qe]=Ge.g,Ne[ge+2+3*Qe]=Ge.b;if(Fe>0){var ee=me!==void 0&&Oe!==void 0&&me.serial!==Oe.serial;for(Qe=0;Qe<4;Qe++){var ie=[ue+de[Qe][0],ue+de[Qe][1],ue+de[Qe][2],ue+de[Qe][3]];if(Re=Je.faceidx,Ue[Re]=ie[0],Ue[Re+1]=ie[1],Ue[Re+2]=ie[3],Ue[Re+3]=ie[1],Ue[Re+4]=ie[2],Ue[Re+5]=ie[3],Je.faceidx+=6,Oe.clickable||me.clickable||Oe.hoverable||me.hoverable){var oe=N[ie[3]].clone(),we=N[ie[0]].clone(),Se=N[ie[2]].clone(),He=N[ie[1]].clone();if(oe.atom=N[ie[3]].atom||null,Se.atom=N[ie[2]].atom||null,we.atom=N[ie[0]].atom||null,He.atom=N[ie[1]].atom||null,ee){var Be=oe.clone().add(we).multiplyScalar(.5),K=Se.clone().add(He).multiplyScalar(.5),xe=oe.clone().add(He).multiplyScalar(.5);Qe%2===0?((me.clickable||me.hoverable)&&(st=new v.Triangle(Be,xe,oe),ot=new v.Triangle(K,Se,xe),Ke=new v.Triangle(xe,Se,oe),me.intersectionShape.triangle.push(st),me.intersectionShape.triangle.push(ot),me.intersectionShape.triangle.push(Ke)),(Oe.clickable||Oe.hoverable)&&(st=new v.Triangle(we,He,xe),ot=new v.Triangle(He,K,xe),Ke=new v.Triangle(we,xe,Be),Oe.intersectionShape.triangle.push(st),Oe.intersectionShape.triangle.push(ot),Oe.intersectionShape.triangle.push(Ke))):((Oe.clickable||Oe.hoverable)&&(st=new v.Triangle(Be,xe,oe),ot=new v.Triangle(K,Se,xe),Ke=new v.Triangle(xe,Se,oe),Oe.intersectionShape.triangle.push(st),Oe.intersectionShape.triangle.push(ot),Oe.intersectionShape.triangle.push(Ke)),(me.clickable||me.hoverable)&&(st=new v.Triangle(we,He,xe),ot=new v.Triangle(He,K,xe),Ke=new v.Triangle(we,xe,Be),me.intersectionShape.triangle.push(st),me.intersectionShape.triangle.push(ot),me.intersectionShape.triangle.push(Ke)))}else(Oe.clickable||Oe.hoverable)&&(st=new v.Triangle(we,He,oe),ot=new v.Triangle(He,Se,oe),Oe.intersectionShape.triangle.push(st),Oe.intersectionShape.triangle.push(ot))}}}Je.vertices+=8,me=Oe}var Me=N.length-8;for(Je=O.updateGeoGroup(8),Xe=Je.vertexArray,Ne=Je.colorArray,Ue=Je.faceArray,ue=Je.vertices,ge=ue*3,Re=Je.faceidx,Fe=0;Fe<4;Fe++){N.push(N[Fe*2]),N.push(N[Me+Fe*2]);var $e=N[Fe*2],ye=N[Me+Fe*2];Xe[ge+6*Fe]=$e.x,Xe[ge+1+6*Fe]=$e.y,Xe[ge+2+6*Fe]=$e.z,Xe[ge+3+6*Fe]=ye.x,Xe[ge+4+6*Fe]=ye.y,Xe[ge+5+6*Fe]=ye.z,Ne[ge+6*Fe]=Ge.r,Ne[ge+1+6*Fe]=Ge.g,Ne[ge+2+6*Fe]=Ge.b,Ne[ge+3+6*Fe]=Ge.r,Ne[ge+4+6*Fe]=Ge.g,Ne[ge+5+6*Fe]=Ge.b}Me+=8,st=[ue,ue+2,ue+6,ue+4],ot=[ue+1,ue+5,ue+7,ue+3],Ue[Re]=st[0],Ue[Re+1]=st[1],Ue[Re+2]=st[3],Ue[Re+3]=st[1],Ue[Re+4]=st[2],Ue[Re+5]=st[3],Ue[Re+6]=ot[0],Ue[Re+7]=ot[1],Ue[Re+8]=ot[3],Ue[Re+9]=ot[1],Ue[Re+10]=ot[2],Ue[Re+11]=ot[3],Je.faceidx+=12,Je.vertices+=8}}function _(O,W,H,q,U,B,Y){(!Y||Y==="default")&&(Y="rectangle"),Y==="edged"?w(O,W,H,q,U):(Y==="rectangle"||Y==="oval"||Y==="parabola")&&c(O,W,H,q,U,B,Y)}function M(O){return O&&O.elem==="C"&&O.atom==="CA"}function l(O,W){if(O&&W&&O.chain===W.chain){if(!O.hetflag&&!W.hetflag&&O.reschain===W.reschain&&(O.resi===W.resi||O.resi===W.resi-1))return!0;if(O.resi<W.resi){var H=O.x-W.x,q=O.y-W.y,U=O.z-W.z,B=H*H+q*q+U*U;if(O.atom=="CA"&&W.atom=="CA"&&B<16||(O.atom=="P"||W.atom=="P")&&B<64)return!0}}return!1}function h(O,W,H,q,U){if(!(W==null||W.vertices==0)){U&&(W.initTypedArrays(),W.setUpNormals());var B=new x.MeshDoubleLambertMaterial;B.vertexColors=x.Coloring.FaceColors,typeof H=="number"&&H>=0&&H<1&&(B.transparent=!0,B.opacity=H),B.outline=q;var Y=new x.Mesh(W,B);O.add(Y)}}function S(O,W,H,q,U,B,Y,X,N){var J,ae,se,he,pe,de;if(!(!q||!U||!Y)){var ue=U.sub(q);ue.normalize();var ge=X[N];for(ae=N+1;ae<X.length&&(ge=X[ae],ge.atom!=Y.atom);ae++);if(ge=ge?new u.Vector3(ge.x,ge.y,ge.z):new u.Vector3(0,0,0),ge.sub(q),Y.ss==="arrow start"){var Re=ge.clone().multiplyScalar(.3).cross(U);q.add(Re);var Ge=ge.clone().cross(ue).normalize();ue.rotateAboutVector(Ge,.43)}for(Y.style.cartoon.ribbon?J=Y.style.cartoon.thickness||C:Y.style.cartoon.width?J=Y.style.cartoon.width:Y.ss==="c"?Y.atom==="P"?J=T:J=R:Y.ss==="arrow start"?(J=P,pe=!0):Y.ss==="arrow end"||Y.ss==="h"&&Y.style.cartoon.tubes||Y.ss==="tube start"?J=R:J=P,B!=null&&ue.dot(B)<0&&ue.negate(),ue.multiplyScalar(J),ae=0;ae<W;ae++)se=-1+ae*2/(W-1),he=new u.Vector3(q.x+se*ue.x,q.y+se*ue.y,q.z+se*ue.z),he.atom=Y,Y.ss==="s"&&(he.smoothen=!0),O[ae].push(he);if(pe)for(ue.multiplyScalar(2),ae=0;ae<W;ae++)se=-1+ae*2/(W-1),he=new u.Vector3(q.x+se*ue.x,q.y+se*ue.y,q.z+se*ue.z),he.atom=Y,he.smoothen=!1,he.skip=!0,O[ae].push(he);return de=Y.style.cartoon.style||"default",O.style?O.style!=de&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),O.style="default"):O.style=de,(Y.ss==="arrow start"||Y.ss==="arrow end")&&(Y.ss="s"),pe}}const E={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},F={DA:!0,DG:!0,A:!0,G:!0},D={DT:!0,DC:!0,U:!0,C:!0,T:!0},L={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function V(O,W,H,q=10){let U=q,B=q;var Y,X,N,J,ae,se,he,pe,de,ue,ge,Re,Ge,We,Oe,me,Fe,qe,Qe=new x.Geometry(!0),st=new x.Geometry(!0),ot=[],Ke=[],Je=1,Xe=!1,Ne={};for(var Ue in b.Gradient.builtinGradients)b.Gradient.builtinGradients.hasOwnProperty(Ue)&&(Ne[Ue]=new b.Gradient.builtinGradients[Ue](H[1],H[0]));var ft=function(Z,De){return H&&De.color==="spectrum"?De.colorscheme in Ne?Ne[De.colorscheme].valueToHex(Z.resi):Ne.sinebow.valueToHex(Z.resi):(0,k.getColorFromStyle)(Z,De).getHex()};for(pe=0;pe<U;pe++)Ke[pe]=[];var ut=!1,ee=!1,ie=[];for(pe in W){if(J=W[pe],J.elem==="C"&&J.atom==="CA"){var oe=l(N,J);oe&&J.ss==="s"?ut=!0:ut&&(N&&X&&N.style.cartoon.arrows&&X.style.cartoon.arrows&&(N.ss="arrow end",X.ss="arrow start"),ut=!1),oe&&(N.ss==="h"||N.ss=="tube start")&&N.style.cartoon.tubes?!ee&&N.ss!="tube start"&&J.style.cartoon.tubes&&(J.ss="tube start",ee=!0):ee&&(N.ss==="tube start"?N.ss="tube end":X&&X.style.cartoon.tubes&&(X.ss="tube end"),ee=!1),X=N,N=J}J&&J.atom in E&&ie.push(J)}ee&&N.style.cartoon.tubes&&(N.ss="tube end",ee=!1);var we=function(Z){Ke[0].length>0&&_(st,Ke,ot,B,he,Je,Ke.style);var De=[],rt=null;if(Z){for(pe=0;pe<U;pe++)De[pe]=Ke[pe][Ke[pe].length-1];rt=ot[ot.length-1]}for(Ke=[],pe=0;pe<U;pe++)Ke[pe]=[];if(ot=[],Z){for(pe=0;pe<U;pe++)Ke[pe].push(De[pe]);ot.push(rt)}h(O,st,Je,Xe,!0),h(O,Qe,Je,Xe,!1),st=new x.Geometry(!0),Qe=new x.Geometry(!0)};N=void 0;for(var Se=0;Se<ie.length;Se++){J=ie[Se];var He=J.resn.trim(),Be=He in L;if(Je=1,Y=J.style.cartoon,N&&N.style.cartoon&&(Je=N.style.cartoon.opacity),N&&N.style.cartoon&&N.style.cartoon.outline&&(Xe=N.style.cartoon.outline),N&&N.style.cartoon&&(!J.style.cartoon||N.style.cartoon.opacity!=J.style.cartoon.opacity)&&we(N.chain==J.chain),Y.style==="trace"){if(!J.hetflag&&(J.elem==="C"&&J.atom==="CA"||Be&&J.atom==="P"||J.atom==="BB")){if(se=ft(J,Y),(0,k.isNumeric)(Y.thickness)?he=Y.thickness:he=C,l(N,J))if(se==ae){var K=p.CC.color(se);y.GLDraw.drawCylinder(Qe,N,J,he,K,2,2)}else{var xe=new u.Vector3().addVectors(N,J).multiplyScalar(.5),Me=p.CC.color(ae),$e=p.CC.color(se);y.GLDraw.drawCylinder(Qe,N,xe,he,Me,2,0),y.GLDraw.drawCylinder(Qe,xe,J,he,$e,0,2)}if((J.clickable===!0||J.hoverable)&&J.intersectionShape!==void 0){var ye=new u.Vector3(J.x,J.y,J.z);J.intersectionShape.sphere.push(new v.Sphere(ye,he))}N=J,ae=se}}else{if(M(J)||Be&&(J.atom==="P"||J.atom.indexOf("O5")==0)){if(qe)if(J.ss==="tube end")qe=!1,Fe=new u.Vector3(J.x,J.y,J.z),y.GLDraw.drawCylinder(Qe,me,Fe,2,p.CC.color(ae),1,1),J.ss="h";else if(N.chain!=J.chain||N.ss==="tube end")qe=!1,N.ss="h",Fe=new u.Vector3(N.x,N.y,N.z),y.GLDraw.drawCylinder(Qe,me,Fe,2,p.CC.color(ae),1,1);else continue;if(N&&(!l(N,J)||N.ss==="tube start")){for(N.ss==="tube start"&&(qe=!0,me=new u.Vector3(N.x,N.y,N.z),N.ss="h"),Oe&&(Re?We=new u.Vector3().addVectors(N,Re).multiplyScalar(.5):We=new u.Vector3(N.x,N.y,N.z),y.GLDraw.drawCylinder(Qe,We,Oe,a,p.CC.color(Oe.color),0,2),S(Ke,U,!0,Re,Ge,ge,N,ie,Se),ot.push(se),We=null,Oe=null),Ke[0].length>0&&_(st,Ke,ot,B,he,Je,Ke.style),Ke=[],pe=0;pe<U;pe++)Ke[pe]=[];ot=[]}if(N===void 0||N.rescode!=J.rescode||N.resi!=J.resi){if(Oe&&N!=null){We=new u.Vector3().addVectors(N,J).multiplyScalar(.5);var je=We.clone().sub(Oe).multiplyScalar(.02);We.add(je),y.GLDraw.drawCylinder(Qe,We,Oe,a,p.CC.color(Oe.color),0,2),We=null,Oe=null}se=ft(J,Y),ot.push(se),(0,k.isNumeric)(Y.thickness)?he=Y.thickness:he=C,N=J,de=new u.Vector3(N.x,N.y,N.z),de.resi=N.resi,ae=se}(J.clickable===!0||J.hoverable===!0)&&(J.intersectionShape===void 0||J.intersectionShape.triangle===void 0)&&(J.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else N!=null&&(M(N)&&J.atom==="O"||Be&&N.atom==="P"&&(J.atom==="OP2"||J.atom==="O2P")||Be&&N.atom.indexOf("O5")==0&&J.atom.indexOf("C5")==0)?(ue=new u.Vector3(J.x,J.y,J.z),ue.resi=J.resi,(J.atom==="OP2"||J.atom==="O2P")&&(Ge=new u.Vector3(J.x,J.y,J.z))):Be&&J.atom.indexOf("O3")==0?Re=new u.Vector3(J.x,J.y,J.z):(J.atom==="N1"&&He in F||J.atom==="N3"&&He in D)&&(Oe=new u.Vector3(J.x,J.y,J.z),Oe.color=(0,k.getColorFromStyle)(J,Y).getHex());ue&&de&&ue.resi===de.resi&&(S(Ke,U,!0,de,ue,ge,N,ie,Se),ge=ue,de=null,ue=null,ot.push(se))}}Oe&&(Re?We=new u.Vector3().addVectors(N,Re).multiplyScalar(.5):We=new u.Vector3(N.x,N.y,N.z),y.GLDraw.drawCylinder(Qe,We,Oe,a,p.CC.color(Oe.color),0,2),S(Ke,U,!0,Re,Ge,ge,N,ie,Se),ot.push(se)),we(!1)}}),"./src/index.ts":((n,t,r)=>{r.r(t),r.d(t,{CAP:()=>a.CAP,CC:()=>v.CC,CONTEXTS_PER_VIEWPORT:()=>w.CONTEXTS_PER_VIEWPORT,Color:()=>v.Color,CustomLinear:()=>u.CustomLinear,Cylinder:()=>k.Cylinder,GLDraw:()=>a.GLDraw,GLModel:()=>c.GLModel,GLShape:()=>C.GLShape,GLViewer:()=>w.GLViewer,GLVolumetricRender:()=>T.GLVolumetricRender,Gradient:()=>u.Gradient,GradientType:()=>u.GradientType,Label:()=>x.Label,LabelCount:()=>x.LabelCount,MarchingCube:()=>R.MarchingCube,MarchingCubeInitializer:()=>R.MarchingCubeInitializer,Matrix3:()=>y.Matrix3,Matrix4:()=>y.Matrix4,Parsers:()=>p.Parsers,PausableTimer:()=>g.PausableTimer,PointGrid:()=>R.PointGrid,ProteinSurface:()=>R.ProteinSurface,Quaternion:()=>y.Quaternion,ROYGB:()=>u.ROYGB,RWB:()=>u.RWB,Ray:()=>y.Ray,Sinebow:()=>u.Sinebow,Sphere:()=>k.Sphere,SurfaceType:()=>R.SurfaceType,Triangle:()=>k.Triangle,Vector2:()=>y.Vector2,Vector3:()=>y.Vector3,VolumeData:()=>P.VolumeData,adjustVolumeStyle:()=>g.adjustVolumeStyle,applyPartialCharges:()=>b.applyPartialCharges,autoinit:()=>_.autoinit,autoload:()=>_.autoload,base64ToArray:()=>g.base64ToArray,bondLength:()=>p.bondLength,builtinColorSchemes:()=>v.builtinColorSchemes,builtinGradients:()=>u.builtinGradients,chains:()=>v.chains,clamp:()=>y.clamp,conversionMatrix3:()=>y.conversionMatrix3,createStereoViewer:()=>w.createStereoViewer,createViewer:()=>w.createViewer,createViewerGrid:()=>w.createViewerGrid,deepCopy:()=>g.deepCopy,degToRad:()=>y.degToRad,download:()=>g.download,drawCartoon:()=>s.drawCartoon,elementColors:()=>v.elementColors,extend:()=>g.extend,get:()=>g.get,getAtomProperty:()=>g.getAtomProperty,getColorFromStyle:()=>g.getColorFromStyle,getElement:()=>g.getElement,getExtent:()=>g.getExtent,getGradient:()=>u.getGradient,getPropertyRange:()=>g.getPropertyRange,getbin:()=>g.getbin,htmlColors:()=>v.htmlColors,inflateString:()=>g.inflateString,isEmptyObject:()=>g.isEmptyObject,isNumeric:()=>g.isNumeric,makeFunction:()=>g.makeFunction,mergeGeos:()=>g.mergeGeos,normalizeValue:()=>u.normalizeValue,partialCharges:()=>b.partialCharges,processing_autoinit:()=>_.processing_autoinit,residues:()=>v.residues,setBondLength:()=>p.setBondLength,setSyncSurface:()=>R.setSyncSurface,specStringToObject:()=>g.specStringToObject,splitMesh:()=>C.splitMesh,ssColors:()=>v.ssColors,subdivide_spline:()=>s.subdivide_spline,syncSurface:()=>R.syncSurface,viewers:()=>_.viewers});var u=r("./src/Gradient.ts"),v=r("./src/colors.ts"),x=r("./src/Label.ts"),b=r("./src/partialCharges.ts"),p=r("./src/parsers/index.ts"),y=r("./src/WebGL/math/index.ts"),k=r("./src/WebGL/shapes/index.ts"),g=r("./src/utilities.ts"),R=r("./src/ProteinSurface4.ts"),P=r("./src/VolumeData.ts"),T=r("./src/VolumetricRender.ts"),C=r("./src/GLShape.ts"),a=r("./src/GLDraw.ts"),s=r("./src/glcartoon.ts"),c=r("./src/GLModel.ts"),w=r("./src/GLViewer.ts"),_=r("./src/autoload.ts");r("./src/specs.ts"),window&&(window.$3Dmol=t)}),"./src/parsers/BCIF.ts":((n,t,r)=>{r.r(t),r.d(t,{BCIF:()=>C});var u=r("./src/utilities.ts"),v=r("./src/parsers/utils/computeSecondaryStructure.ts"),x=r("./src/parsers/utils/processSymmetries.ts"),b=r("./src/parsers/cifutils/category.ts"),p=r("./src/parsers/utils/assignPDBBonds.ts"),y=r("./src/WebGL/index.ts"),k=r("./src/parsers/utils/isEmpty.ts"),g=r("./src/vendor/mmtf.js");class R{constructor(s){if(this.C={},s){let c=s.getField("comp_id"),w=s.getField("atom_id_1"),_=s.getField("atom_id_2"),M=s.getField("value_order");for(let l=0;l<c.length;l++){let h=c[l],S=w[l],E=_[l],F=M[l],D=1;F=="doub"?D=2:F=="trip"&&(D=3),this.C[h]==null&&(this.C[h]={}),this.C[h][S]==null&&(this.C[h][S]={}),this.C[h][E]==null&&(this.C[h][E]={}),this.C[h][S][E]=D,this.C[h][E][S]=D}}}order(s,c,w){return this.C[s]!==void 0&&this.C[s][c]!==void 0&&this.C[s][c][w]!==void 0?this.C[s][c][w]:0}}class P{constructor(s){if(this.C=[],s){let c=s.getField("conn_type_id"),w=s.getField("ptnr1_label_asym_id"),_=s.getField("ptnr1_label_seq_id"),M=s.getField("ptnr1_label_comp_id"),l=s.getField("ptnr1_label_atom_id"),h=s.getField("ptnr2_label_asym_id"),S=s.getField("ptnr2_label_seq_id"),E=s.getField("ptnr2_label_comp_id"),F=s.getField("ptnr2_label_atom_id"),D=s.getField("pdbx_value_order");for(let L=0;L<c.length;L++)if(c[L]=="disulf"||c[L]=="covale"){let V=D?D[L]==""?1:parseInt(D[L]):1;this.C.push([[w[L],_[L],M[L],l[L]],[h[L],S[L],E[L],F[L]],V])}}}}class T{constructor(){this.R={}}add(s){this.R[s.lchain]==null&&(this.R[s.lchain]={}),this.R[s.lchain][s.lresi]==null&&(this.R[s.lchain][s.lresi]={}),this.R[s.lchain][s.lresi][s.lresn]==null&&(this.R[s.lchain][s.lresi][s.lresn]=[]),this.R[s.lchain][s.lresi][s.lresn].push(s),this.R[s.lchain][s.lresi][s.lresn][s.atom]=s}geta([s,c,w,_]){if(this.R[s]!==void 0&&this.R[s][c]!==void 0&&this.R[s][c][w]!==void 0)return this.R[s][c][w][_]}setBonds(s,c){for(let w in this.R)for(let _ in this.R[w])for(let M in this.R[w][_]){let l=this.R[w][_][M];for(let h=0;h<l.length;h++)for(let S=h+1;S<l.length;S++){let E=l[h],F=l[S],D=s.order(M,E.atom,F.atom);D>0&&(E.bonds.push(F.index),F.bonds.push(E.index),E.bondOrder.push(D),F.bondOrder.push(D))}}for(let w of c.C){let _=w[0],M=w[1],l=w[2],h=this.geta(_),S=this.geta(M);h!=null&&S!=null&&(h.bonds.push(S.index),S.bonds.push(h.index),h.bondOrder.push(l),S.bondOrder.push(l))}}}function C(a,s){var c=!s.keepH,w=s.altLoc?s.altLoc:"A",_=!s.noComputeSecondaryStructure;const M=!s.doAssembly,l=s.assignBonds===void 0?!0:s.assignBonds;if(typeof a=="string")try{a=(0,u.base64ToArray)(a)}catch{a=new TextEncoder().encode(a)}else a=new Uint8Array(a);var h=g.decodeMsgpack(a);h==31&&(a=(0,u.inflateString)(a,!1),h=g.decodeMsgpack(a));var S=[],E=S.modelData=[],F=h.dataBlocks.length;if(F==0)return S;s.multimodel||(F=1);for(let D=0;D<F;D++){let L=S.length;const V=[];E.push({symmetries:[]}),S.push([]);const O=h.dataBlocks[D],W=Object.create(null);for(const Ne of O.categories)W[Ne.name.substr(1)]=(0,b.Category)(Ne);let H={},q=W.struct_conf;if(q){let Ne=q.getField("conf_type_id"),Ue=q.getField("beg_label_asym_id"),ft=q.getField("beg_label_seq_id"),ut=q.getField("end_label_seq_id");for(let ee=0;ee<Ne.length;ee++)if(Ne[ee].startsWith("H")){let ie=Ue[ee],oe=ft[ee],we=ut[ee];ie in H||(H[ie]={}),H[ie][oe]="h1";for(let Se=oe+1;Se<we;Se++)H[ie][Se]="h";H[ie][we]="h2"}}let U=W.struct_sheet_range;if(U){let Ne=U.getField("id"),Ue=U.getField("beg_label_asym_id"),ft=U.getField("beg_label_seq_id"),ut=U.getField("end_label_seq_id");for(let ee=0;ee<Ne.length;ee++){let ie=Ue[ee],oe=ft[ee],we=ut[ee];ie in H||(H[ie]={}),H[ie][oe]="s1";for(let Se=oe+1;Se<we;Se++)H[ie][Se]="s";H[ie][we]="s2"}}let B=W.pdbx_struct_oper_list,Y=B.getField("id");if(Y&&!M){let Ne=B.getField("matrix[1][1]"),Ue=B.getField("matrix[1][2]"),ft=B.getField("matrix[1][3]"),ut=B.getField("matrix[2][1]"),ee=B.getField("matrix[2][2]"),ie=B.getField("matrix[2][3]"),oe=B.getField("matrix[3][1]"),we=B.getField("matrix[3][2]"),Se=B.getField("matrix[3][3]"),He=B.getField("vector[1]"),Be=B.getField("vector[2]"),K=B.getField("vector[3]");for(let xe=0;xe<Y.length;xe++){const Me=new y.Matrix4(Ne[xe],Ue[xe],ft[xe],He[xe],ut[xe],ee[xe],ie[xe],Be[xe],oe[xe],we[xe],Se[xe],K[xe]);E[E.length-1].symmetries.push(Me)}}let X=new R(W.chem_comp_bond),N=new T,J=new P(W.struct_conn),ae=W.atom_site,se=ae.rowCount,he=ae.getField("group_PDB"),pe=ae.getField("Cartn_x"),de=ae.getField("Cartn_y"),ue=ae.getField("Cartn_z"),ge=ae.getField("auth_asym_id"),Re=ae.getField("label_asym_id"),Ge=ae.getField("auth_seq_id"),We=ae.getField("label_seq_id"),Oe=ae.getField("auth_comp_id"),me=ae.getField("label_comp_id"),Fe=ae.getField("auth_atom_id"),qe=ae.getField("label_atom_id"),Qe=ae.getField("type_symbol"),st=ae.getField("B_iso_or_equiv"),ot=ae.getField("id"),Ke=ae.getField("label_alt_id"),Je=ae.getField("pdbx_PDB_model_num"),Xe=Je?Je[0]:0;for(let Ne=0;Ne<se;Ne++){if(he!==void 0&&he[Ne]==="TER")continue;if(Je&&Je[Ne]!=Xe)if(Xe=Je[Ne],s.multimodel)s.onemol||(S.push([]),E.push(E[E.length-1]),Xe=Je[Ne],N.setBonds(X,J),N=new T);else break;const Ue={};Ue.x=pe[Ne],Ue.y=de[Ne],Ue.z=ue[Ne],Ue.chain=ge?ge[Ne]:Re?Re[Ne]:void 0,Ue.lchain=Re?Re[Ne]:void 0,Ue.resi=Ge?Ge[Ne]:We?We[Ne]:void 0,Ue.lresi=We?We[Ne]:void 0,Ue.resn=Oe?Oe[Ne].trim():me?me[Ne].trim():void 0,Ue.lresn=me?me[Ne].trim():void 0,Ue.atom=Fe?Fe[Ne].replace(/"/gm,""):qe?qe[Ne].replace(/"/gm,""):void 0,Ue.icode=Ke?Ke[Ne]:void 0,Ue.altLoc=Ue.icode,Ue.hetflag=!he||he[Ne]==="HETA"||he[Ne]==="HETATM";let ft="X";Qe&&(ft=Qe[Ne].replace(/\(?\+?\d+.*/,"")),Ue.elem=ft[0].toUpperCase()+ft.substring(1,2).toLowerCase(),st&&(Ue.b=st[Ne]),!(c&&Ue.elem=="H")&&(Ue.altLoc!=""&&Ue.altLoc!=w&&w!="*"||(Ue.bonds=[],Ue.ss="c",Ue.serial=ot[Ne],Ue.model=Xe,Ue.bondOrder=[],Ue.properties={},Ue.index=S[S.length-1].length,V[Ue.serial]=[S.length,Ue.index],S[S.length-1].push(Ue),N.add(Ue)))}if(N.setBonds(X,J),!(0,k.isEmpty)(H))for(let Ne=L;Ne<S.length;Ne++){let Ue=S[Ne];for(let ft=0;ft<Ue.length;ft++){const ut=Ue[ft];if(ut!==void 0&&ut.lchain in H&&ut.lresi in H[ut.lchain]){const ee=H[ut.lchain][ut.lresi];ut.ss=ee[0],ee.length>1&&(ee[1]=="1"?ut.ssbegin=!0:ee[1]=="2"&&(ut.ssend=!0))}}}s.multimodel&&D<F-1&&(s.onemol||(S.push([]),E.push({symmetries:[]})))}for(let D=0;D<S.length;D++)l&&!(s.duplicateAssemblyAtoms&&!s.dontConnectDuplicatedAtoms)&&(0,p.assignPDBBonds)(S[D],s),_&&(0,v.computeSecondaryStructure)(S[D],s.hbondCutoff),(0,x.processSymmetries)(E[D].symmetries,S[D],s,E[D].cryst),s.duplicateAssemblyAtoms&&!s.dontConnectDuplicatedAtoms&&l&&(0,p.assignPDBBonds)(S[D],s);return S}}),"./src/parsers/CDJSON.ts":((n,t,r)=>{r.r(t),r.d(t,{CDJSON:()=>u});function u(v,x){var b=[[]];typeof v=="string"&&(v=JSON.parse(v));for(var p=v.m,y=p[0].a,k=p[0].b,g=p[0].s,R=x!==void 0&&x.parseStyle!==void 0?x.parseStyle:g!==void 0,P=b[b.length-1].length,T=0;T<y.length;T++){var C=y[T],a={};a.id=C.i,a.x=C.x,a.y=C.y,a.z=C.z||0,a.bonds=[],a.bondOrder=[];var s=C.l||"C";a.elem=s[0].toUpperCase()+s.substring(1).toLowerCase(),a.serial=b[b.length-1].length,R&&(a.style=g[C.s||0]),b[b.length-1].push(a)}for(let c=0;c<k.length;c++){let w=k[c],_=w.b+P,M=w.e+P,l=w.o||1,h=b[b.length-1][_],S=b[b.length-1][M];h.bonds.push(M),h.bondOrder.push(l),S.bonds.push(_),S.bondOrder.push(l)}return b}}),"./src/parsers/CIF.ts":((n,t,r)=>{r.r(t),r.d(t,{CIF:()=>y});var u=r("./src/parsers/utils/computeSecondaryStructure.ts"),v=r("./src/parsers/utils/processSymmetries.ts"),x=r("./src/WebGL/index.ts"),b=r("./src/parsers/utils/assignPDBBonds.ts");const p=function(k,g,R,P){return new x.Vector3(g,R,P).applyMatrix3(k)};function y(k,g={}){const R=[],P=!g.doAssembly,T=R.modelData=[],C=g.assignBonds===void 0?!0:g.assignBonds;function a(l,h){const S=[];let E=0,F=0;for(;F<l.length;){for(;l.substring(F,F+h.length)!==h&&F<l.length;)if(l[F]==="'"){for(F++;F<l.length&&l[F]!=="'";)F++;for(;l.substring(F,F+h.length)!==h&&F<l.length;)F++}else if(l[F]==='"'){for(F++;F<l.length&&l[F]!=='"';)F++;F++}else F++;S.push(l.substring(E,F)),E=F=F+h.length}return S}const s=k.split(/\r?\n|\r/),c=[];let w=!1;for(let l=0;l<s.length;l++){var _=s[l].split("#")[0];if(w?_[0]===";"&&(w=!1):_[0]===";"&&(w=!0),w||_!==""){if(!w&&(_=_.trim(),_[0]==="_")){const h=_.split(/\s/)[0].indexOf(".");if(h>-1){let S=_.split("");S[h]="_",_=S.join(""),_=_.substring(0,h)+"_"+_.substring(h+1)}}c.push(_)}}let M=0;for(;M<c.length;){for(;!c[M].startsWith("data_")||c[M]==="data_global";)M++;M++;const l={};for(;M<c.length&&!c[M].startsWith("data_");)if(c[M][0]===void 0)M++;else if(c[M][0]==="_"){const F=c[M].split(/\s/)[0].toLowerCase(),D=l[F]=l[F]||[],L=c[M].substring(c[M].indexOf(F)+F.length);if(L==="")if(M++,c[M][0]===";"){let V=c[M].substring(1);for(M++;c[M]!==";";)V=V+`
`+c[M],M++;D.push(V)}else D.push(c[M]);else D.push(L.trim());M++}else if(c[M].substring(0,5)==="loop_"){M++;const F=[];for(;c[M]===""||c[M][0]==="_";){if(c[M]!==""){let L=c[M].split(/\s/)[0].toLowerCase(),V=l[L]=l[L]||[];F.push(V)}M++}let D=0;for(;M<c.length&&c[M][0]!=="_"&&!c[M].startsWith("loop_")&&!c[M].startsWith("data_");){let L=a(c[M]," ");for(let V=0;V<L.length;V++)L[V]!==""&&(F[D].push(L[V]),D=(D+1)%F.length);M++}}else M++;T.push({symmetries:[]}),R.push([]);const h=l._atom_site_id!==void 0?l._atom_site_id.length:l._atom_site_label.length;let S;if(l._cell_length_a!==void 0){const F=parseFloat(l._cell_length_a),D=parseFloat(l._cell_length_b),L=parseFloat(l._cell_length_c),V=parseFloat(l._cell_angle_alpha)||90,O=parseFloat(l._cell_angle_beta)||90,W=parseFloat(l._cell_angle_gamma)||90;S=(0,x.conversionMatrix3)(F,D,L,V,O,W),T[T.length-1].cryst={a:F,b:D,c:L,alpha:V,beta:O,gamma:W}}for(let F=0;F<h;F++){if(l._atom_site_group_pdb!==void 0&&l._atom_site_group_pdb[F]==="TER")continue;const D={};if(l._atom_site_cartn_x!==void 0)D.x=parseFloat(l._atom_site_cartn_x[F]),D.y=parseFloat(l._atom_site_cartn_y[F]),D.z=parseFloat(l._atom_site_cartn_z[F]);else{const V=p(S,parseFloat(l._atom_site_fract_x[F]),parseFloat(l._atom_site_fract_y[F]),parseFloat(l._atom_site_fract_z[F]));D.x=V.x,D.y=V.y,D.z=V.z}D.chain=l._atom_site_auth_asym_id?l._atom_site_auth_asym_id[F]:l._atom_site_label_asym_id?l._atom_site_label_asym_id[F]:void 0,D.resi=l._atom_site_auth_seq_id?parseInt(l._atom_site_auth_seq_id[F]):l._atom_site_label_seq_id?l._atom_site_label_seq_id[F]:void 0,D.resn=l._atom_site_auth_comp_id?l._atom_site_auth_comp_id[F].trim():l._atom_site_label_comp_id?l._atom_site_label_comp_id[F].trim():void 0,D.atom=l._atom_site_auth_atom_id?l._atom_site_auth_atom_id[F].replace(/"/gm,""):l._atom_site_label_atom_id?l._atom_site_label_atom_id[F].replace(/"/gm,""):void 0,D.hetflag=!l._atom_site_group_pdb||l._atom_site_group_pdb[F]==="HETA"||l._atom_site_group_pdb[F]==="HETATM",l._atom_site_b_iso_or_equiv&&(D.b=parseFloat(l._atom_site_b_iso_or_equiv[F]));let L="X";l._atom_site_type_symbol?L=l._atom_site_type_symbol[F].replace(/\(?\+?\d+.*/,""):l._atom_site_label&&(L=l._atom_site_label[F].split("_")[0].replace(/\(?\d+.*/,"")),D.elem=L[0].toUpperCase()+L.substring(1,2).toLowerCase(),D.bonds=[],D.ss="c",D.serial=F,D.bondOrder=[],D.properties={},R[R.length-1].push(D)}if(l._pdbx_struct_oper_list_id!==void 0&&!P)for(let F=0;F<l._pdbx_struct_oper_list_id.length;F++){const D=parseFloat(l["_pdbx_struct_oper_list_matrix[1][1]"][F]),L=parseFloat(l["_pdbx_struct_oper_list_matrix[1][2]"][F]),V=parseFloat(l["_pdbx_struct_oper_list_matrix[1][3]"][F]),O=parseFloat(l["_pdbx_struct_oper_list_vector[1]"][F]),W=parseFloat(l["_pdbx_struct_oper_list_matrix[2][1]"][F]),H=parseFloat(l["_pdbx_struct_oper_list_matrix[2][2]"][F]),q=parseFloat(l["_pdbx_struct_oper_list_matrix[2][3]"][F]),U=parseFloat(l["_pdbx_struct_oper_list_vector[2]"][F]),B=parseFloat(l["_pdbx_struct_oper_list_matrix[3][1]"][F]),Y=parseFloat(l["_pdbx_struct_oper_list_matrix[3][2]"][F]),X=parseFloat(l["_pdbx_struct_oper_list_matrix[3][3]"][F]),N=parseFloat(l["_pdbx_struct_oper_list_vector[3]"][F]),J=new x.Matrix4(D,L,V,O,W,H,q,U,B,Y,X,N);T[T.length-1].symmetries.push(J)}const E=function(F){const D=F.match("-");F=F.replace(/[-xyz]/g,"");const L=F.split("/");let V,O;return L[1]===void 0?O=1:O=parseInt(L[1]),L[0]===""?V=1:V=parseInt(L[0]),V/O*(D?-1:1)};if(l._symmetry_equiv_pos_as_xyz!==void 0&&!P)for(let F=0;F<l._symmetry_equiv_pos_as_xyz.length;F++){const D=l._symmetry_equiv_pos_as_xyz[F].replace(/["' ]/g,"").split(",").map(function(W){return W.replace(/-/g,"+-")});let L=new x.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let W=0;W<3;W++){const H=D[W].split("+");for(let q=0;q<H.length;q++){const U=H[q];if(U==="")continue;const B=E(U);U.match("x")?L.elements[W+0]=B:U.match("y")?L.elements[W+4]=B:U.match("z")?L.elements[W+8]=B:L.elements[W+12]=B}}const V=S.getMatrix4(),O=new x.Matrix4().getInverse(V,!0);L=new x.Matrix4().multiplyMatrices(L,O),L=new x.Matrix4().multiplyMatrices(V,L),T[T.length-1].symmetries.push(L)}}for(let l=0;l<R.length;l++)C&&!(g.duplicateAssemblyAtoms&&!g.dontConnectDuplicatedAtoms)&&(0,b.assignPDBBonds)(R[l],g),(0,u.computeSecondaryStructure)(R[l],g.hbondCutoff),(0,v.processSymmetries)(T[l].symmetries,R[l],g,T[l].cryst),g.duplicateAssemblyAtoms&&!g.dontConnectDuplicatedAtoms&&C&&(0,b.assignPDBBonds)(R[l],g);return R}}),"./src/parsers/CUBE.ts":((n,t,r)=>{r.r(t),r.d(t,{CUBE:()=>b});var u=r("./src/WebGL/index.ts"),v=r("./src/parsers/utils/assignBonds.ts"),x=r("./src/parsers/utils/anumToSymbol.ts");function b(p,y){y=y||{};const k=[[]];let g=p.split(/\r?\n/);const R=y.assignBonds===void 0?!0:y.assignBonds;if(g.length<6)return k;let P=g[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const T=Math.abs(parseFloat(P[0]));let C={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const a=C.origin=new u.Vector3(parseFloat(P[1]),parseFloat(P[2]),parseFloat(P[3]));P=g[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),P=g[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const s=P[0]>0?.529177:1;a.multiplyScalar(s);const c=Math.abs(P[0]),w=new u.Vector3(parseFloat(P[1]),parseFloat(P[2]),parseFloat(P[3])).multiplyScalar(s);P=g[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const _=Math.abs(P[0]),M=new u.Vector3(parseFloat(P[1]),parseFloat(P[2]),parseFloat(P[3])).multiplyScalar(s);P=g[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const l=Math.abs(P[0]),h=new u.Vector3(parseFloat(P[1]),parseFloat(P[2]),parseFloat(P[3])).multiplyScalar(s);if(C.size={x:c,y:_,z:l},C.unit=new u.Vector3(w.x,M.y,h.z),w.y!=0||w.z!=0||M.x!=0||M.z!=0||h.x!=0||h.y!=0){C.matrix4=new u.Matrix4(w.x,M.x,h.x,0,w.y,M.y,h.y,0,w.z,M.z,h.z,0,0,0,0,1);let O=new u.Matrix4().makeTranslation(a.x,a.y,a.z);C.matrix4=C.matrix4.multiplyMatrices(O,C.matrix4),C.matrix=C.matrix4.matrix3FromTopLeft(),C.origin=new u.Vector3(0,0,0),C.unit=new u.Vector3(1,1,1)}k.modelData=[{cryst:C}],g=g.splice(6,T);for(var S=k[k.length-1].length,E=S+g.length,F=S;F<E;++F){var D={};D.serial=F;var L=g[F-S],V=L.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");D.elem=x.anumToSymbol[V[0]],D.x=parseFloat(V[2])*s,D.y=parseFloat(V[3])*s,D.z=parseFloat(V[4])*s,D.hetflag=!0,D.bonds=[],D.bondOrder=[],D.properties={},k[k.length-1].push(D)}if(R)for(let O=0;O<k.length;O++)(0,v.assignBonds)(k[O],y);return k}}),"./src/parsers/GRO.ts":((n,t,r)=>{r.r(t),r.d(t,{GRO:()=>x});var u=r("./src/parsers/utils/assignPDBBonds.ts"),v=r("./src/parsers/utils/atomNameToElem.ts");function x(b,p){const y=[],k=b.split(/\r?\n|\r/);for(;k.length>0;){const g=parseInt(k[1]);if(k.length<3||isNaN(g)||g<=0||k.length<g+3)break;const R=[];y.push(R);let P=2;const T=R.length,C=T+g;for(let a=T;a<C;a++){const s=k[P++],c={};c.serial=a,c.atom=s.slice(10,15).trim(),c.elem=(0,v.atomNameToElem)(c.atom,!0),c.x=10*parseFloat(s.slice(20,28)),c.y=10*parseFloat(s.slice(28,36)),c.z=10*parseFloat(s.slice(36,44)),c.resi=parseInt(s.slice(0,5)),c.resn=s.slice(5,10).trim(),c.bonds=[],c.bondOrder=[],c.properties={},s.length>44&&(c.dx=10*parseFloat(s.slice(44,52)),c.dy=10*parseFloat(s.slice(52,60)),c.dz=10*parseFloat(s.slice(60,68))),R[a]=c}if(k.length<=P+3){const a=k[P++].trim().split(/\s+/);if(a.length===3){for(let s=0;s<3;s++)a[s]=(parseFloat(a[s])*10).toString();y.box=a}}k.splice(0,++P)}for(let g=0;g<y.length;g++)(0,u.assignPDBBonds)(y[g],p);return y}}),"./src/parsers/LAMMPSTRJ.ts":((n,t,r)=>{r.r(t),r.d(t,{LAMMPSTRJ:()=>x});var u=r("./src/parsers/utils/assignBonds.ts");const v={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function x(b,p){const y=[],k=b.split(/\r?\n|\r/);let g=0,R=0,P=0;for(;P<k.length-9;){for(var T=P;T<k.length;T++)if(k[T].match(/ITEM: NUMBER OF ATOMS/)&&(R=parseInt(k[T+1])),k[T].match(/ITEM: ATOMS/)){g=T+1;break}const C=k[g-1].replace("ITEM: ATOMS ","").split(" ");y.push([]);for(let a=g;a<g+R;a++){const s={},c={},w=k[a].split(" ");for(let _=0;_<w.length;_++){const M=v[C[_]];M!==void 0&&(M==="serial"?s[M]=parseInt(w[_]):M==="x"||M==="y"||M==="z"?s[M]=parseFloat(w[_]):M==="charge"||M==="radius"?c[M]=parseFloat(w[_]):s[M]=w[_]),s.properties=c,s.bonds=[],s.bondOrder=[]}y[y.length-1][a-g]=s}P=g+R-1}if(p.assignBonds)for(let C=0;C<y.length;C++)(0,u.assignBonds)(y[C],p);return y}}),"./src/parsers/MMTF.ts":((n,t,r)=>{r.r(t),r.d(t,{MMTFparser:()=>R});var u=r("./src/utilities.ts"),v=r("./src/WebGL/index.ts"),x=r("./src/parsers/utils/computeSecondaryStructure.ts"),b=r("./src/parsers/utils/processSymmetries.ts"),p=r("./src/vendor/mmtf.js"),y=function(P){return String.fromCharCode.apply(null,P).replace(/\0/g,"")},k=function(P){return P==0||P==2||P==4?"h":P==3?"s":"c"};let g=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function R(P,T){var C=!T.keepH,a=T.altLoc?T.altLoc:"A",s=!!T.noSecondaryStructure,c=!T.noComputeSecondaryStructure,w=!T.doAssembly,_=T.assemblyIndex?T.assemblyIndex:0;typeof P=="string"?P=(0,u.base64ToArray)(P):P=new Uint8Array(P);var M=p.decode(P),l=[[]],h=l.modelData=[],S=0,E=0,F=0,D=M.secStructList,L=M.bFactorList,V=M.altLocList,O=M.occupancyList,W=M.bondAtomList,H=M.bondOrderList,q=M.numModels;if(q==0)return l;T.multimodel||(q=1);var U,B,Y,X,N,J,ae=[];if(!w&&M.bioAssemblyList&&M.bioAssemblyList.length>0){var se=M.bioAssemblyList[_].transformList;for(U=0,J=se.length;U<J;U++){var he=new v.Matrix4(se[U].matrix);he.transpose(),ae.push(he)}}var pe=null;if(M.unitCell){var de=M.unitCell;pe={a:de[0],b:de[1],c:de[2],alpha:de[3],beta:de[4],gamma:de[5]}}let ue=[];M.entityList.forEach(Ee=>{Ee.chainIndexList.forEach(re=>{ue[re]=Ee.type=="polymer"})});var ge=0;for(N=0;N<q;N++){var Re=M.chainsPerModel[N],Ge=l[l.length-1],We=[];for(h.push({symmetries:ae,cryst:pe}),U=0;U<Re;++U){var Oe=M.groupsPerChain[S],me=y(M.chainIdList.subarray(S*4,S*4+4));M.chainNameList&&(me=y(M.chainNameList.subarray(S*4,S*4+4)));var Fe=E,qe="";for(B=0;B<Oe;++B){var Qe=M.groupList[M.groupTypeList[E]],st=Qe.atomNameList.length,ot=0,Ke=!1,Je=!1;if(D){ot=D[E];var Xe=k(ot);(E==0||Xe!=qe)&&(Ke=!0),qe=Xe;var Ne=E+1;(Ne>=D.length||k(D[Ne]!=Xe))&&(Je=!0)}var Ue=M.groupIdList[E],ft=Qe.groupName;let Ee=Qe.chemCompType;var ut=F;let re=g.has(Ee)||!ue[S];for(Y=0;Y<st;++Y){var ee=Qe.elementList[Y];if(C&&ee=="H"){F+=1;continue}var ie="";L&&(ie=L[F]);var oe="";V&&V[F]&&(oe=String.fromCharCode(V[F]));var we="";if(O&&(we=O[F]),oe!=""&&oe!=a&&a!="*"){F+=1;continue}var Se=M.atomIdList[F],He=Qe.atomNameList[Y],Be=0;Qe.atomChargeList&&(Be=Qe.atomChargeList[Y]);var K=M.xCoordList[F],xe=M.yCoordList[F],Me=M.zCoordList[F];We[F]=Ge.length,Ge.push({resn:ft,x:K,y:xe,z:Me,elem:ee,hetflag:re,chain:me,resi:Ue,icode:oe,rescode:Ue+(oe!=" "?"^"+oe:""),serial:Se,altLoc:oe,index:F,atom:He,bonds:[],ss:k(ot),ssbegin:Ke,ssend:Je,bondOrder:[],properties:{charge:Be,occupancy:we},b:ie}),F+=1}var $e=Qe.bondAtomList;for(Y=0,X=Qe.bondOrderList.length;Y<X;++Y){var ye=ut+$e[Y*2],je=ut+$e[Y*2+1],Z=Qe.bondOrderList[Y],De=We[ye],rt=We[je],G=Ge[De],Te=Ge[rt];G&&Te&&(G.bonds.push(rt),G.bondOrder.push(Z),Te.bonds.push(De),Te.bondOrder.push(Z))}E+=1}for(E=Fe,B=0;B<Oe;++B)E+=1;S+=1}if(W)for(let Ee=ge,re=W.length;Ee<re;Ee+=2){let ve=W[Ee],ke=W[Ee+1],ct=H?H[Ee/2]:1;if(ve>=F){ge=Ee;break}let lt=We[ve],dt=We[ke],yt=Ge[lt],ir=Ge[dt];yt&&ir&&(yt.bonds.push(dt),yt.bondOrder.push(ct),ir.bonds.push(lt),ir.bondOrder.push(ct))}T.multimodel&&(T.onemol||l.push([]))}if(!w)for(let Ee=0;Ee<l.length;Ee++)(0,b.processSymmetries)(h[Ee].symmetries,l[Ee],T,h[Ee].cryst);return c&&!s&&(0,x.computeSecondaryStructure)(l,T.hbondCutoff),l}}),"./src/parsers/MOL2.ts":((n,t,r)=>{r.r(t),r.d(t,{MOL2:()=>v});let u={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function v(x,b){var p=[[]],y=!1;typeof b.keepH<"u"&&(y=!b.keepH);var k=x.search(/@<TRIPOS>MOLECULE/),g=x.search(/@<TRIPOS>ATOM/);if(k==-1||g==-1)return p;for(var R=x.substring(k).split(/\r?\n|\r/);R.length>0;){var P=[],T=R[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),C=parseInt(T[0]),a=0;T.length>1&&(a=parseInt(T[1]));var s=4,c;for(c=3;c<R.length;c++)if(R[c]=="@<TRIPOS>ATOM"){s=c+1;break}var w=p[p.length-1].length,_=w+C,M;for(c=w;c<_;c++){M=R[s++],T=M.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var l={},h=T[5];if(u[h]!==void 0?h=u[h]:(h=h.split(".")[0],h=h[0].toUpperCase()+h.substring(1).toLowerCase()),l.atom=T[1],l.elem=h,!(l.elem=="H"&&y)){var S=p[p.length-1].length,E=parseInt(T[0]);l.serial=E,l.x=parseFloat(T[2]),l.y=parseFloat(T[3]),l.z=parseFloat(T[4]),l.atom=T[5];var F=parseFloat(T[8]);l.index=S,l.bonds=[],l.bondOrder=[],l.properties={charge:F,partialCharge:F},P[E]=S,p[p.length-1].push(l)}}for(var D=!1;s<R.length;)if(R[s++]=="@<TRIPOS>BOND"){D=!0;break}if(D&&a)for(c=0;c<a;c++){M=R[s++],T=M.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var L=parseInt(T[1]),V=p[p.length-1][P[L]],O=parseInt(T[2]),W=p[p.length-1][P[O]],H=parseInt(T[3]);isNaN(H)&&(H=1),V!==void 0&&W!==void 0&&(V.bonds.push(P[O]),V.bondOrder.push(H),W.bonds.push(P[L]),W.bondOrder.push(H))}if(b.multimodel){b.onemol||p.push([]),R.splice(0,s),x=R.join(`
`);continue}else break}return p}}),"./src/parsers/PDB.ts":((n,t,r)=>{r.r(t),r.d(t,{PDB:()=>v});var u=r("./src/parsers/utils/getSinglePDB.ts");function v(x,b){b=b||{};var p=[],y={};p.modelData=[];for(var k=x.split(/\r?\n|\r/);k.length>0;){var g=(0,u.getSinglePDB)(k,b,y),R=g[0],P=g[1];if(k=g[2],R.length!=0){if(b.multimodel&&b.onemol&&p.length>0)for(var T=p[0].length,C=0;C<R.length;C++){var a=R[C];a.index=C;for(var s=0;s<a.bonds.length;s++)a.bonds[s]+=T;p[0].push(a)}else p.modelData.push(P),p.push(R);if(!b.multimodel)break}}return p}}),"./src/parsers/PQR.ts":((n,t,r)=>{r.r(t),r.d(t,{PQR:()=>x});var u=r("./src/parsers/utils/assignPDBBonds.ts"),v=r("./src/parsers/utils/computeSecondaryStructure.ts");function x(b,p){var y=[[]],k=!p.noSecondaryStructure;y.modelData=[{symmetries:[]}];var g=[],R=b.split(/\r?\n|\r/),P;for(let D=0;D<R.length;D++){P=R[D].replace(/^\s*/,"");var T=P.substring(0,6);if(T.indexOf("END")==0)if(p.multimodel){p.onemol||y.push([]);continue}else break;else if(T=="ATOM  "||T=="HETATM"){var C;let L=parseInt(P.substring(6,11)),V=P.substring(12,16).replace(/ /g,""),O=P.substring(17,20).trim(),W=P.substring(21,22),H=parseInt(P.substring(22,26));var a=P.substring(30).trim().split(/\s+/),s=parseFloat(a[0]),c=parseFloat(a[1]),w=parseFloat(a[2]),_=parseFloat(a[3]),M=parseFloat(a[4]),l=V[0];V.length>1&&V[1].toUpperCase()!=V[1]&&(l=V.substring(0,2)),P[0]=="H"?C=!0:C=!1,g[L]=y[y.length-1].length,y[y.length-1].push({resn:O,x:s,y:c,z:w,elem:l,hetflag:C,chain:W,resi:H,serial:L,atom:V,bonds:[],ss:"c",bondOrder:[],properties:{charge:_,partialCharge:_,radius:M},pdbline:P})}else if(T=="CONECT"){var h=parseInt(P.substring(6,11)),S=y[y.length-1][g[h]];for(let L=0;L<4;L++){var E=parseInt(P.substring([11,16,21,26][L],[11,16,21,26][L]+5)),F=y[y.length-1][g[E]];S!==void 0&&F!==void 0&&(S.bonds.push(g[E]),S.bondOrder.push(1))}}}for(let D=0;D<y.length;D++)(0,u.assignPDBBonds)(y[D],p),k&&(0,v.computeSecondaryStructure)(y[D],p.hbondCutoff);return y}}),"./src/parsers/PRMTOP.ts":((n,t,r)=>{r.r(t),r.d(t,{PRMTOP:()=>u});function u(v){var x=[],b,p=0,y=v.split(/\r?\n|\r/);if(y.length>0&&y[0].includes("VERSION")){var k=y.filter(function(s){return s.includes("POINTERS")||s.includes("ATOM_NAME")||s.includes("CHARGE")||s.includes("RADII")||s.includes("BONDS_INC_HYDROGEN")||s.includes("BONDS_WITHOUT_HYDROGEN")}),g=C("POINTERS");if(g==-1)return[];var R=a(g),P=parseInt(y[g+1].slice(0,R[1]));if(isNaN(P)||P<=0)return[];if(g=C("ATOM_NAME"),g==-1)return[];R=a(g);var T=R[0];for(let s=0;s<P/R[0];s++){s==parseInt(P/R[0])&&(T=P%R[0]);for(let c=0;c<T;c++){let w={},_={charge:"",radii:""};w.serial=p,w.x=0,w.y=0,w.z=0,w.atom=y[g+1].slice(R[1]*c,R[1]*(c+1)).trim(),w.elem=y[g+1].slice(R[1]*c,R[1]*c+1).trim(),w.properties=_,w.bonds=[],w.bondOrder=[],x.push(w),p++}g++}if(g=C("CHARGE"),g!=-1){R=a(g),p=0,T=R[0];for(let s=0;s<P/R[0];s++){s==parseInt(P/R[0])&&(T=P%R[0]);for(let c=0;c<T;c++)x[p].properties.charge=parseFloat(y[g+1].slice(R[1]*c,R[1]*(c+1))),p++;g++}}if(g=C("RADII"),g!=-1){R=a(g),p=0,T=R[0];for(let s=0;s<P/R[0];s++){s==parseInt(P/R[0])&&(T=P%R[0]);for(let c=0;c<T;c++)x[p].properties.radii=parseFloat(y[g+1].slice(R[1]*c,R[1]*(c+1))),p++;g++}}if(g=C("BONDS_WITHOUT_HYDROGEN"),g!=-1)for(R=a(g),p=0,T=R[0],g=g+1;!y[g].match(/^%FLAG/);){y[g+1].match(/^%FLAG/)&&(T=P%R[0]);for(let s=0;s<T;s++)p%3==0?b=parseInt(y[g].slice(R[1]*s,R[1]*(s+1))/3):p%3==1&&x[b].bonds.push(parseInt(y[g].slice(R[1]*s,R[1]*(s+1))/3)),p++;g++}if(g=C("BONDS_INC_HYDROGEN"),g!=-1)for(R=a(g),p=0,T=R[0],g=g+1;!y[g].match(/^%FLAG/);){y[g+1].match(/^%FLAG/)&&(T=P%R[0]);for(let s=0;s<T;s++)p%3==0?b=parseInt(y[g].slice(R[1]*s,R[1]*(s+1))/3):p%3==1&&x[b].bonds.push(parseInt(y[g].slice(R[1]*s,R[1]*(s+1))/3)),p++;g++}}else return[];function C(s){var c=y.indexOf(k.filter(function(w){return w.includes(s)})[0]);if(Number.isInteger(c)&&c>0){for(;!y[c].includes("FORMAT");)c++;return c}else return-1}function a(s){var c=y[s].match(/\((\d*)\S*/),w=y[s].match(/[a-zA-Z](\d*)\)\s*/);return w==null&&(w=y[s].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[c[1],w[1]]}return[x]}}),"./src/parsers/SDF.ts":((n,t,r)=>{r.r(t),r.d(t,{SDF:()=>x});var u=function(b,p){var y=[[]],k=!1;for(typeof p.keepH<"u"&&(k=!p.keepH);b.length>0&&!(b.length<4);){var g=parseInt(b[3].substring(0,3));if(isNaN(g)||g<=0)break;var R=parseInt(b[3].substring(3,6)),P=4;if(b.length<4+g+R)break;var T=[],C=y[y.length-1].length,a=C+g,s,c;for(s=C;s<a;s++,P++){c=b[P];var w={},_=c.substring(31,34).replace(/ /g,"");w.atom=w.elem=_[0].toUpperCase()+_.substring(1).toLowerCase(),(w.elem!=="H"||!k)&&(w.serial=s,T[s]=y[y.length-1].length,w.x=parseFloat(c.substring(0,10)),w.y=parseFloat(c.substring(10,20)),w.z=parseFloat(c.substring(20,30)),w.hetflag=!0,w.bonds=[],w.bondOrder=[],w.properties={},w.index=y[y.length-1].length,y[y.length-1].push(w))}for(s=0;s<R;s++,P++){c=b[P];var M=T[parseInt(c.substring(0,3))-1+C],l=T[parseInt(c.substring(3,6))-1+C],h=parseFloat(c.substring(6));typeof M<"u"&&typeof l<"u"&&(y[y.length-1][M].bonds.push(l),y[y.length-1][M].bondOrder.push(h),y[y.length-1][l].bonds.push(M),y[y.length-1][l].bondOrder.push(h))}if(p.multimodel){for(p.onemol||y.push([]);b[P]!=="$$$$"&&P<b.length;)P++;b.splice(0,++P)}else break}return y},v=function(b,p){var y=[[]],k=!1;for(typeof p.keepH<"u"&&(k=!p.keepH);b.length>0&&!(b.length<8||!b[4].startsWith("M  V30 BEGIN CTAB")||!b[5].startsWith("M  V30 COUNTS")||b[5].length<14);){var g=b[5].substring(13).match(/\S+/g);if(g.length<2)break;var R=parseInt(g[0]);if(isNaN(R)||R<=0)break;var P=parseInt(g[1]),T=7;if(b.length<8+R+P)break;var C=[],a=y[y.length-1].length,s=a+R,c,w;for(c=a;c<s;c++,T++){w=b[T];var _=w.substring(6).match(/\S+/g);if(_.length>4){var M={},l=_[1].replace(/ /g,"");M.atom=M.elem=l[0].toUpperCase()+l.substring(1).toLowerCase(),(M.elem!=="H"||!k)&&(M.serial=c,C[c]=y[y.length-1].length,M.x=parseFloat(_[2]),M.y=parseFloat(_[3]),M.z=parseFloat(_[4]),M.hetflag=!0,M.bonds=[],M.bondOrder=[],M.properties={},M.index=y[y.length-1].length,y[y.length-1].push(M))}}if(b[T]==="M  V30 END ATOM")T++;else break;if(P!==0&&b[T]==="M  V30 BEGIN BOND")T++;else break;for(c=0;c<P;c++,T++){w=b[T];var h=w.substring(6).match(/\S+/g);if(h.length>3){var S=C[parseInt(h[2])-1+a],E=C[parseInt(h[3])-1+a],F=parseFloat(h[1]);typeof S<"u"&&typeof E<"u"&&(y[y.length-1][S].bonds.push(E),y[y.length-1][S].bondOrder.push(F),y[y.length-1][E].bonds.push(S),y[y.length-1][E].bondOrder.push(F))}}if(p.multimodel){for(p.onemol||y.push([]);b[T]!=="$$$$"&&T<b.length;)T++;b.splice(0,++T)}else break}return y};function x(b,p){var y="V2000",k=b.split(/\r?\n|\r/);return k.length>3&&k[3].length>38&&(y=k[3].substring(34,39)),y==="V2000"?u(k,p):y==="V3000"?v(k,p):[[""]]}}),"./src/parsers/VASP.ts":((n,t,r)=>{r.r(t),r.d(t,{VASP:()=>x});var u=r("./src/WebGL/index.ts"),v=r("./src/parsers/utils/assignBonds.ts");function x(b,p={}){var y=[[]],k={};const g=p.assignBonds===void 0?!0:p.assignBonds;var R=b.replace(/^\s+/,"").split(/\r?\n/);if(R.length<3)return y;if(R[1].match(/\d+/))k.length=parseFloat(R[1]);else return console.log("Warning: second line of the vasp structure file must be a number"),y;if(k.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),y;k.xVec=new Float32Array(R[2].replace(/^\s+/,"").split(/\s+/)),k.yVec=new Float32Array(R[3].replace(/^\s+/,"").split(/\s+/)),k.zVec=new Float32Array(R[4].replace(/^\s+/,"").split(/\s+/));var P=new u.Matrix3(k.xVec[0],k.xVec[1],k.xVec[2],k.yVec[0],k.yVec[1],k.yVec[2],k.zVec[0],k.zVec[1],k.zVec[2]);P.multiplyScalar(k.length),y.modelData=[{symmetries:[],cryst:{matrix:P}}];var T=R[5].replace(/\s+/,"").replace(/\s+$/,"").split(/\s+/),C=new Int16Array(R[6].replace(/^\s+/,"").split(/\s+/)),a=R[7].replace(/\s+/,""),s=!1;if(a.match(/S/)&&(s=!0,a=R[8].replace(/\s+/,"")),a.match(/C/))a="cartesian";else if(a.match(/D/))a="direct";else return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),y;if(T.length!=C.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(T),console.log(C),y;s?R.splice(0,9):R.splice(0,8);for(var c=0,w=0,_=T.length;w<_;w++){for(var M=T[w],l=0,h=C[w];l<h;l++){var S=new Float32Array(R[c+l].replace(/^\s+/,"").split(/\s+/)),E={};E.elem=M,a=="cartesian"?(E.x=k.length*S[0],E.y=k.length*S[1],E.z=k.length*S[2]):(E.x=k.length*(S[0]*k.xVec[0]+S[1]*k.yVec[0]+S[2]*k.zVec[0]),E.y=k.length*(S[0]*k.xVec[1]+S[1]*k.yVec[1]+S[2]*k.zVec[1]),E.z=k.length*(S[0]*k.xVec[2]+S[1]*k.yVec[2]+S[2]*k.zVec[2])),E.bonds=[],E.bondOrder=[],y[0].push(E)}c+=C[w]}if(g)for(let F=0;F<y.length;F++)(0,v.assignBonds)(y[F],p);return y}}),"./src/parsers/XYZ.ts":((n,t,r)=>{r.r(t),r.d(t,{XYZ:()=>x});var u=r("./src/WebGL/index.ts"),v=r("./src/parsers/utils/assignBonds.ts");function x(b,p){p=p||{};for(var y=[[]],k=p.assignBonds===void 0?!0:p.assignBonds,g=b.split(/\r?\n|\r/);g.length>0&&!(g.length<3);){var R=parseInt(g[0]);if(isNaN(R)||R<=0||g.length<R+2)break;var P=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi,T=P.exec(g[1]);if(T!=null&&T.length>1){var C=new Float32Array(T[1].split(/\s+/)),a=new u.Matrix3(C[0],C[3],C[6],C[1],C[4],C[7],C[2],C[5],C[8]);y.modelData=[{cryst:{matrix:a}}]}for(var s=2,c=y[y.length-1].length,w=c+R,_=c;_<w;_++){var M=g[s++],l=M.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),h={};h.serial=_;var S=l[0];h.atom=h.elem=S[0].toUpperCase()+S.substring(1,2).toLowerCase(),h.x=parseFloat(l[1]),h.y=parseFloat(l[2]),h.z=parseFloat(l[3]),h.hetflag=!0,h.bonds=[],h.bondOrder=[],h.properties={},y[y.length-1][_]=h,l.length>=7&&(h.dx=parseFloat(l[4]),h.dy=parseFloat(l[5]),h.dz=parseFloat(l[6]))}if(p.multimodel)y.push([]),g.splice(0,s);else break}if(k)for(let F=0;F<y.length;F++)(0,v.assignBonds)(y[F],p);if(p.onemol){var E=y;y=[],y.push(E[0]);for(let F=1;F<E.length;F++){let D=y[0].length;for(let L=0;L<E[F].length;L++){let V=E[F][L];for(let O=0;O<V.bonds.length;O++)V.bonds[O]=V.bonds[O]+D;V.index=y[0].length,V.serial=y[0].length,y[0].push(V)}}}return y}}),"./src/parsers/cifutils/category.ts":((n,t,r)=>{r.r(t),r.d(t,{Category:()=>v});var u=r("./src/parsers/cifutils/decoder.ts");function v(x){const b=Object.create(null),p=Object.create(null);for(const y of x.columns)b[y.name]=y;return{rowCount:x.rowCount,name:x.name.substring(1),fieldNames:x.columns.map(y=>y.name),getField(y){const k=b[y];if(k)return p[y]||(p[y]=(0,u.decode)(k.data)),p[y]}}}}),"./src/parsers/cifutils/decoder.ts":((n,t,r)=>{r.r(t),r.d(t,{decode:()=>b});var u=r("./src/parsers/cifutils/encoding.ts");const v=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function x(D,L){const V=new ArrayBuffer(D.length),O=new Uint8Array(V);for(let W=0,H=D.length;W<H;W+=L)for(let q=0;q<L;q++)O[W+L-q-1]=D[W+q];return V}function b(D){let L=D.data;for(let V=D.encoding.length-1;V>=0;V--)L=p(L,D.encoding[V]);return L}function p(D,L){switch(L.kind){case"ByteArray":switch(L.type){case u.Encoding.IntDataType.Uint8:return D;case u.Encoding.IntDataType.Int8:return g(D);case u.Encoding.IntDataType.Int16:return P(D);case u.Encoding.IntDataType.Uint16:return T(D);case u.Encoding.IntDataType.Int32:return C(D);case u.Encoding.IntDataType.Uint32:return a(D);case u.Encoding.FloatDataType.Float32:return s(D);case u.Encoding.FloatDataType.Float64:return c(D);default:throw new Error("unreachable")}case"FixedPoint":return w(D,L);case"IntervalQuantization":return _(D,L);case"RunLength":return M(D,L);case"Delta":return l(D,L);case"IntegerPacking":return E(D,L);case"StringArray":return F(D,L)}}function y(D,L){switch(D){case u.Encoding.IntDataType.Int8:return new Int8Array(L);case u.Encoding.IntDataType.Int16:return new Int16Array(L);case u.Encoding.IntDataType.Int32:return new Int32Array(L);case u.Encoding.IntDataType.Uint8:return new Uint8Array(L);case u.Encoding.IntDataType.Uint16:return new Uint16Array(L);case u.Encoding.IntDataType.Uint32:return new Uint32Array(L);default:return new Int32Array(L)}}function k(D,L){switch(D){case u.Encoding.FloatDataType.Float32:return new Float32Array(L);case u.Encoding.FloatDataType.Float64:return new Float64Array(L);default:return new Float64Array(L)}}function g(D){return new Int8Array(D.buffer,D.byteOffset)}function R(D,L,V){return(D.byteOffset!=0||D.byteLength!=D.buffer.byteLength)&&(D=new Uint8Array(D)),v?new V(D.buffer):new V(x(D,L))}function P(D){return R(D,2,Int16Array)}function T(D){return R(D,2,Uint16Array)}function C(D){return R(D,4,Int32Array)}function a(D){return R(D,4,Uint32Array)}function s(D){return R(D,4,Float32Array)}function c(D){return R(D,8,Float64Array)}function w(D,L){const V=D.length,O=k(L.srcType,V),W=1/L.factor;for(let H=0;H<V;H++)O[H]=W*D[H];return O}function _(D,L){const V=D.length,O=k(L.srcType,V),W=(L.max-L.min)/(L.numSteps-1),H=L.min;for(let q=0;q<V;q++)O[q]=H+W*D[q];return O}function M(D,L){const V=y(L.srcType,L.srcSize);let O=0;for(let W=0,H=D.length;W<H;W+=2){const q=D[W],U=D[W+1];for(let B=0;B<U;++B)V[O++]=q}return V}function l(D,L){const V=D.length,O=y(L.srcType,V);if(!V)return D;O[0]=D[0]+(L.origin|0);for(let W=1;W<V;++W)O[W]=D[W]+O[W-1];return O}function h(D,L){const V=L.byteCount===1?127:32767,O=-V-1,W=D.length,H=new Int32Array(L.srcSize);let q=0,U=0;for(;q<W;){let B=0,Y=D[q];for(;Y===V||Y===O;)B+=Y,q++,Y=D[q];B+=Y,H[U]=B,q++,U++}return H}function S(D,L){const V=L.byteCount===1?255:65535,O=D.length,W=new Int32Array(L.srcSize);let H=0,q=0;for(;H<O;){let U=0,B=D[H];for(;B===V;)U+=B,H++,B=D[H];U+=B,W[q]=U,H++,q++}return W}function E(D,L){return D.length===L.srcSize?D:L.isUnsigned?S(D,L):h(D,L)}function F(D,L){const V=b({encoding:L.offsetEncoding,data:L.offsets}),O=b({encoding:L.dataEncoding,data:D}),W=L.stringData,H=new Array(V.length);H[0]="";for(let B=1,Y=V.length;B<Y;B++)H[B]=W.substring(V[B-1],V[B]);let q=0;const U=new Array(O.length);for(let B=0,Y=O.length;B<Y;B++)U[q++]=H[O[B]+1];return U}}),"./src/parsers/cifutils/encoding.ts":((n,t,r)=>{r.r(t),r.d(t,{Encoding:()=>v,VERSION:()=>u});const u="0.3.0";var v;(function(x){(function(y){y[y.Int8=1]="Int8",y[y.Int16=2]="Int16",y[y.Int32=3]="Int32",y[y.Uint8=4]="Uint8",y[y.Uint16=5]="Uint16",y[y.Uint32=6]="Uint32"})(x.IntDataType||(x.IntDataType={})),(function(y){y[y.Float32=32]="Float32",y[y.Float64=33]="Float64"})(x.FloatDataType||(x.FloatDataType={}));function b(y){let k;return y instanceof Int8Array?k=x.IntDataType.Int8:y instanceof Int16Array?k=x.IntDataType.Int16:y instanceof Int32Array?k=x.IntDataType.Int32:y instanceof Uint8Array?k=x.IntDataType.Uint8:y instanceof Uint16Array?k=x.IntDataType.Uint16:y instanceof Uint32Array?k=x.IntDataType.Uint32:y instanceof Float32Array?k=x.FloatDataType.Float32:y instanceof Float64Array?k=x.FloatDataType.Float64:k=x.IntDataType.Int32,k}x.getDataType=b;function p(y){if(y instanceof Int8Array||y instanceof Int16Array||y instanceof Int32Array)return!0;for(let k=0,g=y.length;k<g;k++)if(k<0)return!1;return!0}x.isSignedIntegerDataType=p})(v||(v={}))}),"./src/parsers/index.ts":((n,t,r)=>{r.r(t),r.d(t,{Parsers:()=>w,bondLength:()=>c.bondLength,setBondLength:()=>c.setBondLength});var u=r("./src/parsers/VASP.ts"),v=r("./src/parsers/CUBE.ts"),x=r("./src/parsers/XYZ.ts"),b=r("./src/parsers/SDF.ts"),p=r("./src/parsers/CDJSON.ts"),y=r("./src/parsers/CIF.ts"),k=r("./src/parsers/MOL2.ts"),g=r("./src/parsers/PDB.ts"),R=r("./src/parsers/PQR.ts"),P=r("./src/parsers/MMTF.ts"),T=r("./src/parsers/PRMTOP.ts"),C=r("./src/parsers/GRO.ts"),a=r("./src/parsers/LAMMPSTRJ.ts"),s=r("./src/parsers/BCIF.ts"),c=r("./src/parsers/utils/bondLength.ts");const w={vasp:u.VASP,VASP:u.VASP,cube:v.CUBE,CUBE:v.CUBE,xyz:x.XYZ,XYZ:x.XYZ,sdf:b.SDF,SDF:b.SDF,json:p.CDJSON,cdjson:p.CDJSON,CDJSON:p.CDJSON,mcif:y.CIF,cif:y.CIF,CIF:y.CIF,mol2:k.MOL2,MOL2:k.MOL2,pdb:g.PDB,PDB:g.PDB,pdbqt:g.PDB,PDBQT:g.PDB,pqr:R.PQR,PQR:R.PQR,mmtf:P.MMTFparser,MMTF:P.MMTFparser,prmtop:T.PRMTOP,PRMTOP:T.PRMTOP,gro:C.GRO,GRO:C.GRO,lammpstrj:a.LAMMPSTRJ,LAMMPSTRJ:a.LAMMPSTRJ,bcif:s.BCIF,BCIF:s.BCIF}}),"./src/parsers/utils/anumToSymbol.ts":((n,t,r)=>{r.r(t),r.d(t,{anumToSymbol:()=>u});const u={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"}}),"./src/parsers/utils/areConnected.ts":((n,t,r)=>{r.r(t),r.d(t,{areConnected:()=>x});var u=r("./src/parsers/utils/bondLength.ts");const v=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function x(b,p,y){if(y&&y.unboundCations&&(v.has(b.elem)||v.has(p.elem)))return!1;let k=(0,u.bondLength)(b.elem)+(0,u.bondLength)(p.elem);k+=.25,k*=k;let g=b.x-p.x;if(g*=g,g>k)return!1;let R=b.y-p.y;if(R*=R,R>k)return!1;let P=b.z-p.z;if(P*=P,P>k)return!1;const T=g+R+P;return!(isNaN(T)||T<.5||T>k||b.altLoc!==p.altLoc&&b.altLoc.trim()!==""&&p.altLoc.trim()!=="")}}),"./src/parsers/utils/assignBackboneHBonds.ts":((n,t,r)=>{r.r(t),r.d(t,{assignBackboneHBonds:()=>u});function u(v,x){const b=x||3.2,p=b*b,y=[];for(let k=0,g=v.length;k<g;k++){v[k].index=k;const R=v[k];!R.hetflag&&(R.atom==="N"||R.atom==="O")&&(y.push(R),R.hbondOther=null,R.hbondDistanceSq=Number.POSITIVE_INFINITY)}y.sort(function(k,g){return k.z-g.z});for(let k=0,g=y.length;k<g;k++){const R=y[k];for(let P=k+1;P<g;P++){const T=y[P],C=T.z-R.z;if(C>b)break;if(T.atom==R.atom)continue;const a=Math.abs(T.y-R.y);if(a>b)continue;const s=Math.abs(T.x-R.x);if(s>b)continue;const c=s*s+a*a+C*C;c>p||T.chain==R.chain&&Math.abs(T.resi-R.resi)<4||(c<R.hbondDistanceSq&&(R.hbondOther=T,R.hbondDistanceSq=c),c<T.hbondDistanceSq&&(T.hbondOther=R,T.hbondDistanceSq=c))}}}}),"./src/parsers/utils/assignBonds.ts":((n,t,r)=>{r.r(t),r.d(t,{assignBonds:()=>b});var u=r("./src/parsers/utils/areConnected.ts");const v=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],x=4.95;function b(p,y){for(let R=0,P=p.length;R<P;R++)p[R].index||(p[R].index=R);const k={x:{y:{z:[]}}};for(let R=0;R<p.length;R++){const P=p[R],T=Math.floor(P.x/x),C=Math.floor(P.y/x),a=Math.floor(P.z/x);k[T]||(k[T]={}),k[T][C]||(k[T][C]={}),k[T][C][a]||(k[T][C][a]=[]),k[T][C][a].push(P)}function g(R,P){for(let T=0;T<R.length;T++){const C=R[T];for(let a=0;a<P.length;a++){const s=P[a];if((0,u.areConnected)(C,s,y)){const c=C.bonds.indexOf(s.index),w=s.bonds.indexOf(C.index);c===-1&&w===-1?(C.bonds.push(s.index),C.bondOrder.push(1),s.bonds.push(C.index),s.bondOrder.push(1)):c===-1?(C.bonds.push(s.index),C.bondOrder.push(s.bondOrder[w])):w===-1&&(s.bonds.push(C.index),s.bondOrder.push(C.bondOrder[c]))}}}}for(let R in k){const P=parseInt(R);for(let T in k[P]){const C=parseInt(T);for(let a in k[P][C]){const s=parseInt(a),c=k[P][C][s];for(let w=0;w<c.length;w++){const _=c[w];for(let M=w+1;M<c.length;M++){const l=c[M];(0,u.areConnected)(_,l,y)&&_.bonds.indexOf(l.index)==-1&&(_.bonds.push(l.index),_.bondOrder.push(1),l.bonds.push(_.index),l.bondOrder.push(1))}}for(let w=0;w<v.length;w++){const _=v[w];if(!k[P+_.x]||!k[P+_.x][C+_.y]||!k[P+_.x][C+_.y][s+_.z])continue;const M=k[P+_.x][C+_.y][s+_.z];g(c,M)}}}}}}),"./src/parsers/utils/assignPDBBonds.ts":((n,t,r)=>{r.r(t),r.d(t,{assignPDBBonds:()=>b});var u=r("./src/parsers/utils/areConnected.ts"),v=r("./src/parsers/utils/assignBonds.ts"),x=r("./src/parsers/utils/standardResidues.ts");function b(p,y){const k=[],g=[];for(let C=0,a=p.length;C<a;C++){const s=p[C];s.index=C,s.hetflag||!x.standardResidues.has(s.resn)?g.push(s):k.push(s)}(0,v.assignBonds)(g,y),k.sort(function(C,a){return C.chain!==a.chain?C.chain<a.chain?-1:1:C.resi-a.resi});let R=-1,P=-1,T;for(let C=0,a=k.length;C<a;C++){const s=k[C];s.resi!==R&&(R=s.resi,T||P++,T=!1),s.reschain=P;for(let c=C+1;c<k.length;c++){const w=k[c];if(w.chain!==s.chain||w.resi-s.resi>1)break;(0,u.areConnected)(s,w,y)&&(s.bonds.indexOf(w.index)===-1&&(s.bonds.push(w.index),s.bondOrder.push(1),w.bonds.push(s.index),w.bondOrder.push(1)),s.resi!==w.resi&&(T=!0))}}}}),"./src/parsers/utils/atomNameToElem.ts":((n,t,r)=>{r.r(t),r.d(t,{atomNameToElem:()=>v});var u=r("./src/parsers/utils/bondLength.ts");function v(x,b){let p=x.replace(/ /g,"");return p.length>0&&p[0]==="H"&&p!=="Hg"&&p!=="He"&&p!=="Hf"&&p!=="Hs"&&p!=="Ho"&&(p="H"),p.length>1&&(p=p[0].toUpperCase()+p.substring(1).toLowerCase(),u.bondTable[p]===void 0?p=p[0]:b&&(p==="Ca"||p==="Cd")&&(p="C")),p}}),"./src/parsers/utils/bondLength.ts":((n,t,r)=>{r.r(t),r.d(t,{bondLength:()=>v,bondTable:()=>u,setBondLength:()=>x});let u={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function v(b){return u[b]||1.6}function x(b,p){p<0&&(p=0),u[b]=p}}),"./src/parsers/utils/computeSecondaryStructure.ts":((n,t,r)=>{r.r(t),r.d(t,{computeSecondaryStructure:()=>v});var u=r("./src/parsers/utils/assignBackboneHBonds.ts");function v(x,b){(0,u.assignBackboneHBonds)(x,b);const p={};let y,k,g,R,P,T;for(y=0,k=x.length;y<k;y++)if(P=x[y],p[P.chain]===void 0&&(p[P.chain]=[]),isFinite(P.hbondDistanceSq)){const C=P.hbondOther;p[C.chain]===void 0&&(p[C.chain]=[]),Math.abs(C.resi-P.resi)===4&&(p[P.chain][P.resi]="h")}for(g in p)for(R=1;R<p[g].length-1;R++){const C=p[g][R-1],a=p[g][R+1];T=p[g][R],C=="h"&&C==a&&T!=C&&(p[g][R]=C)}for(y=0,k=x.length;y<k;y++)P=x[y],isFinite(P.hbondDistanceSq)&&p[P.chain][P.resi]!="h"&&P.ss!=="h"&&(p[P.chain][P.resi]="maybesheet");for(let C=0,a=x.length;C<a;C++)if(P=x[C],isFinite(P.hbondDistanceSq)&&p[P.chain][P.resi]=="maybesheet"){let s=P.hbondOther,c=p[s.chain][s.resi];(c=="maybesheet"||c=="s")&&(p[P.chain][P.resi]="s",p[s.chain][s.resi]="s")}for(let C in p){for(let a=1;a<p[C].length-1;a++){const s=p[C][a-1],c=p[C][a+1];T=p[C][a],s=="s"&&s==c&&T!=s&&(p[C][a]=s)}for(let a=0;a<p[C].length;a++){const s=p[C][a];(s=="h"||s=="s")&&p[C][a-1]!=s&&p[C][a+1]!=s&&delete p[C][a]}}for(y=0,k=x.length;y<k;y++)P=x[y],T=p[P.chain][P.resi],delete P.hbondOther,delete P.hbondDistanceSq,!(T===void 0||T==="maybesheet")&&(P.ss=T,p[P.chain][P.resi-1]!=T&&(P.ssbegin=!0),p[P.chain][P.resi+1]!=T&&(P.ssend=!0))}}),"./src/parsers/utils/getSinglePDB.ts":((n,t,r)=>{r.r(t),r.d(t,{getSinglePDB:()=>R});var u=r("./src/WebGL/index.ts"),v=r("./src/parsers/utils/atomNameToElem.ts"),x=r("./src/parsers/utils/bondLength.ts"),b=r("./src/parsers/utils/computeSecondaryStructure.ts"),p=r("./src/parsers/utils/isEmpty.ts"),y=r("./src/parsers/utils/processSymmetries.ts"),k=r("./src/parsers/utils/assignPDBBonds.ts"),g=r("./src/parsers/utils/validateBonds.ts");function R(P,T,C){const a=[],s=T.assignBonds===void 0?!0:T.assignBonds,c=!T.keepH,w=!!T.noSecondaryStructure,_=!T.noComputeSecondaryStructure,M=!T.doAssembly,l=T.altLoc?T.altLoc:"A",h={symmetries:[],cryst:void 0};let S,E=[];const F=[];let D;const L={};for(let V=0;V<P.length;V++){D=P[V].replace(/^\s*/,"");const O=D.substring(0,6);let W,H,q;if(O.indexOf("END")===0){if(E=P.slice(V+1),O==="END")for(const U in C)C.hasOwnProperty(U)&&delete C[U];break}else if(O==="ATOM  "||O==="HETATM"){let U,B,Y,X,N,J,ae,se,he,pe,de,ue;if(de=D.substring(16,17),de!==" "&&de!==l&&l!=="*"||(pe=parseInt(D.substring(6,11)),S=D.substring(12,16).replace(/ /g,""),U=D.substring(17,20).replace(/ /g,""),B=D.substring(21,22),Y=parseInt(D.substring(22,26)),X=D.substring(26,27),N=parseFloat(D.substring(30,38)),J=parseFloat(D.substring(38,46)),ae=parseFloat(D.substring(46,54)),ue=parseFloat(D.substring(60,68)),he=D.substring(76,78).replace(/ /g,""),he===""||x.bondTable[he]===void 0?he=(0,v.atomNameToElem)(D.substring(12,14),D[0]=="A"):he=he[0].toUpperCase()+he.substring(1).toLowerCase(),he==="H"&&c))continue;O[0]=="H"?se=!0:se=!1,F[pe]=a.length,a.push({resn:U,x:N,y:J,z:ae,elem:he,hetflag:se,altLoc:de,chain:B,resi:Y,icode:X,rescode:Y+(X!==" "?"^"+X:""),serial:pe,atom:S,bonds:[],ss:"c",bondOrder:[],properties:{},b:ue,pdbline:D})}else if(O==="SHEET "){W=D.substring(21,22),H=parseInt(D.substring(22,26)),q=parseInt(D.substring(33,37)),W in C||(C[W]={}),C[W][H]="s1";for(let U=H+1;U<q;U++)C[W][U]="s";C[W][q]="s2"}else if(O==="CONECT"){const U=parseInt(D.substring(6,11)),B=F[U],Y=a[B],X=[11,16,21,26];for(let N=0;N<4;N++){const J=parseInt(D.substring(X[N],X[N]+5)),ae=F[J];let se=B+":"+ae;const he=a[ae];if(Y!==void 0&&he!==void 0)if(!L[se])L[se]=1,(Y.bonds.length==0||Y.bonds[Y.bonds.length-1]!==ae)&&(Y.bonds.push(ae),Y.bondOrder.push(1));else{L[se]+=1;for(let pe=0;pe<Y.bonds.length;pe++)if(Y.bonds[pe]==ae){const de=L[se];de>=4?Y.bondOrder[pe]=1:Y.bondOrder[pe]=de}}}}else if(O==="HELIX "){W=D.substring(19,20),H=parseInt(D.substring(21,25)),q=parseInt(D.substring(33,37)),W in C||(C[W]={}),C[W][H]="h1";for(let U=H+1;U<q;U++)C[W][U]="h";C[W][q]="h2"}else if(!M&&O==="REMARK"&&D.substring(13,18)==="BIOMT"){let U,B=new u.Matrix4;for(U=1;U<=3;U++)if(D=P[V].replace(/^\s*/,""),parseInt(D.substring(18,19))==U)B.elements[U-1]=parseFloat(D.substring(23,33)),B.elements[U-1+4]=parseFloat(D.substring(33,43)),B.elements[U-1+8]=parseFloat(D.substring(43,53)),B.elements[U-1+12]=parseFloat(D.substring(53)),V++;else for(;D.substring(13,18)==="BIOMT";)V++,D=P[V].replace(/^\s*/,"");B.elements[3]=0,B.elements[7]=0,B.elements[11]=0,B.elements[15]=1,h.symmetries.push(B),V--}else if(O==="CRYST1"){let U,B,Y,X,N,J;U=parseFloat(D.substring(7,15)),B=parseFloat(D.substring(16,24)),Y=parseFloat(D.substring(25,33)),X=parseFloat(D.substring(34,40)),N=parseFloat(D.substring(41,47)),J=parseFloat(D.substring(48,54)),h.cryst={a:U,b:B,c:Y,alpha:X,beta:N,gamma:J}}else if(O==="ANISOU"){const U=parseInt(D.substring(6,11)),B=F[U],Y=a[B];if(Y){const X=D.substring(30).trim().split(/\s+/),N={u11:parseInt(X[0]),u22:parseInt(X[1]),u33:parseInt(X[2]),u12:parseInt(X[3]),u13:parseInt(X[4]),u23:parseInt(X[5])};Y.uMat=N}}}if((0,g.validateBonds)(a,F),s&&(0,k.assignPDBBonds)(a,T),M||(0,y.processSymmetries)(h.symmetries,a,T,h.cryst),_&&!w&&(0,b.computeSecondaryStructure)(a,T.hbondCutoff),!(0,p.isEmpty)(C))for(let V=0;V<a.length;V++){const O=a[V];if(O!==void 0&&O.chain in C&&O.resi in C[O.chain]){const W=C[O.chain][O.resi];O.ss=W[0],W.length>1&&(W[1]=="1"?O.ssbegin=!0:W[1]=="2"&&(O.ssend=!0))}}return[a,h,E]}}),"./src/parsers/utils/isEmpty.ts":((n,t,r)=>{r.r(t),r.d(t,{isEmpty:()=>u});function u(v){for(const x in v)return!1;return!0}}),"./src/parsers/utils/processSymmetries.ts":((n,t,r)=>{r.r(t),r.d(t,{processSymmetries:()=>v});var u=r("./src/WebGL/index.ts");function v(x,b,p,y){const k=!p.duplicateAssemblyAtoms,g=b.length;let R=g,P=-1,T=null,C=null;(p.normalizeAssembly||p.wrapAtoms)&&y&&(T=(0,u.conversionMatrix3)(y.a,y.b,y.c,y.alpha,y.beta,y.gamma),C=new u.Matrix3,C.getInverse3(T));let a=function(w){let _=w.clone().applyMatrix3(C);const M=[_.x,_.y,_.z],l=[0,0,0];for(let S=0;S<3;S++){for(;M[S]<-.001;)M[S]+=1,l[S]+=1;for(;M[S]>1.001;)M[S]-=1,l[S]-=1}const h=new u.Vector3(l[0],l[1],l[2]);return h.applyMatrix3(T),h};if(p.normalizeAssembly&&y)for(let w=0;w<x.length;w++){const _=new u.Vector3(0,0,0);for(let l=0;l<g;l++){const h=new u.Vector3(b[l].x,b[l].y,b[l].z);h.applyMatrix4(x[w]),_.add(h)}_.divideScalar(g);const M=a(_);x[w].isNearlyIdentity()&&M.lengthSq()>.001&&(P=w),x[w].translate(M)}if(k){if(x.length>1)for(let w=0;w<b.length;w++){var s=[];for(let _=0;_<x.length;_++)if(!x[_].isNearlyIdentity()){var c=new u.Vector3;c.set(b[w].x,b[w].y,b[w].z),c.applyMatrix4(x[_]),s.push(c)}b[w].symmetries=s}}else{for(let w=0;w<g;w++)b[w].sym=-1;for(let w=0;w<x.length;w++)if(!x[w].isNearlyIdentity()&&P!=w){let _=new u.Vector3;for(let M=0;M<g;M++){const l=[];for(let S=0;S<b[M].bonds.length;S++)l.push(b[M].bonds[S]+R);if(_.set(b[M].x,b[M].y,b[M].z),_.applyMatrix4(x[w]),p.wrapAtoms&&y){let S=a(_);_.add(S)}const h={};for(const S in b[M])h[S]=b[M][S];h.x=_.x,h.y=_.y,h.z=_.z,h.bonds=l,h.sym=w,h.index=b.length,b.push(h)}R=b.length}else for(let _=0;_<g;_++)b[_].sym=w;if(p.wrapAtoms&&y){let w=new u.Vector3;for(let _=0;_<g;_++){w.set(b[_].x,b[_].y,b[_].z);let M=a(w);w.add(M),b[_].x=w.x,b[_].y=w.y,b[_].z=w.z}}if(P>=0){const w=new u.Vector3;for(let _=0;_<g;_++)w.set(b[_].x,b[_].y,b[_].z),w.applyMatrix4(x[P]),b[_].x=w.x,b[_].y=w.y,b[_].z=w.z}x.length=0}}}),"./src/parsers/utils/standardResidues.ts":((n,t,r)=>{r.r(t),r.d(t,{standardResidues:()=>u});const u=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"])}),"./src/parsers/utils/validateBonds.ts":((n,t,r)=>{r.r(t),r.d(t,{validateBonds:()=>u});function u(v,x){for(let b=0,p=v.length;b<p;b++){const y=v[b];for(let k=0;k<y.bonds.length;k++){const g=y.bonds[k],R=v[g],P=x[y.serial];R&&P&&R.bonds.indexOf(P)<0&&(R.bonds.push(P),R.bondOrder.push(y.bondOrder[k]))}}}}),"./src/partialCharges.ts":((n,t,r)=>{r.r(t),r.d(t,{applyPartialCharges:()=>v,partialCharges:()=>u});const u={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function v(x,b){if((!b||typeof x.partialCharge>"u")&&x.resn&&x.atom){var p=x.resn+":"+x.atom;x.properties.partialCharge=u[p]}}}),"./src/specs.ts":((n,t,r)=>{r.r(t)}),"./src/utilities.ts":((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/Gradient.ts"),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/VolumeData.ts"),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/colors.ts"),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/pako/dist/pako.esm.mjs");function extend(n,t){for(var r in t)t.hasOwnProperty(r)&&t[r]!==void 0&&(n[r]=t[r]);return n}function deepCopy(n){let t,r,u;if(n==null)return{};if(typeof n!="object"||n===null)return n;t=Array.isArray(n)?[]:{};for(u in n)r=n[u],t[u]=deepCopy(r);return t}function isNumeric(n){var t=typeof n;return(t==="number"||t==="string")&&!isNaN(n-parseFloat(n))}function isEmptyObject(n){var t;for(t in n)return!1;return!0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?null:callback}function adjustVolumeStyle(n){n&&(n.volformat&&!(n.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData)&&(n.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(n.voldata,n.volformat)),n.volscheme&&(n.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(n.volscheme)))}function getExtent(n,t){var r,u,v,x,b,p,y,k,g,R,P=!t;if(r=u=v=9999,x=b=p=-9999,y=k=g=R=0,n.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var T=0;T<n.length;T++){var C=n[T];if(!(typeof C>"u"||!isFinite(C.x)||!isFinite(C.y)||!isFinite(C.z))&&(R++,y+=C.x,k+=C.y,g+=C.z,r=r<C.x?r:C.x,u=u<C.y?u:C.y,v=v<C.z?v:C.z,x=x>C.x?x:C.x,b=b>C.y?b:C.y,p=p>C.z?p:C.z,C.symmetries&&P))for(var a=0;a<C.symmetries.length;a++)R++,y+=C.symmetries[a].x,k+=C.symmetries[a].y,g+=C.symmetries[a].z,r=r<C.symmetries[a].x?r:C.symmetries[a].x,u=u<C.symmetries[a].y?u:C.symmetries[a].y,v=v<C.symmetries[a].z?v:C.symmetries[a].z,x=x>C.symmetries[a].x?x:C.symmetries[a].x,b=b>C.symmetries[a].y?b:C.symmetries[a].y,p=p>C.symmetries[a].z?p:C.symmetries[a].z}return[[r,u,v],[x,b,p],[y/R,k/R,g/R]]}function getPropertyRange(n,t){for(var r=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,v=0,x=n.length;v<x;v++){var b=n[v],p=getAtomProperty(b,t);p!=null&&(p<r&&(r=p),p>u&&(u=p))}return!isFinite(r)&&!isFinite(u)?r=u=0:isFinite(r)?isFinite(u)||(u=r):r=u,[r,u]}class PausableTimer{constructor(t,r,u){this.total_time_run=0,this.fn=t,this.arg=u,this.countdown=r,this.start_time=new Date().getTime(),this.ident=setTimeout(t,r,u)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(n){for(var t=window.atob(n),r=t.length,u=new Uint8Array(r),v=0;v<r;v++)u[v]=t.charCodeAt(v);return u}function getAtomProperty(n,t){var r=null;return n.properties&&typeof n.properties[t]<"u"?r=n.properties[t]:typeof n[t]<"u"&&(r=n[t]),r}function mergeGeos(n,t){var r=t.geometry;r!==void 0&&n.geometryGroups.push(r.geometryGroups[0])}function specStringToObject(n){if(typeof n=="object"||typeof n>"u"||n==null)return n;try{return JSON.parse(n)}catch{}n=n.replace(/%7E/g,"~");var t=function(P){return isNumeric(P)?Math.floor(parseFloat(P))==parseInt(P)||P.indexOf(".")>=0?parseFloat(P):parseInt(P):P==="true"?!0:P==="false"?!1:P},r={};if(n==="all")return r;for(var u=n.split(";"),v=0;v<u.length;v++){var x=u[v].split(":"),b=x[0],p={},y=x[1];if(y)if(y=y.replace(/~/g,"="),y.indexOf("=")!==-1)for(var k=y.split(","),g=0;g<k.length;g++){var R=k[g].split("=",2);p[R[0]]=t(R[1])}else y.indexOf(",")!==-1?p=y.split(","):p=t(y);r[b]=p}return r}function checkStatus(n){if(!n.ok)throw new Error(`HTTP ${n.status} - ${n.statusText}`);return n}function get(n,t){var r=fetch(n).then(checkStatus).then(u=>u.text());return t?r.then(t):r}function getbin(n,t,r,u){var v;return r=="POST"?v=fetch(n,{method:"POST",body:u}).then(x=>checkStatus(x)).then(x=>x.arrayBuffer()):v=fetch(n).then(x=>checkStatus(x)).then(x=>x.arrayBuffer()),t?v.then(t):v}function download(n,t,r,u){var v="",x="",b="",p=null,y=t.addModel();if(n.indexOf(":")<0&&(n.length==4?n="pdb:"+n:isNaN(n)?n="url:"+n:n="cid:"+n),n.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),n="bcif:"+n.slice(5)),n.substring(0,5)==="bcif:")n=n.substring(5).toUpperCase(),b="https://models.rcsb.org/"+n+".bcif.gz",r&&typeof r.noComputeSecondaryStructure>"u"&&(r.noComputeSecondaryStructure=!0),p=new Promise(function(g){getbin(b).then(function(R){y.addMolData(R,"bcif.gz",r),t.zoomTo(),t.render(),g(y)},function(){console.error("fetch of "+b+" failed.")})});else{if(n.substring(0,4)==="pdb:"){if(v="bcif",r&&r.format&&(v=r.format),r&&typeof r.noComputeSecondaryStructure>"u"&&(r.noComputeSecondaryStructure=!0),n=n.substring(4).toUpperCase(),!n.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}v=="bcif"?b="https://models.rcsb.org/"+n.toUpperCase()+".bcif.gz":(x=r&&r.pdbUri?r.pdbUri:"https://files.rcsb.org/view/",b=x+n+"."+v)}else if(n.substring(0,4)=="cid:"){if(v="sdf",n=n.substring(4),!n.match(/^[0-9]+$/)){alert("Wrong Compound ID");return}b="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+n+"/SDF?record_type=3d"}else n.substring(0,4)=="url:"&&(b=n.substring(4),v=b);var k=function(g){y.addMolData(g,v,r),t.zoomTo(),t.render()};p=new Promise(function(g){v=="bcif"?getbin(b).then(function(R){k(R),g(y)}).catch(function(){x=r&&r.pdbUri?r.pdbUri:"https://files.rcsb.org/view/",b=x+n+".pdb",v="pdb",console.warn("falling back to pdb format"),get(b).then(function(R){k(R),g(y)}).catch(function(R){k(""),g(y),console.error("fetch of "+b+" failed: "+R.statusText)})}):get(b).then(function(R){k(R),g(y)}).catch(function(R){k(""),g(y),console.error("fetch of "+b+" failed: "+R.statusText)})})}return u?(p.then(function(g){u(g)}),y):p}function getColorFromStyle(n,t){let r=t.colorscheme;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[r]<"u")r=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[r];else if(typeof r=="string"&&r.endsWith("Carbon")){let x=r.substring(0,r.lastIndexOf("Carbon")).toLowerCase();if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[x]<"u"){let b=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);b.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[x],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[r]={prop:"elem",map:b},r=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[r]}}let u=n.color;if(typeof t.color<"u"&&t.color!="spectrum"&&(u=t.color),typeof r<"u"){let x,b;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[r]<"u")r=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[r],typeof r[n[r.prop]]<"u"&&(u=r.map[n[r.prop]]);else if(typeof r[n[r.prop]]<"u")u=r.map[n[r.prop]];else if(typeof r.prop<"u"&&typeof r.gradient<"u"){x=r.prop;var v=r.gradient;v instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(v=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(r));let p=v.range()||[-1,1];b=getAtomProperty(n,x),b!=null&&(u=v.valueToHex(b,p))}else typeof r.prop<"u"&&typeof r.map<"u"?(x=r.prop,b=getAtomProperty(n,x),typeof r.map[b]<"u"&&(u=r.map[b])):typeof t.colorscheme[n.elem]<"u"?u=t.colorscheme[n.elem]:console.warn("Could not interpret colorscheme "+r)}else typeof t.colorfunc<"u"&&(u=t.colorfunc(n));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(u)}function getElement(n){let t=n;return typeof n=="string"?t=document.querySelector("#"+n):typeof n=="object"&&n.get&&(t=n.get(0)),t}function inflateString(n,t=!0){let r;return typeof n=="string"?r=new TextEncoder().encode(n):r=new Uint8Array(n),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(r,{to:t?"string":null})}}),"./node_modules/upng-js/UPNG.js":((n,t,r)=>{(function(){var u={},v;n.exports=u,v=r("./node_modules/upng-js/node_modules/pako/index.js"),(function(x,b){x.toRGBA8=function(p){var y=p.width,k=p.height;if(p.tabs.acTL==null)return[x.toRGBA8.decodeImage(p.data,y,k,p).buffer];var g=[];p.frames[0].data==null&&(p.frames[0].data=p.data);for(var R,P=new Uint8Array(y*k*4),T=0;T<p.frames.length;T++){var C=p.frames[T],a=C.rect.x,s=C.rect.y,c=C.rect.width,w=C.rect.height,_=x.toRGBA8.decodeImage(C.data,c,w,p);if(T==0?R=_:C.blend==0?x._copyTile(_,c,w,R,y,k,a,s,0):C.blend==1&&x._copyTile(_,c,w,R,y,k,a,s,1),g.push(R.buffer),R=R.slice(0),C.dispose!=0){if(C.dispose==1)x._copyTile(P,c,w,R,y,k,a,s,0);else if(C.dispose==2){for(var M=T-1;p.frames[M].dispose==2;)M--;R=new Uint8Array(g[M]).slice(0)}}}return g},x.toRGBA8.decodeImage=function(p,y,k,g){var R=y*k,P=x.decode._getBPP(g),T=Math.ceil(y*P/8),C=new Uint8Array(R*4),a=new Uint32Array(C.buffer),s=g.ctype,c=g.depth,w=x._bin.readUshort;if(s==6){var _=R<<2;if(c==8)for(var M=0;M<_;M++)C[M]=p[M];if(c==16)for(var M=0;M<_;M++)C[M]=p[M<<1]}else if(s==2){var l=g.tabs.tRNS,h=-1,S=-1,E=-1;if(l&&(h=l[0],S=l[1],E=l[2]),c==8)for(var M=0;M<R;M++){var F=M<<2,D=M*3;C[F]=p[D],C[F+1]=p[D+1],C[F+2]=p[D+2],C[F+3]=255,h!=-1&&p[D]==h&&p[D+1]==S&&p[D+2]==E&&(C[F+3]=0)}if(c==16)for(var M=0;M<R;M++){var F=M<<2,D=M*6;C[F]=p[D],C[F+1]=p[D+2],C[F+2]=p[D+4],C[F+3]=255,h!=-1&&w(p,D)==h&&w(p,D+2)==S&&w(p,D+4)==E&&(C[F+3]=0)}}else if(s==3){var L=g.tabs.PLTE,V=g.tabs.tRNS,O=V?V.length:0;if(c==1)for(var W=0;W<k;W++)for(var H=W*T,q=W*y,M=0;M<y;M++){var F=q+M<<2,U=p[H+(M>>3)]>>7-((M&7)<<0)&1,B=3*U;C[F]=L[B],C[F+1]=L[B+1],C[F+2]=L[B+2],C[F+3]=U<O?V[U]:255}if(c==2)for(var W=0;W<k;W++)for(var H=W*T,q=W*y,M=0;M<y;M++){var F=q+M<<2,U=p[H+(M>>2)]>>6-((M&3)<<1)&3,B=3*U;C[F]=L[B],C[F+1]=L[B+1],C[F+2]=L[B+2],C[F+3]=U<O?V[U]:255}if(c==4)for(var W=0;W<k;W++)for(var H=W*T,q=W*y,M=0;M<y;M++){var F=q+M<<2,U=p[H+(M>>1)]>>4-((M&1)<<2)&15,B=3*U;C[F]=L[B],C[F+1]=L[B+1],C[F+2]=L[B+2],C[F+3]=U<O?V[U]:255}if(c==8)for(var M=0;M<R;M++){var F=M<<2,U=p[M],B=3*U;C[F]=L[B],C[F+1]=L[B+1],C[F+2]=L[B+2],C[F+3]=U<O?V[U]:255}}else if(s==4){if(c==8)for(var M=0;M<R;M++){var F=M<<2,Y=M<<1,X=p[Y];C[F]=X,C[F+1]=X,C[F+2]=X,C[F+3]=p[Y+1]}if(c==16)for(var M=0;M<R;M++){var F=M<<2,Y=M<<2,X=p[Y];C[F]=X,C[F+1]=X,C[F+2]=X,C[F+3]=p[Y+2]}}else if(s==0){var h=g.tabs.tRNS?g.tabs.tRNS:-1;if(c==1)for(var M=0;M<R;M++){var X=255*(p[M>>3]>>7-(M&7)&1),N=X==h*255?0:255;a[M]=N<<24|X<<16|X<<8|X}if(c==2)for(var M=0;M<R;M++){var X=85*(p[M>>2]>>6-((M&3)<<1)&3),N=X==h*85?0:255;a[M]=N<<24|X<<16|X<<8|X}if(c==4)for(var M=0;M<R;M++){var X=17*(p[M>>1]>>4-((M&1)<<2)&15),N=X==h*17?0:255;a[M]=N<<24|X<<16|X<<8|X}if(c==8)for(var M=0;M<R;M++){var X=p[M],N=X==h?0:255;a[M]=N<<24|X<<16|X<<8|X}if(c==16)for(var M=0;M<R;M++){var X=p[M<<1],N=w(p,M<<1)==h?0:255;a[M]=N<<24|X<<16|X<<8|X}}return C},x.decode=function(p){for(var y=new Uint8Array(p),k=8,g=x._bin,R=g.readUshort,P=g.readUint,T={tabs:{},frames:[]},C=new Uint8Array(y.length),a=0,s,c=0,w=[137,80,78,71,13,10,26,10],_=0;_<8;_++)if(y[_]!=w[_])throw"The input is not a PNG file!";for(;k<y.length;){var M=g.readUint(y,k);k+=4;var l=g.readASCII(y,k,4);if(k+=4,l=="IHDR")x.decode._IHDR(y,k,T);else if(l=="IDAT"){for(var _=0;_<M;_++)C[a+_]=y[k+_];a+=M}else if(l=="acTL")T.tabs[l]={num_frames:P(y,k),num_plays:P(y,k+4)},s=new Uint8Array(y.length);else if(l=="fcTL"){if(c!=0){var h=T.frames[T.frames.length-1];h.data=x.decode._decompress(T,s.slice(0,c),h.rect.width,h.rect.height),c=0}var S={x:P(y,k+12),y:P(y,k+16),width:P(y,k+4),height:P(y,k+8)},E=R(y,k+22);E=R(y,k+20)/(E==0?100:E);var F={rect:S,delay:Math.round(E*1e3),dispose:y[k+24],blend:y[k+25]};T.frames.push(F)}else if(l=="fdAT"){for(var _=0;_<M-4;_++)s[c+_]=y[k+_+4];c+=M-4}else if(l=="pHYs")T.tabs[l]=[g.readUint(y,k),g.readUint(y,k+4),y[k+8]];else if(l=="cHRM"){T.tabs[l]=[];for(var _=0;_<8;_++)T.tabs[l].push(g.readUint(y,k+_*4))}else if(l=="tEXt"){T.tabs[l]==null&&(T.tabs[l]={});var D=g.nextZero(y,k),L=g.readASCII(y,k,D-k),V=g.readASCII(y,D+1,k+M-D-1);T.tabs[l][L]=V}else if(l=="iTXt"){T.tabs[l]==null&&(T.tabs[l]={});var D=0,O=k;D=g.nextZero(y,O);var L=g.readASCII(y,O,D-O);O=D+1,y[O],y[O+1],O+=2,D=g.nextZero(y,O),g.readASCII(y,O,D-O),O=D+1,D=g.nextZero(y,O),g.readUTF8(y,O,D-O),O=D+1;var V=g.readUTF8(y,O,M-(O-k));T.tabs[l][L]=V}else if(l=="PLTE")T.tabs[l]=g.readBytes(y,k,M);else if(l=="hIST"){var W=T.tabs.PLTE.length/3;T.tabs[l]=[];for(var _=0;_<W;_++)T.tabs[l].push(R(y,k+_*2))}else if(l=="tRNS")T.ctype==3?T.tabs[l]=g.readBytes(y,k,M):T.ctype==0?T.tabs[l]=R(y,k):T.ctype==2&&(T.tabs[l]=[R(y,k),R(y,k+2),R(y,k+4)]);else if(l=="gAMA")T.tabs[l]=g.readUint(y,k)/1e5;else if(l=="sRGB")T.tabs[l]=y[k];else if(l=="bKGD")T.ctype==0||T.ctype==4?T.tabs[l]=[R(y,k)]:T.ctype==2||T.ctype==6?T.tabs[l]=[R(y,k),R(y,k+2),R(y,k+4)]:T.ctype==3&&(T.tabs[l]=y[k]);else if(l=="IEND"){if(c!=0){var h=T.frames[T.frames.length-1];h.data=x.decode._decompress(T,s.slice(0,c),h.rect.width,h.rect.height),c=0}T.data=x.decode._decompress(T,C,T.width,T.height);break}k+=M,g.readUint(y,k),k+=4}return delete T.compress,delete T.interlace,delete T.filter,T},x.decode._decompress=function(p,y,k,g){return p.compress==0&&(y=x.decode._inflate(y)),p.interlace==0?y=x.decode._filterZero(y,p,0,k,g):p.interlace==1&&(y=x.decode._readInterlace(y,p)),y},x.decode._inflate=function(p){return b.inflate(p)},x.decode._readInterlace=function(p,y){for(var k=y.width,g=y.height,R=x.decode._getBPP(y),P=R>>3,T=Math.ceil(k*R/8),C=new Uint8Array(g*T),a=0,s=[0,0,4,0,2,0,1],c=[0,4,0,2,0,1,0],w=[8,8,8,4,4,2,2],_=[8,8,4,4,2,2,1],M=0;M<7;){for(var l=w[M],h=_[M],S=0,E=0,F=s[M];F<g;)F+=l,E++;for(var D=c[M];D<k;)D+=h,S++;var L=Math.ceil(S*R/8);x.decode._filterZero(p,y,a,S,E);for(var V=0,O=s[M];O<g;){for(var W=c[M],H=a+V*L<<3;W<k;){if(R==1){var q=p[H>>3];q=q>>7-(H&7)&1,C[O*T+(W>>3)]|=q<<7-((W&3)<<0)}if(R==2){var q=p[H>>3];q=q>>6-(H&7)&3,C[O*T+(W>>2)]|=q<<6-((W&3)<<1)}if(R==4){var q=p[H>>3];q=q>>4-(H&7)&15,C[O*T+(W>>1)]|=q<<4-((W&1)<<2)}if(R>=8)for(var U=O*T+W*P,B=0;B<P;B++)C[U+B]=p[(H>>3)+B];H+=R,W+=h}V++,O+=l}S*E!=0&&(a+=E*(1+L)),M=M+1}return C},x.decode._getBPP=function(p){var y=[1,null,3,1,2,null,4][p.ctype];return y*p.depth},x.decode._filterZero=function(p,y,k,g,R){var P=x.decode._getBPP(y),T=Math.ceil(g*P/8),C=x.decode._paeth;P=Math.ceil(P/8);for(var a=0;a<R;a++){var s=k+a*T,c=s+a+1,w=p[c-1];if(w==0)for(var _=0;_<T;_++)p[s+_]=p[c+_];else if(w==1){for(var _=0;_<P;_++)p[s+_]=p[c+_];for(var _=P;_<T;_++)p[s+_]=p[c+_]+p[s+_-P]&255}else if(a==0){for(var _=0;_<P;_++)p[s+_]=p[c+_];if(w==2)for(var _=P;_<T;_++)p[s+_]=p[c+_]&255;if(w==3)for(var _=P;_<T;_++)p[s+_]=p[c+_]+(p[s+_-P]>>1)&255;if(w==4)for(var _=P;_<T;_++)p[s+_]=p[c+_]+C(p[s+_-P],0,0)&255}else{if(w==2)for(var _=0;_<T;_++)p[s+_]=p[c+_]+p[s+_-T]&255;if(w==3){for(var _=0;_<P;_++)p[s+_]=p[c+_]+(p[s+_-T]>>1)&255;for(var _=P;_<T;_++)p[s+_]=p[c+_]+(p[s+_-T]+p[s+_-P]>>1)&255}if(w==4){for(var _=0;_<P;_++)p[s+_]=p[c+_]+C(0,p[s+_-T],0)&255;for(var _=P;_<T;_++)p[s+_]=p[c+_]+C(p[s+_-P],p[s+_-T],p[s+_-P-T])&255}}}return p},x.decode._paeth=function(p,y,k){var g=p+y-k,R=Math.abs(g-p),P=Math.abs(g-y),T=Math.abs(g-k);return R<=P&&R<=T?p:P<=T?y:k},x.decode._IHDR=function(p,y,k){var g=x._bin;k.width=g.readUint(p,y),y+=4,k.height=g.readUint(p,y),y+=4,k.depth=p[y],y++,k.ctype=p[y],y++,k.compress=p[y],y++,k.filter=p[y],y++,k.interlace=p[y],y++},x._bin={nextZero:function(p,y){for(;p[y]!=0;)y++;return y},readUshort:function(p,y){return p[y]<<8|p[y+1]},writeUshort:function(p,y,k){p[y]=k>>8&255,p[y+1]=k&255},readUint:function(p,y){return p[y]*16777216+(p[y+1]<<16|p[y+2]<<8|p[y+3])},writeUint:function(p,y,k){p[y]=k>>24&255,p[y+1]=k>>16&255,p[y+2]=k>>8&255,p[y+3]=k&255},readASCII:function(p,y,k){for(var g="",R=0;R<k;R++)g+=String.fromCharCode(p[y+R]);return g},writeASCII:function(p,y,k){for(var g=0;g<k.length;g++)p[y+g]=k.charCodeAt(g)},readBytes:function(p,y,k){for(var g=[],R=0;R<k;R++)g.push(p[y+R]);return g},pad:function(p){return p.length<2?"0"+p:p},readUTF8:function(p,y,k){for(var g="",R,P=0;P<k;P++)g+="%"+x._bin.pad(p[y+P].toString(16));try{R=decodeURIComponent(g)}catch{return x._bin.readASCII(p,y,k)}return R}},x._copyTile=function(p,y,k,g,R,P,T,C,a){for(var s=Math.min(y,R),c=Math.min(k,P),w=0,_=0,M=0;M<c;M++)for(var l=0;l<s;l++)if(T>=0&&C>=0?(w=M*y+l<<2,_=(C+M)*R+T+l<<2):(w=(-C+M)*y-T+l<<2,_=M*R+l<<2),a==0)g[_]=p[w],g[_+1]=p[w+1],g[_+2]=p[w+2],g[_+3]=p[w+3];else if(a==1){var h=p[w+3]*.00392156862745098,S=p[w]*h,E=p[w+1]*h,F=p[w+2]*h,D=g[_+3]*(1/255),L=g[_]*D,V=g[_+1]*D,O=g[_+2]*D,W=1-h,H=h+D*W,q=H==0?0:1/H;g[_+3]=255*H,g[_+0]=(S+L*W)*q,g[_+1]=(E+V*W)*q,g[_+2]=(F+O*W)*q}else if(a==2){var h=p[w+3],S=p[w],E=p[w+1],F=p[w+2],D=g[_+3],L=g[_],V=g[_+1],O=g[_+2];h==D&&S==L&&E==V&&F==O?(g[_]=0,g[_+1]=0,g[_+2]=0,g[_+3]=0):(g[_]=S,g[_+1]=E,g[_+2]=F,g[_+3]=h)}else if(a==3){var h=p[w+3],S=p[w],E=p[w+1],F=p[w+2],D=g[_+3],L=g[_],V=g[_+1],O=g[_+2];if(h==D&&S==L&&E==V&&F==O)continue;if(h<220&&D>20)return!1}return!0},x.encode=function(p,y,k,g,R,P){g==null&&(g=0),P==null&&(P=!1);for(var T=new Uint8Array(p[0].byteLength*p.length+100),C=[137,80,78,71,13,10,26,10],a=0;a<8;a++)T[a]=C[a];var s=8,c=x._bin,w=x.crc.crc,_=c.writeUint,M=c.writeUshort,l=c.writeASCII,h=x.encode.compressPNG(p,y,k,g,P);_(T,s,13),s+=4,l(T,s,"IHDR"),s+=4,_(T,s,y),s+=4,_(T,s,k),s+=4,T[s]=h.depth,s++,T[s]=h.ctype,s++,T[s]=0,s++,T[s]=0,s++,T[s]=0,s++,_(T,s,w(T,s-17,17)),s+=4,_(T,s,1),s+=4,l(T,s,"sRGB"),s+=4,T[s]=1,s++,_(T,s,w(T,s-5,5)),s+=4;var S=p.length>1;if(S&&(_(T,s,8),s+=4,l(T,s,"acTL"),s+=4,_(T,s,p.length),s+=4,_(T,s,0),s+=4,_(T,s,w(T,s-12,12)),s+=4),h.ctype==3){var E=h.plte.length;_(T,s,E*3),s+=4,l(T,s,"PLTE"),s+=4;for(var a=0;a<E;a++){var F=a*3,D=h.plte[a],L=D&255,V=D>>8&255,O=D>>16&255;T[s+F+0]=L,T[s+F+1]=V,T[s+F+2]=O}if(s+=E*3,_(T,s,w(T,s-E*3-4,E*3+4)),s+=4,h.gotAlpha){_(T,s,E),s+=4,l(T,s,"tRNS"),s+=4;for(var a=0;a<E;a++)T[s+a]=h.plte[a]>>24&255;s+=E,_(T,s,w(T,s-E-4,E+4)),s+=4}}for(var W=0,H=0;H<h.frames.length;H++){var q=h.frames[H];S&&(_(T,s,26),s+=4,l(T,s,"fcTL"),s+=4,_(T,s,W++),s+=4,_(T,s,q.rect.width),s+=4,_(T,s,q.rect.height),s+=4,_(T,s,q.rect.x),s+=4,_(T,s,q.rect.y),s+=4,M(T,s,R[H]),s+=2,M(T,s,1e3),s+=2,T[s]=q.dispose,s++,T[s]=q.blend,s++,_(T,s,w(T,s-30,30)),s+=4);var U=q.cimg,E=U.length;_(T,s,E+(H==0?0:4)),s+=4;var B=s;l(T,s,H==0?"IDAT":"fdAT"),s+=4,H!=0&&(_(T,s,W++),s+=4);for(var a=0;a<E;a++)T[s+a]=U[a];s+=E,_(T,s,w(T,B,s-B)),s+=4}return _(T,s,0),s+=4,l(T,s,"IEND"),s+=4,_(T,s,w(T,s-4,4)),s+=4,T.buffer.slice(0,s)},x.encode.compressPNG=function(p,y,k,g,R){for(var P=x.encode.compress(p,y,k,g,!1,R),T=0;T<p.length;T++){var C=P.frames[T];C.rect.width;var a=C.rect.height,s=C.bpl,c=C.bpp,w=new Uint8Array(a*s+a);C.cimg=x.encode._filterZero(C.img,a,c,s,w)}return P},x.encode.compress=function(p,y,k,g,R,P){P==null&&(P=!1);for(var T=6,C=8,a=4,s=255,c=0;c<p.length;c++)for(var w=new Uint8Array(p[c]),_=w.length,M=0;M<_;M+=4)s&=w[M+3];var l=s!=255,h={},S=[];if(p.length!=0&&(h[0]=0,S.push(0),g!=0&&g--),g!=0){var E=x.quantize(p,g,R);p=E.bufs;for(var M=0;M<E.plte.length;M++){var F=E.plte[M].est.rgba;h[F]==null&&(h[F]=S.length,S.push(F))}}else for(var c=0;c<p.length;c++)for(var D=new Uint32Array(p[c]),_=D.length,M=0;M<_;M++){var F=D[M];if((M<y||F!=D[M-1]&&F!=D[M-y])&&h[F]==null&&(h[F]=S.length,S.push(F),S.length>=300))break}var L=l?R:!1,V=S.length;V<=256&&P==!1&&(V<=2?C=1:V<=4?C=2:V<=16?C=4:C=8,R&&(C=8),l=!0);for(var O=[],c=0;c<p.length;c++){var W=new Uint8Array(p[c]),H=new Uint32Array(W.buffer),q=0,U=0,B=y,Y=k,X=0;if(c!=0&&!L){for(var N=R||c==1||O[O.length-2].dispose==2?1:2,J=0,ae=1e9,se=0;se<N;se++){for(var Oe=new Uint8Array(p[c-1-se]),he=new Uint32Array(p[c-1-se]),pe=y,de=k,ue=-1,ge=-1,Re=0;Re<k;Re++)for(var Ge=0;Ge<y;Ge++){var M=Re*y+Ge;H[M]!=he[M]&&(Ge<pe&&(pe=Ge),Ge>ue&&(ue=Ge),Re<de&&(de=Re),Re>ge&&(ge=Re))}var We=ue==-1?1:(ue-pe+1)*(ge-de+1);We<ae&&(ae=We,J=se,ue==-1?(q=U=0,B=Y=1):(q=pe,U=de,B=ue-pe+1,Y=ge-de+1))}var Oe=new Uint8Array(p[c-1-J]);J==1&&(O[O.length-1].dispose=2);var me=new Uint8Array(B*Y*4);new Uint32Array(me.buffer),x._copyTile(Oe,y,k,me,B,Y,-q,-U,0),x._copyTile(W,y,k,me,B,Y,-q,-U,3)?(x._copyTile(W,y,k,me,B,Y,-q,-U,2),X=1):(x._copyTile(W,y,k,me,B,Y,-q,-U,0),X=0),W=me,H=new Uint32Array(W.buffer)}var Fe=4*B;if(V<=256&&P==!1){Fe=Math.ceil(C*B/8);for(var me=new Uint8Array(Fe*Y),Re=0;Re<Y;Re++){var M=Re*Fe,qe=Re*B;if(C==8)for(var Ge=0;Ge<B;Ge++)me[M+Ge]=h[H[qe+Ge]];else if(C==4)for(var Ge=0;Ge<B;Ge++)me[M+(Ge>>1)]|=h[H[qe+Ge]]<<4-(Ge&1)*4;else if(C==2)for(var Ge=0;Ge<B;Ge++)me[M+(Ge>>2)]|=h[H[qe+Ge]]<<6-(Ge&3)*2;else if(C==1)for(var Ge=0;Ge<B;Ge++)me[M+(Ge>>3)]|=h[H[qe+Ge]]<<7-(Ge&7)*1}W=me,T=3,a=1}else if(l==!1&&p.length==1){for(var me=new Uint8Array(B*Y*3),Qe=B*Y,M=0;M<Qe;M++){var st=M*3,ot=M*4;me[st]=W[ot],me[st+1]=W[ot+1],me[st+2]=W[ot+2]}W=me,T=2,a=3,Fe=3*B}O.push({rect:{x:q,y:U,width:B,height:Y},img:W,bpl:Fe,bpp:a,blend:X,dispose:L?1:0})}return{ctype:T,depth:C,plte:S,gotAlpha:l,frames:O}},x.encode._filterZero=function(p,y,k,g,R){for(var P=[],T=0;T<5;T++)if(!(y*g>5e5&&(T==2||T==3||T==4))){for(var C=0;C<y;C++)x.encode._filterLine(R,p,C,g,k,T);if(P.push(b.deflate(R)),k==1)break}for(var a,s=1e9,c=0;c<P.length;c++)P[c].length<s&&(a=c,s=P[c].length);return P[a]},x.encode._filterLine=function(p,y,k,g,R,P){var T=k*g,C=T+k,a=x.decode._paeth;if(p[C]=P,C++,P==0)for(var s=0;s<g;s++)p[C+s]=y[T+s];else if(P==1){for(var s=0;s<R;s++)p[C+s]=y[T+s];for(var s=R;s<g;s++)p[C+s]=y[T+s]-y[T+s-R]+256&255}else if(k==0){for(var s=0;s<R;s++)p[C+s]=y[T+s];if(P==2)for(var s=R;s<g;s++)p[C+s]=y[T+s];if(P==3)for(var s=R;s<g;s++)p[C+s]=y[T+s]-(y[T+s-R]>>1)+256&255;if(P==4)for(var s=R;s<g;s++)p[C+s]=y[T+s]-a(y[T+s-R],0,0)+256&255}else{if(P==2)for(var s=0;s<g;s++)p[C+s]=y[T+s]+256-y[T+s-g]&255;if(P==3){for(var s=0;s<R;s++)p[C+s]=y[T+s]+256-(y[T+s-g]>>1)&255;for(var s=R;s<g;s++)p[C+s]=y[T+s]+256-(y[T+s-g]+y[T+s-R]>>1)&255}if(P==4){for(var s=0;s<R;s++)p[C+s]=y[T+s]+256-a(0,y[T+s-g],0)&255;for(var s=R;s<g;s++)p[C+s]=y[T+s]+256-a(y[T+s-R],y[T+s-g],y[T+s-R-g])&255}}},x.crc={table:(function(){for(var p=new Uint32Array(256),y=0;y<256;y++){for(var k=y,g=0;g<8;g++)k&1?k=3988292384^k>>>1:k=k>>>1;p[y]=k}return p})(),update:function(p,y,k,g){for(var R=0;R<g;R++)p=x.crc.table[(p^y[k+R])&255]^p>>>8;return p},crc:function(p,y,k){return x.crc.update(4294967295,p,y,k)^4294967295}},x.quantize=function(p,y,k){for(var g=[],R=0,P=0;P<p.length;P++)g.push(x.encode.alphaMul(new Uint8Array(p[P]),k)),R+=p[P].byteLength;for(var T=new Uint8Array(R),C=new Uint32Array(T.buffer),a=0,P=0;P<g.length;P++){for(var s=g[P],c=s.length,w=0;w<c;w++)T[a+w]=s[w];a+=c}var _={i0:0,i1:T.length,bst:null,est:null,tdst:0,left:null,right:null};_.bst=x.quantize.stats(T,_.i0,_.i1),_.est=x.quantize.estats(_.bst);for(var M=[_];M.length<y;){for(var l=0,h=0,P=0;P<M.length;P++)M[P].est.L>l&&(l=M[P].est.L,h=P);if(l<.001)break;var S=M[h],E=x.quantize.splitPixels(T,C,S.i0,S.i1,S.est.e,S.est.eMq255),F={i0:S.i0,i1:E,bst:null,est:null,tdst:0,left:null,right:null};F.bst=x.quantize.stats(T,F.i0,F.i1),F.est=x.quantize.estats(F.bst);var D={i0:E,i1:S.i1,bst:null,est:null,tdst:0,left:null,right:null};D.bst={R:[],m:[],N:S.bst.N-F.bst.N};for(var P=0;P<16;P++)D.bst.R[P]=S.bst.R[P]-F.bst.R[P];for(var P=0;P<4;P++)D.bst.m[P]=S.bst.m[P]-F.bst.m[P];D.est=x.quantize.estats(D.bst),S.left=F,S.right=D,M[h]=F,M.push(D)}M.sort(function(N,J){return J.bst.N-N.bst.N});for(var L=0;L<g.length;L++){for(var V=x.quantize.planeDst,O=new Uint8Array(g[L].buffer),W=new Uint32Array(g[L].buffer),H=O.length,P=0;P<H;P+=4){for(var q=O[P]*.00392156862745098,U=O[P+1]*.00392156862745098,B=O[P+2]*.00392156862745098,Y=O[P+3]*.00392156862745098,X=_;X.left;)X=V(X.est,q,U,B,Y)<=0?X.left:X.right;W[P>>2]=X.est.rgba}g[L]=W.buffer}return{bufs:g,plte:M}},x.quantize.getNearest=function(p,y,k,g,R){if(p.left==null)return p.tdst=x.quantize.dist(p.est.q,y,k,g,R),p;var P=x.quantize.planeDst(p.est,y,k,g,R),T=p.left,C=p.right;P>0&&(T=p.right,C=p.left);var a=x.quantize.getNearest(T,y,k,g,R);if(a.tdst<=P*P)return a;var s=x.quantize.getNearest(C,y,k,g,R);return s.tdst<a.tdst?s:a},x.quantize.planeDst=function(p,y,k,g,R){var P=p.e;return P[0]*y+P[1]*k+P[2]*g+P[3]*R-p.eMq},x.quantize.dist=function(p,y,k,g,R){var P=y-p[0],T=k-p[1],C=g-p[2],a=R-p[3];return P*P+T*T+C*C+a*a},x.quantize.splitPixels=function(p,y,k,g,R,P){var T=x.quantize.vecDot;for(g-=4;k<g;){for(;T(p,k,R)<=P;)k+=4;for(;T(p,g,R)>P;)g-=4;if(k>=g)break;var C=y[k>>2];y[k>>2]=y[g>>2],y[g>>2]=C,k+=4,g-=4}for(;T(p,k,R)>P;)k-=4;return k+4},x.quantize.vecDot=function(p,y,k){return p[y]*k[0]+p[y+1]*k[1]+p[y+2]*k[2]+p[y+3]*k[3]},x.quantize.stats=function(p,y,k){for(var g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],R=[0,0,0,0],P=k-y>>2,T=y;T<k;T+=4){var C=p[T]*.00392156862745098,a=p[T+1]*(1/255),s=p[T+2]*(1/255),c=p[T+3]*(1/255);R[0]+=C,R[1]+=a,R[2]+=s,R[3]+=c,g[0]+=C*C,g[1]+=C*a,g[2]+=C*s,g[3]+=C*c,g[5]+=a*a,g[6]+=a*s,g[7]+=a*c,g[10]+=s*s,g[11]+=s*c,g[15]+=c*c}return g[4]=g[1],g[8]=g[2],g[12]=g[3],g[9]=g[6],g[13]=g[7],g[14]=g[11],{R:g,m:R,N:P}},x.quantize.estats=function(p){var y=p.R,k=p.m,g=p.N,R=k[0],P=k[1],T=k[2],C=k[3],a=g==0?0:1/g,s=[y[0]-R*R*a,y[1]-R*P*a,y[2]-R*T*a,y[3]-R*C*a,y[4]-P*R*a,y[5]-P*P*a,y[6]-P*T*a,y[7]-P*C*a,y[8]-T*R*a,y[9]-T*P*a,y[10]-T*T*a,y[11]-T*C*a,y[12]-C*R*a,y[13]-C*P*a,y[14]-C*T*a,y[15]-C*C*a],c=s,w=x.M4,_=[.5,.5,.5,.5],M=0,l=0;if(g!=0)for(var h=0;h<10&&(_=w.multVec(c,_),l=Math.sqrt(w.dot(_,_)),_=w.sml(1/l,_),!(Math.abs(l-M)<1e-9));h++)M=l;var S=[R*a,P*a,T*a,C*a],E=w.dot(w.sml(255,S),_),F=S[3]<.001?0:1/S[3];return{Cov:s,q:S,e:_,L:M,eMq255:E,eMq:w.dot(_,S),rgba:(Math.round(255*S[3])<<24|Math.round(255*S[2]*F)<<16|Math.round(255*S[1]*F)<<8|Math.round(255*S[0]*F)<<0)>>>0}},x.M4={multVec:function(p,y){return[p[0]*y[0]+p[1]*y[1]+p[2]*y[2]+p[3]*y[3],p[4]*y[0]+p[5]*y[1]+p[6]*y[2]+p[7]*y[3],p[8]*y[0]+p[9]*y[1]+p[10]*y[2]+p[11]*y[3],p[12]*y[0]+p[13]*y[1]+p[14]*y[2]+p[15]*y[3]]},dot:function(p,y){return p[0]*y[0]+p[1]*y[1]+p[2]*y[2]+p[3]*y[3]},sml:function(p,y){return[p*y[0],p*y[1],p*y[2],p*y[3]]}},x.encode.alphaMul=function(p,y){for(var k=new Uint8Array(p.length),g=p.length>>2,R=0;R<g;R++){var P=R<<2,T=p[P+3];y&&(T=T<128?0:255);var C=T*(1/255);k[P+0]=p[P+0]*C,k[P+1]=p[P+1]*C,k[P+2]=p[P+2]*C,k[P+3]=T}return k}})(u,v)})()}),"./node_modules/upng-js/node_modules/pako/index.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js").assign,v=r("./node_modules/upng-js/node_modules/pako/lib/deflate.js"),x=r("./node_modules/upng-js/node_modules/pako/lib/inflate.js"),b=r("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),p={};u(p,v,x,b),n.exports=p}),"./node_modules/upng-js/node_modules/pako/lib/deflate.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js"),v=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),x=r("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),b=r("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),p=r("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),y=Object.prototype.toString,k=0,g=4,R=0,P=1,T=2,C=-1,a=0,s=8;function c(l){if(!(this instanceof c))return new c(l);this.options=v.assign({level:C,method:s,chunkSize:16384,windowBits:15,memLevel:8,strategy:a,to:""},l||{});var h=this.options;h.raw&&h.windowBits>0?h.windowBits=-h.windowBits:h.gzip&&h.windowBits>0&&h.windowBits<16&&(h.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var S=u.deflateInit2(this.strm,h.level,h.method,h.windowBits,h.memLevel,h.strategy);if(S!==R)throw new Error(b[S]);if(h.header&&u.deflateSetHeader(this.strm,h.header),h.dictionary){var E;if(typeof h.dictionary=="string"?E=x.string2buf(h.dictionary):y.call(h.dictionary)==="[object ArrayBuffer]"?E=new Uint8Array(h.dictionary):E=h.dictionary,S=u.deflateSetDictionary(this.strm,E),S!==R)throw new Error(b[S]);this._dict_set=!0}}c.prototype.push=function(l,h){var S=this.strm,E=this.options.chunkSize,F,D;if(this.ended)return!1;D=h===~~h?h:h===!0?g:k,typeof l=="string"?S.input=x.string2buf(l):y.call(l)==="[object ArrayBuffer]"?S.input=new Uint8Array(l):S.input=l,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new v.Buf8(E),S.next_out=0,S.avail_out=E),F=u.deflate(S,D),F!==P&&F!==R)return this.onEnd(F),this.ended=!0,!1;(S.avail_out===0||S.avail_in===0&&(D===g||D===T))&&(this.options.to==="string"?this.onData(x.buf2binstring(v.shrinkBuf(S.output,S.next_out))):this.onData(v.shrinkBuf(S.output,S.next_out)))}while((S.avail_in>0||S.avail_out===0)&&F!==P);return D===g?(F=u.deflateEnd(this.strm),this.onEnd(F),this.ended=!0,F===R):(D===T&&(this.onEnd(R),S.avail_out=0),!0)},c.prototype.onData=function(l){this.chunks.push(l)},c.prototype.onEnd=function(l){l===R&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg};function w(l,h){var S=new c(h);if(S.push(l,!0),S.err)throw S.msg||b[S.err];return S.result}function _(l,h){return h=h||{},h.raw=!0,w(l,h)}function M(l,h){return h=h||{},h.gzip=!0,w(l,h)}t.Deflate=c,t.deflate=w,t.deflateRaw=_,t.gzip=M}),"./node_modules/upng-js/node_modules/pako/lib/inflate.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js"),v=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),x=r("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),b=r("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),p=r("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),y=r("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),k=r("./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js"),g=Object.prototype.toString;function R(C){if(!(this instanceof R))return new R(C);this.options=v.assign({chunkSize:16384,windowBits:0,to:""},C||{});var a=this.options;a.raw&&a.windowBits>=0&&a.windowBits<16&&(a.windowBits=-a.windowBits,a.windowBits===0&&(a.windowBits=-15)),a.windowBits>=0&&a.windowBits<16&&!(C&&C.windowBits)&&(a.windowBits+=32),a.windowBits>15&&a.windowBits<48&&(a.windowBits&15||(a.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var s=u.inflateInit2(this.strm,a.windowBits);if(s!==b.Z_OK)throw new Error(p[s]);if(this.header=new k,u.inflateGetHeader(this.strm,this.header),a.dictionary&&(typeof a.dictionary=="string"?a.dictionary=x.string2buf(a.dictionary):g.call(a.dictionary)==="[object ArrayBuffer]"&&(a.dictionary=new Uint8Array(a.dictionary)),a.raw&&(s=u.inflateSetDictionary(this.strm,a.dictionary),s!==b.Z_OK)))throw new Error(p[s])}R.prototype.push=function(C,a){var s=this.strm,c=this.options.chunkSize,w=this.options.dictionary,_,M,l,h,S,E=!1;if(this.ended)return!1;M=a===~~a?a:a===!0?b.Z_FINISH:b.Z_NO_FLUSH,typeof C=="string"?s.input=x.binstring2buf(C):g.call(C)==="[object ArrayBuffer]"?s.input=new Uint8Array(C):s.input=C,s.next_in=0,s.avail_in=s.input.length;do{if(s.avail_out===0&&(s.output=new v.Buf8(c),s.next_out=0,s.avail_out=c),_=u.inflate(s,b.Z_NO_FLUSH),_===b.Z_NEED_DICT&&w&&(_=u.inflateSetDictionary(this.strm,w)),_===b.Z_BUF_ERROR&&E===!0&&(_=b.Z_OK,E=!1),_!==b.Z_STREAM_END&&_!==b.Z_OK)return this.onEnd(_),this.ended=!0,!1;s.next_out&&(s.avail_out===0||_===b.Z_STREAM_END||s.avail_in===0&&(M===b.Z_FINISH||M===b.Z_SYNC_FLUSH))&&(this.options.to==="string"?(l=x.utf8border(s.output,s.next_out),h=s.next_out-l,S=x.buf2string(s.output,l),s.next_out=h,s.avail_out=c-h,h&&v.arraySet(s.output,s.output,l,h,0),this.onData(S)):this.onData(v.shrinkBuf(s.output,s.next_out))),s.avail_in===0&&s.avail_out===0&&(E=!0)}while((s.avail_in>0||s.avail_out===0)&&_!==b.Z_STREAM_END);return _===b.Z_STREAM_END&&(M=b.Z_FINISH),M===b.Z_FINISH?(_=u.inflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===b.Z_OK):(M===b.Z_SYNC_FLUSH&&(this.onEnd(b.Z_OK),s.avail_out=0),!0)},R.prototype.onData=function(C){this.chunks.push(C)},R.prototype.onEnd=function(C){C===b.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=C,this.msg=this.strm.msg};function P(C,a){var s=new R(a);if(s.push(C,!0),s.err)throw s.msg||p[s.err];return s.result}function T(C,a){return a=a||{},a.raw=!0,P(C,a)}t.Inflate=R,t.inflate=P,t.inflateRaw=T,t.ungzip=P}),"./node_modules/upng-js/node_modules/pako/lib/utils/common.js":((n,t)=>{var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function u(b,p){return Object.prototype.hasOwnProperty.call(b,p)}t.assign=function(b){for(var p=Array.prototype.slice.call(arguments,1);p.length;){var y=p.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(var k in y)u(y,k)&&(b[k]=y[k])}}return b},t.shrinkBuf=function(b,p){return b.length===p?b:b.subarray?b.subarray(0,p):(b.length=p,b)};var v={arraySet:function(b,p,y,k,g){if(p.subarray&&b.subarray){b.set(p.subarray(y,y+k),g);return}for(var R=0;R<k;R++)b[g+R]=p[y+R]},flattenChunks:function(b){var p,y,k,g,R,P;for(k=0,p=0,y=b.length;p<y;p++)k+=b[p].length;for(P=new Uint8Array(k),g=0,p=0,y=b.length;p<y;p++)R=b[p],P.set(R,g),g+=R.length;return P}},x={arraySet:function(b,p,y,k,g){for(var R=0;R<k;R++)b[g+R]=p[y+R]},flattenChunks:function(b){return[].concat.apply([],b)}};t.setTyped=function(b){b?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,v)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,x))},t.setTyped(r)}),"./node_modules/upng-js/node_modules/pako/lib/utils/strings.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),v=!0,x=!0;try{String.fromCharCode.apply(null,[0])}catch{v=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{x=!1}for(var b=new u.Buf8(256),p=0;p<256;p++)b[p]=p>=252?6:p>=248?5:p>=240?4:p>=224?3:p>=192?2:1;b[254]=b[254]=1,t.string2buf=function(k){var g,R,P,T,C,a=k.length,s=0;for(T=0;T<a;T++)R=k.charCodeAt(T),(R&64512)===55296&&T+1<a&&(P=k.charCodeAt(T+1),(P&64512)===56320&&(R=65536+(R-55296<<10)+(P-56320),T++)),s+=R<128?1:R<2048?2:R<65536?3:4;for(g=new u.Buf8(s),C=0,T=0;C<s;T++)R=k.charCodeAt(T),(R&64512)===55296&&T+1<a&&(P=k.charCodeAt(T+1),(P&64512)===56320&&(R=65536+(R-55296<<10)+(P-56320),T++)),R<128?g[C++]=R:R<2048?(g[C++]=192|R>>>6,g[C++]=128|R&63):R<65536?(g[C++]=224|R>>>12,g[C++]=128|R>>>6&63,g[C++]=128|R&63):(g[C++]=240|R>>>18,g[C++]=128|R>>>12&63,g[C++]=128|R>>>6&63,g[C++]=128|R&63);return g};function y(k,g){if(g<65534&&(k.subarray&&x||!k.subarray&&v))return String.fromCharCode.apply(null,u.shrinkBuf(k,g));for(var R="",P=0;P<g;P++)R+=String.fromCharCode(k[P]);return R}t.buf2binstring=function(k){return y(k,k.length)},t.binstring2buf=function(k){for(var g=new u.Buf8(k.length),R=0,P=g.length;R<P;R++)g[R]=k.charCodeAt(R);return g},t.buf2string=function(k,g){var R,P,T,C,a=g||k.length,s=new Array(a*2);for(P=0,R=0;R<a;){if(T=k[R++],T<128){s[P++]=T;continue}if(C=b[T],C>4){s[P++]=65533,R+=C-1;continue}for(T&=C===2?31:C===3?15:7;C>1&&R<a;)T=T<<6|k[R++]&63,C--;if(C>1){s[P++]=65533;continue}T<65536?s[P++]=T:(T-=65536,s[P++]=55296|T>>10&1023,s[P++]=56320|T&1023)}return y(s,P)},t.utf8border=function(k,g){var R;for(g=g||k.length,g>k.length&&(g=k.length),R=g-1;R>=0&&(k[R]&192)===128;)R--;return R<0||R===0?g:R+b[k[R]]>g?R:g}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js":(n=>{function t(r,u,v,x){for(var b=r&65535|0,p=r>>>16&65535|0,y=0;v!==0;){y=v>2e3?2e3:v,v-=y;do b=b+u[x++]|0,p=p+b|0;while(--y);b%=65521,p%=65521}return b|p<<16|0}n.exports=t}),"./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js":(n=>{n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js":(n=>{function t(){for(var v,x=[],b=0;b<256;b++){v=b;for(var p=0;p<8;p++)v=v&1?3988292384^v>>>1:v>>>1;x[b]=v}return x}var r=t();function u(v,x,b,p){var y=r,k=p+b;v^=-1;for(var g=p;g<k;g++)v=v>>>8^y[(v^x[g])&255];return v^-1}n.exports=u}),"./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),v=r("./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js"),x=r("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),b=r("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),p=r("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),y=0,k=1,g=3,R=4,P=5,T=0,C=1,a=-2,s=-3,c=-5,w=-1,_=1,M=2,l=3,h=4,S=0,E=2,F=8,D=9,L=15,V=8,O=29,W=256,H=W+1+O,q=30,U=19,B=2*H+1,Y=15,X=3,N=258,J=N+X+1,ae=32,se=42,he=69,pe=73,de=91,ue=103,ge=113,Re=666,Ge=1,We=2,Oe=3,me=4,Fe=3;function qe(G,Te){return G.msg=p[Te],Te}function Qe(G){return(G<<1)-(G>4?9:0)}function st(G){for(var Te=G.length;--Te>=0;)G[Te]=0}function ot(G){var Te=G.state,Ee=Te.pending;Ee>G.avail_out&&(Ee=G.avail_out),Ee!==0&&(u.arraySet(G.output,Te.pending_buf,Te.pending_out,Ee,G.next_out),G.next_out+=Ee,Te.pending_out+=Ee,G.total_out+=Ee,G.avail_out-=Ee,Te.pending-=Ee,Te.pending===0&&(Te.pending_out=0))}function Ke(G,Te){v._tr_flush_block(G,G.block_start>=0?G.block_start:-1,G.strstart-G.block_start,Te),G.block_start=G.strstart,ot(G.strm)}function Je(G,Te){G.pending_buf[G.pending++]=Te}function Xe(G,Te){G.pending_buf[G.pending++]=Te>>>8&255,G.pending_buf[G.pending++]=Te&255}function Ne(G,Te,Ee,re){var ve=G.avail_in;return ve>re&&(ve=re),ve===0?0:(G.avail_in-=ve,u.arraySet(Te,G.input,G.next_in,ve,Ee),G.state.wrap===1?G.adler=x(G.adler,Te,ve,Ee):G.state.wrap===2&&(G.adler=b(G.adler,Te,ve,Ee)),G.next_in+=ve,G.total_in+=ve,ve)}function Ue(G,Te){var Ee=G.max_chain_length,re=G.strstart,ve,ke,ct=G.prev_length,lt=G.nice_match,dt=G.strstart>G.w_size-J?G.strstart-(G.w_size-J):0,yt=G.window,ir=G.w_mask,At=G.prev,Mt=G.strstart+N,Pt=yt[re+ct-1],Qt=yt[re+ct];G.prev_length>=G.good_match&&(Ee>>=2),lt>G.lookahead&&(lt=G.lookahead);do if(ve=Te,!(yt[ve+ct]!==Qt||yt[ve+ct-1]!==Pt||yt[ve]!==yt[re]||yt[++ve]!==yt[re+1])){re+=2,ve++;do;while(yt[++re]===yt[++ve]&&yt[++re]===yt[++ve]&&yt[++re]===yt[++ve]&&yt[++re]===yt[++ve]&&yt[++re]===yt[++ve]&&yt[++re]===yt[++ve]&&yt[++re]===yt[++ve]&&yt[++re]===yt[++ve]&&re<Mt);if(ke=N-(Mt-re),re=Mt-N,ke>ct){if(G.match_start=Te,ct=ke,ke>=lt)break;Pt=yt[re+ct-1],Qt=yt[re+ct]}}while((Te=At[Te&ir])>dt&&--Ee!==0);return ct<=G.lookahead?ct:G.lookahead}function ft(G){var Te=G.w_size,Ee,re,ve,ke,ct;do{if(ke=G.window_size-G.lookahead-G.strstart,G.strstart>=Te+(Te-J)){u.arraySet(G.window,G.window,Te,Te,0),G.match_start-=Te,G.strstart-=Te,G.block_start-=Te,re=G.hash_size,Ee=re;do ve=G.head[--Ee],G.head[Ee]=ve>=Te?ve-Te:0;while(--re);re=Te,Ee=re;do ve=G.prev[--Ee],G.prev[Ee]=ve>=Te?ve-Te:0;while(--re);ke+=Te}if(G.strm.avail_in===0)break;if(re=Ne(G.strm,G.window,G.strstart+G.lookahead,ke),G.lookahead+=re,G.lookahead+G.insert>=X)for(ct=G.strstart-G.insert,G.ins_h=G.window[ct],G.ins_h=(G.ins_h<<G.hash_shift^G.window[ct+1])&G.hash_mask;G.insert&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[ct+X-1])&G.hash_mask,G.prev[ct&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=ct,ct++,G.insert--,!(G.lookahead+G.insert<X)););}while(G.lookahead<J&&G.strm.avail_in!==0)}function ut(G,Te){var Ee=65535;for(Ee>G.pending_buf_size-5&&(Ee=G.pending_buf_size-5);;){if(G.lookahead<=1){if(ft(G),G.lookahead===0&&Te===y)return Ge;if(G.lookahead===0)break}G.strstart+=G.lookahead,G.lookahead=0;var re=G.block_start+Ee;if((G.strstart===0||G.strstart>=re)&&(G.lookahead=G.strstart-re,G.strstart=re,Ke(G,!1),G.strm.avail_out===0)||G.strstart-G.block_start>=G.w_size-J&&(Ke(G,!1),G.strm.avail_out===0))return Ge}return G.insert=0,Te===R?(Ke(G,!0),G.strm.avail_out===0?Oe:me):(G.strstart>G.block_start&&(Ke(G,!1),G.strm.avail_out),Ge)}function ee(G,Te){for(var Ee,re;;){if(G.lookahead<J){if(ft(G),G.lookahead<J&&Te===y)return Ge;if(G.lookahead===0)break}if(Ee=0,G.lookahead>=X&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+X-1])&G.hash_mask,Ee=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),Ee!==0&&G.strstart-Ee<=G.w_size-J&&(G.match_length=Ue(G,Ee)),G.match_length>=X)if(re=v._tr_tally(G,G.strstart-G.match_start,G.match_length-X),G.lookahead-=G.match_length,G.match_length<=G.max_lazy_match&&G.lookahead>=X){G.match_length--;do G.strstart++,G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+X-1])&G.hash_mask,Ee=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart;while(--G.match_length!==0);G.strstart++}else G.strstart+=G.match_length,G.match_length=0,G.ins_h=G.window[G.strstart],G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+1])&G.hash_mask;else re=v._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++;if(re&&(Ke(G,!1),G.strm.avail_out===0))return Ge}return G.insert=G.strstart<X-1?G.strstart:X-1,Te===R?(Ke(G,!0),G.strm.avail_out===0?Oe:me):G.last_lit&&(Ke(G,!1),G.strm.avail_out===0)?Ge:We}function ie(G,Te){for(var Ee,re,ve;;){if(G.lookahead<J){if(ft(G),G.lookahead<J&&Te===y)return Ge;if(G.lookahead===0)break}if(Ee=0,G.lookahead>=X&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+X-1])&G.hash_mask,Ee=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),G.prev_length=G.match_length,G.prev_match=G.match_start,G.match_length=X-1,Ee!==0&&G.prev_length<G.max_lazy_match&&G.strstart-Ee<=G.w_size-J&&(G.match_length=Ue(G,Ee),G.match_length<=5&&(G.strategy===_||G.match_length===X&&G.strstart-G.match_start>4096)&&(G.match_length=X-1)),G.prev_length>=X&&G.match_length<=G.prev_length){ve=G.strstart+G.lookahead-X,re=v._tr_tally(G,G.strstart-1-G.prev_match,G.prev_length-X),G.lookahead-=G.prev_length-1,G.prev_length-=2;do++G.strstart<=ve&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+X-1])&G.hash_mask,Ee=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart);while(--G.prev_length!==0);if(G.match_available=0,G.match_length=X-1,G.strstart++,re&&(Ke(G,!1),G.strm.avail_out===0))return Ge}else if(G.match_available){if(re=v._tr_tally(G,0,G.window[G.strstart-1]),re&&Ke(G,!1),G.strstart++,G.lookahead--,G.strm.avail_out===0)return Ge}else G.match_available=1,G.strstart++,G.lookahead--}return G.match_available&&(re=v._tr_tally(G,0,G.window[G.strstart-1]),G.match_available=0),G.insert=G.strstart<X-1?G.strstart:X-1,Te===R?(Ke(G,!0),G.strm.avail_out===0?Oe:me):G.last_lit&&(Ke(G,!1),G.strm.avail_out===0)?Ge:We}function oe(G,Te){for(var Ee,re,ve,ke,ct=G.window;;){if(G.lookahead<=N){if(ft(G),G.lookahead<=N&&Te===y)return Ge;if(G.lookahead===0)break}if(G.match_length=0,G.lookahead>=X&&G.strstart>0&&(ve=G.strstart-1,re=ct[ve],re===ct[++ve]&&re===ct[++ve]&&re===ct[++ve])){ke=G.strstart+N;do;while(re===ct[++ve]&&re===ct[++ve]&&re===ct[++ve]&&re===ct[++ve]&&re===ct[++ve]&&re===ct[++ve]&&re===ct[++ve]&&re===ct[++ve]&&ve<ke);G.match_length=N-(ke-ve),G.match_length>G.lookahead&&(G.match_length=G.lookahead)}if(G.match_length>=X?(Ee=v._tr_tally(G,1,G.match_length-X),G.lookahead-=G.match_length,G.strstart+=G.match_length,G.match_length=0):(Ee=v._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++),Ee&&(Ke(G,!1),G.strm.avail_out===0))return Ge}return G.insert=0,Te===R?(Ke(G,!0),G.strm.avail_out===0?Oe:me):G.last_lit&&(Ke(G,!1),G.strm.avail_out===0)?Ge:We}function we(G,Te){for(var Ee;;){if(G.lookahead===0&&(ft(G),G.lookahead===0)){if(Te===y)return Ge;break}if(G.match_length=0,Ee=v._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++,Ee&&(Ke(G,!1),G.strm.avail_out===0))return Ge}return G.insert=0,Te===R?(Ke(G,!0),G.strm.avail_out===0?Oe:me):G.last_lit&&(Ke(G,!1),G.strm.avail_out===0)?Ge:We}function Se(G,Te,Ee,re,ve){this.good_length=G,this.max_lazy=Te,this.nice_length=Ee,this.max_chain=re,this.func=ve}var He;He=[new Se(0,0,0,0,ut),new Se(4,4,8,4,ee),new Se(4,5,16,8,ee),new Se(4,6,32,32,ee),new Se(4,4,16,16,ie),new Se(8,16,32,32,ie),new Se(8,16,128,128,ie),new Se(8,32,128,256,ie),new Se(32,128,258,1024,ie),new Se(32,258,258,4096,ie)];function Be(G){G.window_size=2*G.w_size,st(G.head),G.max_lazy_match=He[G.level].max_lazy,G.good_match=He[G.level].good_length,G.nice_match=He[G.level].nice_length,G.max_chain_length=He[G.level].max_chain,G.strstart=0,G.block_start=0,G.lookahead=0,G.insert=0,G.match_length=G.prev_length=X-1,G.match_available=0,G.ins_h=0}function K(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=F,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new u.Buf16(B*2),this.dyn_dtree=new u.Buf16((2*q+1)*2),this.bl_tree=new u.Buf16((2*U+1)*2),st(this.dyn_ltree),st(this.dyn_dtree),st(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new u.Buf16(Y+1),this.heap=new u.Buf16(2*H+1),st(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new u.Buf16(2*H+1),st(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function xe(G){var Te;return!G||!G.state?qe(G,a):(G.total_in=G.total_out=0,G.data_type=E,Te=G.state,Te.pending=0,Te.pending_out=0,Te.wrap<0&&(Te.wrap=-Te.wrap),Te.status=Te.wrap?se:ge,G.adler=Te.wrap===2?0:1,Te.last_flush=y,v._tr_init(Te),T)}function Me(G){var Te=xe(G);return Te===T&&Be(G.state),Te}function $e(G,Te){return!G||!G.state||G.state.wrap!==2?a:(G.state.gzhead=Te,T)}function ye(G,Te,Ee,re,ve,ke){if(!G)return a;var ct=1;if(Te===w&&(Te=6),re<0?(ct=0,re=-re):re>15&&(ct=2,re-=16),ve<1||ve>D||Ee!==F||re<8||re>15||Te<0||Te>9||ke<0||ke>h)return qe(G,a);re===8&&(re=9);var lt=new K;return G.state=lt,lt.strm=G,lt.wrap=ct,lt.gzhead=null,lt.w_bits=re,lt.w_size=1<<lt.w_bits,lt.w_mask=lt.w_size-1,lt.hash_bits=ve+7,lt.hash_size=1<<lt.hash_bits,lt.hash_mask=lt.hash_size-1,lt.hash_shift=~~((lt.hash_bits+X-1)/X),lt.window=new u.Buf8(lt.w_size*2),lt.head=new u.Buf16(lt.hash_size),lt.prev=new u.Buf16(lt.w_size),lt.lit_bufsize=1<<ve+6,lt.pending_buf_size=lt.lit_bufsize*4,lt.pending_buf=new u.Buf8(lt.pending_buf_size),lt.d_buf=1*lt.lit_bufsize,lt.l_buf=3*lt.lit_bufsize,lt.level=Te,lt.strategy=ke,lt.method=Ee,Me(G)}function je(G,Te){return ye(G,Te,F,L,V,S)}function Z(G,Te){var Ee,re,ve,ke;if(!G||!G.state||Te>P||Te<0)return G?qe(G,a):a;if(re=G.state,!G.output||!G.input&&G.avail_in!==0||re.status===Re&&Te!==R)return qe(G,G.avail_out===0?c:a);if(re.strm=G,Ee=re.last_flush,re.last_flush=Te,re.status===se)if(re.wrap===2)G.adler=0,Je(re,31),Je(re,139),Je(re,8),re.gzhead?(Je(re,(re.gzhead.text?1:0)+(re.gzhead.hcrc?2:0)+(re.gzhead.extra?4:0)+(re.gzhead.name?8:0)+(re.gzhead.comment?16:0)),Je(re,re.gzhead.time&255),Je(re,re.gzhead.time>>8&255),Je(re,re.gzhead.time>>16&255),Je(re,re.gzhead.time>>24&255),Je(re,re.level===9?2:re.strategy>=M||re.level<2?4:0),Je(re,re.gzhead.os&255),re.gzhead.extra&&re.gzhead.extra.length&&(Je(re,re.gzhead.extra.length&255),Je(re,re.gzhead.extra.length>>8&255)),re.gzhead.hcrc&&(G.adler=b(G.adler,re.pending_buf,re.pending,0)),re.gzindex=0,re.status=he):(Je(re,0),Je(re,0),Je(re,0),Je(re,0),Je(re,0),Je(re,re.level===9?2:re.strategy>=M||re.level<2?4:0),Je(re,Fe),re.status=ge);else{var ct=F+(re.w_bits-8<<4)<<8,lt=-1;re.strategy>=M||re.level<2?lt=0:re.level<6?lt=1:re.level===6?lt=2:lt=3,ct|=lt<<6,re.strstart!==0&&(ct|=ae),ct+=31-ct%31,re.status=ge,Xe(re,ct),re.strstart!==0&&(Xe(re,G.adler>>>16),Xe(re,G.adler&65535)),G.adler=1}if(re.status===he)if(re.gzhead.extra){for(ve=re.pending;re.gzindex<(re.gzhead.extra.length&65535)&&!(re.pending===re.pending_buf_size&&(re.gzhead.hcrc&&re.pending>ve&&(G.adler=b(G.adler,re.pending_buf,re.pending-ve,ve)),ot(G),ve=re.pending,re.pending===re.pending_buf_size));)Je(re,re.gzhead.extra[re.gzindex]&255),re.gzindex++;re.gzhead.hcrc&&re.pending>ve&&(G.adler=b(G.adler,re.pending_buf,re.pending-ve,ve)),re.gzindex===re.gzhead.extra.length&&(re.gzindex=0,re.status=pe)}else re.status=pe;if(re.status===pe)if(re.gzhead.name){ve=re.pending;do{if(re.pending===re.pending_buf_size&&(re.gzhead.hcrc&&re.pending>ve&&(G.adler=b(G.adler,re.pending_buf,re.pending-ve,ve)),ot(G),ve=re.pending,re.pending===re.pending_buf_size)){ke=1;break}re.gzindex<re.gzhead.name.length?ke=re.gzhead.name.charCodeAt(re.gzindex++)&255:ke=0,Je(re,ke)}while(ke!==0);re.gzhead.hcrc&&re.pending>ve&&(G.adler=b(G.adler,re.pending_buf,re.pending-ve,ve)),ke===0&&(re.gzindex=0,re.status=de)}else re.status=de;if(re.status===de)if(re.gzhead.comment){ve=re.pending;do{if(re.pending===re.pending_buf_size&&(re.gzhead.hcrc&&re.pending>ve&&(G.adler=b(G.adler,re.pending_buf,re.pending-ve,ve)),ot(G),ve=re.pending,re.pending===re.pending_buf_size)){ke=1;break}re.gzindex<re.gzhead.comment.length?ke=re.gzhead.comment.charCodeAt(re.gzindex++)&255:ke=0,Je(re,ke)}while(ke!==0);re.gzhead.hcrc&&re.pending>ve&&(G.adler=b(G.adler,re.pending_buf,re.pending-ve,ve)),ke===0&&(re.status=ue)}else re.status=ue;if(re.status===ue&&(re.gzhead.hcrc?(re.pending+2>re.pending_buf_size&&ot(G),re.pending+2<=re.pending_buf_size&&(Je(re,G.adler&255),Je(re,G.adler>>8&255),G.adler=0,re.status=ge)):re.status=ge),re.pending!==0){if(ot(G),G.avail_out===0)return re.last_flush=-1,T}else if(G.avail_in===0&&Qe(Te)<=Qe(Ee)&&Te!==R)return qe(G,c);if(re.status===Re&&G.avail_in!==0)return qe(G,c);if(G.avail_in!==0||re.lookahead!==0||Te!==y&&re.status!==Re){var dt=re.strategy===M?we(re,Te):re.strategy===l?oe(re,Te):He[re.level].func(re,Te);if((dt===Oe||dt===me)&&(re.status=Re),dt===Ge||dt===Oe)return G.avail_out===0&&(re.last_flush=-1),T;if(dt===We&&(Te===k?v._tr_align(re):Te!==P&&(v._tr_stored_block(re,0,0,!1),Te===g&&(st(re.head),re.lookahead===0&&(re.strstart=0,re.block_start=0,re.insert=0))),ot(G),G.avail_out===0))return re.last_flush=-1,T}return Te!==R?T:re.wrap<=0?C:(re.wrap===2?(Je(re,G.adler&255),Je(re,G.adler>>8&255),Je(re,G.adler>>16&255),Je(re,G.adler>>24&255),Je(re,G.total_in&255),Je(re,G.total_in>>8&255),Je(re,G.total_in>>16&255),Je(re,G.total_in>>24&255)):(Xe(re,G.adler>>>16),Xe(re,G.adler&65535)),ot(G),re.wrap>0&&(re.wrap=-re.wrap),re.pending!==0?T:C)}function De(G){var Te;return!G||!G.state?a:(Te=G.state.status,Te!==se&&Te!==he&&Te!==pe&&Te!==de&&Te!==ue&&Te!==ge&&Te!==Re?qe(G,a):(G.state=null,Te===ge?qe(G,s):T))}function rt(G,Te){var Ee=Te.length,re,ve,ke,ct,lt,dt,yt,ir;if(!G||!G.state||(re=G.state,ct=re.wrap,ct===2||ct===1&&re.status!==se||re.lookahead))return a;for(ct===1&&(G.adler=x(G.adler,Te,Ee,0)),re.wrap=0,Ee>=re.w_size&&(ct===0&&(st(re.head),re.strstart=0,re.block_start=0,re.insert=0),ir=new u.Buf8(re.w_size),u.arraySet(ir,Te,Ee-re.w_size,re.w_size,0),Te=ir,Ee=re.w_size),lt=G.avail_in,dt=G.next_in,yt=G.input,G.avail_in=Ee,G.next_in=0,G.input=Te,ft(re);re.lookahead>=X;){ve=re.strstart,ke=re.lookahead-(X-1);do re.ins_h=(re.ins_h<<re.hash_shift^re.window[ve+X-1])&re.hash_mask,re.prev[ve&re.w_mask]=re.head[re.ins_h],re.head[re.ins_h]=ve,ve++;while(--ke);re.strstart=ve,re.lookahead=X-1,ft(re)}return re.strstart+=re.lookahead,re.block_start=re.strstart,re.insert=re.lookahead,re.lookahead=0,re.match_length=re.prev_length=X-1,re.match_available=0,G.next_in=dt,G.input=yt,G.avail_in=lt,re.wrap=ct,T}t.deflateInit=je,t.deflateInit2=ye,t.deflateReset=Me,t.deflateResetKeep=xe,t.deflateSetHeader=$e,t.deflate=Z,t.deflateEnd=De,t.deflateSetDictionary=rt,t.deflateInfo="pako deflate (from Nodeca project)"}),"./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js":(n=>{function t(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}n.exports=t}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js":(n=>{var t=30,r=12;n.exports=function(u,v){var x,b,p,y,k,g,R,P,T,C,a,s,c,w,_,M,l,h,S,E,F,D,L,V,O;x=u.state,b=u.next_in,V=u.input,p=b+(u.avail_in-5),y=u.next_out,O=u.output,k=y-(v-u.avail_out),g=y+(u.avail_out-257),R=x.dmax,P=x.wsize,T=x.whave,C=x.wnext,a=x.window,s=x.hold,c=x.bits,w=x.lencode,_=x.distcode,M=(1<<x.lenbits)-1,l=(1<<x.distbits)-1;e:do{c<15&&(s+=V[b++]<<c,c+=8,s+=V[b++]<<c,c+=8),h=w[s&M];t:for(;;){if(S=h>>>24,s>>>=S,c-=S,S=h>>>16&255,S===0)O[y++]=h&65535;else if(S&16){E=h&65535,S&=15,S&&(c<S&&(s+=V[b++]<<c,c+=8),E+=s&(1<<S)-1,s>>>=S,c-=S),c<15&&(s+=V[b++]<<c,c+=8,s+=V[b++]<<c,c+=8),h=_[s&l];r:for(;;){if(S=h>>>24,s>>>=S,c-=S,S=h>>>16&255,S&16){if(F=h&65535,S&=15,c<S&&(s+=V[b++]<<c,c+=8,c<S&&(s+=V[b++]<<c,c+=8)),F+=s&(1<<S)-1,F>R){u.msg="invalid distance too far back",x.mode=t;break e}if(s>>>=S,c-=S,S=y-k,F>S){if(S=F-S,S>T&&x.sane){u.msg="invalid distance too far back",x.mode=t;break e}if(D=0,L=a,C===0){if(D+=P-S,S<E){E-=S;do O[y++]=a[D++];while(--S);D=y-F,L=O}}else if(C<S){if(D+=P+C-S,S-=C,S<E){E-=S;do O[y++]=a[D++];while(--S);if(D=0,C<E){S=C,E-=S;do O[y++]=a[D++];while(--S);D=y-F,L=O}}}else if(D+=C-S,S<E){E-=S;do O[y++]=a[D++];while(--S);D=y-F,L=O}for(;E>2;)O[y++]=L[D++],O[y++]=L[D++],O[y++]=L[D++],E-=3;E&&(O[y++]=L[D++],E>1&&(O[y++]=L[D++]))}else{D=y-F;do O[y++]=O[D++],O[y++]=O[D++],O[y++]=O[D++],E-=3;while(E>2);E&&(O[y++]=O[D++],E>1&&(O[y++]=O[D++]))}}else if(S&64){u.msg="invalid distance code",x.mode=t;break e}else{h=_[(h&65535)+(s&(1<<S)-1)];continue r}break}}else if(S&64)if(S&32){x.mode=r;break e}else{u.msg="invalid literal/length code",x.mode=t;break e}else{h=w[(h&65535)+(s&(1<<S)-1)];continue t}break}}while(b<p&&y<g);E=c>>3,b-=E,c-=E<<3,s&=(1<<c)-1,u.next_in=b,u.next_out=y,u.avail_in=b<p?5+(p-b):5-(b-p),u.avail_out=y<g?257+(g-y):257-(y-g),x.hold=s,x.bits=c}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),v=r("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),x=r("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),b=r("./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js"),p=r("./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js"),y=0,k=1,g=2,R=4,P=5,T=6,C=0,a=1,s=2,c=-2,w=-3,_=-4,M=-5,l=8,h=1,S=2,E=3,F=4,D=5,L=6,V=7,O=8,W=9,H=10,q=11,U=12,B=13,Y=14,X=15,N=16,J=17,ae=18,se=19,he=20,pe=21,de=22,ue=23,ge=24,Re=25,Ge=26,We=27,Oe=28,me=29,Fe=30,qe=31,Qe=32,st=852,ot=592,Ke=15,Je=Ke;function Xe(ye){return(ye>>>24&255)+(ye>>>8&65280)+((ye&65280)<<8)+((ye&255)<<24)}function Ne(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new u.Buf16(320),this.work=new u.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Ue(ye){var je;return!ye||!ye.state?c:(je=ye.state,ye.total_in=ye.total_out=je.total=0,ye.msg="",je.wrap&&(ye.adler=je.wrap&1),je.mode=h,je.last=0,je.havedict=0,je.dmax=32768,je.head=null,je.hold=0,je.bits=0,je.lencode=je.lendyn=new u.Buf32(st),je.distcode=je.distdyn=new u.Buf32(ot),je.sane=1,je.back=-1,C)}function ft(ye){var je;return!ye||!ye.state?c:(je=ye.state,je.wsize=0,je.whave=0,je.wnext=0,Ue(ye))}function ut(ye,je){var Z,De;return!ye||!ye.state||(De=ye.state,je<0?(Z=0,je=-je):(Z=(je>>4)+1,je<48&&(je&=15)),je&&(je<8||je>15))?c:(De.window!==null&&De.wbits!==je&&(De.window=null),De.wrap=Z,De.wbits=je,ft(ye))}function ee(ye,je){var Z,De;return ye?(De=new Ne,ye.state=De,De.window=null,Z=ut(ye,je),Z!==C&&(ye.state=null),Z):c}function ie(ye){return ee(ye,Je)}var oe=!0,we,Se;function He(ye){if(oe){var je;for(we=new u.Buf32(512),Se=new u.Buf32(32),je=0;je<144;)ye.lens[je++]=8;for(;je<256;)ye.lens[je++]=9;for(;je<280;)ye.lens[je++]=7;for(;je<288;)ye.lens[je++]=8;for(p(k,ye.lens,0,288,we,0,ye.work,{bits:9}),je=0;je<32;)ye.lens[je++]=5;p(g,ye.lens,0,32,Se,0,ye.work,{bits:5}),oe=!1}ye.lencode=we,ye.lenbits=9,ye.distcode=Se,ye.distbits=5}function Be(ye,je,Z,De){var rt,G=ye.state;return G.window===null&&(G.wsize=1<<G.wbits,G.wnext=0,G.whave=0,G.window=new u.Buf8(G.wsize)),De>=G.wsize?(u.arraySet(G.window,je,Z-G.wsize,G.wsize,0),G.wnext=0,G.whave=G.wsize):(rt=G.wsize-G.wnext,rt>De&&(rt=De),u.arraySet(G.window,je,Z-De,rt,G.wnext),De-=rt,De?(u.arraySet(G.window,je,Z-De,De,0),G.wnext=De,G.whave=G.wsize):(G.wnext+=rt,G.wnext===G.wsize&&(G.wnext=0),G.whave<G.wsize&&(G.whave+=rt))),0}function K(ye,je){var Z,De,rt,G,Te,Ee,re,ve,ke,ct,lt,dt,yt,ir,At=0,Mt,Pt,Qt,Kt,Kr,ai,Lt,Wt,qt=new u.Buf8(4),wr,dr,Nr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ye||!ye.state||!ye.output||!ye.input&&ye.avail_in!==0)return c;Z=ye.state,Z.mode===U&&(Z.mode=B),Te=ye.next_out,rt=ye.output,re=ye.avail_out,G=ye.next_in,De=ye.input,Ee=ye.avail_in,ve=Z.hold,ke=Z.bits,ct=Ee,lt=re,Wt=C;e:for(;;)switch(Z.mode){case h:if(Z.wrap===0){Z.mode=B;break}for(;ke<16;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}if(Z.wrap&2&&ve===35615){Z.check=0,qt[0]=ve&255,qt[1]=ve>>>8&255,Z.check=x(Z.check,qt,2,0),ve=0,ke=0,Z.mode=S;break}if(Z.flags=0,Z.head&&(Z.head.done=!1),!(Z.wrap&1)||(((ve&255)<<8)+(ve>>8))%31){ye.msg="incorrect header check",Z.mode=Fe;break}if((ve&15)!==l){ye.msg="unknown compression method",Z.mode=Fe;break}if(ve>>>=4,ke-=4,Lt=(ve&15)+8,Z.wbits===0)Z.wbits=Lt;else if(Lt>Z.wbits){ye.msg="invalid window size",Z.mode=Fe;break}Z.dmax=1<<Lt,ye.adler=Z.check=1,Z.mode=ve&512?H:U,ve=0,ke=0;break;case S:for(;ke<16;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}if(Z.flags=ve,(Z.flags&255)!==l){ye.msg="unknown compression method",Z.mode=Fe;break}if(Z.flags&57344){ye.msg="unknown header flags set",Z.mode=Fe;break}Z.head&&(Z.head.text=ve>>8&1),Z.flags&512&&(qt[0]=ve&255,qt[1]=ve>>>8&255,Z.check=x(Z.check,qt,2,0)),ve=0,ke=0,Z.mode=E;case E:for(;ke<32;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}Z.head&&(Z.head.time=ve),Z.flags&512&&(qt[0]=ve&255,qt[1]=ve>>>8&255,qt[2]=ve>>>16&255,qt[3]=ve>>>24&255,Z.check=x(Z.check,qt,4,0)),ve=0,ke=0,Z.mode=F;case F:for(;ke<16;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}Z.head&&(Z.head.xflags=ve&255,Z.head.os=ve>>8),Z.flags&512&&(qt[0]=ve&255,qt[1]=ve>>>8&255,Z.check=x(Z.check,qt,2,0)),ve=0,ke=0,Z.mode=D;case D:if(Z.flags&1024){for(;ke<16;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}Z.length=ve,Z.head&&(Z.head.extra_len=ve),Z.flags&512&&(qt[0]=ve&255,qt[1]=ve>>>8&255,Z.check=x(Z.check,qt,2,0)),ve=0,ke=0}else Z.head&&(Z.head.extra=null);Z.mode=L;case L:if(Z.flags&1024&&(dt=Z.length,dt>Ee&&(dt=Ee),dt&&(Z.head&&(Lt=Z.head.extra_len-Z.length,Z.head.extra||(Z.head.extra=new Array(Z.head.extra_len)),u.arraySet(Z.head.extra,De,G,dt,Lt)),Z.flags&512&&(Z.check=x(Z.check,De,dt,G)),Ee-=dt,G+=dt,Z.length-=dt),Z.length))break e;Z.length=0,Z.mode=V;case V:if(Z.flags&2048){if(Ee===0)break e;dt=0;do Lt=De[G+dt++],Z.head&&Lt&&Z.length<65536&&(Z.head.name+=String.fromCharCode(Lt));while(Lt&&dt<Ee);if(Z.flags&512&&(Z.check=x(Z.check,De,dt,G)),Ee-=dt,G+=dt,Lt)break e}else Z.head&&(Z.head.name=null);Z.length=0,Z.mode=O;case O:if(Z.flags&4096){if(Ee===0)break e;dt=0;do Lt=De[G+dt++],Z.head&&Lt&&Z.length<65536&&(Z.head.comment+=String.fromCharCode(Lt));while(Lt&&dt<Ee);if(Z.flags&512&&(Z.check=x(Z.check,De,dt,G)),Ee-=dt,G+=dt,Lt)break e}else Z.head&&(Z.head.comment=null);Z.mode=W;case W:if(Z.flags&512){for(;ke<16;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}if(ve!==(Z.check&65535)){ye.msg="header crc mismatch",Z.mode=Fe;break}ve=0,ke=0}Z.head&&(Z.head.hcrc=Z.flags>>9&1,Z.head.done=!0),ye.adler=Z.check=0,Z.mode=U;break;case H:for(;ke<32;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}ye.adler=Z.check=Xe(ve),ve=0,ke=0,Z.mode=q;case q:if(Z.havedict===0)return ye.next_out=Te,ye.avail_out=re,ye.next_in=G,ye.avail_in=Ee,Z.hold=ve,Z.bits=ke,s;ye.adler=Z.check=1,Z.mode=U;case U:if(je===P||je===T)break e;case B:if(Z.last){ve>>>=ke&7,ke-=ke&7,Z.mode=We;break}for(;ke<3;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}switch(Z.last=ve&1,ve>>>=1,ke-=1,ve&3){case 0:Z.mode=Y;break;case 1:if(He(Z),Z.mode=he,je===T){ve>>>=2,ke-=2;break e}break;case 2:Z.mode=J;break;case 3:ye.msg="invalid block type",Z.mode=Fe}ve>>>=2,ke-=2;break;case Y:for(ve>>>=ke&7,ke-=ke&7;ke<32;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}if((ve&65535)!==(ve>>>16^65535)){ye.msg="invalid stored block lengths",Z.mode=Fe;break}if(Z.length=ve&65535,ve=0,ke=0,Z.mode=X,je===T)break e;case X:Z.mode=N;case N:if(dt=Z.length,dt){if(dt>Ee&&(dt=Ee),dt>re&&(dt=re),dt===0)break e;u.arraySet(rt,De,G,dt,Te),Ee-=dt,G+=dt,re-=dt,Te+=dt,Z.length-=dt;break}Z.mode=U;break;case J:for(;ke<14;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}if(Z.nlen=(ve&31)+257,ve>>>=5,ke-=5,Z.ndist=(ve&31)+1,ve>>>=5,ke-=5,Z.ncode=(ve&15)+4,ve>>>=4,ke-=4,Z.nlen>286||Z.ndist>30){ye.msg="too many length or distance symbols",Z.mode=Fe;break}Z.have=0,Z.mode=ae;case ae:for(;Z.have<Z.ncode;){for(;ke<3;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}Z.lens[Nr[Z.have++]]=ve&7,ve>>>=3,ke-=3}for(;Z.have<19;)Z.lens[Nr[Z.have++]]=0;if(Z.lencode=Z.lendyn,Z.lenbits=7,wr={bits:Z.lenbits},Wt=p(y,Z.lens,0,19,Z.lencode,0,Z.work,wr),Z.lenbits=wr.bits,Wt){ye.msg="invalid code lengths set",Z.mode=Fe;break}Z.have=0,Z.mode=se;case se:for(;Z.have<Z.nlen+Z.ndist;){for(;At=Z.lencode[ve&(1<<Z.lenbits)-1],Mt=At>>>24,Pt=At>>>16&255,Qt=At&65535,!(Mt<=ke);){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}if(Qt<16)ve>>>=Mt,ke-=Mt,Z.lens[Z.have++]=Qt;else{if(Qt===16){for(dr=Mt+2;ke<dr;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}if(ve>>>=Mt,ke-=Mt,Z.have===0){ye.msg="invalid bit length repeat",Z.mode=Fe;break}Lt=Z.lens[Z.have-1],dt=3+(ve&3),ve>>>=2,ke-=2}else if(Qt===17){for(dr=Mt+3;ke<dr;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}ve>>>=Mt,ke-=Mt,Lt=0,dt=3+(ve&7),ve>>>=3,ke-=3}else{for(dr=Mt+7;ke<dr;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}ve>>>=Mt,ke-=Mt,Lt=0,dt=11+(ve&127),ve>>>=7,ke-=7}if(Z.have+dt>Z.nlen+Z.ndist){ye.msg="invalid bit length repeat",Z.mode=Fe;break}for(;dt--;)Z.lens[Z.have++]=Lt}}if(Z.mode===Fe)break;if(Z.lens[256]===0){ye.msg="invalid code -- missing end-of-block",Z.mode=Fe;break}if(Z.lenbits=9,wr={bits:Z.lenbits},Wt=p(k,Z.lens,0,Z.nlen,Z.lencode,0,Z.work,wr),Z.lenbits=wr.bits,Wt){ye.msg="invalid literal/lengths set",Z.mode=Fe;break}if(Z.distbits=6,Z.distcode=Z.distdyn,wr={bits:Z.distbits},Wt=p(g,Z.lens,Z.nlen,Z.ndist,Z.distcode,0,Z.work,wr),Z.distbits=wr.bits,Wt){ye.msg="invalid distances set",Z.mode=Fe;break}if(Z.mode=he,je===T)break e;case he:Z.mode=pe;case pe:if(Ee>=6&&re>=258){ye.next_out=Te,ye.avail_out=re,ye.next_in=G,ye.avail_in=Ee,Z.hold=ve,Z.bits=ke,b(ye,lt),Te=ye.next_out,rt=ye.output,re=ye.avail_out,G=ye.next_in,De=ye.input,Ee=ye.avail_in,ve=Z.hold,ke=Z.bits,Z.mode===U&&(Z.back=-1);break}for(Z.back=0;At=Z.lencode[ve&(1<<Z.lenbits)-1],Mt=At>>>24,Pt=At>>>16&255,Qt=At&65535,!(Mt<=ke);){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}if(Pt&&!(Pt&240)){for(Kt=Mt,Kr=Pt,ai=Qt;At=Z.lencode[ai+((ve&(1<<Kt+Kr)-1)>>Kt)],Mt=At>>>24,Pt=At>>>16&255,Qt=At&65535,!(Kt+Mt<=ke);){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}ve>>>=Kt,ke-=Kt,Z.back+=Kt}if(ve>>>=Mt,ke-=Mt,Z.back+=Mt,Z.length=Qt,Pt===0){Z.mode=Ge;break}if(Pt&32){Z.back=-1,Z.mode=U;break}if(Pt&64){ye.msg="invalid literal/length code",Z.mode=Fe;break}Z.extra=Pt&15,Z.mode=de;case de:if(Z.extra){for(dr=Z.extra;ke<dr;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}Z.length+=ve&(1<<Z.extra)-1,ve>>>=Z.extra,ke-=Z.extra,Z.back+=Z.extra}Z.was=Z.length,Z.mode=ue;case ue:for(;At=Z.distcode[ve&(1<<Z.distbits)-1],Mt=At>>>24,Pt=At>>>16&255,Qt=At&65535,!(Mt<=ke);){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}if(!(Pt&240)){for(Kt=Mt,Kr=Pt,ai=Qt;At=Z.distcode[ai+((ve&(1<<Kt+Kr)-1)>>Kt)],Mt=At>>>24,Pt=At>>>16&255,Qt=At&65535,!(Kt+Mt<=ke);){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}ve>>>=Kt,ke-=Kt,Z.back+=Kt}if(ve>>>=Mt,ke-=Mt,Z.back+=Mt,Pt&64){ye.msg="invalid distance code",Z.mode=Fe;break}Z.offset=Qt,Z.extra=Pt&15,Z.mode=ge;case ge:if(Z.extra){for(dr=Z.extra;ke<dr;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}Z.offset+=ve&(1<<Z.extra)-1,ve>>>=Z.extra,ke-=Z.extra,Z.back+=Z.extra}if(Z.offset>Z.dmax){ye.msg="invalid distance too far back",Z.mode=Fe;break}Z.mode=Re;case Re:if(re===0)break e;if(dt=lt-re,Z.offset>dt){if(dt=Z.offset-dt,dt>Z.whave&&Z.sane){ye.msg="invalid distance too far back",Z.mode=Fe;break}dt>Z.wnext?(dt-=Z.wnext,yt=Z.wsize-dt):yt=Z.wnext-dt,dt>Z.length&&(dt=Z.length),ir=Z.window}else ir=rt,yt=Te-Z.offset,dt=Z.length;dt>re&&(dt=re),re-=dt,Z.length-=dt;do rt[Te++]=ir[yt++];while(--dt);Z.length===0&&(Z.mode=pe);break;case Ge:if(re===0)break e;rt[Te++]=Z.length,re--,Z.mode=pe;break;case We:if(Z.wrap){for(;ke<32;){if(Ee===0)break e;Ee--,ve|=De[G++]<<ke,ke+=8}if(lt-=re,ye.total_out+=lt,Z.total+=lt,lt&&(ye.adler=Z.check=Z.flags?x(Z.check,rt,lt,Te-lt):v(Z.check,rt,lt,Te-lt)),lt=re,(Z.flags?ve:Xe(ve))!==Z.check){ye.msg="incorrect data check",Z.mode=Fe;break}ve=0,ke=0}Z.mode=Oe;case Oe:if(Z.wrap&&Z.flags){for(;ke<32;){if(Ee===0)break e;Ee--,ve+=De[G++]<<ke,ke+=8}if(ve!==(Z.total&4294967295)){ye.msg="incorrect length check",Z.mode=Fe;break}ve=0,ke=0}Z.mode=me;case me:Wt=a;break e;case Fe:Wt=w;break e;case qe:return _;case Qe:default:return c}return ye.next_out=Te,ye.avail_out=re,ye.next_in=G,ye.avail_in=Ee,Z.hold=ve,Z.bits=ke,(Z.wsize||lt!==ye.avail_out&&Z.mode<Fe&&(Z.mode<We||je!==R))&&Be(ye,ye.output,ye.next_out,lt-ye.avail_out),ct-=ye.avail_in,lt-=ye.avail_out,ye.total_in+=ct,ye.total_out+=lt,Z.total+=lt,Z.wrap&&lt&&(ye.adler=Z.check=Z.flags?x(Z.check,rt,lt,ye.next_out-lt):v(Z.check,rt,lt,ye.next_out-lt)),ye.data_type=Z.bits+(Z.last?64:0)+(Z.mode===U?128:0)+(Z.mode===he||Z.mode===X?256:0),(ct===0&&lt===0||je===R)&&Wt===C&&(Wt=M),Wt}function xe(ye){if(!ye||!ye.state)return c;var je=ye.state;return je.window&&(je.window=null),ye.state=null,C}function Me(ye,je){var Z;return!ye||!ye.state||(Z=ye.state,!(Z.wrap&2))?c:(Z.head=je,je.done=!1,C)}function $e(ye,je){var Z=je.length,De,rt,G;return!ye||!ye.state||(De=ye.state,De.wrap!==0&&De.mode!==q)?c:De.mode===q&&(rt=1,rt=v(rt,je,Z,0),rt!==De.check)?w:(G=Be(ye,je,Z,Z),G?(De.mode=qe,_):(De.havedict=1,C))}t.inflateReset=ft,t.inflateReset2=ut,t.inflateResetKeep=Ue,t.inflateInit=ie,t.inflateInit2=ee,t.inflate=K,t.inflateEnd=xe,t.inflateGetHeader=Me,t.inflateSetDictionary=$e,t.inflateInfo="pako inflate (from Nodeca project)"}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),v=15,x=852,b=592,p=0,y=1,k=2,g=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],R=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],P=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],T=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(C,a,s,c,w,_,M,l){var h=l.bits,S=0,E=0,F=0,D=0,L=0,V=0,O=0,W=0,H=0,q=0,U,B,Y,X,N,J=null,ae=0,se,he=new u.Buf16(v+1),pe=new u.Buf16(v+1),de=null,ue=0,ge,Re,Ge;for(S=0;S<=v;S++)he[S]=0;for(E=0;E<c;E++)he[a[s+E]]++;for(L=h,D=v;D>=1&&he[D]===0;D--);if(L>D&&(L=D),D===0)return w[_++]=20971520,w[_++]=20971520,l.bits=1,0;for(F=1;F<D&&he[F]===0;F++);for(L<F&&(L=F),W=1,S=1;S<=v;S++)if(W<<=1,W-=he[S],W<0)return-1;if(W>0&&(C===p||D!==1))return-1;for(pe[1]=0,S=1;S<v;S++)pe[S+1]=pe[S]+he[S];for(E=0;E<c;E++)a[s+E]!==0&&(M[pe[a[s+E]]++]=E);if(C===p?(J=de=M,se=19):C===y?(J=g,ae-=257,de=R,ue-=257,se=256):(J=P,de=T,se=-1),q=0,E=0,S=F,N=_,V=L,O=0,Y=-1,H=1<<L,X=H-1,C===y&&H>x||C===k&&H>b)return 1;for(;;){ge=S-O,M[E]<se?(Re=0,Ge=M[E]):M[E]>se?(Re=de[ue+M[E]],Ge=J[ae+M[E]]):(Re=96,Ge=0),U=1<<S-O,B=1<<V,F=B;do B-=U,w[N+(q>>O)+B]=ge<<24|Re<<16|Ge|0;while(B!==0);for(U=1<<S-1;q&U;)U>>=1;if(U!==0?(q&=U-1,q+=U):q=0,E++,--he[S]===0){if(S===D)break;S=a[s+M[E]]}if(S>L&&(q&X)!==Y){for(O===0&&(O=L),N+=F,V=S-O,W=1<<V;V+O<D&&(W-=he[V+O],!(W<=0));)V++,W<<=1;if(H+=1<<V,C===y&&H>x||C===k&&H>b)return 1;Y=q&X,w[Y]=L<<24|V<<16|N-_|0}}return q!==0&&(w[N+q]=S-O<<24|4194304|0),l.bits=L,0}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js":(n=>{n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),v=4,x=0,b=1,p=2;function y(K){for(var xe=K.length;--xe>=0;)K[xe]=0}var k=0,g=1,R=2,P=3,T=258,C=29,a=256,s=a+1+C,c=30,w=19,_=2*s+1,M=15,l=16,h=7,S=256,E=16,F=17,D=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=512,q=new Array((s+2)*2);y(q);var U=new Array(c*2);y(U);var B=new Array(H);y(B);var Y=new Array(T-P+1);y(Y);var X=new Array(C);y(X);var N=new Array(c);y(N);function J(K,xe,Me,$e,ye){this.static_tree=K,this.extra_bits=xe,this.extra_base=Me,this.elems=$e,this.max_length=ye,this.has_stree=K&&K.length}var ae,se,he;function pe(K,xe){this.dyn_tree=K,this.max_code=0,this.stat_desc=xe}function de(K){return K<256?B[K]:B[256+(K>>>7)]}function ue(K,xe){K.pending_buf[K.pending++]=xe&255,K.pending_buf[K.pending++]=xe>>>8&255}function ge(K,xe,Me){K.bi_valid>l-Me?(K.bi_buf|=xe<<K.bi_valid&65535,ue(K,K.bi_buf),K.bi_buf=xe>>l-K.bi_valid,K.bi_valid+=Me-l):(K.bi_buf|=xe<<K.bi_valid&65535,K.bi_valid+=Me)}function Re(K,xe,Me){ge(K,Me[xe*2],Me[xe*2+1])}function Ge(K,xe){var Me=0;do Me|=K&1,K>>>=1,Me<<=1;while(--xe>0);return Me>>>1}function We(K){K.bi_valid===16?(ue(K,K.bi_buf),K.bi_buf=0,K.bi_valid=0):K.bi_valid>=8&&(K.pending_buf[K.pending++]=K.bi_buf&255,K.bi_buf>>=8,K.bi_valid-=8)}function Oe(K,xe){var Me=xe.dyn_tree,$e=xe.max_code,ye=xe.stat_desc.static_tree,je=xe.stat_desc.has_stree,Z=xe.stat_desc.extra_bits,De=xe.stat_desc.extra_base,rt=xe.stat_desc.max_length,G,Te,Ee,re,ve,ke,ct=0;for(re=0;re<=M;re++)K.bl_count[re]=0;for(Me[K.heap[K.heap_max]*2+1]=0,G=K.heap_max+1;G<_;G++)Te=K.heap[G],re=Me[Me[Te*2+1]*2+1]+1,re>rt&&(re=rt,ct++),Me[Te*2+1]=re,!(Te>$e)&&(K.bl_count[re]++,ve=0,Te>=De&&(ve=Z[Te-De]),ke=Me[Te*2],K.opt_len+=ke*(re+ve),je&&(K.static_len+=ke*(ye[Te*2+1]+ve)));if(ct!==0){do{for(re=rt-1;K.bl_count[re]===0;)re--;K.bl_count[re]--,K.bl_count[re+1]+=2,K.bl_count[rt]--,ct-=2}while(ct>0);for(re=rt;re!==0;re--)for(Te=K.bl_count[re];Te!==0;)Ee=K.heap[--G],!(Ee>$e)&&(Me[Ee*2+1]!==re&&(K.opt_len+=(re-Me[Ee*2+1])*Me[Ee*2],Me[Ee*2+1]=re),Te--)}}function me(K,xe,Me){var $e=new Array(M+1),ye=0,je,Z;for(je=1;je<=M;je++)$e[je]=ye=ye+Me[je-1]<<1;for(Z=0;Z<=xe;Z++){var De=K[Z*2+1];De!==0&&(K[Z*2]=Ge($e[De]++,De))}}function Fe(){var K,xe,Me,$e,ye,je=new Array(M+1);for(Me=0,$e=0;$e<C-1;$e++)for(X[$e]=Me,K=0;K<1<<L[$e];K++)Y[Me++]=$e;for(Y[Me-1]=$e,ye=0,$e=0;$e<16;$e++)for(N[$e]=ye,K=0;K<1<<V[$e];K++)B[ye++]=$e;for(ye>>=7;$e<c;$e++)for(N[$e]=ye<<7,K=0;K<1<<V[$e]-7;K++)B[256+ye++]=$e;for(xe=0;xe<=M;xe++)je[xe]=0;for(K=0;K<=143;)q[K*2+1]=8,K++,je[8]++;for(;K<=255;)q[K*2+1]=9,K++,je[9]++;for(;K<=279;)q[K*2+1]=7,K++,je[7]++;for(;K<=287;)q[K*2+1]=8,K++,je[8]++;for(me(q,s+1,je),K=0;K<c;K++)U[K*2+1]=5,U[K*2]=Ge(K,5);ae=new J(q,L,a+1,s,M),se=new J(U,V,0,c,M),he=new J(new Array(0),O,0,w,h)}function qe(K){var xe;for(xe=0;xe<s;xe++)K.dyn_ltree[xe*2]=0;for(xe=0;xe<c;xe++)K.dyn_dtree[xe*2]=0;for(xe=0;xe<w;xe++)K.bl_tree[xe*2]=0;K.dyn_ltree[S*2]=1,K.opt_len=K.static_len=0,K.last_lit=K.matches=0}function Qe(K){K.bi_valid>8?ue(K,K.bi_buf):K.bi_valid>0&&(K.pending_buf[K.pending++]=K.bi_buf),K.bi_buf=0,K.bi_valid=0}function st(K,xe,Me,$e){Qe(K),ue(K,Me),ue(K,~Me),u.arraySet(K.pending_buf,K.window,xe,Me,K.pending),K.pending+=Me}function ot(K,xe,Me,$e){var ye=xe*2,je=Me*2;return K[ye]<K[je]||K[ye]===K[je]&&$e[xe]<=$e[Me]}function Ke(K,xe,Me){for(var $e=K.heap[Me],ye=Me<<1;ye<=K.heap_len&&(ye<K.heap_len&&ot(xe,K.heap[ye+1],K.heap[ye],K.depth)&&ye++,!ot(xe,$e,K.heap[ye],K.depth));)K.heap[Me]=K.heap[ye],Me=ye,ye<<=1;K.heap[Me]=$e}function Je(K,xe,Me){var $e,ye,je=0,Z,De;if(K.last_lit!==0)do $e=K.pending_buf[K.d_buf+je*2]<<8|K.pending_buf[K.d_buf+je*2+1],ye=K.pending_buf[K.l_buf+je],je++,$e===0?Re(K,ye,xe):(Z=Y[ye],Re(K,Z+a+1,xe),De=L[Z],De!==0&&(ye-=X[Z],ge(K,ye,De)),$e--,Z=de($e),Re(K,Z,Me),De=V[Z],De!==0&&($e-=N[Z],ge(K,$e,De)));while(je<K.last_lit);Re(K,S,xe)}function Xe(K,xe){var Me=xe.dyn_tree,$e=xe.stat_desc.static_tree,ye=xe.stat_desc.has_stree,je=xe.stat_desc.elems,Z,De,rt=-1,G;for(K.heap_len=0,K.heap_max=_,Z=0;Z<je;Z++)Me[Z*2]!==0?(K.heap[++K.heap_len]=rt=Z,K.depth[Z]=0):Me[Z*2+1]=0;for(;K.heap_len<2;)G=K.heap[++K.heap_len]=rt<2?++rt:0,Me[G*2]=1,K.depth[G]=0,K.opt_len--,ye&&(K.static_len-=$e[G*2+1]);for(xe.max_code=rt,Z=K.heap_len>>1;Z>=1;Z--)Ke(K,Me,Z);G=je;do Z=K.heap[1],K.heap[1]=K.heap[K.heap_len--],Ke(K,Me,1),De=K.heap[1],K.heap[--K.heap_max]=Z,K.heap[--K.heap_max]=De,Me[G*2]=Me[Z*2]+Me[De*2],K.depth[G]=(K.depth[Z]>=K.depth[De]?K.depth[Z]:K.depth[De])+1,Me[Z*2+1]=Me[De*2+1]=G,K.heap[1]=G++,Ke(K,Me,1);while(K.heap_len>=2);K.heap[--K.heap_max]=K.heap[1],Oe(K,xe),me(Me,rt,K.bl_count)}function Ne(K,xe,Me){var $e,ye=-1,je,Z=xe[1],De=0,rt=7,G=4;for(Z===0&&(rt=138,G=3),xe[(Me+1)*2+1]=65535,$e=0;$e<=Me;$e++)je=Z,Z=xe[($e+1)*2+1],!(++De<rt&&je===Z)&&(De<G?K.bl_tree[je*2]+=De:je!==0?(je!==ye&&K.bl_tree[je*2]++,K.bl_tree[E*2]++):De<=10?K.bl_tree[F*2]++:K.bl_tree[D*2]++,De=0,ye=je,Z===0?(rt=138,G=3):je===Z?(rt=6,G=3):(rt=7,G=4))}function Ue(K,xe,Me){var $e,ye=-1,je,Z=xe[1],De=0,rt=7,G=4;for(Z===0&&(rt=138,G=3),$e=0;$e<=Me;$e++)if(je=Z,Z=xe[($e+1)*2+1],!(++De<rt&&je===Z)){if(De<G)do Re(K,je,K.bl_tree);while(--De!==0);else je!==0?(je!==ye&&(Re(K,je,K.bl_tree),De--),Re(K,E,K.bl_tree),ge(K,De-3,2)):De<=10?(Re(K,F,K.bl_tree),ge(K,De-3,3)):(Re(K,D,K.bl_tree),ge(K,De-11,7));De=0,ye=je,Z===0?(rt=138,G=3):je===Z?(rt=6,G=3):(rt=7,G=4)}}function ft(K){var xe;for(Ne(K,K.dyn_ltree,K.l_desc.max_code),Ne(K,K.dyn_dtree,K.d_desc.max_code),Xe(K,K.bl_desc),xe=w-1;xe>=3&&K.bl_tree[W[xe]*2+1]===0;xe--);return K.opt_len+=3*(xe+1)+5+5+4,xe}function ut(K,xe,Me,$e){var ye;for(ge(K,xe-257,5),ge(K,Me-1,5),ge(K,$e-4,4),ye=0;ye<$e;ye++)ge(K,K.bl_tree[W[ye]*2+1],3);Ue(K,K.dyn_ltree,xe-1),Ue(K,K.dyn_dtree,Me-1)}function ee(K){var xe=4093624447,Me;for(Me=0;Me<=31;Me++,xe>>>=1)if(xe&1&&K.dyn_ltree[Me*2]!==0)return x;if(K.dyn_ltree[18]!==0||K.dyn_ltree[20]!==0||K.dyn_ltree[26]!==0)return b;for(Me=32;Me<a;Me++)if(K.dyn_ltree[Me*2]!==0)return b;return x}var ie=!1;function oe(K){ie||(Fe(),ie=!0),K.l_desc=new pe(K.dyn_ltree,ae),K.d_desc=new pe(K.dyn_dtree,se),K.bl_desc=new pe(K.bl_tree,he),K.bi_buf=0,K.bi_valid=0,qe(K)}function we(K,xe,Me,$e){ge(K,(k<<1)+($e?1:0),3),st(K,xe,Me)}function Se(K){ge(K,g<<1,3),Re(K,S,q),We(K)}function He(K,xe,Me,$e){var ye,je,Z=0;K.level>0?(K.strm.data_type===p&&(K.strm.data_type=ee(K)),Xe(K,K.l_desc),Xe(K,K.d_desc),Z=ft(K),ye=K.opt_len+3+7>>>3,je=K.static_len+3+7>>>3,je<=ye&&(ye=je)):ye=je=Me+5,Me+4<=ye&&xe!==-1?we(K,xe,Me,$e):K.strategy===v||je===ye?(ge(K,(g<<1)+($e?1:0),3),Je(K,q,U)):(ge(K,(R<<1)+($e?1:0),3),ut(K,K.l_desc.max_code+1,K.d_desc.max_code+1,Z+1),Je(K,K.dyn_ltree,K.dyn_dtree)),qe(K),$e&&Qe(K)}function Be(K,xe,Me){return K.pending_buf[K.d_buf+K.last_lit*2]=xe>>>8&255,K.pending_buf[K.d_buf+K.last_lit*2+1]=xe&255,K.pending_buf[K.l_buf+K.last_lit]=Me&255,K.last_lit++,xe===0?K.dyn_ltree[Me*2]++:(K.matches++,xe--,K.dyn_ltree[(Y[Me]+a+1)*2]++,K.dyn_dtree[de(xe)*2]++),K.last_lit===K.lit_bufsize-1}t._tr_init=oe,t._tr_stored_block=we,t._tr_flush_block=He,t._tr_tally=Be,t._tr_align=Se}),"./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js":(n=>{function t(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}n.exports=t}),"./src/SurfaceWorker.js":(()=>{$3Dmol.workerString=(function(){self.onmessage=function(n){var t=n.data,r=t.type;if(r<0)self.atomData=t.atoms,self.volume=t.volume,self.ps=new ProteinSurface;else{var u=self.ps;u.initparm(t.expandedExtent,r!=1,self.volume),u.fillvoxels(self.atomData,t.extendedAtoms),u.buildboundary(),(r===4||r===2)&&(u.fastdistancemap(),u.boundingatom(!1),u.fillvoxelswaals(self.atomData,t.extendedAtoms)),u.marchingcube(r);var v=u.getFacesAndVertices(t.atomsToShow);self.postMessage(v)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0}),"./src/exporter.js":(n=>{typeof n.exports=="object"&&(n.exports=window.$3Dmol)}),"./src/vendor/mmtf.js":(function(n,t){(function(r,u){u(t)})(this,function(r){function u(ee,ie,oe){for(var we=(ee.byteLength,0),Se=oe.length;Se>we;we++){var He=oe.charCodeAt(we);if(128>He)ee.setUint8(ie++,He>>>0&127|0);else if(2048>He)ee.setUint8(ie++,He>>>6&31|192),ee.setUint8(ie++,He>>>0&63|128);else if(65536>He)ee.setUint8(ie++,He>>>12&15|224),ee.setUint8(ie++,He>>>6&63|128),ee.setUint8(ie++,He>>>0&63|128);else{if(!(1114112>He))throw new Error("bad codepoint "+He);ee.setUint8(ie++,He>>>18&7|240),ee.setUint8(ie++,He>>>12&63|128),ee.setUint8(ie++,He>>>6&63|128),ee.setUint8(ie++,He>>>0&63|128)}}}function v(ee){for(var ie=0,oe=0,we=ee.length;we>oe;oe++){var Se=ee.charCodeAt(oe);if(128>Se)ie+=1;else if(2048>Se)ie+=2;else if(65536>Se)ie+=3;else{if(!(1114112>Se))throw new Error("bad codepoint "+Se);ie+=4}}return ie}function x(ee,ie,oe){var we=typeof ee;if(we==="string"){var Se=v(ee);if(32>Se)return ie.setUint8(oe,160|Se),u(ie,oe+1,ee),1+Se;if(256>Se)return ie.setUint8(oe,217),ie.setUint8(oe+1,Se),u(ie,oe+2,ee),2+Se;if(65536>Se)return ie.setUint8(oe,218),ie.setUint16(oe+1,Se),u(ie,oe+3,ee),3+Se;if(4294967296>Se)return ie.setUint8(oe,219),ie.setUint32(oe+1,Se),u(ie,oe+5,ee),5+Se}if(ee instanceof Uint8Array){var Se=ee.byteLength,He=new Uint8Array(ie.buffer);if(256>Se)return ie.setUint8(oe,196),ie.setUint8(oe+1,Se),He.set(ee,oe+2),2+Se;if(65536>Se)return ie.setUint8(oe,197),ie.setUint16(oe+1,Se),He.set(ee,oe+3),3+Se;if(4294967296>Se)return ie.setUint8(oe,198),ie.setUint32(oe+1,Se),He.set(ee,oe+5),5+Se}if(we==="number"){if(!isFinite(ee))throw new Error("Number not finite: "+ee);if(Math.floor(ee)!==ee)return ie.setUint8(oe,203),ie.setFloat64(oe+1,ee),9;if(ee>=0){if(128>ee)return ie.setUint8(oe,ee),1;if(256>ee)return ie.setUint8(oe,204),ie.setUint8(oe+1,ee),2;if(65536>ee)return ie.setUint8(oe,205),ie.setUint16(oe+1,ee),3;if(4294967296>ee)return ie.setUint8(oe,206),ie.setUint32(oe+1,ee),5;throw new Error("Number too big 0x"+ee.toString(16))}if(ee>=-32)return ie.setInt8(oe,ee),1;if(ee>=-128)return ie.setUint8(oe,208),ie.setInt8(oe+1,ee),2;if(ee>=-32768)return ie.setUint8(oe,209),ie.setInt16(oe+1,ee),3;if(ee>=-2147483648)return ie.setUint8(oe,210),ie.setInt32(oe+1,ee),5;throw new Error("Number too small -0x"+(-ee).toString(16).substr(1))}if(ee===null)return ie.setUint8(oe,192),1;if(we==="boolean")return ie.setUint8(oe,ee?195:194),1;if(we==="object"){var Se,xe=0,Be=Array.isArray(ee);if(Be)Se=ee.length;else{var K=Object.keys(ee);Se=K.length}var xe;if(16>Se?(ie.setUint8(oe,Se|(Be?144:128)),xe=1):65536>Se?(ie.setUint8(oe,Be?220:222),ie.setUint16(oe+1,Se),xe=3):4294967296>Se&&(ie.setUint8(oe,Be?221:223),ie.setUint32(oe+1,Se),xe=5),Be)for(var Me=0;Se>Me;Me++)xe+=x(ee[Me],ie,oe+xe);else for(var Me=0;Se>Me;Me++){var $e=K[Me];xe+=x($e,ie,oe+xe),xe+=x(ee[$e],ie,oe+xe)}return xe}throw new Error("Unknown type "+we)}function b(ee){var ie=typeof ee;if(ie==="string"){var oe=v(ee);if(32>oe)return 1+oe;if(256>oe)return 2+oe;if(65536>oe)return 3+oe;if(4294967296>oe)return 5+oe}if(ee instanceof Uint8Array){var oe=ee.byteLength;if(256>oe)return 2+oe;if(65536>oe)return 3+oe;if(4294967296>oe)return 5+oe}if(ie==="number"){if(Math.floor(ee)!==ee)return 9;if(ee>=0){if(128>ee)return 1;if(256>ee)return 2;if(65536>ee)return 3;if(4294967296>ee)return 5;throw new Error("Number too big 0x"+ee.toString(16))}if(ee>=-32)return 1;if(ee>=-128)return 2;if(ee>=-32768)return 3;if(ee>=-2147483648)return 5;throw new Error("Number too small -0x"+ee.toString(16).substr(1))}if(ie==="boolean"||ee===null)return 1;if(ie==="object"){var oe,we=0;if(Array.isArray(ee)){oe=ee.length;for(var Se=0;oe>Se;Se++)we+=b(ee[Se])}else{var He=Object.keys(ee);oe=He.length;for(var Se=0;oe>Se;Se++){var Be=He[Se];we+=b(Be)+b(ee[Be])}}if(16>oe)return 1+we;if(65536>oe)return 3+we;if(4294967296>oe)return 5+we;throw new Error("Array or object too long 0x"+oe.toString(16))}throw new Error("Unknown type "+ie)}function p(ee){var ie=new ArrayBuffer(b(ee)),oe=new DataView(ie);return x(ee,oe,0),new Uint8Array(ie)}function y(ee,ie,oe){return ie?new ee(ie.buffer,ie.byteOffset,ie.byteLength/(oe||1)):void 0}function k(ee){return y(DataView,ee)}function g(ee){return y(Uint8Array,ee)}function R(ee){return y(Int8Array,ee)}function P(ee){return y(Int32Array,ee,4)}function T(ee){return y(Float32Array,ee,4)}function C(ee,ie){var oe=ee.length/2;ie||(ie=new Int16Array(oe));for(var we=0,Se=0;oe>we;++we,Se+=2)ie[we]=ee[Se]<<8^ee[Se+1]<<0;return ie}function a(ee,ie){var oe=ee.length;ie||(ie=new Uint8Array(2*oe));for(var we=k(ie),Se=0;oe>Se;++Se)we.setInt16(2*Se,ee[Se]);return g(ie)}function s(ee,ie){var oe=ee.length/4;ie||(ie=new Int32Array(oe));for(var we=0,Se=0;oe>we;++we,Se+=4)ie[we]=ee[Se]<<24^ee[Se+1]<<16^ee[Se+2]<<8^ee[Se+3]<<0;return ie}function c(ee,ie){var oe=ee.length;ie||(ie=new Uint8Array(4*oe));for(var we=k(ie),Se=0;oe>Se;++Se)we.setInt32(4*Se,ee[Se]);return g(ie)}function w(ee,ie){var oe=ee.length;ie||(ie=new Float32Array(oe/4));for(var we=k(ie),Se=k(ee),He=0,Be=0,K=oe/4;K>He;++He,Be+=4)we.setFloat32(Be,Se.getFloat32(Be),!0);return ie}function _(ee,ie,oe){var we=ee.length,Se=1/ie;oe||(oe=new Float32Array(we));for(var He=0;we>He;++He)oe[He]=ee[He]*Se;return oe}function M(ee,ie,oe){var we=ee.length;oe||(oe=new Int32Array(we));for(var Se=0;we>Se;++Se)oe[Se]=Math.round(ee[Se]*ie);return oe}function l(ee,ie){var oe,we;if(!ie){var Se=0;for(oe=0,we=ee.length;we>oe;oe+=2)Se+=ee[oe+1];ie=new ee.constructor(Se)}var He=0;for(oe=0,we=ee.length;we>oe;oe+=2)for(var Be=ee[oe],K=ee[oe+1],xe=0;K>xe;++xe)ie[He]=Be,++He;return ie}function h(ee){if(ee.length===0)return new Int32Array;var ie,oe,we=2;for(ie=1,oe=ee.length;oe>ie;++ie)ee[ie-1]!==ee[ie]&&(we+=2);var Se=new Int32Array(we),He=0,Be=1;for(ie=1,oe=ee.length;oe>ie;++ie)ee[ie-1]!==ee[ie]?(Se[He]=ee[ie-1],Se[He+1]=Be,Be=1,He+=2):++Be;return Se[He]=ee[ee.length-1],Se[He+1]=Be,Se}function S(ee,ie){var oe=ee.length;ie||(ie=new ee.constructor(oe)),oe&&(ie[0]=ee[0]);for(var we=1;oe>we;++we)ie[we]=ee[we]+ie[we-1];return ie}function E(ee,ie){var oe=ee.length;ie||(ie=new ee.constructor(oe)),ie[0]=ee[0];for(var we=1;oe>we;++we)ie[we]=ee[we]-ee[we-1];return ie}function F(ee,ie){var oe,we,Se=ee instanceof Int8Array?127:32767,He=-Se-1,Be=ee.length;if(!ie){var K=0;for(oe=0;Be>oe;++oe)ee[oe]<Se&&ee[oe]>He&&++K;ie=new Int32Array(K)}for(oe=0,we=0;Be>oe;){for(var xe=0;ee[oe]===Se||ee[oe]===He;)xe+=ee[oe],++oe;xe+=ee[oe],++oe,ie[we]=xe,++we}return ie}function D(ee,ie){var oe,we=32767,Se=-we-1,He=ee.length,Be=0;for(oe=0;He>oe;++oe){var K=ee[oe];K===0?++Be:K>0?(Be+=Math.ceil(K/we),K%we===0&&(Be+=1)):(Be+=Math.ceil(K/Se),K%Se===0&&(Be+=1))}var xe=new Int16Array(Be),Me=0;for(oe=0;He>oe;++oe){var K=ee[oe];if(K>=0)for(;K>=we;)xe[Me]=we,++Me,K-=we;else for(;Se>=K;)xe[Me]=Se,++Me,K-=Se;xe[Me]=K,++Me}return xe}function L(ee,ie){return S(l(ee),ie)}function V(ee){return h(E(ee))}function O(ee,ie,oe){return _(l(ee,P(oe)),ie,oe)}function W(ee,ie){return h(M(ee,ie))}function H(ee,ie,oe){return _(S(ee,P(oe)),ie,oe)}function q(ee,ie,oe){return E(M(ee,ie),oe)}function U(ee,ie,oe){return _(F(ee,P(oe)),ie,oe)}function B(ee,ie,oe){var we=F(ee,P(oe));return H(we,ie,T(we))}function Y(ee,ie,oe){return D(q(ee,ie))}function X(He){var ie=k(He),oe=ie.getInt32(0),we=ie.getInt32(4),Se=He.subarray(8,12),He=He.subarray(12);return[oe,He,we,Se]}function N(ee,ie,oe,we){var Se=new ArrayBuffer(12+we.byteLength),He=new Uint8Array(Se),Be=new DataView(Se);return Be.setInt32(0,ee),Be.setInt32(4,ie),oe&&He.set(oe,8),He.set(we,12),He}function J(ee){var ie=ee.length,oe=g(ee);return N(2,ie,void 0,oe)}function ae(ee){var ie=ee.length,oe=c(ee);return N(4,ie,void 0,oe)}function se(ee,ie){var oe=ee.length/ie,we=c([ie]),Se=g(ee);return N(5,oe,we,Se)}function he(ee){var ie=ee.length,oe=c(h(ee));return N(6,ie,void 0,oe)}function pe(ee){var ie=ee.length,oe=c(V(ee));return N(8,ie,void 0,oe)}function de(ee,ie){var oe=ee.length,we=c([ie]),Se=c(W(ee,ie));return N(9,oe,we,Se)}function ue(ee,ie){var oe=ee.length,we=c([ie]),Se=a(Y(ee,ie));return N(10,oe,we,Se)}function ge(ee){var ie={};return Ke.forEach(function(oe){ee[oe]!==void 0&&(ie[oe]=ee[oe])}),ee.bondAtomList&&(ie.bondAtomList=ae(ee.bondAtomList)),ee.bondOrderList&&(ie.bondOrderList=J(ee.bondOrderList)),ie.xCoordList=ue(ee.xCoordList,1e3),ie.yCoordList=ue(ee.yCoordList,1e3),ie.zCoordList=ue(ee.zCoordList,1e3),ee.bFactorList&&(ie.bFactorList=ue(ee.bFactorList,100)),ee.atomIdList&&(ie.atomIdList=pe(ee.atomIdList)),ee.altLocList&&(ie.altLocList=he(ee.altLocList)),ee.occupancyList&&(ie.occupancyList=de(ee.occupancyList,100)),ie.groupIdList=pe(ee.groupIdList),ie.groupTypeList=ae(ee.groupTypeList),ee.secStructList&&(ie.secStructList=J(ee.secStructList)),ee.insCodeList&&(ie.insCodeList=he(ee.insCodeList)),ee.sequenceIndexList&&(ie.sequenceIndexList=pe(ee.sequenceIndexList)),ie.chainIdList=se(ee.chainIdList,4),ee.chainNameList&&(ie.chainNameList=se(ee.chainNameList,4)),ie}function Re(ee){function ie(xe){for(var Me={},$e=0;xe>$e;$e++){var ye=He();Me[ye]=He()}return Me}function oe(xe){var Me=ee.subarray(Be,Be+xe);return Be+=xe,Me}function we(xe){var Me=ee.subarray(Be,Be+xe);Be+=xe;var $e=65535;if(xe>$e){for(var ye=[],je=0;je<Me.length;je+=$e)ye.push(String.fromCharCode.apply(null,Me.subarray(je,je+$e)));return ye.join("")}return String.fromCharCode.apply(null,Me)}function Se(xe){for(var Me=new Array(xe),$e=0;xe>$e;$e++)Me[$e]=He();return Me}function He(){var xe,Me,$e=ee[Be];if(!(128&$e))return Be++,$e;if((240&$e)===128)return Me=15&$e,Be++,ie(Me);if((240&$e)===144)return Me=15&$e,Be++,Se(Me);if((224&$e)===160)return Me=31&$e,Be++,we(Me);if((224&$e)===224)return xe=K.getInt8(Be),Be++,xe;switch($e){case 192:return Be++,null;case 194:return Be++,!1;case 195:return Be++,!0;case 196:return Me=K.getUint8(Be+1),Be+=2,oe(Me);case 197:return Me=K.getUint16(Be+1),Be+=3,oe(Me);case 198:return Me=K.getUint32(Be+1),Be+=5,oe(Me);case 202:return xe=K.getFloat32(Be+1),Be+=5,xe;case 203:return xe=K.getFloat64(Be+1),Be+=9,xe;case 204:return xe=ee[Be+1],Be+=2,xe;case 205:return xe=K.getUint16(Be+1),Be+=3,xe;case 206:return xe=K.getUint32(Be+1),Be+=5,xe;case 208:return xe=K.getInt8(Be+1),Be+=2,xe;case 209:return xe=K.getInt16(Be+1),Be+=3,xe;case 210:return xe=K.getInt32(Be+1),Be+=5,xe;case 217:return Me=K.getUint8(Be+1),Be+=2,we(Me);case 218:return Me=K.getUint16(Be+1),Be+=3,we(Me);case 219:return Me=K.getUint32(Be+1),Be+=5,we(Me);case 220:return Me=K.getUint16(Be+1),Be+=3,Se(Me);case 221:return Me=K.getUint32(Be+1),Be+=5,Se(Me);case 222:return Me=K.getUint16(Be+1),Be+=3,ie(Me);case 223:return Me=K.getUint32(Be+1),Be+=5,ie(Me)}throw new Error("Unknown type 0x"+$e.toString(16))}var Be=0,K=new DataView(ee.buffer);return He()}function Ge(ee,ie,oe,we){switch(ee){case 1:return w(ie);case 2:return R(ie);case 3:return C(ie);case 4:return s(ie);case 5:return g(ie);case 6:return l(s(ie),new Uint8Array(oe));case 7:return l(s(ie));case 8:return L(s(ie));case 9:return O(s(ie),s(we)[0]);case 10:return B(C(ie),s(we)[0]);case 11:return _(C(ie),s(we)[0]);case 12:return U(C(ie),s(we)[0]);case 13:return U(R(ie),s(we)[0]);case 14:return F(C(ie));case 15:return F(R(ie))}}function We(ee,ie){ie=ie||{};var oe=ie.ignoreFields,we={};return Xe.forEach(function(Se){var He=oe?oe.indexOf(Se)!==-1:!1,Be=ee[Se];He||Be===void 0||(Be instanceof Uint8Array?we[Se]=Ge.apply(null,X(Be)):we[Se]=Be)}),we}function Oe(ee){return String.fromCharCode.apply(null,ee).replace(/\0/g,"")}function me(ee,ie,oe){oe=oe||{};var we,Se,He,Be,K,xe,Me=oe.firstModelOnly,$e=ie.onModel,ye=ie.onChain,je=ie.onGroup,Z=ie.onAtom,De=ie.onBond,rt=0,G=0,Te=0,Ee=0,re=0,ve=-1,ke=ee.chainNameList,ct=ee.secStructList,lt=ee.insCodeList,dt=ee.sequenceIndexList,yt=ee.atomIdList,ir=ee.bFactorList,At=ee.altLocList,Mt=ee.occupancyList,Pt=ee.bondAtomList,Qt=ee.bondOrderList;for(we=0,Se=ee.chainsPerModel.length;Se>we&&!(Me&&rt>0);++we){var Kt=ee.chainsPerModel[rt];for($e&&$e({chainCount:Kt,modelIndex:rt}),He=0;Kt>He;++He){var Kr=ee.groupsPerChain[G];if(ye){var ai=Oe(ee.chainIdList.subarray(4*G,4*G+4)),Lt=null;ke&&(Lt=Oe(ke.subarray(4*G,4*G+4))),ye({groupCount:Kr,chainIndex:G,modelIndex:rt,chainId:ai,chainName:Lt})}for(Be=0;Kr>Be;++Be){var Wt=ee.groupList[ee.groupTypeList[Te]],qt=Wt.atomNameList.length;if(je){var wr=null;ct&&(wr=ct[Te]);var dr=null;ee.insCodeList&&(dr=String.fromCharCode(lt[Te]));var Nr=null;dt&&(Nr=dt[Te]),je({atomCount:qt,groupIndex:Te,chainIndex:G,modelIndex:rt,groupId:ee.groupIdList[Te],groupType:ee.groupTypeList[Te],groupName:Wt.groupName,singleLetterCode:Wt.singleLetterCode,chemCompType:Wt.chemCompType,secStruct:wr,insCode:dr,sequenceIndex:Nr})}for(K=0;qt>K;++K){if(Z){var gn=null;yt&&(gn=yt[Ee]);var vn=null;ir&&(vn=ir[Ee]);var Wn=null;At&&(Wn=String.fromCharCode(At[Ee]));var Gi=null;Mt&&(Gi=Mt[Ee]),Z({atomIndex:Ee,groupIndex:Te,chainIndex:G,modelIndex:rt,atomId:gn,element:Wt.elementList[K],atomName:Wt.atomNameList[K],formalCharge:Wt.formalChargeList[K],xCoord:ee.xCoordList[Ee],yCoord:ee.yCoordList[Ee],zCoord:ee.zCoordList[Ee],bFactor:vn,altLoc:Wn,occupancy:Gi})}Ee+=1}if(De){var Jt=Wt.bondAtomList;for(K=0,xe=Wt.bondOrderList.length;xe>K;++K)De({atomIndex1:Ee-qt+Jt[2*K],atomIndex2:Ee-qt+Jt[2*K+1],bondOrder:Wt.bondOrderList[K]})}Te+=1}G+=1}if(re=ve+1,ve=Ee-1,De&&Pt)for(K=0,xe=Pt.length;xe>K;K+=2){var yn=Pt[K],Ei=Pt[K+1];(yn>=re&&ve>=yn||Ei>=re&&ve>=Ei)&&De({atomIndex1:yn,atomIndex2:Ei,bondOrder:Qt?Qt[K/2]:null})}rt+=1}}function Fe(ee){return p(ge(ee))}function qe(ee,ie){ee instanceof ArrayBuffer&&(ee=new Uint8Array(ee));var oe;return oe=ee instanceof Uint8Array?Re(ee):ee,We(oe,ie)}function Qe(ee,ie,oe,we){function Se(){try{var Be=qe(He.response);oe(Be)}catch(K){we(K)}}var He=new XMLHttpRequest;He.addEventListener("load",Se,!0),He.addEventListener("error",we,!0),He.responseType="arraybuffer",He.open("GET",ie+ee.toUpperCase()),He.send()}function st(ee,ie,oe){Qe(ee,ft,ie,oe)}function ot(ee,ie,oe){Qe(ee,ut,ie,oe)}var Ke=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],Je=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],Xe=Ke.concat(Je),Ne="v1.0.1",Ue="//mmtf.rcsb.org/v1.0/",ft=Ue+"full/",ut=Ue+"reduced/";r.encode=Fe,r.decode=qe,r.traverse=me,r.fetch=st,r.fetchReduced=ot,r.version=Ne,r.fetchUrl=ft,r.fetchReducedUrl=ut,r.encodeMsgpack=p,r.encodeMmtf=ge,r.decodeMsgpack=Re,r.decodeMmtf=We})}),"./node_modules/pako/dist/pako.esm.mjs":((n,t,r)=>{r.r(t),r.d(t,{Deflate:()=>xi,Inflate:()=>mo,constants:()=>qr,default:()=>xs,deflate:()=>Oi,deflateRaw:()=>xr,gzip:()=>Dn,inflate:()=>go,inflateRaw:()=>zn,ungzip:()=>vo});/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const u=4,v=0,x=1,b=2;function p(A){let Q=A.length;for(;--Q>=0;)A[Q]=0}const y=0,k=1,g=2,R=3,P=258,T=29,C=256,a=C+1+T,s=30,c=19,w=2*a+1,_=15,M=16,l=7,h=256,S=16,E=17,F=18,D=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),L=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),V=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),W=512,H=new Array((a+2)*2);p(H);const q=new Array(s*2);p(q);const U=new Array(W);p(U);const B=new Array(P-R+1);p(B);const Y=new Array(T);p(Y);const X=new Array(s);p(X);function N(A,Q,z,ne,le){this.static_tree=A,this.extra_bits=Q,this.extra_base=z,this.elems=ne,this.max_length=le,this.has_stree=A&&A.length}let J,ae,se;function he(A,Q){this.dyn_tree=A,this.max_code=0,this.stat_desc=Q}const pe=A=>A<256?U[A]:U[256+(A>>>7)],de=(A,Q)=>{A.pending_buf[A.pending++]=Q&255,A.pending_buf[A.pending++]=Q>>>8&255},ue=(A,Q,z)=>{A.bi_valid>M-z?(A.bi_buf|=Q<<A.bi_valid&65535,de(A,A.bi_buf),A.bi_buf=Q>>M-A.bi_valid,A.bi_valid+=z-M):(A.bi_buf|=Q<<A.bi_valid&65535,A.bi_valid+=z)},ge=(A,Q,z)=>{ue(A,z[Q*2],z[Q*2+1])},Re=(A,Q)=>{let z=0;do z|=A&1,A>>>=1,z<<=1;while(--Q>0);return z>>>1},Ge=A=>{A.bi_valid===16?(de(A,A.bi_buf),A.bi_buf=0,A.bi_valid=0):A.bi_valid>=8&&(A.pending_buf[A.pending++]=A.bi_buf&255,A.bi_buf>>=8,A.bi_valid-=8)},We=(A,Q)=>{const z=Q.dyn_tree,ne=Q.max_code,le=Q.stat_desc.static_tree,ce=Q.stat_desc.has_stree,ze=Q.stat_desc.extra_bits,Ae=Q.stat_desc.extra_base,ht=Q.stat_desc.max_length;let _e,Pe,Ft,nt,Ye,$t,Xt=0;for(nt=0;nt<=_;nt++)A.bl_count[nt]=0;for(z[A.heap[A.heap_max]*2+1]=0,_e=A.heap_max+1;_e<w;_e++)Pe=A.heap[_e],nt=z[z[Pe*2+1]*2+1]+1,nt>ht&&(nt=ht,Xt++),z[Pe*2+1]=nt,!(Pe>ne)&&(A.bl_count[nt]++,Ye=0,Pe>=Ae&&(Ye=ze[Pe-Ae]),$t=z[Pe*2],A.opt_len+=$t*(nt+Ye),ce&&(A.static_len+=$t*(le[Pe*2+1]+Ye)));if(Xt!==0){do{for(nt=ht-1;A.bl_count[nt]===0;)nt--;A.bl_count[nt]--,A.bl_count[nt+1]+=2,A.bl_count[ht]--,Xt-=2}while(Xt>0);for(nt=ht;nt!==0;nt--)for(Pe=A.bl_count[nt];Pe!==0;)Ft=A.heap[--_e],!(Ft>ne)&&(z[Ft*2+1]!==nt&&(A.opt_len+=(nt-z[Ft*2+1])*z[Ft*2],z[Ft*2+1]=nt),Pe--)}},Oe=(A,Q,z)=>{const ne=new Array(_+1);let le=0,ce,ze;for(ce=1;ce<=_;ce++)le=le+z[ce-1]<<1,ne[ce]=le;for(ze=0;ze<=Q;ze++){let Ae=A[ze*2+1];Ae!==0&&(A[ze*2]=Re(ne[Ae]++,Ae))}},me=()=>{let A,Q,z,ne,le;const ce=new Array(_+1);for(z=0,ne=0;ne<T-1;ne++)for(Y[ne]=z,A=0;A<1<<D[ne];A++)B[z++]=ne;for(B[z-1]=ne,le=0,ne=0;ne<16;ne++)for(X[ne]=le,A=0;A<1<<L[ne];A++)U[le++]=ne;for(le>>=7;ne<s;ne++)for(X[ne]=le<<7,A=0;A<1<<L[ne]-7;A++)U[256+le++]=ne;for(Q=0;Q<=_;Q++)ce[Q]=0;for(A=0;A<=143;)H[A*2+1]=8,A++,ce[8]++;for(;A<=255;)H[A*2+1]=9,A++,ce[9]++;for(;A<=279;)H[A*2+1]=7,A++,ce[7]++;for(;A<=287;)H[A*2+1]=8,A++,ce[8]++;for(Oe(H,a+1,ce),A=0;A<s;A++)q[A*2+1]=5,q[A*2]=Re(A,5);J=new N(H,D,C+1,a,_),ae=new N(q,L,0,s,_),se=new N(new Array(0),V,0,c,l)},Fe=A=>{let Q;for(Q=0;Q<a;Q++)A.dyn_ltree[Q*2]=0;for(Q=0;Q<s;Q++)A.dyn_dtree[Q*2]=0;for(Q=0;Q<c;Q++)A.bl_tree[Q*2]=0;A.dyn_ltree[h*2]=1,A.opt_len=A.static_len=0,A.sym_next=A.matches=0},qe=A=>{A.bi_valid>8?de(A,A.bi_buf):A.bi_valid>0&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0},Qe=(A,Q,z,ne)=>{const le=Q*2,ce=z*2;return A[le]<A[ce]||A[le]===A[ce]&&ne[Q]<=ne[z]},st=(A,Q,z)=>{const ne=A.heap[z];let le=z<<1;for(;le<=A.heap_len&&(le<A.heap_len&&Qe(Q,A.heap[le+1],A.heap[le],A.depth)&&le++,!Qe(Q,ne,A.heap[le],A.depth));)A.heap[z]=A.heap[le],z=le,le<<=1;A.heap[z]=ne},ot=(A,Q,z)=>{let ne,le,ce=0,ze,Ae;if(A.sym_next!==0)do ne=A.pending_buf[A.sym_buf+ce++]&255,ne+=(A.pending_buf[A.sym_buf+ce++]&255)<<8,le=A.pending_buf[A.sym_buf+ce++],ne===0?ge(A,le,Q):(ze=B[le],ge(A,ze+C+1,Q),Ae=D[ze],Ae!==0&&(le-=Y[ze],ue(A,le,Ae)),ne--,ze=pe(ne),ge(A,ze,z),Ae=L[ze],Ae!==0&&(ne-=X[ze],ue(A,ne,Ae)));while(ce<A.sym_next);ge(A,h,Q)},Ke=(A,Q)=>{const z=Q.dyn_tree,ne=Q.stat_desc.static_tree,le=Q.stat_desc.has_stree,ce=Q.stat_desc.elems;let ze,Ae,ht=-1,_e;for(A.heap_len=0,A.heap_max=w,ze=0;ze<ce;ze++)z[ze*2]!==0?(A.heap[++A.heap_len]=ht=ze,A.depth[ze]=0):z[ze*2+1]=0;for(;A.heap_len<2;)_e=A.heap[++A.heap_len]=ht<2?++ht:0,z[_e*2]=1,A.depth[_e]=0,A.opt_len--,le&&(A.static_len-=ne[_e*2+1]);for(Q.max_code=ht,ze=A.heap_len>>1;ze>=1;ze--)st(A,z,ze);_e=ce;do ze=A.heap[1],A.heap[1]=A.heap[A.heap_len--],st(A,z,1),Ae=A.heap[1],A.heap[--A.heap_max]=ze,A.heap[--A.heap_max]=Ae,z[_e*2]=z[ze*2]+z[Ae*2],A.depth[_e]=(A.depth[ze]>=A.depth[Ae]?A.depth[ze]:A.depth[Ae])+1,z[ze*2+1]=z[Ae*2+1]=_e,A.heap[1]=_e++,st(A,z,1);while(A.heap_len>=2);A.heap[--A.heap_max]=A.heap[1],We(A,Q),Oe(z,ht,A.bl_count)},Je=(A,Q,z)=>{let ne,le=-1,ce,ze=Q[1],Ae=0,ht=7,_e=4;for(ze===0&&(ht=138,_e=3),Q[(z+1)*2+1]=65535,ne=0;ne<=z;ne++)ce=ze,ze=Q[(ne+1)*2+1],!(++Ae<ht&&ce===ze)&&(Ae<_e?A.bl_tree[ce*2]+=Ae:ce!==0?(ce!==le&&A.bl_tree[ce*2]++,A.bl_tree[S*2]++):Ae<=10?A.bl_tree[E*2]++:A.bl_tree[F*2]++,Ae=0,le=ce,ze===0?(ht=138,_e=3):ce===ze?(ht=6,_e=3):(ht=7,_e=4))},Xe=(A,Q,z)=>{let ne,le=-1,ce,ze=Q[1],Ae=0,ht=7,_e=4;for(ze===0&&(ht=138,_e=3),ne=0;ne<=z;ne++)if(ce=ze,ze=Q[(ne+1)*2+1],!(++Ae<ht&&ce===ze)){if(Ae<_e)do ge(A,ce,A.bl_tree);while(--Ae!==0);else ce!==0?(ce!==le&&(ge(A,ce,A.bl_tree),Ae--),ge(A,S,A.bl_tree),ue(A,Ae-3,2)):Ae<=10?(ge(A,E,A.bl_tree),ue(A,Ae-3,3)):(ge(A,F,A.bl_tree),ue(A,Ae-11,7));Ae=0,le=ce,ze===0?(ht=138,_e=3):ce===ze?(ht=6,_e=3):(ht=7,_e=4)}},Ne=A=>{let Q;for(Je(A,A.dyn_ltree,A.l_desc.max_code),Je(A,A.dyn_dtree,A.d_desc.max_code),Ke(A,A.bl_desc),Q=c-1;Q>=3&&A.bl_tree[O[Q]*2+1]===0;Q--);return A.opt_len+=3*(Q+1)+5+5+4,Q},Ue=(A,Q,z,ne)=>{let le;for(ue(A,Q-257,5),ue(A,z-1,5),ue(A,ne-4,4),le=0;le<ne;le++)ue(A,A.bl_tree[O[le]*2+1],3);Xe(A,A.dyn_ltree,Q-1),Xe(A,A.dyn_dtree,z-1)},ft=A=>{let Q=4093624447,z;for(z=0;z<=31;z++,Q>>>=1)if(Q&1&&A.dyn_ltree[z*2]!==0)return v;if(A.dyn_ltree[18]!==0||A.dyn_ltree[20]!==0||A.dyn_ltree[26]!==0)return x;for(z=32;z<C;z++)if(A.dyn_ltree[z*2]!==0)return x;return v};let ut=!1;const ee=A=>{ut||(me(),ut=!0),A.l_desc=new he(A.dyn_ltree,J),A.d_desc=new he(A.dyn_dtree,ae),A.bl_desc=new he(A.bl_tree,se),A.bi_buf=0,A.bi_valid=0,Fe(A)},ie=(A,Q,z,ne)=>{ue(A,(y<<1)+(ne?1:0),3),qe(A),de(A,z),de(A,~z),z&&A.pending_buf.set(A.window.subarray(Q,Q+z),A.pending),A.pending+=z},oe=A=>{ue(A,k<<1,3),ge(A,h,H),Ge(A)},we=(A,Q,z,ne)=>{let le,ce,ze=0;A.level>0?(A.strm.data_type===b&&(A.strm.data_type=ft(A)),Ke(A,A.l_desc),Ke(A,A.d_desc),ze=Ne(A),le=A.opt_len+3+7>>>3,ce=A.static_len+3+7>>>3,ce<=le&&(le=ce)):le=ce=z+5,z+4<=le&&Q!==-1?ie(A,Q,z,ne):A.strategy===u||ce===le?(ue(A,(k<<1)+(ne?1:0),3),ot(A,H,q)):(ue(A,(g<<1)+(ne?1:0),3),Ue(A,A.l_desc.max_code+1,A.d_desc.max_code+1,ze+1),ot(A,A.dyn_ltree,A.dyn_dtree)),Fe(A),ne&&qe(A)},Se=(A,Q,z)=>(A.pending_buf[A.sym_buf+A.sym_next++]=Q,A.pending_buf[A.sym_buf+A.sym_next++]=Q>>8,A.pending_buf[A.sym_buf+A.sym_next++]=z,Q===0?A.dyn_ltree[z*2]++:(A.matches++,Q--,A.dyn_ltree[(B[z]+C+1)*2]++,A.dyn_dtree[pe(Q)*2]++),A.sym_next===A.sym_end);var He=ee,Be=ie,K=we,xe=Se,Me=oe,$e={_tr_init:He,_tr_stored_block:Be,_tr_flush_block:K,_tr_tally:xe,_tr_align:Me},ye=(A,Q,z,ne)=>{let le=A&65535|0,ce=A>>>16&65535|0,ze=0;for(;z!==0;){ze=z>2e3?2e3:z,z-=ze;do le=le+Q[ne++]|0,ce=ce+le|0;while(--ze);le%=65521,ce%=65521}return le|ce<<16|0};const je=()=>{let A,Q=[];for(var z=0;z<256;z++){A=z;for(var ne=0;ne<8;ne++)A=A&1?3988292384^A>>>1:A>>>1;Q[z]=A}return Q},Z=new Uint32Array(je());var De=(A,Q,z,ne)=>{const le=Z,ce=ne+z;A^=-1;for(let ze=ne;ze<ce;ze++)A=A>>>8^le[(A^Q[ze])&255];return A^-1},rt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},G={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Te,_tr_stored_block:Ee,_tr_flush_block:re,_tr_tally:ve,_tr_align:ke}=$e,{Z_NO_FLUSH:ct,Z_PARTIAL_FLUSH:lt,Z_FULL_FLUSH:dt,Z_FINISH:yt,Z_BLOCK:ir,Z_OK:At,Z_STREAM_END:Mt,Z_STREAM_ERROR:Pt,Z_DATA_ERROR:Qt,Z_BUF_ERROR:Kt,Z_DEFAULT_COMPRESSION:Kr,Z_FILTERED:ai,Z_HUFFMAN_ONLY:Lt,Z_RLE:Wt,Z_FIXED:qt,Z_DEFAULT_STRATEGY:wr,Z_UNKNOWN:dr,Z_DEFLATED:Nr}=G,gn=9,vn=15,Wn=8,Gi=286,Jt=30,yn=19,Ei=2*Gi+1,Po=15,It=3,li=258,Vr=li+It+1,Hn=32,vr=42,Ps=57,Rr=69,Is=73,Fs=91,Ds=103,Wr=113,ui=666,nr=1,Zr=2,Ai=3,Ui=4,zs=3,ci=(A,Q)=>(A.msg=rt[Q],Q),$n=A=>A*2-(A>4?9:0),Dr=A=>{let Q=A.length;for(;--Q>=0;)A[Q]=0},Va=A=>{let Q,z,ne,le=A.w_size;Q=A.hash_size,ne=Q;do z=A.head[--ne],A.head[ne]=z>=le?z-le:0;while(--Q);Q=le,ne=Q;do z=A.prev[--ne],A.prev[ne]=z>=le?z-le:0;while(--Q)};let Hr=(A,Q,z)=>(Q<<A.hash_shift^z)&A.hash_mask;const Rt=A=>{const Q=A.state;let z=Q.pending;z>A.avail_out&&(z=A.avail_out),z!==0&&(A.output.set(Q.pending_buf.subarray(Q.pending_out,Q.pending_out+z),A.next_out),A.next_out+=z,Q.pending_out+=z,A.total_out+=z,A.avail_out-=z,Q.pending-=z,Q.pending===0&&(Q.pending_out=0))},Sr=(A,Q)=>{re(A,A.block_start>=0?A.block_start:-1,A.strstart-A.block_start,Q),A.block_start=A.strstart,Rt(A.strm)},jt=(A,Q)=>{A.pending_buf[A.pending++]=Q},Ti=(A,Q)=>{A.pending_buf[A.pending++]=Q>>>8&255,A.pending_buf[A.pending++]=Q&255},qn=(A,Q,z,ne)=>{let le=A.avail_in;return le>ne&&(le=ne),le===0?0:(A.avail_in-=le,Q.set(A.input.subarray(A.next_in,A.next_in+le),z),A.state.wrap===1?A.adler=ye(A.adler,Q,le,z):A.state.wrap===2&&(A.adler=De(A.adler,Q,le,z)),A.next_in+=le,A.total_in+=le,le)},Ls=(A,Q)=>{let z=A.max_chain_length,ne=A.strstart,le,ce,ze=A.prev_length,Ae=A.nice_match;const ht=A.strstart>A.w_size-Vr?A.strstart-(A.w_size-Vr):0,_e=A.window,Pe=A.w_mask,Ft=A.prev,nt=A.strstart+li;let Ye=_e[ne+ze-1],$t=_e[ne+ze];A.prev_length>=A.good_match&&(z>>=2),Ae>A.lookahead&&(Ae=A.lookahead);do if(le=Q,!(_e[le+ze]!==$t||_e[le+ze-1]!==Ye||_e[le]!==_e[ne]||_e[++le]!==_e[ne+1])){ne+=2,le++;do;while(_e[++ne]===_e[++le]&&_e[++ne]===_e[++le]&&_e[++ne]===_e[++le]&&_e[++ne]===_e[++le]&&_e[++ne]===_e[++le]&&_e[++ne]===_e[++le]&&_e[++ne]===_e[++le]&&_e[++ne]===_e[++le]&&ne<nt);if(ce=li-(nt-ne),ne=nt-li,ce>ze){if(A.match_start=Q,ze=ce,ce>=Ae)break;Ye=_e[ne+ze-1],$t=_e[ne+ze]}}while((Q=Ft[Q&Pe])>ht&&--z!==0);return ze<=A.lookahead?ze:A.lookahead},Mi=A=>{const Q=A.w_size;let z,ne,le;do{if(ne=A.window_size-A.lookahead-A.strstart,A.strstart>=Q+(Q-Vr)&&(A.window.set(A.window.subarray(Q,Q+Q-ne),0),A.match_start-=Q,A.strstart-=Q,A.block_start-=Q,A.insert>A.strstart&&(A.insert=A.strstart),Va(A),ne+=Q),A.strm.avail_in===0)break;if(z=qn(A.strm,A.window,A.strstart+A.lookahead,ne),A.lookahead+=z,A.lookahead+A.insert>=It)for(le=A.strstart-A.insert,A.ins_h=A.window[le],A.ins_h=Hr(A,A.ins_h,A.window[le+1]);A.insert&&(A.ins_h=Hr(A,A.ins_h,A.window[le+It-1]),A.prev[le&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=le,le++,A.insert--,!(A.lookahead+A.insert<It)););}while(A.lookahead<Vr&&A.strm.avail_in!==0)},Yn=(A,Q)=>{let z=A.pending_buf_size-5>A.w_size?A.w_size:A.pending_buf_size-5,ne,le,ce,ze=0,Ae=A.strm.avail_in;do{if(ne=65535,ce=A.bi_valid+42>>3,A.strm.avail_out<ce||(ce=A.strm.avail_out-ce,le=A.strstart-A.block_start,ne>le+A.strm.avail_in&&(ne=le+A.strm.avail_in),ne>ce&&(ne=ce),ne<z&&(ne===0&&Q!==yt||Q===ct||ne!==le+A.strm.avail_in)))break;ze=Q===yt&&ne===le+A.strm.avail_in?1:0,Ee(A,0,0,ze),A.pending_buf[A.pending-4]=ne,A.pending_buf[A.pending-3]=ne>>8,A.pending_buf[A.pending-2]=~ne,A.pending_buf[A.pending-1]=~ne>>8,Rt(A.strm),le&&(le>ne&&(le=ne),A.strm.output.set(A.window.subarray(A.block_start,A.block_start+le),A.strm.next_out),A.strm.next_out+=le,A.strm.avail_out-=le,A.strm.total_out+=le,A.block_start+=le,ne-=le),ne&&(qn(A.strm,A.strm.output,A.strm.next_out,ne),A.strm.next_out+=ne,A.strm.avail_out-=ne,A.strm.total_out+=ne)}while(ze===0);return Ae-=A.strm.avail_in,Ae&&(Ae>=A.w_size?(A.matches=2,A.window.set(A.strm.input.subarray(A.strm.next_in-A.w_size,A.strm.next_in),0),A.strstart=A.w_size,A.insert=A.strstart):(A.window_size-A.strstart<=Ae&&(A.strstart-=A.w_size,A.window.set(A.window.subarray(A.w_size,A.w_size+A.strstart),0),A.matches<2&&A.matches++,A.insert>A.strstart&&(A.insert=A.strstart)),A.window.set(A.strm.input.subarray(A.strm.next_in-Ae,A.strm.next_in),A.strstart),A.strstart+=Ae,A.insert+=Ae>A.w_size-A.insert?A.w_size-A.insert:Ae),A.block_start=A.strstart),A.high_water<A.strstart&&(A.high_water=A.strstart),ze?Ui:Q!==ct&&Q!==yt&&A.strm.avail_in===0&&A.strstart===A.block_start?Zr:(ce=A.window_size-A.strstart,A.strm.avail_in>ce&&A.block_start>=A.w_size&&(A.block_start-=A.w_size,A.strstart-=A.w_size,A.window.set(A.window.subarray(A.w_size,A.w_size+A.strstart),0),A.matches<2&&A.matches++,ce+=A.w_size,A.insert>A.strstart&&(A.insert=A.strstart)),ce>A.strm.avail_in&&(ce=A.strm.avail_in),ce&&(qn(A.strm,A.window,A.strstart,ce),A.strstart+=ce,A.insert+=ce>A.w_size-A.insert?A.w_size-A.insert:ce),A.high_water<A.strstart&&(A.high_water=A.strstart),ce=A.bi_valid+42>>3,ce=A.pending_buf_size-ce>65535?65535:A.pending_buf_size-ce,z=ce>A.w_size?A.w_size:ce,le=A.strstart-A.block_start,(le>=z||(le||Q===yt)&&Q!==ct&&A.strm.avail_in===0&&le<=ce)&&(ne=le>ce?ce:le,ze=Q===yt&&A.strm.avail_in===0&&ne===le?1:0,Ee(A,A.block_start,ne,ze),A.block_start+=ne,Rt(A.strm)),ze?Ai:nr)},Wi=(A,Q)=>{let z,ne;for(;;){if(A.lookahead<Vr){if(Mi(A),A.lookahead<Vr&&Q===ct)return nr;if(A.lookahead===0)break}if(z=0,A.lookahead>=It&&(A.ins_h=Hr(A,A.ins_h,A.window[A.strstart+It-1]),z=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),z!==0&&A.strstart-z<=A.w_size-Vr&&(A.match_length=Ls(A,z)),A.match_length>=It)if(ne=ve(A,A.strstart-A.match_start,A.match_length-It),A.lookahead-=A.match_length,A.match_length<=A.max_lazy_match&&A.lookahead>=It){A.match_length--;do A.strstart++,A.ins_h=Hr(A,A.ins_h,A.window[A.strstart+It-1]),z=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart;while(--A.match_length!==0);A.strstart++}else A.strstart+=A.match_length,A.match_length=0,A.ins_h=A.window[A.strstart],A.ins_h=Hr(A,A.ins_h,A.window[A.strstart+1]);else ne=ve(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++;if(ne&&(Sr(A,!1),A.strm.avail_out===0))return nr}return A.insert=A.strstart<It-1?A.strstart:It-1,Q===yt?(Sr(A,!0),A.strm.avail_out===0?Ai:Ui):A.sym_next&&(Sr(A,!1),A.strm.avail_out===0)?nr:Zr},kr=(A,Q)=>{let z,ne,le;for(;;){if(A.lookahead<Vr){if(Mi(A),A.lookahead<Vr&&Q===ct)return nr;if(A.lookahead===0)break}if(z=0,A.lookahead>=It&&(A.ins_h=Hr(A,A.ins_h,A.window[A.strstart+It-1]),z=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),A.prev_length=A.match_length,A.prev_match=A.match_start,A.match_length=It-1,z!==0&&A.prev_length<A.max_lazy_match&&A.strstart-z<=A.w_size-Vr&&(A.match_length=Ls(A,z),A.match_length<=5&&(A.strategy===ai||A.match_length===It&&A.strstart-A.match_start>4096)&&(A.match_length=It-1)),A.prev_length>=It&&A.match_length<=A.prev_length){le=A.strstart+A.lookahead-It,ne=ve(A,A.strstart-1-A.prev_match,A.prev_length-It),A.lookahead-=A.prev_length-1,A.prev_length-=2;do++A.strstart<=le&&(A.ins_h=Hr(A,A.ins_h,A.window[A.strstart+It-1]),z=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart);while(--A.prev_length!==0);if(A.match_available=0,A.match_length=It-1,A.strstart++,ne&&(Sr(A,!1),A.strm.avail_out===0))return nr}else if(A.match_available){if(ne=ve(A,0,A.window[A.strstart-1]),ne&&Sr(A,!1),A.strstart++,A.lookahead--,A.strm.avail_out===0)return nr}else A.match_available=1,A.strstart++,A.lookahead--}return A.match_available&&(ne=ve(A,0,A.window[A.strstart-1]),A.match_available=0),A.insert=A.strstart<It-1?A.strstart:It-1,Q===yt?(Sr(A,!0),A.strm.avail_out===0?Ai:Ui):A.sym_next&&(Sr(A,!1),A.strm.avail_out===0)?nr:Zr},di=(A,Q)=>{let z,ne,le,ce;const ze=A.window;for(;;){if(A.lookahead<=li){if(Mi(A),A.lookahead<=li&&Q===ct)return nr;if(A.lookahead===0)break}if(A.match_length=0,A.lookahead>=It&&A.strstart>0&&(le=A.strstart-1,ne=ze[le],ne===ze[++le]&&ne===ze[++le]&&ne===ze[++le])){ce=A.strstart+li;do;while(ne===ze[++le]&&ne===ze[++le]&&ne===ze[++le]&&ne===ze[++le]&&ne===ze[++le]&&ne===ze[++le]&&ne===ze[++le]&&ne===ze[++le]&&le<ce);A.match_length=li-(ce-le),A.match_length>A.lookahead&&(A.match_length=A.lookahead)}if(A.match_length>=It?(z=ve(A,1,A.match_length-It),A.lookahead-=A.match_length,A.strstart+=A.match_length,A.match_length=0):(z=ve(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++),z&&(Sr(A,!1),A.strm.avail_out===0))return nr}return A.insert=0,Q===yt?(Sr(A,!0),A.strm.avail_out===0?Ai:Ui):A.sym_next&&(Sr(A,!1),A.strm.avail_out===0)?nr:Zr},hi=(A,Q)=>{let z;for(;;){if(A.lookahead===0&&(Mi(A),A.lookahead===0)){if(Q===ct)return nr;break}if(A.match_length=0,z=ve(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++,z&&(Sr(A,!1),A.strm.avail_out===0))return nr}return A.insert=0,Q===yt?(Sr(A,!0),A.strm.avail_out===0?Ai:Ui):A.sym_next&&(Sr(A,!1),A.strm.avail_out===0)?nr:Zr};function Cr(A,Q,z,ne,le){this.good_length=A,this.max_lazy=Q,this.nice_length=z,this.max_chain=ne,this.func=le}const ei=[new Cr(0,0,0,0,Yn),new Cr(4,4,8,4,Wi),new Cr(4,5,16,8,Wi),new Cr(4,6,32,32,Wi),new Cr(4,4,16,16,kr),new Cr(8,16,32,32,kr),new Cr(8,16,128,128,kr),new Cr(8,32,128,256,kr),new Cr(32,128,258,1024,kr),new Cr(32,258,258,4096,kr)],fi=A=>{A.window_size=2*A.w_size,Dr(A.head),A.max_lazy_match=ei[A.level].max_lazy,A.good_match=ei[A.level].good_length,A.nice_match=ei[A.level].nice_length,A.max_chain_length=ei[A.level].max_chain,A.strstart=0,A.block_start=0,A.lookahead=0,A.insert=0,A.match_length=A.prev_length=It-1,A.match_available=0,A.ins_h=0};function Ba(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Nr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Ei*2),this.dyn_dtree=new Uint16Array((2*Jt+1)*2),this.bl_tree=new Uint16Array((2*yn+1)*2),Dr(this.dyn_ltree),Dr(this.dyn_dtree),Dr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Po+1),this.heap=new Uint16Array(2*Gi+1),Dr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Gi+1),Dr(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Hi=A=>{if(!A)return 1;const Q=A.state;return!Q||Q.strm!==A||Q.status!==vr&&Q.status!==Ps&&Q.status!==Rr&&Q.status!==Is&&Q.status!==Fs&&Q.status!==Ds&&Q.status!==Wr&&Q.status!==ui?1:0},$i=A=>{if(Hi(A))return ci(A,Pt);A.total_in=A.total_out=0,A.data_type=dr;const Q=A.state;return Q.pending=0,Q.pending_out=0,Q.wrap<0&&(Q.wrap=-Q.wrap),Q.status=Q.wrap===2?Ps:Q.wrap?vr:Wr,A.adler=Q.wrap===2?0:1,Q.last_flush=-2,Te(Q),At},Io=A=>{const Q=$i(A);return Q===At&&fi(A.state),Q},Fo=(A,Q)=>Hi(A)||A.state.wrap!==2?Pt:(A.state.gzhead=Q,At),xn=(A,Q,z,ne,le,ce)=>{if(!A)return Pt;let ze=1;if(Q===Kr&&(Q=6),ne<0?(ze=0,ne=-ne):ne>15&&(ze=2,ne-=16),le<1||le>gn||z!==Nr||ne<8||ne>15||Q<0||Q>9||ce<0||ce>qt||ne===8&&ze!==1)return ci(A,Pt);ne===8&&(ne=9);const Ae=new Ba;return A.state=Ae,Ae.strm=A,Ae.status=vr,Ae.wrap=ze,Ae.gzhead=null,Ae.w_bits=ne,Ae.w_size=1<<Ae.w_bits,Ae.w_mask=Ae.w_size-1,Ae.hash_bits=le+7,Ae.hash_size=1<<Ae.hash_bits,Ae.hash_mask=Ae.hash_size-1,Ae.hash_shift=~~((Ae.hash_bits+It-1)/It),Ae.window=new Uint8Array(Ae.w_size*2),Ae.head=new Uint16Array(Ae.hash_size),Ae.prev=new Uint16Array(Ae.w_size),Ae.lit_bufsize=1<<le+6,Ae.pending_buf_size=Ae.lit_bufsize*4,Ae.pending_buf=new Uint8Array(Ae.pending_buf_size),Ae.sym_buf=Ae.lit_bufsize,Ae.sym_end=(Ae.lit_bufsize-1)*3,Ae.level=Q,Ae.strategy=ce,Ae.method=z,Io(A)},Do=(A,Q)=>xn(A,Q,Nr,vn,Wn,wr),Ga=(A,Q)=>{if(Hi(A)||Q>ir||Q<0)return A?ci(A,Pt):Pt;const z=A.state;if(!A.output||A.avail_in!==0&&!A.input||z.status===ui&&Q!==yt)return ci(A,A.avail_out===0?Kt:Pt);const ne=z.last_flush;if(z.last_flush=Q,z.pending!==0){if(Rt(A),A.avail_out===0)return z.last_flush=-1,At}else if(A.avail_in===0&&$n(Q)<=$n(ne)&&Q!==yt)return ci(A,Kt);if(z.status===ui&&A.avail_in!==0)return ci(A,Kt);if(z.status===vr&&z.wrap===0&&(z.status=Wr),z.status===vr){let le=Nr+(z.w_bits-8<<4)<<8,ce=-1;if(z.strategy>=Lt||z.level<2?ce=0:z.level<6?ce=1:z.level===6?ce=2:ce=3,le|=ce<<6,z.strstart!==0&&(le|=Hn),le+=31-le%31,Ti(z,le),z.strstart!==0&&(Ti(z,A.adler>>>16),Ti(z,A.adler&65535)),A.adler=1,z.status=Wr,Rt(A),z.pending!==0)return z.last_flush=-1,At}if(z.status===Ps){if(A.adler=0,jt(z,31),jt(z,139),jt(z,8),z.gzhead)jt(z,(z.gzhead.text?1:0)+(z.gzhead.hcrc?2:0)+(z.gzhead.extra?4:0)+(z.gzhead.name?8:0)+(z.gzhead.comment?16:0)),jt(z,z.gzhead.time&255),jt(z,z.gzhead.time>>8&255),jt(z,z.gzhead.time>>16&255),jt(z,z.gzhead.time>>24&255),jt(z,z.level===9?2:z.strategy>=Lt||z.level<2?4:0),jt(z,z.gzhead.os&255),z.gzhead.extra&&z.gzhead.extra.length&&(jt(z,z.gzhead.extra.length&255),jt(z,z.gzhead.extra.length>>8&255)),z.gzhead.hcrc&&(A.adler=De(A.adler,z.pending_buf,z.pending,0)),z.gzindex=0,z.status=Rr;else if(jt(z,0),jt(z,0),jt(z,0),jt(z,0),jt(z,0),jt(z,z.level===9?2:z.strategy>=Lt||z.level<2?4:0),jt(z,zs),z.status=Wr,Rt(A),z.pending!==0)return z.last_flush=-1,At}if(z.status===Rr){if(z.gzhead.extra){let le=z.pending,ce=(z.gzhead.extra.length&65535)-z.gzindex;for(;z.pending+ce>z.pending_buf_size;){let Ae=z.pending_buf_size-z.pending;if(z.pending_buf.set(z.gzhead.extra.subarray(z.gzindex,z.gzindex+Ae),z.pending),z.pending=z.pending_buf_size,z.gzhead.hcrc&&z.pending>le&&(A.adler=De(A.adler,z.pending_buf,z.pending-le,le)),z.gzindex+=Ae,Rt(A),z.pending!==0)return z.last_flush=-1,At;le=0,ce-=Ae}let ze=new Uint8Array(z.gzhead.extra);z.pending_buf.set(ze.subarray(z.gzindex,z.gzindex+ce),z.pending),z.pending+=ce,z.gzhead.hcrc&&z.pending>le&&(A.adler=De(A.adler,z.pending_buf,z.pending-le,le)),z.gzindex=0}z.status=Is}if(z.status===Is){if(z.gzhead.name){let le=z.pending,ce;do{if(z.pending===z.pending_buf_size){if(z.gzhead.hcrc&&z.pending>le&&(A.adler=De(A.adler,z.pending_buf,z.pending-le,le)),Rt(A),z.pending!==0)return z.last_flush=-1,At;le=0}z.gzindex<z.gzhead.name.length?ce=z.gzhead.name.charCodeAt(z.gzindex++)&255:ce=0,jt(z,ce)}while(ce!==0);z.gzhead.hcrc&&z.pending>le&&(A.adler=De(A.adler,z.pending_buf,z.pending-le,le)),z.gzindex=0}z.status=Fs}if(z.status===Fs){if(z.gzhead.comment){let le=z.pending,ce;do{if(z.pending===z.pending_buf_size){if(z.gzhead.hcrc&&z.pending>le&&(A.adler=De(A.adler,z.pending_buf,z.pending-le,le)),Rt(A),z.pending!==0)return z.last_flush=-1,At;le=0}z.gzindex<z.gzhead.comment.length?ce=z.gzhead.comment.charCodeAt(z.gzindex++)&255:ce=0,jt(z,ce)}while(ce!==0);z.gzhead.hcrc&&z.pending>le&&(A.adler=De(A.adler,z.pending_buf,z.pending-le,le))}z.status=Ds}if(z.status===Ds){if(z.gzhead.hcrc){if(z.pending+2>z.pending_buf_size&&(Rt(A),z.pending!==0))return z.last_flush=-1,At;jt(z,A.adler&255),jt(z,A.adler>>8&255),A.adler=0}if(z.status=Wr,Rt(A),z.pending!==0)return z.last_flush=-1,At}if(A.avail_in!==0||z.lookahead!==0||Q!==ct&&z.status!==ui){let le=z.level===0?Yn(z,Q):z.strategy===Lt?hi(z,Q):z.strategy===Wt?di(z,Q):ei[z.level].func(z,Q);if((le===Ai||le===Ui)&&(z.status=ui),le===nr||le===Ai)return A.avail_out===0&&(z.last_flush=-1),At;if(le===Zr&&(Q===lt?ke(z):Q!==ir&&(Ee(z,0,0,!1),Q===dt&&(Dr(z.head),z.lookahead===0&&(z.strstart=0,z.block_start=0,z.insert=0))),Rt(A),A.avail_out===0))return z.last_flush=-1,At}return Q!==yt?At:z.wrap<=0?Mt:(z.wrap===2?(jt(z,A.adler&255),jt(z,A.adler>>8&255),jt(z,A.adler>>16&255),jt(z,A.adler>>24&255),jt(z,A.total_in&255),jt(z,A.total_in>>8&255),jt(z,A.total_in>>16&255),jt(z,A.total_in>>24&255)):(Ti(z,A.adler>>>16),Ti(z,A.adler&65535)),Rt(A),z.wrap>0&&(z.wrap=-z.wrap),z.pending!==0?At:Mt)},_n=A=>{if(Hi(A))return Pt;const Q=A.state.status;return A.state=null,Q===Wr?ci(A,Qt):At},bn=(A,Q)=>{let z=Q.length;if(Hi(A))return Pt;const ne=A.state,le=ne.wrap;if(le===2||le===1&&ne.status!==vr||ne.lookahead)return Pt;if(le===1&&(A.adler=ye(A.adler,Q,z,0)),ne.wrap=0,z>=ne.w_size){le===0&&(Dr(ne.head),ne.strstart=0,ne.block_start=0,ne.insert=0);let ht=new Uint8Array(ne.w_size);ht.set(Q.subarray(z-ne.w_size,z),0),Q=ht,z=ne.w_size}const ce=A.avail_in,ze=A.next_in,Ae=A.input;for(A.avail_in=z,A.next_in=0,A.input=Q,Mi(ne);ne.lookahead>=It;){let ht=ne.strstart,_e=ne.lookahead-(It-1);do ne.ins_h=Hr(ne,ne.ins_h,ne.window[ht+It-1]),ne.prev[ht&ne.w_mask]=ne.head[ne.ins_h],ne.head[ne.ins_h]=ht,ht++;while(--_e);ne.strstart=ht,ne.lookahead=It-1,Mi(ne)}return ne.strstart+=ne.lookahead,ne.block_start=ne.strstart,ne.insert=ne.lookahead,ne.lookahead=0,ne.match_length=ne.prev_length=It-1,ne.match_available=0,A.next_in=ze,A.input=Ae,A.avail_in=ce,ne.wrap=le,At};var qi=Do,Xn=xn,Ua=Io,Wa=$i,Os=Fo,Jn=Ga,js=_n,zo=bn,pi="pako deflate (from Nodeca project)",Ri={deflateInit:qi,deflateInit2:Xn,deflateReset:Ua,deflateResetKeep:Wa,deflateSetHeader:Os,deflate:Jn,deflateEnd:js,deflateSetDictionary:zo,deflateInfo:pi};const Qn=(A,Q)=>Object.prototype.hasOwnProperty.call(A,Q);var Lo=function(A){const Q=Array.prototype.slice.call(arguments,1);for(;Q.length;){const z=Q.shift();if(z){if(typeof z!="object")throw new TypeError(z+"must be non-object");for(const ne in z)Qn(z,ne)&&(A[ne]=z[ne])}}return A},Kn=A=>{let Q=0;for(let ne=0,le=A.length;ne<le;ne++)Q+=A[ne].length;const z=new Uint8Array(Q);for(let ne=0,le=0,ce=A.length;ne<ce;ne++){let ze=A[ne];z.set(ze,le),le+=ze.length}return z},ki={assign:Lo,flattenChunks:Kn};let Ns=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Ns=!1}const lr=new Uint8Array(256);for(let A=0;A<256;A++)lr[A]=A>=252?6:A>=248?5:A>=240?4:A>=224?3:A>=192?2:1;lr[254]=lr[254]=1;var Yi=A=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(A);let Q,z,ne,le,ce,ze=A.length,Ae=0;for(le=0;le<ze;le++)z=A.charCodeAt(le),(z&64512)===55296&&le+1<ze&&(ne=A.charCodeAt(le+1),(ne&64512)===56320&&(z=65536+(z-55296<<10)+(ne-56320),le++)),Ae+=z<128?1:z<2048?2:z<65536?3:4;for(Q=new Uint8Array(Ae),ce=0,le=0;ce<Ae;le++)z=A.charCodeAt(le),(z&64512)===55296&&le+1<ze&&(ne=A.charCodeAt(le+1),(ne&64512)===56320&&(z=65536+(z-55296<<10)+(ne-56320),le++)),z<128?Q[ce++]=z:z<2048?(Q[ce++]=192|z>>>6,Q[ce++]=128|z&63):z<65536?(Q[ce++]=224|z>>>12,Q[ce++]=128|z>>>6&63,Q[ce++]=128|z&63):(Q[ce++]=240|z>>>18,Q[ce++]=128|z>>>12&63,Q[ce++]=128|z>>>6&63,Q[ce++]=128|z&63);return Q};const Vs=(A,Q)=>{if(Q<65534&&A.subarray&&Ns)return String.fromCharCode.apply(null,A.length===Q?A:A.subarray(0,Q));let z="";for(let ne=0;ne<Q;ne++)z+=String.fromCharCode(A[ne]);return z};var wn=(A,Q)=>{const z=Q||A.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(A.subarray(0,Q));let ne,le;const ce=new Array(z*2);for(le=0,ne=0;ne<z;){let ze=A[ne++];if(ze<128){ce[le++]=ze;continue}let Ae=lr[ze];if(Ae>4){ce[le++]=65533,ne+=Ae-1;continue}for(ze&=Ae===2?31:Ae===3?15:7;Ae>1&&ne<z;)ze=ze<<6|A[ne++]&63,Ae--;if(Ae>1){ce[le++]=65533;continue}ze<65536?ce[le++]=ze:(ze-=65536,ce[le++]=55296|ze>>10&1023,ce[le++]=56320|ze&1023)}return Vs(ce,le)},Ha=(A,Q)=>{Q=Q||A.length,Q>A.length&&(Q=A.length);let z=Q-1;for(;z>=0&&(A[z]&192)===128;)z--;return z<0||z===0?Q:z+lr[A[z]]>Q?z:Q},Pi={string2buf:Yi,buf2string:wn,utf8border:Ha};function Bs(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Xi=Bs;const Sn=Object.prototype.toString,{Z_NO_FLUSH:Oo,Z_SYNC_FLUSH:$a,Z_FULL_FLUSH:qa,Z_FINISH:Ya,Z_OK:Ji,Z_STREAM_END:Xa,Z_DEFAULT_COMPRESSION:Ja,Z_DEFAULT_STRATEGY:Qa,Z_DEFLATED:Ka}=G;function Cn(A){this.options=ki.assign({level:Ja,method:Ka,chunkSize:16384,windowBits:15,memLevel:8,strategy:Qa},A||{});let Q=this.options;Q.raw&&Q.windowBits>0?Q.windowBits=-Q.windowBits:Q.gzip&&Q.windowBits>0&&Q.windowBits<16&&(Q.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Xi,this.strm.avail_out=0;let z=Ri.deflateInit2(this.strm,Q.level,Q.method,Q.windowBits,Q.memLevel,Q.strategy);if(z!==Ji)throw new Error(rt[z]);if(Q.header&&Ri.deflateSetHeader(this.strm,Q.header),Q.dictionary){let ne;if(typeof Q.dictionary=="string"?ne=Pi.string2buf(Q.dictionary):Sn.call(Q.dictionary)==="[object ArrayBuffer]"?ne=new Uint8Array(Q.dictionary):ne=Q.dictionary,z=Ri.deflateSetDictionary(this.strm,ne),z!==Ji)throw new Error(rt[z]);this._dict_set=!0}}Cn.prototype.push=function(A,Q){const z=this.strm,ne=this.options.chunkSize;let le,ce;if(this.ended)return!1;for(Q===~~Q?ce=Q:ce=Q===!0?Ya:Oo,typeof A=="string"?z.input=Pi.string2buf(A):Sn.call(A)==="[object ArrayBuffer]"?z.input=new Uint8Array(A):z.input=A,z.next_in=0,z.avail_in=z.input.length;;){if(z.avail_out===0&&(z.output=new Uint8Array(ne),z.next_out=0,z.avail_out=ne),(ce===$a||ce===qa)&&z.avail_out<=6){this.onData(z.output.subarray(0,z.next_out)),z.avail_out=0;continue}if(le=Ri.deflate(z,ce),le===Xa)return z.next_out>0&&this.onData(z.output.subarray(0,z.next_out)),le=Ri.deflateEnd(this.strm),this.onEnd(le),this.ended=!0,le===Ji;if(z.avail_out===0){this.onData(z.output);continue}if(ce>0&&z.next_out>0){this.onData(z.output.subarray(0,z.next_out)),z.avail_out=0;continue}if(z.avail_in===0)break}return!0},Cn.prototype.onData=function(A){this.chunks.push(A)},Cn.prototype.onEnd=function(A){A===Ji&&(this.result=ki.flattenChunks(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg};function Zn(A,Q){const z=new Cn(Q);if(z.push(A,!0),z.err)throw z.msg||rt[z.err];return z.result}function Za(A,Q){return Q=Q||{},Q.raw=!0,Zn(A,Q)}function el(A,Q){return Q=Q||{},Q.gzip=!0,Zn(A,Q)}var tl=Cn,rl=Zn,Gs=Za,il=el,nl={Deflate:tl,deflate:rl,deflateRaw:Gs,gzip:il};const es=16209,jo=16191;var sl=function(A,Q){let z,ne,le,ce,ze,Ae,ht,_e,Pe,Ft,nt,Ye,$t,Xt,zt,bt,_t,tt,wt,tr,Ot,Dt,Bt,St;const kt=A.state;z=A.next_in,Bt=A.input,ne=z+(A.avail_in-5),le=A.next_out,St=A.output,ce=le-(Q-A.avail_out),ze=le+(A.avail_out-257),Ae=kt.dmax,ht=kt.wsize,_e=kt.whave,Pe=kt.wnext,Ft=kt.window,nt=kt.hold,Ye=kt.bits,$t=kt.lencode,Xt=kt.distcode,zt=(1<<kt.lenbits)-1,bt=(1<<kt.distbits)-1;e:do{Ye<15&&(nt+=Bt[z++]<<Ye,Ye+=8,nt+=Bt[z++]<<Ye,Ye+=8),_t=$t[nt&zt];t:for(;;){if(tt=_t>>>24,nt>>>=tt,Ye-=tt,tt=_t>>>16&255,tt===0)St[le++]=_t&65535;else if(tt&16){wt=_t&65535,tt&=15,tt&&(Ye<tt&&(nt+=Bt[z++]<<Ye,Ye+=8),wt+=nt&(1<<tt)-1,nt>>>=tt,Ye-=tt),Ye<15&&(nt+=Bt[z++]<<Ye,Ye+=8,nt+=Bt[z++]<<Ye,Ye+=8),_t=Xt[nt&bt];r:for(;;){if(tt=_t>>>24,nt>>>=tt,Ye-=tt,tt=_t>>>16&255,tt&16){if(tr=_t&65535,tt&=15,Ye<tt&&(nt+=Bt[z++]<<Ye,Ye+=8,Ye<tt&&(nt+=Bt[z++]<<Ye,Ye+=8)),tr+=nt&(1<<tt)-1,tr>Ae){A.msg="invalid distance too far back",kt.mode=es;break e}if(nt>>>=tt,Ye-=tt,tt=le-ce,tr>tt){if(tt=tr-tt,tt>_e&&kt.sane){A.msg="invalid distance too far back",kt.mode=es;break e}if(Ot=0,Dt=Ft,Pe===0){if(Ot+=ht-tt,tt<wt){wt-=tt;do St[le++]=Ft[Ot++];while(--tt);Ot=le-tr,Dt=St}}else if(Pe<tt){if(Ot+=ht+Pe-tt,tt-=Pe,tt<wt){wt-=tt;do St[le++]=Ft[Ot++];while(--tt);if(Ot=0,Pe<wt){tt=Pe,wt-=tt;do St[le++]=Ft[Ot++];while(--tt);Ot=le-tr,Dt=St}}}else if(Ot+=Pe-tt,tt<wt){wt-=tt;do St[le++]=Ft[Ot++];while(--tt);Ot=le-tr,Dt=St}for(;wt>2;)St[le++]=Dt[Ot++],St[le++]=Dt[Ot++],St[le++]=Dt[Ot++],wt-=3;wt&&(St[le++]=Dt[Ot++],wt>1&&(St[le++]=Dt[Ot++]))}else{Ot=le-tr;do St[le++]=St[Ot++],St[le++]=St[Ot++],St[le++]=St[Ot++],wt-=3;while(wt>2);wt&&(St[le++]=St[Ot++],wt>1&&(St[le++]=St[Ot++]))}}else if(tt&64){A.msg="invalid distance code",kt.mode=es;break e}else{_t=Xt[(_t&65535)+(nt&(1<<tt)-1)];continue r}break}}else if(tt&64)if(tt&32){kt.mode=jo;break e}else{A.msg="invalid literal/length code",kt.mode=es;break e}else{_t=$t[(_t&65535)+(nt&(1<<tt)-1)];continue t}break}}while(z<ne&&le<ze);wt=Ye>>3,z-=wt,Ye-=wt<<3,nt&=(1<<Ye)-1,A.next_in=z,A.next_out=le,A.avail_in=z<ne?5+(ne-z):5-(z-ne),A.avail_out=le<ze?257+(ze-le):257-(le-ze),kt.hold=nt,kt.bits=Ye};const Qi=15,No=852,Vo=592,Bo=0,Us=1,Go=2,Ws=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),En=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ol=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Uo=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Ki=(A,Q,z,ne,le,ce,ze,Ae)=>{const ht=Ae.bits;let _e=0,Pe=0,Ft=0,nt=0,Ye=0,$t=0,Xt=0,zt=0,bt=0,_t=0,tt,wt,tr,Ot,Dt,Bt=null,St;const kt=new Uint16Array(Qi+1),fr=new Uint16Array(Qi+1);let zr=null,_s,bs,_i;for(_e=0;_e<=Qi;_e++)kt[_e]=0;for(Pe=0;Pe<ne;Pe++)kt[Q[z+Pe]]++;for(Ye=ht,nt=Qi;nt>=1&&kt[nt]===0;nt--);if(Ye>nt&&(Ye=nt),nt===0)return le[ce++]=1<<24|64<<16|0,le[ce++]=1<<24|64<<16|0,Ae.bits=1,0;for(Ft=1;Ft<nt&&kt[Ft]===0;Ft++);for(Ye<Ft&&(Ye=Ft),zt=1,_e=1;_e<=Qi;_e++)if(zt<<=1,zt-=kt[_e],zt<0)return-1;if(zt>0&&(A===Bo||nt!==1))return-1;for(fr[1]=0,_e=1;_e<Qi;_e++)fr[_e+1]=fr[_e]+kt[_e];for(Pe=0;Pe<ne;Pe++)Q[z+Pe]!==0&&(ze[fr[Q[z+Pe]]++]=Pe);if(A===Bo?(Bt=zr=ze,St=20):A===Us?(Bt=Ws,zr=En,St=257):(Bt=ol,zr=Uo,St=0),_t=0,Pe=0,_e=Ft,Dt=ce,$t=Ye,Xt=0,tr=-1,bt=1<<Ye,Ot=bt-1,A===Us&&bt>No||A===Go&&bt>Vo)return 1;for(;;){_s=_e-Xt,ze[Pe]+1<St?(bs=0,_i=ze[Pe]):ze[Pe]>=St?(bs=zr[ze[Pe]-St],_i=Bt[ze[Pe]-St]):(bs=96,_i=0),tt=1<<_e-Xt,wt=1<<$t,Ft=wt;do wt-=tt,le[Dt+(_t>>Xt)+wt]=_s<<24|bs<<16|_i|0;while(wt!==0);for(tt=1<<_e-1;_t&tt;)tt>>=1;if(tt!==0?(_t&=tt-1,_t+=tt):_t=0,Pe++,--kt[_e]===0){if(_e===nt)break;_e=Q[z+ze[Pe]]}if(_e>Ye&&(_t&Ot)!==tr){for(Xt===0&&(Xt=Ye),Dt+=Ft,$t=_e-Xt,zt=1<<$t;$t+Xt<nt&&(zt-=kt[$t+Xt],!(zt<=0));)$t++,zt<<=1;if(bt+=1<<$t,A===Us&&bt>No||A===Go&&bt>Vo)return 1;tr=_t&Ot,le[tr]=Ye<<24|$t<<16|Dt-ce|0}}return _t!==0&&(le[Dt+_t]=_e-Xt<<24|64<<16|0),Ae.bits=Ye,0};const Wo=0,Hs=1,$s=2,{Z_FINISH:Ii,Z_BLOCK:al,Z_TREES:ts,Z_OK:Fi,Z_STREAM_END:Ho,Z_NEED_DICT:$o,Z_STREAM_ERROR:yr,Z_DATA_ERROR:Zi,Z_MEM_ERROR:qo,Z_BUF_ERROR:rs,Z_DEFLATED:Yo}=G,An=16180,is=16181,ns=16182,qs=16183,Xs=16184,Js=16185,Xo=16186,Jo=16187,Qo=16188,Ko=16189,ss=16190,sr=16191,Di=16192,Qs=16193,os=16194,Ks=16195,eo=16196,as=16197,Zo=16198,ls=16199,ti=16200,us=16201,en=16202,cs=16203,to=16204,Tn=16205,mi=16206,ds=16207,ro=16208,Gt=16209,io=16210,no=16211,ea=852,ta=592,ra=15,so=A=>(A>>>24&255)+(A>>>8&65280)+((A&65280)<<8)+((A&255)<<24);function gi(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ri=A=>{if(!A)return 1;const Q=A.state;return!Q||Q.strm!==A||Q.mode<An||Q.mode>no?1:0},hs=A=>{if(ri(A))return yr;const Q=A.state;return A.total_in=A.total_out=Q.total=0,A.msg="",Q.wrap&&(A.adler=Q.wrap&1),Q.mode=An,Q.last=0,Q.havedict=0,Q.flags=-1,Q.dmax=32768,Q.head=null,Q.hold=0,Q.bits=0,Q.lencode=Q.lendyn=new Int32Array(ea),Q.distcode=Q.distdyn=new Int32Array(ta),Q.sane=1,Q.back=-1,Fi},ia=A=>{if(ri(A))return yr;const Q=A.state;return Q.wsize=0,Q.whave=0,Q.wnext=0,hs(A)},na=(A,Q)=>{let z;if(ri(A))return yr;const ne=A.state;return Q<0?(z=0,Q=-Q):(z=(Q>>4)+5,Q<48&&(Q&=15)),Q&&(Q<8||Q>15)?yr:(ne.window!==null&&ne.wbits!==Q&&(ne.window=null),ne.wrap=z,ne.wbits=Q,ia(A))},tn=(A,Q)=>{if(!A)return yr;const z=new gi;A.state=z,z.strm=A,z.window=null,z.mode=An;const ne=na(A,Q);return ne!==Fi&&(A.state=null),ne},ll=A=>tn(A,ra);let oo=!0,fs,Ut;const ao=A=>{if(oo){fs=new Int32Array(512),Ut=new Int32Array(32);let Q=0;for(;Q<144;)A.lens[Q++]=8;for(;Q<256;)A.lens[Q++]=9;for(;Q<280;)A.lens[Q++]=7;for(;Q<288;)A.lens[Q++]=8;for(Ki(Hs,A.lens,0,288,fs,0,A.work,{bits:9}),Q=0;Q<32;)A.lens[Q++]=5;Ki($s,A.lens,0,32,Ut,0,A.work,{bits:5}),oo=!1}A.lencode=fs,A.lenbits=9,A.distcode=Ut,A.distbits=5},Mn=(A,Q,z,ne)=>{let le;const ce=A.state;return ce.window===null&&(ce.wsize=1<<ce.wbits,ce.wnext=0,ce.whave=0,ce.window=new Uint8Array(ce.wsize)),ne>=ce.wsize?(ce.window.set(Q.subarray(z-ce.wsize,z),0),ce.wnext=0,ce.whave=ce.wsize):(le=ce.wsize-ce.wnext,le>ne&&(le=ne),ce.window.set(Q.subarray(z-ne,z-ne+le),ce.wnext),ne-=le,ne?(ce.window.set(Q.subarray(z-ne,z),0),ce.wnext=ne,ce.whave=ce.wsize):(ce.wnext+=le,ce.wnext===ce.wsize&&(ce.wnext=0),ce.whave<ce.wsize&&(ce.whave+=le))),0},Rn=(A,Q)=>{let z,ne,le,ce,ze,Ae,ht,_e,Pe,Ft,nt,Ye,$t,Xt,zt=0,bt,_t,tt,wt,tr,Ot,Dt,Bt;const St=new Uint8Array(4);let kt,fr;const zr=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ri(A)||!A.output||!A.input&&A.avail_in!==0)return yr;z=A.state,z.mode===sr&&(z.mode=Di),ze=A.next_out,le=A.output,ht=A.avail_out,ce=A.next_in,ne=A.input,Ae=A.avail_in,_e=z.hold,Pe=z.bits,Ft=Ae,nt=ht,Bt=Fi;e:for(;;)switch(z.mode){case An:if(z.wrap===0){z.mode=Di;break}for(;Pe<16;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}if(z.wrap&2&&_e===35615){z.wbits===0&&(z.wbits=15),z.check=0,St[0]=_e&255,St[1]=_e>>>8&255,z.check=De(z.check,St,2,0),_e=0,Pe=0,z.mode=is;break}if(z.head&&(z.head.done=!1),!(z.wrap&1)||(((_e&255)<<8)+(_e>>8))%31){A.msg="incorrect header check",z.mode=Gt;break}if((_e&15)!==Yo){A.msg="unknown compression method",z.mode=Gt;break}if(_e>>>=4,Pe-=4,Dt=(_e&15)+8,z.wbits===0&&(z.wbits=Dt),Dt>15||Dt>z.wbits){A.msg="invalid window size",z.mode=Gt;break}z.dmax=1<<z.wbits,z.flags=0,A.adler=z.check=1,z.mode=_e&512?Ko:sr,_e=0,Pe=0;break;case is:for(;Pe<16;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}if(z.flags=_e,(z.flags&255)!==Yo){A.msg="unknown compression method",z.mode=Gt;break}if(z.flags&57344){A.msg="unknown header flags set",z.mode=Gt;break}z.head&&(z.head.text=_e>>8&1),z.flags&512&&z.wrap&4&&(St[0]=_e&255,St[1]=_e>>>8&255,z.check=De(z.check,St,2,0)),_e=0,Pe=0,z.mode=ns;case ns:for(;Pe<32;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}z.head&&(z.head.time=_e),z.flags&512&&z.wrap&4&&(St[0]=_e&255,St[1]=_e>>>8&255,St[2]=_e>>>16&255,St[3]=_e>>>24&255,z.check=De(z.check,St,4,0)),_e=0,Pe=0,z.mode=qs;case qs:for(;Pe<16;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}z.head&&(z.head.xflags=_e&255,z.head.os=_e>>8),z.flags&512&&z.wrap&4&&(St[0]=_e&255,St[1]=_e>>>8&255,z.check=De(z.check,St,2,0)),_e=0,Pe=0,z.mode=Xs;case Xs:if(z.flags&1024){for(;Pe<16;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}z.length=_e,z.head&&(z.head.extra_len=_e),z.flags&512&&z.wrap&4&&(St[0]=_e&255,St[1]=_e>>>8&255,z.check=De(z.check,St,2,0)),_e=0,Pe=0}else z.head&&(z.head.extra=null);z.mode=Js;case Js:if(z.flags&1024&&(Ye=z.length,Ye>Ae&&(Ye=Ae),Ye&&(z.head&&(Dt=z.head.extra_len-z.length,z.head.extra||(z.head.extra=new Uint8Array(z.head.extra_len)),z.head.extra.set(ne.subarray(ce,ce+Ye),Dt)),z.flags&512&&z.wrap&4&&(z.check=De(z.check,ne,Ye,ce)),Ae-=Ye,ce+=Ye,z.length-=Ye),z.length))break e;z.length=0,z.mode=Xo;case Xo:if(z.flags&2048){if(Ae===0)break e;Ye=0;do Dt=ne[ce+Ye++],z.head&&Dt&&z.length<65536&&(z.head.name+=String.fromCharCode(Dt));while(Dt&&Ye<Ae);if(z.flags&512&&z.wrap&4&&(z.check=De(z.check,ne,Ye,ce)),Ae-=Ye,ce+=Ye,Dt)break e}else z.head&&(z.head.name=null);z.length=0,z.mode=Jo;case Jo:if(z.flags&4096){if(Ae===0)break e;Ye=0;do Dt=ne[ce+Ye++],z.head&&Dt&&z.length<65536&&(z.head.comment+=String.fromCharCode(Dt));while(Dt&&Ye<Ae);if(z.flags&512&&z.wrap&4&&(z.check=De(z.check,ne,Ye,ce)),Ae-=Ye,ce+=Ye,Dt)break e}else z.head&&(z.head.comment=null);z.mode=Qo;case Qo:if(z.flags&512){for(;Pe<16;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}if(z.wrap&4&&_e!==(z.check&65535)){A.msg="header crc mismatch",z.mode=Gt;break}_e=0,Pe=0}z.head&&(z.head.hcrc=z.flags>>9&1,z.head.done=!0),A.adler=z.check=0,z.mode=sr;break;case Ko:for(;Pe<32;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}A.adler=z.check=so(_e),_e=0,Pe=0,z.mode=ss;case ss:if(z.havedict===0)return A.next_out=ze,A.avail_out=ht,A.next_in=ce,A.avail_in=Ae,z.hold=_e,z.bits=Pe,$o;A.adler=z.check=1,z.mode=sr;case sr:if(Q===al||Q===ts)break e;case Di:if(z.last){_e>>>=Pe&7,Pe-=Pe&7,z.mode=mi;break}for(;Pe<3;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}switch(z.last=_e&1,_e>>>=1,Pe-=1,_e&3){case 0:z.mode=Qs;break;case 1:if(ao(z),z.mode=ls,Q===ts){_e>>>=2,Pe-=2;break e}break;case 2:z.mode=eo;break;case 3:A.msg="invalid block type",z.mode=Gt}_e>>>=2,Pe-=2;break;case Qs:for(_e>>>=Pe&7,Pe-=Pe&7;Pe<32;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}if((_e&65535)!==(_e>>>16^65535)){A.msg="invalid stored block lengths",z.mode=Gt;break}if(z.length=_e&65535,_e=0,Pe=0,z.mode=os,Q===ts)break e;case os:z.mode=Ks;case Ks:if(Ye=z.length,Ye){if(Ye>Ae&&(Ye=Ae),Ye>ht&&(Ye=ht),Ye===0)break e;le.set(ne.subarray(ce,ce+Ye),ze),Ae-=Ye,ce+=Ye,ht-=Ye,ze+=Ye,z.length-=Ye;break}z.mode=sr;break;case eo:for(;Pe<14;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}if(z.nlen=(_e&31)+257,_e>>>=5,Pe-=5,z.ndist=(_e&31)+1,_e>>>=5,Pe-=5,z.ncode=(_e&15)+4,_e>>>=4,Pe-=4,z.nlen>286||z.ndist>30){A.msg="too many length or distance symbols",z.mode=Gt;break}z.have=0,z.mode=as;case as:for(;z.have<z.ncode;){for(;Pe<3;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}z.lens[zr[z.have++]]=_e&7,_e>>>=3,Pe-=3}for(;z.have<19;)z.lens[zr[z.have++]]=0;if(z.lencode=z.lendyn,z.lenbits=7,kt={bits:z.lenbits},Bt=Ki(Wo,z.lens,0,19,z.lencode,0,z.work,kt),z.lenbits=kt.bits,Bt){A.msg="invalid code lengths set",z.mode=Gt;break}z.have=0,z.mode=Zo;case Zo:for(;z.have<z.nlen+z.ndist;){for(;zt=z.lencode[_e&(1<<z.lenbits)-1],bt=zt>>>24,_t=zt>>>16&255,tt=zt&65535,!(bt<=Pe);){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}if(tt<16)_e>>>=bt,Pe-=bt,z.lens[z.have++]=tt;else{if(tt===16){for(fr=bt+2;Pe<fr;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}if(_e>>>=bt,Pe-=bt,z.have===0){A.msg="invalid bit length repeat",z.mode=Gt;break}Dt=z.lens[z.have-1],Ye=3+(_e&3),_e>>>=2,Pe-=2}else if(tt===17){for(fr=bt+3;Pe<fr;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}_e>>>=bt,Pe-=bt,Dt=0,Ye=3+(_e&7),_e>>>=3,Pe-=3}else{for(fr=bt+7;Pe<fr;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}_e>>>=bt,Pe-=bt,Dt=0,Ye=11+(_e&127),_e>>>=7,Pe-=7}if(z.have+Ye>z.nlen+z.ndist){A.msg="invalid bit length repeat",z.mode=Gt;break}for(;Ye--;)z.lens[z.have++]=Dt}}if(z.mode===Gt)break;if(z.lens[256]===0){A.msg="invalid code -- missing end-of-block",z.mode=Gt;break}if(z.lenbits=9,kt={bits:z.lenbits},Bt=Ki(Hs,z.lens,0,z.nlen,z.lencode,0,z.work,kt),z.lenbits=kt.bits,Bt){A.msg="invalid literal/lengths set",z.mode=Gt;break}if(z.distbits=6,z.distcode=z.distdyn,kt={bits:z.distbits},Bt=Ki($s,z.lens,z.nlen,z.ndist,z.distcode,0,z.work,kt),z.distbits=kt.bits,Bt){A.msg="invalid distances set",z.mode=Gt;break}if(z.mode=ls,Q===ts)break e;case ls:z.mode=ti;case ti:if(Ae>=6&&ht>=258){A.next_out=ze,A.avail_out=ht,A.next_in=ce,A.avail_in=Ae,z.hold=_e,z.bits=Pe,sl(A,nt),ze=A.next_out,le=A.output,ht=A.avail_out,ce=A.next_in,ne=A.input,Ae=A.avail_in,_e=z.hold,Pe=z.bits,z.mode===sr&&(z.back=-1);break}for(z.back=0;zt=z.lencode[_e&(1<<z.lenbits)-1],bt=zt>>>24,_t=zt>>>16&255,tt=zt&65535,!(bt<=Pe);){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}if(_t&&!(_t&240)){for(wt=bt,tr=_t,Ot=tt;zt=z.lencode[Ot+((_e&(1<<wt+tr)-1)>>wt)],bt=zt>>>24,_t=zt>>>16&255,tt=zt&65535,!(wt+bt<=Pe);){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}_e>>>=wt,Pe-=wt,z.back+=wt}if(_e>>>=bt,Pe-=bt,z.back+=bt,z.length=tt,_t===0){z.mode=Tn;break}if(_t&32){z.back=-1,z.mode=sr;break}if(_t&64){A.msg="invalid literal/length code",z.mode=Gt;break}z.extra=_t&15,z.mode=us;case us:if(z.extra){for(fr=z.extra;Pe<fr;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}z.length+=_e&(1<<z.extra)-1,_e>>>=z.extra,Pe-=z.extra,z.back+=z.extra}z.was=z.length,z.mode=en;case en:for(;zt=z.distcode[_e&(1<<z.distbits)-1],bt=zt>>>24,_t=zt>>>16&255,tt=zt&65535,!(bt<=Pe);){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}if(!(_t&240)){for(wt=bt,tr=_t,Ot=tt;zt=z.distcode[Ot+((_e&(1<<wt+tr)-1)>>wt)],bt=zt>>>24,_t=zt>>>16&255,tt=zt&65535,!(wt+bt<=Pe);){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}_e>>>=wt,Pe-=wt,z.back+=wt}if(_e>>>=bt,Pe-=bt,z.back+=bt,_t&64){A.msg="invalid distance code",z.mode=Gt;break}z.offset=tt,z.extra=_t&15,z.mode=cs;case cs:if(z.extra){for(fr=z.extra;Pe<fr;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}z.offset+=_e&(1<<z.extra)-1,_e>>>=z.extra,Pe-=z.extra,z.back+=z.extra}if(z.offset>z.dmax){A.msg="invalid distance too far back",z.mode=Gt;break}z.mode=to;case to:if(ht===0)break e;if(Ye=nt-ht,z.offset>Ye){if(Ye=z.offset-Ye,Ye>z.whave&&z.sane){A.msg="invalid distance too far back",z.mode=Gt;break}Ye>z.wnext?(Ye-=z.wnext,$t=z.wsize-Ye):$t=z.wnext-Ye,Ye>z.length&&(Ye=z.length),Xt=z.window}else Xt=le,$t=ze-z.offset,Ye=z.length;Ye>ht&&(Ye=ht),ht-=Ye,z.length-=Ye;do le[ze++]=Xt[$t++];while(--Ye);z.length===0&&(z.mode=ti);break;case Tn:if(ht===0)break e;le[ze++]=z.length,ht--,z.mode=ti;break;case mi:if(z.wrap){for(;Pe<32;){if(Ae===0)break e;Ae--,_e|=ne[ce++]<<Pe,Pe+=8}if(nt-=ht,A.total_out+=nt,z.total+=nt,z.wrap&4&&nt&&(A.adler=z.check=z.flags?De(z.check,le,nt,ze-nt):ye(z.check,le,nt,ze-nt)),nt=ht,z.wrap&4&&(z.flags?_e:so(_e))!==z.check){A.msg="incorrect data check",z.mode=Gt;break}_e=0,Pe=0}z.mode=ds;case ds:if(z.wrap&&z.flags){for(;Pe<32;){if(Ae===0)break e;Ae--,_e+=ne[ce++]<<Pe,Pe+=8}if(z.wrap&4&&_e!==(z.total&4294967295)){A.msg="incorrect length check",z.mode=Gt;break}_e=0,Pe=0}z.mode=ro;case ro:Bt=Ho;break e;case Gt:Bt=Zi;break e;case io:return qo;case no:default:return yr}return A.next_out=ze,A.avail_out=ht,A.next_in=ce,A.avail_in=Ae,z.hold=_e,z.bits=Pe,(z.wsize||nt!==A.avail_out&&z.mode<Gt&&(z.mode<mi||Q!==Ii))&&Mn(A,A.output,A.next_out,nt-A.avail_out),Ft-=A.avail_in,nt-=A.avail_out,A.total_in+=Ft,A.total_out+=nt,z.total+=nt,z.wrap&4&&nt&&(A.adler=z.check=z.flags?De(z.check,le,nt,A.next_out-nt):ye(z.check,le,nt,A.next_out-nt)),A.data_type=z.bits+(z.last?64:0)+(z.mode===sr?128:0)+(z.mode===ls||z.mode===os?256:0),(Ft===0&&nt===0||Q===Ii)&&Bt===Fi&&(Bt=rs),Bt},sa=A=>{if(ri(A))return yr;let Q=A.state;return Q.window&&(Q.window=null),A.state=null,Fi},lo=(A,Q)=>{if(ri(A))return yr;const z=A.state;return z.wrap&2?(z.head=Q,Q.done=!1,Fi):yr},kn=(A,Q)=>{const z=Q.length;let ne,le,ce;return ri(A)||(ne=A.state,ne.wrap!==0&&ne.mode!==ss)?yr:ne.mode===ss&&(le=1,le=ye(le,Q,z,0),le!==ne.check)?Zi:(ce=Mn(A,Q,z,z),ce?(ne.mode=io,qo):(ne.havedict=1,Fi))};var ps=ia,rn=na,oa=hs,ul=ll,cl=tn,aa=Rn,ms=sa,gs=lo,uo=kn,co="pako inflate (from Nodeca project)",Br={inflateReset:ps,inflateReset2:rn,inflateResetKeep:oa,inflateInit:ul,inflateInit2:cl,inflate:aa,inflateEnd:ms,inflateGetHeader:gs,inflateSetDictionary:uo,inflateInfo:co};function ho(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var dl=ho;const fo=Object.prototype.toString,{Z_NO_FLUSH:hl,Z_FINISH:fl,Z_OK:zi,Z_STREAM_END:$r,Z_NEED_DICT:vs,Z_STREAM_ERROR:nn,Z_DATA_ERROR:Gr,Z_MEM_ERROR:Pn}=G;function Pr(A){this.options=ki.assign({chunkSize:65536,windowBits:15,to:""},A||{});const Q=this.options;Q.raw&&Q.windowBits>=0&&Q.windowBits<16&&(Q.windowBits=-Q.windowBits,Q.windowBits===0&&(Q.windowBits=-15)),Q.windowBits>=0&&Q.windowBits<16&&!(A&&A.windowBits)&&(Q.windowBits+=32),Q.windowBits>15&&Q.windowBits<48&&(Q.windowBits&15||(Q.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Xi,this.strm.avail_out=0;let z=Br.inflateInit2(this.strm,Q.windowBits);if(z!==zi)throw new Error(rt[z]);if(this.header=new dl,Br.inflateGetHeader(this.strm,this.header),Q.dictionary&&(typeof Q.dictionary=="string"?Q.dictionary=Pi.string2buf(Q.dictionary):fo.call(Q.dictionary)==="[object ArrayBuffer]"&&(Q.dictionary=new Uint8Array(Q.dictionary)),Q.raw&&(z=Br.inflateSetDictionary(this.strm,Q.dictionary),z!==zi)))throw new Error(rt[z])}Pr.prototype.push=function(A,Q){const z=this.strm,ne=this.options.chunkSize,le=this.options.dictionary;let ce,ze,Ae;if(this.ended)return!1;for(Q===~~Q?ze=Q:ze=Q===!0?fl:hl,fo.call(A)==="[object ArrayBuffer]"?z.input=new Uint8Array(A):z.input=A,z.next_in=0,z.avail_in=z.input.length;;){for(z.avail_out===0&&(z.output=new Uint8Array(ne),z.next_out=0,z.avail_out=ne),ce=Br.inflate(z,ze),ce===vs&&le&&(ce=Br.inflateSetDictionary(z,le),ce===zi?ce=Br.inflate(z,ze):ce===Gr&&(ce=vs));z.avail_in>0&&ce===$r&&z.state.wrap>0&&A[z.next_in]!==0;)Br.inflateReset(z),ce=Br.inflate(z,ze);switch(ce){case nn:case Gr:case vs:case Pn:return this.onEnd(ce),this.ended=!0,!1}if(Ae=z.avail_out,z.next_out&&(z.avail_out===0||ce===$r))if(this.options.to==="string"){let ht=Pi.utf8border(z.output,z.next_out),_e=z.next_out-ht,Pe=Pi.buf2string(z.output,ht);z.next_out=_e,z.avail_out=ne-_e,_e&&z.output.set(z.output.subarray(ht,ht+_e),0),this.onData(Pe)}else this.onData(z.output.length===z.next_out?z.output:z.output.subarray(0,z.next_out));if(!(ce===zi&&Ae===0)){if(ce===$r)return ce=Br.inflateEnd(this.strm),this.onEnd(ce),this.ended=!0,!0;if(z.avail_in===0)break}}return!0},Pr.prototype.onData=function(A){this.chunks.push(A)},Pr.prototype.onEnd=function(A){A===zi&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ki.flattenChunks(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg};function In(A,Q){const z=new Pr(Q);if(z.push(A),z.err)throw z.msg||rt[z.err];return z.result}function pl(A,Q){return Q=Q||{},Q.raw=!0,In(A,Q)}var ml=Pr,Li=In,Fn=pl,sn=In,ys={Inflate:ml,inflate:Li,inflateRaw:Fn,ungzip:sn};const{Deflate:po,deflate:on,deflateRaw:vi,gzip:Yt}=nl,{Inflate:Ht,inflate:yi,inflateRaw:hr,ungzip:Er}=ys;var xi=po,Oi=on,xr=vi,Dn=Yt,mo=Ht,go=yi,zn=hr,vo=Er,qr=G,xs={Deflate:xi,deflate:Oi,deflateRaw:xr,gzip:Dn,Inflate:mo,inflate:go,inflateRaw:zn,ungzip:vo,constants:qr}})},__webpack_module_cache__={};function __webpack_require__(n){var t=__webpack_module_cache__[n];if(t!==void 0)return t.exports;var r=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=n=>{var t=n&&n.__esModule?(()=>n.default):(()=>n);return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(n,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t),__webpack_require__.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},__webpack_require__("./src/index.ts"),__webpack_require__("./src/SurfaceWorker.js");var __webpack_exports__=__webpack_require__("./src/exporter.js");return __webpack_exports__})())})(_3Dmol);var _3DmolExports=_3Dmol.exports;const covalentRadii={H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.61,Fe:1.52,Co:1.5,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,Pd:1.39,Ag:1.45,Cd:1.44,In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.75,Hf:1.87,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69};function mod(n,t){return(n%t+t)%t}function setCustomBondLengths(){function n(t,r){_3DmolExports.setBondLength(t,r)}Object.keys(covalentRadii).forEach(t=>{n(t,1.05*covalentRadii[t])})}class Visualizer3dmol extends React.Component{constructor(t){super(t),setCustomBondLengths(),this.viewer=null,this.model=null,this.divId="gldiv-"+(Math.random()+1).toString(36).substring(7)}componentDidMount(){let t={backgroundColor:"white",orthographic:!0};this.viewer=_3DmolExports.createViewer(this.divId,t),this.updateView()}componentDidUpdate(t){(t.viewerParams!=this.props.viewerParams||t.cifText!=this.props.cifText)&&this.updateView()}custom3dmolSetup(){if(this.model=this.viewer.addModel(),this.props.cifText){let t=_3DmolExports.Parsers.CIF(this.props.cifText),r=t[0],u=t.modelData[0].cryst;this.model.setCrystData(u.a,u.b,u.c,u.alpha,u.beta,u.gamma);let v=this.model.modelData.cryst.matrix,x=new _3DmolExports.Matrix3().getInverse3(v),b=[],p=[];r.forEach(g=>{let R=new _3DmolExports.Vector3(g.x,g.y,g.z);if(this.props.viewerParams.packedCell){let P=R.clone().applyMatrix3(x);R=new _3DmolExports.Vector3(mod(P.x,1),mod(P.y,1),mod(P.z,1)).applyMatrix3(v)}p.push({elem:g.elem,x:R.x,y:R.y,z:R.z})});let y=.03,k=this.props.viewerParams.supercell;for(let g=-1;g<k[0]+1;g++)for(let R=-1;R<k[1]+1;R++)for(let P=-1;P<k[2]+1;P++){let T=new _3DmolExports.Vector3(g,R,P);if(T.applyMatrix3(v),g==-1||g==k[0]||R==-1||R==k[1]||P==-1||P==k[2])if(this.props.viewerParams.packedCell)p.forEach(C=>{let a=new _3DmolExports.Vector3(C.x,C.y,C.z);a.add(T);let s=a.clone().applyMatrix3(x);s.x>-y&&s.x<k[0]+y&&s.y>-y&&s.y<k[1]+y&&s.z>-y&&s.z<k[2]+y&&b.push({elem:C.elem,x:a.x,y:a.y,z:a.z})});else continue;else p.forEach(C=>{b.push({elem:C.elem,x:C.x+T.x,y:C.y+T.y,z:C.z+T.z})})}this.model.addAtoms(b)}}updateView(){this.viewer.removeAllModels(),this.custom3dmolSetup();let t={sphere:{scale:.3,colorscheme:"Jmol"}};this.props.viewerParams.vdwRadius&&(t.sphere.scale=1),this.props.viewerParams.bonds&&(t.stick={radius:.15,colorscheme:"Jmol"}),this.viewer.setStyle(t),this.viewer.addUnitCell(this.model),this.model.assignBonds(),this.viewer.removeAllLabels(),this.props.viewerParams.atomLabels&&this.model.atoms.forEach(r=>{this.viewer.addLabel(r.elem,{position:{x:r.x,y:r.y,z:r.z},fontColor:"black",bold:!0,fontSize:18,showBackground:!1,backgroundOpacity:1,inFront:!0},null,!0)}),this.viewer.zoomTo(),this.viewer.zoom(1.4),this.viewer.render()}handleEvent(t,r){t=="camera"&&(r=="x"&&this.viewer.setView([0,0,0,0,-.5,-.5,-.5,.5]),r=="y"&&this.viewer.setView([0,0,0,0,.5,.5,.5,.5]),r=="z"&&this.viewer.setView([0,0,0,0,0,0,0,1]),this.viewer.zoomTo(),this.viewer.zoom(1.4))}render(){return jsxRuntimeExports.jsx("div",{id:this.divId,className:"gldiv",children:"No data!"})}}class StructureWindow extends React.Component{constructor(t){super(t)}render(){let t="structure-window";this.props.mouseEnabled||(t+=" disable-mouse");let r="Click to interact",u="mouse-disabled-note";return this.props.mouseEnabled&&(u="mouse-disabled-note on"),jsxRuntimeExports.jsxs("div",{className:"structure-window-outer",children:[jsxRuntimeExports.jsx("div",{className:"structure-window-click-handler",onClick:()=>this.props.setMouseEnabledState(!0),children:jsxRuntimeExports.jsx("div",{className:t,children:jsxRuntimeExports.jsx(Visualizer3dmol,{ref:this.props.visualizerRef,viewerParams:this.props.viewerParams,cifText:this.props.cifText})})}),jsxRuntimeExports.jsx("div",{className:u,onClick:()=>this.props.setMouseEnabledState(!this.props.mouseEnabled),children:r})]})}}const StructureVisualizer=n=>{const[t,r]=reactExports.useState({supercell:n.initSupercell||[2,2,2],bonds:!0,packedCell:!0,atomLabels:!1,vdwRadius:!1}),[u,v]=reactExports.useState(!1),x=reactExports.useRef(null),b=reactExports.useRef(null);reactExports.useEffect(()=>{const g=R=>{b&&!b.current.contains(R.target)&&v(!1)};return document.addEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)}},[]);const p=g=>{v(g)},y=(g,R)=>{r(P=>({...P,[g]:R}))},k=(g,R)=>{x.current.handleEvent(g,R)};return jsxRuntimeExports.jsxs("div",{ref:b,className:"structure-visualizer",children:[jsxRuntimeExports.jsx(StructureWindow,{visualizerRef:x,viewerParams:t,cifText:n.cifText,mouseEnabled:u,setMouseEnabledState:p}),jsxRuntimeExports.jsx(ControlBox,{viewerParams:t,onViewerParamChange:y,onViewerEvent:k})]})};function DownloadIcon({size:n=14,className:t=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[jsxRuntimeExports$1.jsx("path",{d:"M12 15V3"}),jsxRuntimeExports$1.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),jsxRuntimeExports$1.jsx("path",{d:"m7 10 5 5 5-5"})]})}function NextIcon({size:n=14,className:t=""}){return jsxRuntimeExports$1.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,hegiht:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:jsxRuntimeExports$1.jsx("path",{d:"m9 18 6-6-6-6"})})}function PreviousIcon({size:n=14,className:t=""}){return jsxRuntimeExports$1.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,hegiht:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:jsxRuntimeExports$1.jsx("path",{d:"m15 18-6-6 6-6"})})}function FirstIcon({size:n=14,className:t=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,hegiht:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[jsxRuntimeExports$1.jsx("path",{d:"m17 18-6-6 6-6"}),jsxRuntimeExports$1.jsx("path",{d:"M7 6v12"})]})}function LastIcon({size:n=14,className:t=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,hegiht:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[jsxRuntimeExports$1.jsx("path",{d:"m7 18 6-6-6-6"}),jsxRuntimeExports$1.jsx("path",{d:"M17 6v12"})]})}var ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array;function create$1(){var n=new ARRAY_TYPE(9);return ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function fromValues$1(n,t,r,u,v,x,b,p,y){var k=new ARRAY_TYPE(9);return k[0]=n,k[1]=t,k[2]=r,k[3]=u,k[4]=v,k[5]=x,k[6]=b,k[7]=p,k[8]=y,k}function invert(n,t){var r=t[0],u=t[1],v=t[2],x=t[3],b=t[4],p=t[5],y=t[6],k=t[7],g=t[8],R=g*b-p*k,P=-g*x+p*y,T=k*x-b*y,C=r*R+u*P+v*T;return C?(C=1/C,n[0]=R*C,n[1]=(-g*u+v*k)*C,n[2]=(p*u-v*b)*C,n[3]=P*C,n[4]=(g*r-v*y)*C,n[5]=(-p*r+v*x)*C,n[6]=T*C,n[7]=(-k*r+u*y)*C,n[8]=(b*r-u*x)*C,n):null}function create(){var n=new ARRAY_TYPE(3);return ARRAY_TYPE!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function length(n){var t=n[0],r=n[1],u=n[2];return Math.sqrt(t*t+r*r+u*u)}function fromValues(n,t,r){var u=new ARRAY_TYPE(3);return u[0]=n,u[1]=t,u[2]=r,u}function dot(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function transformMat3(n,t,r){var u=t[0],v=t[1],x=t[2];return n[0]=u*r[0]+v*r[3]+x*r[6],n[1]=u*r[1]+v*r[4]+x*r[7],n[2]=u*r[2]+v*r[5]+x*r[8],n}(function(){var n=create();return function(t,r,u,v,x,b){var p,y;for(r||(r=3),u||(u=0),v?y=Math.min(v*r+u,t.length):y=t.length,p=u;p<y;p+=r)n[0]=t[p],n[1]=t[p+1],n[2]=t[p+2],x(n,n,b),t[p]=n[0],t[p+1]=n[1],t[p+2]=n[2];return t}})();function vecLength(n){return length(n)}function radToDeg$1(n){return n*180/Math.PI}function cartesianToFractional(n,t){const r=fromValues$1(t[0][0],t[1][0],t[2][0],t[0][1],t[1][1],t[2][1],t[0][2],t[1][2],t[2][2]),u=create$1();if(!invert(u,r))throw new Error("Singular lattice matrix");return n.map(v=>{const x=fromValues(v.x,v.y,v.z),b=create();return transformMat3(b,x,u),{element:v.element,x:b[0],y:b[1],z:b[2]}})}function latticeMatrixToCIFParams(n){const t=fromValues(...n[0]),r=fromValues(...n[1]),u=fromValues(...n[2]),v=vecLength(t),x=vecLength(r),b=vecLength(u),p=radToDeg$1(Math.acos(dot(r,u)/(x*b))),y=radToDeg$1(Math.acos(dot(t,u)/(v*b))),k=radToDeg$1(Math.acos(dot(t,r)/(v*x)));return{a:v,b:x,c:b,alpha:p,beta:y,gamma:k}}function generateCIFfromMatrix(n){const{lattice:t,sites:r}=n,u=cartesianToFractional(r,t),{a:v,b:x,c:b,alpha:p,beta:y,gamma:k}=latticeMatrixToCIFParams(t);let g=`data_generated_structure
_symmetry_space_group_name_H-M   'P 1'
_cell_length_a   ${v.toFixed(6)}
_cell_length_b   ${x.toFixed(6)}
_cell_length_c   ${b.toFixed(6)}
_cell_angle_alpha   ${p.toFixed(6)}
_cell_angle_beta    ${y.toFixed(6)}
_cell_angle_gamma   ${k.toFixed(6)}

loop_
_atom_site_label
_atom_site_type_symbol
_atom_site_fract_x
_atom_site_fract_y
_atom_site_fract_z
`;return u.forEach((R,P)=>{g+=`${R.element}${P+1} ${R.element} ${R.x.toFixed(6)} ${R.y.toFixed(6)} ${R.z.toFixed(6)}
`}),g}function generateXYZ(n){const{lattice:t,sites:r}=n,u=r.length,v=t.flat().map(b=>b.toFixed(6)).join(" ");let x=`${u}
`;return x+=`Lattice="${v}" Properties=species:S:1:pos:R:3
`,r.forEach(b=>{x+=`${b.element} ${b.x.toFixed(6)} ${b.y.toFixed(6)} ${b.z.toFixed(6)}
`}),x}function generatePOSCAR(n){const{lattice:t,sites:r}=n,u=[...new Set(r.map(p=>p.element))],v=u.map(p=>r.filter(y=>y.element===p).length),x=t.map(p=>p.map(y=>y.toFixed(6)).join(" ")).join(`
`),b=u.flatMap(p=>r.filter(y=>y.element===p).map(y=>`${y.x.toFixed(6)} ${y.y.toFixed(6)} ${y.z.toFixed(6)}`));return["Generated structure from OPTIMADE CLIENT","1.0",x,u.join(" "),v.join(" "),"Cartesian",...b].join(`
`)}function generateXSF(n){const{lattice:t,sites:r}=n;let u=`CRYSTAL
PRIMVEC
`;return t.forEach(v=>{u+=v.map(x=>x.toFixed(6)).join(" ")+`
`}),u+=`PRIMCOORD
${r.length} 1
`,r.forEach(v=>{u+=`${v.element} ${v.x.toFixed(6)} ${v.y.toFixed(6)} ${v.z.toFixed(6)}
`}),u}const defaultFormats=[{format:"json",label:"JSON"},{format:"cif",label:"CIF"},{format:"xyz",label:"XYZ"},{format:"xsf",label:"XSF"},{format:"poscar",label:"VASP"}];function downloadFile(n,t){const r=new Blob([n],{type:"text/plain"}),u=URL.createObjectURL(r),v=document.createElement("a");v.href=u,v.download=t,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(u)}function StructureDownload({OptimadeStructure:n,download_formats:t}){const[r,u]=reactExports.useState(!1),v=reactExports.useRef(null),x=t||defaultFormats,b=n.attributes.lattice_vectors,p=n.attributes.cartesian_site_positions,y=n.attributes.species_at_sites,k=p.map((P,T)=>({element:y[T],x:P[0],y:P[1],z:P[2]})),g={lattice:b,sites:k},R=P=>{let T="",C="structure";P==="cif"?(T=generateCIFfromMatrix(g),C+=".cif"):P==="xyz"?(T=generateXYZ(g),C+=".xyz"):P==="poscar"?(T=generatePOSCAR(g),C+=".vasp"):P==="xsf"?(T=generateXSF(g),C+=".xsf"):P==="json"&&(T=JSON.stringify(n,null,2),C+=".json"),T&&downloadFile(T,C),u(!1)};return reactExports.useEffect(()=>{const P=T=>{v.current&&!v.current.contains(T.target)&&u(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]),jsxRuntimeExports$1.jsxs("div",{className:"relative inline-block",ref:v,children:[jsxRuntimeExports$1.jsx("div",{onClick:()=>u(P=>!P),className:"flex items-center gap-1 px-2 py-2 text-sm bg-blue-600 text-white rounded-md shadow hover:bg-blue-700 cursor-pointer",title:"Download",children:jsxRuntimeExports$1.jsx(DownloadIcon,{})}),r&&jsxRuntimeExports$1.jsx("div",{className:"absolute right-0 mt-1 bg-white rounded-md shadow-md ring-2 ring-black ring-opacity-5 z-10",children:jsxRuntimeExports$1.jsx("ul",{className:"list-none p-0 m-0",children:x.map(({format:P,label:T})=>jsxRuntimeExports$1.jsx("li",{children:jsxRuntimeExports$1.jsx("button",{onClick:()=>R(P),className:"block w-full text-left px-3 py-1.5 text-sm text-black hover:bg-gray-100",children:T})},P))})})]})}function QEInputButton({cifText:n}){const t="https://qeinputgenerator.materialscloud.io",r=async()=>{if(!n){alert("No CIF data available");return}try{const u=new FormData;u.append("fileformat","cif-ase"),u.append("structurefile",new Blob([n],{type:"text/plain;charset=utf-8"}),"structure.cif");const v=await fetch(`${t}/compute/upload_structure/`,{method:"POST",body:u});if(!v.ok)throw new Error(`Upload failed: ${v.statusText}`);const x=await v.json();x.redirect?window.open(`${t}${x.redirect}`,"_blank"):alert("Unexpected response from server")}catch(u){console.error(u),alert("Failed to upload structure.")}};return jsxRuntimeExports$1.jsx("button",{onClick:r,disabled:!n,title:"Use the chosen structure in the QE Input Generator Tool",className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:bg-gray-400",children:"Use in QE Input Generator"})}function StructureViewerWithDownload({OptimadeStructure:n,className:t=""}){const r=n.attributes.lattice_vectors,u=n.attributes.cartesian_site_positions,v=n.attributes.species_at_sites,x=u.map((y,k)=>({element:v[k],x:y[0],y:y[1],z:y[2]})),b={lattice:r,sites:x},p=reactExports.useMemo(()=>generateCIFfromMatrix(b),[b]);return jsxRuntimeExports$1.jsxs("div",{className:`relative rounded-lg w-full min-h-[450px] ${t}`,children:[jsxRuntimeExports$1.jsx("div",{className:"w-full h-[450px]",children:jsxRuntimeExports$1.jsx(StructureVisualizer,{cifText:p},p)}),jsxRuntimeExports$1.jsx("div",{className:"absolute top-2 right-2 z-10",children:jsxRuntimeExports$1.jsx(StructureDownload,{OptimadeStructure:n})})]})}function ResultViewer({selectedResult:n}){const t=n?.attributes?.lattice_vectors??[],r=n?.attributes?.cartesian_site_positions??[],u=n?.attributes?.species_at_sites??[],v=r.map((p,y)=>({element:u[y],x:p[0],y:p[1],z:p[2]})),x=reactExports.useMemo(()=>({lattice:t,sites:v}),[t,v]),b=reactExports.useMemo(()=>generateCIFfromMatrix(x),[x]);return jsxRuntimeExports$1.jsxs("div",{className:"w-full mt-4 flex flex-col",children:[n&&jsxRuntimeExports$1.jsxs("div",{className:"@container w-full flex flex-col md:flex-row gap-4",children:[jsxRuntimeExports$1.jsx("div",{className:"w-full md:w-1/2",children:jsxRuntimeExports$1.jsx(StructureViewerWithDownload,{OptimadeStructure:n,cifText:b})}),jsxRuntimeExports$1.jsxs("div",{className:"w-full md:w-1/2 bg-slate-100 rounded shadow border p-2 min-h-[12rem] md:h-[450px] h-[200px] overflow-auto text-xs",children:[jsxRuntimeExports$1.jsx("p",{className:"text-[14px] pb-2",children:"OPTIMADE JSON RESPONSE"}),jsxRuntimeExports$1.jsx(JsonView,{data:n,compactTopLevel:!0,shouldExpandNode:p=>p<2,style:{backgroundColor:""}})]})]}),jsxRuntimeExports$1.jsx("div",{className:"mt-4 flex justify-center",children:jsxRuntimeExports$1.jsx(QEInputButton,{cifText:b})})]})}function ResultsDropdown({results:n,resultsLoading:t,selectedResult:r,setSelectedResult:u}){return jsxRuntimeExports$1.jsxs("div",{className:"w-full mb-4 relative",children:[jsxRuntimeExports$1.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select a result"}),jsxRuntimeExports$1.jsx("select",{className:`${slateDropdown} w-full`,value:r?.id||"",onChange:v=>{const x=n?.data?.find(b=>b.id===v.target.value);x&&u(x)},disabled:t||!n?.data?.length,children:n?.data?.length?n.data.map(v=>jsxRuntimeExports$1.jsx("option",{value:v.id,children:`${v.attributes?.chemical_formula_descriptive||"Unknown"} (${v.id})`},v.id)):jsxRuntimeExports$1.jsx("option",{value:"",children:"No results for current query"})}),t&&jsxRuntimeExports$1.jsx("div",{className:"absolute right-5 top-1/2 bg-white bg-opacity-50 pointer-events-none",children:jsxRuntimeExports$1.jsx("div",{className:"w-5 h-5 border-2 border-t-2 border-gray-400 border-t-blue-500 rounded-full animate-spin"})})]})}function ProviderInfo({queryUrl:n}){const[t,r]=reactExports.useState(null),[u,v]=reactExports.useState([]),[x,b]=reactExports.useState(!1);return reactExports.useEffect(()=>{if(!n)return;b(!0),r(null),v([]);async function p(){try{const{customProps:y,error:k}=await getInfo({providerUrl:n});k&&v([k]),y&&r(y),console.log("cP",y)}catch(y){v([y])}finally{b(!1)}}p()},[n]),n?jsxRuntimeExports$1.jsxs("div",{className:"w-full mt-4",children:[x&&jsxRuntimeExports$1.jsxs("div",{className:"flex items-center justify-center p-4 w-full bg-slate-50 border rounded",children:[jsxRuntimeExports$1.jsx("div",{className:"w-5 h-5 border-2 border-t-2 border-gray-400 border-t-blue-500 rounded-full animate-spin mr-2"}),jsxRuntimeExports$1.jsx("span",{className:"text-gray-500",children:"Loading provider info"})]}),u.length>0&&!x&&jsxRuntimeExports$1.jsxs("div",{className:"bg-red-100 border border-red-500 text-red-700 px-4 py-2 rounded mb-4 w-full",children:[jsxRuntimeExports$1.jsx("strong",{children:"Failed to fetch provider info:"}),jsxRuntimeExports$1.jsx("ul",{className:"list-disc pl-5",children:u.map((p,y)=>jsxRuntimeExports$1.jsx("li",{children:p.message},y))})]}),t&&!x&&jsxRuntimeExports$1.jsxs("div",{className:"w-full py-2 px-4 border rounded bg-slate-50 max-h-72 overflow-auto",children:[jsxRuntimeExports$1.jsx("h4",{className:"text-center font-semibold mb-2 text-xs sm:text-sm md:text-base",children:"Custom attributes in selected database"}),jsxRuntimeExports$1.jsxs("div",{className:"grid grid-cols-[8fr_17fr_2fr] gap-y-0.5 gap-x-2",children:[jsxRuntimeExports$1.jsx("div",{className:"font-semibold truncate text-[9px] sm:text-[11px] md:text-[13px]",children:"Field"}),jsxRuntimeExports$1.jsx("div",{className:"font-semibold text-[9px] sm:text-[11px] md:text-[13px]",children:"Description"}),jsxRuntimeExports$1.jsx("div",{className:"font-semibold truncate text-[9px] sm:text-[11px] md:text-[13px]",children:"Unit"}),Object.entries(t).map(([p,y])=>jsxRuntimeExports$1.jsxs(React.Fragment,{children:[jsxRuntimeExports$1.jsx("div",{className:"break-words text-[9px] sm:text-[11px] md:text-[13px]",children:p}),jsxRuntimeExports$1.jsx("div",{className:"break-words text-[9px] sm:text-[11px] md:text-[13px]",children:y.description||"-"}),jsxRuntimeExports$1.jsx("div",{className:"break-words text-[9px] sm:text-[11px] md:text-[13px]",children:y.unit||"-"})]},p))]})]})]}):null}function PaginationHandler({currentPage:n,totalPages:t,resultsLoading:r,metaData:u,onPageChange:v}){return!t||t<1?null:jsxRuntimeExports$1.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-1 mt-4",children:[jsxRuntimeExports$1.jsx("span",{className:"text-gray-700 text-sm text-center w-full md:w-auto",children:`Filtered results: ${u.data_returned} of ${u.data_available} | Page ${n} of ${t}`}),jsxRuntimeExports$1.jsx("button",{onClick:()=>v(1),disabled:n===1||r,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-default",children:jsxRuntimeExports$1.jsx(FirstIcon,{})}),jsxRuntimeExports$1.jsx("button",{onClick:()=>v(n-1),disabled:n===1||r,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-default",children:jsxRuntimeExports$1.jsx(PreviousIcon,{})}),jsxRuntimeExports$1.jsx("button",{onClick:()=>v(n+1),disabled:n===t||r,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-default",children:jsxRuntimeExports$1.jsx(NextIcon,{})}),jsxRuntimeExports$1.jsx("button",{onClick:()=>v(t),disabled:n===t||r,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-default",children:jsxRuntimeExports$1.jsx(LastIcon,{})})]})}const LayoutGroupContext=reactExports.createContext({});function useConstant(n){const t=reactExports.useRef(null);return t.current===null&&(t.current=n()),t.current}const isBrowser=typeof window<"u",useIsomorphicLayoutEffect=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,PresenceContext=reactExports.createContext(null);function addUniqueItem(n,t){n.indexOf(t)===-1&&n.push(t)}function removeItem(n,t){const r=n.indexOf(t);r>-1&&n.splice(r,1)}const clamp=(n,t,r)=>r>t?t:r<n?n:r;let invariant=()=>{};const MotionGlobalConfig={},isNumericalString=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function isObject(n){return typeof n=="object"&&n!==null}const isZeroValueString=n=>/^0[^.\s]+$/u.test(n);function memo(n){let t;return()=>(t===void 0&&(t=n()),t)}const noop=n=>n,combineFunctions=(n,t)=>r=>t(n(r)),pipe=(...n)=>n.reduce(combineFunctions),progress=(n,t,r)=>{const u=t-n;return u===0?1:(r-n)/u};class SubscriptionManager{constructor(){this.subscriptions=[]}add(t){return addUniqueItem(this.subscriptions,t),()=>removeItem(this.subscriptions,t)}notify(t,r,u){const v=this.subscriptions.length;if(v)if(v===1)this.subscriptions[0](t,r,u);else for(let x=0;x<v;x++){const b=this.subscriptions[x];b&&b(t,r,u)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const secondsToMilliseconds=n=>n*1e3,millisecondsToSeconds=n=>n/1e3;function velocityPerSecond(n,t){return t?n*(1e3/t):0}const calcBezier=(n,t,r)=>(((1-3*r+3*t)*n+(3*r-6*t))*n+3*t)*n,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(n,t,r,u,v){let x,b,p=0;do b=t+(r-t)/2,x=calcBezier(b,u,v)-n,x>0?r=b:t=b;while(Math.abs(x)>subdivisionPrecision&&++p<subdivisionMaxIterations);return b}function cubicBezier(n,t,r,u){if(n===t&&r===u)return noop;const v=x=>binarySubdivide(x,0,1,n,r);return x=>x===0||x===1?x:calcBezier(v(x),t,u)}const mirrorEasing=n=>t=>t<=.5?n(2*t)/2:(2-n(2*(1-t)))/2,reverseEasing=n=>t=>1-n(1-t),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=n=>(n*=2)<1?.5*backIn(n):.5*(2-Math.pow(2,-10*(n-1))),circIn=n=>1-Math.sin(Math.acos(n)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=n=>Array.isArray(n)&&typeof n[0]!="number",isBezierDefinition=n=>Array.isArray(n)&&typeof n[0]=="number",easingLookup={linear:noop,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},isValidEasing=n=>typeof n=="string",easingDefinitionToFunction=n=>{if(isBezierDefinition(n)){invariant(n.length===4);const[t,r,u,v]=n;return cubicBezier(t,r,u,v)}else if(isValidEasing(n))return easingLookup[n];return n},stepsOrder=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function createRenderStep(n,t){let r=new Set,u=new Set,v=!1,x=!1;const b=new WeakSet;let p={delta:0,timestamp:0,isProcessing:!1};function y(g){b.has(g)&&(k.schedule(g),n()),g(p)}const k={schedule:(g,R=!1,P=!1)=>{const C=P&&v?r:u;return R&&b.add(g),C.has(g)||C.add(g),g},cancel:g=>{u.delete(g),b.delete(g)},process:g=>{if(p=g,v){x=!0;return}v=!0,[r,u]=[u,r],r.forEach(y),r.clear(),v=!1,x&&(x=!1,k.process(g))}};return k}const maxElapsed=40;function createRenderBatcher(n,t){let r=!1,u=!0;const v={delta:0,timestamp:0,isProcessing:!1},x=()=>r=!0,b=stepsOrder.reduce((_,M)=>(_[M]=createRenderStep(x),_),{}),{setup:p,read:y,resolveKeyframes:k,preUpdate:g,update:R,preRender:P,render:T,postRender:C}=b,a=()=>{const _=MotionGlobalConfig.useManualTiming?v.timestamp:performance.now();r=!1,MotionGlobalConfig.useManualTiming||(v.delta=u?1e3/60:Math.max(Math.min(_-v.timestamp,maxElapsed),1)),v.timestamp=_,v.isProcessing=!0,p.process(v),y.process(v),k.process(v),g.process(v),R.process(v),P.process(v),T.process(v),C.process(v),v.isProcessing=!1,r&&t&&(u=!1,n(a))},s=()=>{r=!0,u=!0,v.isProcessing||n(a)};return{schedule:stepsOrder.reduce((_,M)=>{const l=b[M];return _[M]=(h,S=!1,E=!1)=>(r||s(),l.schedule(h,S,E)),_},{}),cancel:_=>{for(let M=0;M<stepsOrder.length;M++)b[stepsOrder[M]].cancel(_)},state:v,steps:b}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop,!0);let now;function clearTime(){now=void 0}const time={now:()=>(now===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now),set:n=>{now=n,queueMicrotask(clearTime)}},checkStringStartsWith=n=>t=>typeof t=="string"&&t.startsWith(n),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=n=>startsAsVariableToken(n)?singleCssVariableRegex.test(n.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,number={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},alpha={...number,transform:n=>clamp(0,1,n)},scale={...number,default:1},sanitize=n=>Math.round(n*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(n){return n==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(n,t)=>r=>!!(typeof r=="string"&&singleColorRegex.test(r)&&r.startsWith(n)||t&&!isNullish(r)&&Object.prototype.hasOwnProperty.call(r,t)),splitColor=(n,t,r)=>u=>{if(typeof u!="string")return u;const[v,x,b,p]=u.match(floatRegex);return{[n]:parseFloat(v),[t]:parseFloat(x),[r]:parseFloat(b),alpha:p!==void 0?parseFloat(p):1}},clampRgbUnit=n=>clamp(0,255,n),rgbUnit={...number,transform:n=>Math.round(clampRgbUnit(n))},rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:n,green:t,blue:r,alpha:u=1})=>"rgba("+rgbUnit.transform(n)+", "+rgbUnit.transform(t)+", "+rgbUnit.transform(r)+", "+sanitize(alpha.transform(u))+")"};function parseHex(n){let t="",r="",u="",v="";return n.length>5?(t=n.substring(1,3),r=n.substring(3,5),u=n.substring(5,7),v=n.substring(7,9)):(t=n.substring(1,2),r=n.substring(2,3),u=n.substring(3,4),v=n.substring(4,5),t+=t,r+=r,u+=u,v+=v),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(u,16),alpha:v?parseInt(v,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},createUnitType=n=>({test:t=>typeof t=="string"&&t.endsWith(n)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${n}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:n=>percent.parse(n)/100,transform:n=>percent.transform(n*100)},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:n,saturation:t,lightness:r,alpha:u=1})=>"hsla("+Math.round(n)+", "+percent.transform(sanitize(t))+", "+percent.transform(sanitize(r))+", "+sanitize(alpha.transform(u))+")"},color={test:n=>rgba.test(n)||hex.test(n)||hsla.test(n),parse:n=>rgba.test(n)?rgba.parse(n):hsla.test(n)?hsla.parse(n):hex.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?rgba.transform(n):hsla.transform(n),getAnimatableNone:n=>{const t=color.parse(n);return t.alpha=0,color.transform(t)}},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(n){return isNaN(n)&&typeof n=="string"&&(n.match(floatRegex)?.length||0)+(n.match(colorRegex)?.length||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(n){const t=n.toString(),r=[],u={color:[],number:[],var:[]},v=[];let x=0;const p=t.replace(complexRegex,y=>(color.test(y)?(u.color.push(x),v.push(COLOR_TOKEN),r.push(color.parse(y))):y.startsWith(VAR_FUNCTION_TOKEN)?(u.var.push(x),v.push(VAR_TOKEN),r.push(y)):(u.number.push(x),v.push(NUMBER_TOKEN),r.push(parseFloat(y))),++x,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:r,split:p,indexes:u,types:v}}function parseComplexValue(n){return analyseComplexValue(n).values}function createTransformer(n){const{split:t,types:r}=analyseComplexValue(n),u=t.length;return v=>{let x="";for(let b=0;b<u;b++)if(x+=t[b],v[b]!==void 0){const p=r[b];p===NUMBER_TOKEN?x+=sanitize(v[b]):p===COLOR_TOKEN?x+=color.transform(v[b]):x+=v[b]}return x}}const convertNumbersToZero=n=>typeof n=="number"?0:color.test(n)?color.getAnimatableNone(n):n;function getAnimatableNone$1(n){const t=parseComplexValue(n);return createTransformer(n)(t.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1};function hueToRgb(n,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?n+(t-n)*6*r:r<1/2?t:r<2/3?n+(t-n)*(2/3-r)*6:n}function hslaToRgba({hue:n,saturation:t,lightness:r,alpha:u}){n/=360,t/=100,r/=100;let v=0,x=0,b=0;if(!t)v=x=b=r;else{const p=r<.5?r*(1+t):r+t-r*t,y=2*r-p;v=hueToRgb(y,p,n+1/3),x=hueToRgb(y,p,n),b=hueToRgb(y,p,n-1/3)}return{red:Math.round(v*255),green:Math.round(x*255),blue:Math.round(b*255),alpha:u}}function mixImmediate(n,t){return r=>r>0?t:n}const mixNumber$1=(n,t,r)=>n+(t-n)*r,mixLinearColor=(n,t,r)=>{const u=n*n,v=r*(t*t-u)+u;return v<0?0:Math.sqrt(v)},colorTypes=[hex,rgba,hsla],getColorType=n=>colorTypes.find(t=>t.test(n));function asRGBA(n){const t=getColorType(n);if(!t)return!1;let r=t.parse(n);return t===hsla&&(r=hslaToRgba(r)),r}const mixColor=(n,t)=>{const r=asRGBA(n),u=asRGBA(t);if(!r||!u)return mixImmediate(n,t);const v={...r};return x=>(v.red=mixLinearColor(r.red,u.red,x),v.green=mixLinearColor(r.green,u.green,x),v.blue=mixLinearColor(r.blue,u.blue,x),v.alpha=mixNumber$1(r.alpha,u.alpha,x),rgba.transform(v))},invisibleValues=new Set(["none","hidden"]);function mixVisibility(n,t){return invisibleValues.has(n)?r=>r<=0?n:t:r=>r>=1?t:n}function mixNumber(n,t){return r=>mixNumber$1(n,t,r)}function getMixer(n){return typeof n=="number"?mixNumber:typeof n=="string"?isCSSVariableToken(n)?mixImmediate:color.test(n)?mixColor:mixComplex:Array.isArray(n)?mixArray:typeof n=="object"?color.test(n)?mixColor:mixObject:mixImmediate}function mixArray(n,t){const r=[...n],u=r.length,v=n.map((x,b)=>getMixer(x)(x,t[b]));return x=>{for(let b=0;b<u;b++)r[b]=v[b](x);return r}}function mixObject(n,t){const r={...n,...t},u={};for(const v in r)n[v]!==void 0&&t[v]!==void 0&&(u[v]=getMixer(n[v])(n[v],t[v]));return v=>{for(const x in u)r[x]=u[x](v);return r}}function matchOrder(n,t){const r=[],u={color:0,var:0,number:0};for(let v=0;v<t.values.length;v++){const x=t.types[v],b=n.indexes[x][u[x]],p=n.values[b]??0;r[v]=p,u[x]++}return r}const mixComplex=(n,t)=>{const r=complex.createTransformer(t),u=analyseComplexValue(n),v=analyseComplexValue(t);return u.indexes.var.length===v.indexes.var.length&&u.indexes.color.length===v.indexes.color.length&&u.indexes.number.length>=v.indexes.number.length?invisibleValues.has(n)&&!v.values.length||invisibleValues.has(t)&&!u.values.length?mixVisibility(n,t):pipe(mixArray(matchOrder(u,v),v.values),r):mixImmediate(n,t)};function mix(n,t,r){return typeof n=="number"&&typeof t=="number"&&typeof r=="number"?mixNumber$1(n,t,r):getMixer(n)(n,t)}const frameloopDriver=n=>{const t=({timestamp:r})=>n(r);return{start:(r=!0)=>frame.update(t,r),stop:()=>cancelFrame(t),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generateLinearEasing=(n,t,r=10)=>{let u="";const v=Math.max(Math.round(t/r),2);for(let x=0;x<v;x++)u+=Math.round(n(x/(v-1))*1e4)/1e4+", ";return`linear(${u.substring(0,u.length-2)})`},maxGeneratorDuration=2e4;function calcGeneratorDuration(n){let t=0;const r=50;let u=n.next(t);for(;!u.done&&t<maxGeneratorDuration;)t+=r,u=n.next(t);return t>=maxGeneratorDuration?1/0:t}function createGeneratorEasing(n,t=100,r){const u=r({...n,keyframes:[0,t]}),v=Math.min(calcGeneratorDuration(u),maxGeneratorDuration);return{type:"keyframes",ease:x=>u.next(v*x).value/t,duration:millisecondsToSeconds(v)}}const velocitySampleDuration=5;function calcGeneratorVelocity(n,t,r){const u=Math.max(t-velocitySampleDuration,0);return velocityPerSecond(r-n(u),t-u)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:n=springDefaults.duration,bounce:t=springDefaults.bounce,velocity:r=springDefaults.velocity,mass:u=springDefaults.mass}){let v,x,b=1-t;b=clamp(springDefaults.minDamping,springDefaults.maxDamping,b),n=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(n)),b<1?(v=k=>{const g=k*b,R=g*n,P=g-r,T=calcAngularFreq(k,b),C=Math.exp(-R);return safeMin-P/T*C},x=k=>{const R=k*b*n,P=R*r+r,T=Math.pow(b,2)*Math.pow(k,2)*n,C=Math.exp(-R),a=calcAngularFreq(Math.pow(k,2),b);return(-v(k)+safeMin>0?-1:1)*((P-T)*C)/a}):(v=k=>{const g=Math.exp(-k*n),R=(k-r)*n+1;return-safeMin+g*R},x=k=>{const g=Math.exp(-k*n),R=(r-k)*(n*n);return g*R});const p=5/n,y=approximateRoot(v,x,p);if(n=secondsToMilliseconds(n),isNaN(y))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:n};{const k=Math.pow(y,2)*u;return{stiffness:k,damping:b*2*Math.sqrt(u*k),duration:n}}}const rootIterations=12;function approximateRoot(n,t,r){let u=r;for(let v=1;v<rootIterations;v++)u=u-n(u)/t(u);return u}function calcAngularFreq(n,t){return n*Math.sqrt(1-t*t)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(n,t){return t.some(r=>n[r]!==void 0)}function getSpringOptions(n){let t={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...n};if(!isSpringType(n,physicsKeys)&&isSpringType(n,durationKeys))if(n.visualDuration){const r=n.visualDuration,u=2*Math.PI/(r*1.2),v=u*u,x=2*clamp(.05,1,1-(n.bounce||0))*Math.sqrt(v);t={...t,mass:springDefaults.mass,stiffness:v,damping:x}}else{const r=findSpring(n);t={...t,...r,mass:springDefaults.mass},t.isResolvedFromDuration=!0}return t}function spring(n=springDefaults.visualDuration,t=springDefaults.bounce){const r=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:t}:n;let{restSpeed:u,restDelta:v}=r;const x=r.keyframes[0],b=r.keyframes[r.keyframes.length-1],p={done:!1,value:x},{stiffness:y,damping:k,mass:g,duration:R,velocity:P,isResolvedFromDuration:T}=getSpringOptions({...r,velocity:-millisecondsToSeconds(r.velocity||0)}),C=P||0,a=k/(2*Math.sqrt(y*g)),s=b-x,c=millisecondsToSeconds(Math.sqrt(y/g)),w=Math.abs(s)<5;u||(u=w?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),v||(v=w?springDefaults.restDelta.granular:springDefaults.restDelta.default);let _;if(a<1){const l=calcAngularFreq(c,a);_=h=>{const S=Math.exp(-a*c*h);return b-S*((C+a*c*s)/l*Math.sin(l*h)+s*Math.cos(l*h))}}else if(a===1)_=l=>b-Math.exp(-c*l)*(s+(C+c*s)*l);else{const l=c*Math.sqrt(a*a-1);_=h=>{const S=Math.exp(-a*c*h),E=Math.min(l*h,300);return b-S*((C+a*c*s)*Math.sinh(E)+l*s*Math.cosh(E))/l}}const M={calculatedDuration:T&&R||null,next:l=>{const h=_(l);if(T)p.done=l>=R;else{let S=l===0?C:0;a<1&&(S=l===0?secondsToMilliseconds(C):calcGeneratorVelocity(_,l,h));const E=Math.abs(S)<=u,F=Math.abs(b-h)<=v;p.done=E&&F}return p.value=p.done?b:h,p},toString:()=>{const l=Math.min(calcGeneratorDuration(M),maxGeneratorDuration),h=generateLinearEasing(S=>M.next(l*S).value,l,30);return l+"ms "+h},toTransition:()=>{}};return M}spring.applyToOptions=n=>{const t=createGeneratorEasing(n,100,spring);return n.ease=t.ease,n.duration=secondsToMilliseconds(t.duration),n.type="keyframes",n};function inertia({keyframes:n,velocity:t=0,power:r=.8,timeConstant:u=325,bounceDamping:v=10,bounceStiffness:x=500,modifyTarget:b,min:p,max:y,restDelta:k=.5,restSpeed:g}){const R=n[0],P={done:!1,value:R},T=E=>p!==void 0&&E<p||y!==void 0&&E>y,C=E=>p===void 0?y:y===void 0||Math.abs(p-E)<Math.abs(y-E)?p:y;let a=r*t;const s=R+a,c=b===void 0?s:b(s);c!==s&&(a=c-R);const w=E=>-a*Math.exp(-E/u),_=E=>c+w(E),M=E=>{const F=w(E),D=_(E);P.done=Math.abs(F)<=k,P.value=P.done?c:D};let l,h;const S=E=>{T(P.value)&&(l=E,h=spring({keyframes:[P.value,C(P.value)],velocity:calcGeneratorVelocity(_,E,P.value),damping:v,stiffness:x,restDelta:k,restSpeed:g}))};return S(0),{calculatedDuration:null,next:E=>{let F=!1;return!h&&l===void 0&&(F=!0,M(E),S(E)),l!==void 0&&E>=l?h.next(E-l):(!F&&M(E),P)}}}function createMixers(n,t,r){const u=[],v=r||MotionGlobalConfig.mix||mix,x=n.length-1;for(let b=0;b<x;b++){let p=v(n[b],n[b+1]);if(t){const y=Array.isArray(t)?t[b]||noop:t;p=pipe(y,p)}u.push(p)}return u}function interpolate(n,t,{clamp:r=!0,ease:u,mixer:v}={}){const x=n.length;if(invariant(x===t.length),x===1)return()=>t[0];if(x===2&&t[0]===t[1])return()=>t[1];const b=n[0]===n[1];n[0]>n[x-1]&&(n=[...n].reverse(),t=[...t].reverse());const p=createMixers(t,u,v),y=p.length,k=g=>{if(b&&g<n[0])return t[0];let R=0;if(y>1)for(;R<n.length-2&&!(g<n[R+1]);R++);const P=progress(n[R],n[R+1],g);return p[R](P)};return r?g=>k(clamp(n[0],n[x-1],g)):k}function fillOffset(n,t){const r=n[n.length-1];for(let u=1;u<=t;u++){const v=progress(0,t,u);n.push(mixNumber$1(r,1,v))}}function defaultOffset(n){const t=[0];return fillOffset(t,n.length-1),t}function convertOffsetToTimes(n,t){return n.map(r=>r*t)}function defaultEasing(n,t){return n.map(()=>t||easeInOut).splice(0,n.length-1)}function keyframes({duration:n=300,keyframes:t,times:r,ease:u="easeInOut"}){const v=isEasingArray(u)?u.map(easingDefinitionToFunction):easingDefinitionToFunction(u),x={done:!1,value:t[0]},b=convertOffsetToTimes(r&&r.length===t.length?r:defaultOffset(t),n),p=interpolate(b,t,{ease:Array.isArray(v)?v:defaultEasing(t,v)});return{calculatedDuration:n,next:y=>(x.value=p(y),x.done=y>=n,x)}}const isNotNull$1=n=>n!==null;function getFinalKeyframe$1(n,{repeat:t,repeatType:r="loop"},u,v=1){const x=n.filter(isNotNull$1),p=v<0||t&&r!=="loop"&&t%2===1?0:x.length-1;return!p||u===void 0?x[p]:u}const transitionTypeMap={decay:inertia,inertia,tween:keyframes,keyframes,spring};function replaceTransitionType(n){typeof n.type=="string"&&(n.type=transitionTypeMap[n.type])}class WithPromise{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const percentToProgress=n=>n/100;class JSAnimation extends WithPromise{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==time.now()&&this.tick(time.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;replaceTransitionType(t);const{type:r=keyframes,repeat:u=0,repeatDelay:v=0,repeatType:x,velocity:b=0}=t;let{keyframes:p}=t;const y=r||keyframes;y!==keyframes&&typeof p[0]!="number"&&(this.mixKeyframes=pipe(percentToProgress,mix(p[0],p[1])),p=[0,100]);const k=y({...t,keyframes:p});x==="mirror"&&(this.mirroredGenerator=y({...t,keyframes:[...p].reverse(),velocity:-b})),k.calculatedDuration===null&&(k.calculatedDuration=calcGeneratorDuration(k));const{calculatedDuration:g}=k;this.calculatedDuration=g,this.resolvedDuration=g+v,this.totalDuration=this.resolvedDuration*(u+1)-v,this.generator=k}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:u,totalDuration:v,mixKeyframes:x,mirroredGenerator:b,resolvedDuration:p,calculatedDuration:y}=this;if(this.startTime===null)return u.next(0);const{delay:k=0,keyframes:g,repeat:R,repeatType:P,repeatDelay:T,type:C,onUpdate:a,finalKeyframe:s}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-v/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const c=this.currentTime-k*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?c<0:c>v;this.currentTime=Math.max(c,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=v);let _=this.currentTime,M=u;if(R){const E=Math.min(this.currentTime,v)/p;let F=Math.floor(E),D=E%1;!D&&E>=1&&(D=1),D===1&&F--,F=Math.min(F,R+1),!!(F%2)&&(P==="reverse"?(D=1-D,T&&(D-=T/p)):P==="mirror"&&(M=b)),_=clamp(0,1,D)*p}const l=w?{done:!1,value:g[0]}:M.next(_);x&&(l.value=x(l.value));let{done:h}=l;!w&&y!==null&&(h=this.playbackSpeed>=0?this.currentTime>=v:this.currentTime<=0);const S=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&h);return S&&C!==inertia&&(l.value=getFinalKeyframe$1(g,this.options,s,this.speed)),a&&a(l.value),S&&this.finish(),l}then(t,r){return this.finished.then(t,r)}get duration(){return millisecondsToSeconds(this.calculatedDuration)}get time(){return millisecondsToSeconds(this.currentTime)}set time(t){t=secondsToMilliseconds(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(time.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=millisecondsToSeconds(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=frameloopDriver,startTime:r}=this.options;this.driver||(this.driver=t(v=>this.tick(v))),this.options.onPlay?.();const u=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=u):this.holdTime!==null?this.startTime=u-this.holdTime:this.startTime||(this.startTime=r??u),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(time.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function fillWildcards(n){for(let t=1;t<n.length;t++)n[t]??(n[t]=n[t-1])}const radToDeg=n=>n*180/Math.PI,rotate=n=>{const t=radToDeg(Math.atan2(n[1],n[0]));return rebaseAngle(t)},matrix2dParsers={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate,rotateZ:rotate,skewX:n=>radToDeg(Math.atan(n[1])),skewY:n=>radToDeg(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},rebaseAngle=n=>(n=n%360,n<0&&(n+=360),n),rotateZ=rotate,scaleX=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),scaleY=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),matrix3dParsers={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX,scaleY,scale:n=>(scaleX(n)+scaleY(n))/2,rotateX:n=>rebaseAngle(radToDeg(Math.atan2(n[6],n[5]))),rotateY:n=>rebaseAngle(radToDeg(Math.atan2(-n[2],n[0]))),rotateZ,rotate:rotateZ,skewX:n=>radToDeg(Math.atan(n[4])),skewY:n=>radToDeg(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function defaultTransformValue(n){return n.includes("scale")?1:0}function parseValueFromTransform(n,t){if(!n||n==="none")return defaultTransformValue(t);const r=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let u,v;if(r)u=matrix3dParsers,v=r;else{const p=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);u=matrix2dParsers,v=p}if(!v)return defaultTransformValue(t);const x=u[t],b=v[1].split(",").map(convertTransformToNumber);return typeof x=="function"?x(b):b[x]}const readTransformValue=(n,t)=>{const{transform:r="none"}=getComputedStyle(n);return parseValueFromTransform(r,t)};function convertTransformToNumber(n){return parseFloat(n.trim())}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),isNumOrPxType=n=>n===number||n===px,transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(n=>!transformKeys.has(n));function removeNonTranslationalTransform(n){const t=[];return nonTranslationalTransformKeys.forEach(r=>{const u=n.getValue(r);u!==void 0&&(t.push([r,u.get()]),u.set(r.startsWith("scale")?1:0))}),t}const positionalValues={width:({x:n},{paddingLeft:t="0",paddingRight:r="0"})=>n.max-n.min-parseFloat(t)-parseFloat(r),height:({y:n},{paddingTop:t="0",paddingBottom:r="0"})=>n.max-n.min-parseFloat(t)-parseFloat(r),top:(n,{top:t})=>parseFloat(t),left:(n,{left:t})=>parseFloat(t),bottom:({y:n},{top:t})=>parseFloat(t)+(n.max-n.min),right:({x:n},{left:t})=>parseFloat(t)+(n.max-n.min),x:(n,{transform:t})=>parseValueFromTransform(t,"x"),y:(n,{transform:t})=>parseValueFromTransform(t,"y")};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1,isForced=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const n=Array.from(toResolve).filter(u=>u.needsMeasurement),t=new Set(n.map(u=>u.element)),r=new Map;t.forEach(u=>{const v=removeNonTranslationalTransform(u);v.length&&(r.set(u,v),u.render())}),n.forEach(u=>u.measureInitialState()),t.forEach(u=>{u.render();const v=r.get(u);v&&v.forEach(([x,b])=>{u.getValue(x)?.set(b)})}),n.forEach(u=>u.measureEndState()),n.forEach(u=>{u.suspendedScrollY!==void 0&&window.scrollTo(0,u.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(n=>n.complete(isForced)),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){isForced=!0,readAllKeyframes(),measureAllKeyframes(),isForced=!1}class KeyframeResolver{constructor(t,r,u,v,x,b=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=u,this.motionValue=v,this.element=x,this.isAsync=b}scheduleResolve(){this.state="scheduled",this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:u,motionValue:v}=this;if(t[0]===null){const x=v?.get(),b=t[t.length-1];if(x!==void 0)t[0]=x;else if(u&&r){const p=u.readValue(r,b);p!=null&&(t[0]=p)}t[0]===void 0&&(t[0]=b),v&&x===void 0&&v.set(t[0])}fillWildcards(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),toResolve.delete(this)}cancel(){this.state==="scheduled"&&(toResolve.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const isCSSVar=n=>n.startsWith("--");function setStyle(n,t,r){isCSSVar(t)?n.style.setProperty(t,r):n.style[t]=r}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0),supportsFlags={};function memoSupports(n,t){const r=memo(n);return()=>supportsFlags[t]??r()}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cubicBezierAsString=([n,t,r,u])=>`cubic-bezier(${n}, ${t}, ${r}, ${u})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(n,t){if(n)return typeof n=="function"?supportsLinearEasing()?generateLinearEasing(n,t):"ease-out":isBezierDefinition(n)?cubicBezierAsString(n):Array.isArray(n)?n.map(r=>mapEasingToNativeEasing(r,t)||supportedWaapiEasing.easeOut):supportedWaapiEasing[n]}function startWaapiAnimation(n,t,r,{delay:u=0,duration:v=300,repeat:x=0,repeatType:b="loop",ease:p="easeOut",times:y}={},k=void 0){const g={[t]:r};y&&(g.offset=y);const R=mapEasingToNativeEasing(p,v);Array.isArray(R)&&(g.easing=R);const P={delay:u,duration:v,easing:Array.isArray(R)?"linear":R,fill:"both",iterations:x+1,direction:b==="reverse"?"alternate":"normal"};return k&&(P.pseudoElement=k),n.animate(g,P)}function isGenerator(n){return typeof n=="function"&&"applyToOptions"in n}function applyGeneratorOptions({type:n,...t}){return isGenerator(n)&&supportsLinearEasing()?n.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class NativeAnimation extends WithPromise{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:u,keyframes:v,pseudoElement:x,allowFlatten:b=!1,finalKeyframe:p,onComplete:y}=t;this.isPseudoElement=!!x,this.allowFlatten=b,this.options=t,invariant(typeof t.type!="string");const k=applyGeneratorOptions(t);this.animation=startWaapiAnimation(r,u,v,k,x),k.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!x){const g=getFinalKeyframe$1(v,this.options,p,this.speed);this.updateMotionValue?this.updateMotionValue(g):setStyle(r,u,g),this.animation.cancel()}y?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return millisecondsToSeconds(Number(t))}get time(){return millisecondsToSeconds(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=secondsToMilliseconds(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&supportsScrollTimeline()?(this.animation.timeline=t,noop):r(this)}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(n){return n in unsupportedEasingFunctions}function replaceStringEasing(n){typeof n.ease=="string"&&isUnsupportedEase(n.ease)&&(n.ease=unsupportedEasingFunctions[n.ease])}const sampleDelta=10;class NativeAnimationExtended extends NativeAnimation{constructor(t){replaceStringEasing(t),replaceTransitionType(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:u,onComplete:v,element:x,...b}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const p=new JSAnimation({...b,autoplay:!1}),y=secondsToMilliseconds(this.finishedTime??this.time);r.setWithVelocity(p.sample(y-sampleDelta).value,p.sample(y).value,sampleDelta),p.stop()}}const isAnimatable=(n,t)=>t==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(complex.test(n)||n==="0")&&!n.startsWith("url("));function hasKeyframesChanged(n){const t=n[0];if(n.length===1)return!0;for(let r=0;r<n.length;r++)if(n[r]!==t)return!0}function canAnimate(n,t,r,u){const v=n[0];if(v===null)return!1;if(t==="display"||t==="visibility")return!0;const x=n[n.length-1],b=isAnimatable(v,t),p=isAnimatable(x,t);return!b||!p?!1:hasKeyframesChanged(n)||(r==="spring"||isGenerator(r))&&u}function makeAnimationInstant(n){n.duration=0,n.type}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]),supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function supportsBrowserAnimation(n){const{motionValue:t,name:r,repeatDelay:u,repeatType:v,damping:x,type:b}=n;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:y,transformTemplate:k}=t.owner.getProps();return supportsWaapi()&&r&&acceleratedValues.has(r)&&(r!=="transform"||!k)&&!y&&!u&&v!=="mirror"&&x!==0&&b!=="inertia"}const MAX_RESOLVE_DELAY=40;class AsyncMotionValueAnimation extends WithPromise{constructor({autoplay:t=!0,delay:r=0,type:u="keyframes",repeat:v=0,repeatDelay:x=0,repeatType:b="loop",keyframes:p,name:y,motionValue:k,element:g,...R}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=time.now();const P={autoplay:t,delay:r,type:u,repeat:v,repeatDelay:x,repeatType:b,name:y,motionValue:k,element:g,...R},T=g?.KeyframeResolver||KeyframeResolver;this.keyframeResolver=new T(p,(C,a,s)=>this.onKeyframesResolved(C,a,P,!s),y,k,g),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,r,u,v){this.keyframeResolver=void 0;const{name:x,type:b,velocity:p,delay:y,isHandoff:k,onUpdate:g}=u;this.resolvedAt=time.now(),canAnimate(t,x,b,p)||((MotionGlobalConfig.instantAnimations||!y)&&g?.(getFinalKeyframe$1(t,u,r)),t[0]=t[t.length-1],makeAnimationInstant(u),u.repeat=0);const P={startTime:v?this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...u,keyframes:t},T=!k&&supportsBrowserAnimation(P)?new NativeAnimationExtended({...P,element:P.motionValue.owner.current}):new JSAnimation(P);T.finished.then(()=>this.notifyFinished()).catch(noop),this.pendingTimeline&&(this.stopTimeline=T.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=T}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),flushKeyframeResolvers()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(n){const t=splitCSSVariableRegex.exec(n);if(!t)return[,];const[,r,u,v]=t;return[`--${r??u}`,v]}function getVariableValue(n,t,r=1){const[u,v]=parseCSSVariable(n);if(!u)return;const x=window.getComputedStyle(t).getPropertyValue(u);if(x){const b=x.trim();return isNumericalString(b)?parseFloat(b):b}return isCSSVariableToken(v)?getVariableValue(v,t,r+1):v}function getValueTransition(n,t){return n?.[t]??n?.default??n}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]),auto={test:n=>n==="auto",parse:n=>n},testValueType=n=>t=>t.test(n),dimensionValueTypes=[number,px,percent,degrees,vw,vh,auto],findDimensionValueType=n=>dimensionValueTypes.find(testValueType(n));function isNone(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||isZeroValueString(n):!0}const maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(n){const[t,r]=n.slice(0,-1).split("(");if(t==="drop-shadow")return n;const[u]=r.match(floatRegex)||[];if(!u)return n;const v=r.replace(u,"");let x=maxDefaults.has(t)?1:0;return u!==r&&(x*=100),t+"("+x+v+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:n=>{const t=n.match(functionRegex);return t?t.map(applyDefaultFilter).join(" "):n}},int={...number,transform:Math.round},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,backgroundPositionX:px,backgroundPositionY:px,...transformValueTypes,zIndex:int,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},defaultValueTypes={...numberValueTypes,color,backgroundColor:color,outlineColor:color,fill:color,stroke:color,borderColor:color,borderTopColor:color,borderRightColor:color,borderBottomColor:color,borderLeftColor:color,filter,WebkitFilter:filter},getDefaultValueType=n=>defaultValueTypes[n];function getAnimatableNone(n,t){let r=getDefaultValueType(n);return r!==filter&&(r=complex),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(n,t,r){let u=0,v;for(;u<n.length&&!v;){const x=n[u];typeof x=="string"&&!invalidTemplates.has(x)&&analyseComplexValue(x).values.length&&(v=n[u]),u++}if(v&&r)for(const x of t)n[x]=getAnimatableNone(r,v)}class DOMKeyframesResolver extends KeyframeResolver{constructor(t,r,u,v,x){super(t,r,u,v,x,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:u}=this;if(!r||!r.current)return;super.readKeyframes();for(let y=0;y<t.length;y++){let k=t[y];if(typeof k=="string"&&(k=k.trim(),isCSSVariableToken(k))){const g=getVariableValue(k,r.current);g!==void 0&&(t[y]=g),y===t.length-1&&(this.finalKeyframe=k)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(u)||t.length!==2)return;const[v,x]=t,b=findDimensionValueType(v),p=findDimensionValueType(x);if(b!==p)if(isNumOrPxType(b)&&isNumOrPxType(p))for(let y=0;y<t.length;y++){const k=t[y];typeof k=="string"&&(t[y]=parseFloat(k))}else positionalValues[u]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,u=[];for(let v=0;v<t.length;v++)(t[v]===null||isNone(t[v]))&&u.push(v);u.length&&makeNoneKeyframesAnimatable(t,u,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:u}=this;if(!t||!t.current)return;u==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[u](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const v=r[r.length-1];v!==void 0&&t.getValue(u,v).jump(v,!1)}measureEndState(){const{element:t,name:r,unresolvedKeyframes:u}=this;if(!t||!t.current)return;const v=t.getValue(r);v&&v.jump(this.measuredOrigin,!1);const x=u.length-1,b=u[x];u[x]=positionalValues[r](t.measureViewportBox(),window.getComputedStyle(t.current)),b!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=b),this.removedTransforms?.length&&this.removedTransforms.forEach(([p,y])=>{t.getValue(p).set(y)}),this.resolveNoneKeyframes()}}function resolveElements(n,t,r){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let u=document;const v=r?.[n]??u.querySelectorAll(n);return v?Array.from(v):[]}return Array.from(n)}const getValueAsType=(n,t)=>t&&typeof n=="number"?t.transform(n):n;function isHTMLElement(n){return isObject(n)&&"offsetHeight"in n}const MAX_VELOCITY_DELTA=30,isFloat=n=>!isNaN(parseFloat(n));class MotionValue{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=u=>{const v=time.now();if(this.updatedAt!==v&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(u),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const x of this.dependents)x.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=time.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new SubscriptionManager);const u=this.events[t].add(r);return t==="change"?()=>{u(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:u}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,u){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-u}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(n,t){return new MotionValue(n,t)}const{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function setDragLock(n){return n==="x"||n==="y"?isDragging[n]?null:(isDragging[n]=!0,()=>{isDragging[n]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}function setupGesture(n,t){const r=resolveElements(n),u=new AbortController,v={passive:!0,...t,signal:u.signal};return[r,v,()=>u.abort()]}function isValidHover(n){return!(n.pointerType==="touch"||isDragActive())}function hover(n,t,r={}){const[u,v,x]=setupGesture(n,r),b=p=>{if(!isValidHover(p))return;const{target:y}=p,k=t(y,p);if(typeof k!="function"||!y)return;const g=R=>{isValidHover(R)&&(k(R),y.removeEventListener("pointerleave",g))};y.addEventListener("pointerleave",g,v)};return u.forEach(p=>{p.addEventListener("pointerenter",b,v)}),x}const isNodeOrChild=(n,t)=>t?n===t?!0:isNodeOrChild(n,t.parentElement):!1,isPrimaryPointer=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,focusableElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(n){return focusableElements.has(n.tagName)||n.tabIndex!==-1}const isPressing=new WeakSet;function filterEvents(n){return t=>{t.key==="Enter"&&n(t)}}function firePointerEvent(n,t){n.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(n,t)=>{const r=n.currentTarget;if(!r)return;const u=filterEvents(()=>{if(isPressing.has(r))return;firePointerEvent(r,"down");const v=filterEvents(()=>{firePointerEvent(r,"up")}),x=()=>firePointerEvent(r,"cancel");r.addEventListener("keyup",v,t),r.addEventListener("blur",x,t)});r.addEventListener("keydown",u,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",u),t)};function isValidPressEvent(n){return isPrimaryPointer(n)&&!isDragActive()}function press(n,t,r={}){const[u,v,x]=setupGesture(n,r),b=p=>{const y=p.currentTarget;if(!isValidPressEvent(p))return;isPressing.add(y);const k=t(y,p),g=(T,C)=>{window.removeEventListener("pointerup",R),window.removeEventListener("pointercancel",P),isPressing.has(y)&&isPressing.delete(y),isValidPressEvent(T)&&typeof k=="function"&&k(T,{success:C})},R=T=>{g(T,y===window||y===document||r.useGlobalTarget||isNodeOrChild(y,T.target))},P=T=>{g(T,!1)};window.addEventListener("pointerup",R,v),window.addEventListener("pointercancel",P,v)};return u.forEach(p=>{(r.useGlobalTarget?window:p).addEventListener("pointerdown",b,v),isHTMLElement(p)&&(p.addEventListener("focus",k=>enableKeyboardPress(k,v)),!isElementKeyboardAccessible(p)&&!p.hasAttribute("tabindex")&&(p.tabIndex=0))}),x}function isSVGElement(n){return isObject(n)&&"ownerSVGElement"in n}function isSVGSVGElement(n){return isSVGElement(n)&&n.tagName==="svg"}const isMotionValue=n=>!!(n&&n.getVelocity),valueTypes=[...dimensionValueTypes,color,complex],findValueType=n=>valueTypes.find(testValueType(n)),MotionConfigContext=reactExports.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function setRef(n,t){if(typeof n=="function")return n(t);n!=null&&(n.current=t)}function composeRefs(...n){return t=>{let r=!1;const u=n.map(v=>{const x=setRef(v,t);return!r&&typeof x=="function"&&(r=!0),x});if(r)return()=>{for(let v=0;v<u.length;v++){const x=u[v];typeof x=="function"?x():setRef(n[v],null)}}}}function useComposedRefs(...n){return reactExports.useCallback(composeRefs(...n),n)}class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const u=r.offsetParent,v=isHTMLElement(u)&&u.offsetWidth||0,x=this.props.sizeRef.current;x.height=r.offsetHeight||0,x.width=r.offsetWidth||0,x.top=r.offsetTop,x.left=r.offsetLeft,x.right=v-x.width-x.left}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:n,isPresent:t,anchorX:r,root:u}){const v=reactExports.useId(),x=reactExports.useRef(null),b=reactExports.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:p}=reactExports.useContext(MotionConfigContext),y=useComposedRefs(x,n?.ref);return reactExports.useInsertionEffect(()=>{const{width:k,height:g,top:R,left:P,right:T}=b.current;if(t||!x.current||!k||!g)return;const C=r==="left"?`left: ${P}`:`right: ${T}`;x.current.dataset.motionPopId=v;const a=document.createElement("style");p&&(a.nonce=p);const s=u??document.head;return s.appendChild(a),a.sheet&&a.sheet.insertRule(`
          [data-motion-pop-id="${v}"] {
            position: absolute !important;
            width: ${k}px !important;
            height: ${g}px !important;
            ${C}px !important;
            top: ${R}px !important;
          }
        `),()=>{s.contains(a)&&s.removeChild(a)}},[t]),jsxRuntimeExports$1.jsx(PopChildMeasure,{isPresent:t,childRef:x,sizeRef:b,children:reactExports.cloneElement(n,{ref:y})})}const PresenceChild=({children:n,initial:t,isPresent:r,onExitComplete:u,custom:v,presenceAffectsLayout:x,mode:b,anchorX:p,root:y})=>{const k=useConstant(newChildrenMap),g=reactExports.useId();let R=!0,P=reactExports.useMemo(()=>(R=!1,{id:g,initial:t,isPresent:r,custom:v,onExitComplete:T=>{k.set(T,!0);for(const C of k.values())if(!C)return;u&&u()},register:T=>(k.set(T,!1),()=>k.delete(T))}),[r,k,u]);return x&&R&&(P={...P}),reactExports.useMemo(()=>{k.forEach((T,C)=>k.set(C,!1))},[r]),reactExports.useEffect(()=>{!r&&!k.size&&u&&u()},[r]),b==="popLayout"&&(n=jsxRuntimeExports$1.jsx(PopChild,{isPresent:r,anchorX:p,root:y,children:n})),jsxRuntimeExports$1.jsx(PresenceContext.Provider,{value:P,children:n})};function newChildrenMap(){return new Map}function usePresence(n=!0){const t=reactExports.useContext(PresenceContext);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:u,register:v}=t,x=reactExports.useId();reactExports.useEffect(()=>{if(n)return v(x)},[n]);const b=reactExports.useCallback(()=>n&&u&&u(x),[x,u,n]);return!r&&u?[!1,b]:[!0]}const getChildKey=n=>n.key||"";function onlyElements(n){const t=[];return reactExports.Children.forEach(n,r=>{reactExports.isValidElement(r)&&t.push(r)}),t}const AnimatePresence=({children:n,custom:t,initial:r=!0,onExitComplete:u,presenceAffectsLayout:v=!0,mode:x="sync",propagate:b=!1,anchorX:p="left",root:y})=>{const[k,g]=usePresence(b),R=reactExports.useMemo(()=>onlyElements(n),[n]),P=b&&!k?[]:R.map(getChildKey),T=reactExports.useRef(!0),C=reactExports.useRef(R),a=useConstant(()=>new Map),[s,c]=reactExports.useState(R),[w,_]=reactExports.useState(R);useIsomorphicLayoutEffect(()=>{T.current=!1,C.current=R;for(let h=0;h<w.length;h++){const S=getChildKey(w[h]);P.includes(S)?a.delete(S):a.get(S)!==!0&&a.set(S,!1)}},[w,P.length,P.join("-")]);const M=[];if(R!==s){let h=[...R];for(let S=0;S<w.length;S++){const E=w[S],F=getChildKey(E);P.includes(F)||(h.splice(S,0,E),M.push(E))}return x==="wait"&&M.length&&(h=M),_(onlyElements(h)),c(R),null}const{forceRender:l}=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports$1.jsx(jsxRuntimeExports$1.Fragment,{children:w.map(h=>{const S=getChildKey(h),E=b&&!k?!1:R===w||P.includes(S),F=()=>{if(a.has(S))a.set(S,!0);else return;let D=!0;a.forEach(L=>{L||(D=!1)}),D&&(l?.(),_(C.current),b&&g?.(),u&&u())};return jsxRuntimeExports$1.jsx(PresenceChild,{isPresent:E,initial:!T.current||r?void 0:!1,custom:t,presenceAffectsLayout:v,mode:x,root:y,onExitComplete:E?void 0:F,anchorX:p,children:h},S)})})},LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const n in featureProps)featureDefinitions[n]={isEnabled:t=>featureProps[n].some(r=>!!t[r])};function loadFeatures(n){for(const t in n)featureDefinitions[t]={...featureDefinitions[t],...n[t]}}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||validMotionProps.has(n)}let shouldForward=n=>!isValidMotionProp(n);function loadExternalIsValidProp(n){typeof n=="function"&&(shouldForward=t=>t.startsWith("on")?!isValidMotionProp(t):n(t))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(n,t,r){const u={};for(const v in n)v==="values"&&typeof n.values=="object"||(shouldForward(v)||r===!0&&isValidMotionProp(v)||!t&&!isValidMotionProp(v)||n.draggable&&v.startsWith("onDrag"))&&(u[v]=n[v]);return u}const MotionContext=reactExports.createContext({});function isAnimationControls(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function isVariantLabel(n){return typeof n=="string"||Array.isArray(n)}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(n){return isAnimationControls(n.animate)||variantProps.some(t=>isVariantLabel(n[t]))}function isVariantNode(n){return!!(isControllingVariants(n)||n.variants)}function getCurrentTreeVariants(n,t){if(isControllingVariants(n)){const{initial:r,animate:u}=n;return{initial:r===!1||isVariantLabel(r)?r:void 0,animate:isVariantLabel(u)?u:void 0}}return n.inherit!==!1?t:{}}function useCreateMotionContext(n){const{initial:t,animate:r}=getCurrentTreeVariants(n,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:t,animate:r}),[variantLabelsAsDependency(t),variantLabelsAsDependency(r)])}function variantLabelsAsDependency(n){return Array.isArray(n)?n.join(" "):n}const scaleCorrectors={};function addScaleCorrector(n){for(const t in n)scaleCorrectors[t]=n[t],isCSSVariableName(t)&&(scaleCorrectors[t].isCSSVariable=!0)}function isForcedMotionValue(n,{layout:t,layoutId:r}){return transformProps.has(n)||n.startsWith("origin")||(t||r!==void 0)&&(!!scaleCorrectors[n]||n==="opacity")}const translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(n,t,r){let u="",v=!0;for(let x=0;x<numTransforms;x++){const b=transformPropOrder[x],p=n[b];if(p===void 0)continue;let y=!0;if(typeof p=="number"?y=p===(b.startsWith("scale")?1:0):y=parseFloat(p)===0,!y||r){const k=getValueAsType(p,numberValueTypes[b]);if(!y){v=!1;const g=translateAlias[b]||b;u+=`${g}(${k}) `}r&&(t[b]=k)}}return u=u.trim(),r?u=r(t,v?"":u):v&&(u="none"),u}function buildHTMLStyles(n,t,r){const{style:u,vars:v,transformOrigin:x}=n;let b=!1,p=!1;for(const y in t){const k=t[y];if(transformProps.has(y)){b=!0;continue}else if(isCSSVariableName(y)){v[y]=k;continue}else{const g=getValueAsType(k,numberValueTypes[y]);y.startsWith("origin")?(p=!0,x[y]=g):u[y]=g}}if(t.transform||(b||r?u.transform=buildTransform(t,n.transform,r):u.transform&&(u.transform="none")),p){const{originX:y="50%",originY:k="50%",originZ:g=0}=x;u.transformOrigin=`${y} ${k} ${g}`}}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(n,t,r){for(const u in t)!isMotionValue(t[u])&&!isForcedMotionValue(u,r)&&(n[u]=t[u])}function useInitialMotionValues({transformTemplate:n},t){return reactExports.useMemo(()=>{const r=createHtmlRenderState();return buildHTMLStyles(r,t,n),Object.assign({},r.vars,r.style)},[t])}function useStyle(n,t){const r=n.style||{},u={};return copyRawValuesOnly(u,r,n),Object.assign(u,useInitialMotionValues(n,t)),u}function useHTMLProps(n,t){const r={},u=useStyle(n,t);return n.drag&&n.dragListener!==!1&&(r.draggable=!1,u.userSelect=u.WebkitUserSelect=u.WebkitTouchCallout="none",u.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(r.tabIndex=0),r.style=u,r}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(n,t,r=1,u=0,v=!0){n.pathLength=1;const x=v?dashKeys:camelKeys;n[x.offset]=px.transform(-u);const b=px.transform(t),p=px.transform(r);n[x.array]=`${b} ${p}`}function buildSVGAttrs(n,{attrX:t,attrY:r,attrScale:u,pathLength:v,pathSpacing:x=1,pathOffset:b=0,...p},y,k,g){if(buildHTMLStyles(n,p,k),y){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:R,style:P}=n;R.transform&&(P.transform=R.transform,delete R.transform),(P.transform||R.transformOrigin)&&(P.transformOrigin=R.transformOrigin??"50% 50%",delete R.transformOrigin),P.transform&&(P.transformBox=g?.transformBox??"fill-box",delete R.transformBox),t!==void 0&&(R.x=t),r!==void 0&&(R.y=r),u!==void 0&&(R.scale=u),v!==void 0&&buildSVGPath(R,v,x,b,!1)}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=n=>typeof n=="string"&&n.toLowerCase()==="svg";function useSVGProps(n,t,r,u){const v=reactExports.useMemo(()=>{const x=createSvgRenderState();return buildSVGAttrs(x,t,isSVGTag(u),n.transformTemplate,n.style),{...x.attrs,style:{...x.style}}},[t]);if(n.style){const x={};copyRawValuesOnly(x,n.style,n),v.style={...x,...v.style}}return v}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(n){return typeof n!="string"||n.includes("-")?!1:!!(lowercaseSVGElements.indexOf(n)>-1||/[A-Z]/u.test(n))}function useRender(n,t,r,{latestValues:u},v,x=!1){const p=(isSVGComponent(n)?useSVGProps:useHTMLProps)(t,u,v,n),y=filterProps(t,typeof n=="string",x),k=n!==reactExports.Fragment?{...y,...p,ref:r}:{},{children:g}=t,R=reactExports.useMemo(()=>isMotionValue(g)?g.get():g,[g]);return reactExports.createElement(n,{...k,children:R})}function getValueState(n){const t=[{},{}];return n?.values.forEach((r,u)=>{t[0][u]=r.get(),t[1][u]=r.getVelocity()}),t}function resolveVariantFromProps(n,t,r,u){if(typeof t=="function"){const[v,x]=getValueState(u);t=t(r!==void 0?r:n.custom,v,x)}if(typeof t=="string"&&(t=n.variants&&n.variants[t]),typeof t=="function"){const[v,x]=getValueState(u);t=t(r!==void 0?r:n.custom,v,x)}return t}function resolveMotionValue(n){return isMotionValue(n)?n.get():n}function makeState({scrapeMotionValuesFromProps:n,createRenderState:t},r,u,v){return{latestValues:makeLatestValues(r,u,v,n),renderState:t()}}function makeLatestValues(n,t,r,u){const v={},x=u(n,{});for(const P in x)v[P]=resolveMotionValue(x[P]);let{initial:b,animate:p}=n;const y=isControllingVariants(n),k=isVariantNode(n);t&&k&&!y&&n.inherit!==!1&&(b===void 0&&(b=t.initial),p===void 0&&(p=t.animate));let g=r?r.initial===!1:!1;g=g||b===!1;const R=g?p:b;if(R&&typeof R!="boolean"&&!isAnimationControls(R)){const P=Array.isArray(R)?R:[R];for(let T=0;T<P.length;T++){const C=resolveVariantFromProps(n,P[T]);if(C){const{transitionEnd:a,transition:s,...c}=C;for(const w in c){let _=c[w];if(Array.isArray(_)){const M=g?_.length-1:0;_=_[M]}_!==null&&(v[w]=_)}for(const w in a)v[w]=a[w]}}}return v}const makeUseVisualState=n=>(t,r)=>{const u=reactExports.useContext(MotionContext),v=reactExports.useContext(PresenceContext),x=()=>makeState(n,t,u,v);return r?x():useConstant(x)};function scrapeMotionValuesFromProps$1(n,t,r){const{style:u}=n,v={};for(const x in u)(isMotionValue(u[x])||t.style&&isMotionValue(t.style[x])||isForcedMotionValue(x,n)||r?.getValue(x)?.liveStyle!==void 0)&&(v[x]=u[x]);return v}const useHTMLVisualState=makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState});function scrapeMotionValuesFromProps(n,t,r){const u=scrapeMotionValuesFromProps$1(n,t,r);for(const v in n)if(isMotionValue(n[v])||isMotionValue(t[v])){const x=transformPropOrder.indexOf(v)!==-1?"attr"+v.charAt(0).toUpperCase()+v.substring(1):v;u[x]=n[v]}return u}const useSVGVisualState=makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState}),motionComponentSymbol=Symbol.for("motionComponentSymbol");function isRefObject(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function useMotionRef(n,t,r){return reactExports.useCallback(u=>{u&&n.onMount&&n.onMount(u),t&&(u?t.mount(u):t.unmount()),r&&(typeof r=="function"?r(u):isRefObject(r)&&(r.current=u))},[t])}const camelToDash=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),SwitchLayoutGroupContext=reactExports.createContext({});function useVisualElement(n,t,r,u,v){const{visualElement:x}=reactExports.useContext(MotionContext),b=reactExports.useContext(LazyContext),p=reactExports.useContext(PresenceContext),y=reactExports.useContext(MotionConfigContext).reducedMotion,k=reactExports.useRef(null);u=u||b.renderer,!k.current&&u&&(k.current=u(n,{visualState:t,parent:x,props:r,presenceContext:p,blockInitialAnimation:p?p.initial===!1:!1,reducedMotionConfig:y}));const g=k.current,R=reactExports.useContext(SwitchLayoutGroupContext);g&&!g.projection&&v&&(g.type==="html"||g.type==="svg")&&createProjectionNode$1(k.current,r,v,R);const P=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{g&&P.current&&g.update(r,p)});const T=r[optimizedAppearDataAttribute],C=reactExports.useRef(!!T&&!window.MotionHandoffIsComplete?.(T)&&window.MotionHasOptimisedAnimation?.(T));return useIsomorphicLayoutEffect(()=>{g&&(P.current=!0,window.MotionIsMounted=!0,g.updateFeatures(),g.scheduleRenderMicrotask(),C.current&&g.animationState&&g.animationState.animateChanges())}),reactExports.useEffect(()=>{g&&(!C.current&&g.animationState&&g.animationState.animateChanges(),C.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(T)}),C.current=!1),g.enteringChildren=void 0)}),g}function createProjectionNode$1(n,t,r,u){const{layoutId:v,layout:x,drag:b,dragConstraints:p,layoutScroll:y,layoutRoot:k,layoutCrossfade:g}=t;n.projection=new r(n.latestValues,t["data-framer-portal-id"]?void 0:getClosestProjectingNode(n.parent)),n.projection.setOptions({layoutId:v,layout:x,alwaysMeasureLayout:!!b||p&&isRefObject(p),visualElement:n,animationType:typeof x=="string"?x:"both",initialPromotionConfig:u,crossfade:g,layoutScroll:y,layoutRoot:k})}function getClosestProjectingNode(n){if(n)return n.options.allowProjection!==!1?n.projection:getClosestProjectingNode(n.parent)}function createMotionComponent(n,{forwardMotionProps:t=!1}={},r,u){r&&loadFeatures(r);const v=isSVGComponent(n)?useSVGVisualState:useHTMLVisualState;function x(p,y){let k;const g={...reactExports.useContext(MotionConfigContext),...p,layoutId:useLayoutId(p)},{isStatic:R}=g,P=useCreateMotionContext(p),T=v(p,R);if(!R&&isBrowser){useStrictMode();const C=getProjectionFunctionality(g);k=C.MeasureLayout,P.visualElement=useVisualElement(n,T,g,u,C.ProjectionNode)}return jsxRuntimeExports$1.jsxs(MotionContext.Provider,{value:P,children:[k&&P.visualElement?jsxRuntimeExports$1.jsx(k,{visualElement:P.visualElement,...g}):null,useRender(n,p,useMotionRef(T,P.visualElement,y),T,R,t)]})}x.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const b=reactExports.forwardRef(x);return b[motionComponentSymbol]=n,b}function useLayoutId({layoutId:n}){const t=reactExports.useContext(LayoutGroupContext).id;return t&&n!==void 0?t+"-"+n:n}function useStrictMode(n,t){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(n){const{drag:t,layout:r}=featureDefinitions;if(!t&&!r)return{};const u={...t,...r};return{MeasureLayout:t?.isEnabled(n)||r?.isEnabled(n)?u.MeasureLayout:void 0,ProjectionNode:u.ProjectionNode}}function createMotionProxy(n,t){if(typeof Proxy>"u")return createMotionComponent;const r=new Map,u=(x,b)=>createMotionComponent(x,b,n,t),v=(x,b)=>u(x,b);return new Proxy(v,{get:(x,b)=>b==="create"?u:(r.has(b)||r.set(b,createMotionComponent(b,void 0,n,t)),r.get(b))})}function convertBoundingBoxToBox({top:n,left:t,right:r,bottom:u}){return{x:{min:t,max:r},y:{min:n,max:u}}}function convertBoxToBoundingBox({x:n,y:t}){return{top:t.min,right:n.max,bottom:t.max,left:n.min}}function transformBoxPoints(n,t){if(!t)return n;const r=t({x:n.left,y:n.top}),u=t({x:n.right,y:n.bottom});return{top:r.y,left:r.x,bottom:u.y,right:u.x}}function isIdentityScale(n){return n===void 0||n===1}function hasScale({scale:n,scaleX:t,scaleY:r}){return!isIdentityScale(n)||!isIdentityScale(t)||!isIdentityScale(r)}function hasTransform(n){return hasScale(n)||has2DTranslate(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function has2DTranslate(n){return is2DTranslate(n.x)||is2DTranslate(n.y)}function is2DTranslate(n){return n&&n!=="0%"}function scalePoint(n,t,r){const u=n-r,v=t*u;return r+v}function applyPointDelta(n,t,r,u,v){return v!==void 0&&(n=scalePoint(n,v,u)),scalePoint(n,r,u)+t}function applyAxisDelta(n,t=0,r=1,u,v){n.min=applyPointDelta(n.min,t,r,u,v),n.max=applyPointDelta(n.max,t,r,u,v)}function applyBoxDelta(n,{x:t,y:r}){applyAxisDelta(n.x,t.translate,t.scale,t.originPoint),applyAxisDelta(n.y,r.translate,r.scale,r.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(n,t,r,u=!1){const v=r.length;if(!v)return;t.x=t.y=1;let x,b;for(let p=0;p<v;p++){x=r[p],b=x.projectionDelta;const{visualElement:y}=x.options;y&&y.props.style&&y.props.style.display==="contents"||(u&&x.options.layoutScroll&&x.scroll&&x!==x.root&&transformBox(n,{x:-x.scroll.offset.x,y:-x.scroll.offset.y}),b&&(t.x*=b.x.scale,t.y*=b.y.scale,applyBoxDelta(n,b)),u&&hasTransform(x.latestValues)&&transformBox(n,x.latestValues))}t.x<TREE_SCALE_SNAP_MAX&&t.x>TREE_SCALE_SNAP_MIN&&(t.x=1),t.y<TREE_SCALE_SNAP_MAX&&t.y>TREE_SCALE_SNAP_MIN&&(t.y=1)}function translateAxis(n,t){n.min=n.min+t,n.max=n.max+t}function transformAxis(n,t,r,u,v=.5){const x=mixNumber$1(n.min,n.max,v);applyAxisDelta(n,t,r,x,u)}function transformBox(n,t){transformAxis(n.x,t.x,t.scaleX,t.scale,t.originX),transformAxis(n.y,t.y,t.scaleY,t.scale,t.originY)}function measureViewportBox(n,t){return convertBoundingBoxToBox(transformBoxPoints(n.getBoundingClientRect(),t))}function measurePageBox(n,t,r){const u=measureViewportBox(n,r),{scroll:v}=t;return v&&(translateAxis(u.x,v.offset.x),translateAxis(u.y,v.offset.y)),u}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()}),prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),t=()=>prefersReducedMotion.current=n.matches;n.addEventListener("change",t),t()}else prefersReducedMotion.current=!1}const visualElementStore=new WeakMap;function updateMotionValuesFromProps(n,t,r){for(const u in t){const v=t[u],x=r[u];if(isMotionValue(v))n.addValue(u,v);else if(isMotionValue(x))n.addValue(u,motionValue(v,{owner:n}));else if(x!==v)if(n.hasValue(u)){const b=n.getValue(u);b.liveStyle===!0?b.jump(v):b.hasAnimated||b.set(v)}else{const b=n.getStaticValue(u);n.addValue(u,motionValue(b!==void 0?b:v,{owner:n}))}}for(const u in r)t[u]===void 0&&n.removeValue(u);return t}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps(t,r,u){return{}}constructor({parent:t,props:r,presenceContext:u,reducedMotionConfig:v,blockInitialAnimation:x,visualState:b},p={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const P=time.now();this.renderScheduledAt<P&&(this.renderScheduledAt=P,frame.render(this.render,!1,!0))};const{latestValues:y,renderState:k}=b;this.latestValues=y,this.baseTarget={...y},this.initialValues=r.initial?{...y}:{},this.renderState=k,this.parent=t,this.props=r,this.presenceContext=u,this.depth=t?t.depth+1:0,this.reducedMotionConfig=v,this.options=p,this.blockInitialAnimation=!!x,this.isControllingVariants=isControllingVariants(r),this.isVariantNode=isVariantNode(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:g,...R}=this.scrapeMotionValuesFromProps(r,{},this);for(const P in R){const T=R[P];y[P]!==void 0&&isMotionValue(T)&&T.set(y[P])}}mount(t){this.current=t,visualElementStore.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,u)=>this.bindToMotionValue(u,r)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const u=transformProps.has(t);u&&this.onBindTransform&&this.onBindTransform();const v=r.on("change",b=>{this.latestValues[t]=b,this.props.onUpdate&&frame.preRender(this.notifyUpdate),u&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let x;window.MotionCheckAppearSync&&(x=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{v(),x&&x(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in featureDefinitions){const r=featureDefinitions[t];if(!r)continue;const{isEnabled:u,Feature:v}=r;if(!this.features[t]&&v&&u(this.props)&&(this.features[t]=new v(this)),this.features[t]){const x=this.features[t];x.isMounted?x.update():(x.mount(),x.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let u=0;u<propEventHandlers.length;u++){const v=propEventHandlers[u];this.propEventSubscriptions[v]&&(this.propEventSubscriptions[v](),delete this.propEventSubscriptions[v]);const x="on"+v,b=t[x];b&&(this.propEventSubscriptions[v]=this.on(v,b))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const u=this.values.get(t);r!==u&&(u&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let u=this.values.get(t);return u===void 0&&r!==void 0&&(u=motionValue(r===null?void 0:r,{owner:this}),this.addValue(t,u)),u}readValue(t,r){let u=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return u!=null&&(typeof u=="string"&&(isNumericalString(u)||isZeroValueString(u))?u=parseFloat(u):!findValueType(u)&&complex.test(r)&&(u=getAnimatableNone(t,r)),this.setBaseTarget(t,isMotionValue(u)?u.get():u)),isMotionValue(u)?u.get():u}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){const{initial:r}=this.props;let u;if(typeof r=="string"||typeof r=="object"){const x=resolveVariantFromProps(this.props,r,this.presenceContext?.custom);x&&(u=x[t])}if(r&&u!==void 0)return u;const v=this.getBaseTargetFromProps(this.props,t);return v!==void 0&&!isMotionValue(v)?v:this.initialValues[t]!==void 0&&u===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new SubscriptionManager),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){microtask.render(this.render)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:u}){delete r[t],delete u[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;isMotionValue(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function renderHTML(n,{style:t,vars:r},u,v){const x=n.style;let b;for(b in t)x[b]=t[b];v?.applyProjectionStyles(x,u);for(b in r)x.setProperty(b,r[b])}function getComputedStyle$1(n){return window.getComputedStyle(n)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(t,r){if(transformProps.has(r))return this.projection?.isProjecting?defaultTransformValue(r):readTransformValue(t,r);{const u=getComputedStyle$1(t),v=(isCSSVariableName(r)?u.getPropertyValue(r):u[r])||0;return typeof v=="string"?v.trim():v}}measureInstanceViewportBox(t,{transformPagePoint:r}){return measureViewportBox(t,r)}build(t,r,u){buildHTMLStyles(t,r,u.transformTemplate)}scrapeMotionValuesFromProps(t,r,u){return scrapeMotionValuesFromProps$1(t,r,u)}}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(n,t,r,u){renderHTML(n,t,void 0,u);for(const v in t.attrs)n.setAttribute(camelCaseAttributes.has(v)?v:camelToDash(v),t.attrs[v])}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(transformProps.has(r)){const u=getDefaultValueType(r);return u&&u.default||0}return r=camelCaseAttributes.has(r)?r:camelToDash(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,u){return scrapeMotionValuesFromProps(t,r,u)}build(t,r,u){buildSVGAttrs(t,r,this.isSVGTag,u.transformTemplate,u.style)}renderInstance(t,r,u,v){renderSVG(t,r,u,v)}mount(t){this.isSVGTag=isSVGTag(t.tagName),super.mount(t)}}const createDomVisualElement=(n,t)=>isSVGComponent(n)?new SVGVisualElement(t):new HTMLVisualElement(t,{allowProjection:n!==reactExports.Fragment});function resolveVariant(n,t,r){const u=n.getProps();return resolveVariantFromProps(u,t,r!==void 0?r:u.custom,n)}const isKeyframesTarget=n=>Array.isArray(n);function setMotionValue(n,t,r){n.hasValue(t)?n.getValue(t).set(r):n.addValue(t,motionValue(r))}function resolveFinalValueInKeyframes(n){return isKeyframesTarget(n)?n[n.length-1]||0:n}function setTarget(n,t){const r=resolveVariant(n,t);let{transitionEnd:u={},transition:v={},...x}=r||{};x={...x,...u};for(const b in x){const p=resolveFinalValueInKeyframes(x[b]);setMotionValue(n,b,p)}}function isWillChangeMotionValue(n){return!!(isMotionValue(n)&&n.add)}function addValueToWillChange(n,t){const r=n.getValue("willChange");if(isWillChangeMotionValue(r))return r.add(t);if(!r&&MotionGlobalConfig.WillChange){const u=new MotionGlobalConfig.WillChange("auto");n.addValue("willChange",u),u.add(t)}}function getOptimisedAppearId(n){return n.props[optimizedAppearDataAttribute]}const isNotNull=n=>n!==null;function getFinalKeyframe(n,{repeat:t,repeatType:r="loop"},u){const v=n.filter(isNotNull),x=t&&r!=="loop"&&t%2===1?0:v.length-1;return v[x]}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(n,{keyframes:t})=>t.length>2?keyframesTransition:transformProps.has(n)?n.startsWith("scale")?criticallyDampedSpring(t[1]):underDampedSpring:ease;function isTransitionDefined({when:n,delay:t,delayChildren:r,staggerChildren:u,staggerDirection:v,repeat:x,repeatType:b,repeatDelay:p,from:y,elapsed:k,...g}){return!!Object.keys(g).length}const animateMotionValue=(n,t,r,u={},v,x)=>b=>{const p=getValueTransition(u,n)||{},y=p.delay||u.delay||0;let{elapsed:k=0}=u;k=k-secondsToMilliseconds(y);const g={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...p,delay:-k,onUpdate:P=>{t.set(P),p.onUpdate&&p.onUpdate(P)},onComplete:()=>{b(),p.onComplete&&p.onComplete()},name:n,motionValue:t,element:x?void 0:v};isTransitionDefined(p)||Object.assign(g,getDefaultTransition(n,g)),g.duration&&(g.duration=secondsToMilliseconds(g.duration)),g.repeatDelay&&(g.repeatDelay=secondsToMilliseconds(g.repeatDelay)),g.from!==void 0&&(g.keyframes[0]=g.from);let R=!1;if((g.type===!1||g.duration===0&&!g.repeatDelay)&&(makeAnimationInstant(g),g.delay===0&&(R=!0)),(MotionGlobalConfig.instantAnimations||MotionGlobalConfig.skipAnimations)&&(R=!0,makeAnimationInstant(g),g.delay=0),g.allowFlatten=!p.type&&!p.ease,R&&!x&&t.get()!==void 0){const P=getFinalKeyframe(g.keyframes,p);if(P!==void 0){frame.update(()=>{g.onUpdate(P),g.onComplete()});return}}return p.isSync?new JSAnimation(g):new AsyncMotionValueAnimation(g)};function shouldBlockAnimation({protectedKeys:n,needsAnimating:t},r){const u=n.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,u}function animateTarget(n,t,{delay:r=0,transitionOverride:u,type:v}={}){let{transition:x=n.getDefaultTransition(),transitionEnd:b,...p}=t;u&&(x=u);const y=[],k=v&&n.animationState&&n.animationState.getState()[v];for(const g in p){const R=n.getValue(g,n.latestValues[g]??null),P=p[g];if(P===void 0||k&&shouldBlockAnimation(k,g))continue;const T={delay:r,...getValueTransition(x||{},g)},C=R.get();if(C!==void 0&&!R.isAnimating&&!Array.isArray(P)&&P===C&&!T.velocity)continue;let a=!1;if(window.MotionHandoffAnimation){const c=getOptimisedAppearId(n);if(c){const w=window.MotionHandoffAnimation(c,g,frame);w!==null&&(T.startTime=w,a=!0)}}addValueToWillChange(n,g),R.start(animateMotionValue(g,R,P,n.shouldReduceMotion&&positionalKeys.has(g)?{type:!1}:T,n,a));const s=R.animation;s&&y.push(s)}return b&&Promise.all(y).then(()=>{frame.update(()=>{b&&setTarget(n,b)})}),y}function calcChildStagger(n,t,r,u=0,v=1){const x=Array.from(n).sort((k,g)=>k.sortNodePosition(g)).indexOf(t),b=n.size,p=(b-1)*u;return typeof r=="function"?r(x,b):v===1?x*u:p-x*u}function animateVariant(n,t,r={}){const u=resolveVariant(n,t,r.type==="exit"?n.presenceContext?.custom:void 0);let{transition:v=n.getDefaultTransition()||{}}=u||{};r.transitionOverride&&(v=r.transitionOverride);const x=u?()=>Promise.all(animateTarget(n,u,r)):()=>Promise.resolve(),b=n.variantChildren&&n.variantChildren.size?(y=0)=>{const{delayChildren:k=0,staggerChildren:g,staggerDirection:R}=v;return animateChildren(n,t,y,k,g,R,r)}:()=>Promise.resolve(),{when:p}=v;if(p){const[y,k]=p==="beforeChildren"?[x,b]:[b,x];return y().then(()=>k())}else return Promise.all([x(),b(r.delay)])}function animateChildren(n,t,r=0,u=0,v=0,x=1,b){const p=[];for(const y of n.variantChildren)y.notify("AnimationStart",t),p.push(animateVariant(y,t,{...b,delay:r+(typeof u=="function"?0:u)+calcChildStagger(n.variantChildren,y,u,v,x)}).then(()=>y.notify("AnimationComplete",t)));return Promise.all(p)}function animateVisualElement(n,t,r={}){n.notify("AnimationStart",t);let u;if(Array.isArray(t)){const v=t.map(x=>animateVariant(n,x,r));u=Promise.all(v)}else if(typeof t=="string")u=animateVariant(n,t,r);else{const v=typeof t=="function"?resolveVariant(n,t,r.custom):t;u=Promise.all(animateTarget(n,v,r))}return u.then(()=>{n.notify("AnimationComplete",t)})}function shallowCompare(n,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==n.length)return!1;for(let u=0;u<r;u++)if(t[u]!==n[u])return!1;return!0}const numVariantProps=variantProps.length;function getVariantContext(n){if(!n)return;if(!n.isControllingVariants){const r=n.parent?getVariantContext(n.parent)||{}:{};return n.props.initial!==void 0&&(r.initial=n.props.initial),r}const t={};for(let r=0;r<numVariantProps;r++){const u=variantProps[r],v=n.props[u];(isVariantLabel(v)||v===!1)&&(t[u]=v)}return t}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(n){return t=>Promise.all(t.map(({animation:r,options:u})=>animateVisualElement(n,r,u)))}function createAnimationState(n){let t=animateList(n),r=createState(),u=!0;const v=y=>(k,g)=>{const R=resolveVariant(n,g,y==="exit"?n.presenceContext?.custom:void 0);if(R){const{transition:P,transitionEnd:T,...C}=R;k={...k,...C,...T}}return k};function x(y){t=y(n)}function b(y){const{props:k}=n,g=getVariantContext(n.parent)||{},R=[],P=new Set;let T={},C=1/0;for(let s=0;s<numAnimationTypes;s++){const c=reversePriorityOrder[s],w=r[c],_=k[c]!==void 0?k[c]:g[c],M=isVariantLabel(_),l=c===y?w.isActive:null;l===!1&&(C=s);let h=_===g[c]&&_!==k[c]&&M;if(h&&u&&n.manuallyAnimateOnMount&&(h=!1),w.protectedKeys={...T},!w.isActive&&l===null||!_&&!w.prevProp||isAnimationControls(_)||typeof _=="boolean")continue;const S=checkVariantsDidChange(w.prevProp,_);let E=S||c===y&&w.isActive&&!h&&M||s>C&&M,F=!1;const D=Array.isArray(_)?_:[_];let L=D.reduce(v(c),{});l===!1&&(L={});const{prevResolvedValues:V={}}=w,O={...V,...L},W=U=>{E=!0,P.has(U)&&(F=!0,P.delete(U)),w.needsAnimating[U]=!0;const B=n.getValue(U);B&&(B.liveStyle=!1)};for(const U in O){const B=L[U],Y=V[U];if(T.hasOwnProperty(U))continue;let X=!1;isKeyframesTarget(B)&&isKeyframesTarget(Y)?X=!shallowCompare(B,Y):X=B!==Y,X?B!=null?W(U):P.add(U):B!==void 0&&P.has(U)?W(U):w.protectedKeys[U]=!0}w.prevProp=_,w.prevResolvedValues=L,w.isActive&&(T={...T,...L}),u&&n.blockInitialAnimation&&(E=!1);const H=h&&S;E&&(!H||F)&&R.push(...D.map(U=>{const B={type:c};if(typeof U=="string"&&u&&!H&&n.manuallyAnimateOnMount&&n.parent){const{parent:Y}=n,X=resolveVariant(Y,U);if(Y.enteringChildren&&X){const{delayChildren:N}=X.transition||{};B.delay=calcChildStagger(Y.enteringChildren,n,N)}}return{animation:U,options:B}}))}if(P.size){const s={};if(typeof k.initial!="boolean"){const c=resolveVariant(n,Array.isArray(k.initial)?k.initial[0]:k.initial);c&&c.transition&&(s.transition=c.transition)}P.forEach(c=>{const w=n.getBaseTarget(c),_=n.getValue(c);_&&(_.liveStyle=!0),s[c]=w??null}),R.push({animation:s})}let a=!!R.length;return u&&(k.initial===!1||k.initial===k.animate)&&!n.manuallyAnimateOnMount&&(a=!1),u=!1,a?t(R):Promise.resolve()}function p(y,k){if(r[y].isActive===k)return Promise.resolve();n.variantChildren?.forEach(R=>R.animationState?.setActive(y,k)),r[y].isActive=k;const g=b(y);for(const R in r)r[R].protectedKeys={};return g}return{animateChanges:b,setActive:p,setAnimateFunction:x,getState:()=>r,reset:()=>{r=createState(),u=!0}}}function checkVariantsDidChange(n,t){return typeof t=="string"?t!==n:Array.isArray(t)?!shallowCompare(t,n):!1}function createTypeState(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor(t){this.isMounted=!1,this.node=t}update(){}}class AnimationFeature extends Feature{constructor(t){super(t),t.animationState||(t.animationState=createAnimationState(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();isAnimationControls(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:u}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===u)return;const v=this.node.animationState.setActive("exit",!t);r&&!t&&v.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function addDomEvent(n,t,r,u={passive:!0}){return n.addEventListener(t,r,u),()=>n.removeEventListener(t,r)}function extractEventInfo(n){return{point:{x:n.pageX,y:n.pageY}}}const addPointerInfo=n=>t=>isPrimaryPointer(t)&&n(t,extractEventInfo(t));function addPointerEvent(n,t,r,u){return addDomEvent(n,t,addPointerInfo(r),u)}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(n){return n.max-n.min}function isNear(n,t,r){return Math.abs(n-t)<=r}function calcAxisDelta(n,t,r,u=.5){n.origin=u,n.originPoint=mixNumber$1(t.min,t.max,n.origin),n.scale=calcLength(r)/calcLength(t),n.translate=mixNumber$1(r.min,r.max,n.origin)-n.originPoint,(n.scale>=SCALE_MIN&&n.scale<=SCALE_MAX||isNaN(n.scale))&&(n.scale=1),(n.translate>=TRANSLATE_MIN&&n.translate<=TRANSLATE_MAX||isNaN(n.translate))&&(n.translate=0)}function calcBoxDelta(n,t,r,u){calcAxisDelta(n.x,t.x,r.x,u?u.originX:void 0),calcAxisDelta(n.y,t.y,r.y,u?u.originY:void 0)}function calcRelativeAxis(n,t,r){n.min=r.min+t.min,n.max=n.min+calcLength(t)}function calcRelativeBox(n,t,r){calcRelativeAxis(n.x,t.x,r.x),calcRelativeAxis(n.y,t.y,r.y)}function calcRelativeAxisPosition(n,t,r){n.min=t.min-r.min,n.max=n.min+calcLength(t)}function calcRelativePosition(n,t,r){calcRelativeAxisPosition(n.x,t.x,r.x),calcRelativeAxisPosition(n.y,t.y,r.y)}function eachAxis(n){return[n("x"),n("y")]}const getContextWindow=({current:n})=>n?n.ownerDocument.defaultView:null,distance=(n,t)=>Math.abs(n-t);function distance2D(n,t){const r=distance(n.x,t.x),u=distance(n.y,t.y);return Math.sqrt(r**2+u**2)}class PanSession{constructor(t,r,{transformPagePoint:u,contextWindow:v=window,dragSnapToOrigin:x=!1,distanceThreshold:b=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const P=getPanInfo(this.lastMoveEventInfo,this.history),T=this.startEvent!==null,C=distance2D(P.offset,{x:0,y:0})>=this.distanceThreshold;if(!T&&!C)return;const{point:a}=P,{timestamp:s}=frameData;this.history.push({...a,timestamp:s});const{onStart:c,onMove:w}=this.handlers;T||(c&&c(this.lastMoveEvent,P),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,P)},this.handlePointerMove=(P,T)=>{this.lastMoveEvent=P,this.lastMoveEventInfo=transformPoint(T,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(P,T)=>{this.end();const{onEnd:C,onSessionEnd:a,resumeAnimation:s}=this.handlers;if(this.dragSnapToOrigin&&s&&s(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const c=getPanInfo(P.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(T,this.transformPagePoint),this.history);this.startEvent&&C&&C(P,c),a&&a(P,c)},!isPrimaryPointer(t))return;this.dragSnapToOrigin=x,this.handlers=r,this.transformPagePoint=u,this.distanceThreshold=b,this.contextWindow=v||window;const p=extractEventInfo(t),y=transformPoint(p,this.transformPagePoint),{point:k}=y,{timestamp:g}=frameData;this.history=[{...k,timestamp:g}];const{onSessionStart:R}=r;R&&R(t,getPanInfo(y,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(n,t){return t?{point:t(n.point)}:n}function subtractPoint(n,t){return{x:n.x-t.x,y:n.y-t.y}}function getPanInfo({point:n},t){return{point:n,delta:subtractPoint(n,lastDevicePoint(t)),offset:subtractPoint(n,startDevicePoint(t)),velocity:getVelocity(t,.1)}}function startDevicePoint(n){return n[0]}function lastDevicePoint(n){return n[n.length-1]}function getVelocity(n,t){if(n.length<2)return{x:0,y:0};let r=n.length-1,u=null;const v=lastDevicePoint(n);for(;r>=0&&(u=n[r],!(v.timestamp-u.timestamp>secondsToMilliseconds(t)));)r--;if(!u)return{x:0,y:0};const x=millisecondsToSeconds(v.timestamp-u.timestamp);if(x===0)return{x:0,y:0};const b={x:(v.x-u.x)/x,y:(v.y-u.y)/x};return b.x===1/0&&(b.x=0),b.y===1/0&&(b.y=0),b}function applyConstraints(n,{min:t,max:r},u){return t!==void 0&&n<t?n=u?mixNumber$1(t,n,u.min):Math.max(n,t):r!==void 0&&n>r&&(n=u?mixNumber$1(r,n,u.max):Math.min(n,r)),n}function calcRelativeAxisConstraints(n,t,r){return{min:t!==void 0?n.min+t:void 0,max:r!==void 0?n.max+r-(n.max-n.min):void 0}}function calcRelativeConstraints(n,{top:t,left:r,bottom:u,right:v}){return{x:calcRelativeAxisConstraints(n.x,r,v),y:calcRelativeAxisConstraints(n.y,t,u)}}function calcViewportAxisConstraints(n,t){let r=t.min-n.min,u=t.max-n.max;return t.max-t.min<n.max-n.min&&([r,u]=[u,r]),{min:r,max:u}}function calcViewportConstraints(n,t){return{x:calcViewportAxisConstraints(n.x,t.x),y:calcViewportAxisConstraints(n.y,t.y)}}function calcOrigin(n,t){let r=.5;const u=calcLength(n),v=calcLength(t);return v>u?r=progress(t.min,t.max-u,n.min):u>v&&(r=progress(n.min,n.max-v,t.min)),clamp(0,1,r)}function rebaseAxisConstraints(n,t){const r={};return t.min!==void 0&&(r.min=t.min-n.min),t.max!==void 0&&(r.max=t.max-n.min),r}const defaultElastic=.35;function resolveDragElastic(n=defaultElastic){return n===!1?n=0:n===!0&&(n=defaultElastic),{x:resolveAxisElastic(n,"left","right"),y:resolveAxisElastic(n,"top","bottom")}}function resolveAxisElastic(n,t,r){return{min:resolvePointElastic(n,t),max:resolvePointElastic(n,r)}}function resolvePointElastic(n,t){return typeof n=="number"?n:n[t]||0}const elementDragControls=new WeakMap;class VisualElementDragControls{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:u}={}){const{presenceContext:v}=this.visualElement;if(v&&v.isPresent===!1)return;const x=R=>{const{dragSnapToOrigin:P}=this.getProps();P?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(extractEventInfo(R).point)},b=(R,P)=>{const{drag:T,dragPropagation:C,onDragStart:a}=this.getProps();if(T&&!C&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(T),!this.openDragLock))return;this.latestPointerEvent=R,this.latestPanInfo=P,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(c=>{let w=this.getAxisMotionValue(c).get()||0;if(percent.test(w)){const{projection:_}=this.visualElement;if(_&&_.layout){const M=_.layout.layoutBox[c];M&&(w=calcLength(M)*(parseFloat(w)/100))}}this.originPoint[c]=w}),a&&frame.postRender(()=>a(R,P)),addValueToWillChange(this.visualElement,"transform");const{animationState:s}=this.visualElement;s&&s.setActive("whileDrag",!0)},p=(R,P)=>{this.latestPointerEvent=R,this.latestPanInfo=P;const{dragPropagation:T,dragDirectionLock:C,onDirectionLock:a,onDrag:s}=this.getProps();if(!T&&!this.openDragLock)return;const{offset:c}=P;if(C&&this.currentDirection===null){this.currentDirection=getCurrentDirection(c),this.currentDirection!==null&&a&&a(this.currentDirection);return}this.updateAxis("x",P.point,c),this.updateAxis("y",P.point,c),this.visualElement.render(),s&&s(R,P)},y=(R,P)=>{this.latestPointerEvent=R,this.latestPanInfo=P,this.stop(R,P),this.latestPointerEvent=null,this.latestPanInfo=null},k=()=>eachAxis(R=>this.getAnimationState(R)==="paused"&&this.getAxisMotionValue(R).animation?.play()),{dragSnapToOrigin:g}=this.getProps();this.panSession=new PanSession(t,{onSessionStart:x,onStart:b,onMove:p,onSessionEnd:y,resumeAnimation:k},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:g,distanceThreshold:u,contextWindow:getContextWindow(this.visualElement)})}stop(t,r){const u=t||this.latestPointerEvent,v=r||this.latestPanInfo,x=this.isDragging;if(this.cancel(),!x||!v||!u)return;const{velocity:b}=v;this.startAnimation(b);const{onDragEnd:p}=this.getProps();p&&frame.postRender(()=>p(u,v))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:u}=this.getProps();!u&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,u){const{drag:v}=this.getProps();if(!u||!shouldDrag(t,v,this.currentDirection))return;const x=this.getAxisMotionValue(t);let b=this.originPoint[t]+u[t];this.constraints&&this.constraints[t]&&(b=applyConstraints(b,this.constraints[t],this.elastic[t])),x.set(b)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),u=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,v=this.constraints;t&&isRefObject(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&u?this.constraints=calcRelativeConstraints(u.layoutBox,t):this.constraints=!1,this.elastic=resolveDragElastic(r),v!==this.constraints&&u&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(x=>{this.constraints!==!1&&this.getAxisMotionValue(x)&&(this.constraints[x]=rebaseAxisConstraints(u.layoutBox[x],this.constraints[x]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!isRefObject(t))return!1;const u=t.current,{projection:v}=this.visualElement;if(!v||!v.layout)return!1;const x=measurePageBox(u,v.root,this.visualElement.getTransformPagePoint());let b=calcViewportConstraints(v.layout.layoutBox,x);if(r){const p=r(convertBoxToBoundingBox(b));this.hasMutatedConstraints=!!p,p&&(b=convertBoundingBoxToBox(p))}return b}startAnimation(t){const{drag:r,dragMomentum:u,dragElastic:v,dragTransition:x,dragSnapToOrigin:b,onDragTransitionEnd:p}=this.getProps(),y=this.constraints||{},k=eachAxis(g=>{if(!shouldDrag(g,r,this.currentDirection))return;let R=y&&y[g]||{};b&&(R={min:0,max:0});const P=v?200:1e6,T=v?40:1e7,C={type:"inertia",velocity:u?t[g]:0,bounceStiffness:P,bounceDamping:T,timeConstant:750,restDelta:1,restSpeed:10,...x,...R};return this.startAxisValueAnimation(g,C)});return Promise.all(k).then(p)}startAxisValueAnimation(t,r){const u=this.getAxisMotionValue(t);return addValueToWillChange(this.visualElement,t),u.start(animateMotionValue(t,u,0,r,this.visualElement,!1))}stopAnimation(){eachAxis(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){eachAxis(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,u=this.visualElement.getProps(),v=u[r];return v||this.visualElement.getValue(t,(u.initial?u.initial[t]:void 0)||0)}snapToCursor(t){eachAxis(r=>{const{drag:u}=this.getProps();if(!shouldDrag(r,u,this.currentDirection))return;const{projection:v}=this.visualElement,x=this.getAxisMotionValue(r);if(v&&v.layout){const{min:b,max:p}=v.layout.layoutBox[r];x.set(t[r]-mixNumber$1(b,p,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:u}=this.visualElement;if(!isRefObject(r)||!u||!this.constraints)return;this.stopAnimation();const v={x:0,y:0};eachAxis(b=>{const p=this.getAxisMotionValue(b);if(p&&this.constraints!==!1){const y=p.get();v[b]=calcOrigin({min:y,max:y},this.constraints[b])}});const{transformTemplate:x}=this.visualElement.getProps();this.visualElement.current.style.transform=x?x({},""):"none",u.root&&u.root.updateScroll(),u.updateLayout(),this.resolveConstraints(),eachAxis(b=>{if(!shouldDrag(b,t,null))return;const p=this.getAxisMotionValue(b),{min:y,max:k}=this.constraints[b];p.set(mixNumber$1(y,k,v[b]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const t=this.visualElement.current,r=addPointerEvent(t,"pointerdown",y=>{const{drag:k,dragListener:g=!0}=this.getProps();k&&g&&this.start(y)}),u=()=>{const{dragConstraints:y}=this.getProps();isRefObject(y)&&y.current&&(this.constraints=this.resolveRefConstraints())},{projection:v}=this.visualElement,x=v.addEventListener("measure",u);v&&!v.layout&&(v.root&&v.root.updateScroll(),v.updateLayout()),frame.read(u);const b=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),p=v.addEventListener("didUpdate",(({delta:y,hasLayoutChanged:k})=>{this.isDragging&&k&&(eachAxis(g=>{const R=this.getAxisMotionValue(g);R&&(this.originPoint[g]+=y[g].translate,R.set(R.get()+y[g].translate))}),this.visualElement.render())}));return()=>{b(),r(),x(),p&&p()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:u=!1,dragPropagation:v=!1,dragConstraints:x=!1,dragElastic:b=defaultElastic,dragMomentum:p=!0}=t;return{...t,drag:r,dragDirectionLock:u,dragPropagation:v,dragConstraints:x,dragElastic:b,dragMomentum:p}}}function shouldDrag(n,t,r){return(t===!0||t===n)&&(r===null||r===n)}function getCurrentDirection(n,t=10){let r=null;return Math.abs(n.y)>t?r="y":Math.abs(n.x)>t&&(r="x"),r}class DragGesture extends Feature{constructor(t){super(t),this.removeGroupControls=noop,this.removeListeners=noop,this.controls=new VisualElementDragControls(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=n=>(t,r)=>{n&&frame.postRender(()=>n(t,r))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop}onPointerDown(t){this.session=new PanSession(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:u,onPanEnd:v}=this.node.getProps();return{onSessionStart:asyncHandler(t),onStart:asyncHandler(r),onMove:u,onEnd:(x,b)=>{delete this.session,v&&frame.postRender(()=>v(x,b))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(n,t){return t.max===t.min?0:n/(t.max-t.min)*100}const correctBorderRadius={correct:(n,t)=>{if(!t.target)return n;if(typeof n=="string")if(px.test(n))n=parseFloat(n);else return n;const r=pixelsToPercent(n,t.target.x),u=pixelsToPercent(n,t.target.y);return`${r}% ${u}%`}},correctBoxShadow={correct:(n,{treeScale:t,projectionDelta:r})=>{const u=n,v=complex.parse(n);if(v.length>5)return u;const x=complex.createTransformer(n),b=typeof v[0]!="number"?1:0,p=r.x.scale*t.x,y=r.y.scale*t.y;v[0+b]/=p,v[1+b]/=y;const k=mixNumber$1(p,y,.5);return typeof v[2+b]=="number"&&(v[2+b]/=k),typeof v[3+b]=="number"&&(v[3+b]/=k),x(v)}};let hasTakenAnySnapshot=!1;class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:u,layoutId:v}=this.props,{projection:x}=t;addScaleCorrector(defaultScaleCorrectors),x&&(r.group&&r.group.add(x),u&&u.register&&v&&u.register(x),hasTakenAnySnapshot&&x.root.didUpdate(),x.addEventListener("animationComplete",()=>{this.safeToRemove()}),x.setOptions({...x.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:u,drag:v,isPresent:x}=this.props,{projection:b}=u;return b&&(b.isPresent=x,hasTakenAnySnapshot=!0,v||t.layoutDependency!==r||r===void 0||t.isPresent!==x?b.willUpdate():this.safeToRemove(),t.isPresent!==x&&(x?b.promote():b.relegate()||frame.postRender(()=>{const p=b.getStack();(!p||!p.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),microtask.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:u}=this.props,{projection:v}=t;hasTakenAnySnapshot=!0,v&&(v.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(v),u&&u.deregister&&u.deregister(v))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function MeasureLayout(n){const[t,r]=usePresence(),u=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports$1.jsx(MeasureLayoutWithContext,{...n,layoutGroup:u,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:t,safeToRemove:r})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function animateSingleValue(n,t,r){const u=isMotionValue(n)?n:motionValue(n);return u.start(animateMotionValue("",u,t,r)),u.animation}const compareByDepth=(n,t)=>n.depth-t.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(t){addUniqueItem(this.children,t),this.isDirty=!0}remove(t){removeItem(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(t)}}function delay(n,t){const r=time.now(),u=({timestamp:v})=>{const x=v-r;x>=t&&(cancelFrame(u),n(x-t))};return frame.setup(u,!0),()=>cancelFrame(u)}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=n=>typeof n=="string"?parseFloat(n):n,isPx=n=>typeof n=="number"||px.test(n);function mixValues(n,t,r,u,v,x){v?(n.opacity=mixNumber$1(0,r.opacity??1,easeCrossfadeIn(u)),n.opacityExit=mixNumber$1(t.opacity??1,0,easeCrossfadeOut(u))):x&&(n.opacity=mixNumber$1(t.opacity??1,r.opacity??1,u));for(let b=0;b<numBorders;b++){const p=`border${borders[b]}Radius`;let y=getRadius(t,p),k=getRadius(r,p);if(y===void 0&&k===void 0)continue;y||(y=0),k||(k=0),y===0||k===0||isPx(y)===isPx(k)?(n[p]=Math.max(mixNumber$1(asNumber(y),asNumber(k),u),0),(percent.test(k)||percent.test(y))&&(n[p]+="%")):n[p]=k}(t.rotate||r.rotate)&&(n.rotate=mixNumber$1(t.rotate||0,r.rotate||0,u))}function getRadius(n,t){return n[t]!==void 0?n[t]:n.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop);function compress(n,t,r){return u=>u<n?0:u>t?1:r(progress(n,t,u))}function copyAxisInto(n,t){n.min=t.min,n.max=t.max}function copyBoxInto(n,t){copyAxisInto(n.x,t.x),copyAxisInto(n.y,t.y)}function copyAxisDeltaInto(n,t){n.translate=t.translate,n.scale=t.scale,n.originPoint=t.originPoint,n.origin=t.origin}function removePointDelta(n,t,r,u,v){return n-=t,n=scalePoint(n,1/r,u),v!==void 0&&(n=scalePoint(n,1/v,u)),n}function removeAxisDelta(n,t=0,r=1,u=.5,v,x=n,b=n){if(percent.test(t)&&(t=parseFloat(t),t=mixNumber$1(b.min,b.max,t/100)-b.min),typeof t!="number")return;let p=mixNumber$1(x.min,x.max,u);n===x&&(p-=t),n.min=removePointDelta(n.min,t,r,p,v),n.max=removePointDelta(n.max,t,r,p,v)}function removeAxisTransforms(n,t,[r,u,v],x,b){removeAxisDelta(n,t[r],t[u],t[v],t.scale,x,b)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(n,t,r,u){removeAxisTransforms(n.x,t,xKeys,r?r.x:void 0,u?u.x:void 0),removeAxisTransforms(n.y,t,yKeys,r?r.y:void 0,u?u.y:void 0)}function isAxisDeltaZero(n){return n.translate===0&&n.scale===1}function isDeltaZero(n){return isAxisDeltaZero(n.x)&&isAxisDeltaZero(n.y)}function axisEquals(n,t){return n.min===t.min&&n.max===t.max}function boxEquals(n,t){return axisEquals(n.x,t.x)&&axisEquals(n.y,t.y)}function axisEqualsRounded(n,t){return Math.round(n.min)===Math.round(t.min)&&Math.round(n.max)===Math.round(t.max)}function boxEqualsRounded(n,t){return axisEqualsRounded(n.x,t.x)&&axisEqualsRounded(n.y,t.y)}function aspectRatio(n){return calcLength(n.x)/calcLength(n.y)}function axisDeltaEquals(n,t){return n.translate===t.translate&&n.scale===t.scale&&n.originPoint===t.originPoint}class NodeStack{constructor(){this.members=[]}add(t){addUniqueItem(this.members,t),t.scheduleRender()}remove(t){if(removeItem(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(v=>t===v);if(r===0)return!1;let u;for(let v=r;v>=0;v--){const x=this.members[v];if(x.isPresent!==!1){u=x;break}}return u?(this.promote(u),!0):!1}promote(t,r){const u=this.lead;if(t!==u&&(this.prevLead=u,this.lead=t,t.show(),u)){u.instance&&u.scheduleRender(),t.scheduleRender(),t.resumeFrom=u,r&&(t.resumeFrom.preserveOpacity=!0),u.snapshot&&(t.snapshot=u.snapshot,t.snapshot.latestValues=u.animationValues||u.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:v}=t.options;v===!1&&u.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:u}=t;r.onExitComplete&&r.onExitComplete(),u&&u.options.onExitComplete&&u.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(n,t,r){let u="";const v=n.x.translate/t.x,x=n.y.translate/t.y,b=r?.z||0;if((v||x||b)&&(u=`translate3d(${v}px, ${x}px, ${b}px) `),(t.x!==1||t.y!==1)&&(u+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:k,rotate:g,rotateX:R,rotateY:P,skewX:T,skewY:C}=r;k&&(u=`perspective(${k}px) ${u}`),g&&(u+=`rotate(${g}deg) `),R&&(u+=`rotateX(${R}deg) `),P&&(u+=`rotateY(${P}deg) `),T&&(u+=`skewX(${T}deg) `),C&&(u+=`skewY(${C}deg) `)}const p=n.x.scale*t.x,y=n.y.scale*t.y;return(p!==1||y!==1)&&(u+=`scale(${p}, ${y})`),u||"none"}const transformAxes=["","X","Y","Z"],animationTarget=1e3;let id=0;function resetDistortingTransform(n,t,r,u){const{latestValues:v}=t;v[n]&&(r[n]=v[n],t.setStaticValue(n,0),u&&(u[n]=0))}function cancelTreeOptimisedTransformAnimations(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:t}=n.options;if(!t)return;const r=getOptimisedAppearId(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:v,layoutId:x}=n.options;window.MotionCancelOptimisedAnimation(r,"transform",frame,!(v||x))}const{parent:u}=n;u&&!u.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(u)}function createProjectionNode({attachResizeListener:n,defaultParent:t,measureScroll:r,checkIsScrollRoot:u,resetTransform:v}){return class{constructor(b={},p=t?.()){this.id=id++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=b,this.root=p?p.root||p:this,this.path=p?[...p.path,p]:[],this.parent=p,this.depth=p?p.depth+1:0;for(let y=0;y<this.path.length;y++)this.path[y].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(b,p){return this.eventHandlers.has(b)||this.eventHandlers.set(b,new SubscriptionManager),this.eventHandlers.get(b).add(p)}notifyListeners(b,...p){const y=this.eventHandlers.get(b);y&&y.notify(...p)}hasListeners(b){return this.eventHandlers.has(b)}mount(b){if(this.instance)return;this.isSVG=isSVGElement(b)&&!isSVGSVGElement(b),this.instance=b;const{layoutId:p,layout:y,visualElement:k}=this.options;if(k&&!k.current&&k.mount(b),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(y||p)&&(this.isLayoutDirty=!0),n){let g,R=0;const P=()=>this.root.updateBlockedByResize=!1;frame.read(()=>{R=window.innerWidth}),n(b,()=>{const T=window.innerWidth;T!==R&&(R=T,this.root.updateBlockedByResize=!0,g&&g(),g=delay(P,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation)))})}p&&this.root.registerSharedNode(p,this),this.options.animate!==!1&&k&&(p||y)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:R,hasRelativeLayoutChanged:P,layout:T})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const C=this.options.transition||k.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:a,onLayoutAnimationComplete:s}=k.getProps(),c=!this.targetLayout||!boxEqualsRounded(this.targetLayout,T),w=!R&&P;if(this.options.layoutRoot||this.resumeFrom||w||R&&(c||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const _={...getValueTransition(C,"layout"),onPlay:a,onComplete:s};(k.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_),this.setAnimationOrigin(g,w)}else R||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=T})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const b=this.getStack();b&&b.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:b}=this.options;return b&&b.getProps().transformTemplate}willUpdate(b=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let g=0;g<this.path.length;g++){const R=this.path[g];R.shouldResetTransform=!0,R.updateScroll("snapshot"),R.options.layoutRoot&&R.willUpdate(!1)}const{layoutId:p,layout:y}=this.options;if(p===void 0&&!y)return;const k=this.getTransformTemplate();this.prevTransformTemplateValue=k?k(this.latestValues,""):void 0,this.updateSnapshot(),b&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(clearIsLayoutDirty);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate)):this.nodes.forEach(clearIsLayoutDirty),this.clearAllSnapshots();const p=time.now();frameData.delta=clamp(0,1e3/60,p-frameData.timestamp),frameData.timestamp=p,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!calcLength(this.snapshot.measuredBox.x)&&!calcLength(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let y=0;y<this.path.length;y++)this.path[y].updateScroll();const b=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:p}=this.options;p&&p.notify("LayoutMeasure",this.layout.layoutBox,b?b.layoutBox:void 0)}updateScroll(b="measure"){let p=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===b&&(p=!1),p&&this.instance){const y=u(this.instance);this.scroll={animationId:this.root.animationId,phase:b,isRoot:y,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:y}}}resetTransform(){if(!v)return;const b=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,p=this.projectionDelta&&!isDeltaZero(this.projectionDelta),y=this.getTransformTemplate(),k=y?y(this.latestValues,""):void 0,g=k!==this.prevTransformTemplateValue;b&&this.instance&&(p||hasTransform(this.latestValues)||g)&&(v(this.instance,k),this.shouldResetTransform=!1,this.scheduleRender())}measure(b=!0){const p=this.measurePageBox();let y=this.removeElementScroll(p);return b&&(y=this.removeTransform(y)),roundBox(y),{animationId:this.root.animationId,measuredBox:p,layoutBox:y,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:b}=this.options;if(!b)return createBox();const p=b.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(checkNodeWasScrollRoot))){const{scroll:k}=this.root;k&&(translateAxis(p.x,k.offset.x),translateAxis(p.y,k.offset.y))}return p}removeElementScroll(b){const p=createBox();if(copyBoxInto(p,b),this.scroll?.wasRoot)return p;for(let y=0;y<this.path.length;y++){const k=this.path[y],{scroll:g,options:R}=k;k!==this.root&&g&&R.layoutScroll&&(g.wasRoot&&copyBoxInto(p,b),translateAxis(p.x,g.offset.x),translateAxis(p.y,g.offset.y))}return p}applyTransform(b,p=!1){const y=createBox();copyBoxInto(y,b);for(let k=0;k<this.path.length;k++){const g=this.path[k];!p&&g.options.layoutScroll&&g.scroll&&g!==g.root&&transformBox(y,{x:-g.scroll.offset.x,y:-g.scroll.offset.y}),hasTransform(g.latestValues)&&transformBox(y,g.latestValues)}return hasTransform(this.latestValues)&&transformBox(y,this.latestValues),y}removeTransform(b){const p=createBox();copyBoxInto(p,b);for(let y=0;y<this.path.length;y++){const k=this.path[y];if(!k.instance||!hasTransform(k.latestValues))continue;hasScale(k.latestValues)&&k.updateSnapshot();const g=createBox(),R=k.measurePageBox();copyBoxInto(g,R),removeBoxTransforms(p,k.latestValues,k.snapshot?k.snapshot.layoutBox:void 0,g)}return hasTransform(this.latestValues)&&removeBoxTransforms(p,this.latestValues),p}setTargetDelta(b){this.targetDelta=b,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(b){this.options={...this.options,...b,crossfade:b.crossfade!==void 0?b.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(b=!1){const p=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=p.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=p.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=p.isSharedProjectionDirty);const y=!!this.resumingFrom||this!==p;if(!(b||y&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:R}=this.options;if(!(!this.layout||!(g||R))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const P=this.getClosestProjectingParent();P&&P.layout&&this.animationProgress!==1?(this.relativeParent=P,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,P.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const P=this.getClosestProjectingParent();P&&!!P.resumingFrom==!!this.resumingFrom&&!P.options.layoutScroll&&P.target&&this.animationProgress!==1?(this.relativeParent=P,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,P.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const b=this.getLead(),p=!!this.resumingFrom||this!==b;let y=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(y=!1),p&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(y=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(y=!1),y)return;const{layout:k,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(k||g))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const R=this.treeScale.x,P=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,p),b.layout&&!b.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(b.target=b.layout.layoutBox,b.targetWithTransforms=createBox());const{target:T}=b;if(!T){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,T,this.latestValues),(this.treeScale.x!==R||this.treeScale.y!==P||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",T))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(b=!0){if(this.options.visualElement?.scheduleRender(),b){const p=this.getStack();p&&p.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(b,p=!1){const y=this.snapshot,k=y?y.latestValues:{},g={...this.latestValues},R=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!p;const P=createBox(),T=y?y.source:void 0,C=this.layout?this.layout.source:void 0,a=T!==C,s=this.getStack(),c=!s||s.members.length<=1,w=!!(a&&!c&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let _;this.mixTargetDelta=M=>{const l=M/1e3;mixAxisDelta(R.x,b.x,l),mixAxisDelta(R.y,b.y,l),this.setTargetDelta(R),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(P,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,P,l),_&&boxEquals(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=createBox()),copyBoxInto(_,this.relativeTarget)),a&&(this.animationValues=g,mixValues(g,k,this.latestValues,l,w,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=l},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(b){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=motionValue(0)),this.currentAnimation=animateSingleValue(this.motionValue,[0,1e3],{...b,velocity:0,isSync:!0,onUpdate:p=>{this.mixTargetDelta(p),b.onUpdate&&b.onUpdate(p)},onStop:()=>{},onComplete:()=>{b.onComplete&&b.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const b=this.getStack();b&&b.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const b=this.getLead();let{targetWithTransforms:p,target:y,layout:k,latestValues:g}=b;if(!(!p||!y||!k)){if(this!==b&&this.layout&&k&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,k.layoutBox)){y=this.target||createBox();const R=calcLength(this.layout.layoutBox.x);y.x.min=b.target.x.min,y.x.max=y.x.min+R;const P=calcLength(this.layout.layoutBox.y);y.y.min=b.target.y.min,y.y.max=y.y.min+P}copyBoxInto(p,y),transformBox(p,g),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,p,g)}}registerSharedNode(b,p){this.sharedNodes.has(b)||this.sharedNodes.set(b,new NodeStack),this.sharedNodes.get(b).add(p);const k=p.options.initialPromotionConfig;p.promote({transition:k?k.transition:void 0,preserveFollowOpacity:k&&k.shouldPreserveFollowOpacity?k.shouldPreserveFollowOpacity(p):void 0})}isLead(){const b=this.getStack();return b?b.lead===this:!0}getLead(){const{layoutId:b}=this.options;return b?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:b}=this.options;return b?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:b}=this.options;if(b)return this.root.sharedNodes.get(b)}promote({needsReset:b,transition:p,preserveFollowOpacity:y}={}){const k=this.getStack();k&&k.promote(this,y),b&&(this.projectionDelta=void 0,this.needsReset=!0),p&&this.setOptions({transition:p})}relegate(){const b=this.getStack();return b?b.relegate(this):!1}resetSkewAndRotation(){const{visualElement:b}=this.options;if(!b)return;let p=!1;const{latestValues:y}=b;if((y.z||y.rotate||y.rotateX||y.rotateY||y.rotateZ||y.skewX||y.skewY)&&(p=!0),!p)return;const k={};y.z&&resetDistortingTransform("z",b,k,this.animationValues);for(let g=0;g<transformAxes.length;g++)resetDistortingTransform(`rotate${transformAxes[g]}`,b,k,this.animationValues),resetDistortingTransform(`skew${transformAxes[g]}`,b,k,this.animationValues);b.render();for(const g in k)b.setStaticValue(g,k[g]),this.animationValues&&(this.animationValues[g]=k[g]);b.scheduleRender()}applyProjectionStyles(b,p){if(!this.instance||this.isSVG)return;if(!this.isVisible){b.visibility="hidden";return}const y=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,b.visibility="",b.opacity="",b.pointerEvents=resolveMotionValue(p?.pointerEvents)||"",b.transform=y?y(this.latestValues,""):"none";return}const k=this.getLead();if(!this.projectionDelta||!this.layout||!k.target){this.options.layoutId&&(b.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,b.pointerEvents=resolveMotionValue(p?.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(b.transform=y?y({},""):"none",this.hasProjected=!1);return}b.visibility="";const g=k.animationValues||k.latestValues;this.applyTransformsToTarget();let R=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,g);y&&(R=y(g,R)),b.transform=R;const{x:P,y:T}=this.projectionDelta;b.transformOrigin=`${P.origin*100}% ${T.origin*100}% 0`,k.animationValues?b.opacity=k===this?g.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:g.opacityExit:b.opacity=k===this?g.opacity!==void 0?g.opacity:"":g.opacityExit!==void 0?g.opacityExit:0;for(const C in scaleCorrectors){if(g[C]===void 0)continue;const{correct:a,applyTo:s,isCSSVariable:c}=scaleCorrectors[C],w=R==="none"?g[C]:a(g[C],k);if(s){const _=s.length;for(let M=0;M<_;M++)b[s[M]]=w}else c?this.options.visualElement.renderState.vars[C]=w:b[C]=w}this.options.layoutId&&(b.pointerEvents=k===this?resolveMotionValue(p?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(b=>b.currentAnimation?.stop()),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(n){n.updateLayout()}function notifyLayoutUpdate(n){const t=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:u}=n.layout,{animationType:v}=n.options,x=t.source!==n.layout.source;v==="size"?eachAxis(g=>{const R=x?t.measuredBox[g]:t.layoutBox[g],P=calcLength(R);R.min=r[g].min,R.max=R.min+P}):shouldAnimatePositionOnly(v,t.layoutBox,r)&&eachAxis(g=>{const R=x?t.measuredBox[g]:t.layoutBox[g],P=calcLength(r[g]);R.max=R.min+P,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[g].max=n.relativeTarget[g].min+P)});const b=createDelta();calcBoxDelta(b,r,t.layoutBox);const p=createDelta();x?calcBoxDelta(p,n.applyTransform(u,!0),t.measuredBox):calcBoxDelta(p,r,t.layoutBox);const y=!isDeltaZero(b);let k=!1;if(!n.resumeFrom){const g=n.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:R,layout:P}=g;if(R&&P){const T=createBox();calcRelativePosition(T,t.layoutBox,R.layoutBox);const C=createBox();calcRelativePosition(C,r,P.layoutBox),boxEqualsRounded(T,C)||(k=!0),g.options.layoutRoot&&(n.relativeTarget=C,n.relativeTargetOrigin=T,n.relativeParent=g)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:p,layoutDelta:b,hasLayoutChanged:y,hasRelativeLayoutChanged:k})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function propagateDirtyNodes(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function cleanDirtyNodes(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function clearSnapshot(n){n.clearSnapshot()}function clearMeasurements(n){n.clearMeasurements()}function clearIsLayoutDirty(n){n.isLayoutDirty=!1}function resetTransformStyle(n){const{visualElement:t}=n.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),n.resetTransform()}function finishAnimation(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function resolveTargetDelta(n){n.resolveTargetDelta()}function calcProjection(n){n.calcProjection()}function resetSkewAndRotation(n){n.resetSkewAndRotation()}function removeLeadSnapshots(n){n.removeLeadSnapshot()}function mixAxisDelta(n,t,r){n.translate=mixNumber$1(t.translate,0,r),n.scale=mixNumber$1(t.scale,1,r),n.origin=t.origin,n.originPoint=t.originPoint}function mixAxis(n,t,r,u){n.min=mixNumber$1(t.min,r.min,u),n.max=mixNumber$1(t.max,r.max,u)}function mixBox(n,t,r,u){mixAxis(n.x,t.x,r.x,u),mixAxis(n.y,t.y,r.y,u)}function hasOpacityCrossfade(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop;function roundAxis(n){n.min=roundPoint(n.min),n.max=roundPoint(n.max)}function roundBox(n){roundAxis(n.x),roundAxis(n.y)}function shouldAnimatePositionOnly(n,t,r){return n==="position"||n==="preserve-aspect"&&!isNear(aspectRatio(t),aspectRatio(r),.2)}function checkNodeWasScrollRoot(n){return n!==n.root&&n.scroll?.wasRoot}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(n,t)=>addDomEvent(n,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const n=new DocumentProjectionNode({});n.mount(window),n.setOptions({layoutScroll:!0}),rootProjectionNode.current=n}return rootProjectionNode.current},resetTransform:(n,t)=>{n.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(n,t,r){const{props:u}=n;n.animationState&&u.whileHover&&n.animationState.setActive("whileHover",r==="Start");const v="onHover"+r,x=u[v];x&&frame.postRender(()=>x(t,extractEventInfo(t)))}class HoverGesture extends Feature{mount(){const{current:t}=this.node;t&&(this.unmount=hover(t,(r,u)=>(handleHoverEvent(this.node,u,"Start"),v=>handleHoverEvent(this.node,v,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(n,t,r){const{props:u}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&u.whileTap&&n.animationState.setActive("whileTap",r==="Start");const v="onTap"+(r==="End"?"":r),x=u[v];x&&frame.postRender(()=>x(t,extractEventInfo(t)))}class PressGesture extends Feature{mount(){const{current:t}=this.node;t&&(this.unmount=press(t,(r,u)=>(handlePressEvent(this.node,u,"Start"),(v,{success:x})=>handlePressEvent(this.node,v,x?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=n=>{const t=observerCallbacks.get(n.target);t&&t(n)},fireAllObserverCallbacks=n=>{n.forEach(fireObserverCallback)};function initIntersectionObserver({root:n,...t}){const r=n||document;observers.has(r)||observers.set(r,{});const u=observers.get(r),v=JSON.stringify(t);return u[v]||(u[v]=new IntersectionObserver(fireAllObserverCallbacks,{root:n,...t})),u[v]}function observeIntersection(n,t,r){const u=initIntersectionObserver(t);return observerCallbacks.set(n,r),u.observe(n),()=>{observerCallbacks.delete(n),u.unobserve(n)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:u,amount:v="some",once:x}=t,b={root:r?r.current:void 0,rootMargin:u,threshold:typeof v=="number"?v:thresholdNames[v]},p=y=>{const{isIntersecting:k}=y;if(this.isInView===k||(this.isInView=k,x&&!k&&this.hasEnteredView))return;k&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",k);const{onViewportEnter:g,onViewportLeave:R}=this.node.getProps(),P=k?g:R;P&&P(y)};return observeIntersection(this.node.current,b,p)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(t,r))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:n={}},{viewport:t={}}={}){return r=>n[r]!==t[r]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},featureBundle={...animations,...gestureAnimations,...drag,...layout},motion=createMotionProxy(featureBundle,createDomVisualElement);function OptimadeClient(){const[n,t]=reactExports.useState([]),[r,u]=reactExports.useState(""),[v,x]=reactExports.useState(""),[b,p]=reactExports.useState(1),[y,k]=reactExports.useState(null),[g,R]=reactExports.useState(null),[P,T]=reactExports.useState(!1),[C,a]=reactExports.useState(1),[s,c]=reactExports.useState({data_returned:0,data_available:0});reactExports.useEffect(()=>{(async()=>{try{const M=await getProvidersList(void 0,["exmpl","matcloud"]);t(M.data)}catch(M){console.error("Error fetching providers:",M)}})()},[]);const w=reactExports.useCallback(async()=>{if(r){T(!0);try{const _=await getStructures({providerUrl:r,filter:v,page:b});R(_);const M=_?.meta??{data_returned:0,data_available:0};c(M),a(Math.max(1,Math.ceil((M.data_returned??0)/20))),k(_?.data[0]||null)}catch(_){console.error("Error fetching structures:",_),k(null)}finally{T(!1)}}},[r,v,b]);return reactExports.useEffect(()=>{w()},[w]),jsxRuntimeExports$1.jsxs("div",{className:"min-h-screen flex flex-col items-center",children:[jsxRuntimeExports$1.jsx(OptimadeHeader,{}),jsxRuntimeExports$1.jsxs("div",{className:"flex flex-col items-center w-full max-w-3xl",children:[jsxRuntimeExports$1.jsx("div",{className:"mt-4",children:jsxRuntimeExports$1.jsx(DatabaseSelector,{providers:n,onQueryUrlChange:_=>{_!==r&&(u(_),p(1))}})}),jsxRuntimeExports$1.jsxs("div",{className:"pt-2",children:["Query Url:"," ",r?jsxRuntimeExports$1.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:r}):"None"]}),jsxRuntimeExports$1.jsx("div",{className:"pb-4 px-0.5 w-full",children:jsxRuntimeExports$1.jsx(ProviderInfo,{queryUrl:r})}),jsxRuntimeExports$1.jsx(AnimatePresence,{children:r&&jsxRuntimeExports$1.jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3,ease:"easeInOut"},className:"w-full p-4 border rounded bg-slate-50",children:jsxRuntimeExports$1.jsx(OptimadeFilters,{onSubmit:_=>{x(_),p(1)}})})}),r&&jsxRuntimeExports$1.jsxs("div",{className:"px-2 w-full",children:[P&&jsxRuntimeExports$1.jsx("div",{className:"flex justify-center items-center h-[800px]",children:jsxRuntimeExports$1.jsx("div",{className:"w-16 h-16 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}),jsxRuntimeExports$1.jsx("div",{className:"border-b-2 pt-8"}),!P&&!y&&v&&jsxRuntimeExports$1.jsxs("div",{className:"my-4 w-full rounded bg-yellow-100 border border-yellow-400 text-yellow-800 px-3 py-3 text-sm",children:[jsxRuntimeExports$1.jsx("strong",{className:"font-semibold",children:"Warning: "}),"No results returned for this query. The server may not be responsive Try to relax the filters, check the syntax of the query or the server may be unresponsive.",jsxRuntimeExports$1.jsxs("p",{className:"text-xs text-center pt-2",children:["Attempted Query:"," ",jsxRuntimeExports$1.jsx("a",{href:`${r}/structures?filter=${encodeURIComponent(v)}`,target:"_blank",rel:"noopener noreferrer",className:"underline text-blue-700 hover:text-blue-900 break-all",children:`${r}/structures?filter=${v}`})]})]}),!P&&g&&y&&jsxRuntimeExports$1.jsxs("div",{className:"py-2 ",children:[jsxRuntimeExports$1.jsx(ResultsDropdown,{results:g,resultsLoading:P,selectedResult:y,setSelectedResult:k}),jsxRuntimeExports$1.jsx(ResultViewer,{selectedResult:y}),jsxRuntimeExports$1.jsx(PaginationHandler,{currentPage:b,totalPages:C,resultsLoading:P,metaData:s,onPageChange:p})]})]})]})]})}function App(){return jsxRuntimeExports$1.jsx(OptimadeClient,{})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports$1.jsx(reactExports.StrictMode,{children:jsxRuntimeExports$1.jsx(App,{})}));
