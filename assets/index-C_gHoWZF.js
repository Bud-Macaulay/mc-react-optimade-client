(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const v of document.querySelectorAll('link[rel="modulepreload"]'))u(v);new MutationObserver(v=>{for(const _ of v)if(_.type==="childList")for(const b of _.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&u(b)}).observe(document,{childList:!0,subtree:!0});function r(v){const _={};return v.integrity&&(_.integrity=v.integrity),v.referrerPolicy&&(_.referrerPolicy=v.referrerPolicy),v.crossOrigin==="use-credentials"?_.credentials="include":v.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function u(v){if(v.ep)return;v.ep=!0;const _=r(v);fetch(v.href,_)}})();function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var jsxRuntime$1={exports:{}},reactJsxRuntime_production_min$1={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var n=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),b=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),k=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),M=Symbol.iterator;function P(j){return j===null||typeof j!="object"?null:(j=M&&j[M]||j["@@iterator"],typeof j=="function"?j:null)}var R={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,a={};function s(j,J,le){this.props=j,this.context=J,this.refs=a,this.updater=le||R}s.prototype.isReactComponent={},s.prototype.setState=function(j,J){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,J,"setState")},s.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function c(){}c.prototype=s.prototype;function w(j,J,le){this.props=j,this.context=J,this.refs=a,this.updater=le||R}var x=w.prototype=new c;x.constructor=w,S(x,s.prototype),x.isPureReactComponent=!0;var T=Array.isArray,l=Object.prototype.hasOwnProperty,h={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function E(j,J,le){var se,he={},pe=null,ve=null;if(J!=null)for(se in J.ref!==void 0&&(ve=J.ref),J.key!==void 0&&(pe=""+J.key),J)l.call(J,se)&&!C.hasOwnProperty(se)&&(he[se]=J[se]);var ce=arguments.length-2;if(ce===1)he.children=le;else if(1<ce){for(var me=Array(ce),Re=0;Re<ce;Re++)me[Re]=arguments[Re+2];he.children=me}if(j&&j.defaultProps)for(se in ce=j.defaultProps,ce)he[se]===void 0&&(he[se]=ce[se]);return{$$typeof:n,type:j,key:pe,ref:ve,props:he,_owner:h.current}}function D(j,J){return{$$typeof:n,type:j.type,key:J,ref:j.ref,props:j.props,_owner:j._owner}}function z(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function L(j){var J={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(le){return J[le]})}var V=/\/+/g;function O(j,J){return typeof j=="object"&&j!==null&&j.key!=null?L(""+j.key):J.toString(36)}function W(j,J,le,se,he){var pe=typeof j;(pe==="undefined"||pe==="boolean")&&(j=null);var ve=!1;if(j===null)ve=!0;else switch(pe){case"string":case"number":ve=!0;break;case"object":switch(j.$$typeof){case n:case t:ve=!0}}if(ve)return ve=j,he=he(ve),j=se===""?"."+O(ve,0):se,T(he)?(le="",j!=null&&(le=j.replace(V,"$&/")+"/"),W(he,J,le,"",function(Re){return Re})):he!=null&&(z(he)&&(he=D(he,le+(!he.key||ve&&ve.key===he.key?"":(""+he.key).replace(V,"$&/")+"/")+j)),J.push(he)),1;if(ve=0,se=se===""?".":se+":",T(j))for(var ce=0;ce<j.length;ce++){pe=j[ce];var me=se+O(pe,ce);ve+=W(pe,J,le,me,he)}else if(me=P(j),typeof me=="function")for(j=me.call(j),ce=0;!(pe=j.next()).done;)pe=pe.value,me=se+O(pe,ce++),ve+=W(pe,J,le,me,he);else if(pe==="object")throw J=String(j),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.");return ve}function H(j,J,le){if(j==null)return j;var se=[],he=0;return W(j,se,"","",function(pe){return J.call(le,pe,he++)}),se}function q(j){if(j._status===-1){var J=j._result;J=J(),J.then(function(le){(j._status===0||j._status===-1)&&(j._status=1,j._result=le)},function(le){(j._status===0||j._status===-1)&&(j._status=2,j._result=le)}),j._status===-1&&(j._status=0,j._result=J)}if(j._status===1)return j._result.default;throw j._result}var U={current:null},B={transition:null},Y={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:B,ReactCurrentOwner:h};function X(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:H,forEach:function(j,J,le){H(j,function(){J.apply(this,arguments)},le)},count:function(j){var J=0;return H(j,function(){J++}),J},toArray:function(j){return H(j,function(J){return J})||[]},only:function(j){if(!z(j))throw Error("React.Children.only expected to receive a single React element child.");return j}},react_production_min.Component=s,react_production_min.Fragment=r,react_production_min.Profiler=v,react_production_min.PureComponent=w,react_production_min.StrictMode=u,react_production_min.Suspense=y,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y,react_production_min.act=X,react_production_min.cloneElement=function(j,J,le){if(j==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+j+".");var se=S({},j.props),he=j.key,pe=j.ref,ve=j._owner;if(J!=null){if(J.ref!==void 0&&(pe=J.ref,ve=h.current),J.key!==void 0&&(he=""+J.key),j.type&&j.type.defaultProps)var ce=j.type.defaultProps;for(me in J)l.call(J,me)&&!C.hasOwnProperty(me)&&(se[me]=J[me]===void 0&&ce!==void 0?ce[me]:J[me])}var me=arguments.length-2;if(me===1)se.children=le;else if(1<me){ce=Array(me);for(var Re=0;Re<me;Re++)ce[Re]=arguments[Re+2];se.children=ce}return{$$typeof:n,type:j.type,key:he,ref:pe,props:se,_owner:ve}},react_production_min.createContext=function(j){return j={$$typeof:b,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},j.Provider={$$typeof:_,_context:j},j.Consumer=j},react_production_min.createElement=E,react_production_min.createFactory=function(j){var J=E.bind(null,j);return J.type=j,J},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(j){return{$$typeof:p,render:j}},react_production_min.isValidElement=z,react_production_min.lazy=function(j){return{$$typeof:g,_payload:{_status:-1,_result:j},_init:q}},react_production_min.memo=function(j,J){return{$$typeof:k,type:j,compare:J===void 0?null:J}},react_production_min.startTransition=function(j){var J=B.transition;B.transition={};try{j()}finally{B.transition=J}},react_production_min.unstable_act=X,react_production_min.useCallback=function(j,J){return U.current.useCallback(j,J)},react_production_min.useContext=function(j){return U.current.useContext(j)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(j){return U.current.useDeferredValue(j)},react_production_min.useEffect=function(j,J){return U.current.useEffect(j,J)},react_production_min.useId=function(){return U.current.useId()},react_production_min.useImperativeHandle=function(j,J,le){return U.current.useImperativeHandle(j,J,le)},react_production_min.useInsertionEffect=function(j,J){return U.current.useInsertionEffect(j,J)},react_production_min.useLayoutEffect=function(j,J){return U.current.useLayoutEffect(j,J)},react_production_min.useMemo=function(j,J){return U.current.useMemo(j,J)},react_production_min.useReducer=function(j,J,le){return U.current.useReducer(j,J,le)},react_production_min.useRef=function(j){return U.current.useRef(j)},react_production_min.useState=function(j){return U.current.useState(j)},react_production_min.useSyncExternalStore=function(j,J,le){return U.current.useSyncExternalStore(j,J,le)},react_production_min.useTransition=function(){return U.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min$1;function requireReactJsxRuntime_production_min$1(){if(hasRequiredReactJsxRuntime_production_min$1)return reactJsxRuntime_production_min$1;hasRequiredReactJsxRuntime_production_min$1=1;var n=requireReact(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,v=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_={key:!0,ref:!0,__self:!0,__source:!0};function b(p,y,k){var g,M={},P=null,R=null;k!==void 0&&(P=""+k),y.key!==void 0&&(P=""+y.key),y.ref!==void 0&&(R=y.ref);for(g in y)u.call(y,g)&&!_.hasOwnProperty(g)&&(M[g]=y[g]);if(p&&p.defaultProps)for(g in y=p.defaultProps,y)M[g]===void 0&&(M[g]=y[g]);return{$$typeof:t,type:p,key:P,ref:R,props:M,_owner:v.current}}return reactJsxRuntime_production_min$1.Fragment=r,reactJsxRuntime_production_min$1.jsx=b,reactJsxRuntime_production_min$1.jsxs=b,reactJsxRuntime_production_min$1}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime$1.exports=requireReactJsxRuntime_production_min$1()),jsxRuntime$1.exports}var jsxRuntimeExports$1=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(n){function t(B,Y){var X=B.length;B.push(Y);e:for(;0<X;){var j=X-1>>>1,J=B[j];if(0<v(J,Y))B[j]=Y,B[X]=J,X=j;else break e}}function r(B){return B.length===0?null:B[0]}function u(B){if(B.length===0)return null;var Y=B[0],X=B.pop();if(X!==Y){B[0]=X;e:for(var j=0,J=B.length,le=J>>>1;j<le;){var se=2*(j+1)-1,he=B[se],pe=se+1,ve=B[pe];if(0>v(he,X))pe<J&&0>v(ve,he)?(B[j]=ve,B[pe]=X,j=pe):(B[j]=he,B[se]=X,j=se);else if(pe<J&&0>v(ve,X))B[j]=ve,B[pe]=X,j=pe;else break e}}return Y}function v(B,Y){var X=B.sortIndex-Y.sortIndex;return X!==0?X:B.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var _=performance;n.unstable_now=function(){return _.now()}}else{var b=Date,p=b.now();n.unstable_now=function(){return b.now()-p}}var y=[],k=[],g=1,M=null,P=3,R=!1,S=!1,a=!1,s=typeof setTimeout=="function"?setTimeout:null,c=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(B){for(var Y=r(k);Y!==null;){if(Y.callback===null)u(k);else if(Y.startTime<=B)u(k),Y.sortIndex=Y.expirationTime,t(y,Y);else break;Y=r(k)}}function T(B){if(a=!1,x(B),!S)if(r(y)!==null)S=!0,q(l);else{var Y=r(k);Y!==null&&U(T,Y.startTime-B)}}function l(B,Y){S=!1,a&&(a=!1,c(E),E=-1),R=!0;var X=P;try{for(x(Y),M=r(y);M!==null&&(!(M.expirationTime>Y)||B&&!L());){var j=M.callback;if(typeof j=="function"){M.callback=null,P=M.priorityLevel;var J=j(M.expirationTime<=Y);Y=n.unstable_now(),typeof J=="function"?M.callback=J:M===r(y)&&u(y),x(Y)}else u(y);M=r(y)}if(M!==null)var le=!0;else{var se=r(k);se!==null&&U(T,se.startTime-Y),le=!1}return le}finally{M=null,P=X,R=!1}}var h=!1,C=null,E=-1,D=5,z=-1;function L(){return!(n.unstable_now()-z<D)}function V(){if(C!==null){var B=n.unstable_now();z=B;var Y=!0;try{Y=C(!0,B)}finally{Y?O():(h=!1,C=null)}}else h=!1}var O;if(typeof w=="function")O=function(){w(V)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,H=W.port2;W.port1.onmessage=V,O=function(){H.postMessage(null)}}else O=function(){s(V,0)};function q(B){C=B,h||(h=!0,O())}function U(B,Y){E=s(function(){B(n.unstable_now())},Y)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_continueExecution=function(){S||R||(S=!0,q(l))},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return P},n.unstable_getFirstCallbackNode=function(){return r(y)},n.unstable_next=function(B){switch(P){case 1:case 2:case 3:var Y=3;break;default:Y=P}var X=P;P=Y;try{return B()}finally{P=X}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(B,Y){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var X=P;P=B;try{return Y()}finally{P=X}},n.unstable_scheduleCallback=function(B,Y,X){var j=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?j+X:j):X=j,B){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=X+J,B={id:g++,callback:Y,priorityLevel:B,startTime:X,expirationTime:J,sortIndex:-1},X>j?(B.sortIndex=X,t(k,B),r(y)===null&&B===r(k)&&(a?(c(E),E=-1):a=!0,U(T,X-j))):(B.sortIndex=J,t(y,B),S||R||(S=!0,q(l))),B},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(B){var Y=P;return function(){var X=P;P=Y;try{return B.apply(this,arguments)}finally{P=X}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var n=requireReact(),t=requireScheduler();function r(e){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+e,f=1;f<arguments.length;f++)o+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+e+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=new Set,v={};function _(e,o){b(e,o),b(e+"Capture",o)}function b(e,o){for(v[e]=o,e=0;e<o.length;e++)u.add(o[e])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),y=Object.prototype.hasOwnProperty,k=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},M={};function P(e){return y.call(M,e)?!0:y.call(g,e)?!1:k.test(e)?M[e]=!0:(g[e]=!0,!1)}function R(e,o,f,F){if(f!==null&&f.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return F?!1:f!==null?!f.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function S(e,o,f,F){if(o===null||typeof o>"u"||R(e,o,f,F))return!0;if(F)return!1;if(f!==null)switch(f.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function a(e,o,f,F,N,$,te){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=F,this.attributeNamespace=N,this.mustUseProperty=f,this.propertyName=e,this.type=o,this.sanitizeURL=$,this.removeEmptyString=te}var s={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){s[e]=new a(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var o=e[0];s[o]=new a(o,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){s[e]=new a(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){s[e]=new a(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){s[e]=new a(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){s[e]=new a(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){s[e]=new a(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){s[e]=new a(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){s[e]=new a(e,5,!1,e.toLowerCase(),null,!1,!1)});var c=/[\-:]([a-z])/g;function w(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var o=e.replace(c,w);s[o]=new a(o,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var o=e.replace(c,w);s[o]=new a(o,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var o=e.replace(c,w);s[o]=new a(o,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){s[e]=new a(e,1,!1,e.toLowerCase(),null,!1,!1)}),s.xlinkHref=new a("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){s[e]=new a(e,1,!1,e.toLowerCase(),null,!0,!0)});function x(e,o,f,F){var N=s.hasOwnProperty(o)?s[o]:null;(N!==null?N.type!==0:F||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(S(o,f,N,F)&&(f=null),F||N===null?P(o)&&(f===null?e.removeAttribute(o):e.setAttribute(o,""+f)):N.mustUseProperty?e[N.propertyName]=f===null?N.type===3?!1:"":f:(o=N.attributeName,F=N.attributeNamespace,f===null?e.removeAttribute(o):(N=N.type,f=N===3||N===4&&f===!0?"":""+f,F?e.setAttributeNS(F,o,f):e.setAttribute(o,f))))}var T=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),h=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),z=Symbol.for("react.provider"),L=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),U=Symbol.for("react.offscreen"),B=Symbol.iterator;function Y(e){return e===null||typeof e!="object"?null:(e=B&&e[B]||e["@@iterator"],typeof e=="function"?e:null)}var X=Object.assign,j;function J(e){if(j===void 0)try{throw Error()}catch(f){var o=f.stack.trim().match(/\n( *(at )?)/);j=o&&o[1]||""}return`
`+j+e}var le=!1;function se(e,o){if(!e||le)return"";le=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Ve){var F=Ve}Reflect.construct(e,[],o)}else{try{o.call()}catch(Ve){F=Ve}e.call(o.prototype)}else{try{throw Error()}catch(Ve){F=Ve}e()}}catch(Ve){if(Ve&&F&&typeof Ve.stack=="string"){for(var N=Ve.stack.split(`
`),$=F.stack.split(`
`),te=N.length-1,de=$.length-1;1<=te&&0<=de&&N[te]!==$[de];)de--;for(;1<=te&&0<=de;te--,de--)if(N[te]!==$[de]){if(te!==1||de!==1)do if(te--,de--,0>de||N[te]!==$[de]){var be=`
`+N[te].replace(" at new "," at ");return e.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",e.displayName)),be}while(1<=te&&0<=de);break}}}finally{le=!1,Error.prepareStackTrace=f}return(e=e?e.displayName||e.name:"")?J(e):""}function he(e){switch(e.tag){case 5:return J(e.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 2:case 15:return e=se(e.type,!1),e;case 11:return e=se(e.type.render,!1),e;case 1:return e=se(e.type,!0),e;default:return""}}function pe(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case C:return"Fragment";case h:return"Portal";case D:return"Profiler";case E:return"StrictMode";case O:return"Suspense";case W:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case L:return(e.displayName||"Context")+".Consumer";case z:return(e._context.displayName||"Context")+".Provider";case V:var o=e.render;return e=e.displayName,e||(e=o.displayName||o.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case H:return o=e.displayName||null,o!==null?o:pe(e.type)||"Memo";case q:o=e._payload,e=e._init;try{return pe(e(o))}catch{}}return null}function ve(e){var o=e.type;switch(e.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=o.render,e=e.displayName||e.name||"",o.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(o);case 8:return o===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function ce(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function me(e){var o=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Re(e){var o=me(e)?"checked":"value",f=Object.getOwnPropertyDescriptor(e.constructor.prototype,o),F=""+e[o];if(!e.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var N=f.get,$=f.set;return Object.defineProperty(e,o,{configurable:!0,get:function(){return N.call(this)},set:function(te){F=""+te,$.call(this,te)}}),Object.defineProperty(e,o,{enumerable:f.enumerable}),{getValue:function(){return F},setValue:function(te){F=""+te},stopTracking:function(){e._valueTracker=null,delete e[o]}}}}function Ge(e){e._valueTracker||(e._valueTracker=Re(e))}function We(e){if(!e)return!1;var o=e._valueTracker;if(!o)return!0;var f=o.getValue(),F="";return e&&(F=me(e)?e.checked?"true":"false":e.value),e=F,e!==f?(o.setValue(e),!0):!1}function Oe(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function fe(e,o){var f=o.checked;return X({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??e._wrapperState.initialChecked})}function De(e,o){var f=o.defaultValue==null?"":o.defaultValue,F=o.checked!=null?o.checked:o.defaultChecked;f=ce(o.value!=null?o.value:f),e._wrapperState={initialChecked:F,initialValue:f,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function qe(e,o){o=o.checked,o!=null&&x(e,"checked",o,!1)}function Qe(e,o){qe(e,o);var f=ce(o.value),F=o.type;if(f!=null)F==="number"?(f===0&&e.value===""||e.value!=f)&&(e.value=""+f):e.value!==""+f&&(e.value=""+f);else if(F==="submit"||F==="reset"){e.removeAttribute("value");return}o.hasOwnProperty("value")?ot(e,o.type,f):o.hasOwnProperty("defaultValue")&&ot(e,o.type,ce(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(e.defaultChecked=!!o.defaultChecked)}function st(e,o,f){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var F=o.type;if(!(F!=="submit"&&F!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+e._wrapperState.initialValue,f||o===e.value||(e.value=o),e.defaultValue=o}f=e.name,f!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,f!==""&&(e.name=f)}function ot(e,o,f){(o!=="number"||Oe(e.ownerDocument)!==e)&&(f==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+f&&(e.defaultValue=""+f))}var Ke=Array.isArray;function Je(e,o,f,F){if(e=e.options,o){o={};for(var N=0;N<f.length;N++)o["$"+f[N]]=!0;for(f=0;f<e.length;f++)N=o.hasOwnProperty("$"+e[f].value),e[f].selected!==N&&(e[f].selected=N),N&&F&&(e[f].defaultSelected=!0)}else{for(f=""+ce(f),o=null,N=0;N<e.length;N++){if(e[N].value===f){e[N].selected=!0,F&&(e[N].defaultSelected=!0);return}o!==null||e[N].disabled||(o=e[N])}o!==null&&(o.selected=!0)}}function Xe(e,o){if(o.dangerouslySetInnerHTML!=null)throw Error(r(91));return X({},o,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function je(e,o){var f=o.value;if(f==null){if(f=o.children,o=o.defaultValue,f!=null){if(o!=null)throw Error(r(92));if(Ke(f)){if(1<f.length)throw Error(r(93));f=f[0]}o=f}o==null&&(o=""),f=o}e._wrapperState={initialValue:ce(f)}}function Ue(e,o){var f=ce(o.value),F=ce(o.defaultValue);f!=null&&(f=""+f,f!==e.value&&(e.value=f),o.defaultValue==null&&e.defaultValue!==f&&(e.defaultValue=f)),F!=null&&(e.defaultValue=""+F)}function ft(e){var o=e.textContent;o===e._wrapperState.initialValue&&o!==""&&o!==null&&(e.value=o)}function ut(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ee(e,o){return e==null||e==="http://www.w3.org/1999/xhtml"?ut(o):e==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ie,oe=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,f,F,N){MSApp.execUnsafeLocalFunction(function(){return e(o,f,F,N)})}:e})(function(e,o){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=o;else{for(ie=ie||document.createElement("div"),ie.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=ie.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;o.firstChild;)e.appendChild(o.firstChild)}});function we(e,o){if(o){var f=e.firstChild;if(f&&f===e.lastChild&&f.nodeType===3){f.nodeValue=o;return}}e.textContent=o}var Se={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},He=["Webkit","ms","Moz","O"];Object.keys(Se).forEach(function(e){He.forEach(function(o){o=o+e.charAt(0).toUpperCase()+e.substring(1),Se[o]=Se[e]})});function Be(e,o,f){return o==null||typeof o=="boolean"||o===""?"":f||typeof o!="number"||o===0||Se.hasOwnProperty(e)&&Se[e]?(""+o).trim():o+"px"}function K(e,o){e=e.style;for(var f in o)if(o.hasOwnProperty(f)){var F=f.indexOf("--")===0,N=Be(f,o[f],F);f==="float"&&(f="cssFloat"),F?e.setProperty(f,N):e[f]=N}}var _e=X({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Me(e,o){if(o){if(_e[e]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(r(137,e));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(r(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(r(61))}if(o.style!=null&&typeof o.style!="object")throw Error(r(62))}}function $e(e,o){if(e.indexOf("-")===-1)return typeof o.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function Ne(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Z=null,ze=null,rt=null;function G(e){if(e=Dn(e)){if(typeof Z!="function")throw Error(r(280));var o=e.stateNode;o&&(o=ys(o),Z(e.stateNode,e.type,o))}}function Te(e){ze?rt?rt.push(e):rt=[e]:ze=e}function Ee(){if(ze){var e=ze,o=rt;if(rt=ze=null,G(e),o)for(e=0;e<o.length;e++)G(o[e])}}function re(e,o){return e(o)}function ge(){}var ke=!1;function ct(e,o,f){if(ke)return e(o,f);ke=!0;try{return re(e,o,f)}finally{ke=!1,(ze!==null||rt!==null)&&(ge(),Ee())}}function lt(e,o){var f=e.stateNode;if(f===null)return null;var F=ys(f);if(F===null)return null;f=F[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(F=!F.disabled)||(e=e.type,F=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!F;break e;default:e=!1}if(e)return null;if(f&&typeof f!="function")throw Error(r(231,o,typeof f));return f}var dt=!1;if(p)try{var yt={};Object.defineProperty(yt,"passive",{get:function(){dt=!0}}),window.addEventListener("test",yt,yt),window.removeEventListener("test",yt,yt)}catch{dt=!1}function ir(e,o,f,F,N,$,te,de,be){var Ve=Array.prototype.slice.call(arguments,3);try{o.apply(f,Ve)}catch(et){this.onError(et)}}var At=!1,Mt=null,Pt=!1,Qt=null,Kt={onError:function(e){At=!0,Mt=e}};function Kr(e,o,f,F,N,$,te,de,be){At=!1,Mt=null,ir.apply(Kt,arguments)}function ai(e,o,f,F,N,$,te,de,be){if(Kr.apply(this,arguments),At){if(At){var Ve=Mt;At=!1,Mt=null}else throw Error(r(198));Pt||(Pt=!0,Qt=Ve)}}function Lt(e){var o=e,f=e;if(e.alternate)for(;o.return;)o=o.return;else{e=o;do o=e,(o.flags&4098)!==0&&(f=o.return),e=o.return;while(e)}return o.tag===3?f:null}function Wt(e){if(e.tag===13){var o=e.memoizedState;if(o===null&&(e=e.alternate,e!==null&&(o=e.memoizedState)),o!==null)return o.dehydrated}return null}function qt(e){if(Lt(e)!==e)throw Error(r(188))}function wr(e){var o=e.alternate;if(!o){if(o=Lt(e),o===null)throw Error(r(188));return o!==e?null:e}for(var f=e,F=o;;){var N=f.return;if(N===null)break;var $=N.alternate;if($===null){if(F=N.return,F!==null){f=F;continue}break}if(N.child===$.child){for($=N.child;$;){if($===f)return qt(N),e;if($===F)return qt(N),o;$=$.sibling}throw Error(r(188))}if(f.return!==F.return)f=N,F=$;else{for(var te=!1,de=N.child;de;){if(de===f){te=!0,f=N,F=$;break}if(de===F){te=!0,F=N,f=$;break}de=de.sibling}if(!te){for(de=$.child;de;){if(de===f){te=!0,f=$,F=N;break}if(de===F){te=!0,F=$,f=N;break}de=de.sibling}if(!te)throw Error(r(189))}}if(f.alternate!==F)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?e:o}function dr(e){return e=wr(e),e!==null?jr(e):null}function jr(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var o=jr(e);if(o!==null)return o;e=e.sibling}return null}var gn=t.unstable_scheduleCallback,vn=t.unstable_cancelCallback,Wn=t.unstable_shouldYield,Gi=t.unstable_requestPaint,Jt=t.unstable_now,yn=t.unstable_getCurrentPriorityLevel,Ei=t.unstable_ImmediatePriority,Po=t.unstable_UserBlockingPriority,Ft=t.unstable_NormalPriority,li=t.unstable_LowPriority,Vr=t.unstable_IdlePriority,Hn=null,vr=null;function Ps(e){if(vr&&typeof vr.onCommitFiberRoot=="function")try{vr.onCommitFiberRoot(Hn,e,void 0,(e.current.flags&128)===128)}catch{}}var Rr=Math.clz32?Math.clz32:zs,Fs=Math.log,Ds=Math.LN2;function zs(e){return e>>>=0,e===0?32:31-(Fs(e)/Ds|0)|0}var Wr=64,ui=4194304;function nr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zr(e,o){var f=e.pendingLanes;if(f===0)return 0;var F=0,N=e.suspendedLanes,$=e.pingedLanes,te=f&268435455;if(te!==0){var de=te&~N;de!==0?F=nr(de):($&=te,$!==0&&(F=nr($)))}else te=f&~N,te!==0?F=nr(te):$!==0&&(F=nr($));if(F===0)return 0;if(o!==0&&o!==F&&(o&N)===0&&(N=F&-F,$=o&-o,N>=$||N===16&&($&4194240)!==0))return o;if((F&4)!==0&&(F|=f&16),o=e.entangledLanes,o!==0)for(e=e.entanglements,o&=F;0<o;)f=31-Rr(o),N=1<<f,F|=e[f],o&=~N;return F}function Ai(e,o){switch(e){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ui(e,o){for(var f=e.suspendedLanes,F=e.pingedLanes,N=e.expirationTimes,$=e.pendingLanes;0<$;){var te=31-Rr($),de=1<<te,be=N[te];be===-1?((de&f)===0||(de&F)!==0)&&(N[te]=Ai(de,o)):be<=o&&(e.expiredLanes|=de),$&=~de}}function Is(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ci(){var e=Wr;return Wr<<=1,(Wr&4194240)===0&&(Wr=64),e}function $n(e){for(var o=[],f=0;31>f;f++)o.push(e);return o}function zr(e,o,f){e.pendingLanes|=o,o!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,o=31-Rr(o),e[o]=f}function Va(e,o){var f=e.pendingLanes&~o;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=o,e.mutableReadLanes&=o,e.entangledLanes&=o,o=e.entanglements;var F=e.eventTimes;for(e=e.expirationTimes;0<f;){var N=31-Rr(f),$=1<<N;o[N]=0,F[N]=-1,e[N]=-1,f&=~$}}function Hr(e,o){var f=e.entangledLanes|=o;for(e=e.entanglements;f;){var F=31-Rr(f),N=1<<F;N&o|e[F]&o&&(e[F]|=o),f&=~N}}var Rt=0;function Sr(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Nt,Ti,qn,Ls,Mi,Yn=!1,Wi=[],kr=null,di=null,hi=null,Cr=new Map,ei=new Map,fi=[],Ba="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hi(e,o){switch(e){case"focusin":case"focusout":kr=null;break;case"dragenter":case"dragleave":di=null;break;case"mouseover":case"mouseout":hi=null;break;case"pointerover":case"pointerout":Cr.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ei.delete(o.pointerId)}}function $i(e,o,f,F,N,$){return e===null||e.nativeEvent!==$?(e={blockedOn:o,domEventName:f,eventSystemFlags:F,nativeEvent:$,targetContainers:[N]},o!==null&&(o=Dn(o),o!==null&&Ti(o)),e):(e.eventSystemFlags|=F,o=e.targetContainers,N!==null&&o.indexOf(N)===-1&&o.push(N),e)}function Fo(e,o,f,F,N){switch(o){case"focusin":return kr=$i(kr,e,o,f,F,N),!0;case"dragenter":return di=$i(di,e,o,f,F,N),!0;case"mouseover":return hi=$i(hi,e,o,f,F,N),!0;case"pointerover":var $=N.pointerId;return Cr.set($,$i(Cr.get($)||null,e,o,f,F,N)),!0;case"gotpointercapture":return $=N.pointerId,ei.set($,$i(ei.get($)||null,e,o,f,F,N)),!0}return!1}function Do(e){var o=Li(e.target);if(o!==null){var f=Lt(o);if(f!==null){if(o=f.tag,o===13){if(o=Wt(f),o!==null){e.blockedOn=o,Mi(e.priority,function(){qn(f)});return}}else if(o===3&&f.stateNode.current.memoizedState.isDehydrated){e.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _n(e){if(e.blockedOn!==null)return!1;for(var o=e.targetContainers;0<o.length;){var f=Ns(e.domEventName,e.eventSystemFlags,o[0],e.nativeEvent);if(f===null){f=e.nativeEvent;var F=new f.constructor(f.type,f);ye=F,f.target.dispatchEvent(F),ye=null}else return o=Dn(f),o!==null&&Ti(o),e.blockedOn=f,!1;o.shift()}return!0}function zo(e,o,f){_n(e)&&f.delete(o)}function Ga(){Yn=!1,kr!==null&&_n(kr)&&(kr=null),di!==null&&_n(di)&&(di=null),hi!==null&&_n(hi)&&(hi=null),Cr.forEach(zo),ei.forEach(zo)}function xn(e,o){e.blockedOn===o&&(e.blockedOn=null,Yn||(Yn=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Ga)))}function bn(e){function o(N){return xn(N,e)}if(0<Wi.length){xn(Wi[0],e);for(var f=1;f<Wi.length;f++){var F=Wi[f];F.blockedOn===e&&(F.blockedOn=null)}}for(kr!==null&&xn(kr,e),di!==null&&xn(di,e),hi!==null&&xn(hi,e),Cr.forEach(o),ei.forEach(o),f=0;f<fi.length;f++)F=fi[f],F.blockedOn===e&&(F.blockedOn=null);for(;0<fi.length&&(f=fi[0],f.blockedOn===null);)Do(f),f.blockedOn===null&&fi.shift()}var qi=T.ReactCurrentBatchConfig,Xn=!0;function Ua(e,o,f,F){var N=Rt,$=qi.transition;qi.transition=null;try{Rt=1,Os(e,o,f,F)}finally{Rt=N,qi.transition=$}}function Wa(e,o,f,F){var N=Rt,$=qi.transition;qi.transition=null;try{Rt=4,Os(e,o,f,F)}finally{Rt=N,qi.transition=$}}function Os(e,o,f,F){if(Xn){var N=Ns(e,o,f,F);if(N===null)lo(e,o,F,Jn,f),Hi(e,F);else if(Fo(N,e,o,f,F))F.stopPropagation();else if(Hi(e,F),o&4&&-1<Ba.indexOf(e)){for(;N!==null;){var $=Dn(N);if($!==null&&Nt($),$=Ns(e,o,f,F),$===null&&lo(e,o,F,Jn,f),$===N)break;N=$}N!==null&&F.stopPropagation()}else lo(e,o,F,null,f)}}var Jn=null;function Ns(e,o,f,F){if(Jn=null,e=Ne(F),e=Li(e),e!==null)if(o=Lt(e),o===null)e=null;else if(f=o.tag,f===13){if(e=Wt(o),e!==null)return e;e=null}else if(f===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;e=null}else o!==e&&(e=null);return Jn=e,null}function Io(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yn()){case Ei:return 1;case Po:return 4;case Ft:case li:return 16;case Vr:return 536870912;default:return 16}default:return 16}}var pi=null,Ri=null,Qn=null;function Lo(){if(Qn)return Qn;var e,o=Ri,f=o.length,F,N="value"in pi?pi.value:pi.textContent,$=N.length;for(e=0;e<f&&o[e]===N[e];e++);var te=f-e;for(F=1;F<=te&&o[f-F]===N[$-F];F++);return Qn=N.slice(e,1<F?1-F:void 0)}function Kn(e){var o=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&o===13&&(e=13)):e=o,e===10&&(e=13),32<=e||e===13?e:0}function ki(){return!0}function js(){return!1}function lr(e){function o(f,F,N,$,te){this._reactName=f,this._targetInst=N,this.type=F,this.nativeEvent=$,this.target=te,this.currentTarget=null;for(var de in e)e.hasOwnProperty(de)&&(f=e[de],this[de]=f?f($):$[de]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?ki:js,this.isPropagationStopped=js,this}return X(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ki)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ki)},persist:function(){},isPersistent:ki}),o}var Yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vs=lr(Yi),wn=X({},Yi,{view:0,detail:0}),Ha=lr(wn),Pi,Bs,Xi,Sn=X({},wn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gs,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xi&&(Xi&&e.type==="mousemove"?(Pi=e.screenX-Xi.screenX,Bs=e.screenY-Xi.screenY):Bs=Pi=0,Xi=e),Pi)},movementY:function(e){return"movementY"in e?e.movementY:Bs}}),Oo=lr(Sn),$a=X({},Sn,{dataTransfer:0}),qa=lr($a),Ya=X({},wn,{relatedTarget:0}),Ji=lr(Ya),Xa=X({},Yi,{animationName:0,elapsedTime:0,pseudoElement:0}),Ja=lr(Xa),Qa=X({},Yi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ka=lr(Qa),Cn=X({},Yi,{data:0}),Zn=lr(Cn),Za={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},el={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rl(e){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(e):(e=tl[e])?!!o[e]:!1}function Gs(){return rl}var il=X({},wn,{key:function(e){if(e.key){var o=Za[e.key]||e.key;if(o!=="Unidentified")return o}return e.type==="keypress"?(e=Kn(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?el[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gs,charCode:function(e){return e.type==="keypress"?Kn(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Kn(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),nl=lr(il),es=X({},Sn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),No=lr(es),sl=X({},wn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gs}),Qi=lr(sl),jo=X({},Yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vo=lr(jo),Bo=X({},Sn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Us=lr(Bo),Go=[9,13,27,32],Ws=p&&"CompositionEvent"in window,En=null;p&&"documentMode"in document&&(En=document.documentMode);var ol=p&&"TextEvent"in window&&!En,Uo=p&&(!Ws||En&&8<En&&11>=En),Ki=" ",Wo=!1;function Hs(e,o){switch(e){case"keyup":return Go.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $s(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Fi=!1;function al(e,o){switch(e){case"compositionend":return $s(o);case"keypress":return o.which!==32?null:(Wo=!0,Ki);case"textInput":return e=o.data,e===Ki&&Wo?null:e;default:return null}}function ts(e,o){if(Fi)return e==="compositionend"||!Ws&&Hs(e,o)?(e=Lo(),Qn=Ri=pi=null,Fi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Uo&&o.locale!=="ko"?null:o.data;default:return null}}var Di={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ho(e){var o=e&&e.nodeName&&e.nodeName.toLowerCase();return o==="input"?!!Di[e.type]:o==="textarea"}function $o(e,o,f,F){Te(F),o=ps(o,"onChange"),0<o.length&&(f=new Vs("onChange","change",null,f,F),e.push({event:f,listeners:o}))}var yr=null,Zi=null;function qo(e){fs(e,0)}function rs(e){var o=sn(e);if(We(o))return e}function Yo(e,o){if(e==="change")return o}var An=!1;if(p){var is;if(p){var ns="oninput"in document;if(!ns){var qs=document.createElement("div");qs.setAttribute("oninput","return;"),ns=typeof qs.oninput=="function"}is=ns}else is=!1;An=is&&(!document.documentMode||9<document.documentMode)}function Xs(){yr&&(yr.detachEvent("onpropertychange",Js),Zi=yr=null)}function Js(e){if(e.propertyName==="value"&&rs(Zi)){var o=[];$o(o,Zi,e,Ne(e)),ct(qo,o)}}function Xo(e,o,f){e==="focusin"?(Xs(),yr=o,Zi=f,yr.attachEvent("onpropertychange",Js)):e==="focusout"&&Xs()}function Jo(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return rs(Zi)}function Qo(e,o){if(e==="click")return rs(o)}function Ko(e,o){if(e==="input"||e==="change")return rs(o)}function ss(e,o){return e===o&&(e!==0||1/e===1/o)||e!==e&&o!==o}var sr=typeof Object.is=="function"?Object.is:ss;function zi(e,o){if(sr(e,o))return!0;if(typeof e!="object"||e===null||typeof o!="object"||o===null)return!1;var f=Object.keys(e),F=Object.keys(o);if(f.length!==F.length)return!1;for(F=0;F<f.length;F++){var N=f[F];if(!y.call(o,N)||!sr(e[N],o[N]))return!1}return!0}function Qs(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function os(e,o){var f=Qs(e);e=0;for(var F;f;){if(f.nodeType===3){if(F=e+f.textContent.length,e<=o&&F>=o)return{node:f,offset:o-e};e=F}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=Qs(f)}}function Ks(e,o){return e&&o?e===o?!0:e&&e.nodeType===3?!1:o&&o.nodeType===3?Ks(e,o.parentNode):"contains"in e?e.contains(o):e.compareDocumentPosition?!!(e.compareDocumentPosition(o)&16):!1:!1}function eo(){for(var e=window,o=Oe();o instanceof e.HTMLIFrameElement;){try{var f=typeof o.contentWindow.location.href=="string"}catch{f=!1}if(f)e=o.contentWindow;else break;o=Oe(e.document)}return o}function as(e){var o=e&&e.nodeName&&e.nodeName.toLowerCase();return o&&(o==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||o==="textarea"||e.contentEditable==="true")}function Zo(e){var o=eo(),f=e.focusedElem,F=e.selectionRange;if(o!==f&&f&&f.ownerDocument&&Ks(f.ownerDocument.documentElement,f)){if(F!==null&&as(f)){if(o=F.start,e=F.end,e===void 0&&(e=o),"selectionStart"in f)f.selectionStart=o,f.selectionEnd=Math.min(e,f.value.length);else if(e=(o=f.ownerDocument||document)&&o.defaultView||window,e.getSelection){e=e.getSelection();var N=f.textContent.length,$=Math.min(F.start,N);F=F.end===void 0?$:Math.min(F.end,N),!e.extend&&$>F&&(N=F,F=$,$=N),N=os(f,$);var te=os(f,F);N&&te&&(e.rangeCount!==1||e.anchorNode!==N.node||e.anchorOffset!==N.offset||e.focusNode!==te.node||e.focusOffset!==te.offset)&&(o=o.createRange(),o.setStart(N.node,N.offset),e.removeAllRanges(),$>F?(e.addRange(o),e.extend(te.node,te.offset)):(o.setEnd(te.node,te.offset),e.addRange(o)))}}for(o=[],e=f;e=e.parentNode;)e.nodeType===1&&o.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<o.length;f++)e=o[f],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ls=p&&"documentMode"in document&&11>=document.documentMode,ti=null,us=null,en=null,cs=!1;function to(e,o,f){var F=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;cs||ti==null||ti!==Oe(F)||(F=ti,"selectionStart"in F&&as(F)?F={start:F.selectionStart,end:F.selectionEnd}:(F=(F.ownerDocument&&F.ownerDocument.defaultView||window).getSelection(),F={anchorNode:F.anchorNode,anchorOffset:F.anchorOffset,focusNode:F.focusNode,focusOffset:F.focusOffset}),en&&zi(en,F)||(en=F,F=ps(us,"onSelect"),0<F.length&&(o=new Vs("onSelect","select",null,o,f),e.push({event:o,listeners:F}),o.target=ti)))}function Tn(e,o){var f={};return f[e.toLowerCase()]=o.toLowerCase(),f["Webkit"+e]="webkit"+o,f["Moz"+e]="moz"+o,f}var mi={animationend:Tn("Animation","AnimationEnd"),animationiteration:Tn("Animation","AnimationIteration"),animationstart:Tn("Animation","AnimationStart"),transitionend:Tn("Transition","TransitionEnd")},ds={},ro={};p&&(ro=document.createElement("div").style,"AnimationEvent"in window||(delete mi.animationend.animation,delete mi.animationiteration.animation,delete mi.animationstart.animation),"TransitionEvent"in window||delete mi.transitionend.transition);function Gt(e){if(ds[e])return ds[e];if(!mi[e])return e;var o=mi[e],f;for(f in o)if(o.hasOwnProperty(f)&&f in ro)return ds[e]=o[f];return e}var io=Gt("animationend"),no=Gt("animationiteration"),ea=Gt("animationstart"),ta=Gt("transitionend"),ra=new Map,so="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gi(e,o){ra.set(e,o),_(o,[e])}for(var ri=0;ri<so.length;ri++){var hs=so[ri],ia=hs.toLowerCase(),na=hs[0].toUpperCase()+hs.slice(1);gi(ia,"on"+na)}gi(io,"onAnimationEnd"),gi(no,"onAnimationIteration"),gi(ea,"onAnimationStart"),gi("dblclick","onDoubleClick"),gi("focusin","onFocus"),gi("focusout","onBlur"),gi(ta,"onTransitionEnd"),b("onMouseEnter",["mouseout","mouseover"]),b("onMouseLeave",["mouseout","mouseover"]),b("onPointerEnter",["pointerout","pointerover"]),b("onPointerLeave",["pointerout","pointerover"]),_("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_("onBeforeInput",["compositionend","keypress","textInput","paste"]),_("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ll=new Set("cancel close invalid load scroll toggle".split(" ").concat(tn));function oo(e,o,f){var F=e.type||"unknown-event";e.currentTarget=f,ai(F,o,void 0,e),e.currentTarget=null}function fs(e,o){o=(o&4)!==0;for(var f=0;f<e.length;f++){var F=e[f],N=F.event;F=F.listeners;e:{var $=void 0;if(o)for(var te=F.length-1;0<=te;te--){var de=F[te],be=de.instance,Ve=de.currentTarget;if(de=de.listener,be!==$&&N.isPropagationStopped())break e;oo(N,de,Ve),$=be}else for(te=0;te<F.length;te++){if(de=F[te],be=de.instance,Ve=de.currentTarget,de=de.listener,be!==$&&N.isPropagationStopped())break e;oo(N,de,Ve),$=be}}}if(Pt)throw e=Qt,Pt=!1,Qt=null,e}function Ut(e,o){var f=o[Fn];f===void 0&&(f=o[Fn]=new Set);var F=e+"__bubble";f.has(F)||(sa(o,e,2,!1),f.add(F))}function ao(e,o,f){var F=0;o&&(F|=4),sa(f,e,F,o)}var Mn="_reactListening"+Math.random().toString(36).slice(2);function Rn(e){if(!e[Mn]){e[Mn]=!0,u.forEach(function(f){f!=="selectionchange"&&(ll.has(f)||ao(f,!1,e),ao(f,!0,e))});var o=e.nodeType===9?e:e.ownerDocument;o===null||o[Mn]||(o[Mn]=!0,ao("selectionchange",!1,o))}}function sa(e,o,f,F){switch(Io(o)){case 1:var N=Ua;break;case 4:N=Wa;break;default:N=Os}f=N.bind(null,o,f,e),N=void 0,!dt||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(N=!0),F?N!==void 0?e.addEventListener(o,f,{capture:!0,passive:N}):e.addEventListener(o,f,!0):N!==void 0?e.addEventListener(o,f,{passive:N}):e.addEventListener(o,f,!1)}function lo(e,o,f,F,N){var $=F;if((o&1)===0&&(o&2)===0&&F!==null)e:for(;;){if(F===null)return;var te=F.tag;if(te===3||te===4){var de=F.stateNode.containerInfo;if(de===N||de.nodeType===8&&de.parentNode===N)break;if(te===4)for(te=F.return;te!==null;){var be=te.tag;if((be===3||be===4)&&(be=te.stateNode.containerInfo,be===N||be.nodeType===8&&be.parentNode===N))return;te=te.return}for(;de!==null;){if(te=Li(de),te===null)return;if(be=te.tag,be===5||be===6){F=$=te;continue e}de=de.parentNode}}F=F.return}ct(function(){var Ve=$,et=Ne(f),it=[];e:{var Ze=ra.get(e);if(Ze!==void 0){var pt=Vs,gt=e;switch(e){case"keypress":if(Kn(f)===0)break e;case"keydown":case"keyup":pt=nl;break;case"focusin":gt="focus",pt=Ji;break;case"focusout":gt="blur",pt=Ji;break;case"beforeblur":case"afterblur":pt=Ji;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pt=Oo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pt=qa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pt=Qi;break;case io:case no:case ea:pt=Ja;break;case ta:pt=Vo;break;case"scroll":pt=Ha;break;case"wheel":pt=Us;break;case"copy":case"cut":case"paste":pt=Ka;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pt=No}var vt=(o&4)!==0,or=!vt&&e==="scroll",Fe=vt?Ze!==null?Ze+"Capture":null:Ze;vt=[];for(var Ce=Ve,Le;Ce!==null;){Le=Ce;var at=Le.stateNode;if(Le.tag===5&&at!==null&&(Le=at,Fe!==null&&(at=lt(Ce,Fe),at!=null&&vt.push(kn(Ce,at,Le)))),or)break;Ce=Ce.return}0<vt.length&&(Ze=new pt(Ze,gt,null,f,et),it.push({event:Ze,listeners:vt}))}}if((o&7)===0){e:{if(Ze=e==="mouseover"||e==="pointerover",pt=e==="mouseout"||e==="pointerout",Ze&&f!==ye&&(gt=f.relatedTarget||f.fromElement)&&(Li(gt)||gt[Pr]))break e;if((pt||Ze)&&(Ze=et.window===et?et:(Ze=et.ownerDocument)?Ze.defaultView||Ze.parentWindow:window,pt?(gt=f.relatedTarget||f.toElement,pt=Ve,gt=gt?Li(gt):null,gt!==null&&(or=Lt(gt),gt!==or||gt.tag!==5&&gt.tag!==6)&&(gt=null)):(pt=null,gt=Ve),pt!==gt)){if(vt=Oo,at="onMouseLeave",Fe="onMouseEnter",Ce="mouse",(e==="pointerout"||e==="pointerover")&&(vt=No,at="onPointerLeave",Fe="onPointerEnter",Ce="pointer"),or=pt==null?Ze:sn(pt),Le=gt==null?Ze:sn(gt),Ze=new vt(at,Ce+"leave",pt,f,et),Ze.target=or,Ze.relatedTarget=Le,at=null,Li(et)===Ve&&(vt=new vt(Fe,Ce+"enter",gt,f,et),vt.target=Le,vt.relatedTarget=or,at=vt),or=at,pt&&gt)t:{for(vt=pt,Fe=gt,Ce=0,Le=vt;Le;Le=rn(Le))Ce++;for(Le=0,at=Fe;at;at=rn(at))Le++;for(;0<Ce-Le;)vt=rn(vt),Ce--;for(;0<Le-Ce;)Fe=rn(Fe),Le--;for(;Ce--;){if(vt===Fe||Fe!==null&&vt===Fe.alternate)break t;vt=rn(vt),Fe=rn(Fe)}vt=null}else vt=null;pt!==null&&oa(it,Ze,pt,vt,!1),gt!==null&&or!==null&&oa(it,or,gt,vt,!0)}}e:{if(Ze=Ve?sn(Ve):window,pt=Ze.nodeName&&Ze.nodeName.toLowerCase(),pt==="select"||pt==="input"&&Ze.type==="file")var _t=Yo;else if(Ho(Ze))if(An)_t=Ko;else{_t=Jo;var Ct=Xo}else(pt=Ze.nodeName)&&pt.toLowerCase()==="input"&&(Ze.type==="checkbox"||Ze.type==="radio")&&(_t=Qo);if(_t&&(_t=_t(e,Ve))){$o(it,_t,f,et);break e}Ct&&Ct(e,Ze,Ve),e==="focusout"&&(Ct=Ze._wrapperState)&&Ct.controlled&&Ze.type==="number"&&ot(Ze,"number",Ze.value)}switch(Ct=Ve?sn(Ve):window,e){case"focusin":(Ho(Ct)||Ct.contentEditable==="true")&&(ti=Ct,us=Ve,en=null);break;case"focusout":en=us=ti=null;break;case"mousedown":cs=!0;break;case"contextmenu":case"mouseup":case"dragend":cs=!1,to(it,f,et);break;case"selectionchange":if(ls)break;case"keydown":case"keyup":to(it,f,et)}var Et;if(Ws)e:{switch(e){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else Fi?Hs(e,f)&&(Tt="onCompositionEnd"):e==="keydown"&&f.keyCode===229&&(Tt="onCompositionStart");Tt&&(Uo&&f.locale!=="ko"&&(Fi||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&Fi&&(Et=Lo()):(pi=et,Ri="value"in pi?pi.value:pi.textContent,Fi=!0)),Ct=ps(Ve,Tt),0<Ct.length&&(Tt=new Zn(Tt,e,null,f,et),it.push({event:Tt,listeners:Ct}),Et?Tt.data=Et:(Et=$s(f),Et!==null&&(Tt.data=Et)))),(Et=ol?al(e,f):ts(e,f))&&(Ve=ps(Ve,"onBeforeInput"),0<Ve.length&&(et=new Zn("onBeforeInput","beforeinput",null,f,et),it.push({event:et,listeners:Ve}),et.data=Et))}fs(it,o)})}function kn(e,o,f){return{instance:e,listener:o,currentTarget:f}}function ps(e,o){for(var f=o+"Capture",F=[];e!==null;){var N=e,$=N.stateNode;N.tag===5&&$!==null&&(N=$,$=lt(e,f),$!=null&&F.unshift(kn(e,$,N)),$=lt(e,o),$!=null&&F.push(kn(e,$,N))),e=e.return}return F}function rn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function oa(e,o,f,F,N){for(var $=o._reactName,te=[];f!==null&&f!==F;){var de=f,be=de.alternate,Ve=de.stateNode;if(be!==null&&be===F)break;de.tag===5&&Ve!==null&&(de=Ve,N?(be=lt(f,$),be!=null&&te.unshift(kn(f,be,de))):N||(be=lt(f,$),be!=null&&te.push(kn(f,be,de)))),f=f.return}te.length!==0&&e.push({event:o,listeners:te})}var ul=/\r\n?/g,cl=/\u0000|\uFFFD/g;function aa(e){return(typeof e=="string"?e:""+e).replace(ul,`
`).replace(cl,"")}function ms(e,o,f){if(o=aa(o),aa(e)!==o&&f)throw Error(r(425))}function gs(){}var uo=null,co=null;function Br(e,o){return e==="textarea"||e==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var ho=typeof setTimeout=="function"?setTimeout:void 0,dl=typeof clearTimeout=="function"?clearTimeout:void 0,fo=typeof Promise=="function"?Promise:void 0,hl=typeof queueMicrotask=="function"?queueMicrotask:typeof fo<"u"?function(e){return fo.resolve(null).then(e).catch(fl)}:ho;function fl(e){setTimeout(function(){throw e})}function Ii(e,o){var f=o,F=0;do{var N=f.nextSibling;if(e.removeChild(f),N&&N.nodeType===8)if(f=N.data,f==="/$"){if(F===0){e.removeChild(N),bn(o);return}F--}else f!=="$"&&f!=="$?"&&f!=="$!"||F++;f=N}while(f);bn(o)}function $r(e){for(;e!=null;e=e.nextSibling){var o=e.nodeType;if(o===1||o===3)break;if(o===8){if(o=e.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return e}function vs(e){e=e.previousSibling;for(var o=0;e;){if(e.nodeType===8){var f=e.data;if(f==="$"||f==="$!"||f==="$?"){if(o===0)return e;o--}else f==="/$"&&o++}e=e.previousSibling}return null}var nn=Math.random().toString(36).slice(2),Gr="__reactFiber$"+nn,Pn="__reactProps$"+nn,Pr="__reactContainer$"+nn,Fn="__reactEvents$"+nn,pl="__reactListeners$"+nn,ml="__reactHandles$"+nn;function Li(e){var o=e[Gr];if(o)return o;for(var f=e.parentNode;f;){if(o=f[Pr]||f[Gr]){if(f=o.alternate,o.child!==null||f!==null&&f.child!==null)for(e=vs(e);e!==null;){if(f=e[Gr])return f;e=vs(e)}return o}e=f,f=e.parentNode}return null}function Dn(e){return e=e[Gr]||e[Pr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function sn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(r(33))}function ys(e){return e[Pn]||null}var po=[],on=-1;function vi(e){return{current:e}}function Yt(e){0>on||(e.current=po[on],po[on]=null,on--)}function Ht(e,o){on++,po[on]=e.current,e.current=o}var yi={},hr=vi(yi),Er=vi(!1),_i=yi;function Oi(e,o){var f=e.type.contextTypes;if(!f)return yi;var F=e.stateNode;if(F&&F.__reactInternalMemoizedUnmaskedChildContext===o)return F.__reactInternalMemoizedMaskedChildContext;var N={},$;for($ in f)N[$]=o[$];return F&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=N),N}function _r(e){return e=e.childContextTypes,e!=null}function zn(){Yt(Er),Yt(hr)}function mo(e,o,f){if(hr.current!==yi)throw Error(r(168));Ht(hr,o),Ht(Er,f)}function go(e,o,f){var F=e.stateNode;if(o=o.childContextTypes,typeof F.getChildContext!="function")return f;F=F.getChildContext();for(var N in F)if(!(N in o))throw Error(r(108,ve(e)||"Unknown",N));return X({},f,F)}function In(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||yi,_i=hr.current,Ht(hr,e),Ht(Er,Er.current),!0}function vo(e,o,f){var F=e.stateNode;if(!F)throw Error(r(169));f?(e=go(e,o,_i),F.__reactInternalMemoizedMergedChildContext=e,Yt(Er),Yt(hr),Ht(hr,e)):Yt(Er),Ht(Er,f)}var qr=null,_s=!1,A=!1;function Q(e){qr===null?qr=[e]:qr.push(e)}function I(e){_s=!0,Q(e)}function ne(){if(!A&&qr!==null){A=!0;var e=0,o=Rt;try{var f=qr;for(Rt=1;e<f.length;e++){var F=f[e];do F=F(!0);while(F!==null)}qr=null,_s=!1}catch(N){throw qr!==null&&(qr=qr.slice(e+1)),gn(Ei,ne),N}finally{Rt=o,A=!1}}return null}var ae=[],ue=0,Ie=null,Ae=0,ht=[],xe=0,Pe=null,Dt=1,nt="";function Ye(e,o){ae[ue++]=Ae,ae[ue++]=Ie,Ie=e,Ae=o}function $t(e,o,f){ht[xe++]=Dt,ht[xe++]=nt,ht[xe++]=Pe,Pe=e;var F=Dt;e=nt;var N=32-Rr(F)-1;F&=~(1<<N),f+=1;var $=32-Rr(o)+N;if(30<$){var te=N-N%5;$=(F&(1<<te)-1).toString(32),F>>=te,N-=te,Dt=1<<32-Rr(o)+N|f<<N|F,nt=$+e}else Dt=1<<$|f<<N|F,nt=e}function Xt(e){e.return!==null&&(Ye(e,1),$t(e,1,0))}function It(e){for(;e===Ie;)Ie=ae[--ue],ae[ue]=null,Ae=ae[--ue],ae[ue]=null;for(;e===Pe;)Pe=ht[--xe],ht[xe]=null,nt=ht[--xe],ht[xe]=null,Dt=ht[--xe],ht[xe]=null}var bt=null,xt=null,tt=!1,wt=null;function tr(e,o){var f=Qr(5,null,null,0);f.elementType="DELETED",f.stateNode=o,f.return=e,o=e.deletions,o===null?(e.deletions=[f],e.flags|=16):o.push(f)}function Ot(e,o){switch(e.tag){case 5:var f=e.type;return o=o.nodeType!==1||f.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(e.stateNode=o,bt=e,xt=$r(o.firstChild),!0):!1;case 6:return o=e.pendingProps===""||o.nodeType!==3?null:o,o!==null?(e.stateNode=o,bt=e,xt=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(f=Pe!==null?{id:Dt,overflow:nt}:null,e.memoizedState={dehydrated:o,treeContext:f,retryLane:1073741824},f=Qr(18,null,null,0),f.stateNode=o,f.return=e,e.child=f,bt=e,xt=null,!0):!1;default:return!1}}function zt(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Bt(e){if(tt){var o=xt;if(o){var f=o;if(!Ot(e,o)){if(zt(e))throw Error(r(418));o=$r(f.nextSibling);var F=bt;o&&Ot(e,o)?tr(F,f):(e.flags=e.flags&-4097|2,tt=!1,bt=e)}}else{if(zt(e))throw Error(r(418));e.flags=e.flags&-4097|2,tt=!1,bt=e}}}function St(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;bt=e}function kt(e){if(e!==bt)return!1;if(!tt)return St(e),tt=!0,!1;var o;if((o=e.tag!==3)&&!(o=e.tag!==5)&&(o=e.type,o=o!=="head"&&o!=="body"&&!Br(e.type,e.memoizedProps)),o&&(o=xt)){if(zt(e))throw fr(),Error(r(418));for(;o;)tr(e,o),o=$r(o.nextSibling)}if(St(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(r(317));e:{for(e=e.nextSibling,o=0;e;){if(e.nodeType===8){var f=e.data;if(f==="/$"){if(o===0){xt=$r(e.nextSibling);break e}o--}else f!=="$"&&f!=="$!"&&f!=="$?"||o++}e=e.nextSibling}xt=null}}else xt=bt?$r(e.stateNode.nextSibling):null;return!0}function fr(){for(var e=xt;e;)e=$r(e.nextSibling)}function Ir(){xt=bt=null,tt=!1}function xs(e){wt===null?wt=[e]:wt.push(e)}var bs=T.ReactCurrentBatchConfig;function xi(e,o,f){if(e=f.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(r(309));var F=f.stateNode}if(!F)throw Error(r(147,e));var N=F,$=""+e;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===$?o.ref:(o=function(te){var de=N.refs;te===null?delete de[$]:de[$]=te},o._stringRef=$,o)}if(typeof e!="string")throw Error(r(284));if(!f._owner)throw Error(r(290,e))}return e}function la(e,o){throw e=Object.prototype.toString.call(o),Error(r(31,e==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":e))}function hu(e){var o=e._init;return o(e._payload)}function fu(e){function o(Fe,Ce){if(e){var Le=Fe.deletions;Le===null?(Fe.deletions=[Ce],Fe.flags|=16):Le.push(Ce)}}function f(Fe,Ce){if(!e)return null;for(;Ce!==null;)o(Fe,Ce),Ce=Ce.sibling;return null}function F(Fe,Ce){for(Fe=new Map;Ce!==null;)Ce.key!==null?Fe.set(Ce.key,Ce):Fe.set(Ce.index,Ce),Ce=Ce.sibling;return Fe}function N(Fe,Ce){return Fe=pn(Fe,Ce),Fe.index=0,Fe.sibling=null,Fe}function $(Fe,Ce,Le){return Fe.index=Le,e?(Le=Fe.alternate,Le!==null?(Le=Le.index,Le<Ce?(Fe.flags|=2,Ce):Le):(Fe.flags|=2,Ce)):(Fe.flags|=1048576,Ce)}function te(Fe){return e&&Fe.alternate===null&&(Fe.flags|=2),Fe}function de(Fe,Ce,Le,at){return Ce===null||Ce.tag!==6?(Ce=ou(Le,Fe.mode,at),Ce.return=Fe,Ce):(Ce=N(Ce,Le),Ce.return=Fe,Ce)}function be(Fe,Ce,Le,at){var _t=Le.type;return _t===C?et(Fe,Ce,Le.props.children,at,Le.key):Ce!==null&&(Ce.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===q&&hu(_t)===Ce.type)?(at=N(Ce,Le.props),at.ref=xi(Fe,Ce,Le),at.return=Fe,at):(at=Fa(Le.type,Le.key,Le.props,null,Fe.mode,at),at.ref=xi(Fe,Ce,Le),at.return=Fe,at)}function Ve(Fe,Ce,Le,at){return Ce===null||Ce.tag!==4||Ce.stateNode.containerInfo!==Le.containerInfo||Ce.stateNode.implementation!==Le.implementation?(Ce=au(Le,Fe.mode,at),Ce.return=Fe,Ce):(Ce=N(Ce,Le.children||[]),Ce.return=Fe,Ce)}function et(Fe,Ce,Le,at,_t){return Ce===null||Ce.tag!==7?(Ce=Un(Le,Fe.mode,at,_t),Ce.return=Fe,Ce):(Ce=N(Ce,Le),Ce.return=Fe,Ce)}function it(Fe,Ce,Le){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return Ce=ou(""+Ce,Fe.mode,Le),Ce.return=Fe,Ce;if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case l:return Le=Fa(Ce.type,Ce.key,Ce.props,null,Fe.mode,Le),Le.ref=xi(Fe,null,Ce),Le.return=Fe,Le;case h:return Ce=au(Ce,Fe.mode,Le),Ce.return=Fe,Ce;case q:var at=Ce._init;return it(Fe,at(Ce._payload),Le)}if(Ke(Ce)||Y(Ce))return Ce=Un(Ce,Fe.mode,Le,null),Ce.return=Fe,Ce;la(Fe,Ce)}return null}function Ze(Fe,Ce,Le,at){var _t=Ce!==null?Ce.key:null;if(typeof Le=="string"&&Le!==""||typeof Le=="number")return _t!==null?null:de(Fe,Ce,""+Le,at);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case l:return Le.key===_t?be(Fe,Ce,Le,at):null;case h:return Le.key===_t?Ve(Fe,Ce,Le,at):null;case q:return _t=Le._init,Ze(Fe,Ce,_t(Le._payload),at)}if(Ke(Le)||Y(Le))return _t!==null?null:et(Fe,Ce,Le,at,null);la(Fe,Le)}return null}function pt(Fe,Ce,Le,at,_t){if(typeof at=="string"&&at!==""||typeof at=="number")return Fe=Fe.get(Le)||null,de(Ce,Fe,""+at,_t);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case l:return Fe=Fe.get(at.key===null?Le:at.key)||null,be(Ce,Fe,at,_t);case h:return Fe=Fe.get(at.key===null?Le:at.key)||null,Ve(Ce,Fe,at,_t);case q:var Ct=at._init;return pt(Fe,Ce,Le,Ct(at._payload),_t)}if(Ke(at)||Y(at))return Fe=Fe.get(Le)||null,et(Ce,Fe,at,_t,null);la(Ce,at)}return null}function gt(Fe,Ce,Le,at){for(var _t=null,Ct=null,Et=Ce,Tt=Ce=0,gr=null;Et!==null&&Tt<Le.length;Tt++){Et.index>Tt?(gr=Et,Et=null):gr=Et.sibling;var Vt=Ze(Fe,Et,Le[Tt],at);if(Vt===null){Et===null&&(Et=gr);break}e&&Et&&Vt.alternate===null&&o(Fe,Et),Ce=$(Vt,Ce,Tt),Ct===null?_t=Vt:Ct.sibling=Vt,Ct=Vt,Et=gr}if(Tt===Le.length)return f(Fe,Et),tt&&Ye(Fe,Tt),_t;if(Et===null){for(;Tt<Le.length;Tt++)Et=it(Fe,Le[Tt],at),Et!==null&&(Ce=$(Et,Ce,Tt),Ct===null?_t=Et:Ct.sibling=Et,Ct=Et);return tt&&Ye(Fe,Tt),_t}for(Et=F(Fe,Et);Tt<Le.length;Tt++)gr=pt(Et,Fe,Tt,Le[Tt],at),gr!==null&&(e&&gr.alternate!==null&&Et.delete(gr.key===null?Tt:gr.key),Ce=$(gr,Ce,Tt),Ct===null?_t=gr:Ct.sibling=gr,Ct=gr);return e&&Et.forEach(function(mn){return o(Fe,mn)}),tt&&Ye(Fe,Tt),_t}function vt(Fe,Ce,Le,at){var _t=Y(Le);if(typeof _t!="function")throw Error(r(150));if(Le=_t.call(Le),Le==null)throw Error(r(151));for(var Ct=_t=null,Et=Ce,Tt=Ce=0,gr=null,Vt=Le.next();Et!==null&&!Vt.done;Tt++,Vt=Le.next()){Et.index>Tt?(gr=Et,Et=null):gr=Et.sibling;var mn=Ze(Fe,Et,Vt.value,at);if(mn===null){Et===null&&(Et=gr);break}e&&Et&&mn.alternate===null&&o(Fe,Et),Ce=$(mn,Ce,Tt),Ct===null?_t=mn:Ct.sibling=mn,Ct=mn,Et=gr}if(Vt.done)return f(Fe,Et),tt&&Ye(Fe,Tt),_t;if(Et===null){for(;!Vt.done;Tt++,Vt=Le.next())Vt=it(Fe,Vt.value,at),Vt!==null&&(Ce=$(Vt,Ce,Tt),Ct===null?_t=Vt:Ct.sibling=Vt,Ct=Vt);return tt&&Ye(Fe,Tt),_t}for(Et=F(Fe,Et);!Vt.done;Tt++,Vt=Le.next())Vt=pt(Et,Fe,Tt,Vt.value,at),Vt!==null&&(e&&Vt.alternate!==null&&Et.delete(Vt.key===null?Tt:Vt.key),Ce=$(Vt,Ce,Tt),Ct===null?_t=Vt:Ct.sibling=Vt,Ct=Vt);return e&&Et.forEach(function(pd){return o(Fe,pd)}),tt&&Ye(Fe,Tt),_t}function or(Fe,Ce,Le,at){if(typeof Le=="object"&&Le!==null&&Le.type===C&&Le.key===null&&(Le=Le.props.children),typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case l:e:{for(var _t=Le.key,Ct=Ce;Ct!==null;){if(Ct.key===_t){if(_t=Le.type,_t===C){if(Ct.tag===7){f(Fe,Ct.sibling),Ce=N(Ct,Le.props.children),Ce.return=Fe,Fe=Ce;break e}}else if(Ct.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===q&&hu(_t)===Ct.type){f(Fe,Ct.sibling),Ce=N(Ct,Le.props),Ce.ref=xi(Fe,Ct,Le),Ce.return=Fe,Fe=Ce;break e}f(Fe,Ct);break}else o(Fe,Ct);Ct=Ct.sibling}Le.type===C?(Ce=Un(Le.props.children,Fe.mode,at,Le.key),Ce.return=Fe,Fe=Ce):(at=Fa(Le.type,Le.key,Le.props,null,Fe.mode,at),at.ref=xi(Fe,Ce,Le),at.return=Fe,Fe=at)}return te(Fe);case h:e:{for(Ct=Le.key;Ce!==null;){if(Ce.key===Ct)if(Ce.tag===4&&Ce.stateNode.containerInfo===Le.containerInfo&&Ce.stateNode.implementation===Le.implementation){f(Fe,Ce.sibling),Ce=N(Ce,Le.children||[]),Ce.return=Fe,Fe=Ce;break e}else{f(Fe,Ce);break}else o(Fe,Ce);Ce=Ce.sibling}Ce=au(Le,Fe.mode,at),Ce.return=Fe,Fe=Ce}return te(Fe);case q:return Ct=Le._init,or(Fe,Ce,Ct(Le._payload),at)}if(Ke(Le))return gt(Fe,Ce,Le,at);if(Y(Le))return vt(Fe,Ce,Le,at);la(Fe,Le)}return typeof Le=="string"&&Le!==""||typeof Le=="number"?(Le=""+Le,Ce!==null&&Ce.tag===6?(f(Fe,Ce.sibling),Ce=N(Ce,Le),Ce.return=Fe,Fe=Ce):(f(Fe,Ce),Ce=ou(Le,Fe.mode,at),Ce.return=Fe,Fe=Ce),te(Fe)):f(Fe,Ce)}return or}var ws=fu(!0),pu=fu(!1),ua=vi(null),ca=null,Ss=null,gl=null;function vl(){gl=Ss=ca=null}function yl(e){var o=ua.current;Yt(ua),e._currentValue=o}function _l(e,o,f){for(;e!==null;){var F=e.alternate;if((e.childLanes&o)!==o?(e.childLanes|=o,F!==null&&(F.childLanes|=o)):F!==null&&(F.childLanes&o)!==o&&(F.childLanes|=o),e===f)break;e=e.return}}function Cs(e,o){ca=e,gl=Ss=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&o)!==0&&(Lr=!0),e.firstContext=null)}function Yr(e){var o=e._currentValue;if(gl!==e)if(e={context:e,memoizedValue:o,next:null},Ss===null){if(ca===null)throw Error(r(308));Ss=e,ca.dependencies={lanes:0,firstContext:e}}else Ss=Ss.next=e;return o}var Ln=null;function xl(e){Ln===null?Ln=[e]:Ln.push(e)}function mu(e,o,f,F){var N=o.interleaved;return N===null?(f.next=f,xl(o)):(f.next=N.next,N.next=f),o.interleaved=f,Ni(e,F)}function Ni(e,o){e.lanes|=o;var f=e.alternate;for(f!==null&&(f.lanes|=o),f=e,e=e.return;e!==null;)e.childLanes|=o,f=e.alternate,f!==null&&(f.childLanes|=o),f=e,e=e.return;return f.tag===3?f.stateNode:null}var an=!1;function bl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gu(e,o){e=e.updateQueue,o.updateQueue===e&&(o.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ji(e,o){return{eventTime:e,lane:o,tag:0,payload:null,callback:null,next:null}}function ln(e,o,f){var F=e.updateQueue;if(F===null)return null;if(F=F.shared,(jt&2)!==0){var N=F.pending;return N===null?o.next=o:(o.next=N.next,N.next=o),F.pending=o,Ni(e,f)}return N=F.interleaved,N===null?(o.next=o,xl(F)):(o.next=N.next,N.next=o),F.interleaved=o,Ni(e,f)}function da(e,o,f){if(o=o.updateQueue,o!==null&&(o=o.shared,(f&4194240)!==0)){var F=o.lanes;F&=e.pendingLanes,f|=F,o.lanes=f,Hr(e,f)}}function vu(e,o){var f=e.updateQueue,F=e.alternate;if(F!==null&&(F=F.updateQueue,f===F)){var N=null,$=null;if(f=f.firstBaseUpdate,f!==null){do{var te={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};$===null?N=$=te:$=$.next=te,f=f.next}while(f!==null);$===null?N=$=o:$=$.next=o}else N=$=o;f={baseState:F.baseState,firstBaseUpdate:N,lastBaseUpdate:$,shared:F.shared,effects:F.effects},e.updateQueue=f;return}e=f.lastBaseUpdate,e===null?f.firstBaseUpdate=o:e.next=o,f.lastBaseUpdate=o}function ha(e,o,f,F){var N=e.updateQueue;an=!1;var $=N.firstBaseUpdate,te=N.lastBaseUpdate,de=N.shared.pending;if(de!==null){N.shared.pending=null;var be=de,Ve=be.next;be.next=null,te===null?$=Ve:te.next=Ve,te=be;var et=e.alternate;et!==null&&(et=et.updateQueue,de=et.lastBaseUpdate,de!==te&&(de===null?et.firstBaseUpdate=Ve:de.next=Ve,et.lastBaseUpdate=be))}if($!==null){var it=N.baseState;te=0,et=Ve=be=null,de=$;do{var Ze=de.lane,pt=de.eventTime;if((F&Ze)===Ze){et!==null&&(et=et.next={eventTime:pt,lane:0,tag:de.tag,payload:de.payload,callback:de.callback,next:null});e:{var gt=e,vt=de;switch(Ze=o,pt=f,vt.tag){case 1:if(gt=vt.payload,typeof gt=="function"){it=gt.call(pt,it,Ze);break e}it=gt;break e;case 3:gt.flags=gt.flags&-65537|128;case 0:if(gt=vt.payload,Ze=typeof gt=="function"?gt.call(pt,it,Ze):gt,Ze==null)break e;it=X({},it,Ze);break e;case 2:an=!0}}de.callback!==null&&de.lane!==0&&(e.flags|=64,Ze=N.effects,Ze===null?N.effects=[de]:Ze.push(de))}else pt={eventTime:pt,lane:Ze,tag:de.tag,payload:de.payload,callback:de.callback,next:null},et===null?(Ve=et=pt,be=it):et=et.next=pt,te|=Ze;if(de=de.next,de===null){if(de=N.shared.pending,de===null)break;Ze=de,de=Ze.next,Ze.next=null,N.lastBaseUpdate=Ze,N.shared.pending=null}}while(!0);if(et===null&&(be=it),N.baseState=be,N.firstBaseUpdate=Ve,N.lastBaseUpdate=et,o=N.shared.interleaved,o!==null){N=o;do te|=N.lane,N=N.next;while(N!==o)}else $===null&&(N.shared.lanes=0);jn|=te,e.lanes=te,e.memoizedState=it}}function yu(e,o,f){if(e=o.effects,o.effects=null,e!==null)for(o=0;o<e.length;o++){var F=e[o],N=F.callback;if(N!==null){if(F.callback=null,F=f,typeof N!="function")throw Error(r(191,N));N.call(F)}}}var yo={},bi=vi(yo),_o=vi(yo),xo=vi(yo);function On(e){if(e===yo)throw Error(r(174));return e}function wl(e,o){switch(Ht(xo,o),Ht(_o,e),Ht(bi,yo),e=o.nodeType,e){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:ee(null,"");break;default:e=e===8?o.parentNode:o,o=e.namespaceURI||null,e=e.tagName,o=ee(o,e)}Yt(bi),Ht(bi,o)}function Es(){Yt(bi),Yt(_o),Yt(xo)}function _u(e){On(xo.current);var o=On(bi.current),f=ee(o,e.type);o!==f&&(Ht(_o,e),Ht(bi,f))}function Sl(e){_o.current===e&&(Yt(bi),Yt(_o))}var Zt=vi(0);function fa(e){for(var o=e;o!==null;){if(o.tag===13){var f=o.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Cl=[];function El(){for(var e=0;e<Cl.length;e++)Cl[e]._workInProgressVersionPrimary=null;Cl.length=0}var pa=T.ReactCurrentDispatcher,Al=T.ReactCurrentBatchConfig,Nn=0,er=null,ur=null,pr=null,ma=!1,bo=!1,wo=0,Ic=0;function Ar(){throw Error(r(321))}function Tl(e,o){if(o===null)return!1;for(var f=0;f<o.length&&f<e.length;f++)if(!sr(e[f],o[f]))return!1;return!0}function Ml(e,o,f,F,N,$){if(Nn=$,er=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,pa.current=e===null||e.memoizedState===null?jc:Vc,e=f(F,N),bo){$=0;do{if(bo=!1,wo=0,25<=$)throw Error(r(301));$+=1,pr=ur=null,o.updateQueue=null,pa.current=Bc,e=f(F,N)}while(bo)}if(pa.current=ya,o=ur!==null&&ur.next!==null,Nn=0,pr=ur=er=null,ma=!1,o)throw Error(r(300));return e}function Rl(){var e=wo!==0;return wo=0,e}function wi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pr===null?er.memoizedState=pr=e:pr=pr.next=e,pr}function Xr(){if(ur===null){var e=er.alternate;e=e!==null?e.memoizedState:null}else e=ur.next;var o=pr===null?er.memoizedState:pr.next;if(o!==null)pr=o,ur=e;else{if(e===null)throw Error(r(310));ur=e,e={memoizedState:ur.memoizedState,baseState:ur.baseState,baseQueue:ur.baseQueue,queue:ur.queue,next:null},pr===null?er.memoizedState=pr=e:pr=pr.next=e}return pr}function So(e,o){return typeof o=="function"?o(e):o}function kl(e){var o=Xr(),f=o.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=e;var F=ur,N=F.baseQueue,$=f.pending;if($!==null){if(N!==null){var te=N.next;N.next=$.next,$.next=te}F.baseQueue=N=$,f.pending=null}if(N!==null){$=N.next,F=F.baseState;var de=te=null,be=null,Ve=$;do{var et=Ve.lane;if((Nn&et)===et)be!==null&&(be=be.next={lane:0,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null}),F=Ve.hasEagerState?Ve.eagerState:e(F,Ve.action);else{var it={lane:et,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null};be===null?(de=be=it,te=F):be=be.next=it,er.lanes|=et,jn|=et}Ve=Ve.next}while(Ve!==null&&Ve!==$);be===null?te=F:be.next=de,sr(F,o.memoizedState)||(Lr=!0),o.memoizedState=F,o.baseState=te,o.baseQueue=be,f.lastRenderedState=F}if(e=f.interleaved,e!==null){N=e;do $=N.lane,er.lanes|=$,jn|=$,N=N.next;while(N!==e)}else N===null&&(f.lanes=0);return[o.memoizedState,f.dispatch]}function Pl(e){var o=Xr(),f=o.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=e;var F=f.dispatch,N=f.pending,$=o.memoizedState;if(N!==null){f.pending=null;var te=N=N.next;do $=e($,te.action),te=te.next;while(te!==N);sr($,o.memoizedState)||(Lr=!0),o.memoizedState=$,o.baseQueue===null&&(o.baseState=$),f.lastRenderedState=$}return[$,F]}function xu(){}function bu(e,o){var f=er,F=Xr(),N=o(),$=!sr(F.memoizedState,N);if($&&(F.memoizedState=N,Lr=!0),F=F.queue,Fl(Cu.bind(null,f,F,e),[e]),F.getSnapshot!==o||$||pr!==null&&pr.memoizedState.tag&1){if(f.flags|=2048,Co(9,Su.bind(null,f,F,N,o),void 0,null),mr===null)throw Error(r(349));(Nn&30)!==0||wu(f,o,N)}return N}function wu(e,o,f){e.flags|=16384,e={getSnapshot:o,value:f},o=er.updateQueue,o===null?(o={lastEffect:null,stores:null},er.updateQueue=o,o.stores=[e]):(f=o.stores,f===null?o.stores=[e]:f.push(e))}function Su(e,o,f,F){o.value=f,o.getSnapshot=F,Eu(o)&&Au(e)}function Cu(e,o,f){return f(function(){Eu(o)&&Au(e)})}function Eu(e){var o=e.getSnapshot;e=e.value;try{var f=o();return!sr(e,f)}catch{return!0}}function Au(e){var o=Ni(e,1);o!==null&&oi(o,e,1,-1)}function Tu(e){var o=wi();return typeof e=="function"&&(e=e()),o.memoizedState=o.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:e},o.queue=e,e=e.dispatch=Nc.bind(null,er,e),[o.memoizedState,e]}function Co(e,o,f,F){return e={tag:e,create:o,destroy:f,deps:F,next:null},o=er.updateQueue,o===null?(o={lastEffect:null,stores:null},er.updateQueue=o,o.lastEffect=e.next=e):(f=o.lastEffect,f===null?o.lastEffect=e.next=e:(F=f.next,f.next=e,e.next=F,o.lastEffect=e)),e}function Mu(){return Xr().memoizedState}function ga(e,o,f,F){var N=wi();er.flags|=e,N.memoizedState=Co(1|o,f,void 0,F===void 0?null:F)}function va(e,o,f,F){var N=Xr();F=F===void 0?null:F;var $=void 0;if(ur!==null){var te=ur.memoizedState;if($=te.destroy,F!==null&&Tl(F,te.deps)){N.memoizedState=Co(o,f,$,F);return}}er.flags|=e,N.memoizedState=Co(1|o,f,$,F)}function Ru(e,o){return ga(8390656,8,e,o)}function Fl(e,o){return va(2048,8,e,o)}function ku(e,o){return va(4,2,e,o)}function Pu(e,o){return va(4,4,e,o)}function Fu(e,o){if(typeof o=="function")return e=e(),o(e),function(){o(null)};if(o!=null)return e=e(),o.current=e,function(){o.current=null}}function Du(e,o,f){return f=f!=null?f.concat([e]):null,va(4,4,Fu.bind(null,o,e),f)}function Dl(){}function zu(e,o){var f=Xr();o=o===void 0?null:o;var F=f.memoizedState;return F!==null&&o!==null&&Tl(o,F[1])?F[0]:(f.memoizedState=[e,o],e)}function Iu(e,o){var f=Xr();o=o===void 0?null:o;var F=f.memoizedState;return F!==null&&o!==null&&Tl(o,F[1])?F[0]:(e=e(),f.memoizedState=[e,o],e)}function Lu(e,o,f){return(Nn&21)===0?(e.baseState&&(e.baseState=!1,Lr=!0),e.memoizedState=f):(sr(f,o)||(f=ci(),er.lanes|=f,jn|=f,e.baseState=!0),o)}function Lc(e,o){var f=Rt;Rt=f!==0&&4>f?f:4,e(!0);var F=Al.transition;Al.transition={};try{e(!1),o()}finally{Rt=f,Al.transition=F}}function Ou(){return Xr().memoizedState}function Oc(e,o,f){var F=hn(e);if(f={lane:F,action:f,hasEagerState:!1,eagerState:null,next:null},Nu(e))ju(o,f);else if(f=mu(e,o,f,F),f!==null){var N=Dr();oi(f,e,F,N),Vu(f,o,F)}}function Nc(e,o,f){var F=hn(e),N={lane:F,action:f,hasEagerState:!1,eagerState:null,next:null};if(Nu(e))ju(o,N);else{var $=e.alternate;if(e.lanes===0&&($===null||$.lanes===0)&&($=o.lastRenderedReducer,$!==null))try{var te=o.lastRenderedState,de=$(te,f);if(N.hasEagerState=!0,N.eagerState=de,sr(de,te)){var be=o.interleaved;be===null?(N.next=N,xl(o)):(N.next=be.next,be.next=N),o.interleaved=N;return}}catch{}finally{}f=mu(e,o,N,F),f!==null&&(N=Dr(),oi(f,e,F,N),Vu(f,o,F))}}function Nu(e){var o=e.alternate;return e===er||o!==null&&o===er}function ju(e,o){bo=ma=!0;var f=e.pending;f===null?o.next=o:(o.next=f.next,f.next=o),e.pending=o}function Vu(e,o,f){if((f&4194240)!==0){var F=o.lanes;F&=e.pendingLanes,f|=F,o.lanes=f,Hr(e,f)}}var ya={readContext:Yr,useCallback:Ar,useContext:Ar,useEffect:Ar,useImperativeHandle:Ar,useInsertionEffect:Ar,useLayoutEffect:Ar,useMemo:Ar,useReducer:Ar,useRef:Ar,useState:Ar,useDebugValue:Ar,useDeferredValue:Ar,useTransition:Ar,useMutableSource:Ar,useSyncExternalStore:Ar,useId:Ar,unstable_isNewReconciler:!1},jc={readContext:Yr,useCallback:function(e,o){return wi().memoizedState=[e,o===void 0?null:o],e},useContext:Yr,useEffect:Ru,useImperativeHandle:function(e,o,f){return f=f!=null?f.concat([e]):null,ga(4194308,4,Fu.bind(null,o,e),f)},useLayoutEffect:function(e,o){return ga(4194308,4,e,o)},useInsertionEffect:function(e,o){return ga(4,2,e,o)},useMemo:function(e,o){var f=wi();return o=o===void 0?null:o,e=e(),f.memoizedState=[e,o],e},useReducer:function(e,o,f){var F=wi();return o=f!==void 0?f(o):o,F.memoizedState=F.baseState=o,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:o},F.queue=e,e=e.dispatch=Oc.bind(null,er,e),[F.memoizedState,e]},useRef:function(e){var o=wi();return e={current:e},o.memoizedState=e},useState:Tu,useDebugValue:Dl,useDeferredValue:function(e){return wi().memoizedState=e},useTransition:function(){var e=Tu(!1),o=e[0];return e=Lc.bind(null,e[1]),wi().memoizedState=e,[o,e]},useMutableSource:function(){},useSyncExternalStore:function(e,o,f){var F=er,N=wi();if(tt){if(f===void 0)throw Error(r(407));f=f()}else{if(f=o(),mr===null)throw Error(r(349));(Nn&30)!==0||wu(F,o,f)}N.memoizedState=f;var $={value:f,getSnapshot:o};return N.queue=$,Ru(Cu.bind(null,F,$,e),[e]),F.flags|=2048,Co(9,Su.bind(null,F,$,f,o),void 0,null),f},useId:function(){var e=wi(),o=mr.identifierPrefix;if(tt){var f=nt,F=Dt;f=(F&~(1<<32-Rr(F)-1)).toString(32)+f,o=":"+o+"R"+f,f=wo++,0<f&&(o+="H"+f.toString(32)),o+=":"}else f=Ic++,o=":"+o+"r"+f.toString(32)+":";return e.memoizedState=o},unstable_isNewReconciler:!1},Vc={readContext:Yr,useCallback:zu,useContext:Yr,useEffect:Fl,useImperativeHandle:Du,useInsertionEffect:ku,useLayoutEffect:Pu,useMemo:Iu,useReducer:kl,useRef:Mu,useState:function(){return kl(So)},useDebugValue:Dl,useDeferredValue:function(e){var o=Xr();return Lu(o,ur.memoizedState,e)},useTransition:function(){var e=kl(So)[0],o=Xr().memoizedState;return[e,o]},useMutableSource:xu,useSyncExternalStore:bu,useId:Ou,unstable_isNewReconciler:!1},Bc={readContext:Yr,useCallback:zu,useContext:Yr,useEffect:Fl,useImperativeHandle:Du,useInsertionEffect:ku,useLayoutEffect:Pu,useMemo:Iu,useReducer:Pl,useRef:Mu,useState:function(){return Pl(So)},useDebugValue:Dl,useDeferredValue:function(e){var o=Xr();return ur===null?o.memoizedState=e:Lu(o,ur.memoizedState,e)},useTransition:function(){var e=Pl(So)[0],o=Xr().memoizedState;return[e,o]},useMutableSource:xu,useSyncExternalStore:bu,useId:Ou,unstable_isNewReconciler:!1};function ii(e,o){if(e&&e.defaultProps){o=X({},o),e=e.defaultProps;for(var f in e)o[f]===void 0&&(o[f]=e[f]);return o}return o}function zl(e,o,f,F){o=e.memoizedState,f=f(F,o),f=f==null?o:X({},o,f),e.memoizedState=f,e.lanes===0&&(e.updateQueue.baseState=f)}var _a={isMounted:function(e){return(e=e._reactInternals)?Lt(e)===e:!1},enqueueSetState:function(e,o,f){e=e._reactInternals;var F=Dr(),N=hn(e),$=ji(F,N);$.payload=o,f!=null&&($.callback=f),o=ln(e,$,N),o!==null&&(oi(o,e,N,F),da(o,e,N))},enqueueReplaceState:function(e,o,f){e=e._reactInternals;var F=Dr(),N=hn(e),$=ji(F,N);$.tag=1,$.payload=o,f!=null&&($.callback=f),o=ln(e,$,N),o!==null&&(oi(o,e,N,F),da(o,e,N))},enqueueForceUpdate:function(e,o){e=e._reactInternals;var f=Dr(),F=hn(e),N=ji(f,F);N.tag=2,o!=null&&(N.callback=o),o=ln(e,N,F),o!==null&&(oi(o,e,F,f),da(o,e,F))}};function Bu(e,o,f,F,N,$,te){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(F,$,te):o.prototype&&o.prototype.isPureReactComponent?!zi(f,F)||!zi(N,$):!0}function Gu(e,o,f){var F=!1,N=yi,$=o.contextType;return typeof $=="object"&&$!==null?$=Yr($):(N=_r(o)?_i:hr.current,F=o.contextTypes,$=(F=F!=null)?Oi(e,N):yi),o=new o(f,$),e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=_a,e.stateNode=o,o._reactInternals=e,F&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=N,e.__reactInternalMemoizedMaskedChildContext=$),o}function Uu(e,o,f,F){e=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(f,F),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(f,F),o.state!==e&&_a.enqueueReplaceState(o,o.state,null)}function Il(e,o,f,F){var N=e.stateNode;N.props=f,N.state=e.memoizedState,N.refs={},bl(e);var $=o.contextType;typeof $=="object"&&$!==null?N.context=Yr($):($=_r(o)?_i:hr.current,N.context=Oi(e,$)),N.state=e.memoizedState,$=o.getDerivedStateFromProps,typeof $=="function"&&(zl(e,o,$,f),N.state=e.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(o=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),o!==N.state&&_a.enqueueReplaceState(N,N.state,null),ha(e,f,N,F),N.state=e.memoizedState),typeof N.componentDidMount=="function"&&(e.flags|=4194308)}function As(e,o){try{var f="",F=o;do f+=he(F),F=F.return;while(F);var N=f}catch($){N=`
Error generating stack: `+$.message+`
`+$.stack}return{value:e,source:o,stack:N,digest:null}}function Ll(e,o,f){return{value:e,source:null,stack:f??null,digest:o??null}}function Ol(e,o){try{console.error(o.value)}catch(f){setTimeout(function(){throw f})}}var Gc=typeof WeakMap=="function"?WeakMap:Map;function Wu(e,o,f){f=ji(-1,f),f.tag=3,f.payload={element:null};var F=o.value;return f.callback=function(){Aa||(Aa=!0,Kl=F),Ol(e,o)},f}function Hu(e,o,f){f=ji(-1,f),f.tag=3;var F=e.type.getDerivedStateFromError;if(typeof F=="function"){var N=o.value;f.payload=function(){return F(N)},f.callback=function(){Ol(e,o)}}var $=e.stateNode;return $!==null&&typeof $.componentDidCatch=="function"&&(f.callback=function(){Ol(e,o),typeof F!="function"&&(cn===null?cn=new Set([this]):cn.add(this));var te=o.stack;this.componentDidCatch(o.value,{componentStack:te!==null?te:""})}),f}function $u(e,o,f){var F=e.pingCache;if(F===null){F=e.pingCache=new Gc;var N=new Set;F.set(o,N)}else N=F.get(o),N===void 0&&(N=new Set,F.set(o,N));N.has(f)||(N.add(f),e=rd.bind(null,e,o,f),o.then(e,e))}function qu(e){do{var o;if((o=e.tag===13)&&(o=e.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return e;e=e.return}while(e!==null);return null}function Yu(e,o,f,F,N){return(e.mode&1)===0?(e===o?e.flags|=65536:(e.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(o=ji(-1,1),o.tag=2,ln(f,o,1))),f.lanes|=1),e):(e.flags|=65536,e.lanes=N,e)}var Uc=T.ReactCurrentOwner,Lr=!1;function Fr(e,o,f,F){o.child=e===null?pu(o,null,f,F):ws(o,e.child,f,F)}function Xu(e,o,f,F,N){f=f.render;var $=o.ref;return Cs(o,N),F=Ml(e,o,f,F,$,N),f=Rl(),e!==null&&!Lr?(o.updateQueue=e.updateQueue,o.flags&=-2053,e.lanes&=~N,Vi(e,o,N)):(tt&&f&&Xt(o),o.flags|=1,Fr(e,o,F,N),o.child)}function Ju(e,o,f,F,N){if(e===null){var $=f.type;return typeof $=="function"&&!su($)&&$.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(o.tag=15,o.type=$,Qu(e,o,$,F,N)):(e=Fa(f.type,null,F,o,o.mode,N),e.ref=o.ref,e.return=o,o.child=e)}if($=e.child,(e.lanes&N)===0){var te=$.memoizedProps;if(f=f.compare,f=f!==null?f:zi,f(te,F)&&e.ref===o.ref)return Vi(e,o,N)}return o.flags|=1,e=pn($,F),e.ref=o.ref,e.return=o,o.child=e}function Qu(e,o,f,F,N){if(e!==null){var $=e.memoizedProps;if(zi($,F)&&e.ref===o.ref)if(Lr=!1,o.pendingProps=F=$,(e.lanes&N)!==0)(e.flags&131072)!==0&&(Lr=!0);else return o.lanes=e.lanes,Vi(e,o,N)}return Nl(e,o,f,F,N)}function Ku(e,o,f){var F=o.pendingProps,N=F.children,$=e!==null?e.memoizedState:null;if(F.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ht(Ms,Ur),Ur|=f;else{if((f&1073741824)===0)return e=$!==null?$.baseLanes|f:f,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:e,cachePool:null,transitions:null},o.updateQueue=null,Ht(Ms,Ur),Ur|=e,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},F=$!==null?$.baseLanes:f,Ht(Ms,Ur),Ur|=F}else $!==null?(F=$.baseLanes|f,o.memoizedState=null):F=f,Ht(Ms,Ur),Ur|=F;return Fr(e,o,N,f),o.child}function Zu(e,o){var f=o.ref;(e===null&&f!==null||e!==null&&e.ref!==f)&&(o.flags|=512,o.flags|=2097152)}function Nl(e,o,f,F,N){var $=_r(f)?_i:hr.current;return $=Oi(o,$),Cs(o,N),f=Ml(e,o,f,F,$,N),F=Rl(),e!==null&&!Lr?(o.updateQueue=e.updateQueue,o.flags&=-2053,e.lanes&=~N,Vi(e,o,N)):(tt&&F&&Xt(o),o.flags|=1,Fr(e,o,f,N),o.child)}function ec(e,o,f,F,N){if(_r(f)){var $=!0;In(o)}else $=!1;if(Cs(o,N),o.stateNode===null)ba(e,o),Gu(o,f,F),Il(o,f,F,N),F=!0;else if(e===null){var te=o.stateNode,de=o.memoizedProps;te.props=de;var be=te.context,Ve=f.contextType;typeof Ve=="object"&&Ve!==null?Ve=Yr(Ve):(Ve=_r(f)?_i:hr.current,Ve=Oi(o,Ve));var et=f.getDerivedStateFromProps,it=typeof et=="function"||typeof te.getSnapshotBeforeUpdate=="function";it||typeof te.UNSAFE_componentWillReceiveProps!="function"&&typeof te.componentWillReceiveProps!="function"||(de!==F||be!==Ve)&&Uu(o,te,F,Ve),an=!1;var Ze=o.memoizedState;te.state=Ze,ha(o,F,te,N),be=o.memoizedState,de!==F||Ze!==be||Er.current||an?(typeof et=="function"&&(zl(o,f,et,F),be=o.memoizedState),(de=an||Bu(o,f,de,F,Ze,be,Ve))?(it||typeof te.UNSAFE_componentWillMount!="function"&&typeof te.componentWillMount!="function"||(typeof te.componentWillMount=="function"&&te.componentWillMount(),typeof te.UNSAFE_componentWillMount=="function"&&te.UNSAFE_componentWillMount()),typeof te.componentDidMount=="function"&&(o.flags|=4194308)):(typeof te.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=F,o.memoizedState=be),te.props=F,te.state=be,te.context=Ve,F=de):(typeof te.componentDidMount=="function"&&(o.flags|=4194308),F=!1)}else{te=o.stateNode,gu(e,o),de=o.memoizedProps,Ve=o.type===o.elementType?de:ii(o.type,de),te.props=Ve,it=o.pendingProps,Ze=te.context,be=f.contextType,typeof be=="object"&&be!==null?be=Yr(be):(be=_r(f)?_i:hr.current,be=Oi(o,be));var pt=f.getDerivedStateFromProps;(et=typeof pt=="function"||typeof te.getSnapshotBeforeUpdate=="function")||typeof te.UNSAFE_componentWillReceiveProps!="function"&&typeof te.componentWillReceiveProps!="function"||(de!==it||Ze!==be)&&Uu(o,te,F,be),an=!1,Ze=o.memoizedState,te.state=Ze,ha(o,F,te,N);var gt=o.memoizedState;de!==it||Ze!==gt||Er.current||an?(typeof pt=="function"&&(zl(o,f,pt,F),gt=o.memoizedState),(Ve=an||Bu(o,f,Ve,F,Ze,gt,be)||!1)?(et||typeof te.UNSAFE_componentWillUpdate!="function"&&typeof te.componentWillUpdate!="function"||(typeof te.componentWillUpdate=="function"&&te.componentWillUpdate(F,gt,be),typeof te.UNSAFE_componentWillUpdate=="function"&&te.UNSAFE_componentWillUpdate(F,gt,be)),typeof te.componentDidUpdate=="function"&&(o.flags|=4),typeof te.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof te.componentDidUpdate!="function"||de===e.memoizedProps&&Ze===e.memoizedState||(o.flags|=4),typeof te.getSnapshotBeforeUpdate!="function"||de===e.memoizedProps&&Ze===e.memoizedState||(o.flags|=1024),o.memoizedProps=F,o.memoizedState=gt),te.props=F,te.state=gt,te.context=be,F=Ve):(typeof te.componentDidUpdate!="function"||de===e.memoizedProps&&Ze===e.memoizedState||(o.flags|=4),typeof te.getSnapshotBeforeUpdate!="function"||de===e.memoizedProps&&Ze===e.memoizedState||(o.flags|=1024),F=!1)}return jl(e,o,f,F,$,N)}function jl(e,o,f,F,N,$){Zu(e,o);var te=(o.flags&128)!==0;if(!F&&!te)return N&&vo(o,f,!1),Vi(e,o,$);F=o.stateNode,Uc.current=o;var de=te&&typeof f.getDerivedStateFromError!="function"?null:F.render();return o.flags|=1,e!==null&&te?(o.child=ws(o,e.child,null,$),o.child=ws(o,null,de,$)):Fr(e,o,de,$),o.memoizedState=F.state,N&&vo(o,f,!0),o.child}function tc(e){var o=e.stateNode;o.pendingContext?mo(e,o.pendingContext,o.pendingContext!==o.context):o.context&&mo(e,o.context,!1),wl(e,o.containerInfo)}function rc(e,o,f,F,N){return Ir(),xs(N),o.flags|=256,Fr(e,o,f,F),o.child}var Vl={dehydrated:null,treeContext:null,retryLane:0};function Bl(e){return{baseLanes:e,cachePool:null,transitions:null}}function ic(e,o,f){var F=o.pendingProps,N=Zt.current,$=!1,te=(o.flags&128)!==0,de;if((de=te)||(de=e!==null&&e.memoizedState===null?!1:(N&2)!==0),de?($=!0,o.flags&=-129):(e===null||e.memoizedState!==null)&&(N|=1),Ht(Zt,N&1),e===null)return Bt(o),e=o.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((o.mode&1)===0?o.lanes=1:e.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(te=F.children,e=F.fallback,$?(F=o.mode,$=o.child,te={mode:"hidden",children:te},(F&1)===0&&$!==null?($.childLanes=0,$.pendingProps=te):$=Da(te,F,0,null),e=Un(e,F,f,null),$.return=o,e.return=o,$.sibling=e,o.child=$,o.child.memoizedState=Bl(f),o.memoizedState=Vl,e):Gl(o,te));if(N=e.memoizedState,N!==null&&(de=N.dehydrated,de!==null))return Wc(e,o,te,F,de,N,f);if($){$=F.fallback,te=o.mode,N=e.child,de=N.sibling;var be={mode:"hidden",children:F.children};return(te&1)===0&&o.child!==N?(F=o.child,F.childLanes=0,F.pendingProps=be,o.deletions=null):(F=pn(N,be),F.subtreeFlags=N.subtreeFlags&14680064),de!==null?$=pn(de,$):($=Un($,te,f,null),$.flags|=2),$.return=o,F.return=o,F.sibling=$,o.child=F,F=$,$=o.child,te=e.child.memoizedState,te=te===null?Bl(f):{baseLanes:te.baseLanes|f,cachePool:null,transitions:te.transitions},$.memoizedState=te,$.childLanes=e.childLanes&~f,o.memoizedState=Vl,F}return $=e.child,e=$.sibling,F=pn($,{mode:"visible",children:F.children}),(o.mode&1)===0&&(F.lanes=f),F.return=o,F.sibling=null,e!==null&&(f=o.deletions,f===null?(o.deletions=[e],o.flags|=16):f.push(e)),o.child=F,o.memoizedState=null,F}function Gl(e,o){return o=Da({mode:"visible",children:o},e.mode,0,null),o.return=e,e.child=o}function xa(e,o,f,F){return F!==null&&xs(F),ws(o,e.child,null,f),e=Gl(o,o.pendingProps.children),e.flags|=2,o.memoizedState=null,e}function Wc(e,o,f,F,N,$,te){if(f)return o.flags&256?(o.flags&=-257,F=Ll(Error(r(422))),xa(e,o,te,F)):o.memoizedState!==null?(o.child=e.child,o.flags|=128,null):($=F.fallback,N=o.mode,F=Da({mode:"visible",children:F.children},N,0,null),$=Un($,N,te,null),$.flags|=2,F.return=o,$.return=o,F.sibling=$,o.child=F,(o.mode&1)!==0&&ws(o,e.child,null,te),o.child.memoizedState=Bl(te),o.memoizedState=Vl,$);if((o.mode&1)===0)return xa(e,o,te,null);if(N.data==="$!"){if(F=N.nextSibling&&N.nextSibling.dataset,F)var de=F.dgst;return F=de,$=Error(r(419)),F=Ll($,F,void 0),xa(e,o,te,F)}if(de=(te&e.childLanes)!==0,Lr||de){if(F=mr,F!==null){switch(te&-te){case 4:N=2;break;case 16:N=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:N=32;break;case 536870912:N=268435456;break;default:N=0}N=(N&(F.suspendedLanes|te))!==0?0:N,N!==0&&N!==$.retryLane&&($.retryLane=N,Ni(e,N),oi(F,e,N,-1))}return nu(),F=Ll(Error(r(421))),xa(e,o,te,F)}return N.data==="$?"?(o.flags|=128,o.child=e.child,o=nd.bind(null,e),N._reactRetry=o,null):(e=$.treeContext,xt=$r(N.nextSibling),bt=o,tt=!0,wt=null,e!==null&&(ht[xe++]=Dt,ht[xe++]=nt,ht[xe++]=Pe,Dt=e.id,nt=e.overflow,Pe=o),o=Gl(o,F.children),o.flags|=4096,o)}function nc(e,o,f){e.lanes|=o;var F=e.alternate;F!==null&&(F.lanes|=o),_l(e.return,o,f)}function Ul(e,o,f,F,N){var $=e.memoizedState;$===null?e.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:F,tail:f,tailMode:N}:($.isBackwards=o,$.rendering=null,$.renderingStartTime=0,$.last=F,$.tail=f,$.tailMode=N)}function sc(e,o,f){var F=o.pendingProps,N=F.revealOrder,$=F.tail;if(Fr(e,o,F.children,f),F=Zt.current,(F&2)!==0)F=F&1|2,o.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=o.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&nc(e,f,o);else if(e.tag===19)nc(e,f,o);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===o)break e;for(;e.sibling===null;){if(e.return===null||e.return===o)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}F&=1}if(Ht(Zt,F),(o.mode&1)===0)o.memoizedState=null;else switch(N){case"forwards":for(f=o.child,N=null;f!==null;)e=f.alternate,e!==null&&fa(e)===null&&(N=f),f=f.sibling;f=N,f===null?(N=o.child,o.child=null):(N=f.sibling,f.sibling=null),Ul(o,!1,N,f,$);break;case"backwards":for(f=null,N=o.child,o.child=null;N!==null;){if(e=N.alternate,e!==null&&fa(e)===null){o.child=N;break}e=N.sibling,N.sibling=f,f=N,N=e}Ul(o,!0,f,null,$);break;case"together":Ul(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function ba(e,o){(o.mode&1)===0&&e!==null&&(e.alternate=null,o.alternate=null,o.flags|=2)}function Vi(e,o,f){if(e!==null&&(o.dependencies=e.dependencies),jn|=o.lanes,(f&o.childLanes)===0)return null;if(e!==null&&o.child!==e.child)throw Error(r(153));if(o.child!==null){for(e=o.child,f=pn(e,e.pendingProps),o.child=f,f.return=o;e.sibling!==null;)e=e.sibling,f=f.sibling=pn(e,e.pendingProps),f.return=o;f.sibling=null}return o.child}function Hc(e,o,f){switch(o.tag){case 3:tc(o),Ir();break;case 5:_u(o);break;case 1:_r(o.type)&&In(o);break;case 4:wl(o,o.stateNode.containerInfo);break;case 10:var F=o.type._context,N=o.memoizedProps.value;Ht(ua,F._currentValue),F._currentValue=N;break;case 13:if(F=o.memoizedState,F!==null)return F.dehydrated!==null?(Ht(Zt,Zt.current&1),o.flags|=128,null):(f&o.child.childLanes)!==0?ic(e,o,f):(Ht(Zt,Zt.current&1),e=Vi(e,o,f),e!==null?e.sibling:null);Ht(Zt,Zt.current&1);break;case 19:if(F=(f&o.childLanes)!==0,(e.flags&128)!==0){if(F)return sc(e,o,f);o.flags|=128}if(N=o.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),Ht(Zt,Zt.current),F)break;return null;case 22:case 23:return o.lanes=0,Ku(e,o,f)}return Vi(e,o,f)}var oc,Wl,ac,lc;oc=function(e,o){for(var f=o.child;f!==null;){if(f.tag===5||f.tag===6)e.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===o)break;for(;f.sibling===null;){if(f.return===null||f.return===o)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Wl=function(){},ac=function(e,o,f,F){var N=e.memoizedProps;if(N!==F){e=o.stateNode,On(bi.current);var $=null;switch(f){case"input":N=fe(e,N),F=fe(e,F),$=[];break;case"select":N=X({},N,{value:void 0}),F=X({},F,{value:void 0}),$=[];break;case"textarea":N=Xe(e,N),F=Xe(e,F),$=[];break;default:typeof N.onClick!="function"&&typeof F.onClick=="function"&&(e.onclick=gs)}Me(f,F);var te;f=null;for(Ve in N)if(!F.hasOwnProperty(Ve)&&N.hasOwnProperty(Ve)&&N[Ve]!=null)if(Ve==="style"){var de=N[Ve];for(te in de)de.hasOwnProperty(te)&&(f||(f={}),f[te]="")}else Ve!=="dangerouslySetInnerHTML"&&Ve!=="children"&&Ve!=="suppressContentEditableWarning"&&Ve!=="suppressHydrationWarning"&&Ve!=="autoFocus"&&(v.hasOwnProperty(Ve)?$||($=[]):($=$||[]).push(Ve,null));for(Ve in F){var be=F[Ve];if(de=N?.[Ve],F.hasOwnProperty(Ve)&&be!==de&&(be!=null||de!=null))if(Ve==="style")if(de){for(te in de)!de.hasOwnProperty(te)||be&&be.hasOwnProperty(te)||(f||(f={}),f[te]="");for(te in be)be.hasOwnProperty(te)&&de[te]!==be[te]&&(f||(f={}),f[te]=be[te])}else f||($||($=[]),$.push(Ve,f)),f=be;else Ve==="dangerouslySetInnerHTML"?(be=be?be.__html:void 0,de=de?de.__html:void 0,be!=null&&de!==be&&($=$||[]).push(Ve,be)):Ve==="children"?typeof be!="string"&&typeof be!="number"||($=$||[]).push(Ve,""+be):Ve!=="suppressContentEditableWarning"&&Ve!=="suppressHydrationWarning"&&(v.hasOwnProperty(Ve)?(be!=null&&Ve==="onScroll"&&Ut("scroll",e),$||de===be||($=[])):($=$||[]).push(Ve,be))}f&&($=$||[]).push("style",f);var Ve=$;(o.updateQueue=Ve)&&(o.flags|=4)}},lc=function(e,o,f,F){f!==F&&(o.flags|=4)};function Eo(e,o){if(!tt)switch(e.tailMode){case"hidden":o=e.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?e.tail=null:f.sibling=null;break;case"collapsed":f=e.tail;for(var F=null;f!==null;)f.alternate!==null&&(F=f),f=f.sibling;F===null?o||e.tail===null?e.tail=null:e.tail.sibling=null:F.sibling=null}}function Tr(e){var o=e.alternate!==null&&e.alternate.child===e.child,f=0,F=0;if(o)for(var N=e.child;N!==null;)f|=N.lanes|N.childLanes,F|=N.subtreeFlags&14680064,F|=N.flags&14680064,N.return=e,N=N.sibling;else for(N=e.child;N!==null;)f|=N.lanes|N.childLanes,F|=N.subtreeFlags,F|=N.flags,N.return=e,N=N.sibling;return e.subtreeFlags|=F,e.childLanes=f,o}function $c(e,o,f){var F=o.pendingProps;switch(It(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tr(o),null;case 1:return _r(o.type)&&zn(),Tr(o),null;case 3:return F=o.stateNode,Es(),Yt(Er),Yt(hr),El(),F.pendingContext&&(F.context=F.pendingContext,F.pendingContext=null),(e===null||e.child===null)&&(kt(o)?o.flags|=4:e===null||e.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,wt!==null&&(tu(wt),wt=null))),Wl(e,o),Tr(o),null;case 5:Sl(o);var N=On(xo.current);if(f=o.type,e!==null&&o.stateNode!=null)ac(e,o,f,F,N),e.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!F){if(o.stateNode===null)throw Error(r(166));return Tr(o),null}if(e=On(bi.current),kt(o)){F=o.stateNode,f=o.type;var $=o.memoizedProps;switch(F[Gr]=o,F[Pn]=$,e=(o.mode&1)!==0,f){case"dialog":Ut("cancel",F),Ut("close",F);break;case"iframe":case"object":case"embed":Ut("load",F);break;case"video":case"audio":for(N=0;N<tn.length;N++)Ut(tn[N],F);break;case"source":Ut("error",F);break;case"img":case"image":case"link":Ut("error",F),Ut("load",F);break;case"details":Ut("toggle",F);break;case"input":De(F,$),Ut("invalid",F);break;case"select":F._wrapperState={wasMultiple:!!$.multiple},Ut("invalid",F);break;case"textarea":je(F,$),Ut("invalid",F)}Me(f,$),N=null;for(var te in $)if($.hasOwnProperty(te)){var de=$[te];te==="children"?typeof de=="string"?F.textContent!==de&&($.suppressHydrationWarning!==!0&&ms(F.textContent,de,e),N=["children",de]):typeof de=="number"&&F.textContent!==""+de&&($.suppressHydrationWarning!==!0&&ms(F.textContent,de,e),N=["children",""+de]):v.hasOwnProperty(te)&&de!=null&&te==="onScroll"&&Ut("scroll",F)}switch(f){case"input":Ge(F),st(F,$,!0);break;case"textarea":Ge(F),ft(F);break;case"select":case"option":break;default:typeof $.onClick=="function"&&(F.onclick=gs)}F=N,o.updateQueue=F,F!==null&&(o.flags|=4)}else{te=N.nodeType===9?N:N.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ut(f)),e==="http://www.w3.org/1999/xhtml"?f==="script"?(e=te.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof F.is=="string"?e=te.createElement(f,{is:F.is}):(e=te.createElement(f),f==="select"&&(te=e,F.multiple?te.multiple=!0:F.size&&(te.size=F.size))):e=te.createElementNS(e,f),e[Gr]=o,e[Pn]=F,oc(e,o,!1,!1),o.stateNode=e;e:{switch(te=$e(f,F),f){case"dialog":Ut("cancel",e),Ut("close",e),N=F;break;case"iframe":case"object":case"embed":Ut("load",e),N=F;break;case"video":case"audio":for(N=0;N<tn.length;N++)Ut(tn[N],e);N=F;break;case"source":Ut("error",e),N=F;break;case"img":case"image":case"link":Ut("error",e),Ut("load",e),N=F;break;case"details":Ut("toggle",e),N=F;break;case"input":De(e,F),N=fe(e,F),Ut("invalid",e);break;case"option":N=F;break;case"select":e._wrapperState={wasMultiple:!!F.multiple},N=X({},F,{value:void 0}),Ut("invalid",e);break;case"textarea":je(e,F),N=Xe(e,F),Ut("invalid",e);break;default:N=F}Me(f,N),de=N;for($ in de)if(de.hasOwnProperty($)){var be=de[$];$==="style"?K(e,be):$==="dangerouslySetInnerHTML"?(be=be?be.__html:void 0,be!=null&&oe(e,be)):$==="children"?typeof be=="string"?(f!=="textarea"||be!=="")&&we(e,be):typeof be=="number"&&we(e,""+be):$!=="suppressContentEditableWarning"&&$!=="suppressHydrationWarning"&&$!=="autoFocus"&&(v.hasOwnProperty($)?be!=null&&$==="onScroll"&&Ut("scroll",e):be!=null&&x(e,$,be,te))}switch(f){case"input":Ge(e),st(e,F,!1);break;case"textarea":Ge(e),ft(e);break;case"option":F.value!=null&&e.setAttribute("value",""+ce(F.value));break;case"select":e.multiple=!!F.multiple,$=F.value,$!=null?Je(e,!!F.multiple,$,!1):F.defaultValue!=null&&Je(e,!!F.multiple,F.defaultValue,!0);break;default:typeof N.onClick=="function"&&(e.onclick=gs)}switch(f){case"button":case"input":case"select":case"textarea":F=!!F.autoFocus;break e;case"img":F=!0;break e;default:F=!1}}F&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Tr(o),null;case 6:if(e&&o.stateNode!=null)lc(e,o,e.memoizedProps,F);else{if(typeof F!="string"&&o.stateNode===null)throw Error(r(166));if(f=On(xo.current),On(bi.current),kt(o)){if(F=o.stateNode,f=o.memoizedProps,F[Gr]=o,($=F.nodeValue!==f)&&(e=bt,e!==null))switch(e.tag){case 3:ms(F.nodeValue,f,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ms(F.nodeValue,f,(e.mode&1)!==0)}$&&(o.flags|=4)}else F=(f.nodeType===9?f:f.ownerDocument).createTextNode(F),F[Gr]=o,o.stateNode=F}return Tr(o),null;case 13:if(Yt(Zt),F=o.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(tt&&xt!==null&&(o.mode&1)!==0&&(o.flags&128)===0)fr(),Ir(),o.flags|=98560,$=!1;else if($=kt(o),F!==null&&F.dehydrated!==null){if(e===null){if(!$)throw Error(r(318));if($=o.memoizedState,$=$!==null?$.dehydrated:null,!$)throw Error(r(317));$[Gr]=o}else Ir(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Tr(o),$=!1}else wt!==null&&(tu(wt),wt=null),$=!0;if(!$)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=f,o):(F=F!==null,F!==(e!==null&&e.memoizedState!==null)&&F&&(o.child.flags|=8192,(o.mode&1)!==0&&(e===null||(Zt.current&1)!==0?cr===0&&(cr=3):nu())),o.updateQueue!==null&&(o.flags|=4),Tr(o),null);case 4:return Es(),Wl(e,o),e===null&&Rn(o.stateNode.containerInfo),Tr(o),null;case 10:return yl(o.type._context),Tr(o),null;case 17:return _r(o.type)&&zn(),Tr(o),null;case 19:if(Yt(Zt),$=o.memoizedState,$===null)return Tr(o),null;if(F=(o.flags&128)!==0,te=$.rendering,te===null)if(F)Eo($,!1);else{if(cr!==0||e!==null&&(e.flags&128)!==0)for(e=o.child;e!==null;){if(te=fa(e),te!==null){for(o.flags|=128,Eo($,!1),F=te.updateQueue,F!==null&&(o.updateQueue=F,o.flags|=4),o.subtreeFlags=0,F=f,f=o.child;f!==null;)$=f,e=F,$.flags&=14680066,te=$.alternate,te===null?($.childLanes=0,$.lanes=e,$.child=null,$.subtreeFlags=0,$.memoizedProps=null,$.memoizedState=null,$.updateQueue=null,$.dependencies=null,$.stateNode=null):($.childLanes=te.childLanes,$.lanes=te.lanes,$.child=te.child,$.subtreeFlags=0,$.deletions=null,$.memoizedProps=te.memoizedProps,$.memoizedState=te.memoizedState,$.updateQueue=te.updateQueue,$.type=te.type,e=te.dependencies,$.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),f=f.sibling;return Ht(Zt,Zt.current&1|2),o.child}e=e.sibling}$.tail!==null&&Jt()>Rs&&(o.flags|=128,F=!0,Eo($,!1),o.lanes=4194304)}else{if(!F)if(e=fa(te),e!==null){if(o.flags|=128,F=!0,f=e.updateQueue,f!==null&&(o.updateQueue=f,o.flags|=4),Eo($,!0),$.tail===null&&$.tailMode==="hidden"&&!te.alternate&&!tt)return Tr(o),null}else 2*Jt()-$.renderingStartTime>Rs&&f!==1073741824&&(o.flags|=128,F=!0,Eo($,!1),o.lanes=4194304);$.isBackwards?(te.sibling=o.child,o.child=te):(f=$.last,f!==null?f.sibling=te:o.child=te,$.last=te)}return $.tail!==null?(o=$.tail,$.rendering=o,$.tail=o.sibling,$.renderingStartTime=Jt(),o.sibling=null,f=Zt.current,Ht(Zt,F?f&1|2:f&1),o):(Tr(o),null);case 22:case 23:return iu(),F=o.memoizedState!==null,e!==null&&e.memoizedState!==null!==F&&(o.flags|=8192),F&&(o.mode&1)!==0?(Ur&1073741824)!==0&&(Tr(o),o.subtreeFlags&6&&(o.flags|=8192)):Tr(o),null;case 24:return null;case 25:return null}throw Error(r(156,o.tag))}function qc(e,o){switch(It(o),o.tag){case 1:return _r(o.type)&&zn(),e=o.flags,e&65536?(o.flags=e&-65537|128,o):null;case 3:return Es(),Yt(Er),Yt(hr),El(),e=o.flags,(e&65536)!==0&&(e&128)===0?(o.flags=e&-65537|128,o):null;case 5:return Sl(o),null;case 13:if(Yt(Zt),e=o.memoizedState,e!==null&&e.dehydrated!==null){if(o.alternate===null)throw Error(r(340));Ir()}return e=o.flags,e&65536?(o.flags=e&-65537|128,o):null;case 19:return Yt(Zt),null;case 4:return Es(),null;case 10:return yl(o.type._context),null;case 22:case 23:return iu(),null;case 24:return null;default:return null}}var wa=!1,Mr=!1,Yc=typeof WeakSet=="function"?WeakSet:Set,mt=null;function Ts(e,o){var f=e.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(F){rr(e,o,F)}else f.current=null}function Hl(e,o,f){try{f()}catch(F){rr(e,o,F)}}var uc=!1;function Xc(e,o){if(uo=Xn,e=eo(),as(e)){if("selectionStart"in e)var f={start:e.selectionStart,end:e.selectionEnd};else e:{f=(f=e.ownerDocument)&&f.defaultView||window;var F=f.getSelection&&f.getSelection();if(F&&F.rangeCount!==0){f=F.anchorNode;var N=F.anchorOffset,$=F.focusNode;F=F.focusOffset;try{f.nodeType,$.nodeType}catch{f=null;break e}var te=0,de=-1,be=-1,Ve=0,et=0,it=e,Ze=null;t:for(;;){for(var pt;it!==f||N!==0&&it.nodeType!==3||(de=te+N),it!==$||F!==0&&it.nodeType!==3||(be=te+F),it.nodeType===3&&(te+=it.nodeValue.length),(pt=it.firstChild)!==null;)Ze=it,it=pt;for(;;){if(it===e)break t;if(Ze===f&&++Ve===N&&(de=te),Ze===$&&++et===F&&(be=te),(pt=it.nextSibling)!==null)break;it=Ze,Ze=it.parentNode}it=pt}f=de===-1||be===-1?null:{start:de,end:be}}else f=null}f=f||{start:0,end:0}}else f=null;for(co={focusedElem:e,selectionRange:f},Xn=!1,mt=o;mt!==null;)if(o=mt,e=o.child,(o.subtreeFlags&1028)!==0&&e!==null)e.return=o,mt=e;else for(;mt!==null;){o=mt;try{var gt=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(gt!==null){var vt=gt.memoizedProps,or=gt.memoizedState,Fe=o.stateNode,Ce=Fe.getSnapshotBeforeUpdate(o.elementType===o.type?vt:ii(o.type,vt),or);Fe.__reactInternalSnapshotBeforeUpdate=Ce}break;case 3:var Le=o.stateNode.containerInfo;Le.nodeType===1?Le.textContent="":Le.nodeType===9&&Le.documentElement&&Le.removeChild(Le.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(at){rr(o,o.return,at)}if(e=o.sibling,e!==null){e.return=o.return,mt=e;break}mt=o.return}return gt=uc,uc=!1,gt}function Ao(e,o,f){var F=o.updateQueue;if(F=F!==null?F.lastEffect:null,F!==null){var N=F=F.next;do{if((N.tag&e)===e){var $=N.destroy;N.destroy=void 0,$!==void 0&&Hl(o,f,$)}N=N.next}while(N!==F)}}function Sa(e,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var f=o=o.next;do{if((f.tag&e)===e){var F=f.create;f.destroy=F()}f=f.next}while(f!==o)}}function $l(e){var o=e.ref;if(o!==null){var f=e.stateNode;switch(e.tag){case 5:e=f;break;default:e=f}typeof o=="function"?o(e):o.current=e}}function cc(e){var o=e.alternate;o!==null&&(e.alternate=null,cc(o)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(o=e.stateNode,o!==null&&(delete o[Gr],delete o[Pn],delete o[Fn],delete o[pl],delete o[ml])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function dc(e){return e.tag===5||e.tag===3||e.tag===4}function hc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||dc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ql(e,o,f){var F=e.tag;if(F===5||F===6)e=e.stateNode,o?f.nodeType===8?f.parentNode.insertBefore(e,o):f.insertBefore(e,o):(f.nodeType===8?(o=f.parentNode,o.insertBefore(e,f)):(o=f,o.appendChild(e)),f=f._reactRootContainer,f!=null||o.onclick!==null||(o.onclick=gs));else if(F!==4&&(e=e.child,e!==null))for(ql(e,o,f),e=e.sibling;e!==null;)ql(e,o,f),e=e.sibling}function Yl(e,o,f){var F=e.tag;if(F===5||F===6)e=e.stateNode,o?f.insertBefore(e,o):f.appendChild(e);else if(F!==4&&(e=e.child,e!==null))for(Yl(e,o,f),e=e.sibling;e!==null;)Yl(e,o,f),e=e.sibling}var xr=null,ni=!1;function un(e,o,f){for(f=f.child;f!==null;)fc(e,o,f),f=f.sibling}function fc(e,o,f){if(vr&&typeof vr.onCommitFiberUnmount=="function")try{vr.onCommitFiberUnmount(Hn,f)}catch{}switch(f.tag){case 5:Mr||Ts(f,o);case 6:var F=xr,N=ni;xr=null,un(e,o,f),xr=F,ni=N,xr!==null&&(ni?(e=xr,f=f.stateNode,e.nodeType===8?e.parentNode.removeChild(f):e.removeChild(f)):xr.removeChild(f.stateNode));break;case 18:xr!==null&&(ni?(e=xr,f=f.stateNode,e.nodeType===8?Ii(e.parentNode,f):e.nodeType===1&&Ii(e,f),bn(e)):Ii(xr,f.stateNode));break;case 4:F=xr,N=ni,xr=f.stateNode.containerInfo,ni=!0,un(e,o,f),xr=F,ni=N;break;case 0:case 11:case 14:case 15:if(!Mr&&(F=f.updateQueue,F!==null&&(F=F.lastEffect,F!==null))){N=F=F.next;do{var $=N,te=$.destroy;$=$.tag,te!==void 0&&(($&2)!==0||($&4)!==0)&&Hl(f,o,te),N=N.next}while(N!==F)}un(e,o,f);break;case 1:if(!Mr&&(Ts(f,o),F=f.stateNode,typeof F.componentWillUnmount=="function"))try{F.props=f.memoizedProps,F.state=f.memoizedState,F.componentWillUnmount()}catch(de){rr(f,o,de)}un(e,o,f);break;case 21:un(e,o,f);break;case 22:f.mode&1?(Mr=(F=Mr)||f.memoizedState!==null,un(e,o,f),Mr=F):un(e,o,f);break;default:un(e,o,f)}}function pc(e){var o=e.updateQueue;if(o!==null){e.updateQueue=null;var f=e.stateNode;f===null&&(f=e.stateNode=new Yc),o.forEach(function(F){var N=sd.bind(null,e,F);f.has(F)||(f.add(F),F.then(N,N))})}}function si(e,o){var f=o.deletions;if(f!==null)for(var F=0;F<f.length;F++){var N=f[F];try{var $=e,te=o,de=te;e:for(;de!==null;){switch(de.tag){case 5:xr=de.stateNode,ni=!1;break e;case 3:xr=de.stateNode.containerInfo,ni=!0;break e;case 4:xr=de.stateNode.containerInfo,ni=!0;break e}de=de.return}if(xr===null)throw Error(r(160));fc($,te,N),xr=null,ni=!1;var be=N.alternate;be!==null&&(be.return=null),N.return=null}catch(Ve){rr(N,o,Ve)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)mc(o,e),o=o.sibling}function mc(e,o){var f=e.alternate,F=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(si(o,e),Si(e),F&4){try{Ao(3,e,e.return),Sa(3,e)}catch(vt){rr(e,e.return,vt)}try{Ao(5,e,e.return)}catch(vt){rr(e,e.return,vt)}}break;case 1:si(o,e),Si(e),F&512&&f!==null&&Ts(f,f.return);break;case 5:if(si(o,e),Si(e),F&512&&f!==null&&Ts(f,f.return),e.flags&32){var N=e.stateNode;try{we(N,"")}catch(vt){rr(e,e.return,vt)}}if(F&4&&(N=e.stateNode,N!=null)){var $=e.memoizedProps,te=f!==null?f.memoizedProps:$,de=e.type,be=e.updateQueue;if(e.updateQueue=null,be!==null)try{de==="input"&&$.type==="radio"&&$.name!=null&&qe(N,$),$e(de,te);var Ve=$e(de,$);for(te=0;te<be.length;te+=2){var et=be[te],it=be[te+1];et==="style"?K(N,it):et==="dangerouslySetInnerHTML"?oe(N,it):et==="children"?we(N,it):x(N,et,it,Ve)}switch(de){case"input":Qe(N,$);break;case"textarea":Ue(N,$);break;case"select":var Ze=N._wrapperState.wasMultiple;N._wrapperState.wasMultiple=!!$.multiple;var pt=$.value;pt!=null?Je(N,!!$.multiple,pt,!1):Ze!==!!$.multiple&&($.defaultValue!=null?Je(N,!!$.multiple,$.defaultValue,!0):Je(N,!!$.multiple,$.multiple?[]:"",!1))}N[Pn]=$}catch(vt){rr(e,e.return,vt)}}break;case 6:if(si(o,e),Si(e),F&4){if(e.stateNode===null)throw Error(r(162));N=e.stateNode,$=e.memoizedProps;try{N.nodeValue=$}catch(vt){rr(e,e.return,vt)}}break;case 3:if(si(o,e),Si(e),F&4&&f!==null&&f.memoizedState.isDehydrated)try{bn(o.containerInfo)}catch(vt){rr(e,e.return,vt)}break;case 4:si(o,e),Si(e);break;case 13:si(o,e),Si(e),N=e.child,N.flags&8192&&($=N.memoizedState!==null,N.stateNode.isHidden=$,!$||N.alternate!==null&&N.alternate.memoizedState!==null||(Ql=Jt())),F&4&&pc(e);break;case 22:if(et=f!==null&&f.memoizedState!==null,e.mode&1?(Mr=(Ve=Mr)||et,si(o,e),Mr=Ve):si(o,e),Si(e),F&8192){if(Ve=e.memoizedState!==null,(e.stateNode.isHidden=Ve)&&!et&&(e.mode&1)!==0)for(mt=e,et=e.child;et!==null;){for(it=mt=et;mt!==null;){switch(Ze=mt,pt=Ze.child,Ze.tag){case 0:case 11:case 14:case 15:Ao(4,Ze,Ze.return);break;case 1:Ts(Ze,Ze.return);var gt=Ze.stateNode;if(typeof gt.componentWillUnmount=="function"){F=Ze,f=Ze.return;try{o=F,gt.props=o.memoizedProps,gt.state=o.memoizedState,gt.componentWillUnmount()}catch(vt){rr(F,f,vt)}}break;case 5:Ts(Ze,Ze.return);break;case 22:if(Ze.memoizedState!==null){yc(it);continue}}pt!==null?(pt.return=Ze,mt=pt):yc(it)}et=et.sibling}e:for(et=null,it=e;;){if(it.tag===5){if(et===null){et=it;try{N=it.stateNode,Ve?($=N.style,typeof $.setProperty=="function"?$.setProperty("display","none","important"):$.display="none"):(de=it.stateNode,be=it.memoizedProps.style,te=be!=null&&be.hasOwnProperty("display")?be.display:null,de.style.display=Be("display",te))}catch(vt){rr(e,e.return,vt)}}}else if(it.tag===6){if(et===null)try{it.stateNode.nodeValue=Ve?"":it.memoizedProps}catch(vt){rr(e,e.return,vt)}}else if((it.tag!==22&&it.tag!==23||it.memoizedState===null||it===e)&&it.child!==null){it.child.return=it,it=it.child;continue}if(it===e)break e;for(;it.sibling===null;){if(it.return===null||it.return===e)break e;et===it&&(et=null),it=it.return}et===it&&(et=null),it.sibling.return=it.return,it=it.sibling}}break;case 19:si(o,e),Si(e),F&4&&pc(e);break;case 21:break;default:si(o,e),Si(e)}}function Si(e){var o=e.flags;if(o&2){try{e:{for(var f=e.return;f!==null;){if(dc(f)){var F=f;break e}f=f.return}throw Error(r(160))}switch(F.tag){case 5:var N=F.stateNode;F.flags&32&&(we(N,""),F.flags&=-33);var $=hc(e);Yl(e,$,N);break;case 3:case 4:var te=F.stateNode.containerInfo,de=hc(e);ql(e,de,te);break;default:throw Error(r(161))}}catch(be){rr(e,e.return,be)}e.flags&=-3}o&4096&&(e.flags&=-4097)}function Jc(e,o,f){mt=e,gc(e)}function gc(e,o,f){for(var F=(e.mode&1)!==0;mt!==null;){var N=mt,$=N.child;if(N.tag===22&&F){var te=N.memoizedState!==null||wa;if(!te){var de=N.alternate,be=de!==null&&de.memoizedState!==null||Mr;de=wa;var Ve=Mr;if(wa=te,(Mr=be)&&!Ve)for(mt=N;mt!==null;)te=mt,be=te.child,te.tag===22&&te.memoizedState!==null?_c(N):be!==null?(be.return=te,mt=be):_c(N);for(;$!==null;)mt=$,gc($),$=$.sibling;mt=N,wa=de,Mr=Ve}vc(e)}else(N.subtreeFlags&8772)!==0&&$!==null?($.return=N,mt=$):vc(e)}}function vc(e){for(;mt!==null;){var o=mt;if((o.flags&8772)!==0){var f=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Mr||Sa(5,o);break;case 1:var F=o.stateNode;if(o.flags&4&&!Mr)if(f===null)F.componentDidMount();else{var N=o.elementType===o.type?f.memoizedProps:ii(o.type,f.memoizedProps);F.componentDidUpdate(N,f.memoizedState,F.__reactInternalSnapshotBeforeUpdate)}var $=o.updateQueue;$!==null&&yu(o,$,F);break;case 3:var te=o.updateQueue;if(te!==null){if(f=null,o.child!==null)switch(o.child.tag){case 5:f=o.child.stateNode;break;case 1:f=o.child.stateNode}yu(o,te,f)}break;case 5:var de=o.stateNode;if(f===null&&o.flags&4){f=de;var be=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":be.autoFocus&&f.focus();break;case"img":be.src&&(f.src=be.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Ve=o.alternate;if(Ve!==null){var et=Ve.memoizedState;if(et!==null){var it=et.dehydrated;it!==null&&bn(it)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Mr||o.flags&512&&$l(o)}catch(Ze){rr(o,o.return,Ze)}}if(o===e){mt=null;break}if(f=o.sibling,f!==null){f.return=o.return,mt=f;break}mt=o.return}}function yc(e){for(;mt!==null;){var o=mt;if(o===e){mt=null;break}var f=o.sibling;if(f!==null){f.return=o.return,mt=f;break}mt=o.return}}function _c(e){for(;mt!==null;){var o=mt;try{switch(o.tag){case 0:case 11:case 15:var f=o.return;try{Sa(4,o)}catch(be){rr(o,f,be)}break;case 1:var F=o.stateNode;if(typeof F.componentDidMount=="function"){var N=o.return;try{F.componentDidMount()}catch(be){rr(o,N,be)}}var $=o.return;try{$l(o)}catch(be){rr(o,$,be)}break;case 5:var te=o.return;try{$l(o)}catch(be){rr(o,te,be)}}}catch(be){rr(o,o.return,be)}if(o===e){mt=null;break}var de=o.sibling;if(de!==null){de.return=o.return,mt=de;break}mt=o.return}}var Qc=Math.ceil,Ca=T.ReactCurrentDispatcher,Xl=T.ReactCurrentOwner,Jr=T.ReactCurrentBatchConfig,jt=0,mr=null,ar=null,br=0,Ur=0,Ms=vi(0),cr=0,To=null,jn=0,Ea=0,Jl=0,Mo=null,Or=null,Ql=0,Rs=1/0,Bi=null,Aa=!1,Kl=null,cn=null,Ta=!1,dn=null,Ma=0,Ro=0,Zl=null,Ra=-1,ka=0;function Dr(){return(jt&6)!==0?Jt():Ra!==-1?Ra:Ra=Jt()}function hn(e){return(e.mode&1)===0?1:(jt&2)!==0&&br!==0?br&-br:bs.transition!==null?(ka===0&&(ka=ci()),ka):(e=Rt,e!==0||(e=window.event,e=e===void 0?16:Io(e.type)),e)}function oi(e,o,f,F){if(50<Ro)throw Ro=0,Zl=null,Error(r(185));zr(e,f,F),((jt&2)===0||e!==mr)&&(e===mr&&((jt&2)===0&&(Ea|=f),cr===4&&fn(e,br)),Nr(e,F),f===1&&jt===0&&(o.mode&1)===0&&(Rs=Jt()+500,_s&&ne()))}function Nr(e,o){var f=e.callbackNode;Ui(e,o);var F=Zr(e,e===mr?br:0);if(F===0)f!==null&&vn(f),e.callbackNode=null,e.callbackPriority=0;else if(o=F&-F,e.callbackPriority!==o){if(f!=null&&vn(f),o===1)e.tag===0?I(bc.bind(null,e)):Q(bc.bind(null,e)),hl(function(){(jt&6)===0&&ne()}),f=null;else{switch(Sr(F)){case 1:f=Ei;break;case 4:f=Po;break;case 16:f=Ft;break;case 536870912:f=Vr;break;default:f=Ft}f=Rc(f,xc.bind(null,e))}e.callbackPriority=o,e.callbackNode=f}}function xc(e,o){if(Ra=-1,ka=0,(jt&6)!==0)throw Error(r(327));var f=e.callbackNode;if(ks()&&e.callbackNode!==f)return null;var F=Zr(e,e===mr?br:0);if(F===0)return null;if((F&30)!==0||(F&e.expiredLanes)!==0||o)o=Pa(e,F);else{o=F;var N=jt;jt|=2;var $=Sc();(mr!==e||br!==o)&&(Bi=null,Rs=Jt()+500,Bn(e,o));do try{ed();break}catch(de){wc(e,de)}while(!0);vl(),Ca.current=$,jt=N,ar!==null?o=0:(mr=null,br=0,o=cr)}if(o!==0){if(o===2&&(N=Is(e),N!==0&&(F=N,o=eu(e,N))),o===1)throw f=To,Bn(e,0),fn(e,F),Nr(e,Jt()),f;if(o===6)fn(e,F);else{if(N=e.current.alternate,(F&30)===0&&!Kc(N)&&(o=Pa(e,F),o===2&&($=Is(e),$!==0&&(F=$,o=eu(e,$))),o===1))throw f=To,Bn(e,0),fn(e,F),Nr(e,Jt()),f;switch(e.finishedWork=N,e.finishedLanes=F,o){case 0:case 1:throw Error(r(345));case 2:Gn(e,Or,Bi);break;case 3:if(fn(e,F),(F&130023424)===F&&(o=Ql+500-Jt(),10<o)){if(Zr(e,0)!==0)break;if(N=e.suspendedLanes,(N&F)!==F){Dr(),e.pingedLanes|=e.suspendedLanes&N;break}e.timeoutHandle=ho(Gn.bind(null,e,Or,Bi),o);break}Gn(e,Or,Bi);break;case 4:if(fn(e,F),(F&4194240)===F)break;for(o=e.eventTimes,N=-1;0<F;){var te=31-Rr(F);$=1<<te,te=o[te],te>N&&(N=te),F&=~$}if(F=N,F=Jt()-F,F=(120>F?120:480>F?480:1080>F?1080:1920>F?1920:3e3>F?3e3:4320>F?4320:1960*Qc(F/1960))-F,10<F){e.timeoutHandle=ho(Gn.bind(null,e,Or,Bi),F);break}Gn(e,Or,Bi);break;case 5:Gn(e,Or,Bi);break;default:throw Error(r(329))}}}return Nr(e,Jt()),e.callbackNode===f?xc.bind(null,e):null}function eu(e,o){var f=Mo;return e.current.memoizedState.isDehydrated&&(Bn(e,o).flags|=256),e=Pa(e,o),e!==2&&(o=Or,Or=f,o!==null&&tu(o)),e}function tu(e){Or===null?Or=e:Or.push.apply(Or,e)}function Kc(e){for(var o=e;;){if(o.flags&16384){var f=o.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var F=0;F<f.length;F++){var N=f[F],$=N.getSnapshot;N=N.value;try{if(!sr($(),N))return!1}catch{return!1}}}if(f=o.child,o.subtreeFlags&16384&&f!==null)f.return=o,o=f;else{if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function fn(e,o){for(o&=~Jl,o&=~Ea,e.suspendedLanes|=o,e.pingedLanes&=~o,e=e.expirationTimes;0<o;){var f=31-Rr(o),F=1<<f;e[f]=-1,o&=~F}}function bc(e){if((jt&6)!==0)throw Error(r(327));ks();var o=Zr(e,0);if((o&1)===0)return Nr(e,Jt()),null;var f=Pa(e,o);if(e.tag!==0&&f===2){var F=Is(e);F!==0&&(o=F,f=eu(e,F))}if(f===1)throw f=To,Bn(e,0),fn(e,o),Nr(e,Jt()),f;if(f===6)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=o,Gn(e,Or,Bi),Nr(e,Jt()),null}function ru(e,o){var f=jt;jt|=1;try{return e(o)}finally{jt=f,jt===0&&(Rs=Jt()+500,_s&&ne())}}function Vn(e){dn!==null&&dn.tag===0&&(jt&6)===0&&ks();var o=jt;jt|=1;var f=Jr.transition,F=Rt;try{if(Jr.transition=null,Rt=1,e)return e()}finally{Rt=F,Jr.transition=f,jt=o,(jt&6)===0&&ne()}}function iu(){Ur=Ms.current,Yt(Ms)}function Bn(e,o){e.finishedWork=null,e.finishedLanes=0;var f=e.timeoutHandle;if(f!==-1&&(e.timeoutHandle=-1,dl(f)),ar!==null)for(f=ar.return;f!==null;){var F=f;switch(It(F),F.tag){case 1:F=F.type.childContextTypes,F!=null&&zn();break;case 3:Es(),Yt(Er),Yt(hr),El();break;case 5:Sl(F);break;case 4:Es();break;case 13:Yt(Zt);break;case 19:Yt(Zt);break;case 10:yl(F.type._context);break;case 22:case 23:iu()}f=f.return}if(mr=e,ar=e=pn(e.current,null),br=Ur=o,cr=0,To=null,Jl=Ea=jn=0,Or=Mo=null,Ln!==null){for(o=0;o<Ln.length;o++)if(f=Ln[o],F=f.interleaved,F!==null){f.interleaved=null;var N=F.next,$=f.pending;if($!==null){var te=$.next;$.next=N,F.next=te}f.pending=F}Ln=null}return e}function wc(e,o){do{var f=ar;try{if(vl(),pa.current=ya,ma){for(var F=er.memoizedState;F!==null;){var N=F.queue;N!==null&&(N.pending=null),F=F.next}ma=!1}if(Nn=0,pr=ur=er=null,bo=!1,wo=0,Xl.current=null,f===null||f.return===null){cr=1,To=o,ar=null;break}e:{var $=e,te=f.return,de=f,be=o;if(o=br,de.flags|=32768,be!==null&&typeof be=="object"&&typeof be.then=="function"){var Ve=be,et=de,it=et.tag;if((et.mode&1)===0&&(it===0||it===11||it===15)){var Ze=et.alternate;Ze?(et.updateQueue=Ze.updateQueue,et.memoizedState=Ze.memoizedState,et.lanes=Ze.lanes):(et.updateQueue=null,et.memoizedState=null)}var pt=qu(te);if(pt!==null){pt.flags&=-257,Yu(pt,te,de,$,o),pt.mode&1&&$u($,Ve,o),o=pt,be=Ve;var gt=o.updateQueue;if(gt===null){var vt=new Set;vt.add(be),o.updateQueue=vt}else gt.add(be);break e}else{if((o&1)===0){$u($,Ve,o),nu();break e}be=Error(r(426))}}else if(tt&&de.mode&1){var or=qu(te);if(or!==null){(or.flags&65536)===0&&(or.flags|=256),Yu(or,te,de,$,o),xs(As(be,de));break e}}$=be=As(be,de),cr!==4&&(cr=2),Mo===null?Mo=[$]:Mo.push($),$=te;do{switch($.tag){case 3:$.flags|=65536,o&=-o,$.lanes|=o;var Fe=Wu($,be,o);vu($,Fe);break e;case 1:de=be;var Ce=$.type,Le=$.stateNode;if(($.flags&128)===0&&(typeof Ce.getDerivedStateFromError=="function"||Le!==null&&typeof Le.componentDidCatch=="function"&&(cn===null||!cn.has(Le)))){$.flags|=65536,o&=-o,$.lanes|=o;var at=Hu($,de,o);vu($,at);break e}}$=$.return}while($!==null)}Ec(f)}catch(_t){o=_t,ar===f&&f!==null&&(ar=f=f.return);continue}break}while(!0)}function Sc(){var e=Ca.current;return Ca.current=ya,e===null?ya:e}function nu(){(cr===0||cr===3||cr===2)&&(cr=4),mr===null||(jn&268435455)===0&&(Ea&268435455)===0||fn(mr,br)}function Pa(e,o){var f=jt;jt|=2;var F=Sc();(mr!==e||br!==o)&&(Bi=null,Bn(e,o));do try{Zc();break}catch(N){wc(e,N)}while(!0);if(vl(),jt=f,Ca.current=F,ar!==null)throw Error(r(261));return mr=null,br=0,cr}function Zc(){for(;ar!==null;)Cc(ar)}function ed(){for(;ar!==null&&!Wn();)Cc(ar)}function Cc(e){var o=Mc(e.alternate,e,Ur);e.memoizedProps=e.pendingProps,o===null?Ec(e):ar=o,Xl.current=null}function Ec(e){var o=e;do{var f=o.alternate;if(e=o.return,(o.flags&32768)===0){if(f=$c(f,o,Ur),f!==null){ar=f;return}}else{if(f=qc(f,o),f!==null){f.flags&=32767,ar=f;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{cr=6,ar=null;return}}if(o=o.sibling,o!==null){ar=o;return}ar=o=e}while(o!==null);cr===0&&(cr=5)}function Gn(e,o,f){var F=Rt,N=Jr.transition;try{Jr.transition=null,Rt=1,td(e,o,f,F)}finally{Jr.transition=N,Rt=F}return null}function td(e,o,f,F){do ks();while(dn!==null);if((jt&6)!==0)throw Error(r(327));f=e.finishedWork;var N=e.finishedLanes;if(f===null)return null;if(e.finishedWork=null,e.finishedLanes=0,f===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var $=f.lanes|f.childLanes;if(Va(e,$),e===mr&&(ar=mr=null,br=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||Ta||(Ta=!0,Rc(Ft,function(){return ks(),null})),$=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||$){$=Jr.transition,Jr.transition=null;var te=Rt;Rt=1;var de=jt;jt|=4,Xl.current=null,Xc(e,f),mc(f,e),Zo(co),Xn=!!uo,co=uo=null,e.current=f,Jc(f),Gi(),jt=de,Rt=te,Jr.transition=$}else e.current=f;if(Ta&&(Ta=!1,dn=e,Ma=N),$=e.pendingLanes,$===0&&(cn=null),Ps(f.stateNode),Nr(e,Jt()),o!==null)for(F=e.onRecoverableError,f=0;f<o.length;f++)N=o[f],F(N.value,{componentStack:N.stack,digest:N.digest});if(Aa)throw Aa=!1,e=Kl,Kl=null,e;return(Ma&1)!==0&&e.tag!==0&&ks(),$=e.pendingLanes,($&1)!==0?e===Zl?Ro++:(Ro=0,Zl=e):Ro=0,ne(),null}function ks(){if(dn!==null){var e=Sr(Ma),o=Jr.transition,f=Rt;try{if(Jr.transition=null,Rt=16>e?16:e,dn===null)var F=!1;else{if(e=dn,dn=null,Ma=0,(jt&6)!==0)throw Error(r(331));var N=jt;for(jt|=4,mt=e.current;mt!==null;){var $=mt,te=$.child;if((mt.flags&16)!==0){var de=$.deletions;if(de!==null){for(var be=0;be<de.length;be++){var Ve=de[be];for(mt=Ve;mt!==null;){var et=mt;switch(et.tag){case 0:case 11:case 15:Ao(8,et,$)}var it=et.child;if(it!==null)it.return=et,mt=it;else for(;mt!==null;){et=mt;var Ze=et.sibling,pt=et.return;if(cc(et),et===Ve){mt=null;break}if(Ze!==null){Ze.return=pt,mt=Ze;break}mt=pt}}}var gt=$.alternate;if(gt!==null){var vt=gt.child;if(vt!==null){gt.child=null;do{var or=vt.sibling;vt.sibling=null,vt=or}while(vt!==null)}}mt=$}}if(($.subtreeFlags&2064)!==0&&te!==null)te.return=$,mt=te;else e:for(;mt!==null;){if($=mt,($.flags&2048)!==0)switch($.tag){case 0:case 11:case 15:Ao(9,$,$.return)}var Fe=$.sibling;if(Fe!==null){Fe.return=$.return,mt=Fe;break e}mt=$.return}}var Ce=e.current;for(mt=Ce;mt!==null;){te=mt;var Le=te.child;if((te.subtreeFlags&2064)!==0&&Le!==null)Le.return=te,mt=Le;else e:for(te=Ce;mt!==null;){if(de=mt,(de.flags&2048)!==0)try{switch(de.tag){case 0:case 11:case 15:Sa(9,de)}}catch(_t){rr(de,de.return,_t)}if(de===te){mt=null;break e}var at=de.sibling;if(at!==null){at.return=de.return,mt=at;break e}mt=de.return}}if(jt=N,ne(),vr&&typeof vr.onPostCommitFiberRoot=="function")try{vr.onPostCommitFiberRoot(Hn,e)}catch{}F=!0}return F}finally{Rt=f,Jr.transition=o}}return!1}function Ac(e,o,f){o=As(f,o),o=Wu(e,o,1),e=ln(e,o,1),o=Dr(),e!==null&&(zr(e,1,o),Nr(e,o))}function rr(e,o,f){if(e.tag===3)Ac(e,e,f);else for(;o!==null;){if(o.tag===3){Ac(o,e,f);break}else if(o.tag===1){var F=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof F.componentDidCatch=="function"&&(cn===null||!cn.has(F))){e=As(f,e),e=Hu(o,e,1),o=ln(o,e,1),e=Dr(),o!==null&&(zr(o,1,e),Nr(o,e));break}}o=o.return}}function rd(e,o,f){var F=e.pingCache;F!==null&&F.delete(o),o=Dr(),e.pingedLanes|=e.suspendedLanes&f,mr===e&&(br&f)===f&&(cr===4||cr===3&&(br&130023424)===br&&500>Jt()-Ql?Bn(e,0):Jl|=f),Nr(e,o)}function Tc(e,o){o===0&&((e.mode&1)===0?o=1:(o=ui,ui<<=1,(ui&130023424)===0&&(ui=4194304)));var f=Dr();e=Ni(e,o),e!==null&&(zr(e,o,f),Nr(e,f))}function nd(e){var o=e.memoizedState,f=0;o!==null&&(f=o.retryLane),Tc(e,f)}function sd(e,o){var f=0;switch(e.tag){case 13:var F=e.stateNode,N=e.memoizedState;N!==null&&(f=N.retryLane);break;case 19:F=e.stateNode;break;default:throw Error(r(314))}F!==null&&F.delete(o),Tc(e,f)}var Mc;Mc=function(e,o,f){if(e!==null)if(e.memoizedProps!==o.pendingProps||Er.current)Lr=!0;else{if((e.lanes&f)===0&&(o.flags&128)===0)return Lr=!1,Hc(e,o,f);Lr=(e.flags&131072)!==0}else Lr=!1,tt&&(o.flags&1048576)!==0&&$t(o,Ae,o.index);switch(o.lanes=0,o.tag){case 2:var F=o.type;ba(e,o),e=o.pendingProps;var N=Oi(o,hr.current);Cs(o,f),N=Ml(null,o,F,e,N,f);var $=Rl();return o.flags|=1,typeof N=="object"&&N!==null&&typeof N.render=="function"&&N.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,_r(F)?($=!0,In(o)):$=!1,o.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,bl(o),N.updater=_a,o.stateNode=N,N._reactInternals=o,Il(o,F,e,f),o=jl(null,o,F,!0,$,f)):(o.tag=0,tt&&$&&Xt(o),Fr(null,o,N,f),o=o.child),o;case 16:F=o.elementType;e:{switch(ba(e,o),e=o.pendingProps,N=F._init,F=N(F._payload),o.type=F,N=o.tag=ad(F),e=ii(F,e),N){case 0:o=Nl(null,o,F,e,f);break e;case 1:o=ec(null,o,F,e,f);break e;case 11:o=Xu(null,o,F,e,f);break e;case 14:o=Ju(null,o,F,ii(F.type,e),f);break e}throw Error(r(306,F,""))}return o;case 0:return F=o.type,N=o.pendingProps,N=o.elementType===F?N:ii(F,N),Nl(e,o,F,N,f);case 1:return F=o.type,N=o.pendingProps,N=o.elementType===F?N:ii(F,N),ec(e,o,F,N,f);case 3:e:{if(tc(o),e===null)throw Error(r(387));F=o.pendingProps,$=o.memoizedState,N=$.element,gu(e,o),ha(o,F,null,f);var te=o.memoizedState;if(F=te.element,$.isDehydrated)if($={element:F,isDehydrated:!1,cache:te.cache,pendingSuspenseBoundaries:te.pendingSuspenseBoundaries,transitions:te.transitions},o.updateQueue.baseState=$,o.memoizedState=$,o.flags&256){N=As(Error(r(423)),o),o=rc(e,o,F,f,N);break e}else if(F!==N){N=As(Error(r(424)),o),o=rc(e,o,F,f,N);break e}else for(xt=$r(o.stateNode.containerInfo.firstChild),bt=o,tt=!0,wt=null,f=pu(o,null,F,f),o.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Ir(),F===N){o=Vi(e,o,f);break e}Fr(e,o,F,f)}o=o.child}return o;case 5:return _u(o),e===null&&Bt(o),F=o.type,N=o.pendingProps,$=e!==null?e.memoizedProps:null,te=N.children,Br(F,N)?te=null:$!==null&&Br(F,$)&&(o.flags|=32),Zu(e,o),Fr(e,o,te,f),o.child;case 6:return e===null&&Bt(o),null;case 13:return ic(e,o,f);case 4:return wl(o,o.stateNode.containerInfo),F=o.pendingProps,e===null?o.child=ws(o,null,F,f):Fr(e,o,F,f),o.child;case 11:return F=o.type,N=o.pendingProps,N=o.elementType===F?N:ii(F,N),Xu(e,o,F,N,f);case 7:return Fr(e,o,o.pendingProps,f),o.child;case 8:return Fr(e,o,o.pendingProps.children,f),o.child;case 12:return Fr(e,o,o.pendingProps.children,f),o.child;case 10:e:{if(F=o.type._context,N=o.pendingProps,$=o.memoizedProps,te=N.value,Ht(ua,F._currentValue),F._currentValue=te,$!==null)if(sr($.value,te)){if($.children===N.children&&!Er.current){o=Vi(e,o,f);break e}}else for($=o.child,$!==null&&($.return=o);$!==null;){var de=$.dependencies;if(de!==null){te=$.child;for(var be=de.firstContext;be!==null;){if(be.context===F){if($.tag===1){be=ji(-1,f&-f),be.tag=2;var Ve=$.updateQueue;if(Ve!==null){Ve=Ve.shared;var et=Ve.pending;et===null?be.next=be:(be.next=et.next,et.next=be),Ve.pending=be}}$.lanes|=f,be=$.alternate,be!==null&&(be.lanes|=f),_l($.return,f,o),de.lanes|=f;break}be=be.next}}else if($.tag===10)te=$.type===o.type?null:$.child;else if($.tag===18){if(te=$.return,te===null)throw Error(r(341));te.lanes|=f,de=te.alternate,de!==null&&(de.lanes|=f),_l(te,f,o),te=$.sibling}else te=$.child;if(te!==null)te.return=$;else for(te=$;te!==null;){if(te===o){te=null;break}if($=te.sibling,$!==null){$.return=te.return,te=$;break}te=te.return}$=te}Fr(e,o,N.children,f),o=o.child}return o;case 9:return N=o.type,F=o.pendingProps.children,Cs(o,f),N=Yr(N),F=F(N),o.flags|=1,Fr(e,o,F,f),o.child;case 14:return F=o.type,N=ii(F,o.pendingProps),N=ii(F.type,N),Ju(e,o,F,N,f);case 15:return Qu(e,o,o.type,o.pendingProps,f);case 17:return F=o.type,N=o.pendingProps,N=o.elementType===F?N:ii(F,N),ba(e,o),o.tag=1,_r(F)?(e=!0,In(o)):e=!1,Cs(o,f),Gu(o,F,N),Il(o,F,N,f),jl(null,o,F,!0,e,f);case 19:return sc(e,o,f);case 22:return Ku(e,o,f)}throw Error(r(156,o.tag))};function Rc(e,o){return gn(e,o)}function od(e,o,f,F){this.tag=e,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=F,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qr(e,o,f,F){return new od(e,o,f,F)}function su(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ad(e){if(typeof e=="function")return su(e)?1:0;if(e!=null){if(e=e.$$typeof,e===V)return 11;if(e===H)return 14}return 2}function pn(e,o){var f=e.alternate;return f===null?(f=Qr(e.tag,o,e.key,e.mode),f.elementType=e.elementType,f.type=e.type,f.stateNode=e.stateNode,f.alternate=e,e.alternate=f):(f.pendingProps=o,f.type=e.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=e.flags&14680064,f.childLanes=e.childLanes,f.lanes=e.lanes,f.child=e.child,f.memoizedProps=e.memoizedProps,f.memoizedState=e.memoizedState,f.updateQueue=e.updateQueue,o=e.dependencies,f.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},f.sibling=e.sibling,f.index=e.index,f.ref=e.ref,f}function Fa(e,o,f,F,N,$){var te=2;if(F=e,typeof e=="function")su(e)&&(te=1);else if(typeof e=="string")te=5;else e:switch(e){case C:return Un(f.children,N,$,o);case E:te=8,N|=8;break;case D:return e=Qr(12,f,o,N|2),e.elementType=D,e.lanes=$,e;case O:return e=Qr(13,f,o,N),e.elementType=O,e.lanes=$,e;case W:return e=Qr(19,f,o,N),e.elementType=W,e.lanes=$,e;case U:return Da(f,N,$,o);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case z:te=10;break e;case L:te=9;break e;case V:te=11;break e;case H:te=14;break e;case q:te=16,F=null;break e}throw Error(r(130,e==null?e:typeof e,""))}return o=Qr(te,f,o,N),o.elementType=e,o.type=F,o.lanes=$,o}function Un(e,o,f,F){return e=Qr(7,e,F,o),e.lanes=f,e}function Da(e,o,f,F){return e=Qr(22,e,F,o),e.elementType=U,e.lanes=f,e.stateNode={isHidden:!1},e}function ou(e,o,f){return e=Qr(6,e,null,o),e.lanes=f,e}function au(e,o,f){return o=Qr(4,e.children!==null?e.children:[],e.key,o),o.lanes=f,o.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},o}function ld(e,o,f,F,N){this.tag=o,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$n(0),this.expirationTimes=$n(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$n(0),this.identifierPrefix=F,this.onRecoverableError=N,this.mutableSourceEagerHydrationData=null}function lu(e,o,f,F,N,$,te,de,be){return e=new ld(e,o,f,de,be),o===1?(o=1,$===!0&&(o|=8)):o=0,$=Qr(3,null,null,o),e.current=$,$.stateNode=e,$.memoizedState={element:F,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},bl($),e}function ud(e,o,f){var F=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:F==null?null:""+F,children:e,containerInfo:o,implementation:f}}function kc(e){if(!e)return yi;e=e._reactInternals;e:{if(Lt(e)!==e||e.tag!==1)throw Error(r(170));var o=e;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(_r(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(r(171))}if(e.tag===1){var f=e.type;if(_r(f))return go(e,f,o)}return o}function Pc(e,o,f,F,N,$,te,de,be){return e=lu(f,F,!0,e,N,$,te,de,be),e.context=kc(null),f=e.current,F=Dr(),N=hn(f),$=ji(F,N),$.callback=o??null,ln(f,$,N),e.current.lanes=N,zr(e,N,F),Nr(e,F),e}function za(e,o,f,F){var N=o.current,$=Dr(),te=hn(N);return f=kc(f),o.context===null?o.context=f:o.pendingContext=f,o=ji($,te),o.payload={element:e},F=F===void 0?null:F,F!==null&&(o.callback=F),e=ln(N,o,te),e!==null&&(oi(e,N,te,$),da(e,N,te)),te}function Ia(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Fc(e,o){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var f=e.retryLane;e.retryLane=f!==0&&f<o?f:o}}function uu(e,o){Fc(e,o),(e=e.alternate)&&Fc(e,o)}function cd(){return null}var Dc=typeof reportError=="function"?reportError:function(e){console.error(e)};function cu(e){this._internalRoot=e}La.prototype.render=cu.prototype.render=function(e){var o=this._internalRoot;if(o===null)throw Error(r(409));za(e,o,null,null)},La.prototype.unmount=cu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var o=e.containerInfo;Vn(function(){za(null,e,null,null)}),o[Pr]=null}};function La(e){this._internalRoot=e}La.prototype.unstable_scheduleHydration=function(e){if(e){var o=Ls();e={blockedOn:null,target:e,priority:o};for(var f=0;f<fi.length&&o!==0&&o<fi[f].priority;f++);fi.splice(f,0,e),f===0&&Do(e)}};function du(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Oa(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function zc(){}function dd(e,o,f,F,N){if(N){if(typeof F=="function"){var $=F;F=function(){var Ve=Ia(te);$.call(Ve)}}var te=Pc(o,F,e,0,null,!1,!1,"",zc);return e._reactRootContainer=te,e[Pr]=te.current,Rn(e.nodeType===8?e.parentNode:e),Vn(),te}for(;N=e.lastChild;)e.removeChild(N);if(typeof F=="function"){var de=F;F=function(){var Ve=Ia(be);de.call(Ve)}}var be=lu(e,0,!1,null,null,!1,!1,"",zc);return e._reactRootContainer=be,e[Pr]=be.current,Rn(e.nodeType===8?e.parentNode:e),Vn(function(){za(o,be,f,F)}),be}function Na(e,o,f,F,N){var $=f._reactRootContainer;if($){var te=$;if(typeof N=="function"){var de=N;N=function(){var be=Ia(te);de.call(be)}}za(o,te,e,N)}else te=dd(f,o,e,N,F);return Ia(te)}Nt=function(e){switch(e.tag){case 3:var o=e.stateNode;if(o.current.memoizedState.isDehydrated){var f=nr(o.pendingLanes);f!==0&&(Hr(o,f|1),Nr(o,Jt()),(jt&6)===0&&(Rs=Jt()+500,ne()))}break;case 13:Vn(function(){var F=Ni(e,1);if(F!==null){var N=Dr();oi(F,e,1,N)}}),uu(e,1)}},Ti=function(e){if(e.tag===13){var o=Ni(e,134217728);if(o!==null){var f=Dr();oi(o,e,134217728,f)}uu(e,134217728)}},qn=function(e){if(e.tag===13){var o=hn(e),f=Ni(e,o);if(f!==null){var F=Dr();oi(f,e,o,F)}uu(e,o)}},Ls=function(){return Rt},Mi=function(e,o){var f=Rt;try{return Rt=e,o()}finally{Rt=f}},Z=function(e,o,f){switch(o){case"input":if(Qe(e,f),o=f.name,f.type==="radio"&&o!=null){for(f=e;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<f.length;o++){var F=f[o];if(F!==e&&F.form===e.form){var N=ys(F);if(!N)throw Error(r(90));We(F),Qe(F,N)}}}break;case"textarea":Ue(e,f);break;case"select":o=f.value,o!=null&&Je(e,!!f.multiple,o,!1)}},re=ru,ge=Vn;var hd={usingClientEntryPoint:!1,Events:[Dn,sn,ys,Te,Ee,ru]},ko={findFiberByHostInstance:Li,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fd={bundleType:ko.bundleType,version:ko.version,rendererPackageName:ko.rendererPackageName,rendererConfig:ko.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:T.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=dr(e),e===null?null:e.stateNode},findFiberByHostInstance:ko.findFiberByHostInstance||cd,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ja=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ja.isDisabled&&ja.supportsFiber)try{Hn=ja.inject(fd),vr=ja}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hd,reactDom_production_min.createPortal=function(e,o){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!du(o))throw Error(r(200));return ud(e,o,null,f)},reactDom_production_min.createRoot=function(e,o){if(!du(e))throw Error(r(299));var f=!1,F="",N=Dc;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(F=o.identifierPrefix),o.onRecoverableError!==void 0&&(N=o.onRecoverableError)),o=lu(e,1,!1,null,null,f,!1,F,N),e[Pr]=o.current,Rn(e.nodeType===8?e.parentNode:e),new cu(o)},reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var o=e._reactInternals;if(o===void 0)throw typeof e.render=="function"?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=dr(o),e=e===null?null:e.stateNode,e},reactDom_production_min.flushSync=function(e){return Vn(e)},reactDom_production_min.hydrate=function(e,o,f){if(!Oa(o))throw Error(r(200));return Na(null,e,o,!0,f)},reactDom_production_min.hydrateRoot=function(e,o,f){if(!du(e))throw Error(r(405));var F=f!=null&&f.hydratedSources||null,N=!1,$="",te=Dc;if(f!=null&&(f.unstable_strictMode===!0&&(N=!0),f.identifierPrefix!==void 0&&($=f.identifierPrefix),f.onRecoverableError!==void 0&&(te=f.onRecoverableError)),o=Pc(o,null,e,1,f??null,N,!1,$,te),e[Pr]=o.current,Rn(e),F)for(e=0;e<F.length;e++)f=F[e],N=f._getVersion,N=N(f._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[f,N]:o.mutableSourceEagerHydrationData.push(f,N);return new La(o)},reactDom_production_min.render=function(e,o,f){if(!Oa(o))throw Error(r(200));return Na(null,e,o,!1,f)},reactDom_production_min.unmountComponentAtNode=function(e){if(!Oa(e))throw Error(r(40));return e._reactRootContainer?(Vn(function(){Na(null,null,e,!1,function(){e._reactRootContainer=null,e[Pr]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=ru,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,o,f,F){if(!Oa(f))throw Error(r(200));if(e==null||e._reactInternals===void 0)throw Error(r(38));return Na(e,o,f,!1,F)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var n=requireReactDom();return client.createRoot=n.createRoot,client.hydrateRoot=n.hydrateRoot,client}var clientExports=requireClient();const LayoutGroupContext=reactExports.createContext({});function useConstant(n){const t=reactExports.useRef(null);return t.current===null&&(t.current=n()),t.current}const isBrowser=typeof window<"u",useIsomorphicLayoutEffect=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,PresenceContext=reactExports.createContext(null);function addUniqueItem(n,t){n.indexOf(t)===-1&&n.push(t)}function removeItem(n,t){const r=n.indexOf(t);r>-1&&n.splice(r,1)}const clamp=(n,t,r)=>r>t?t:r<n?n:r;let invariant=()=>{};const MotionGlobalConfig={},isNumericalString=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function isObject$1(n){return typeof n=="object"&&n!==null}const isZeroValueString=n=>/^0[^.\s]+$/u.test(n);function memo(n){let t;return()=>(t===void 0&&(t=n()),t)}const noop=n=>n,combineFunctions=(n,t)=>r=>t(n(r)),pipe=(...n)=>n.reduce(combineFunctions),progress=(n,t,r)=>{const u=t-n;return u===0?1:(r-n)/u};class SubscriptionManager{constructor(){this.subscriptions=[]}add(t){return addUniqueItem(this.subscriptions,t),()=>removeItem(this.subscriptions,t)}notify(t,r,u){const v=this.subscriptions.length;if(v)if(v===1)this.subscriptions[0](t,r,u);else for(let _=0;_<v;_++){const b=this.subscriptions[_];b&&b(t,r,u)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const secondsToMilliseconds=n=>n*1e3,millisecondsToSeconds=n=>n/1e3;function velocityPerSecond(n,t){return t?n*(1e3/t):0}const calcBezier=(n,t,r)=>(((1-3*r+3*t)*n+(3*r-6*t))*n+3*t)*n,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(n,t,r,u,v){let _,b,p=0;do b=t+(r-t)/2,_=calcBezier(b,u,v)-n,_>0?r=b:t=b;while(Math.abs(_)>subdivisionPrecision&&++p<subdivisionMaxIterations);return b}function cubicBezier(n,t,r,u){if(n===t&&r===u)return noop;const v=_=>binarySubdivide(_,0,1,n,r);return _=>_===0||_===1?_:calcBezier(v(_),t,u)}const mirrorEasing=n=>t=>t<=.5?n(2*t)/2:(2-n(2*(1-t)))/2,reverseEasing=n=>t=>1-n(1-t),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=n=>(n*=2)<1?.5*backIn(n):.5*(2-Math.pow(2,-10*(n-1))),circIn=n=>1-Math.sin(Math.acos(n)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=n=>Array.isArray(n)&&typeof n[0]!="number",isBezierDefinition=n=>Array.isArray(n)&&typeof n[0]=="number",easingLookup={linear:noop,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},isValidEasing=n=>typeof n=="string",easingDefinitionToFunction=n=>{if(isBezierDefinition(n)){invariant(n.length===4);const[t,r,u,v]=n;return cubicBezier(t,r,u,v)}else if(isValidEasing(n))return easingLookup[n];return n},stepsOrder=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function createRenderStep(n,t){let r=new Set,u=new Set,v=!1,_=!1;const b=new WeakSet;let p={delta:0,timestamp:0,isProcessing:!1};function y(g){b.has(g)&&(k.schedule(g),n()),g(p)}const k={schedule:(g,M=!1,P=!1)=>{const S=P&&v?r:u;return M&&b.add(g),S.has(g)||S.add(g),g},cancel:g=>{u.delete(g),b.delete(g)},process:g=>{if(p=g,v){_=!0;return}v=!0,[r,u]=[u,r],r.forEach(y),r.clear(),v=!1,_&&(_=!1,k.process(g))}};return k}const maxElapsed=40;function createRenderBatcher(n,t){let r=!1,u=!0;const v={delta:0,timestamp:0,isProcessing:!1},_=()=>r=!0,b=stepsOrder.reduce((x,T)=>(x[T]=createRenderStep(_),x),{}),{setup:p,read:y,resolveKeyframes:k,preUpdate:g,update:M,preRender:P,render:R,postRender:S}=b,a=()=>{const x=MotionGlobalConfig.useManualTiming?v.timestamp:performance.now();r=!1,MotionGlobalConfig.useManualTiming||(v.delta=u?1e3/60:Math.max(Math.min(x-v.timestamp,maxElapsed),1)),v.timestamp=x,v.isProcessing=!0,p.process(v),y.process(v),k.process(v),g.process(v),M.process(v),P.process(v),R.process(v),S.process(v),v.isProcessing=!1,r&&t&&(u=!1,n(a))},s=()=>{r=!0,u=!0,v.isProcessing||n(a)};return{schedule:stepsOrder.reduce((x,T)=>{const l=b[T];return x[T]=(h,C=!1,E=!1)=>(r||s(),l.schedule(h,C,E)),x},{}),cancel:x=>{for(let T=0;T<stepsOrder.length;T++)b[stepsOrder[T]].cancel(x)},state:v,steps:b}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop,!0);let now;function clearTime(){now=void 0}const time={now:()=>(now===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now),set:n=>{now=n,queueMicrotask(clearTime)}},checkStringStartsWith=n=>t=>typeof t=="string"&&t.startsWith(n),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=n=>startsAsVariableToken(n)?singleCssVariableRegex.test(n.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,number={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},alpha={...number,transform:n=>clamp(0,1,n)},scale={...number,default:1},sanitize=n=>Math.round(n*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(n){return n==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(n,t)=>r=>!!(typeof r=="string"&&singleColorRegex.test(r)&&r.startsWith(n)||t&&!isNullish(r)&&Object.prototype.hasOwnProperty.call(r,t)),splitColor=(n,t,r)=>u=>{if(typeof u!="string")return u;const[v,_,b,p]=u.match(floatRegex);return{[n]:parseFloat(v),[t]:parseFloat(_),[r]:parseFloat(b),alpha:p!==void 0?parseFloat(p):1}},clampRgbUnit=n=>clamp(0,255,n),rgbUnit={...number,transform:n=>Math.round(clampRgbUnit(n))},rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:n,green:t,blue:r,alpha:u=1})=>"rgba("+rgbUnit.transform(n)+", "+rgbUnit.transform(t)+", "+rgbUnit.transform(r)+", "+sanitize(alpha.transform(u))+")"};function parseHex(n){let t="",r="",u="",v="";return n.length>5?(t=n.substring(1,3),r=n.substring(3,5),u=n.substring(5,7),v=n.substring(7,9)):(t=n.substring(1,2),r=n.substring(2,3),u=n.substring(3,4),v=n.substring(4,5),t+=t,r+=r,u+=u,v+=v),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(u,16),alpha:v?parseInt(v,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},createUnitType=n=>({test:t=>typeof t=="string"&&t.endsWith(n)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${n}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:n=>percent.parse(n)/100,transform:n=>percent.transform(n*100)},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:n,saturation:t,lightness:r,alpha:u=1})=>"hsla("+Math.round(n)+", "+percent.transform(sanitize(t))+", "+percent.transform(sanitize(r))+", "+sanitize(alpha.transform(u))+")"},color={test:n=>rgba.test(n)||hex.test(n)||hsla.test(n),parse:n=>rgba.test(n)?rgba.parse(n):hsla.test(n)?hsla.parse(n):hex.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?rgba.transform(n):hsla.transform(n),getAnimatableNone:n=>{const t=color.parse(n);return t.alpha=0,color.transform(t)}},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(n){return isNaN(n)&&typeof n=="string"&&(n.match(floatRegex)?.length||0)+(n.match(colorRegex)?.length||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(n){const t=n.toString(),r=[],u={color:[],number:[],var:[]},v=[];let _=0;const p=t.replace(complexRegex,y=>(color.test(y)?(u.color.push(_),v.push(COLOR_TOKEN),r.push(color.parse(y))):y.startsWith(VAR_FUNCTION_TOKEN)?(u.var.push(_),v.push(VAR_TOKEN),r.push(y)):(u.number.push(_),v.push(NUMBER_TOKEN),r.push(parseFloat(y))),++_,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:r,split:p,indexes:u,types:v}}function parseComplexValue(n){return analyseComplexValue(n).values}function createTransformer(n){const{split:t,types:r}=analyseComplexValue(n),u=t.length;return v=>{let _="";for(let b=0;b<u;b++)if(_+=t[b],v[b]!==void 0){const p=r[b];p===NUMBER_TOKEN?_+=sanitize(v[b]):p===COLOR_TOKEN?_+=color.transform(v[b]):_+=v[b]}return _}}const convertNumbersToZero=n=>typeof n=="number"?0:color.test(n)?color.getAnimatableNone(n):n;function getAnimatableNone$1(n){const t=parseComplexValue(n);return createTransformer(n)(t.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1};function hueToRgb(n,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?n+(t-n)*6*r:r<1/2?t:r<2/3?n+(t-n)*(2/3-r)*6:n}function hslaToRgba({hue:n,saturation:t,lightness:r,alpha:u}){n/=360,t/=100,r/=100;let v=0,_=0,b=0;if(!t)v=_=b=r;else{const p=r<.5?r*(1+t):r+t-r*t,y=2*r-p;v=hueToRgb(y,p,n+1/3),_=hueToRgb(y,p,n),b=hueToRgb(y,p,n-1/3)}return{red:Math.round(v*255),green:Math.round(_*255),blue:Math.round(b*255),alpha:u}}function mixImmediate(n,t){return r=>r>0?t:n}const mixNumber$1=(n,t,r)=>n+(t-n)*r,mixLinearColor=(n,t,r)=>{const u=n*n,v=r*(t*t-u)+u;return v<0?0:Math.sqrt(v)},colorTypes=[hex,rgba,hsla],getColorType=n=>colorTypes.find(t=>t.test(n));function asRGBA(n){const t=getColorType(n);if(!t)return!1;let r=t.parse(n);return t===hsla&&(r=hslaToRgba(r)),r}const mixColor=(n,t)=>{const r=asRGBA(n),u=asRGBA(t);if(!r||!u)return mixImmediate(n,t);const v={...r};return _=>(v.red=mixLinearColor(r.red,u.red,_),v.green=mixLinearColor(r.green,u.green,_),v.blue=mixLinearColor(r.blue,u.blue,_),v.alpha=mixNumber$1(r.alpha,u.alpha,_),rgba.transform(v))},invisibleValues=new Set(["none","hidden"]);function mixVisibility(n,t){return invisibleValues.has(n)?r=>r<=0?n:t:r=>r>=1?t:n}function mixNumber(n,t){return r=>mixNumber$1(n,t,r)}function getMixer(n){return typeof n=="number"?mixNumber:typeof n=="string"?isCSSVariableToken(n)?mixImmediate:color.test(n)?mixColor:mixComplex:Array.isArray(n)?mixArray:typeof n=="object"?color.test(n)?mixColor:mixObject:mixImmediate}function mixArray(n,t){const r=[...n],u=r.length,v=n.map((_,b)=>getMixer(_)(_,t[b]));return _=>{for(let b=0;b<u;b++)r[b]=v[b](_);return r}}function mixObject(n,t){const r={...n,...t},u={};for(const v in r)n[v]!==void 0&&t[v]!==void 0&&(u[v]=getMixer(n[v])(n[v],t[v]));return v=>{for(const _ in u)r[_]=u[_](v);return r}}function matchOrder(n,t){const r=[],u={color:0,var:0,number:0};for(let v=0;v<t.values.length;v++){const _=t.types[v],b=n.indexes[_][u[_]],p=n.values[b]??0;r[v]=p,u[_]++}return r}const mixComplex=(n,t)=>{const r=complex.createTransformer(t),u=analyseComplexValue(n),v=analyseComplexValue(t);return u.indexes.var.length===v.indexes.var.length&&u.indexes.color.length===v.indexes.color.length&&u.indexes.number.length>=v.indexes.number.length?invisibleValues.has(n)&&!v.values.length||invisibleValues.has(t)&&!u.values.length?mixVisibility(n,t):pipe(mixArray(matchOrder(u,v),v.values),r):mixImmediate(n,t)};function mix(n,t,r){return typeof n=="number"&&typeof t=="number"&&typeof r=="number"?mixNumber$1(n,t,r):getMixer(n)(n,t)}const frameloopDriver=n=>{const t=({timestamp:r})=>n(r);return{start:(r=!0)=>frame.update(t,r),stop:()=>cancelFrame(t),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generateLinearEasing=(n,t,r=10)=>{let u="";const v=Math.max(Math.round(t/r),2);for(let _=0;_<v;_++)u+=Math.round(n(_/(v-1))*1e4)/1e4+", ";return`linear(${u.substring(0,u.length-2)})`},maxGeneratorDuration=2e4;function calcGeneratorDuration(n){let t=0;const r=50;let u=n.next(t);for(;!u.done&&t<maxGeneratorDuration;)t+=r,u=n.next(t);return t>=maxGeneratorDuration?1/0:t}function createGeneratorEasing(n,t=100,r){const u=r({...n,keyframes:[0,t]}),v=Math.min(calcGeneratorDuration(u),maxGeneratorDuration);return{type:"keyframes",ease:_=>u.next(v*_).value/t,duration:millisecondsToSeconds(v)}}const velocitySampleDuration=5;function calcGeneratorVelocity(n,t,r){const u=Math.max(t-velocitySampleDuration,0);return velocityPerSecond(r-n(u),t-u)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:n=springDefaults.duration,bounce:t=springDefaults.bounce,velocity:r=springDefaults.velocity,mass:u=springDefaults.mass}){let v,_,b=1-t;b=clamp(springDefaults.minDamping,springDefaults.maxDamping,b),n=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(n)),b<1?(v=k=>{const g=k*b,M=g*n,P=g-r,R=calcAngularFreq(k,b),S=Math.exp(-M);return safeMin-P/R*S},_=k=>{const M=k*b*n,P=M*r+r,R=Math.pow(b,2)*Math.pow(k,2)*n,S=Math.exp(-M),a=calcAngularFreq(Math.pow(k,2),b);return(-v(k)+safeMin>0?-1:1)*((P-R)*S)/a}):(v=k=>{const g=Math.exp(-k*n),M=(k-r)*n+1;return-safeMin+g*M},_=k=>{const g=Math.exp(-k*n),M=(r-k)*(n*n);return g*M});const p=5/n,y=approximateRoot(v,_,p);if(n=secondsToMilliseconds(n),isNaN(y))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:n};{const k=Math.pow(y,2)*u;return{stiffness:k,damping:b*2*Math.sqrt(u*k),duration:n}}}const rootIterations=12;function approximateRoot(n,t,r){let u=r;for(let v=1;v<rootIterations;v++)u=u-n(u)/t(u);return u}function calcAngularFreq(n,t){return n*Math.sqrt(1-t*t)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(n,t){return t.some(r=>n[r]!==void 0)}function getSpringOptions(n){let t={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...n};if(!isSpringType(n,physicsKeys)&&isSpringType(n,durationKeys))if(n.visualDuration){const r=n.visualDuration,u=2*Math.PI/(r*1.2),v=u*u,_=2*clamp(.05,1,1-(n.bounce||0))*Math.sqrt(v);t={...t,mass:springDefaults.mass,stiffness:v,damping:_}}else{const r=findSpring(n);t={...t,...r,mass:springDefaults.mass},t.isResolvedFromDuration=!0}return t}function spring(n=springDefaults.visualDuration,t=springDefaults.bounce){const r=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:t}:n;let{restSpeed:u,restDelta:v}=r;const _=r.keyframes[0],b=r.keyframes[r.keyframes.length-1],p={done:!1,value:_},{stiffness:y,damping:k,mass:g,duration:M,velocity:P,isResolvedFromDuration:R}=getSpringOptions({...r,velocity:-millisecondsToSeconds(r.velocity||0)}),S=P||0,a=k/(2*Math.sqrt(y*g)),s=b-_,c=millisecondsToSeconds(Math.sqrt(y/g)),w=Math.abs(s)<5;u||(u=w?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),v||(v=w?springDefaults.restDelta.granular:springDefaults.restDelta.default);let x;if(a<1){const l=calcAngularFreq(c,a);x=h=>{const C=Math.exp(-a*c*h);return b-C*((S+a*c*s)/l*Math.sin(l*h)+s*Math.cos(l*h))}}else if(a===1)x=l=>b-Math.exp(-c*l)*(s+(S+c*s)*l);else{const l=c*Math.sqrt(a*a-1);x=h=>{const C=Math.exp(-a*c*h),E=Math.min(l*h,300);return b-C*((S+a*c*s)*Math.sinh(E)+l*s*Math.cosh(E))/l}}const T={calculatedDuration:R&&M||null,next:l=>{const h=x(l);if(R)p.done=l>=M;else{let C=l===0?S:0;a<1&&(C=l===0?secondsToMilliseconds(S):calcGeneratorVelocity(x,l,h));const E=Math.abs(C)<=u,D=Math.abs(b-h)<=v;p.done=E&&D}return p.value=p.done?b:h,p},toString:()=>{const l=Math.min(calcGeneratorDuration(T),maxGeneratorDuration),h=generateLinearEasing(C=>T.next(l*C).value,l,30);return l+"ms "+h},toTransition:()=>{}};return T}spring.applyToOptions=n=>{const t=createGeneratorEasing(n,100,spring);return n.ease=t.ease,n.duration=secondsToMilliseconds(t.duration),n.type="keyframes",n};function inertia({keyframes:n,velocity:t=0,power:r=.8,timeConstant:u=325,bounceDamping:v=10,bounceStiffness:_=500,modifyTarget:b,min:p,max:y,restDelta:k=.5,restSpeed:g}){const M=n[0],P={done:!1,value:M},R=E=>p!==void 0&&E<p||y!==void 0&&E>y,S=E=>p===void 0?y:y===void 0||Math.abs(p-E)<Math.abs(y-E)?p:y;let a=r*t;const s=M+a,c=b===void 0?s:b(s);c!==s&&(a=c-M);const w=E=>-a*Math.exp(-E/u),x=E=>c+w(E),T=E=>{const D=w(E),z=x(E);P.done=Math.abs(D)<=k,P.value=P.done?c:z};let l,h;const C=E=>{R(P.value)&&(l=E,h=spring({keyframes:[P.value,S(P.value)],velocity:calcGeneratorVelocity(x,E,P.value),damping:v,stiffness:_,restDelta:k,restSpeed:g}))};return C(0),{calculatedDuration:null,next:E=>{let D=!1;return!h&&l===void 0&&(D=!0,T(E),C(E)),l!==void 0&&E>=l?h.next(E-l):(!D&&T(E),P)}}}function createMixers(n,t,r){const u=[],v=r||MotionGlobalConfig.mix||mix,_=n.length-1;for(let b=0;b<_;b++){let p=v(n[b],n[b+1]);if(t){const y=Array.isArray(t)?t[b]||noop:t;p=pipe(y,p)}u.push(p)}return u}function interpolate(n,t,{clamp:r=!0,ease:u,mixer:v}={}){const _=n.length;if(invariant(_===t.length),_===1)return()=>t[0];if(_===2&&t[0]===t[1])return()=>t[1];const b=n[0]===n[1];n[0]>n[_-1]&&(n=[...n].reverse(),t=[...t].reverse());const p=createMixers(t,u,v),y=p.length,k=g=>{if(b&&g<n[0])return t[0];let M=0;if(y>1)for(;M<n.length-2&&!(g<n[M+1]);M++);const P=progress(n[M],n[M+1],g);return p[M](P)};return r?g=>k(clamp(n[0],n[_-1],g)):k}function fillOffset(n,t){const r=n[n.length-1];for(let u=1;u<=t;u++){const v=progress(0,t,u);n.push(mixNumber$1(r,1,v))}}function defaultOffset(n){const t=[0];return fillOffset(t,n.length-1),t}function convertOffsetToTimes(n,t){return n.map(r=>r*t)}function defaultEasing(n,t){return n.map(()=>t||easeInOut).splice(0,n.length-1)}function keyframes({duration:n=300,keyframes:t,times:r,ease:u="easeInOut"}){const v=isEasingArray(u)?u.map(easingDefinitionToFunction):easingDefinitionToFunction(u),_={done:!1,value:t[0]},b=convertOffsetToTimes(r&&r.length===t.length?r:defaultOffset(t),n),p=interpolate(b,t,{ease:Array.isArray(v)?v:defaultEasing(t,v)});return{calculatedDuration:n,next:y=>(_.value=p(y),_.done=y>=n,_)}}const isNotNull$1=n=>n!==null;function getFinalKeyframe$1(n,{repeat:t,repeatType:r="loop"},u,v=1){const _=n.filter(isNotNull$1),p=v<0||t&&r!=="loop"&&t%2===1?0:_.length-1;return!p||u===void 0?_[p]:u}const transitionTypeMap={decay:inertia,inertia,tween:keyframes,keyframes,spring};function replaceTransitionType(n){typeof n.type=="string"&&(n.type=transitionTypeMap[n.type])}class WithPromise{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const percentToProgress=n=>n/100;class JSAnimation extends WithPromise{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==time.now()&&this.tick(time.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;replaceTransitionType(t);const{type:r=keyframes,repeat:u=0,repeatDelay:v=0,repeatType:_,velocity:b=0}=t;let{keyframes:p}=t;const y=r||keyframes;y!==keyframes&&typeof p[0]!="number"&&(this.mixKeyframes=pipe(percentToProgress,mix(p[0],p[1])),p=[0,100]);const k=y({...t,keyframes:p});_==="mirror"&&(this.mirroredGenerator=y({...t,keyframes:[...p].reverse(),velocity:-b})),k.calculatedDuration===null&&(k.calculatedDuration=calcGeneratorDuration(k));const{calculatedDuration:g}=k;this.calculatedDuration=g,this.resolvedDuration=g+v,this.totalDuration=this.resolvedDuration*(u+1)-v,this.generator=k}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:u,totalDuration:v,mixKeyframes:_,mirroredGenerator:b,resolvedDuration:p,calculatedDuration:y}=this;if(this.startTime===null)return u.next(0);const{delay:k=0,keyframes:g,repeat:M,repeatType:P,repeatDelay:R,type:S,onUpdate:a,finalKeyframe:s}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-v/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const c=this.currentTime-k*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?c<0:c>v;this.currentTime=Math.max(c,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=v);let x=this.currentTime,T=u;if(M){const E=Math.min(this.currentTime,v)/p;let D=Math.floor(E),z=E%1;!z&&E>=1&&(z=1),z===1&&D--,D=Math.min(D,M+1),!!(D%2)&&(P==="reverse"?(z=1-z,R&&(z-=R/p)):P==="mirror"&&(T=b)),x=clamp(0,1,z)*p}const l=w?{done:!1,value:g[0]}:T.next(x);_&&(l.value=_(l.value));let{done:h}=l;!w&&y!==null&&(h=this.playbackSpeed>=0?this.currentTime>=v:this.currentTime<=0);const C=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&h);return C&&S!==inertia&&(l.value=getFinalKeyframe$1(g,this.options,s,this.speed)),a&&a(l.value),C&&this.finish(),l}then(t,r){return this.finished.then(t,r)}get duration(){return millisecondsToSeconds(this.calculatedDuration)}get time(){return millisecondsToSeconds(this.currentTime)}set time(t){t=secondsToMilliseconds(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(time.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=millisecondsToSeconds(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=frameloopDriver,startTime:r}=this.options;this.driver||(this.driver=t(v=>this.tick(v))),this.options.onPlay?.();const u=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=u):this.holdTime!==null?this.startTime=u-this.holdTime:this.startTime||(this.startTime=r??u),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(time.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function fillWildcards(n){for(let t=1;t<n.length;t++)n[t]??(n[t]=n[t-1])}const radToDeg$1=n=>n*180/Math.PI,rotate=n=>{const t=radToDeg$1(Math.atan2(n[1],n[0]));return rebaseAngle(t)},matrix2dParsers={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate,rotateZ:rotate,skewX:n=>radToDeg$1(Math.atan(n[1])),skewY:n=>radToDeg$1(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},rebaseAngle=n=>(n=n%360,n<0&&(n+=360),n),rotateZ=rotate,scaleX=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),scaleY=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),matrix3dParsers={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX,scaleY,scale:n=>(scaleX(n)+scaleY(n))/2,rotateX:n=>rebaseAngle(radToDeg$1(Math.atan2(n[6],n[5]))),rotateY:n=>rebaseAngle(radToDeg$1(Math.atan2(-n[2],n[0]))),rotateZ,rotate:rotateZ,skewX:n=>radToDeg$1(Math.atan(n[4])),skewY:n=>radToDeg$1(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function defaultTransformValue(n){return n.includes("scale")?1:0}function parseValueFromTransform(n,t){if(!n||n==="none")return defaultTransformValue(t);const r=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let u,v;if(r)u=matrix3dParsers,v=r;else{const p=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);u=matrix2dParsers,v=p}if(!v)return defaultTransformValue(t);const _=u[t],b=v[1].split(",").map(convertTransformToNumber);return typeof _=="function"?_(b):b[_]}const readTransformValue=(n,t)=>{const{transform:r="none"}=getComputedStyle(n);return parseValueFromTransform(r,t)};function convertTransformToNumber(n){return parseFloat(n.trim())}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),isNumOrPxType=n=>n===number||n===px,transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(n=>!transformKeys.has(n));function removeNonTranslationalTransform(n){const t=[];return nonTranslationalTransformKeys.forEach(r=>{const u=n.getValue(r);u!==void 0&&(t.push([r,u.get()]),u.set(r.startsWith("scale")?1:0))}),t}const positionalValues={width:({x:n},{paddingLeft:t="0",paddingRight:r="0"})=>n.max-n.min-parseFloat(t)-parseFloat(r),height:({y:n},{paddingTop:t="0",paddingBottom:r="0"})=>n.max-n.min-parseFloat(t)-parseFloat(r),top:(n,{top:t})=>parseFloat(t),left:(n,{left:t})=>parseFloat(t),bottom:({y:n},{top:t})=>parseFloat(t)+(n.max-n.min),right:({x:n},{left:t})=>parseFloat(t)+(n.max-n.min),x:(n,{transform:t})=>parseValueFromTransform(t,"x"),y:(n,{transform:t})=>parseValueFromTransform(t,"y")};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1,isForced=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const n=Array.from(toResolve).filter(u=>u.needsMeasurement),t=new Set(n.map(u=>u.element)),r=new Map;t.forEach(u=>{const v=removeNonTranslationalTransform(u);v.length&&(r.set(u,v),u.render())}),n.forEach(u=>u.measureInitialState()),t.forEach(u=>{u.render();const v=r.get(u);v&&v.forEach(([_,b])=>{u.getValue(_)?.set(b)})}),n.forEach(u=>u.measureEndState()),n.forEach(u=>{u.suspendedScrollY!==void 0&&window.scrollTo(0,u.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(n=>n.complete(isForced)),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){isForced=!0,readAllKeyframes(),measureAllKeyframes(),isForced=!1}class KeyframeResolver{constructor(t,r,u,v,_,b=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=u,this.motionValue=v,this.element=_,this.isAsync=b}scheduleResolve(){this.state="scheduled",this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:u,motionValue:v}=this;if(t[0]===null){const _=v?.get(),b=t[t.length-1];if(_!==void 0)t[0]=_;else if(u&&r){const p=u.readValue(r,b);p!=null&&(t[0]=p)}t[0]===void 0&&(t[0]=b),v&&_===void 0&&v.set(t[0])}fillWildcards(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),toResolve.delete(this)}cancel(){this.state==="scheduled"&&(toResolve.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const isCSSVar=n=>n.startsWith("--");function setStyle(n,t,r){isCSSVar(t)?n.style.setProperty(t,r):n.style[t]=r}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0),supportsFlags={};function memoSupports(n,t){const r=memo(n);return()=>supportsFlags[t]??r()}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cubicBezierAsString=([n,t,r,u])=>`cubic-bezier(${n}, ${t}, ${r}, ${u})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(n,t){if(n)return typeof n=="function"?supportsLinearEasing()?generateLinearEasing(n,t):"ease-out":isBezierDefinition(n)?cubicBezierAsString(n):Array.isArray(n)?n.map(r=>mapEasingToNativeEasing(r,t)||supportedWaapiEasing.easeOut):supportedWaapiEasing[n]}function startWaapiAnimation(n,t,r,{delay:u=0,duration:v=300,repeat:_=0,repeatType:b="loop",ease:p="easeOut",times:y}={},k=void 0){const g={[t]:r};y&&(g.offset=y);const M=mapEasingToNativeEasing(p,v);Array.isArray(M)&&(g.easing=M);const P={delay:u,duration:v,easing:Array.isArray(M)?"linear":M,fill:"both",iterations:_+1,direction:b==="reverse"?"alternate":"normal"};return k&&(P.pseudoElement=k),n.animate(g,P)}function isGenerator(n){return typeof n=="function"&&"applyToOptions"in n}function applyGeneratorOptions({type:n,...t}){return isGenerator(n)&&supportsLinearEasing()?n.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class NativeAnimation extends WithPromise{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:u,keyframes:v,pseudoElement:_,allowFlatten:b=!1,finalKeyframe:p,onComplete:y}=t;this.isPseudoElement=!!_,this.allowFlatten=b,this.options=t,invariant(typeof t.type!="string");const k=applyGeneratorOptions(t);this.animation=startWaapiAnimation(r,u,v,k,_),k.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!_){const g=getFinalKeyframe$1(v,this.options,p,this.speed);this.updateMotionValue?this.updateMotionValue(g):setStyle(r,u,g),this.animation.cancel()}y?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return millisecondsToSeconds(Number(t))}get time(){return millisecondsToSeconds(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=secondsToMilliseconds(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&supportsScrollTimeline()?(this.animation.timeline=t,noop):r(this)}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(n){return n in unsupportedEasingFunctions}function replaceStringEasing(n){typeof n.ease=="string"&&isUnsupportedEase(n.ease)&&(n.ease=unsupportedEasingFunctions[n.ease])}const sampleDelta=10;class NativeAnimationExtended extends NativeAnimation{constructor(t){replaceStringEasing(t),replaceTransitionType(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:u,onComplete:v,element:_,...b}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const p=new JSAnimation({...b,autoplay:!1}),y=secondsToMilliseconds(this.finishedTime??this.time);r.setWithVelocity(p.sample(y-sampleDelta).value,p.sample(y).value,sampleDelta),p.stop()}}const isAnimatable=(n,t)=>t==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(complex.test(n)||n==="0")&&!n.startsWith("url("));function hasKeyframesChanged(n){const t=n[0];if(n.length===1)return!0;for(let r=0;r<n.length;r++)if(n[r]!==t)return!0}function canAnimate(n,t,r,u){const v=n[0];if(v===null)return!1;if(t==="display"||t==="visibility")return!0;const _=n[n.length-1],b=isAnimatable(v,t),p=isAnimatable(_,t);return!b||!p?!1:hasKeyframesChanged(n)||(r==="spring"||isGenerator(r))&&u}function makeAnimationInstant(n){n.duration=0,n.type}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]),supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function supportsBrowserAnimation(n){const{motionValue:t,name:r,repeatDelay:u,repeatType:v,damping:_,type:b}=n;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:y,transformTemplate:k}=t.owner.getProps();return supportsWaapi()&&r&&acceleratedValues.has(r)&&(r!=="transform"||!k)&&!y&&!u&&v!=="mirror"&&_!==0&&b!=="inertia"}const MAX_RESOLVE_DELAY=40;class AsyncMotionValueAnimation extends WithPromise{constructor({autoplay:t=!0,delay:r=0,type:u="keyframes",repeat:v=0,repeatDelay:_=0,repeatType:b="loop",keyframes:p,name:y,motionValue:k,element:g,...M}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=time.now();const P={autoplay:t,delay:r,type:u,repeat:v,repeatDelay:_,repeatType:b,name:y,motionValue:k,element:g,...M},R=g?.KeyframeResolver||KeyframeResolver;this.keyframeResolver=new R(p,(S,a,s)=>this.onKeyframesResolved(S,a,P,!s),y,k,g),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,r,u,v){this.keyframeResolver=void 0;const{name:_,type:b,velocity:p,delay:y,isHandoff:k,onUpdate:g}=u;this.resolvedAt=time.now(),canAnimate(t,_,b,p)||((MotionGlobalConfig.instantAnimations||!y)&&g?.(getFinalKeyframe$1(t,u,r)),t[0]=t[t.length-1],makeAnimationInstant(u),u.repeat=0);const P={startTime:v?this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...u,keyframes:t},R=!k&&supportsBrowserAnimation(P)?new NativeAnimationExtended({...P,element:P.motionValue.owner.current}):new JSAnimation(P);R.finished.then(()=>this.notifyFinished()).catch(noop),this.pendingTimeline&&(this.stopTimeline=R.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=R}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),flushKeyframeResolvers()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(n){const t=splitCSSVariableRegex.exec(n);if(!t)return[,];const[,r,u,v]=t;return[`--${r??u}`,v]}function getVariableValue(n,t,r=1){const[u,v]=parseCSSVariable(n);if(!u)return;const _=window.getComputedStyle(t).getPropertyValue(u);if(_){const b=_.trim();return isNumericalString(b)?parseFloat(b):b}return isCSSVariableToken(v)?getVariableValue(v,t,r+1):v}function getValueTransition(n,t){return n?.[t]??n?.default??n}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]),auto={test:n=>n==="auto",parse:n=>n},testValueType=n=>t=>t.test(n),dimensionValueTypes=[number,px,percent,degrees,vw,vh,auto],findDimensionValueType=n=>dimensionValueTypes.find(testValueType(n));function isNone(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||isZeroValueString(n):!0}const maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(n){const[t,r]=n.slice(0,-1).split("(");if(t==="drop-shadow")return n;const[u]=r.match(floatRegex)||[];if(!u)return n;const v=r.replace(u,"");let _=maxDefaults.has(t)?1:0;return u!==r&&(_*=100),t+"("+_+v+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:n=>{const t=n.match(functionRegex);return t?t.map(applyDefaultFilter).join(" "):n}},int={...number,transform:Math.round},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,backgroundPositionX:px,backgroundPositionY:px,...transformValueTypes,zIndex:int,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},defaultValueTypes={...numberValueTypes,color,backgroundColor:color,outlineColor:color,fill:color,stroke:color,borderColor:color,borderTopColor:color,borderRightColor:color,borderBottomColor:color,borderLeftColor:color,filter,WebkitFilter:filter},getDefaultValueType=n=>defaultValueTypes[n];function getAnimatableNone(n,t){let r=getDefaultValueType(n);return r!==filter&&(r=complex),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(n,t,r){let u=0,v;for(;u<n.length&&!v;){const _=n[u];typeof _=="string"&&!invalidTemplates.has(_)&&analyseComplexValue(_).values.length&&(v=n[u]),u++}if(v&&r)for(const _ of t)n[_]=getAnimatableNone(r,v)}class DOMKeyframesResolver extends KeyframeResolver{constructor(t,r,u,v,_){super(t,r,u,v,_,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:u}=this;if(!r||!r.current)return;super.readKeyframes();for(let y=0;y<t.length;y++){let k=t[y];if(typeof k=="string"&&(k=k.trim(),isCSSVariableToken(k))){const g=getVariableValue(k,r.current);g!==void 0&&(t[y]=g),y===t.length-1&&(this.finalKeyframe=k)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(u)||t.length!==2)return;const[v,_]=t,b=findDimensionValueType(v),p=findDimensionValueType(_);if(b!==p)if(isNumOrPxType(b)&&isNumOrPxType(p))for(let y=0;y<t.length;y++){const k=t[y];typeof k=="string"&&(t[y]=parseFloat(k))}else positionalValues[u]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,u=[];for(let v=0;v<t.length;v++)(t[v]===null||isNone(t[v]))&&u.push(v);u.length&&makeNoneKeyframesAnimatable(t,u,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:u}=this;if(!t||!t.current)return;u==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[u](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const v=r[r.length-1];v!==void 0&&t.getValue(u,v).jump(v,!1)}measureEndState(){const{element:t,name:r,unresolvedKeyframes:u}=this;if(!t||!t.current)return;const v=t.getValue(r);v&&v.jump(this.measuredOrigin,!1);const _=u.length-1,b=u[_];u[_]=positionalValues[r](t.measureViewportBox(),window.getComputedStyle(t.current)),b!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=b),this.removedTransforms?.length&&this.removedTransforms.forEach(([p,y])=>{t.getValue(p).set(y)}),this.resolveNoneKeyframes()}}function resolveElements(n,t,r){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let u=document;const v=r?.[n]??u.querySelectorAll(n);return v?Array.from(v):[]}return Array.from(n)}const getValueAsType=(n,t)=>t&&typeof n=="number"?t.transform(n):n;function isHTMLElement(n){return isObject$1(n)&&"offsetHeight"in n}const MAX_VELOCITY_DELTA=30,isFloat=n=>!isNaN(parseFloat(n));class MotionValue{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=u=>{const v=time.now();if(this.updatedAt!==v&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(u),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const _ of this.dependents)_.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=time.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new SubscriptionManager);const u=this.events[t].add(r);return t==="change"?()=>{u(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:u}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,u){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-u}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(n,t){return new MotionValue(n,t)}const{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function setDragLock(n){return n==="x"||n==="y"?isDragging[n]?null:(isDragging[n]=!0,()=>{isDragging[n]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}function setupGesture(n,t){const r=resolveElements(n),u=new AbortController,v={passive:!0,...t,signal:u.signal};return[r,v,()=>u.abort()]}function isValidHover(n){return!(n.pointerType==="touch"||isDragActive())}function hover(n,t,r={}){const[u,v,_]=setupGesture(n,r),b=p=>{if(!isValidHover(p))return;const{target:y}=p,k=t(y,p);if(typeof k!="function"||!y)return;const g=M=>{isValidHover(M)&&(k(M),y.removeEventListener("pointerleave",g))};y.addEventListener("pointerleave",g,v)};return u.forEach(p=>{p.addEventListener("pointerenter",b,v)}),_}const isNodeOrChild=(n,t)=>t?n===t?!0:isNodeOrChild(n,t.parentElement):!1,isPrimaryPointer=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,focusableElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(n){return focusableElements.has(n.tagName)||n.tabIndex!==-1}const isPressing=new WeakSet;function filterEvents(n){return t=>{t.key==="Enter"&&n(t)}}function firePointerEvent(n,t){n.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(n,t)=>{const r=n.currentTarget;if(!r)return;const u=filterEvents(()=>{if(isPressing.has(r))return;firePointerEvent(r,"down");const v=filterEvents(()=>{firePointerEvent(r,"up")}),_=()=>firePointerEvent(r,"cancel");r.addEventListener("keyup",v,t),r.addEventListener("blur",_,t)});r.addEventListener("keydown",u,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",u),t)};function isValidPressEvent(n){return isPrimaryPointer(n)&&!isDragActive()}function press(n,t,r={}){const[u,v,_]=setupGesture(n,r),b=p=>{const y=p.currentTarget;if(!isValidPressEvent(p))return;isPressing.add(y);const k=t(y,p),g=(R,S)=>{window.removeEventListener("pointerup",M),window.removeEventListener("pointercancel",P),isPressing.has(y)&&isPressing.delete(y),isValidPressEvent(R)&&typeof k=="function"&&k(R,{success:S})},M=R=>{g(R,y===window||y===document||r.useGlobalTarget||isNodeOrChild(y,R.target))},P=R=>{g(R,!1)};window.addEventListener("pointerup",M,v),window.addEventListener("pointercancel",P,v)};return u.forEach(p=>{(r.useGlobalTarget?window:p).addEventListener("pointerdown",b,v),isHTMLElement(p)&&(p.addEventListener("focus",k=>enableKeyboardPress(k,v)),!isElementKeyboardAccessible(p)&&!p.hasAttribute("tabindex")&&(p.tabIndex=0))}),_}function isSVGElement(n){return isObject$1(n)&&"ownerSVGElement"in n}function isSVGSVGElement(n){return isSVGElement(n)&&n.tagName==="svg"}const isMotionValue=n=>!!(n&&n.getVelocity),valueTypes=[...dimensionValueTypes,color,complex],findValueType=n=>valueTypes.find(testValueType(n)),MotionConfigContext=reactExports.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function setRef(n,t){if(typeof n=="function")return n(t);n!=null&&(n.current=t)}function composeRefs(...n){return t=>{let r=!1;const u=n.map(v=>{const _=setRef(v,t);return!r&&typeof _=="function"&&(r=!0),_});if(r)return()=>{for(let v=0;v<u.length;v++){const _=u[v];typeof _=="function"?_():setRef(n[v],null)}}}}function useComposedRefs(...n){return reactExports.useCallback(composeRefs(...n),n)}class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const u=r.offsetParent,v=isHTMLElement(u)&&u.offsetWidth||0,_=this.props.sizeRef.current;_.height=r.offsetHeight||0,_.width=r.offsetWidth||0,_.top=r.offsetTop,_.left=r.offsetLeft,_.right=v-_.width-_.left}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:n,isPresent:t,anchorX:r,root:u}){const v=reactExports.useId(),_=reactExports.useRef(null),b=reactExports.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:p}=reactExports.useContext(MotionConfigContext),y=useComposedRefs(_,n?.ref);return reactExports.useInsertionEffect(()=>{const{width:k,height:g,top:M,left:P,right:R}=b.current;if(t||!_.current||!k||!g)return;const S=r==="left"?`left: ${P}`:`right: ${R}`;_.current.dataset.motionPopId=v;const a=document.createElement("style");p&&(a.nonce=p);const s=u??document.head;return s.appendChild(a),a.sheet&&a.sheet.insertRule(`
          [data-motion-pop-id="${v}"] {
            position: absolute !important;
            width: ${k}px !important;
            height: ${g}px !important;
            ${S}px !important;
            top: ${M}px !important;
          }
        `),()=>{s.contains(a)&&s.removeChild(a)}},[t]),jsxRuntimeExports$1.jsx(PopChildMeasure,{isPresent:t,childRef:_,sizeRef:b,children:reactExports.cloneElement(n,{ref:y})})}const PresenceChild=({children:n,initial:t,isPresent:r,onExitComplete:u,custom:v,presenceAffectsLayout:_,mode:b,anchorX:p,root:y})=>{const k=useConstant(newChildrenMap),g=reactExports.useId();let M=!0,P=reactExports.useMemo(()=>(M=!1,{id:g,initial:t,isPresent:r,custom:v,onExitComplete:R=>{k.set(R,!0);for(const S of k.values())if(!S)return;u&&u()},register:R=>(k.set(R,!1),()=>k.delete(R))}),[r,k,u]);return _&&M&&(P={...P}),reactExports.useMemo(()=>{k.forEach((R,S)=>k.set(S,!1))},[r]),reactExports.useEffect(()=>{!r&&!k.size&&u&&u()},[r]),b==="popLayout"&&(n=jsxRuntimeExports$1.jsx(PopChild,{isPresent:r,anchorX:p,root:y,children:n})),jsxRuntimeExports$1.jsx(PresenceContext.Provider,{value:P,children:n})};function newChildrenMap(){return new Map}function usePresence(n=!0){const t=reactExports.useContext(PresenceContext);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:u,register:v}=t,_=reactExports.useId();reactExports.useEffect(()=>{if(n)return v(_)},[n]);const b=reactExports.useCallback(()=>n&&u&&u(_),[_,u,n]);return!r&&u?[!1,b]:[!0]}const getChildKey=n=>n.key||"";function onlyElements(n){const t=[];return reactExports.Children.forEach(n,r=>{reactExports.isValidElement(r)&&t.push(r)}),t}const AnimatePresence=({children:n,custom:t,initial:r=!0,onExitComplete:u,presenceAffectsLayout:v=!0,mode:_="sync",propagate:b=!1,anchorX:p="left",root:y})=>{const[k,g]=usePresence(b),M=reactExports.useMemo(()=>onlyElements(n),[n]),P=b&&!k?[]:M.map(getChildKey),R=reactExports.useRef(!0),S=reactExports.useRef(M),a=useConstant(()=>new Map),[s,c]=reactExports.useState(M),[w,x]=reactExports.useState(M);useIsomorphicLayoutEffect(()=>{R.current=!1,S.current=M;for(let h=0;h<w.length;h++){const C=getChildKey(w[h]);P.includes(C)?a.delete(C):a.get(C)!==!0&&a.set(C,!1)}},[w,P.length,P.join("-")]);const T=[];if(M!==s){let h=[...M];for(let C=0;C<w.length;C++){const E=w[C],D=getChildKey(E);P.includes(D)||(h.splice(C,0,E),T.push(E))}return _==="wait"&&T.length&&(h=T),x(onlyElements(h)),c(M),null}const{forceRender:l}=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports$1.jsx(jsxRuntimeExports$1.Fragment,{children:w.map(h=>{const C=getChildKey(h),E=b&&!k?!1:M===w||P.includes(C),D=()=>{if(a.has(C))a.set(C,!0);else return;let z=!0;a.forEach(L=>{L||(z=!1)}),z&&(l?.(),x(S.current),b&&g?.(),u&&u())};return jsxRuntimeExports$1.jsx(PresenceChild,{isPresent:E,initial:!R.current||r?void 0:!1,custom:t,presenceAffectsLayout:v,mode:_,root:y,onExitComplete:E?void 0:D,anchorX:p,children:h},C)})})},LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const n in featureProps)featureDefinitions[n]={isEnabled:t=>featureProps[n].some(r=>!!t[r])};function loadFeatures(n){for(const t in n)featureDefinitions[t]={...featureDefinitions[t],...n[t]}}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||validMotionProps.has(n)}let shouldForward=n=>!isValidMotionProp(n);function loadExternalIsValidProp(n){typeof n=="function"&&(shouldForward=t=>t.startsWith("on")?!isValidMotionProp(t):n(t))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(n,t,r){const u={};for(const v in n)v==="values"&&typeof n.values=="object"||(shouldForward(v)||r===!0&&isValidMotionProp(v)||!t&&!isValidMotionProp(v)||n.draggable&&v.startsWith("onDrag"))&&(u[v]=n[v]);return u}const MotionContext=reactExports.createContext({});function isAnimationControls(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function isVariantLabel(n){return typeof n=="string"||Array.isArray(n)}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(n){return isAnimationControls(n.animate)||variantProps.some(t=>isVariantLabel(n[t]))}function isVariantNode(n){return!!(isControllingVariants(n)||n.variants)}function getCurrentTreeVariants(n,t){if(isControllingVariants(n)){const{initial:r,animate:u}=n;return{initial:r===!1||isVariantLabel(r)?r:void 0,animate:isVariantLabel(u)?u:void 0}}return n.inherit!==!1?t:{}}function useCreateMotionContext(n){const{initial:t,animate:r}=getCurrentTreeVariants(n,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:t,animate:r}),[variantLabelsAsDependency(t),variantLabelsAsDependency(r)])}function variantLabelsAsDependency(n){return Array.isArray(n)?n.join(" "):n}const scaleCorrectors={};function addScaleCorrector(n){for(const t in n)scaleCorrectors[t]=n[t],isCSSVariableName(t)&&(scaleCorrectors[t].isCSSVariable=!0)}function isForcedMotionValue(n,{layout:t,layoutId:r}){return transformProps.has(n)||n.startsWith("origin")||(t||r!==void 0)&&(!!scaleCorrectors[n]||n==="opacity")}const translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(n,t,r){let u="",v=!0;for(let _=0;_<numTransforms;_++){const b=transformPropOrder[_],p=n[b];if(p===void 0)continue;let y=!0;if(typeof p=="number"?y=p===(b.startsWith("scale")?1:0):y=parseFloat(p)===0,!y||r){const k=getValueAsType(p,numberValueTypes[b]);if(!y){v=!1;const g=translateAlias[b]||b;u+=`${g}(${k}) `}r&&(t[b]=k)}}return u=u.trim(),r?u=r(t,v?"":u):v&&(u="none"),u}function buildHTMLStyles(n,t,r){const{style:u,vars:v,transformOrigin:_}=n;let b=!1,p=!1;for(const y in t){const k=t[y];if(transformProps.has(y)){b=!0;continue}else if(isCSSVariableName(y)){v[y]=k;continue}else{const g=getValueAsType(k,numberValueTypes[y]);y.startsWith("origin")?(p=!0,_[y]=g):u[y]=g}}if(t.transform||(b||r?u.transform=buildTransform(t,n.transform,r):u.transform&&(u.transform="none")),p){const{originX:y="50%",originY:k="50%",originZ:g=0}=_;u.transformOrigin=`${y} ${k} ${g}`}}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(n,t,r){for(const u in t)!isMotionValue(t[u])&&!isForcedMotionValue(u,r)&&(n[u]=t[u])}function useInitialMotionValues({transformTemplate:n},t){return reactExports.useMemo(()=>{const r=createHtmlRenderState();return buildHTMLStyles(r,t,n),Object.assign({},r.vars,r.style)},[t])}function useStyle(n,t){const r=n.style||{},u={};return copyRawValuesOnly(u,r,n),Object.assign(u,useInitialMotionValues(n,t)),u}function useHTMLProps(n,t){const r={},u=useStyle(n,t);return n.drag&&n.dragListener!==!1&&(r.draggable=!1,u.userSelect=u.WebkitUserSelect=u.WebkitTouchCallout="none",u.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(r.tabIndex=0),r.style=u,r}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(n,t,r=1,u=0,v=!0){n.pathLength=1;const _=v?dashKeys:camelKeys;n[_.offset]=px.transform(-u);const b=px.transform(t),p=px.transform(r);n[_.array]=`${b} ${p}`}function buildSVGAttrs(n,{attrX:t,attrY:r,attrScale:u,pathLength:v,pathSpacing:_=1,pathOffset:b=0,...p},y,k,g){if(buildHTMLStyles(n,p,k),y){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:M,style:P}=n;M.transform&&(P.transform=M.transform,delete M.transform),(P.transform||M.transformOrigin)&&(P.transformOrigin=M.transformOrigin??"50% 50%",delete M.transformOrigin),P.transform&&(P.transformBox=g?.transformBox??"fill-box",delete M.transformBox),t!==void 0&&(M.x=t),r!==void 0&&(M.y=r),u!==void 0&&(M.scale=u),v!==void 0&&buildSVGPath(M,v,_,b,!1)}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=n=>typeof n=="string"&&n.toLowerCase()==="svg";function useSVGProps(n,t,r,u){const v=reactExports.useMemo(()=>{const _=createSvgRenderState();return buildSVGAttrs(_,t,isSVGTag(u),n.transformTemplate,n.style),{..._.attrs,style:{..._.style}}},[t]);if(n.style){const _={};copyRawValuesOnly(_,n.style,n),v.style={..._,...v.style}}return v}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(n){return typeof n!="string"||n.includes("-")?!1:!!(lowercaseSVGElements.indexOf(n)>-1||/[A-Z]/u.test(n))}function useRender(n,t,r,{latestValues:u},v,_=!1){const p=(isSVGComponent(n)?useSVGProps:useHTMLProps)(t,u,v,n),y=filterProps(t,typeof n=="string",_),k=n!==reactExports.Fragment?{...y,...p,ref:r}:{},{children:g}=t,M=reactExports.useMemo(()=>isMotionValue(g)?g.get():g,[g]);return reactExports.createElement(n,{...k,children:M})}function getValueState(n){const t=[{},{}];return n?.values.forEach((r,u)=>{t[0][u]=r.get(),t[1][u]=r.getVelocity()}),t}function resolveVariantFromProps(n,t,r,u){if(typeof t=="function"){const[v,_]=getValueState(u);t=t(r!==void 0?r:n.custom,v,_)}if(typeof t=="string"&&(t=n.variants&&n.variants[t]),typeof t=="function"){const[v,_]=getValueState(u);t=t(r!==void 0?r:n.custom,v,_)}return t}function resolveMotionValue(n){return isMotionValue(n)?n.get():n}function makeState({scrapeMotionValuesFromProps:n,createRenderState:t},r,u,v){return{latestValues:makeLatestValues(r,u,v,n),renderState:t()}}function makeLatestValues(n,t,r,u){const v={},_=u(n,{});for(const P in _)v[P]=resolveMotionValue(_[P]);let{initial:b,animate:p}=n;const y=isControllingVariants(n),k=isVariantNode(n);t&&k&&!y&&n.inherit!==!1&&(b===void 0&&(b=t.initial),p===void 0&&(p=t.animate));let g=r?r.initial===!1:!1;g=g||b===!1;const M=g?p:b;if(M&&typeof M!="boolean"&&!isAnimationControls(M)){const P=Array.isArray(M)?M:[M];for(let R=0;R<P.length;R++){const S=resolveVariantFromProps(n,P[R]);if(S){const{transitionEnd:a,transition:s,...c}=S;for(const w in c){let x=c[w];if(Array.isArray(x)){const T=g?x.length-1:0;x=x[T]}x!==null&&(v[w]=x)}for(const w in a)v[w]=a[w]}}}return v}const makeUseVisualState=n=>(t,r)=>{const u=reactExports.useContext(MotionContext),v=reactExports.useContext(PresenceContext),_=()=>makeState(n,t,u,v);return r?_():useConstant(_)};function scrapeMotionValuesFromProps$1(n,t,r){const{style:u}=n,v={};for(const _ in u)(isMotionValue(u[_])||t.style&&isMotionValue(t.style[_])||isForcedMotionValue(_,n)||r?.getValue(_)?.liveStyle!==void 0)&&(v[_]=u[_]);return v}const useHTMLVisualState=makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState});function scrapeMotionValuesFromProps(n,t,r){const u=scrapeMotionValuesFromProps$1(n,t,r);for(const v in n)if(isMotionValue(n[v])||isMotionValue(t[v])){const _=transformPropOrder.indexOf(v)!==-1?"attr"+v.charAt(0).toUpperCase()+v.substring(1):v;u[_]=n[v]}return u}const useSVGVisualState=makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState}),motionComponentSymbol=Symbol.for("motionComponentSymbol");function isRefObject(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function useMotionRef(n,t,r){return reactExports.useCallback(u=>{u&&n.onMount&&n.onMount(u),t&&(u?t.mount(u):t.unmount()),r&&(typeof r=="function"?r(u):isRefObject(r)&&(r.current=u))},[t])}const camelToDash=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),SwitchLayoutGroupContext=reactExports.createContext({});function useVisualElement(n,t,r,u,v){const{visualElement:_}=reactExports.useContext(MotionContext),b=reactExports.useContext(LazyContext),p=reactExports.useContext(PresenceContext),y=reactExports.useContext(MotionConfigContext).reducedMotion,k=reactExports.useRef(null);u=u||b.renderer,!k.current&&u&&(k.current=u(n,{visualState:t,parent:_,props:r,presenceContext:p,blockInitialAnimation:p?p.initial===!1:!1,reducedMotionConfig:y}));const g=k.current,M=reactExports.useContext(SwitchLayoutGroupContext);g&&!g.projection&&v&&(g.type==="html"||g.type==="svg")&&createProjectionNode$1(k.current,r,v,M);const P=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{g&&P.current&&g.update(r,p)});const R=r[optimizedAppearDataAttribute],S=reactExports.useRef(!!R&&!window.MotionHandoffIsComplete?.(R)&&window.MotionHasOptimisedAnimation?.(R));return useIsomorphicLayoutEffect(()=>{g&&(P.current=!0,window.MotionIsMounted=!0,g.updateFeatures(),g.scheduleRenderMicrotask(),S.current&&g.animationState&&g.animationState.animateChanges())}),reactExports.useEffect(()=>{g&&(!S.current&&g.animationState&&g.animationState.animateChanges(),S.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(R)}),S.current=!1),g.enteringChildren=void 0)}),g}function createProjectionNode$1(n,t,r,u){const{layoutId:v,layout:_,drag:b,dragConstraints:p,layoutScroll:y,layoutRoot:k,layoutCrossfade:g}=t;n.projection=new r(n.latestValues,t["data-framer-portal-id"]?void 0:getClosestProjectingNode(n.parent)),n.projection.setOptions({layoutId:v,layout:_,alwaysMeasureLayout:!!b||p&&isRefObject(p),visualElement:n,animationType:typeof _=="string"?_:"both",initialPromotionConfig:u,crossfade:g,layoutScroll:y,layoutRoot:k})}function getClosestProjectingNode(n){if(n)return n.options.allowProjection!==!1?n.projection:getClosestProjectingNode(n.parent)}function createMotionComponent(n,{forwardMotionProps:t=!1}={},r,u){r&&loadFeatures(r);const v=isSVGComponent(n)?useSVGVisualState:useHTMLVisualState;function _(p,y){let k;const g={...reactExports.useContext(MotionConfigContext),...p,layoutId:useLayoutId(p)},{isStatic:M}=g,P=useCreateMotionContext(p),R=v(p,M);if(!M&&isBrowser){useStrictMode();const S=getProjectionFunctionality(g);k=S.MeasureLayout,P.visualElement=useVisualElement(n,R,g,u,S.ProjectionNode)}return jsxRuntimeExports$1.jsxs(MotionContext.Provider,{value:P,children:[k&&P.visualElement?jsxRuntimeExports$1.jsx(k,{visualElement:P.visualElement,...g}):null,useRender(n,p,useMotionRef(R,P.visualElement,y),R,M,t)]})}_.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const b=reactExports.forwardRef(_);return b[motionComponentSymbol]=n,b}function useLayoutId({layoutId:n}){const t=reactExports.useContext(LayoutGroupContext).id;return t&&n!==void 0?t+"-"+n:n}function useStrictMode(n,t){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(n){const{drag:t,layout:r}=featureDefinitions;if(!t&&!r)return{};const u={...t,...r};return{MeasureLayout:t?.isEnabled(n)||r?.isEnabled(n)?u.MeasureLayout:void 0,ProjectionNode:u.ProjectionNode}}function createMotionProxy(n,t){if(typeof Proxy>"u")return createMotionComponent;const r=new Map,u=(_,b)=>createMotionComponent(_,b,n,t),v=(_,b)=>u(_,b);return new Proxy(v,{get:(_,b)=>b==="create"?u:(r.has(b)||r.set(b,createMotionComponent(b,void 0,n,t)),r.get(b))})}function convertBoundingBoxToBox({top:n,left:t,right:r,bottom:u}){return{x:{min:t,max:r},y:{min:n,max:u}}}function convertBoxToBoundingBox({x:n,y:t}){return{top:t.min,right:n.max,bottom:t.max,left:n.min}}function transformBoxPoints(n,t){if(!t)return n;const r=t({x:n.left,y:n.top}),u=t({x:n.right,y:n.bottom});return{top:r.y,left:r.x,bottom:u.y,right:u.x}}function isIdentityScale(n){return n===void 0||n===1}function hasScale({scale:n,scaleX:t,scaleY:r}){return!isIdentityScale(n)||!isIdentityScale(t)||!isIdentityScale(r)}function hasTransform(n){return hasScale(n)||has2DTranslate(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function has2DTranslate(n){return is2DTranslate(n.x)||is2DTranslate(n.y)}function is2DTranslate(n){return n&&n!=="0%"}function scalePoint(n,t,r){const u=n-r,v=t*u;return r+v}function applyPointDelta(n,t,r,u,v){return v!==void 0&&(n=scalePoint(n,v,u)),scalePoint(n,r,u)+t}function applyAxisDelta(n,t=0,r=1,u,v){n.min=applyPointDelta(n.min,t,r,u,v),n.max=applyPointDelta(n.max,t,r,u,v)}function applyBoxDelta(n,{x:t,y:r}){applyAxisDelta(n.x,t.translate,t.scale,t.originPoint),applyAxisDelta(n.y,r.translate,r.scale,r.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(n,t,r,u=!1){const v=r.length;if(!v)return;t.x=t.y=1;let _,b;for(let p=0;p<v;p++){_=r[p],b=_.projectionDelta;const{visualElement:y}=_.options;y&&y.props.style&&y.props.style.display==="contents"||(u&&_.options.layoutScroll&&_.scroll&&_!==_.root&&transformBox(n,{x:-_.scroll.offset.x,y:-_.scroll.offset.y}),b&&(t.x*=b.x.scale,t.y*=b.y.scale,applyBoxDelta(n,b)),u&&hasTransform(_.latestValues)&&transformBox(n,_.latestValues))}t.x<TREE_SCALE_SNAP_MAX&&t.x>TREE_SCALE_SNAP_MIN&&(t.x=1),t.y<TREE_SCALE_SNAP_MAX&&t.y>TREE_SCALE_SNAP_MIN&&(t.y=1)}function translateAxis(n,t){n.min=n.min+t,n.max=n.max+t}function transformAxis(n,t,r,u,v=.5){const _=mixNumber$1(n.min,n.max,v);applyAxisDelta(n,t,r,_,u)}function transformBox(n,t){transformAxis(n.x,t.x,t.scaleX,t.scale,t.originX),transformAxis(n.y,t.y,t.scaleY,t.scale,t.originY)}function measureViewportBox(n,t){return convertBoundingBoxToBox(transformBoxPoints(n.getBoundingClientRect(),t))}function measurePageBox(n,t,r){const u=measureViewportBox(n,r),{scroll:v}=t;return v&&(translateAxis(u.x,v.offset.x),translateAxis(u.y,v.offset.y)),u}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()}),prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),t=()=>prefersReducedMotion.current=n.matches;n.addEventListener("change",t),t()}else prefersReducedMotion.current=!1}const visualElementStore=new WeakMap;function updateMotionValuesFromProps(n,t,r){for(const u in t){const v=t[u],_=r[u];if(isMotionValue(v))n.addValue(u,v);else if(isMotionValue(_))n.addValue(u,motionValue(v,{owner:n}));else if(_!==v)if(n.hasValue(u)){const b=n.getValue(u);b.liveStyle===!0?b.jump(v):b.hasAnimated||b.set(v)}else{const b=n.getStaticValue(u);n.addValue(u,motionValue(b!==void 0?b:v,{owner:n}))}}for(const u in r)t[u]===void 0&&n.removeValue(u);return t}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps(t,r,u){return{}}constructor({parent:t,props:r,presenceContext:u,reducedMotionConfig:v,blockInitialAnimation:_,visualState:b},p={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const P=time.now();this.renderScheduledAt<P&&(this.renderScheduledAt=P,frame.render(this.render,!1,!0))};const{latestValues:y,renderState:k}=b;this.latestValues=y,this.baseTarget={...y},this.initialValues=r.initial?{...y}:{},this.renderState=k,this.parent=t,this.props=r,this.presenceContext=u,this.depth=t?t.depth+1:0,this.reducedMotionConfig=v,this.options=p,this.blockInitialAnimation=!!_,this.isControllingVariants=isControllingVariants(r),this.isVariantNode=isVariantNode(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:g,...M}=this.scrapeMotionValuesFromProps(r,{},this);for(const P in M){const R=M[P];y[P]!==void 0&&isMotionValue(R)&&R.set(y[P])}}mount(t){this.current=t,visualElementStore.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,u)=>this.bindToMotionValue(u,r)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const u=transformProps.has(t);u&&this.onBindTransform&&this.onBindTransform();const v=r.on("change",b=>{this.latestValues[t]=b,this.props.onUpdate&&frame.preRender(this.notifyUpdate),u&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let _;window.MotionCheckAppearSync&&(_=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{v(),_&&_(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in featureDefinitions){const r=featureDefinitions[t];if(!r)continue;const{isEnabled:u,Feature:v}=r;if(!this.features[t]&&v&&u(this.props)&&(this.features[t]=new v(this)),this.features[t]){const _=this.features[t];_.isMounted?_.update():(_.mount(),_.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let u=0;u<propEventHandlers.length;u++){const v=propEventHandlers[u];this.propEventSubscriptions[v]&&(this.propEventSubscriptions[v](),delete this.propEventSubscriptions[v]);const _="on"+v,b=t[_];b&&(this.propEventSubscriptions[v]=this.on(v,b))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const u=this.values.get(t);r!==u&&(u&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let u=this.values.get(t);return u===void 0&&r!==void 0&&(u=motionValue(r===null?void 0:r,{owner:this}),this.addValue(t,u)),u}readValue(t,r){let u=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return u!=null&&(typeof u=="string"&&(isNumericalString(u)||isZeroValueString(u))?u=parseFloat(u):!findValueType(u)&&complex.test(r)&&(u=getAnimatableNone(t,r)),this.setBaseTarget(t,isMotionValue(u)?u.get():u)),isMotionValue(u)?u.get():u}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){const{initial:r}=this.props;let u;if(typeof r=="string"||typeof r=="object"){const _=resolveVariantFromProps(this.props,r,this.presenceContext?.custom);_&&(u=_[t])}if(r&&u!==void 0)return u;const v=this.getBaseTargetFromProps(this.props,t);return v!==void 0&&!isMotionValue(v)?v:this.initialValues[t]!==void 0&&u===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new SubscriptionManager),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){microtask.render(this.render)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:u}){delete r[t],delete u[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;isMotionValue(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function renderHTML(n,{style:t,vars:r},u,v){const _=n.style;let b;for(b in t)_[b]=t[b];v?.applyProjectionStyles(_,u);for(b in r)_.setProperty(b,r[b])}function getComputedStyle$1(n){return window.getComputedStyle(n)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(t,r){if(transformProps.has(r))return this.projection?.isProjecting?defaultTransformValue(r):readTransformValue(t,r);{const u=getComputedStyle$1(t),v=(isCSSVariableName(r)?u.getPropertyValue(r):u[r])||0;return typeof v=="string"?v.trim():v}}measureInstanceViewportBox(t,{transformPagePoint:r}){return measureViewportBox(t,r)}build(t,r,u){buildHTMLStyles(t,r,u.transformTemplate)}scrapeMotionValuesFromProps(t,r,u){return scrapeMotionValuesFromProps$1(t,r,u)}}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(n,t,r,u){renderHTML(n,t,void 0,u);for(const v in t.attrs)n.setAttribute(camelCaseAttributes.has(v)?v:camelToDash(v),t.attrs[v])}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(transformProps.has(r)){const u=getDefaultValueType(r);return u&&u.default||0}return r=camelCaseAttributes.has(r)?r:camelToDash(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,u){return scrapeMotionValuesFromProps(t,r,u)}build(t,r,u){buildSVGAttrs(t,r,this.isSVGTag,u.transformTemplate,u.style)}renderInstance(t,r,u,v){renderSVG(t,r,u,v)}mount(t){this.isSVGTag=isSVGTag(t.tagName),super.mount(t)}}const createDomVisualElement=(n,t)=>isSVGComponent(n)?new SVGVisualElement(t):new HTMLVisualElement(t,{allowProjection:n!==reactExports.Fragment});function resolveVariant(n,t,r){const u=n.getProps();return resolveVariantFromProps(u,t,r!==void 0?r:u.custom,n)}const isKeyframesTarget=n=>Array.isArray(n);function setMotionValue(n,t,r){n.hasValue(t)?n.getValue(t).set(r):n.addValue(t,motionValue(r))}function resolveFinalValueInKeyframes(n){return isKeyframesTarget(n)?n[n.length-1]||0:n}function setTarget(n,t){const r=resolveVariant(n,t);let{transitionEnd:u={},transition:v={},..._}=r||{};_={..._,...u};for(const b in _){const p=resolveFinalValueInKeyframes(_[b]);setMotionValue(n,b,p)}}function isWillChangeMotionValue(n){return!!(isMotionValue(n)&&n.add)}function addValueToWillChange(n,t){const r=n.getValue("willChange");if(isWillChangeMotionValue(r))return r.add(t);if(!r&&MotionGlobalConfig.WillChange){const u=new MotionGlobalConfig.WillChange("auto");n.addValue("willChange",u),u.add(t)}}function getOptimisedAppearId(n){return n.props[optimizedAppearDataAttribute]}const isNotNull=n=>n!==null;function getFinalKeyframe(n,{repeat:t,repeatType:r="loop"},u){const v=n.filter(isNotNull),_=t&&r!=="loop"&&t%2===1?0:v.length-1;return v[_]}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(n,{keyframes:t})=>t.length>2?keyframesTransition:transformProps.has(n)?n.startsWith("scale")?criticallyDampedSpring(t[1]):underDampedSpring:ease;function isTransitionDefined({when:n,delay:t,delayChildren:r,staggerChildren:u,staggerDirection:v,repeat:_,repeatType:b,repeatDelay:p,from:y,elapsed:k,...g}){return!!Object.keys(g).length}const animateMotionValue=(n,t,r,u={},v,_)=>b=>{const p=getValueTransition(u,n)||{},y=p.delay||u.delay||0;let{elapsed:k=0}=u;k=k-secondsToMilliseconds(y);const g={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...p,delay:-k,onUpdate:P=>{t.set(P),p.onUpdate&&p.onUpdate(P)},onComplete:()=>{b(),p.onComplete&&p.onComplete()},name:n,motionValue:t,element:_?void 0:v};isTransitionDefined(p)||Object.assign(g,getDefaultTransition(n,g)),g.duration&&(g.duration=secondsToMilliseconds(g.duration)),g.repeatDelay&&(g.repeatDelay=secondsToMilliseconds(g.repeatDelay)),g.from!==void 0&&(g.keyframes[0]=g.from);let M=!1;if((g.type===!1||g.duration===0&&!g.repeatDelay)&&(makeAnimationInstant(g),g.delay===0&&(M=!0)),(MotionGlobalConfig.instantAnimations||MotionGlobalConfig.skipAnimations)&&(M=!0,makeAnimationInstant(g),g.delay=0),g.allowFlatten=!p.type&&!p.ease,M&&!_&&t.get()!==void 0){const P=getFinalKeyframe(g.keyframes,p);if(P!==void 0){frame.update(()=>{g.onUpdate(P),g.onComplete()});return}}return p.isSync?new JSAnimation(g):new AsyncMotionValueAnimation(g)};function shouldBlockAnimation({protectedKeys:n,needsAnimating:t},r){const u=n.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,u}function animateTarget(n,t,{delay:r=0,transitionOverride:u,type:v}={}){let{transition:_=n.getDefaultTransition(),transitionEnd:b,...p}=t;u&&(_=u);const y=[],k=v&&n.animationState&&n.animationState.getState()[v];for(const g in p){const M=n.getValue(g,n.latestValues[g]??null),P=p[g];if(P===void 0||k&&shouldBlockAnimation(k,g))continue;const R={delay:r,...getValueTransition(_||{},g)},S=M.get();if(S!==void 0&&!M.isAnimating&&!Array.isArray(P)&&P===S&&!R.velocity)continue;let a=!1;if(window.MotionHandoffAnimation){const c=getOptimisedAppearId(n);if(c){const w=window.MotionHandoffAnimation(c,g,frame);w!==null&&(R.startTime=w,a=!0)}}addValueToWillChange(n,g),M.start(animateMotionValue(g,M,P,n.shouldReduceMotion&&positionalKeys.has(g)?{type:!1}:R,n,a));const s=M.animation;s&&y.push(s)}return b&&Promise.all(y).then(()=>{frame.update(()=>{b&&setTarget(n,b)})}),y}function calcChildStagger(n,t,r,u=0,v=1){const _=Array.from(n).sort((k,g)=>k.sortNodePosition(g)).indexOf(t),b=n.size,p=(b-1)*u;return typeof r=="function"?r(_,b):v===1?_*u:p-_*u}function animateVariant(n,t,r={}){const u=resolveVariant(n,t,r.type==="exit"?n.presenceContext?.custom:void 0);let{transition:v=n.getDefaultTransition()||{}}=u||{};r.transitionOverride&&(v=r.transitionOverride);const _=u?()=>Promise.all(animateTarget(n,u,r)):()=>Promise.resolve(),b=n.variantChildren&&n.variantChildren.size?(y=0)=>{const{delayChildren:k=0,staggerChildren:g,staggerDirection:M}=v;return animateChildren(n,t,y,k,g,M,r)}:()=>Promise.resolve(),{when:p}=v;if(p){const[y,k]=p==="beforeChildren"?[_,b]:[b,_];return y().then(()=>k())}else return Promise.all([_(),b(r.delay)])}function animateChildren(n,t,r=0,u=0,v=0,_=1,b){const p=[];for(const y of n.variantChildren)y.notify("AnimationStart",t),p.push(animateVariant(y,t,{...b,delay:r+(typeof u=="function"?0:u)+calcChildStagger(n.variantChildren,y,u,v,_)}).then(()=>y.notify("AnimationComplete",t)));return Promise.all(p)}function animateVisualElement(n,t,r={}){n.notify("AnimationStart",t);let u;if(Array.isArray(t)){const v=t.map(_=>animateVariant(n,_,r));u=Promise.all(v)}else if(typeof t=="string")u=animateVariant(n,t,r);else{const v=typeof t=="function"?resolveVariant(n,t,r.custom):t;u=Promise.all(animateTarget(n,v,r))}return u.then(()=>{n.notify("AnimationComplete",t)})}function shallowCompare(n,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==n.length)return!1;for(let u=0;u<r;u++)if(t[u]!==n[u])return!1;return!0}const numVariantProps=variantProps.length;function getVariantContext(n){if(!n)return;if(!n.isControllingVariants){const r=n.parent?getVariantContext(n.parent)||{}:{};return n.props.initial!==void 0&&(r.initial=n.props.initial),r}const t={};for(let r=0;r<numVariantProps;r++){const u=variantProps[r],v=n.props[u];(isVariantLabel(v)||v===!1)&&(t[u]=v)}return t}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(n){return t=>Promise.all(t.map(({animation:r,options:u})=>animateVisualElement(n,r,u)))}function createAnimationState(n){let t=animateList(n),r=createState(),u=!0;const v=y=>(k,g)=>{const M=resolveVariant(n,g,y==="exit"?n.presenceContext?.custom:void 0);if(M){const{transition:P,transitionEnd:R,...S}=M;k={...k,...S,...R}}return k};function _(y){t=y(n)}function b(y){const{props:k}=n,g=getVariantContext(n.parent)||{},M=[],P=new Set;let R={},S=1/0;for(let s=0;s<numAnimationTypes;s++){const c=reversePriorityOrder[s],w=r[c],x=k[c]!==void 0?k[c]:g[c],T=isVariantLabel(x),l=c===y?w.isActive:null;l===!1&&(S=s);let h=x===g[c]&&x!==k[c]&&T;if(h&&u&&n.manuallyAnimateOnMount&&(h=!1),w.protectedKeys={...R},!w.isActive&&l===null||!x&&!w.prevProp||isAnimationControls(x)||typeof x=="boolean")continue;const C=checkVariantsDidChange(w.prevProp,x);let E=C||c===y&&w.isActive&&!h&&T||s>S&&T,D=!1;const z=Array.isArray(x)?x:[x];let L=z.reduce(v(c),{});l===!1&&(L={});const{prevResolvedValues:V={}}=w,O={...V,...L},W=U=>{E=!0,P.has(U)&&(D=!0,P.delete(U)),w.needsAnimating[U]=!0;const B=n.getValue(U);B&&(B.liveStyle=!1)};for(const U in O){const B=L[U],Y=V[U];if(R.hasOwnProperty(U))continue;let X=!1;isKeyframesTarget(B)&&isKeyframesTarget(Y)?X=!shallowCompare(B,Y):X=B!==Y,X?B!=null?W(U):P.add(U):B!==void 0&&P.has(U)?W(U):w.protectedKeys[U]=!0}w.prevProp=x,w.prevResolvedValues=L,w.isActive&&(R={...R,...L}),u&&n.blockInitialAnimation&&(E=!1);const H=h&&C;E&&(!H||D)&&M.push(...z.map(U=>{const B={type:c};if(typeof U=="string"&&u&&!H&&n.manuallyAnimateOnMount&&n.parent){const{parent:Y}=n,X=resolveVariant(Y,U);if(Y.enteringChildren&&X){const{delayChildren:j}=X.transition||{};B.delay=calcChildStagger(Y.enteringChildren,n,j)}}return{animation:U,options:B}}))}if(P.size){const s={};if(typeof k.initial!="boolean"){const c=resolveVariant(n,Array.isArray(k.initial)?k.initial[0]:k.initial);c&&c.transition&&(s.transition=c.transition)}P.forEach(c=>{const w=n.getBaseTarget(c),x=n.getValue(c);x&&(x.liveStyle=!0),s[c]=w??null}),M.push({animation:s})}let a=!!M.length;return u&&(k.initial===!1||k.initial===k.animate)&&!n.manuallyAnimateOnMount&&(a=!1),u=!1,a?t(M):Promise.resolve()}function p(y,k){if(r[y].isActive===k)return Promise.resolve();n.variantChildren?.forEach(M=>M.animationState?.setActive(y,k)),r[y].isActive=k;const g=b(y);for(const M in r)r[M].protectedKeys={};return g}return{animateChanges:b,setActive:p,setAnimateFunction:_,getState:()=>r,reset:()=>{r=createState(),u=!0}}}function checkVariantsDidChange(n,t){return typeof t=="string"?t!==n:Array.isArray(t)?!shallowCompare(t,n):!1}function createTypeState(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor(t){this.isMounted=!1,this.node=t}update(){}}class AnimationFeature extends Feature{constructor(t){super(t),t.animationState||(t.animationState=createAnimationState(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();isAnimationControls(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:u}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===u)return;const v=this.node.animationState.setActive("exit",!t);r&&!t&&v.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function addDomEvent(n,t,r,u={passive:!0}){return n.addEventListener(t,r,u),()=>n.removeEventListener(t,r)}function extractEventInfo(n){return{point:{x:n.pageX,y:n.pageY}}}const addPointerInfo=n=>t=>isPrimaryPointer(t)&&n(t,extractEventInfo(t));function addPointerEvent(n,t,r,u){return addDomEvent(n,t,addPointerInfo(r),u)}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(n){return n.max-n.min}function isNear(n,t,r){return Math.abs(n-t)<=r}function calcAxisDelta(n,t,r,u=.5){n.origin=u,n.originPoint=mixNumber$1(t.min,t.max,n.origin),n.scale=calcLength(r)/calcLength(t),n.translate=mixNumber$1(r.min,r.max,n.origin)-n.originPoint,(n.scale>=SCALE_MIN&&n.scale<=SCALE_MAX||isNaN(n.scale))&&(n.scale=1),(n.translate>=TRANSLATE_MIN&&n.translate<=TRANSLATE_MAX||isNaN(n.translate))&&(n.translate=0)}function calcBoxDelta(n,t,r,u){calcAxisDelta(n.x,t.x,r.x,u?u.originX:void 0),calcAxisDelta(n.y,t.y,r.y,u?u.originY:void 0)}function calcRelativeAxis(n,t,r){n.min=r.min+t.min,n.max=n.min+calcLength(t)}function calcRelativeBox(n,t,r){calcRelativeAxis(n.x,t.x,r.x),calcRelativeAxis(n.y,t.y,r.y)}function calcRelativeAxisPosition(n,t,r){n.min=t.min-r.min,n.max=n.min+calcLength(t)}function calcRelativePosition(n,t,r){calcRelativeAxisPosition(n.x,t.x,r.x),calcRelativeAxisPosition(n.y,t.y,r.y)}function eachAxis(n){return[n("x"),n("y")]}const getContextWindow=({current:n})=>n?n.ownerDocument.defaultView:null,distance=(n,t)=>Math.abs(n-t);function distance2D(n,t){const r=distance(n.x,t.x),u=distance(n.y,t.y);return Math.sqrt(r**2+u**2)}class PanSession{constructor(t,r,{transformPagePoint:u,contextWindow:v=window,dragSnapToOrigin:_=!1,distanceThreshold:b=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const P=getPanInfo(this.lastMoveEventInfo,this.history),R=this.startEvent!==null,S=distance2D(P.offset,{x:0,y:0})>=this.distanceThreshold;if(!R&&!S)return;const{point:a}=P,{timestamp:s}=frameData;this.history.push({...a,timestamp:s});const{onStart:c,onMove:w}=this.handlers;R||(c&&c(this.lastMoveEvent,P),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,P)},this.handlePointerMove=(P,R)=>{this.lastMoveEvent=P,this.lastMoveEventInfo=transformPoint(R,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(P,R)=>{this.end();const{onEnd:S,onSessionEnd:a,resumeAnimation:s}=this.handlers;if(this.dragSnapToOrigin&&s&&s(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const c=getPanInfo(P.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(R,this.transformPagePoint),this.history);this.startEvent&&S&&S(P,c),a&&a(P,c)},!isPrimaryPointer(t))return;this.dragSnapToOrigin=_,this.handlers=r,this.transformPagePoint=u,this.distanceThreshold=b,this.contextWindow=v||window;const p=extractEventInfo(t),y=transformPoint(p,this.transformPagePoint),{point:k}=y,{timestamp:g}=frameData;this.history=[{...k,timestamp:g}];const{onSessionStart:M}=r;M&&M(t,getPanInfo(y,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(n,t){return t?{point:t(n.point)}:n}function subtractPoint(n,t){return{x:n.x-t.x,y:n.y-t.y}}function getPanInfo({point:n},t){return{point:n,delta:subtractPoint(n,lastDevicePoint(t)),offset:subtractPoint(n,startDevicePoint(t)),velocity:getVelocity(t,.1)}}function startDevicePoint(n){return n[0]}function lastDevicePoint(n){return n[n.length-1]}function getVelocity(n,t){if(n.length<2)return{x:0,y:0};let r=n.length-1,u=null;const v=lastDevicePoint(n);for(;r>=0&&(u=n[r],!(v.timestamp-u.timestamp>secondsToMilliseconds(t)));)r--;if(!u)return{x:0,y:0};const _=millisecondsToSeconds(v.timestamp-u.timestamp);if(_===0)return{x:0,y:0};const b={x:(v.x-u.x)/_,y:(v.y-u.y)/_};return b.x===1/0&&(b.x=0),b.y===1/0&&(b.y=0),b}function applyConstraints(n,{min:t,max:r},u){return t!==void 0&&n<t?n=u?mixNumber$1(t,n,u.min):Math.max(n,t):r!==void 0&&n>r&&(n=u?mixNumber$1(r,n,u.max):Math.min(n,r)),n}function calcRelativeAxisConstraints(n,t,r){return{min:t!==void 0?n.min+t:void 0,max:r!==void 0?n.max+r-(n.max-n.min):void 0}}function calcRelativeConstraints(n,{top:t,left:r,bottom:u,right:v}){return{x:calcRelativeAxisConstraints(n.x,r,v),y:calcRelativeAxisConstraints(n.y,t,u)}}function calcViewportAxisConstraints(n,t){let r=t.min-n.min,u=t.max-n.max;return t.max-t.min<n.max-n.min&&([r,u]=[u,r]),{min:r,max:u}}function calcViewportConstraints(n,t){return{x:calcViewportAxisConstraints(n.x,t.x),y:calcViewportAxisConstraints(n.y,t.y)}}function calcOrigin(n,t){let r=.5;const u=calcLength(n),v=calcLength(t);return v>u?r=progress(t.min,t.max-u,n.min):u>v&&(r=progress(n.min,n.max-v,t.min)),clamp(0,1,r)}function rebaseAxisConstraints(n,t){const r={};return t.min!==void 0&&(r.min=t.min-n.min),t.max!==void 0&&(r.max=t.max-n.min),r}const defaultElastic=.35;function resolveDragElastic(n=defaultElastic){return n===!1?n=0:n===!0&&(n=defaultElastic),{x:resolveAxisElastic(n,"left","right"),y:resolveAxisElastic(n,"top","bottom")}}function resolveAxisElastic(n,t,r){return{min:resolvePointElastic(n,t),max:resolvePointElastic(n,r)}}function resolvePointElastic(n,t){return typeof n=="number"?n:n[t]||0}const elementDragControls=new WeakMap;class VisualElementDragControls{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:u}={}){const{presenceContext:v}=this.visualElement;if(v&&v.isPresent===!1)return;const _=M=>{const{dragSnapToOrigin:P}=this.getProps();P?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(extractEventInfo(M).point)},b=(M,P)=>{const{drag:R,dragPropagation:S,onDragStart:a}=this.getProps();if(R&&!S&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(R),!this.openDragLock))return;this.latestPointerEvent=M,this.latestPanInfo=P,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(c=>{let w=this.getAxisMotionValue(c).get()||0;if(percent.test(w)){const{projection:x}=this.visualElement;if(x&&x.layout){const T=x.layout.layoutBox[c];T&&(w=calcLength(T)*(parseFloat(w)/100))}}this.originPoint[c]=w}),a&&frame.postRender(()=>a(M,P)),addValueToWillChange(this.visualElement,"transform");const{animationState:s}=this.visualElement;s&&s.setActive("whileDrag",!0)},p=(M,P)=>{this.latestPointerEvent=M,this.latestPanInfo=P;const{dragPropagation:R,dragDirectionLock:S,onDirectionLock:a,onDrag:s}=this.getProps();if(!R&&!this.openDragLock)return;const{offset:c}=P;if(S&&this.currentDirection===null){this.currentDirection=getCurrentDirection(c),this.currentDirection!==null&&a&&a(this.currentDirection);return}this.updateAxis("x",P.point,c),this.updateAxis("y",P.point,c),this.visualElement.render(),s&&s(M,P)},y=(M,P)=>{this.latestPointerEvent=M,this.latestPanInfo=P,this.stop(M,P),this.latestPointerEvent=null,this.latestPanInfo=null},k=()=>eachAxis(M=>this.getAnimationState(M)==="paused"&&this.getAxisMotionValue(M).animation?.play()),{dragSnapToOrigin:g}=this.getProps();this.panSession=new PanSession(t,{onSessionStart:_,onStart:b,onMove:p,onSessionEnd:y,resumeAnimation:k},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:g,distanceThreshold:u,contextWindow:getContextWindow(this.visualElement)})}stop(t,r){const u=t||this.latestPointerEvent,v=r||this.latestPanInfo,_=this.isDragging;if(this.cancel(),!_||!v||!u)return;const{velocity:b}=v;this.startAnimation(b);const{onDragEnd:p}=this.getProps();p&&frame.postRender(()=>p(u,v))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:u}=this.getProps();!u&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,u){const{drag:v}=this.getProps();if(!u||!shouldDrag(t,v,this.currentDirection))return;const _=this.getAxisMotionValue(t);let b=this.originPoint[t]+u[t];this.constraints&&this.constraints[t]&&(b=applyConstraints(b,this.constraints[t],this.elastic[t])),_.set(b)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),u=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,v=this.constraints;t&&isRefObject(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&u?this.constraints=calcRelativeConstraints(u.layoutBox,t):this.constraints=!1,this.elastic=resolveDragElastic(r),v!==this.constraints&&u&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(_=>{this.constraints!==!1&&this.getAxisMotionValue(_)&&(this.constraints[_]=rebaseAxisConstraints(u.layoutBox[_],this.constraints[_]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!isRefObject(t))return!1;const u=t.current,{projection:v}=this.visualElement;if(!v||!v.layout)return!1;const _=measurePageBox(u,v.root,this.visualElement.getTransformPagePoint());let b=calcViewportConstraints(v.layout.layoutBox,_);if(r){const p=r(convertBoxToBoundingBox(b));this.hasMutatedConstraints=!!p,p&&(b=convertBoundingBoxToBox(p))}return b}startAnimation(t){const{drag:r,dragMomentum:u,dragElastic:v,dragTransition:_,dragSnapToOrigin:b,onDragTransitionEnd:p}=this.getProps(),y=this.constraints||{},k=eachAxis(g=>{if(!shouldDrag(g,r,this.currentDirection))return;let M=y&&y[g]||{};b&&(M={min:0,max:0});const P=v?200:1e6,R=v?40:1e7,S={type:"inertia",velocity:u?t[g]:0,bounceStiffness:P,bounceDamping:R,timeConstant:750,restDelta:1,restSpeed:10,..._,...M};return this.startAxisValueAnimation(g,S)});return Promise.all(k).then(p)}startAxisValueAnimation(t,r){const u=this.getAxisMotionValue(t);return addValueToWillChange(this.visualElement,t),u.start(animateMotionValue(t,u,0,r,this.visualElement,!1))}stopAnimation(){eachAxis(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){eachAxis(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,u=this.visualElement.getProps(),v=u[r];return v||this.visualElement.getValue(t,(u.initial?u.initial[t]:void 0)||0)}snapToCursor(t){eachAxis(r=>{const{drag:u}=this.getProps();if(!shouldDrag(r,u,this.currentDirection))return;const{projection:v}=this.visualElement,_=this.getAxisMotionValue(r);if(v&&v.layout){const{min:b,max:p}=v.layout.layoutBox[r];_.set(t[r]-mixNumber$1(b,p,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:u}=this.visualElement;if(!isRefObject(r)||!u||!this.constraints)return;this.stopAnimation();const v={x:0,y:0};eachAxis(b=>{const p=this.getAxisMotionValue(b);if(p&&this.constraints!==!1){const y=p.get();v[b]=calcOrigin({min:y,max:y},this.constraints[b])}});const{transformTemplate:_}=this.visualElement.getProps();this.visualElement.current.style.transform=_?_({},""):"none",u.root&&u.root.updateScroll(),u.updateLayout(),this.resolveConstraints(),eachAxis(b=>{if(!shouldDrag(b,t,null))return;const p=this.getAxisMotionValue(b),{min:y,max:k}=this.constraints[b];p.set(mixNumber$1(y,k,v[b]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const t=this.visualElement.current,r=addPointerEvent(t,"pointerdown",y=>{const{drag:k,dragListener:g=!0}=this.getProps();k&&g&&this.start(y)}),u=()=>{const{dragConstraints:y}=this.getProps();isRefObject(y)&&y.current&&(this.constraints=this.resolveRefConstraints())},{projection:v}=this.visualElement,_=v.addEventListener("measure",u);v&&!v.layout&&(v.root&&v.root.updateScroll(),v.updateLayout()),frame.read(u);const b=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),p=v.addEventListener("didUpdate",(({delta:y,hasLayoutChanged:k})=>{this.isDragging&&k&&(eachAxis(g=>{const M=this.getAxisMotionValue(g);M&&(this.originPoint[g]+=y[g].translate,M.set(M.get()+y[g].translate))}),this.visualElement.render())}));return()=>{b(),r(),_(),p&&p()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:u=!1,dragPropagation:v=!1,dragConstraints:_=!1,dragElastic:b=defaultElastic,dragMomentum:p=!0}=t;return{...t,drag:r,dragDirectionLock:u,dragPropagation:v,dragConstraints:_,dragElastic:b,dragMomentum:p}}}function shouldDrag(n,t,r){return(t===!0||t===n)&&(r===null||r===n)}function getCurrentDirection(n,t=10){let r=null;return Math.abs(n.y)>t?r="y":Math.abs(n.x)>t&&(r="x"),r}class DragGesture extends Feature{constructor(t){super(t),this.removeGroupControls=noop,this.removeListeners=noop,this.controls=new VisualElementDragControls(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=n=>(t,r)=>{n&&frame.postRender(()=>n(t,r))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop}onPointerDown(t){this.session=new PanSession(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:u,onPanEnd:v}=this.node.getProps();return{onSessionStart:asyncHandler(t),onStart:asyncHandler(r),onMove:u,onEnd:(_,b)=>{delete this.session,v&&frame.postRender(()=>v(_,b))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(n,t){return t.max===t.min?0:n/(t.max-t.min)*100}const correctBorderRadius={correct:(n,t)=>{if(!t.target)return n;if(typeof n=="string")if(px.test(n))n=parseFloat(n);else return n;const r=pixelsToPercent(n,t.target.x),u=pixelsToPercent(n,t.target.y);return`${r}% ${u}%`}},correctBoxShadow={correct:(n,{treeScale:t,projectionDelta:r})=>{const u=n,v=complex.parse(n);if(v.length>5)return u;const _=complex.createTransformer(n),b=typeof v[0]!="number"?1:0,p=r.x.scale*t.x,y=r.y.scale*t.y;v[0+b]/=p,v[1+b]/=y;const k=mixNumber$1(p,y,.5);return typeof v[2+b]=="number"&&(v[2+b]/=k),typeof v[3+b]=="number"&&(v[3+b]/=k),_(v)}};let hasTakenAnySnapshot=!1;class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:u,layoutId:v}=this.props,{projection:_}=t;addScaleCorrector(defaultScaleCorrectors),_&&(r.group&&r.group.add(_),u&&u.register&&v&&u.register(_),hasTakenAnySnapshot&&_.root.didUpdate(),_.addEventListener("animationComplete",()=>{this.safeToRemove()}),_.setOptions({..._.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:u,drag:v,isPresent:_}=this.props,{projection:b}=u;return b&&(b.isPresent=_,hasTakenAnySnapshot=!0,v||t.layoutDependency!==r||r===void 0||t.isPresent!==_?b.willUpdate():this.safeToRemove(),t.isPresent!==_&&(_?b.promote():b.relegate()||frame.postRender(()=>{const p=b.getStack();(!p||!p.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),microtask.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:u}=this.props,{projection:v}=t;hasTakenAnySnapshot=!0,v&&(v.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(v),u&&u.deregister&&u.deregister(v))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function MeasureLayout(n){const[t,r]=usePresence(),u=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports$1.jsx(MeasureLayoutWithContext,{...n,layoutGroup:u,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:t,safeToRemove:r})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function animateSingleValue(n,t,r){const u=isMotionValue(n)?n:motionValue(n);return u.start(animateMotionValue("",u,t,r)),u.animation}const compareByDepth=(n,t)=>n.depth-t.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(t){addUniqueItem(this.children,t),this.isDirty=!0}remove(t){removeItem(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(t)}}function delay(n,t){const r=time.now(),u=({timestamp:v})=>{const _=v-r;_>=t&&(cancelFrame(u),n(_-t))};return frame.setup(u,!0),()=>cancelFrame(u)}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=n=>typeof n=="string"?parseFloat(n):n,isPx=n=>typeof n=="number"||px.test(n);function mixValues(n,t,r,u,v,_){v?(n.opacity=mixNumber$1(0,r.opacity??1,easeCrossfadeIn(u)),n.opacityExit=mixNumber$1(t.opacity??1,0,easeCrossfadeOut(u))):_&&(n.opacity=mixNumber$1(t.opacity??1,r.opacity??1,u));for(let b=0;b<numBorders;b++){const p=`border${borders[b]}Radius`;let y=getRadius(t,p),k=getRadius(r,p);if(y===void 0&&k===void 0)continue;y||(y=0),k||(k=0),y===0||k===0||isPx(y)===isPx(k)?(n[p]=Math.max(mixNumber$1(asNumber(y),asNumber(k),u),0),(percent.test(k)||percent.test(y))&&(n[p]+="%")):n[p]=k}(t.rotate||r.rotate)&&(n.rotate=mixNumber$1(t.rotate||0,r.rotate||0,u))}function getRadius(n,t){return n[t]!==void 0?n[t]:n.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop);function compress(n,t,r){return u=>u<n?0:u>t?1:r(progress(n,t,u))}function copyAxisInto(n,t){n.min=t.min,n.max=t.max}function copyBoxInto(n,t){copyAxisInto(n.x,t.x),copyAxisInto(n.y,t.y)}function copyAxisDeltaInto(n,t){n.translate=t.translate,n.scale=t.scale,n.originPoint=t.originPoint,n.origin=t.origin}function removePointDelta(n,t,r,u,v){return n-=t,n=scalePoint(n,1/r,u),v!==void 0&&(n=scalePoint(n,1/v,u)),n}function removeAxisDelta(n,t=0,r=1,u=.5,v,_=n,b=n){if(percent.test(t)&&(t=parseFloat(t),t=mixNumber$1(b.min,b.max,t/100)-b.min),typeof t!="number")return;let p=mixNumber$1(_.min,_.max,u);n===_&&(p-=t),n.min=removePointDelta(n.min,t,r,p,v),n.max=removePointDelta(n.max,t,r,p,v)}function removeAxisTransforms(n,t,[r,u,v],_,b){removeAxisDelta(n,t[r],t[u],t[v],t.scale,_,b)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(n,t,r,u){removeAxisTransforms(n.x,t,xKeys,r?r.x:void 0,u?u.x:void 0),removeAxisTransforms(n.y,t,yKeys,r?r.y:void 0,u?u.y:void 0)}function isAxisDeltaZero(n){return n.translate===0&&n.scale===1}function isDeltaZero(n){return isAxisDeltaZero(n.x)&&isAxisDeltaZero(n.y)}function axisEquals(n,t){return n.min===t.min&&n.max===t.max}function boxEquals(n,t){return axisEquals(n.x,t.x)&&axisEquals(n.y,t.y)}function axisEqualsRounded(n,t){return Math.round(n.min)===Math.round(t.min)&&Math.round(n.max)===Math.round(t.max)}function boxEqualsRounded(n,t){return axisEqualsRounded(n.x,t.x)&&axisEqualsRounded(n.y,t.y)}function aspectRatio(n){return calcLength(n.x)/calcLength(n.y)}function axisDeltaEquals(n,t){return n.translate===t.translate&&n.scale===t.scale&&n.originPoint===t.originPoint}class NodeStack{constructor(){this.members=[]}add(t){addUniqueItem(this.members,t),t.scheduleRender()}remove(t){if(removeItem(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(v=>t===v);if(r===0)return!1;let u;for(let v=r;v>=0;v--){const _=this.members[v];if(_.isPresent!==!1){u=_;break}}return u?(this.promote(u),!0):!1}promote(t,r){const u=this.lead;if(t!==u&&(this.prevLead=u,this.lead=t,t.show(),u)){u.instance&&u.scheduleRender(),t.scheduleRender(),t.resumeFrom=u,r&&(t.resumeFrom.preserveOpacity=!0),u.snapshot&&(t.snapshot=u.snapshot,t.snapshot.latestValues=u.animationValues||u.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:v}=t.options;v===!1&&u.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:u}=t;r.onExitComplete&&r.onExitComplete(),u&&u.options.onExitComplete&&u.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(n,t,r){let u="";const v=n.x.translate/t.x,_=n.y.translate/t.y,b=r?.z||0;if((v||_||b)&&(u=`translate3d(${v}px, ${_}px, ${b}px) `),(t.x!==1||t.y!==1)&&(u+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:k,rotate:g,rotateX:M,rotateY:P,skewX:R,skewY:S}=r;k&&(u=`perspective(${k}px) ${u}`),g&&(u+=`rotate(${g}deg) `),M&&(u+=`rotateX(${M}deg) `),P&&(u+=`rotateY(${P}deg) `),R&&(u+=`skewX(${R}deg) `),S&&(u+=`skewY(${S}deg) `)}const p=n.x.scale*t.x,y=n.y.scale*t.y;return(p!==1||y!==1)&&(u+=`scale(${p}, ${y})`),u||"none"}const transformAxes=["","X","Y","Z"],animationTarget=1e3;let id=0;function resetDistortingTransform(n,t,r,u){const{latestValues:v}=t;v[n]&&(r[n]=v[n],t.setStaticValue(n,0),u&&(u[n]=0))}function cancelTreeOptimisedTransformAnimations(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:t}=n.options;if(!t)return;const r=getOptimisedAppearId(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:v,layoutId:_}=n.options;window.MotionCancelOptimisedAnimation(r,"transform",frame,!(v||_))}const{parent:u}=n;u&&!u.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(u)}function createProjectionNode({attachResizeListener:n,defaultParent:t,measureScroll:r,checkIsScrollRoot:u,resetTransform:v}){return class{constructor(b={},p=t?.()){this.id=id++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=b,this.root=p?p.root||p:this,this.path=p?[...p.path,p]:[],this.parent=p,this.depth=p?p.depth+1:0;for(let y=0;y<this.path.length;y++)this.path[y].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(b,p){return this.eventHandlers.has(b)||this.eventHandlers.set(b,new SubscriptionManager),this.eventHandlers.get(b).add(p)}notifyListeners(b,...p){const y=this.eventHandlers.get(b);y&&y.notify(...p)}hasListeners(b){return this.eventHandlers.has(b)}mount(b){if(this.instance)return;this.isSVG=isSVGElement(b)&&!isSVGSVGElement(b),this.instance=b;const{layoutId:p,layout:y,visualElement:k}=this.options;if(k&&!k.current&&k.mount(b),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(y||p)&&(this.isLayoutDirty=!0),n){let g,M=0;const P=()=>this.root.updateBlockedByResize=!1;frame.read(()=>{M=window.innerWidth}),n(b,()=>{const R=window.innerWidth;R!==M&&(M=R,this.root.updateBlockedByResize=!0,g&&g(),g=delay(P,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation)))})}p&&this.root.registerSharedNode(p,this),this.options.animate!==!1&&k&&(p||y)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:M,hasRelativeLayoutChanged:P,layout:R})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const S=this.options.transition||k.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:a,onLayoutAnimationComplete:s}=k.getProps(),c=!this.targetLayout||!boxEqualsRounded(this.targetLayout,R),w=!M&&P;if(this.options.layoutRoot||this.resumeFrom||w||M&&(c||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const x={...getValueTransition(S,"layout"),onPlay:a,onComplete:s};(k.shouldReduceMotion||this.options.layoutRoot)&&(x.delay=0,x.type=!1),this.startAnimation(x),this.setAnimationOrigin(g,w)}else M||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=R})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const b=this.getStack();b&&b.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:b}=this.options;return b&&b.getProps().transformTemplate}willUpdate(b=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let g=0;g<this.path.length;g++){const M=this.path[g];M.shouldResetTransform=!0,M.updateScroll("snapshot"),M.options.layoutRoot&&M.willUpdate(!1)}const{layoutId:p,layout:y}=this.options;if(p===void 0&&!y)return;const k=this.getTransformTemplate();this.prevTransformTemplateValue=k?k(this.latestValues,""):void 0,this.updateSnapshot(),b&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(clearIsLayoutDirty);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate)):this.nodes.forEach(clearIsLayoutDirty),this.clearAllSnapshots();const p=time.now();frameData.delta=clamp(0,1e3/60,p-frameData.timestamp),frameData.timestamp=p,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!calcLength(this.snapshot.measuredBox.x)&&!calcLength(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let y=0;y<this.path.length;y++)this.path[y].updateScroll();const b=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:p}=this.options;p&&p.notify("LayoutMeasure",this.layout.layoutBox,b?b.layoutBox:void 0)}updateScroll(b="measure"){let p=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===b&&(p=!1),p&&this.instance){const y=u(this.instance);this.scroll={animationId:this.root.animationId,phase:b,isRoot:y,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:y}}}resetTransform(){if(!v)return;const b=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,p=this.projectionDelta&&!isDeltaZero(this.projectionDelta),y=this.getTransformTemplate(),k=y?y(this.latestValues,""):void 0,g=k!==this.prevTransformTemplateValue;b&&this.instance&&(p||hasTransform(this.latestValues)||g)&&(v(this.instance,k),this.shouldResetTransform=!1,this.scheduleRender())}measure(b=!0){const p=this.measurePageBox();let y=this.removeElementScroll(p);return b&&(y=this.removeTransform(y)),roundBox(y),{animationId:this.root.animationId,measuredBox:p,layoutBox:y,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:b}=this.options;if(!b)return createBox();const p=b.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(checkNodeWasScrollRoot))){const{scroll:k}=this.root;k&&(translateAxis(p.x,k.offset.x),translateAxis(p.y,k.offset.y))}return p}removeElementScroll(b){const p=createBox();if(copyBoxInto(p,b),this.scroll?.wasRoot)return p;for(let y=0;y<this.path.length;y++){const k=this.path[y],{scroll:g,options:M}=k;k!==this.root&&g&&M.layoutScroll&&(g.wasRoot&&copyBoxInto(p,b),translateAxis(p.x,g.offset.x),translateAxis(p.y,g.offset.y))}return p}applyTransform(b,p=!1){const y=createBox();copyBoxInto(y,b);for(let k=0;k<this.path.length;k++){const g=this.path[k];!p&&g.options.layoutScroll&&g.scroll&&g!==g.root&&transformBox(y,{x:-g.scroll.offset.x,y:-g.scroll.offset.y}),hasTransform(g.latestValues)&&transformBox(y,g.latestValues)}return hasTransform(this.latestValues)&&transformBox(y,this.latestValues),y}removeTransform(b){const p=createBox();copyBoxInto(p,b);for(let y=0;y<this.path.length;y++){const k=this.path[y];if(!k.instance||!hasTransform(k.latestValues))continue;hasScale(k.latestValues)&&k.updateSnapshot();const g=createBox(),M=k.measurePageBox();copyBoxInto(g,M),removeBoxTransforms(p,k.latestValues,k.snapshot?k.snapshot.layoutBox:void 0,g)}return hasTransform(this.latestValues)&&removeBoxTransforms(p,this.latestValues),p}setTargetDelta(b){this.targetDelta=b,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(b){this.options={...this.options,...b,crossfade:b.crossfade!==void 0?b.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(b=!1){const p=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=p.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=p.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=p.isSharedProjectionDirty);const y=!!this.resumingFrom||this!==p;if(!(b||y&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:M}=this.options;if(!(!this.layout||!(g||M))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const P=this.getClosestProjectingParent();P&&P.layout&&this.animationProgress!==1?(this.relativeParent=P,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,P.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const P=this.getClosestProjectingParent();P&&!!P.resumingFrom==!!this.resumingFrom&&!P.options.layoutScroll&&P.target&&this.animationProgress!==1?(this.relativeParent=P,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,P.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const b=this.getLead(),p=!!this.resumingFrom||this!==b;let y=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(y=!1),p&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(y=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(y=!1),y)return;const{layout:k,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(k||g))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const M=this.treeScale.x,P=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,p),b.layout&&!b.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(b.target=b.layout.layoutBox,b.targetWithTransforms=createBox());const{target:R}=b;if(!R){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,R,this.latestValues),(this.treeScale.x!==M||this.treeScale.y!==P||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",R))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(b=!0){if(this.options.visualElement?.scheduleRender(),b){const p=this.getStack();p&&p.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(b,p=!1){const y=this.snapshot,k=y?y.latestValues:{},g={...this.latestValues},M=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!p;const P=createBox(),R=y?y.source:void 0,S=this.layout?this.layout.source:void 0,a=R!==S,s=this.getStack(),c=!s||s.members.length<=1,w=!!(a&&!c&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let x;this.mixTargetDelta=T=>{const l=T/1e3;mixAxisDelta(M.x,b.x,l),mixAxisDelta(M.y,b.y,l),this.setTargetDelta(M),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(P,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,P,l),x&&boxEquals(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=createBox()),copyBoxInto(x,this.relativeTarget)),a&&(this.animationValues=g,mixValues(g,k,this.latestValues,l,w,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=l},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(b){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=motionValue(0)),this.currentAnimation=animateSingleValue(this.motionValue,[0,1e3],{...b,velocity:0,isSync:!0,onUpdate:p=>{this.mixTargetDelta(p),b.onUpdate&&b.onUpdate(p)},onStop:()=>{},onComplete:()=>{b.onComplete&&b.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const b=this.getStack();b&&b.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const b=this.getLead();let{targetWithTransforms:p,target:y,layout:k,latestValues:g}=b;if(!(!p||!y||!k)){if(this!==b&&this.layout&&k&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,k.layoutBox)){y=this.target||createBox();const M=calcLength(this.layout.layoutBox.x);y.x.min=b.target.x.min,y.x.max=y.x.min+M;const P=calcLength(this.layout.layoutBox.y);y.y.min=b.target.y.min,y.y.max=y.y.min+P}copyBoxInto(p,y),transformBox(p,g),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,p,g)}}registerSharedNode(b,p){this.sharedNodes.has(b)||this.sharedNodes.set(b,new NodeStack),this.sharedNodes.get(b).add(p);const k=p.options.initialPromotionConfig;p.promote({transition:k?k.transition:void 0,preserveFollowOpacity:k&&k.shouldPreserveFollowOpacity?k.shouldPreserveFollowOpacity(p):void 0})}isLead(){const b=this.getStack();return b?b.lead===this:!0}getLead(){const{layoutId:b}=this.options;return b?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:b}=this.options;return b?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:b}=this.options;if(b)return this.root.sharedNodes.get(b)}promote({needsReset:b,transition:p,preserveFollowOpacity:y}={}){const k=this.getStack();k&&k.promote(this,y),b&&(this.projectionDelta=void 0,this.needsReset=!0),p&&this.setOptions({transition:p})}relegate(){const b=this.getStack();return b?b.relegate(this):!1}resetSkewAndRotation(){const{visualElement:b}=this.options;if(!b)return;let p=!1;const{latestValues:y}=b;if((y.z||y.rotate||y.rotateX||y.rotateY||y.rotateZ||y.skewX||y.skewY)&&(p=!0),!p)return;const k={};y.z&&resetDistortingTransform("z",b,k,this.animationValues);for(let g=0;g<transformAxes.length;g++)resetDistortingTransform(`rotate${transformAxes[g]}`,b,k,this.animationValues),resetDistortingTransform(`skew${transformAxes[g]}`,b,k,this.animationValues);b.render();for(const g in k)b.setStaticValue(g,k[g]),this.animationValues&&(this.animationValues[g]=k[g]);b.scheduleRender()}applyProjectionStyles(b,p){if(!this.instance||this.isSVG)return;if(!this.isVisible){b.visibility="hidden";return}const y=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,b.visibility="",b.opacity="",b.pointerEvents=resolveMotionValue(p?.pointerEvents)||"",b.transform=y?y(this.latestValues,""):"none";return}const k=this.getLead();if(!this.projectionDelta||!this.layout||!k.target){this.options.layoutId&&(b.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,b.pointerEvents=resolveMotionValue(p?.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(b.transform=y?y({},""):"none",this.hasProjected=!1);return}b.visibility="";const g=k.animationValues||k.latestValues;this.applyTransformsToTarget();let M=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,g);y&&(M=y(g,M)),b.transform=M;const{x:P,y:R}=this.projectionDelta;b.transformOrigin=`${P.origin*100}% ${R.origin*100}% 0`,k.animationValues?b.opacity=k===this?g.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:g.opacityExit:b.opacity=k===this?g.opacity!==void 0?g.opacity:"":g.opacityExit!==void 0?g.opacityExit:0;for(const S in scaleCorrectors){if(g[S]===void 0)continue;const{correct:a,applyTo:s,isCSSVariable:c}=scaleCorrectors[S],w=M==="none"?g[S]:a(g[S],k);if(s){const x=s.length;for(let T=0;T<x;T++)b[s[T]]=w}else c?this.options.visualElement.renderState.vars[S]=w:b[S]=w}this.options.layoutId&&(b.pointerEvents=k===this?resolveMotionValue(p?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(b=>b.currentAnimation?.stop()),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(n){n.updateLayout()}function notifyLayoutUpdate(n){const t=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:u}=n.layout,{animationType:v}=n.options,_=t.source!==n.layout.source;v==="size"?eachAxis(g=>{const M=_?t.measuredBox[g]:t.layoutBox[g],P=calcLength(M);M.min=r[g].min,M.max=M.min+P}):shouldAnimatePositionOnly(v,t.layoutBox,r)&&eachAxis(g=>{const M=_?t.measuredBox[g]:t.layoutBox[g],P=calcLength(r[g]);M.max=M.min+P,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[g].max=n.relativeTarget[g].min+P)});const b=createDelta();calcBoxDelta(b,r,t.layoutBox);const p=createDelta();_?calcBoxDelta(p,n.applyTransform(u,!0),t.measuredBox):calcBoxDelta(p,r,t.layoutBox);const y=!isDeltaZero(b);let k=!1;if(!n.resumeFrom){const g=n.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:M,layout:P}=g;if(M&&P){const R=createBox();calcRelativePosition(R,t.layoutBox,M.layoutBox);const S=createBox();calcRelativePosition(S,r,P.layoutBox),boxEqualsRounded(R,S)||(k=!0),g.options.layoutRoot&&(n.relativeTarget=S,n.relativeTargetOrigin=R,n.relativeParent=g)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:p,layoutDelta:b,hasLayoutChanged:y,hasRelativeLayoutChanged:k})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function propagateDirtyNodes(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function cleanDirtyNodes(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function clearSnapshot(n){n.clearSnapshot()}function clearMeasurements(n){n.clearMeasurements()}function clearIsLayoutDirty(n){n.isLayoutDirty=!1}function resetTransformStyle(n){const{visualElement:t}=n.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),n.resetTransform()}function finishAnimation(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function resolveTargetDelta(n){n.resolveTargetDelta()}function calcProjection(n){n.calcProjection()}function resetSkewAndRotation(n){n.resetSkewAndRotation()}function removeLeadSnapshots(n){n.removeLeadSnapshot()}function mixAxisDelta(n,t,r){n.translate=mixNumber$1(t.translate,0,r),n.scale=mixNumber$1(t.scale,1,r),n.origin=t.origin,n.originPoint=t.originPoint}function mixAxis(n,t,r,u){n.min=mixNumber$1(t.min,r.min,u),n.max=mixNumber$1(t.max,r.max,u)}function mixBox(n,t,r,u){mixAxis(n.x,t.x,r.x,u),mixAxis(n.y,t.y,r.y,u)}function hasOpacityCrossfade(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop;function roundAxis(n){n.min=roundPoint(n.min),n.max=roundPoint(n.max)}function roundBox(n){roundAxis(n.x),roundAxis(n.y)}function shouldAnimatePositionOnly(n,t,r){return n==="position"||n==="preserve-aspect"&&!isNear(aspectRatio(t),aspectRatio(r),.2)}function checkNodeWasScrollRoot(n){return n!==n.root&&n.scroll?.wasRoot}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(n,t)=>addDomEvent(n,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const n=new DocumentProjectionNode({});n.mount(window),n.setOptions({layoutScroll:!0}),rootProjectionNode.current=n}return rootProjectionNode.current},resetTransform:(n,t)=>{n.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(n,t,r){const{props:u}=n;n.animationState&&u.whileHover&&n.animationState.setActive("whileHover",r==="Start");const v="onHover"+r,_=u[v];_&&frame.postRender(()=>_(t,extractEventInfo(t)))}class HoverGesture extends Feature{mount(){const{current:t}=this.node;t&&(this.unmount=hover(t,(r,u)=>(handleHoverEvent(this.node,u,"Start"),v=>handleHoverEvent(this.node,v,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(n,t,r){const{props:u}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&u.whileTap&&n.animationState.setActive("whileTap",r==="Start");const v="onTap"+(r==="End"?"":r),_=u[v];_&&frame.postRender(()=>_(t,extractEventInfo(t)))}class PressGesture extends Feature{mount(){const{current:t}=this.node;t&&(this.unmount=press(t,(r,u)=>(handlePressEvent(this.node,u,"Start"),(v,{success:_})=>handlePressEvent(this.node,v,_?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=n=>{const t=observerCallbacks.get(n.target);t&&t(n)},fireAllObserverCallbacks=n=>{n.forEach(fireObserverCallback)};function initIntersectionObserver({root:n,...t}){const r=n||document;observers.has(r)||observers.set(r,{});const u=observers.get(r),v=JSON.stringify(t);return u[v]||(u[v]=new IntersectionObserver(fireAllObserverCallbacks,{root:n,...t})),u[v]}function observeIntersection(n,t,r){const u=initIntersectionObserver(t);return observerCallbacks.set(n,r),u.observe(n),()=>{observerCallbacks.delete(n),u.unobserve(n)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:u,amount:v="some",once:_}=t,b={root:r?r.current:void 0,rootMargin:u,threshold:typeof v=="number"?v:thresholdNames[v]},p=y=>{const{isIntersecting:k}=y;if(this.isInView===k||(this.isInView=k,_&&!k&&this.hasEnteredView))return;k&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",k);const{onViewportEnter:g,onViewportLeave:M}=this.node.getProps(),P=k?g:M;P&&P(y)};return observeIntersection(this.node.current,b,p)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(t,r))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:n={}},{viewport:t={}}={}){return r=>n[r]!==t[r]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},featureBundle={...animations,...gestureAnimations,...drag,...layout},motion=createMotionProxy(featureBundle,createDomVisualElement),slateDropdown=`
 w-full border-2 border-slate-300
 bg-slate-200 py-2 px-3 rounded shadow hover:cursor-pointer
hover:bg-slate-300 disabled:cursor-not-allowed
 disabled:bg-gray-100`;async function getProvidersList(n="https://raw.githubusercontent.com/Materials-Consortia/providers/refs/heads/master/src/links/v1/providers.json"){try{const t=await fetch(n);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){console.warn("Remote fetch failed, falling back to cachedProviders.json:",t);try{const r=await fetch("cachedProviders.json");if(!r.ok)throw new Error(`Fallback fetch failed! status: ${r.status}`);return await r.json()}catch(r){throw console.error("Both remote and local fetches failed:",r),r}}}async function getProviderLinks(n){const t=v=>(v.data||[]).filter(_=>_.attributes?.link_type==="child"),r=[{name:"direct",url:`${n}/v1/links`},{name:"allorigins",url:`https://api.allorigins.win/raw?url=${encodeURIComponent(`${n}/v1/links`)}`},{name:"cors-anywhere",url:`https://cors-anywhere.com/${n}/v1/links`}];for(const{url:v,name:_}of r)try{const b=await fetch(v);if(!b.ok)continue;const p=await b.json();return{children:t(p),error:null}}catch{continue}const u=new Error("All fetch methods failed");return{children:[],error:u}}async function getStructures({providerUrl:n,filter:t="",page:r=1,pageSize:u=20}){if(!n)throw new Error("Provider URL is required");const v=(r-1)*u,_=t?`?filter=${encodeURIComponent(t)}&page_offset=${v}`:`?page_offset=${v}`,b=`${n}/v1/structures${_}`,p=await fetch(b);if(!p.ok)throw new Error(`Failed to fetch structures: ${p.status}`);return await p.json()}function OptimadeHeader(){return jsxRuntimeExports$1.jsx("div",{className:"flex justify-center py-4 bg-white shadow w-full",children:jsxRuntimeExports$1.jsx("img",{src:"optimade_logo.png",alt:"OptimadeLogo",className:"h-24 sm:h-32 w-auto object-contain"})})}function DropdownWithSpinner({options:n=[],value:t,onChange:r,placeholder:u="-- Select --",width:v="w-72",loading:_=!1,showCustomInput:b=!1,customValue:p,onCustomChange:y}){const[k,g]=reactExports.useState(!1),[M,P]=reactExports.useState(t||""),[R,S]=reactExports.useState(!1),a=reactExports.useRef();reactExports.useEffect(()=>{function w(x){a.current&&!a.current.contains(x.target)&&g(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]);const s=w=>{w==="__custom__"?(S(!0),P(""),r?.(null)):(S(!1),P(w),r?.(w)),g(!1)},c=R?"Enter Custom Endpoint":M?n.find(w=>w.value===M)?.label||M:u;return jsxRuntimeExports$1.jsxs("div",{className:`relative ${v}`,ref:a,children:[jsxRuntimeExports$1.jsxs("div",{className:`${slateDropdown} flex justify-between`,onClick:()=>g(!k),children:[jsxRuntimeExports$1.jsx("span",{className:"truncate",children:c}),jsxRuntimeExports$1.jsxs("div",{className:"flex items-center space-x-2",children:[_&&jsxRuntimeExports$1.jsx("div",{className:"w-5 h-5 border-2 border-t-2 border-gray-400 border-t-blue-500 rounded-full animate-spin"}),jsxRuntimeExports$1.jsx("svg",{className:`w-4 h-4 transform transition-transform duration-200 ${k?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports$1.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),k&&jsxRuntimeExports$1.jsxs("ul",{className:"absolute left-0 right-0 max-h-60 overflow-auto border border-slate-300 bg-white rounded shadow mt-1 z-50",children:[n.map(w=>jsxRuntimeExports$1.jsx("li",{className:"truncate px-4 py-2 hover:bg-blue-100 cursor-pointer",onClick:()=>s(w.value),children:w.label},w.value)),b&&jsxRuntimeExports$1.jsx("li",{className:"truncate px-4 py-2 hover:bg-blue-100 cursor-pointer",onClick:()=>s("__custom__"),children:"Enter Custom Endpoint"})]}),R&&b&&jsxRuntimeExports$1.jsx("input",{type:"text",value:p,onChange:w=>y?.(w.target.value),placeholder:"Enter custom endpoint URL",className:"w-full mt-2 border-2 border-slate-300 bg-slate-200 py-2 px-4 rounded shadow focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}function OptimadeProviderDropdown({providers:n=[],loading:t,error:r,onSelectUrl:u}){const[v,_]=reactExports.useState(""),[b,p]=reactExports.useState([]),[y,k]=reactExports.useState(""),[g,M]=reactExports.useState(""),[P,R]=reactExports.useState(!1);return reactExports.useEffect(()=>{async function S(a){R(!0);const{children:s}=await getProviderLinks(a);s.length===1?(k(s[0].attributes.base_url),p([]),u?.(s[0].attributes.base_url)):(p(s),k(""),u?.(a)),R(!1)}v&&v!=="__custom__"?S(v):(p([]),k(""),v!=="__custom__"&&u?.(null))},[v]),reactExports.useEffect(()=>{y&&u?.(y)},[y]),reactExports.useEffect(()=>{g&&u?.(g)},[g]),jsxRuntimeExports$1.jsxs("div",{className:"flex flex-col items-center w-full px-4 py-6",children:[jsxRuntimeExports$1.jsx("h1",{className:"text-2xl font-bold pb-4 text-center",children:"Query a database"}),jsxRuntimeExports$1.jsxs("section",{className:"flex flex-col space-y-4 w-full max-w-3xl",children:[t&&jsxRuntimeExports$1.jsx("p",{className:"text-gray-500 text-center",children:"Loading providers…"}),r&&jsxRuntimeExports$1.jsx("p",{className:"text-red-500 text-center",children:"Failed to load providers"}),!t&&!r&&jsxRuntimeExports$1.jsxs(jsxRuntimeExports$1.Fragment,{children:[jsxRuntimeExports$1.jsx("div",{className:"w-full",children:jsxRuntimeExports$1.jsx(DropdownWithSpinner,{options:n.filter(S=>S.attributes?.base_url).map(S=>({label:S.attributes.name||S.id,value:S.attributes.base_url})),value:v,onChange:_,loading:P,showCustomInput:!0,customValue:g,onCustomChange:M,width:"w-full"})}),b.length>1&&jsxRuntimeExports$1.jsx("div",{className:"w-full",children:jsxRuntimeExports$1.jsx(DropdownWithSpinner,{options:b.map(S=>({label:S.attributes.name||S.id,value:S.attributes.base_url})),value:y,onChange:k,width:"w-full"})})]})]})]})}const elements=[{num:1,sym:"H",row:1,col:1,group:"group1"},{num:2,sym:"He",row:1,col:18,group:"group18"},{num:3,sym:"Li",row:2,col:1,group:"group1"},{num:4,sym:"Be",row:2,col:2,group:"group2"},{num:5,sym:"B",row:2,col:13,group:"metalloid"},{num:6,sym:"C",row:2,col:14,group:"mainGroup"},{num:7,sym:"N",row:2,col:15,group:"mainGroup"},{num:8,sym:"O",row:2,col:16,group:"mainGroup"},{num:9,sym:"F",row:2,col:17,group:"group17"},{num:10,sym:"Ne",row:2,col:18,group:"group18"},{num:11,sym:"Na",row:3,col:1,group:"group1"},{num:12,sym:"Mg",row:3,col:2,group:"group2"},{num:13,sym:"Al",row:3,col:13,group:"postTransition"},{num:14,sym:"Si",row:3,col:14,group:"metalloid"},{num:15,sym:"P",row:3,col:15,group:"mainGroup"},{num:16,sym:"S",row:3,col:16,group:"mainGroup"},{num:17,sym:"Cl",row:3,col:17,group:"group17"},{num:18,sym:"Ar",row:3,col:18,group:"group18"},{num:19,sym:"K",row:4,col:1,group:"group1"},{num:20,sym:"Ca",row:4,col:2,group:"group2"},{num:21,sym:"Sc",row:4,col:3,group:"transition"},{num:22,sym:"Ti",row:4,col:4,group:"transition"},{num:23,sym:"V",row:4,col:5,group:"transition"},{num:24,sym:"Cr",row:4,col:6,group:"transition"},{num:25,sym:"Mn",row:4,col:7,group:"transition"},{num:26,sym:"Fe",row:4,col:8,group:"transition"},{num:27,sym:"Co",row:4,col:9,group:"transition"},{num:28,sym:"Ni",row:4,col:10,group:"transition"},{num:29,sym:"Cu",row:4,col:11,group:"transition"},{num:30,sym:"Zn",row:4,col:12,group:"transition"},{num:31,sym:"Ga",row:4,col:13,group:"postTransition"},{num:32,sym:"Ge",row:4,col:14,group:"metalloid"},{num:33,sym:"As",row:4,col:15,group:"metalloid"},{num:34,sym:"Se",row:4,col:16,group:"mainGroup"},{num:35,sym:"Br",row:4,col:17,group:"group17"},{num:36,sym:"Kr",row:4,col:18,group:"group18"},{num:37,sym:"Rb",row:5,col:1,group:"group1"},{num:38,sym:"Sr",row:5,col:2,group:"group2"},{num:39,sym:"Y",row:5,col:3,group:"transition"},{num:40,sym:"Zr",row:5,col:4,group:"transition"},{num:41,sym:"Nb",row:5,col:5,group:"transition"},{num:42,sym:"Mo",row:5,col:6,group:"transition"},{num:43,sym:"Tc",row:5,col:7,group:"transition"},{num:44,sym:"Ru",row:5,col:8,group:"transition"},{num:45,sym:"Rh",row:5,col:9,group:"transition"},{num:46,sym:"Pd",row:5,col:10,group:"transition"},{num:47,sym:"Ag",row:5,col:11,group:"transition"},{num:48,sym:"Cd",row:5,col:12,group:"transition"},{num:49,sym:"In",row:5,col:13,group:"postTransition"},{num:50,sym:"Sn",row:5,col:14,group:"postTransition"},{num:51,sym:"Sb",row:5,col:15,group:"metalloid"},{num:52,sym:"Te",row:5,col:16,group:"metalloid"},{num:53,sym:"I",row:5,col:17,group:"group17"},{num:54,sym:"Xe",row:5,col:18,group:"group18"},{num:55,sym:"Cs",row:6,col:1,group:"group1"},{num:56,sym:"Ba",row:6,col:2,group:"group2"},{num:72,sym:"Hf",row:6,col:4,group:"transition"},{num:73,sym:"Ta",row:6,col:5,group:"transition"},{num:74,sym:"W",row:6,col:6,group:"transition"},{num:75,sym:"Re",row:6,col:7,group:"transition"},{num:76,sym:"Os",row:6,col:8,group:"transition"},{num:77,sym:"Ir",row:6,col:9,group:"transition"},{num:78,sym:"Pt",row:6,col:10,group:"transition"},{num:79,sym:"Au",row:6,col:11,group:"transition"},{num:80,sym:"Hg",row:6,col:12,group:"transition"},{num:81,sym:"Tl",row:6,col:13,group:"postTransition"},{num:82,sym:"Pb",row:6,col:14,group:"postTransition"},{num:83,sym:"Bi",row:6,col:15,group:"postTransition"},{num:84,sym:"Po",row:6,col:16,group:"postTransition"},{num:85,sym:"At",row:6,col:17,group:"group17"},{num:86,sym:"Rn",row:6,col:18,group:"group18"},{num:87,sym:"Fr",row:7,col:1,group:"group1"},{num:88,sym:"Ra",row:7,col:2,group:"group2"},{num:104,sym:"Rf",row:7,col:4,group:"transition"},{num:105,sym:"Db",row:7,col:5,group:"transition"},{num:106,sym:"Sg",row:7,col:6,group:"transition"},{num:107,sym:"Bh",row:7,col:7,group:"transition"},{num:108,sym:"Hs",row:7,col:8,group:"transition"},{num:109,sym:"Mt",row:7,col:9,group:"bg-lime-200"},{num:110,sym:"Ds",row:7,col:10,group:"bg-lime-200"},{num:111,sym:"Rg",row:7,col:11,group:"bg-lime-200"},{num:112,sym:"Cn",row:7,col:12,group:"bg-lime-200"},{num:113,sym:"Nh",row:7,col:13,group:"bg-lime-200"},{num:114,sym:"Fl",row:7,col:14,group:"bg-lime-200"},{num:115,sym:"Mc",row:7,col:15,group:"bg-lime-200"},{num:116,sym:"Lv",row:7,col:16,group:"bg-lime-200"},{num:117,sym:"Ts",row:7,col:17,group:"bg-lime-200"},{num:118,sym:"Og",row:7,col:18,group:"bg-lime-200"},{num:57,sym:"La",row:12,col:3,group:"lanthanide"},{num:58,sym:"Ce",row:12,col:4,group:"lanthanide"},{num:59,sym:"Pr",row:12,col:5,group:"lanthanide"},{num:60,sym:"Nd",row:12,col:6,group:"lanthanide"},{num:61,sym:"Pm",row:12,col:7,group:"lanthanide"},{num:62,sym:"Sm",row:12,col:8,group:"lanthanide"},{num:63,sym:"Eu",row:12,col:9,group:"lanthanide"},{num:64,sym:"Gd",row:12,col:10,group:"lanthanide"},{num:65,sym:"Tb",row:12,col:11,group:"lanthanide"},{num:66,sym:"Dy",row:12,col:12,group:"lanthanide"},{num:67,sym:"Ho",row:12,col:13,group:"lanthanide"},{num:68,sym:"Er",row:12,col:14,group:"lanthanide"},{num:69,sym:"Tm",row:12,col:15,group:"lanthanide"},{num:70,sym:"Yb",row:12,col:16,group:"lanthanide"},{num:71,sym:"Lu",row:12,col:17,group:"lanthanide"},{num:89,sym:"Ac",row:13,col:3,group:"actinide"},{num:90,sym:"Th",row:13,col:4,group:"actinide"},{num:91,sym:"Pa",row:13,col:5,group:"actinide"},{num:92,sym:"U",row:13,col:6,group:"actinide"},{num:93,sym:"Np",row:13,col:7,group:"actinide"},{num:94,sym:"Pu",row:13,col:8,group:"actinide"},{num:95,sym:"Am",row:13,col:9,group:"actinide"},{num:96,sym:"Cm",row:13,col:10,group:"actinide"},{num:97,sym:"Bk",row:13,col:11,group:"actinide"},{num:98,sym:"Cf",row:13,col:12,group:"actinide"},{num:99,sym:"Es",row:13,col:13,group:"actinide"},{num:100,sym:"Fm",row:13,col:14,group:"actinide"},{num:101,sym:"Md",row:13,col:15,group:"actinide"},{num:102,sym:"No",row:13,col:16,group:"actinide"},{num:103,sym:"Lr",row:13,col:17,group:"actinide"}],defaultColors={group1:"bg-[#d7bbbb]",group2:"bg-[#d7cdbb]",group17:"bg-[#d7d9c2]",group18:"bg-[#d0d5ee]",transition:"bg-[#c4d0d8]",lanthanide:"bg-[#e5cbee]",actinide:"bg-[#aebcee]",metalloid:"bg-[#cdd9c2]",postTransition:"bg-[#c2c8d9]",mainGroup:"bg-[#d9c2ce]",default:"bg-gray-200"};function PTable({selected:n={},onSelectionChange:t,colors:r=defaultColors,selectedClassName:u="bg-green-400 border border-green-700 text-white scale-105",deselectedClassName:v="bg-red-400 border border-red-700 text-white scale-105",defaultBorderClassName:_="border border-slate-700",hoverClassName:b="transform transition-transform duration-100 hover:scale-105 hover:z-10"}){const p=k=>{if(!t)return;const g=((n[k]??0)+1)%3;t({[k]:g})},y=k=>{const g=n[k.sym]??0;let M=r[k.group]??r.default;return g===1?u:g===2?v:`${M} ${_}`};return jsxRuntimeExports$1.jsx("div",{className:"w-full max-w-full mx-auto p-0",children:jsxRuntimeExports$1.jsx("div",{className:"grid gap-0.5 sm:gap-1 w-full",style:{gridTemplateColumns:"repeat(18, minmax(0, 1fr))"},children:elements.map(k=>jsxRuntimeExports$1.jsx("div",{style:{gridColumn:k.col,gridRow:k.row},className:"relative w-full",children:jsxRuntimeExports$1.jsx("div",{className:"w-full aspect-square",children:jsxRuntimeExports$1.jsxs("button",{onClick:()=>p(k.sym),className:`flex flex-col justify-center items-center w-full h-full rounded-sm ${b} ${y(k)}`,children:[jsxRuntimeExports$1.jsx("span",{className:"text-[0%] xs:text-[0%] sm:text-[0%] md:text-[80%] lg:text-[100%] text-gray-700 leading-tight",children:k.num}),jsxRuntimeExports$1.jsx("span",{className:"text-[55%] xs:text-[100%] sm:text-[120%] md:text-[120%] lg:text-[125%] font-medium leading-none",children:k.sym})]})})},k.sym))})})}function QueryTextBox({value:n,onChange:t,placeholder:r="Enter filter…",onSubmit:u,loading:v=!1}){return jsxRuntimeExports$1.jsx("div",{className:"space-y-2",children:jsxRuntimeExports$1.jsxs("form",{onSubmit:_=>{_.preventDefault(),u?.()},className:"flex gap-2",children:[jsxRuntimeExports$1.jsx("input",{type:"text",value:n,onChange:_=>t(_.target.value),placeholder:r,className:"flex-1 p-2 border border-gray-300 rounded shadow focus:outline-none focus:ring-2 focus:ring-blue-500"}),jsxRuntimeExports$1.jsx("button",{type:"submit",disabled:v,className:"px-4 py-2 bg-blue-500 text-white rounded shadow hover:bg-blue-600 disabled:opacity-50",children:v?"Loading…":"Submit"})]})})}var lib={},Range={},utils={},types={},hasRequiredTypes;function requireTypes(){if(hasRequiredTypes)return types;hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0}),types.Direction=void 0;var n;return(function(t){t.Right="to right",t.Left="to left",t.Down="to bottom",t.Up="to top"})(n||(types.Direction=n={})),types}var hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,(function(n){var t=utils&&utils.__spreadArray||function(V,O,W){if(W||arguments.length===2)for(var H=0,q=O.length,U;H<q;H++)(U||!(H in O))&&(U||(U=Array.prototype.slice.call(O,0,H)),U[H]=O[H]);return V.concat(U||Array.prototype.slice.call(O))};Object.defineProperty(n,"__esModule",{value:!0}),n.isIOS=n.useThumbOverlap=n.assertUnreachable=n.voidFn=n.getTrackBackground=n.replaceAt=n.schd=n.translate=n.getClosestThumbIndex=n.translateThumbs=n.getPaddingAndBorder=n.getMargin=n.checkInitialOverlap=n.checkValuesAgainstBoundaries=n.checkBoundaries=n.isVertical=n.relativeValue=n.normalizeValue=n.isStepDivisible=n.isTouchEvent=n.getStepDecimals=void 0;var r=requireReact(),u=requireTypes(),v=function(V){var O=V.toString().split(".")[1];return O?O.length:0};n.getStepDecimals=v;function _(V){return V.touches&&V.touches.length||V.changedTouches&&V.changedTouches.length}n.isTouchEvent=_;function b(V,O,W){var H=(O-V)/W,q=8,U=Number(H.toFixed(q));return parseInt(U.toString(),10)===U}n.isStepDivisible=b;function p(V,O,W,H,q,U,B){var Y=1e11;if(V=Math.round(V*Y)/Y,!U){var X=B[O-1],j=B[O+1];if(X&&X>V)return X;if(j&&j<V)return j}if(V>H)return H;if(V<W)return W;var J=Math.floor(V*Y-W*Y)%Math.floor(q*Y),le=Math.floor(V*Y-Math.abs(J)),se=J===0?V:le/Y,he=Math.abs(J/Y)<q/2?se:se+q,pe=(0,n.getStepDecimals)(q);return parseFloat(he.toFixed(pe))}n.normalizeValue=p;function y(V,O,W){return(V-O)/(W-O)}n.relativeValue=y;function k(V){return V===u.Direction.Up||V===u.Direction.Down}n.isVertical=k;function g(V,O,W){if(O>=W)throw new RangeError("min (".concat(O,") is equal/bigger than max (").concat(W,")"));if(V<O)throw new RangeError("value (".concat(V,") is smaller than min (").concat(O,")"));if(V>W)throw new RangeError("value (".concat(V,") is bigger than max (").concat(W,")"))}n.checkBoundaries=g;function M(V,O,W){return V<O?O:V>W?W:V}n.checkValuesAgainstBoundaries=M;function P(V){if(!(V.length<2)&&!V.slice(1).every(function(O,W){return V[W]<=O}))throw new RangeError("values={[".concat(V,"]} needs to be sorted when allowOverlap={false}"))}n.checkInitialOverlap=P;function R(V){var O=window.getComputedStyle(V);return{top:parseInt(O["margin-top"],10),bottom:parseInt(O["margin-bottom"],10),left:parseInt(O["margin-left"],10),right:parseInt(O["margin-right"],10)}}n.getMargin=R;function S(V){var O=window.getComputedStyle(V);return{top:parseInt(O["padding-top"],10)+parseInt(O["border-top-width"],10),bottom:parseInt(O["padding-bottom"],10)+parseInt(O["border-bottom-width"],10),left:parseInt(O["padding-left"],10)+parseInt(O["border-left-width"],10),right:parseInt(O["padding-right"],10)+parseInt(O["border-right-width"],10)}}n.getPaddingAndBorder=S;function a(V,O,W){var H=W?-1:1;V.forEach(function(q,U){return c(q,H*O[U].x,O[U].y)})}n.translateThumbs=a;function s(V,O,W,H){for(var q=0,U=z(V[0],O,W,H),B=1;B<V.length;B++){var Y=z(V[B],O,W,H);Y<U&&(U=Y,q=B)}return q}n.getClosestThumbIndex=s;function c(V,O,W){V.style.transform="translate(".concat(O,"px, ").concat(W,"px)")}n.translate=c;var w=function(V){var O=[],W=null,H=function(){for(var q=[],U=0;U<arguments.length;U++)q[U]=arguments[U];O=q,!W&&(W=requestAnimationFrame(function(){W=null,V.apply(void 0,O)}))};return H};n.schd=w;function x(V,O,W){var H=V.slice(0);return H[O]=W,H}n.replaceAt=x;function T(V){var O=V.values,W=V.colors,H=V.min,q=V.max,U=V.direction,B=U===void 0?u.Direction.Right:U,Y=V.rtl,X=Y===void 0?!1:Y;X&&B===u.Direction.Right?B=u.Direction.Left:X&&u.Direction.Left&&(B=u.Direction.Right);var j=O.slice(0).sort(function(le,se){return le-se}).map(function(le){return(le-H)/(q-H)*100}),J=j.reduce(function(le,se,he){return"".concat(le,", ").concat(W[he]," ").concat(se,"%, ").concat(W[he+1]," ").concat(se,"%")},"");return"linear-gradient(".concat(B,", ").concat(W[0]," 0%").concat(J,", ").concat(W[W.length-1]," 100%)")}n.getTrackBackground=T;function l(){}n.voidFn=l;function h(V){throw new Error("Didn't expect to get here")}n.assertUnreachable=h;var C=function(V,O,W,H,q){q===void 0&&(q=function(B){return B});var U=Math.ceil(t([V],Array.from(V.children),!0).reduce(function(B,Y){var X=Math.ceil(Y.getBoundingClientRect().width);if(Y.innerText&&Y.innerText.includes(W)&&Y.childElementCount===0){var j=Y.cloneNode(!0);j.innerHTML=q(O.toFixed(H)),j.style.visibility="hidden",document.body.appendChild(j),X=Math.ceil(j.getBoundingClientRect().width),document.body.removeChild(j)}return X>B?X:B},V.getBoundingClientRect().width));return U},E=function(V,O,W,H,q,U,B){B===void 0&&(B=function(j){return j});var Y=[],X=function(j){var J=C(W[j],H[j],q,U,B),le=O[j].x;O.forEach(function(se,he){var pe=se.x,ve=C(W[he],H[he],q,U,B);j!==he&&(le>=pe&&le<=pe+ve||le+J>=pe&&le+J<=pe+ve)&&(Y.includes(he)||(Y.push(j),Y.push(he),Y=t(t([],Y,!0),[j,he],!1),X(he)))})};return X(V),Array.from(new Set(Y.sort()))},D=function(V,O,W,H,q,U){H===void 0&&(H=.1),q===void 0&&(q=" - "),U===void 0&&(U=function(he){return he});var B=(0,n.getStepDecimals)(H),Y=(0,r.useState)({}),X=Y[0],j=Y[1],J=(0,r.useState)(U(O[W].toFixed(B))),le=J[0],se=J[1];return(0,r.useEffect)(function(){if(V){var he=V.getThumbs();if(he.length<1)return;var pe={},ve=V.getOffsets(),ce=E(W,ve,he,O,q,B,U),me=U(O[W].toFixed(B));if(ce.length){var Re=ce.reduce(function(De,qe,Qe,st){return De.length?t(t([],De,!0),[ve[st[Qe]].x],!1):[ve[st[Qe]].x]},[]);if(Math.min.apply(Math,Re)===ve[W].x){var Ge=[];ce.forEach(function(De){Ge.push(O[De].toFixed(B))}),me=Array.from(new Set(Ge.sort(function(De,qe){return parseFloat(De)-parseFloat(qe)}))).map(U).join(q);var We=Math.min.apply(Math,Re),Oe=Math.max.apply(Math,Re),fe=he[ce[Re.indexOf(Oe)]].getBoundingClientRect().width;pe.left="".concat(Math.abs(We-(Oe+fe))/2,"px"),pe.transform="translate(-50%, 0)"}else pe.visibility="hidden"}se(me),j(pe)}},[V,O]),[le,X]};n.useThumbOverlap=D;function z(V,O,W,H){var q=V.getBoundingClientRect(),U=q.left,B=q.top,Y=q.width,X=q.height;return k(H)?Math.abs(W-(B+X/2)):Math.abs(O-(U+Y/2))}var L=function(){var V,O=((V=navigator.userAgentData)===null||V===void 0?void 0:V.platform)||navigator.platform;return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(O)||navigator.userAgent.includes("Mac")&&"ontouchend"in document};n.isIOS=L})(utils)),utils}var hasRequiredRange;function requireRange(){if(hasRequiredRange)return Range;hasRequiredRange=1;var n=Range&&Range.__extends||(function(){var M=function(P,R){return M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,a){S.__proto__=a}||function(S,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(S[s]=a[s])},M(P,R)};return function(P,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");M(P,R);function S(){this.constructor=P}P.prototype=R===null?Object.create(R):(S.prototype=R.prototype,new S)}})(),t=Range&&Range.__createBinding||(Object.create?(function(M,P,R,S){S===void 0&&(S=R);var a=Object.getOwnPropertyDescriptor(P,R);(!a||("get"in a?!P.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return P[R]}}),Object.defineProperty(M,S,a)}):(function(M,P,R,S){S===void 0&&(S=R),M[S]=P[R]})),r=Range&&Range.__setModuleDefault||(Object.create?(function(M,P){Object.defineProperty(M,"default",{enumerable:!0,value:P})}):function(M,P){M.default=P}),u=Range&&Range.__importStar||function(M){if(M&&M.__esModule)return M;var P={};if(M!=null)for(var R in M)R!=="default"&&Object.prototype.hasOwnProperty.call(M,R)&&t(P,M,R);return r(P,M),P},v=Range&&Range.__spreadArray||function(M,P,R){if(R||arguments.length===2)for(var S=0,a=P.length,s;S<a;S++)(s||!(S in P))&&(s||(s=Array.prototype.slice.call(P,0,S)),s[S]=P[S]);return M.concat(s||Array.prototype.slice.call(P))};Object.defineProperty(Range,"__esModule",{value:!0});var _=u(requireReact()),b=requireUtils(),p=requireTypes(),y=["ArrowRight","ArrowUp","k","PageUp"],k=["ArrowLeft","ArrowDown","j","PageDown"],g=(function(M){n(P,M);function P(R){var S=M.call(this,R)||this;if(S.trackRef=_.createRef(),S.thumbRefs=[],S.state={draggedTrackPos:[-1,-1],draggedThumbIndex:-1,thumbZIndexes:new Array(S.props.values.length).fill(0).map(function(a,s){return s}),isChanged:!1,markOffsets:[]},S.getOffsets=function(){var a=S.props,s=a.direction,c=a.values,w=a.min,x=a.max,T=S.trackRef.current;if(!T)return console.warn("No track element found."),[];var l=T.getBoundingClientRect(),h=(0,b.getPaddingAndBorder)(T);return S.getThumbs().map(function(C,E){var D={x:0,y:0},z=C.getBoundingClientRect(),L=(0,b.getMargin)(C);switch(s){case p.Direction.Right:return D.x=(L.left+h.left)*-1,D.y=((z.height-l.height)/2+h.top)*-1,D.x+=l.width*(0,b.relativeValue)(c[E],w,x)-z.width/2,D;case p.Direction.Left:return D.x=(L.right+h.right)*-1,D.y=((z.height-l.height)/2+h.top)*-1,D.x+=l.width-l.width*(0,b.relativeValue)(c[E],w,x)-z.width/2,D;case p.Direction.Up:return D.x=((z.width-l.width)/2+L.left+h.left)*-1,D.y=-h.left,D.y+=l.height-l.height*(0,b.relativeValue)(c[E],w,x)-z.height/2,D;case p.Direction.Down:return D.x=((z.width-l.width)/2+L.left+h.left)*-1,D.y=-h.left,D.y+=l.height*(0,b.relativeValue)(c[E],w,x)-z.height/2,D;default:return(0,b.assertUnreachable)(s)}})},S.getThumbs=function(){return S.trackRef&&S.trackRef.current?Array.from(S.trackRef.current.children).filter(function(a){return a.hasAttribute("aria-valuenow")}):(console.warn("No thumbs found in the track container. Did you forget to pass & spread the `props` param in renderTrack?"),[])},S.getTargetIndex=function(a){return S.getThumbs().findIndex(function(s){return s===a.target||s.contains(a.target)})},S.addTouchEvents=function(a){document.addEventListener("touchmove",S.schdOnTouchMove,{passive:!1}),document.addEventListener("touchend",S.schdOnEnd,{passive:!1}),document.addEventListener("touchcancel",S.schdOnEnd,{passive:!1})},S.addMouseEvents=function(a){document.addEventListener("mousemove",S.schdOnMouseMove),document.addEventListener("mouseup",S.schdOnEnd)},S.onMouseDownTrack=function(a){var s;if(!(a.button!==0||(0,b.isIOS)()))if(a.persist(),a.preventDefault(),S.addMouseEvents(a.nativeEvent),S.props.values.length>1&&S.props.draggableTrack){if(S.thumbRefs.some(function(w){var x;return(x=w.current)===null||x===void 0?void 0:x.contains(a.target)}))return;S.setState({draggedTrackPos:[a.clientX,a.clientY]},function(){return S.onMove(a.clientX,a.clientY)})}else{var c=(0,b.getClosestThumbIndex)(S.thumbRefs.map(function(w){return w.current}),a.clientX,a.clientY,S.props.direction);(s=S.thumbRefs[c].current)===null||s===void 0||s.focus(),S.setState({draggedThumbIndex:c},function(){return S.onMove(a.clientX,a.clientY)})}},S.onResize=function(){(0,b.translateThumbs)(S.getThumbs(),S.getOffsets(),S.props.rtl),S.calculateMarkOffsets()},S.onTouchStartTrack=function(a){var s;if(a.persist(),S.addTouchEvents(a.nativeEvent),S.props.values.length>1&&S.props.draggableTrack){if(S.thumbRefs.some(function(w){var x;return(x=w.current)===null||x===void 0?void 0:x.contains(a.target)}))return;S.setState({draggedTrackPos:[a.touches[0].clientX,a.touches[0].clientY]},function(){return S.onMove(a.touches[0].clientX,a.touches[0].clientY)})}else{var c=(0,b.getClosestThumbIndex)(S.thumbRefs.map(function(w){return w.current}),a.touches[0].clientX,a.touches[0].clientY,S.props.direction);(s=S.thumbRefs[c].current)===null||s===void 0||s.focus(),S.setState({draggedThumbIndex:c},function(){return S.onMove(a.touches[0].clientX,a.touches[0].clientY)})}},S.onMouseOrTouchStart=function(a){if(!S.props.disabled){var s=(0,b.isTouchEvent)(a);if(!(!s&&a.button!==0)){var c=S.getTargetIndex(a);c!==-1&&(s?S.addTouchEvents(a):S.addMouseEvents(a),S.setState({draggedThumbIndex:c,thumbZIndexes:S.state.thumbZIndexes.map(function(w,x){return x===c?Math.max.apply(Math,S.state.thumbZIndexes):w<=S.state.thumbZIndexes[c]?w:w-1})}))}}},S.onMouseMove=function(a){a.preventDefault(),S.onMove(a.clientX,a.clientY)},S.onTouchMove=function(a){a.preventDefault(),S.onMove(a.touches[0].clientX,a.touches[0].clientY)},S.onKeyDown=function(a){var s=S.props,c=s.values,w=s.onChange,x=s.step,T=s.rtl,l=s.direction,h=S.state.isChanged,C=S.getTargetIndex(a.nativeEvent),E=T||l===p.Direction.Left||l===p.Direction.Down?-1:1;C!==-1&&(y.includes(a.key)?(a.preventDefault(),S.setState({draggedThumbIndex:C,isChanged:!0}),w((0,b.replaceAt)(c,C,S.normalizeValue(c[C]+E*(a.key==="PageUp"?x*10:x),C)))):k.includes(a.key)?(a.preventDefault(),S.setState({draggedThumbIndex:C,isChanged:!0}),w((0,b.replaceAt)(c,C,S.normalizeValue(c[C]-E*(a.key==="PageDown"?x*10:x),C)))):a.key==="Tab"?S.setState({draggedThumbIndex:-1},function(){h&&S.fireOnFinalChange()}):h&&S.fireOnFinalChange())},S.onKeyUp=function(a){var s=S.state.isChanged;S.setState({draggedThumbIndex:-1},function(){s&&S.fireOnFinalChange()})},S.onMove=function(a,s){var c=S.state,w=c.draggedThumbIndex,x=c.draggedTrackPos,T=S.props,l=T.direction,h=T.min,C=T.max,E=T.onChange,D=T.values,z=T.step,L=T.rtl;if(w===-1&&x[0]===-1&&x[1]===-1)return null;var V=S.trackRef.current;if(!V)return null;var O=V.getBoundingClientRect(),W=(0,b.isVertical)(l)?O.height:O.width;if(x[0]!==-1&&x[1]!==-1){var H=a-x[0],q=s-x[1],U=0;switch(l){case p.Direction.Right:case p.Direction.Left:U=H/W*(C-h);break;case p.Direction.Down:case p.Direction.Up:U=q/W*(C-h);break;default:(0,b.assertUnreachable)(l)}if(L&&(U*=-1),Math.abs(U)>=z/2){for(var B=0;B<S.thumbRefs.length;B++){if(D[B]===C&&Math.sign(U)===1||D[B]===h&&Math.sign(U)===-1)return;var Y=D[B]+U;Y>C?U=C-D[B]:Y<h&&(U=h-D[B])}for(var X=D.slice(0),B=0;B<S.thumbRefs.length;B++)X=(0,b.replaceAt)(X,B,S.normalizeValue(D[B]+U,B));S.setState({draggedTrackPos:[a,s]}),E(X)}}else{var j=0;switch(l){case p.Direction.Right:j=(a-O.left)/W*(C-h)+h;break;case p.Direction.Left:j=(W-(a-O.left))/W*(C-h)+h;break;case p.Direction.Down:j=(s-O.top)/W*(C-h)+h;break;case p.Direction.Up:j=(W-(s-O.top))/W*(C-h)+h;break;default:(0,b.assertUnreachable)(l)}L&&(j=C+h-j),Math.abs(D[w]-j)>=z/2&&E((0,b.replaceAt)(D,w,S.normalizeValue(j,w)))}},S.normalizeValue=function(a,s){var c=S.props,w=c.min,x=c.max,T=c.step,l=c.allowOverlap,h=c.values;return(0,b.normalizeValue)(a,s,w,x,T,l,h)},S.onEnd=function(a){if(a.preventDefault(),document.removeEventListener("mousemove",S.schdOnMouseMove),document.removeEventListener("touchmove",S.schdOnTouchMove),document.removeEventListener("mouseup",S.schdOnEnd),document.removeEventListener("touchend",S.schdOnEnd),document.removeEventListener("touchcancel",S.schdOnEnd),S.state.draggedThumbIndex===-1&&S.state.draggedTrackPos[0]===-1&&S.state.draggedTrackPos[1]===-1)return null;S.setState({draggedThumbIndex:-1,draggedTrackPos:[-1,-1]},function(){S.fireOnFinalChange()})},S.fireOnFinalChange=function(){S.setState({isChanged:!1});var a=S.props,s=a.onFinalChange,c=a.values;s&&s(c)},S.updateMarkRefs=function(a){if(!a.renderMark){S.numOfMarks=void 0,S.markRefs=void 0;return}S.numOfMarks=(a.max-a.min)/S.props.step,S.markRefs=[];for(var s=0;s<S.numOfMarks+1;s++)S.markRefs[s]=_.createRef()},S.calculateMarkOffsets=function(){if(!(!S.props.renderMark||!S.trackRef||!S.numOfMarks||!S.markRefs||S.trackRef.current===null)){for(var a=window.getComputedStyle(S.trackRef.current),s=parseInt(a.width,10),c=parseInt(a.height,10),w=parseInt(a.paddingLeft,10),x=parseInt(a.paddingTop,10),T=[],l=0;l<S.numOfMarks+1;l++){var h=9999,C=9999;if(S.markRefs[l].current){var E=S.markRefs[l].current.getBoundingClientRect();h=E.height,C=E.width}S.props.direction===p.Direction.Left||S.props.direction===p.Direction.Right?T.push([Math.round(s/S.numOfMarks*l+w-C/2),-Math.round((h-c)/2)]):T.push([Math.round(c/S.numOfMarks*l+x-h/2),-Math.round((C-s)/2)])}S.setState({markOffsets:T})}},R.step===0)throw new Error('"step" property should be a positive number');return S.schdOnMouseMove=(0,b.schd)(S.onMouseMove),S.schdOnTouchMove=(0,b.schd)(S.onTouchMove),S.schdOnEnd=(0,b.schd)(S.onEnd),S.thumbRefs=R.values.map(function(){return _.createRef()}),S.updateMarkRefs(R),S}return P.prototype.componentDidMount=function(){var R=this,S=this.props,a=S.values,s=S.min,c=S.step;this.resizeObserver=window.ResizeObserver?new window.ResizeObserver(this.onResize):{observe:function(){return window.addEventListener("resize",R.onResize)},unobserve:function(){return window.removeEventListener("resize",R.onResize)}},document.addEventListener("touchstart",this.onMouseOrTouchStart,{passive:!1}),document.addEventListener("mousedown",this.onMouseOrTouchStart,{passive:!1}),!this.props.allowOverlap&&(0,b.checkInitialOverlap)(this.props.values),this.props.values.forEach(function(w){return(0,b.checkBoundaries)(w,R.props.min,R.props.max)}),this.resizeObserver.observe(this.trackRef.current),(0,b.translateThumbs)(this.getThumbs(),this.getOffsets(),this.props.rtl),this.calculateMarkOffsets(),a.forEach(function(w){(0,b.isStepDivisible)(s,w,c)||console.warn("The `values` property is in conflict with the current `step`, `min`, and `max` properties. Please provide values that are accessible using the min, max, and step values.")})},P.prototype.componentDidUpdate=function(R,S){var a=this.props,s=a.max,c=a.min,w=a.step,x=a.values,T=a.rtl;(R.max!==s||R.min!==c||R.step!==w)&&this.updateMarkRefs(this.props),(0,b.translateThumbs)(this.getThumbs(),this.getOffsets(),T),(R.max!==s||R.min!==c||R.step!==w||S.markOffsets.length!==this.state.markOffsets.length)&&(this.calculateMarkOffsets(),x.forEach(function(l){(0,b.isStepDivisible)(c,l,w)||console.warn("The `values` property is in conflict with the current `step`, `min`, and `max` properties. Please provide values that are accessible using the min, max, and step values.")}))},P.prototype.componentWillUnmount=function(){var R={passive:!1};document.removeEventListener("mousedown",this.onMouseOrTouchStart,R),document.removeEventListener("mousemove",this.schdOnMouseMove),document.removeEventListener("touchmove",this.schdOnTouchMove),document.removeEventListener("touchstart",this.onMouseOrTouchStart),document.removeEventListener("mouseup",this.schdOnEnd),document.removeEventListener("touchend",this.schdOnEnd),this.resizeObserver.unobserve(this.trackRef.current)},P.prototype.render=function(){var R=this,S=this.props,a=S.label,s=S.labelledBy,c=S.renderTrack,w=S.renderThumb,x=S.renderMark,T=x===void 0?function(){return null}:x,l=S.values,h=S.min,C=S.max,E=S.allowOverlap,D=S.disabled,z=this.state,L=z.draggedThumbIndex,V=z.thumbZIndexes,O=z.markOffsets;return c({props:{style:{transform:"scale(1)",cursor:L>-1?"grabbing":this.props.draggableTrack?(0,b.isVertical)(this.props.direction)?"ns-resize":"ew-resize":l.length===1&&!D?"pointer":"inherit"},onMouseDown:D?b.voidFn:this.onMouseDownTrack,onTouchStart:D?b.voidFn:this.onTouchStartTrack,ref:this.trackRef},isDragged:this.state.draggedThumbIndex>-1,disabled:D,children:v(v([],O.map(function(W,H,q){return T({props:{style:R.props.direction===p.Direction.Left||R.props.direction===p.Direction.Right?{position:"absolute",left:"".concat(W[0],"px"),marginTop:"".concat(W[1],"px")}:{position:"absolute",top:"".concat(W[0],"px"),marginLeft:"".concat(W[1],"px")},key:"mark".concat(H),ref:R.markRefs[H]},index:H})}),!0),l.map(function(W,H){var q=R.state.draggedThumbIndex===H;return w({index:H,value:W,isDragged:q,props:{style:{position:"absolute",zIndex:V[H],cursor:D?"inherit":q?"grabbing":"grab",userSelect:"none",touchAction:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},key:H,tabIndex:D?void 0:0,"aria-valuemax":E?C:l[H+1]||C,"aria-valuemin":E?h:l[H-1]||h,"aria-valuenow":W,draggable:!1,ref:R.thumbRefs[H],"aria-label":a,"aria-labelledby":s,role:"slider",onKeyDown:D?b.voidFn:R.onKeyDown,onKeyUp:D?b.voidFn:R.onKeyUp}})}),!0)})},P.defaultProps={label:"Accessibility label",labelledBy:null,step:1,direction:p.Direction.Right,rtl:!1,disabled:!1,allowOverlap:!1,draggableTrack:!1,min:0,max:100},P})(_.Component);return Range.default=g,Range}var hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,(function(n){var t=lib&&lib.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(n,"__esModule",{value:!0}),n.checkValuesAgainstBoundaries=n.relativeValue=n.useThumbOverlap=n.Direction=n.getTrackBackground=n.Range=void 0;var r=t(requireRange());n.Range=r.default;var u=requireUtils();Object.defineProperty(n,"getTrackBackground",{enumerable:!0,get:function(){return u.getTrackBackground}}),Object.defineProperty(n,"useThumbOverlap",{enumerable:!0,get:function(){return u.useThumbOverlap}}),Object.defineProperty(n,"relativeValue",{enumerable:!0,get:function(){return u.relativeValue}}),Object.defineProperty(n,"checkValuesAgainstBoundaries",{enumerable:!0,get:function(){return u.checkValuesAgainstBoundaries}});var v=requireTypes();Object.defineProperty(n,"Direction",{enumerable:!0,get:function(){return v.Direction}})})(lib)),lib}var libExports=requireLib();function RangeSlider({title:n,value:t,onChange:r,min:u,max:v}){return jsxRuntimeExports$1.jsxs("div",{className:"my-4",children:[jsxRuntimeExports$1.jsx("label",{className:"block font mb-1",children:n}),jsxRuntimeExports$1.jsx(libExports.Range,{step:1,min:u,max:v,values:t,onChange:r,renderTrack:({props:_,children:b})=>jsxRuntimeExports$1.jsxs("div",{..._,className:"w-full h-2 bg-gray-300 rounded relative",children:[jsxRuntimeExports$1.jsx("div",{className:"absolute h-2 bg-blue-500 rounded",style:{left:`${(t[0]-u)/(v-u)*100}%`,width:`${(t[1]-t[0])/(v-u)*100}%`}}),b]}),renderThumb:({props:_})=>jsxRuntimeExports$1.jsx("div",{..._,className:"w-5 h-5 bg-white border border-gray-500 rounded-full"})}),jsxRuntimeExports$1.jsxs("div",{className:"flex justify-between text-sm mt-1.5",children:[jsxRuntimeExports$1.jsx("span",{children:t[0]}),jsxRuntimeExports$1.jsx("span",{children:t[1]})]})]})}function buildQueryString(n,t,r,u,v){const _=[],b=[],p=[];for(const[y,k]of Object.entries(r))k===1&&b.push(y),k===2&&p.push(y);return p.length&&_.push(`NOT elements HAS ANY ${p.map(y=>`"${y}"`).join(", ")}`),b.length&&_.push(`elements HAS ALL ${b.map(y=>`"${y}"`).join(", ")}`),u[0]!==n[0]&&_.push(`nelements>=${u[0]}`),u[1]!==n[1]&&_.push(`nelements<=${u[1]}`),v[0]!==t[0]&&_.push(`nsites>=${v[0]}`),v[1]!==t[1]&&_.push(`nsites<=${v[1]}`),_.join(" AND ")}function OptimadeFilters({providerUrl:n,onResults:t,onFilterChange:r}){const[u,v]=reactExports.useState([1,118]),[_,b]=reactExports.useState([1,1e3]),[p,y]=reactExports.useState({}),[k,g]=reactExports.useState(!1),[M,P]=reactExports.useState(!1),[R,S]=reactExports.useState(""),a=buildQueryString([1,118],[1,1e3],p,u,_),s=M?R:a;reactExports.useEffect(()=>{r?.(s)},[s]);const c=async()=>{if(!n)return alert("Please select a provider first!");g(!0);try{const x=s?`?filter=${encodeURIComponent(s)}`:"",T=`${n}/v1/structures${x}`,l=await fetch(T);if(!l.ok)throw new Error(`Request failed: ${l.status}`);const h=await l.json();t?.(h)}catch(x){console.error("Error fetching structures:",x)}finally{g(!1)}},w=()=>{P(x=>!x),M||(S(a),y({}),v([1,118]),b([1,1e3]))};return jsxRuntimeExports$1.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports$1.jsxs("div",{className:M?"opacity-50 pointer-events-none":"",children:[jsxRuntimeExports$1.jsx(PTable,{selected:p,onSelectionChange:x=>y(T=>({...T,...x}))}),jsxRuntimeExports$1.jsx(RangeSlider,{title:"Number of atoms",value:u,onChange:v,min:1,max:118}),jsxRuntimeExports$1.jsx(RangeSlider,{title:"Number of sites",value:_,onChange:b,min:0,max:1e3})]}),jsxRuntimeExports$1.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports$1.jsx("input",{id:"manual-mode-toggle",type:"checkbox",checked:M,onChange:w,className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),jsxRuntimeExports$1.jsx("label",{htmlFor:"manual-mode-toggle",className:"text-sm text-gray-700 select-none",children:"Unlock custom query"})]}),jsxRuntimeExports$1.jsx("div",{className:"pb-4",children:jsxRuntimeExports$1.jsx(QueryTextBox,{value:s,onChange:M?S:()=>{},onSubmit:c,loading:k,placeholder:"Enter OPTIMADE filter…"})})]})}function QuerySummary({lastQuery:n,lastProviderUrl:t}){return jsxRuntimeExports$1.jsxs("div",{className:"w-full text-center text-sm text-gray-600 mt-2",children:[jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Last Query:"})," ",n||"None"]}),jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Last Provider URL:"})," ",t||"None selected"]})]})}function DownloadIcon({size:n=14,className:t=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[jsxRuntimeExports$1.jsx("path",{d:"M12 15V3"}),jsxRuntimeExports$1.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),jsxRuntimeExports$1.jsx("path",{d:"m7 10 5 5 5-5"})]})}function NextIcon({size:n=14,className:t=""}){return jsxRuntimeExports$1.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,hegiht:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:jsxRuntimeExports$1.jsx("path",{d:"m9 18 6-6-6-6"})})}function PreviousIcon({size:n=14,className:t=""}){return jsxRuntimeExports$1.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,hegiht:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:jsxRuntimeExports$1.jsx("path",{d:"m15 18-6-6 6-6"})})}function FirstIcon({size:n=14,className:t=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,hegiht:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[jsxRuntimeExports$1.jsx("path",{d:"m17 18-6-6 6-6"}),jsxRuntimeExports$1.jsx("path",{d:"M7 6v12"})]})}function LastIcon({size:n=14,className:t=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,hegiht:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[jsxRuntimeExports$1.jsx("path",{d:"m7 18 6-6-6-6"}),jsxRuntimeExports$1.jsx("path",{d:"M17 6v12"})]})}function PaginationControls({currentPage:n,totalPages:t,metaData:r,resultsLoading:u,fetchPage:v}){return r.data_returned<=0?null:jsxRuntimeExports$1.jsx("div",{className:"pt-8",children:jsxRuntimeExports$1.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-2",children:[jsxRuntimeExports$1.jsx("span",{className:"text-gray-700 text-sm text-center w-full md:w-auto",children:`Filtered results: ${r.data_returned} of ${r.data_available} | Page ${n} of ${t}`}),jsxRuntimeExports$1.jsx("button",{onClick:()=>v(1),disabled:n===1||u,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-default",children:jsxRuntimeExports$1.jsx(FirstIcon,{})}),jsxRuntimeExports$1.jsx("button",{onClick:()=>v(n-1),disabled:n===1||u,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-default",children:jsxRuntimeExports$1.jsx(PreviousIcon,{})}),jsxRuntimeExports$1.jsx("button",{onClick:()=>v(n+1),disabled:n===t||u,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-default",children:jsxRuntimeExports$1.jsx(NextIcon,{})}),jsxRuntimeExports$1.jsx("button",{onClick:()=>v(t),disabled:n===t||u,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-default",children:jsxRuntimeExports$1.jsx(LastIcon,{})})]})})}function ResultsDropdown({results:n,resultsLoading:t,selectedResult:r,setSelectedResult:u,slateDropdown:v}){return jsxRuntimeExports$1.jsxs("div",{className:"w-full",children:[jsxRuntimeExports$1.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select a result"}),t?jsxRuntimeExports$1.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports$1.jsx("div",{className:"w-5 h-5 border-2 border-t-2 border-gray-400 border-t-blue-500 rounded-full animate-spin"}),jsxRuntimeExports$1.jsx("span",{className:"text-gray-500",children:"Loading results…"})]}):jsxRuntimeExports$1.jsx("select",{className:`${v} mb-4`,value:r?.id||"",onChange:_=>{const b=n?.data?.find(p=>p.id===_.target.value);b&&u(b)},disabled:!n?.data||n?.data.length===0,children:!n?.data||n.data.length===0?jsxRuntimeExports$1.jsx("option",{value:"",children:"No results for current query"}):n.data.map(_=>jsxRuntimeExports$1.jsx("option",{value:_.id,children:`${_.attributes?.chemical_formula_descriptive||"Unknown"} (${_.id})`},_.id))})]})}const isBoolean=n=>typeof n=="boolean"||n instanceof Boolean,isNumber=n=>typeof n=="number"||n instanceof Number,isBigInt=n=>typeof n=="bigint"||n instanceof BigInt,isDate=n=>!!n&&n instanceof Date,isString=n=>typeof n=="string"||n instanceof String,isArray=n=>Array.isArray(n),isObject=n=>typeof n=="object"&&n!==null,isFunction=n=>!!n&&n instanceof Object&&typeof n=="function";function quoteString(n,t){return t===void 0&&(t=!1),!n||t?`"${n}"`:n}function quoteStringValue(n,t,r){return r?JSON.stringify(n):t?`"${n}"`:n}function ExpandableObject(n){let{field:t,value:r,data:u,lastElement:v,openBracket:_,closeBracket:b,level:p,style:y,shouldExpandNode:k,clickToExpandNode:g,outerRef:M,beforeExpandChange:P}=n;const R=reactExports.useRef(!1),[S,a]=reactExports.useState(()=>k(p,r,t)),s=reactExports.useRef(null);reactExports.useEffect(()=>{R.current?a(k(p,r,t)):R.current=!0},[k]);const c=reactExports.useId();if(u.length===0)return EmptyObject({field:t,openBracket:_,closeBracket:b,lastElement:v,style:y});const w=S?y.collapseIcon:y.expandIcon,x=S?y.ariaLables.collapseJson:y.ariaLables.expandJson,T=p+1,l=u.length-1,h=D=>{S!==D&&(!P||P({level:p,value:r,field:t,newExpandValue:D}))&&a(D)},C=D=>{if(D.key==="ArrowRight"||D.key==="ArrowLeft")D.preventDefault(),h(D.key==="ArrowRight");else if(D.key==="ArrowUp"||D.key==="ArrowDown"){D.preventDefault();const z=D.key==="ArrowUp"?-1:1;if(!M.current)return;const L=M.current.querySelectorAll("[role=button]");let V=-1;for(let W=0;W<L.length;W++)if(L[W].tabIndex===0){V=W;break}if(V<0)return;const O=(V+z+L.length)%L.length;L[V].tabIndex=-1,L[O].tabIndex=0,L[O].focus()}},E=()=>{var D;h(!S);const z=s.current;if(!z)return;const L=(D=M.current)===null||D===void 0?void 0:D.querySelector('[role=button][tabindex="0"]');L&&(L.tabIndex=-1),z.tabIndex=0,z.focus()};return reactExports.createElement("div",{className:y.basicChildStyle,role:"treeitem","aria-expanded":S,"aria-selected":void 0},reactExports.createElement("span",{className:w,onClick:E,onKeyDown:C,role:"button","aria-label":x,"aria-expanded":S,"aria-controls":S?c:void 0,ref:s,tabIndex:p===0?0:-1}),(t||t==="")&&(g?reactExports.createElement("span",{className:y.clickableLabel,onClick:E,onKeyDown:C},quoteString(t,y.quotesForFieldNames),":"):reactExports.createElement("span",{className:y.label},quoteString(t,y.quotesForFieldNames),":")),reactExports.createElement("span",{className:y.punctuation},_),S?reactExports.createElement("ul",{id:c,role:"group",className:y.childFieldsContainer},u.map((D,z)=>reactExports.createElement(DataRender,{key:D[0]||z,field:D[0],value:D[1],style:y,lastElement:z===l,level:T,shouldExpandNode:k,clickToExpandNode:g,beforeExpandChange:P,outerRef:M}))):reactExports.createElement("span",{className:y.collapsedContent,onClick:E,onKeyDown:C}),reactExports.createElement("span",{className:y.punctuation},b),!v&&reactExports.createElement("span",{className:y.punctuation},","))}function EmptyObject(n){let{field:t,openBracket:r,closeBracket:u,lastElement:v,style:_}=n;return reactExports.createElement("div",{className:_.basicChildStyle,role:"treeitem","aria-selected":void 0},(t||t==="")&&reactExports.createElement("span",{className:_.label},quoteString(t,_.quotesForFieldNames),":"),reactExports.createElement("span",{className:_.punctuation},r),reactExports.createElement("span",{className:_.punctuation},u),!v&&reactExports.createElement("span",{className:_.punctuation},","))}function JsonObject(n){let{field:t,value:r,style:u,lastElement:v,shouldExpandNode:_,clickToExpandNode:b,level:p,outerRef:y,beforeExpandChange:k}=n;return ExpandableObject({field:t,value:r,lastElement:v||!1,level:p,openBracket:"{",closeBracket:"}",style:u,shouldExpandNode:_,clickToExpandNode:b,data:Object.keys(r).map(g=>[g,r[g]]),outerRef:y,beforeExpandChange:k})}function JsonArray(n){let{field:t,value:r,style:u,lastElement:v,level:_,shouldExpandNode:b,clickToExpandNode:p,outerRef:y,beforeExpandChange:k}=n;return ExpandableObject({field:t,value:r,lastElement:v||!1,level:_,openBracket:"[",closeBracket:"]",style:u,shouldExpandNode:b,clickToExpandNode:p,data:r.map(g=>[void 0,g]),outerRef:y,beforeExpandChange:k})}function JsonPrimitiveValue(n){let{field:t,value:r,style:u,lastElement:v}=n,_,b=u.otherValue;return r===null?(_="null",b=u.nullValue):r===void 0?(_="undefined",b=u.undefinedValue):isString(r)?(_=quoteStringValue(r,!u.noQuotesForStringValues,u.stringifyStringValues),b=u.stringValue):isBoolean(r)?(_=r?"true":"false",b=u.booleanValue):isNumber(r)?(_=r.toString(),b=u.numberValue):isBigInt(r)?(_=`${r.toString()}n`,b=u.numberValue):isDate(r)?_=r.toISOString():isFunction(r)?_="function() { }":_=r.toString(),reactExports.createElement("div",{className:u.basicChildStyle,role:"treeitem","aria-selected":void 0},(t||t==="")&&reactExports.createElement("span",{className:u.label},quoteString(t,u.quotesForFieldNames),":"),reactExports.createElement("span",{className:b},_),!v&&reactExports.createElement("span",{className:u.punctuation},","))}function DataRender(n){const t=n.value;return isArray(t)?reactExports.createElement(JsonArray,Object.assign({},n)):isObject(t)&&!isDate(t)&&!isFunction(t)?reactExports.createElement(JsonObject,Object.assign({},n)):reactExports.createElement(JsonPrimitiveValue,Object.assign({},n))}var styles={"container-light":"_2IvMF _GzYRV","basic-element-style":"_2bkNM","child-fields-container":"_1BXBN","label-light":"_1MGIk","clickable-label-light":"_2YKJg _1MGIk _1MFti","punctuation-light":"_3uHL6 _3eOF8","value-null-light":"_2T6PJ","value-undefined-light":"_1Gho6","value-string-light":"_vGjyY","value-number-light":"_1bQdo","value-boolean-light":"_3zQKs","value-other-light":"_1xvuR","collapse-icon-light":"_oLqym _f10Tu _1MFti _1LId0","expand-icon-light":"_2AXVT _f10Tu _1MFti _1UmXx","collapsed-content-light":"_2KJWg _1pNG9 _1MFti"};const defaultAriaLables={collapseJson:"collapse JSON",expandJson:"expand JSON"},defaultStyles={container:styles["container-light"],basicChildStyle:styles["basic-element-style"],childFieldsContainer:styles["child-fields-container"],label:styles["label-light"],clickableLabel:styles["clickable-label-light"],nullValue:styles["value-null-light"],undefinedValue:styles["value-undefined-light"],stringValue:styles["value-string-light"],booleanValue:styles["value-boolean-light"],numberValue:styles["value-number-light"],otherValue:styles["value-other-light"],punctuation:styles["punctuation-light"],collapseIcon:styles["collapse-icon-light"],expandIcon:styles["expand-icon-light"],collapsedContent:styles["collapsed-content-light"],noQuotesForStringValues:!1,quotesForFieldNames:!1,ariaLables:defaultAriaLables,stringifyStringValues:!1},allExpanded=()=>!0,JsonView=n=>{let{data:t,style:r=defaultStyles,shouldExpandNode:u=allExpanded,clickToExpandNode:v=!1,beforeExpandChange:_,compactTopLevel:b,...p}=n;const y=reactExports.useRef(null);return reactExports.createElement("div",Object.assign({"aria-label":"JSON view"},p,{className:r.container,ref:y,role:"tree"}),b&&isObject(t)?Object.entries(t).map(k=>{let[g,M]=k;return reactExports.createElement(DataRender,{key:g,field:g,value:M,style:{...defaultStyles,...r},lastElement:!0,level:1,shouldExpandNode:u,clickToExpandNode:v,beforeExpandChange:_,outerRef:y})}):reactExports.createElement(DataRender,{value:t,style:{...defaultStyles,...r},lastElement:!0,level:0,shouldExpandNode:u,clickToExpandNode:v,outerRef:y,beforeExpandChange:_}))};var classnames={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var hasRequiredClassnames;function requireClassnames(){return hasRequiredClassnames||(hasRequiredClassnames=1,(function(n){(function(){var t={}.hasOwnProperty;function r(){for(var _="",b=0;b<arguments.length;b++){var p=arguments[b];p&&(_=v(_,u(p)))}return _}function u(_){if(typeof _=="string"||typeof _=="number")return _;if(typeof _!="object")return"";if(Array.isArray(_))return r.apply(null,_);if(_.toString!==Object.prototype.toString&&!_.toString.toString().includes("[native code]"))return _.toString();var b="";for(var p in _)t.call(_,p)&&_[p]&&(b=v(b,p));return b}function v(_,b){return b?_?_+" "+b:_+b:_}n.exports?(r.default=r,n.exports=r):window.classNames=r})()})(classnames)),classnames.exports}var classnamesExports=requireClassnames();const classNames=getDefaultExportFromCjs(classnamesExports),DEFAULT_BREAKPOINTS=["xxl","xl","lg","md","sm","xs"],DEFAULT_MIN_BREAKPOINT="xs",ThemeContext=reactExports.createContext({prefixes:{},breakpoints:DEFAULT_BREAKPOINTS,minBreakpoint:DEFAULT_MIN_BREAKPOINT}),{Consumer,Provider}=ThemeContext;function useBootstrapPrefix(n,t){const{prefixes:r}=reactExports.useContext(ThemeContext);return n||r[t]||t}function useBootstrapBreakpoints(){const{breakpoints:n}=reactExports.useContext(ThemeContext);return n}function useBootstrapMinBreakpoint(){const{minBreakpoint:n}=reactExports.useContext(ThemeContext);return n}var propTypes$2={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=n,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var n=requireReactPropTypesSecret();function t(){}function r(){}return r.resetWarningCache=t,factoryWithThrowingShims=function(){function u(b,p,y,k,g,M){if(M!==n){var P=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw P.name="Invariant Violation",P}}u.isRequired=u;function v(){return u}var _={array:u,bigint:u,bool:u,func:u,number:u,object:u,string:u,symbol:u,any:u,arrayOf:v,element:u,elementType:u,instanceOf:v,node:u,objectOf:v,oneOf:v,oneOfType:v,shape:v,exact:v,checkPropTypes:r,resetWarningCache:t};return _.PropTypes=_,_},factoryWithThrowingShims}var hasRequiredPropTypes;function requirePropTypes(){return hasRequiredPropTypes||(hasRequiredPropTypes=1,propTypes$2.exports=requireFactoryWithThrowingShims()()),propTypes$2.exports}var propTypesExports=requirePropTypes();const PropTypes=getDefaultExportFromCjs(propTypesExports),_excluded=["as","disabled"];function _objectWithoutPropertiesLoose(n,t){if(n==null)return{};var r={};for(var u in n)if({}.hasOwnProperty.call(n,u)){if(t.indexOf(u)>=0)continue;r[u]=n[u]}return r}function isTrivialHref(n){return!n||n.trim()==="#"}function useButtonProps({tagName:n,disabled:t,href:r,target:u,rel:v,role:_,onClick:b,tabIndex:p=0,type:y}){n||(r!=null||u!=null||v!=null?n="a":n="button");const k={tagName:n};if(n==="button")return[{type:y||"button",disabled:t},k];const g=P=>{if((t||n==="a"&&isTrivialHref(r))&&P.preventDefault(),t){P.stopPropagation();return}b?.(P)},M=P=>{P.key===" "&&(P.preventDefault(),g(P))};return n==="a"&&(r||(r="#"),t&&(r=void 0)),[{role:_??"button",disabled:void 0,tabIndex:t?void 0:p,href:r,target:n==="a"?u:void 0,"aria-disabled":t||void 0,rel:n==="a"?v:void 0,onClick:g,onKeyDown:M},k]}const Button$1=reactExports.forwardRef((n,t)=>{let{as:r,disabled:u}=n,v=_objectWithoutPropertiesLoose(n,_excluded);const[_,{tagName:b}]=useButtonProps(Object.assign({tagName:r,disabled:u},v));return jsxRuntimeExports$1.jsx(b,Object.assign({},v,_,{ref:t}))});Button$1.displayName="Button";const Button=reactExports.forwardRef(({as:n,bsPrefix:t,variant:r="primary",size:u,active:v=!1,disabled:_=!1,className:b,...p},y)=>{const k=useBootstrapPrefix(t,"btn"),[g,{tagName:M}]=useButtonProps({tagName:n,disabled:_,...p}),P=M;return jsxRuntimeExports$1.jsx(P,{...g,...p,ref:y,disabled:_,className:classNames(b,k,v&&"active",r&&`${k}-${r}`,u&&`${k}-${u}`,p.href&&_&&"disabled")})});Button.displayName="Button";function hasChildOfType(n,t){return reactExports.Children.toArray(n).some(r=>reactExports.isValidElement(r)&&r.type===t)}function useCol({as:n,bsPrefix:t,className:r,...u}){t=useBootstrapPrefix(t,"col");const v=useBootstrapBreakpoints(),_=useBootstrapMinBreakpoint(),b=[],p=[];return v.forEach(y=>{const k=u[y];delete u[y];let g,M,P;typeof k=="object"&&k!=null?{span:g,offset:M,order:P}=k:g=k;const R=y!==_?`-${y}`:"";g&&b.push(g===!0?`${t}${R}`:`${t}${R}-${g}`),P!=null&&p.push(`order${R}-${P}`),M!=null&&p.push(`offset${R}-${M}`)}),[{...u,className:classNames(r,...b,...p)},{as:n,bsPrefix:t,spans:b}]}const Col=reactExports.forwardRef((n,t)=>{const[{className:r,...u},{as:v="div",bsPrefix:_,spans:b}]=useCol(n);return jsxRuntimeExports$1.jsx(v,{...u,ref:t,className:classNames(r,!b.length&&_)})});Col.displayName="Col";const propTypes$1={type:PropTypes.string,tooltip:PropTypes.bool,as:PropTypes.elementType},Feedback=reactExports.forwardRef(({as:n="div",className:t,type:r="valid",tooltip:u=!1,...v},_)=>jsxRuntimeExports$1.jsx(n,{...v,ref:_,className:classNames(t,`${r}-${u?"tooltip":"feedback"}`)}));Feedback.displayName="Feedback";Feedback.propTypes=propTypes$1;const FormContext=reactExports.createContext({}),FormCheckInput=reactExports.forwardRef(({id:n,bsPrefix:t,className:r,type:u="checkbox",isValid:v=!1,isInvalid:_=!1,as:b="input",...p},y)=>{const{controlId:k}=reactExports.useContext(FormContext);return t=useBootstrapPrefix(t,"form-check-input"),jsxRuntimeExports$1.jsx(b,{...p,ref:y,type:u,id:n||k,className:classNames(r,t,v&&"is-valid",_&&"is-invalid")})});FormCheckInput.displayName="FormCheckInput";const FormCheckLabel=reactExports.forwardRef(({bsPrefix:n,className:t,htmlFor:r,...u},v)=>{const{controlId:_}=reactExports.useContext(FormContext);return n=useBootstrapPrefix(n,"form-check-label"),jsxRuntimeExports$1.jsx("label",{...u,ref:v,htmlFor:r||_,className:classNames(t,n)})});FormCheckLabel.displayName="FormCheckLabel";const FormCheck=reactExports.forwardRef(({id:n,bsPrefix:t,bsSwitchPrefix:r,inline:u=!1,reverse:v=!1,disabled:_=!1,isValid:b=!1,isInvalid:p=!1,feedbackTooltip:y=!1,feedback:k,feedbackType:g,className:M,style:P,title:R="",type:S="checkbox",label:a,children:s,as:c="input",...w},x)=>{t=useBootstrapPrefix(t,"form-check"),r=useBootstrapPrefix(r,"form-switch");const{controlId:T}=reactExports.useContext(FormContext),l=reactExports.useMemo(()=>({controlId:n||T}),[T,n]),h=!s&&a!=null&&a!==!1||hasChildOfType(s,FormCheckLabel),C=jsxRuntimeExports$1.jsx(FormCheckInput,{...w,type:S==="switch"?"checkbox":S,ref:x,isValid:b,isInvalid:p,disabled:_,as:c});return jsxRuntimeExports$1.jsx(FormContext.Provider,{value:l,children:jsxRuntimeExports$1.jsx("div",{style:P,className:classNames(M,h&&t,u&&`${t}-inline`,v&&`${t}-reverse`,S==="switch"&&r),children:s||jsxRuntimeExports$1.jsxs(jsxRuntimeExports$1.Fragment,{children:[C,h&&jsxRuntimeExports$1.jsx(FormCheckLabel,{title:R,children:a}),k&&jsxRuntimeExports$1.jsx(Feedback,{type:g,tooltip:y,children:k})]})})})});FormCheck.displayName="FormCheck";const FormCheck$1=Object.assign(FormCheck,{Input:FormCheckInput,Label:FormCheckLabel}),FormControl=reactExports.forwardRef(({bsPrefix:n,type:t,size:r,htmlSize:u,id:v,className:_,isValid:b=!1,isInvalid:p=!1,plaintext:y,readOnly:k,as:g="input",...M},P)=>{const{controlId:R}=reactExports.useContext(FormContext);return n=useBootstrapPrefix(n,"form-control"),jsxRuntimeExports$1.jsx(g,{...M,type:t,size:u,ref:P,readOnly:k,id:v||R,className:classNames(_,y?`${n}-plaintext`:n,r&&`${n}-${r}`,t==="color"&&`${n}-color`,b&&"is-valid",p&&"is-invalid")})});FormControl.displayName="FormControl";const FormControl$1=Object.assign(FormControl,{Feedback}),FormFloating=reactExports.forwardRef(({className:n,bsPrefix:t,as:r="div",...u},v)=>(t=useBootstrapPrefix(t,"form-floating"),jsxRuntimeExports$1.jsx(r,{ref:v,className:classNames(n,t),...u})));FormFloating.displayName="FormFloating";const FormGroup=reactExports.forwardRef(({controlId:n,as:t="div",...r},u)=>{const v=reactExports.useMemo(()=>({controlId:n}),[n]);return jsxRuntimeExports$1.jsx(FormContext.Provider,{value:v,children:jsxRuntimeExports$1.jsx(t,{...r,ref:u})})});FormGroup.displayName="FormGroup";const FormLabel=reactExports.forwardRef(({as:n="label",bsPrefix:t,column:r=!1,visuallyHidden:u=!1,className:v,htmlFor:_,...b},p)=>{const{controlId:y}=reactExports.useContext(FormContext);t=useBootstrapPrefix(t,"form-label");let k="col-form-label";typeof r=="string"&&(k=`${k} ${k}-${r}`);const g=classNames(v,t,u&&"visually-hidden",r&&k);return _=_||y,r?jsxRuntimeExports$1.jsx(Col,{ref:p,as:"label",className:g,htmlFor:_,...b}):jsxRuntimeExports$1.jsx(n,{ref:p,className:g,htmlFor:_,...b})});FormLabel.displayName="FormLabel";const FormRange=reactExports.forwardRef(({bsPrefix:n,className:t,id:r,...u},v)=>{const{controlId:_}=reactExports.useContext(FormContext);return n=useBootstrapPrefix(n,"form-range"),jsxRuntimeExports$1.jsx("input",{...u,type:"range",ref:v,className:classNames(t,n),id:r||_})});FormRange.displayName="FormRange";const FormSelect=reactExports.forwardRef(({bsPrefix:n,size:t,htmlSize:r,className:u,isValid:v=!1,isInvalid:_=!1,id:b,...p},y)=>{const{controlId:k}=reactExports.useContext(FormContext);return n=useBootstrapPrefix(n,"form-select"),jsxRuntimeExports$1.jsx("select",{...p,size:r,ref:y,className:classNames(u,n,t&&`${n}-${t}`,v&&"is-valid",_&&"is-invalid"),id:b||k})});FormSelect.displayName="FormSelect";const FormText=reactExports.forwardRef(({bsPrefix:n,className:t,as:r="small",muted:u,...v},_)=>(n=useBootstrapPrefix(n,"form-text"),jsxRuntimeExports$1.jsx(r,{...v,ref:_,className:classNames(t,n,u&&"text-muted")})));FormText.displayName="FormText";const Switch=reactExports.forwardRef((n,t)=>jsxRuntimeExports$1.jsx(FormCheck$1,{...n,ref:t,type:"switch"}));Switch.displayName="Switch";const Switch$1=Object.assign(Switch,{Input:FormCheck$1.Input,Label:FormCheck$1.Label}),FloatingLabel=reactExports.forwardRef(({bsPrefix:n,className:t,children:r,controlId:u,label:v,..._},b)=>(n=useBootstrapPrefix(n,"form-floating"),jsxRuntimeExports$1.jsxs(FormGroup,{ref:b,className:classNames(t,n),controlId:u,..._,children:[r,jsxRuntimeExports$1.jsx("label",{htmlFor:u,children:v})]})));FloatingLabel.displayName="FloatingLabel";const propTypes={_ref:PropTypes.any,validated:PropTypes.bool,as:PropTypes.elementType},Form=reactExports.forwardRef(({className:n,validated:t,as:r="form",...u},v)=>jsxRuntimeExports$1.jsx(r,{...u,ref:v,className:classNames(n,t&&"was-validated")}));Form.displayName="Form";Form.propTypes=propTypes;const Form$1=Object.assign(Form,{Group:FormGroup,Control:FormControl$1,Floating:FormFloating,Check:FormCheck$1,Switch:Switch$1,Label:FormLabel,Text:FormText,Range:FormRange,Select:FormSelect,FloatingLabel});var Zs=Object.defineProperty,Ys=(n,t,r)=>t in n?Zs(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ci=(n,t,r)=>(Ys(n,typeof t!="symbol"?t+"":t,r),r),commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},jsxRuntime={exports:{}},reactJsxRuntime_production_min={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var n=React,t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,v=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_={key:!0,ref:!0,__self:!0,__source:!0};function b(p,y,k){var g,M={},P=null,R=null;k!==void 0&&(P=""+k),y.key!==void 0&&(P=""+y.key),y.ref!==void 0&&(R=y.ref);for(g in y)u.call(y,g)&&!_.hasOwnProperty(g)&&(M[g]=y[g]);if(p&&p.defaultProps)for(g in y=p.defaultProps,y)M[g]===void 0&&(M[g]=y[g]);return{$$typeof:t,type:p,key:P,ref:R,props:M,_owner:v.current}}return reactJsxRuntime_production_min.Fragment=r,reactJsxRuntime_production_min.jsx=b,reactJsxRuntime_production_min.jsxs=b,reactJsxRuntime_production_min}jsxRuntime.exports=requireReactJsxRuntime_production_min();var jsxRuntimeExports=jsxRuntime.exports;class ControlBox extends React.Component{constructor(){super(...arguments),Ci(this,"handleSupercellChange",(t,r)=>{let u=this.props.viewerParams.supercell;u[t]=parseInt(r),this.props.onViewerParamChange("supercell",u)}),Ci(this,"handleOptionChange",t=>{this.props.onViewerParamChange(t,!this.props.viewerParams[t])}),Ci(this,"handleCameraEvent",t=>{this.props.onViewerEvent("camera",t)})}render(){return jsxRuntimeExports.jsxs("div",{className:"control-box",children:[jsxRuntimeExports.jsxs("div",{className:"control-box-row",children:[jsxRuntimeExports.jsxs("div",{className:"supercell-container",children:[jsxRuntimeExports.jsx(Form$1.Label,{children:"Supercell: "}),jsxRuntimeExports.jsx("div",{style:{display:"flex"},children:[0,1,2].map(t=>jsxRuntimeExports.jsx(Form$1.Control,{className:"supercell-input",type:"number",min:"1",max:"99",value:this.props.viewerParams.supercell[t],onChange:r=>this.handleSupercellChange(t,r.target.value)},t))})]}),jsxRuntimeExports.jsxs("div",{className:"camera-controls",children:[jsxRuntimeExports.jsx(Form$1.Label,{children:"Camera: "}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("x"),children:"x"}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("y"),children:"y"}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("z"),children:"z"})]})]}),jsxRuntimeExports.jsxs("div",{className:"control-box-row",style:{display:"flex"},children:[jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.bonds,onChange:()=>this.handleOptionChange("bonds"),label:"Bonds"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.packedCell,onChange:()=>this.handleOptionChange("packedCell"),label:"Packed cell"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.atomLabels,onChange:()=>this.handleOptionChange("atomLabels"),label:"Atom labels"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.spaceFilling,onChange:()=>this.handleOptionChange("vdwRadius"),label:"vdW radius"})]})]})}}var _3Dmol={exports:{}};/*!
 * 3dmol v2.3.0
 * JavaScript/TypeScript molecular visualization library
 * Author: David Koes and contributors
 */(function(module,exports){(function(n,t){module.exports=t()})(commonjsGlobal,()=>(()=>{var __webpack_modules__={"./node_modules/iobuffer/lib-esm/IOBuffer.js":((n,t,r)=>{r.r(t),r.d(t,{IOBuffer:()=>p});var u=r("./node_modules/iobuffer/lib-esm/text.browser.js");const v=1024*8,_=(()=>{const y=new Uint8Array(4),k=new Uint32Array(y.buffer);return!((k[0]=1)&y[0])})(),b={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class p{constructor(k=v,g={}){let M=!1;typeof k=="number"?k=new ArrayBuffer(k):(M=!0,this.lastWrittenByte=k.byteLength);const P=g.offset?g.offset>>>0:0,R=k.byteLength-P;let S=P;(ArrayBuffer.isView(k)||k instanceof p)&&(k.byteLength!==k.buffer.byteLength&&(S=k.byteOffset+P),k=k.buffer),M?this.lastWrittenByte=R:this.lastWrittenByte=0,this.buffer=k,this.length=R,this.byteLength=R,this.byteOffset=S,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,S,R),this._mark=0,this._marks=[]}available(k=1){return this.offset+k<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(k=1){return this.offset+=k,this}back(k=1){return this.offset-=k,this}seek(k){return this.offset=k,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const k=this._marks.pop();if(k===void 0)throw new Error("Mark stack empty");return this.seek(k),this}rewind(){return this.offset=0,this}ensureAvailable(k=1){if(!this.available(k)){const g=(this.offset+k)*2,M=new Uint8Array(g);M.set(new Uint8Array(this.buffer)),this.buffer=M.buffer,this.length=this.byteLength=g,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(k=1){return this.readArray(k,"uint8")}readArray(k,g){const M=b[g].BYTES_PER_ELEMENT*k,P=this.byteOffset+this.offset,R=this.buffer.slice(P,P+M);if(this.littleEndian===_&&g!=="uint8"&&g!=="int8"){const a=new Uint8Array(this.buffer.slice(P,P+M));a.reverse();const s=new b[g](a.buffer);return this.offset+=M,s.reverse(),s}const S=new b[g](R);return this.offset+=M,S}readInt16(){const k=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,k}readUint16(){const k=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,k}readInt32(){const k=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,k}readUint32(){const k=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,k}readFloat32(){const k=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,k}readFloat64(){const k=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,k}readBigInt64(){const k=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,k}readBigUint64(){const k=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,k}readChar(){return String.fromCharCode(this.readInt8())}readChars(k=1){let g="";for(let M=0;M<k;M++)g+=this.readChar();return g}readUtf8(k=1){return(0,u.decode)(this.readBytes(k))}decodeText(k=1,g="utf-8"){return(0,u.decode)(this.readBytes(k),g)}writeBoolean(k){return this.writeUint8(k?255:0),this}writeInt8(k){return this.ensureAvailable(1),this._data.setInt8(this.offset++,k),this._updateLastWrittenByte(),this}writeUint8(k){return this.ensureAvailable(1),this._data.setUint8(this.offset++,k),this._updateLastWrittenByte(),this}writeByte(k){return this.writeUint8(k)}writeBytes(k){this.ensureAvailable(k.length);for(let g=0;g<k.length;g++)this._data.setUint8(this.offset++,k[g]);return this._updateLastWrittenByte(),this}writeInt16(k){return this.ensureAvailable(2),this._data.setInt16(this.offset,k,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(k){return this.ensureAvailable(2),this._data.setUint16(this.offset,k,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(k){return this.ensureAvailable(4),this._data.setInt32(this.offset,k,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(k){return this.ensureAvailable(4),this._data.setUint32(this.offset,k,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(k){return this.ensureAvailable(4),this._data.setFloat32(this.offset,k,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(k){return this.ensureAvailable(8),this._data.setFloat64(this.offset,k,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(k){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,k,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(k){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,k,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(k){return this.writeUint8(k.charCodeAt(0))}writeChars(k){for(let g=0;g<k.length;g++)this.writeUint8(k.charCodeAt(g));return this}writeUtf8(k){return this.writeBytes((0,u.encode)(k))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}}),"./node_modules/iobuffer/lib-esm/text-encoding-polyfill.js":(function(){(function(n){if(n.TextEncoder&&n.TextDecoder)return!1;function t(u="utf-8"){if(u!=="utf-8")throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${u}') is invalid.`)}Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),t.prototype.encode=function(u,v={stream:!1}){if(v.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let _=0;const b=u.length;let p=0,y=Math.max(32,b+(b>>1)+7),k=new Uint8Array(y>>3<<3);for(;_<b;){let g=u.charCodeAt(_++);if(g>=55296&&g<=56319){if(_<b){const M=u.charCodeAt(_);(M&64512)===56320&&(++_,g=((g&1023)<<10)+(M&1023)+65536)}if(g>=55296&&g<=56319)continue}if(p+4>k.length){y+=8,y*=1+_/u.length*2,y=y>>3<<3;const M=new Uint8Array(y);M.set(k),k=M}if(g&4294967168)if(!(g&4294965248))k[p++]=g>>6&31|192;else if(!(g&4294901760))k[p++]=g>>12&15|224,k[p++]=g>>6&63|128;else if(!(g&4292870144))k[p++]=g>>18&7|240,k[p++]=g>>12&63|128,k[p++]=g>>6&63|128;else continue;else{k[p++]=g;continue}k[p++]=g&63|128}return k.slice(0,p)};function r(u="utf-8",v={fatal:!1}){if(u!=="utf-8")throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${u}') is invalid.`);if(v.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(r.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(r.prototype,"fatal",{value:!1}),Object.defineProperty(r.prototype,"ignoreBOM",{value:!1}),r.prototype.decode=function(u,v={stream:!1}){if(v.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const _=new Uint8Array(u);let b=0;const p=_.length,y=[];for(;b<p;){const k=_[b++];if(k===0)break;if(!(k&128))y.push(k);else if((k&224)===192){const g=_[b++]&63;y.push((k&31)<<6|g)}else if((k&240)===224){const g=_[b++]&63,M=_[b++]&63;y.push((k&31)<<12|g<<6|M)}else if((k&248)===240){const g=_[b++]&63,M=_[b++]&63,P=_[b++]&63;let R=(k&7)<<18|g<<12|M<<6|P;R>65535&&(R-=65536,y.push(R>>>10&1023|55296),R=56320|R&1023),y.push(R)}}return String.fromCharCode.apply(null,y)},n.TextEncoder=t,n.TextDecoder=r})(typeof window<"u"?window:typeof self<"u"?self:this)}),"./node_modules/iobuffer/lib-esm/text.browser.js":((n,t,r)=>{r.r(t),r.d(t,{decode:()=>u,encode:()=>_}),r("./node_modules/iobuffer/lib-esm/text-encoding-polyfill.js");function u(b,p="utf8"){return new TextDecoder(p).decode(b)}const v=new TextEncoder;function _(b){return v.encode(b)}}),"./node_modules/netcdfjs/lib-esm/data.js":((n,t,r)=>{r.r(t),r.d(t,{nonRecord:()=>v,record:()=>_});var u=r("./node_modules/netcdfjs/lib-esm/types.js");function v(b,p){const y=(0,u.str2num)(p.type),k=p.size/(0,u.num2bytes)(y),g=new Array(k);for(let M=0;M<k;M++)g[M]=(0,u.readType)(b,y,1);return g}function _(b,p,y){const k=(0,u.str2num)(p.type),g=p.size?p.size/(0,u.num2bytes)(k):1,M=y.length,P=new Array(M),R=y.recordStep;if(R)for(let S=0;S<M;S++){const a=b.offset;P[S]=(0,u.readType)(b,k,g),b.seek(a+R)}else throw new Error("recordDimension.recordStep is undefined");return P}}),"./node_modules/netcdfjs/lib-esm/header.js":((n,t,r)=>{r.r(t),r.d(t,{header:()=>g});var u=r("./node_modules/netcdfjs/lib-esm/types.js"),v=r("./node_modules/netcdfjs/lib-esm/utils.js");const _=0,b=10,p=11,y=12,k=0;function g(S,a){const s={version:a},c={length:S.readUint32()},w=M(S);Array.isArray(w)||(c.id=w.recordId,c.name=w.recordName,s.dimensions=w.dimensions),s.globalAttributes=P(S);const x=R(S,c?.id,a);return Array.isArray(x)||(s.variables=x.variables,c.recordStep=x.recordStep),s.recordDimension=c,s}function M(S){const a={};let s,c;const w=S.readUint32();let x;if(w===_)return(0,v.notNetcdf)(S.readUint32()!==_,"wrong empty tag for list of dimensions"),[];{(0,v.notNetcdf)(w!==b,"wrong tag for list of dimensions");const T=S.readUint32();x=new Array(T);for(let l=0;l<T;l++){const h=(0,v.readName)(S),C=S.readUint32();C===k&&(s=l,c=h),x[l]={name:h,size:C}}}return s!==void 0&&(a.recordId=s),c!==void 0&&(a.recordName=c),a.dimensions=x,a}function P(S){const a=S.readUint32();let s;if(a===_)return(0,v.notNetcdf)(S.readUint32()!==_,"wrong empty tag for list of attributes"),[];{(0,v.notNetcdf)(a!==y,"wrong tag for list of attributes");const c=S.readUint32();s=new Array(c);for(let w=0;w<c;w++){const x=(0,v.readName)(S),T=S.readUint32();(0,v.notNetcdf)(T<1||T>6,`non valid type ${T}`);const l=S.readUint32(),h=(0,u.readType)(S,T,l);(0,v.padding)(S),s[w]={name:x,type:(0,u.num2str)(T),value:h}}}return s}function R(S,a,s){const c=S.readUint32();let w=0,x;if(c===_)return(0,v.notNetcdf)(S.readUint32()!==_,"wrong empty tag for list of variables"),[];{(0,v.notNetcdf)(c!==p,"wrong tag for list of variables");const T=S.readUint32();x=new Array(T);for(let l=0;l<T;l++){const h=(0,v.readName)(S),C=S.readUint32(),E=new Array(C);for(let W=0;W<C;W++)E[W]=S.readUint32();const D=P(S),z=S.readUint32();(0,v.notNetcdf)(z<1&&z>6,`non valid type ${z}`);const L=S.readUint32();let V=S.readUint32();s===2&&((0,v.notNetcdf)(V>0,"offsets larger than 4GB not supported"),V=S.readUint32());let O=!1;typeof a<"u"&&E[0]===a&&(w+=L,O=!0),x[l]={name:h,dimensions:E,attributes:D,type:(0,u.num2str)(z),size:L,offset:V,record:O}}}return{variables:x,recordStep:w}}}),"./node_modules/netcdfjs/lib-esm/index.js":((n,t,r)=>{r.r(t),r.d(t,{NetCDFReader:()=>u.NetCDFReader});var u=r("./node_modules/netcdfjs/lib-esm/parser.js")}),"./node_modules/netcdfjs/lib-esm/parser.js":((n,t,r)=>{r.r(t),r.d(t,{NetCDFReader:()=>y});var u=r("./node_modules/iobuffer/lib-esm/IOBuffer.js"),v=r("./node_modules/netcdfjs/lib-esm/data.js"),_=r("./node_modules/netcdfjs/lib-esm/header.js"),b=r("./node_modules/netcdfjs/lib-esm/toString.js"),p=r("./node_modules/netcdfjs/lib-esm/utils.js");class y{constructor(g){this.toString=b.toString;const M=new u.IOBuffer(g);M.setBigEndian(),(0,p.notNetcdf)(M.readChars(3)!=="CDF","should start with CDF");const P=M.readByte();(0,p.notNetcdf)(P>2,"unknown version"),this.header=(0,_.header)(M,P),this.buffer=M}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(g){const M=this.globalAttributes.find(P=>P.name===g);return M?M.value:null}getDataVariableAsString(g){const M=this.getDataVariable(g);return M?M.join(""):null}get variables(){return this.header.variables}getDataVariable(g){let M;if(typeof g=="string"?M=this.header.variables.find(P=>P.name===g):M=g,M===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(M.offset),M.record?(0,v.record)(this.buffer,M,this.header.recordDimension):(0,v.nonRecord)(this.buffer,M)}dataVariableExists(g){return this.header.variables.find(M=>M.name===g)!==void 0}attributeExists(g){return this.globalAttributes.find(M=>M.name===g)!==void 0}}}),"./node_modules/netcdfjs/lib-esm/toString.js":((n,t,r)=>{r.r(t),r.d(t,{toString:()=>u});function u(){const v=[];v.push("DIMENSIONS");for(const b of this.dimensions)v.push(`  ${b.name.padEnd(30)} = size: ${b.size}`);v.push(""),v.push("GLOBAL ATTRIBUTES");for(const b of this.globalAttributes)v.push(`  ${b.name.padEnd(30)} = ${b.value}`);const _=JSON.parse(JSON.stringify(this.variables));v.push(""),v.push("VARIABLES:");for(const b of _){b.value=this.getDataVariable(b);let p=JSON.stringify(b.value);p.length>50&&(p=p.substring(0,50)),isNaN(b.value.length)||(p+=` (length: ${b.value.length})`),v.push(`  ${b.name.padEnd(30)} = ${p}`)}return v.join(`
`)}}),"./node_modules/netcdfjs/lib-esm/types.js":((n,t,r)=>{r.r(t),r.d(t,{num2bytes:()=>_,num2str:()=>v,readType:()=>y,str2num:()=>b});const u={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function v(g){switch(Number(g)){case u.BYTE:return"byte";case u.CHAR:return"char";case u.SHORT:return"short";case u.INT:return"int";case u.FLOAT:return"float";case u.DOUBLE:return"double";default:return"undefined"}}function _(g){switch(Number(g)){case u.BYTE:return 1;case u.CHAR:return 1;case u.SHORT:return 2;case u.INT:return 4;case u.FLOAT:return 4;case u.DOUBLE:return 8;default:return-1}}function b(g){switch(String(g)){case"byte":return u.BYTE;case"char":return u.CHAR;case"short":return u.SHORT;case"int":return u.INT;case"float":return u.FLOAT;case"double":return u.DOUBLE;default:return-1}}function p(g,M){if(g!==1){const P=new Array(g);for(let R=0;R<g;R++)P[R]=M();return P}else return M()}function y(g,M,P){switch(M){case u.BYTE:return Array.from(g.readBytes(P));case u.CHAR:return k(g.readChars(P));case u.SHORT:return p(P,g.readInt16.bind(g));case u.INT:return p(P,g.readInt32.bind(g));case u.FLOAT:return p(P,g.readFloat32.bind(g));case u.DOUBLE:return p(P,g.readFloat64.bind(g));default:throw new Error(`non valid type ${M}`)}}function k(g){return g.charCodeAt(g.length-1)===0?g.substring(0,g.length-1):g}}),"./node_modules/netcdfjs/lib-esm/utils.js":((n,t,r)=>{r.r(t),r.d(t,{notNetcdf:()=>u,padding:()=>v,readName:()=>_});function u(b,p){if(b)throw new TypeError(`Not a valid NetCDF v3.x file: ${p}`)}function v(b){b.offset%4!==0&&b.skip(4-b.offset%4)}function _(b){const p=b.readUint32(),y=b.readChars(p);return v(b),y}}),"./src/WebGL/shaders/lib/basic/basic.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;
    float fogFactor = smoothstep( fogNear, fogFar, depth );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
}`}),"./src/WebGL/shaders/lib/basic/basic.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`}),"./src/WebGL/shaders/lib/blur/blur.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`}),"./src/WebGL/shaders/lib/blur/blur.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/instanced/instanced.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`}),"./src/WebGL/shaders/lib/instanced/instanced.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`}),"./src/WebGL/shaders/lib/lambert/lambert.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}`}),"./src/WebGL/shaders/lib/lambert/lambert.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`}),"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`}),"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`}),"./src/WebGL/shaders/lib/outline/outline.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );
}


`}),"./src/WebGL/shaders/lib/outline/outline.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    gl_Position = projectionMatrix * mvPosition;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`}),"./src/WebGL/shaders/lib/screen/screen.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `}),"./src/WebGL/shaders/lib/screen/screen.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/screenaa/screenaa.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec3 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP).xyz;
    vec3 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP).xyz;
    vec3 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP).xyz;
    vec3 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP).xyz;
    vec3 rgbM  = texture2D(tex, fragCoord  * inverseVP).xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)).xyz +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5).xyz +
        texture2D(tex, fragCoord  + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, 1.0);
    else
        color = vec4(rgbB, 1.0);
    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        `}),"./src/WebGL/shaders/lib/screenaa/screenaa.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    float fogFactor = smoothstep( fogNear, fogFar, gl_FragDepthEXT/gl_FragCoord.w );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );


}

`}),"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`}),"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );
}


`}),"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);
    vec4 adjust = projectionMatrix* vec4(norm,normal.z,0.0); adjust.z = 0.0; adjust.w = 0.0;
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+adjust;
}

`}),"./src/WebGL/shaders/lib/sprite/sprite.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform int fogType;
uniform vec3 fogColor;
uniform float fogDensity;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogType > 0) {

        float depth = gl_FragCoord.z / gl_FragCoord.w;
        float fogFactor = 0.0;

        if (fogType == 1) {
            fogFactor = smoothstep(fogNear, fogFar, depth);
        }

        else {
            const float LOG2 = 1.442695;
            float fogFactor = exp2(- fogDensity * fogDensity * depth * depth * LOG2);
            fogFactor = 1.0 - clamp(fogFactor, 0.0, 1.0);
        }

        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);

    }
}

`}),"./src/WebGL/shaders/lib/sprite/sprite.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`}),"./src/WebGL/shaders/lib/ssao/ssao.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`}),"./src/WebGL/shaders/lib/ssao/ssao.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    float fogFactor = smoothstep( fogNear, fogFar, depth );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
}`}),"./src/WebGL/shaders/lib/stickimposter/stickimposter.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(projectionMatrix[3][3] == 0.0) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(projectionMatrix[3][3] == 0.0) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }
    vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
    mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`}),"./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`}),"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    to.xyz += normalize(to.xyz)*outlinePushback;
    pt.xyz += normalize(pt.xyz)*outlinePushback;

    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }
    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`}),"./src/WebGL/shaders/lib/volumetric/volumetric.frag":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `}),"./src/WebGL/shaders/lib/volumetric/volumetric.vert":((n,t,r)=>{r.r(t),r.d(t,{default:()=>u});const u=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`}),"./src/GLDraw.ts":((n,t,r)=>{r.r(t),r.d(t,{CAP:()=>v,GLDraw:()=>_});var u=r("./src/WebGL/math/index.ts"),v;(function(b){b[b.NONE=0]="NONE",b[b.FLAT=1]="FLAT",b[b.ROUND=2]="ROUND"})(v||(v={}));var _;(function(b){function p(a,s,c){var w=Math.hypot(a,s),x,T,l,h,C;w<1e-4?(T=0,l=1):(T=-a/w,l=s/w),s=-T*a+l*s,x=Math.hypot(s,c),x<1e-4?(h=0,C=1):(h=c/x,C=s/x);var E=new Float32Array(9);return E[0]=l,E[1]=T,E[2]=0,E[3]=-T*C,E[4]=l*C,E[5]=h,E[6]=T*h,E[7]=-l*h,E[8]=C,E}class y{constructor(){this.cache={};let s=[],c=4,w=Math.pow(2,c),x=2,T=Math.pow(2,x),l=w/T,h;for(s[0]=new u.Vector3(-1,0,0),s[l]=new u.Vector3(0,0,1),s[l*2]=new u.Vector3(1,0,0),s[l*3]=new u.Vector3(0,0,-1),x=3;x<=c;x++){for(T=Math.pow(2,x-1),l=w/T,h=0;h<T-1;h++)s[l/2+h*l]=s[h*l].clone().add(s[(h+1)*l]).normalize();h=T-1,s[l/2+h*l]=s[h*l].clone().add(s[0]).normalize()}this.basisVectors=s}getVerticesForRadius(s,c,w){if(typeof this.cache<"u"&&this.cache[s]!==void 0&&this.cache[s][c+w]!==void 0)return this.cache[s][c+w];for(var x=this.basisVectors.length,T=[],l=[],h,C=0;C<x;C++)T.push(this.basisVectors[C].clone().multiplyScalar(s)),T.push(this.basisVectors[C].clone().multiplyScalar(s)),h=this.basisVectors[C].clone().normalize(),l.push(h),l.push(h);var E=[],D=10,z=x,L=0,V=Math.PI*2,O=0,W=Math.PI,H,q,U=!1,B=!1;for(q=0;q<=D;q++){U=q===0||q===D,B=q===D/2;var Y=[],X=[];for(H=0;H<=z;H++){if(B){var j=H<z?2*H:0;X.push(j+1),Y.push(j);continue}var J=H/z,le=q/D;if(!U||H===0)if(H<z){var se=new u.Vector3;se.x=-s*Math.cos(L+J*V)*Math.sin(O+le*W),c==1?se.y=0:se.y=s*Math.cos(O+le*W),se.z=s*Math.sin(L+J*V)*Math.sin(O+le*W),Math.abs(se.x)<1e-5&&(se.x=0),Math.abs(se.y)<1e-5&&(se.y=0),Math.abs(se.z)<1e-5&&(se.z=0),c==v.FLAT?(h=new u.Vector3(0,Math.cos(O+le*W),0),h.normalize()):(h=new u.Vector3(se.x,se.y,se.z),h.normalize()),T.push(se),l.push(h),Y.push(T.length-1)}else Y.push(T.length-z);else U&&Y.push(T.length-1)}B&&E.push(X),E.push(Y)}var he={vertices:T,normals:l,verticesRows:E,w:z,h:D};return s in this.cache||(this.cache[s]={}),this.cache[s][c+w]=he,he}}var k=new y;function g(a,s,c,w,x,T=0,l=0){if(!s||!c)return;let h=function(ke){if(typeof ke=="string"){let ct=ke;return ct.toLowerCase()=="flat"?v.FLAT:ct.toLowerCase()=="round"?v.ROUND:v.NONE}else return ke};T=h(T),l=h(l);var C=l||T;x=x||{r:0,g:0,b:0};var E=p(c.x-s.x,c.y-s.y,c.z-s.z),D=k.getVerticesForRadius(w,l,"to"),z=D.w,L=D.h,V=C?L*z+2:2*z,O=a.updateGeoGroup(V),W=D.vertices,H=D.normals,q=D.verticesRows,U=q[L/2],B=q[L/2+1],Y=O.vertices,X,j,J,le,se,he,pe=O.vertexArray,ve=O.normalArray,ce=O.colorArray,me=O.faceArray;for(J=0;J<z;++J){var Re=2*J;le=E[0]*W[Re].x+E[3]*W[Re].y+E[6]*W[Re].z,se=E[1]*W[Re].x+E[4]*W[Re].y+E[7]*W[Re].z,he=E[5]*W[Re].y+E[8]*W[Re].z,X=3*(Y+Re),j=O.faceidx,pe[X]=le+s.x,pe[X+1]=se+s.y,pe[X+2]=he+s.z,pe[X+3]=le+c.x,pe[X+4]=se+c.y,pe[X+5]=he+c.z,ve[X]=le,ve[X+3]=le,ve[X+1]=se,ve[X+4]=se,ve[X+2]=he,ve[X+5]=he,ce[X]=x.r,ce[X+3]=x.r,ce[X+1]=x.g,ce[X+4]=x.g,ce[X+2]=x.b,ce[X+5]=x.b,me[j]=B[J]+Y,me[j+1]=B[J+1]+Y,me[j+2]=U[J]+Y,me[j+3]=U[J]+Y,me[j+4]=B[J+1]+Y,me[j+5]=U[J+1]+Y,O.faceidx+=6}if(C){var Ge=l?0:L/2,We=T?L+1:L/2+1,Oe,fe,De,qe,Qe,st,ot,Ke,Je,Xe,je,Ue,ft,ut,ee,ie,oe,we,Se,He,Be,K,_e,Me,$e,ye,Ne,Z,ze,rt,G,Te;for(se=Ge;se<We;se++)if(se!==L/2){var Ee=se<=L/2?c:s,re=k.getVerticesForRadius(w,l,"to"),ge=k.getVerticesForRadius(w,T,"from");for(Ee===c?(W=re.vertices,H=re.normals,q=re.verticesRows):Ee==s&&(W=ge.vertices,H=ge.normals,q=ge.verticesRows),le=0;le<z;le++)j=O.faceidx,Oe=q[se][le+1],ze=(Oe+Y)*3,fe=q[se][le],rt=(fe+Y)*3,De=q[se+1][le],G=(De+Y)*3,qe=q[se+1][le+1],Te=(qe+Y)*3,Qe=E[0]*W[Oe].x+E[3]*W[Oe].y+E[6]*W[Oe].z,st=E[0]*W[fe].x+E[3]*W[fe].y+E[6]*W[fe].z,ot=E[0]*W[De].x+E[3]*W[De].y+E[6]*W[De].z,Ke=E[0]*W[qe].x+E[3]*W[qe].y+E[6]*W[qe].z,Je=E[1]*W[Oe].x+E[4]*W[Oe].y+E[7]*W[Oe].z,Xe=E[1]*W[fe].x+E[4]*W[fe].y+E[7]*W[fe].z,je=E[1]*W[De].x+E[4]*W[De].y+E[7]*W[De].z,Ue=E[1]*W[qe].x+E[4]*W[qe].y+E[7]*W[qe].z,ft=E[5]*W[Oe].y+E[8]*W[Oe].z,ut=E[5]*W[fe].y+E[8]*W[fe].z,ee=E[5]*W[De].y+E[8]*W[De].z,ie=E[5]*W[qe].y+E[8]*W[qe].z,pe[ze]=Qe+Ee.x,pe[rt]=st+Ee.x,pe[G]=ot+Ee.x,pe[Te]=Ke+Ee.x,pe[ze+1]=Je+Ee.y,pe[rt+1]=Xe+Ee.y,pe[G+1]=je+Ee.y,pe[Te+1]=Ue+Ee.y,pe[ze+2]=ft+Ee.z,pe[rt+2]=ut+Ee.z,pe[G+2]=ee+Ee.z,pe[Te+2]=ie+Ee.z,ce[ze]=x.r,ce[rt]=x.r,ce[G]=x.r,ce[Te]=x.r,ce[ze+1]=x.g,ce[rt+1]=x.g,ce[G+1]=x.g,ce[Te+1]=x.g,ce[ze+2]=x.b,ce[rt+2]=x.b,ce[G+2]=x.b,ce[Te+2]=x.b,oe=E[0]*H[Oe].x+E[3]*H[Oe].y+E[6]*H[Oe].z,we=E[0]*H[fe].x+E[3]*H[fe].y+E[6]*H[fe].z,Se=E[0]*H[De].x+E[3]*H[De].y+E[6]*H[De].z,He=E[0]*H[qe].x+E[3]*H[qe].y+E[6]*H[qe].z,Be=E[1]*H[Oe].x+E[4]*H[Oe].y+E[7]*H[Oe].z,K=E[1]*H[fe].x+E[4]*H[fe].y+E[7]*H[fe].z,_e=E[1]*H[De].x+E[4]*H[De].y+E[7]*H[De].z,Me=E[1]*H[qe].x+E[4]*H[qe].y+E[7]*H[qe].z,$e=E[5]*H[Oe].y+E[8]*H[Oe].z,ye=E[5]*H[fe].y+E[8]*H[fe].z,Ne=E[5]*H[De].y+E[8]*H[De].z,Z=E[5]*H[qe].y+E[8]*H[qe].z,se===0?(ve[ze]=oe,ve[G]=Se,ve[Te]=He,ve[ze+1]=Be,ve[G+1]=_e,ve[Te+1]=Me,ve[ze+2]=$e,ve[G+2]=Ne,ve[Te+2]=Z,me[j]=Oe+Y,me[j+1]=De+Y,me[j+2]=qe+Y,O.faceidx+=3):se===We-1?(ve[ze]=oe,ve[rt]=we,ve[G]=Se,ve[ze+1]=Be,ve[rt+1]=K,ve[G+1]=_e,ve[ze+2]=$e,ve[rt+2]=ye,ve[G+2]=Ne,me[j]=Oe+Y,me[j+1]=fe+Y,me[j+2]=De+Y,O.faceidx+=3):(ve[ze]=oe,ve[rt]=we,ve[Te]=He,ve[ze+1]=Be,ve[rt+1]=K,ve[Te+1]=Me,ve[ze+2]=$e,ve[rt+2]=ye,ve[Te+2]=Z,ve[rt]=we,ve[G]=Se,ve[Te]=He,ve[rt+1]=K,ve[G+1]=_e,ve[Te+1]=Me,ve[rt+2]=ye,ve[G+2]=Ne,ve[Te+2]=Z,me[j]=Oe+Y,me[j+1]=fe+Y,me[j+2]=qe+Y,me[j+3]=fe+Y,me[j+4]=De+Y,me[j+5]=qe+Y,O.faceidx+=6)}}O.vertices+=V}b.drawCylinder=g;function M(a,s,c,w,x){if(!s||!c)return;x=x||{r:0,g:0,b:0};let T=new u.Vector3(c.x-s.x,c.y-s.y,c.z-s.z);var l=p(T.x,T.y,T.z);T=T.normalize();var h=k.basisVectors.length,C=k.basisVectors,E=h+2,D=a.updateGeoGroup(E),z=D.vertices,L,V,O,W,H,q,U=D.vertexArray,B=D.normalArray,Y=D.colorArray,X=D.faceArray;for(L=z*3,U[L]=s.x,U[L+1]=s.y,U[L+2]=s.z,B[L]=-T.x,B[L+1]=-T.y,B[L+2]=-T.z,Y[L]=x.r,Y[L+1]=x.g,Y[L+2]=x.b,U[L+3]=c.x,U[L+4]=c.y,U[L+5]=c.z,B[L+3]=T.x,B[L+4]=T.y,B[L+5]=T.z,Y[L+3]=x.r,Y[L+4]=x.g,Y[L+5]=x.b,L+=6,O=0;O<h;++O){var j=C[O].clone();j.multiplyScalar(w),W=l[0]*j.x+l[3]*j.y+l[6]*j.z,H=l[1]*j.x+l[4]*j.y+l[7]*j.z,q=l[5]*j.y+l[8]*j.z,U[L]=W+s.x,U[L+1]=H+s.y,U[L+2]=q+s.z,B[L]=W,B[L+1]=H,B[L+2]=q,Y[L]=x.r,Y[L+1]=x.g,Y[L+2]=x.b,L+=3}for(D.vertices+=h+2,V=D.faceidx,O=0;O<h;O++){var J=z+2+O,le=z+2+(O+1)%h;X[V]=J,X[V+1]=le,X[V+2]=z,V+=3,X[V]=J,X[V+1]=le,X[V+2]=z+1,V+=3}D.faceidx+=6*h}b.drawCone=M;class P{constructor(){this.cache=new Map}getVerticesForRadius(s,c){c=c||2,this.cache.has(c)||this.cache.set(c,new Map);let w=this.cache.get(c);if(w.has(s))return w.get(s);var x={vertices:[],verticesRows:[],normals:[]},T=16*c,l=10*c;s<1&&(T=10*c,l=8*c);var h=0,C=Math.PI*2,E=0,D=Math.PI,z,L;for(L=0;L<=l;L++){let O=[];for(z=0;z<=T;z++){let W=z/T,H=L/l,q=-s*Math.cos(h+W*C)*Math.sin(E+H*D),U=s*Math.cos(E+H*D),B=s*Math.sin(h+W*C)*Math.sin(E+H*D);var V=new u.Vector3(q,U,B);V.normalize(),x.vertices.push({x:q,y:U,z:B}),x.normals.push(V),O.push(x.vertices.length-1)}x.verticesRows.push(O)}return w.set(s,x),x}}var R=new P;function S(a,s,c,w,x){var T=R.getVerticesForRadius(c,x),l=T.vertices,h=T.normals,C=a.updateGeoGroup(l.length),E=C.vertices,D=C.vertexArray,z=C.colorArray,L=C.faceArray,V=C.lineArray,O=C.normalArray;for(let q=0,U=l.length;q<U;++q){let B=3*(E+q),Y=l[q];D[B]=Y.x+s.x,D[B+1]=Y.y+s.y,D[B+2]=Y.z+s.z,z[B]=w.r,z[B+1]=w.g,z[B+2]=w.b}C.vertices+=l.length;let W=T.verticesRows,H=W.length-1;for(let q=0;q<H;q++){let U=W[q].length-1;for(let B=0;B<U;B++){let Y=C.faceidx,X=C.lineidx,j=W[q][B+1]+E,J=j*3,le=W[q][B]+E,se=le*3,he=W[q+1][B]+E,pe=he*3,ve=W[q+1][B+1]+E,ce=ve*3,me=h[j-E],Re=h[le-E],Ge=h[he-E],We=h[ve-E];Math.abs(l[j-E].y)===c?(O[J]=me.x,O[pe]=Ge.x,O[ce]=We.x,O[J+1]=me.y,O[pe+1]=Ge.y,O[ce+1]=We.y,O[J+2]=me.z,O[pe+2]=Ge.z,O[ce+2]=We.z,L[Y]=j,L[Y+1]=he,L[Y+2]=ve,V[X]=j,V[X+1]=he,V[X+2]=j,V[X+3]=ve,V[X+4]=he,V[X+5]=ve,C.faceidx+=3,C.lineidx+=6):Math.abs(l[he-E].y)===c?(O[J]=me.x,O[se]=Re.x,O[pe]=Ge.x,O[J+1]=me.y,O[se+1]=Re.y,O[pe+1]=Ge.y,O[J+2]=me.z,O[se+2]=Re.z,O[pe+2]=Ge.z,L[Y]=j,L[Y+1]=le,L[Y+2]=he,V[X]=j,V[X+1]=le,V[X+2]=j,V[X+3]=he,V[X+4]=le,V[X+5]=he,C.faceidx+=3,C.lineidx+=6):(O[J]=me.x,O[se]=Re.x,O[ce]=We.x,O[J+1]=me.y,O[se+1]=Re.y,O[ce+1]=We.y,O[J+2]=me.z,O[se+2]=Re.z,O[ce+2]=We.z,O[se]=Re.x,O[pe]=Ge.x,O[ce]=We.x,O[se+1]=Re.y,O[pe+1]=Ge.y,O[ce+1]=We.y,O[se+2]=Re.z,O[pe+2]=Ge.z,O[ce+2]=We.z,L[Y]=j,L[Y+1]=le,L[Y+2]=ve,L[Y+3]=le,L[Y+4]=he,L[Y+5]=ve,V[X]=j,V[X+1]=le,V[X+2]=j,V[X+3]=ve,V[X+4]=le,V[X+5]=he,V[X+6]=he,V[X+7]=ve,C.faceidx+=6,C.lineidx+=8)}}}b.drawSphere=S})(_||(_={}))}),"./src/GLModel.ts":((n,t,r)=>{r.r(t),r.d(t,{GLModel:()=>S});var u=r("./src/WebGL/index.ts"),v=r("./src/WebGL/shapes/index.ts"),_=r("./src/WebGL/math/index.ts"),b=r("./src/colors.ts"),p=r("./src/GLDraw.ts"),y=r("./src/glcartoon.ts"),k=r("./src/utilities.ts"),g=r("./src/Gradient.ts"),M=r("./src/parsers/index.ts"),P=r("./node_modules/netcdfjs/lib-esm/index.js"),R=r("./src/parsers/utils/assignBonds.ts");class S{static sameObj(s,c){return s&&c?JSON.stringify(s)==JSON.stringify(c):s==c}constructor(s,c){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new _.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=b.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=c||{},this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:b.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=s}getRadiusFromStyle(s,c){var w=this.defaultSphereRadius;if(typeof c.radius<"u")w=c.radius;else if(S.vdwRadii[s.elem])w=S.vdwRadii[s.elem];else if(s.elem.length>1){let x=s.elem;x=x[0].toUpperCase()+x[1].toLowerCase(),S.vdwRadii[x]&&(w=S.vdwRadii[x])}return typeof c.scale<"u"&&(w*=c.scale),w}drawAtomCross(s,c){if(s.style.cross){var w=s.style.cross;if(!w.hidden){var x=w.linewidth||S.defaultlineWidth;c[x]||(c[x]=new u.Geometry);var T=c[x].updateGeoGroup(6),l=this.getRadiusFromStyle(s,w),h=[[l,0,0],[-l,0,0],[0,l,0],[0,-l,0],[0,0,l],[0,0,-l]],C=s.clickable||s.hoverable;C&&s.intersectionShape===void 0&&(s.intersectionShape={sphere:[],cylinder:[],line:[]});for(var E=(0,k.getColorFromStyle)(s,w),D=T.vertexArray,z=T.colorArray,L=0;L<6;L++){var V=T.vertices*3;if(T.vertices++,D[V]=s.x+h[L][0],D[V+1]=s.y+h[L][1],D[V+2]=s.z+h[L][2],z[V]=E.r,z[V+1]=E.g,z[V+2]=E.b,C){var O=new _.Vector3(h[L][0],h[L][1],h[L][2]);O.multiplyScalar(.1),O.set(O.x+s.x,O.y+s.y,O.z+s.z),s.intersectionShape.line.push(O)}}}}}getGoodCross(s,c,w,x){for(var T=null,l=-1,h=0,C=s.bonds.length;h<C;h++)if(s.bonds[h]!=c.index){let D=s.bonds[h],z=this.atoms[D],L=new _.Vector3(z.x,z.y,z.z).clone();L.sub(w);let V=L.clone();V.cross(x);var E=V.lengthSq();if(E>l&&(l=E,T=V,l>.1))return T}return T}getSideBondV(s,c,w){var x,T,l,h,C,E=new _.Vector3(s.x,s.y,s.z),D=new _.Vector3(c.x,c.y,c.z),z=D.clone(),L=null;if(z.sub(E),s.bonds.length===1)c.bonds.length===1?(L=z.clone(),Math.abs(L.x)>1e-4?L.y+=1:L.x+=1):(x=(w+1)%c.bonds.length,T=c.bonds[x],l=this.atoms[T],l.index==s.index&&(x=(x+1)%c.bonds.length,T=c.bonds[x],l=this.atoms[T]),h=new _.Vector3(l.x,l.y,l.z),C=h.clone(),C.sub(E),L=C.clone(),L.cross(z));else if(L=this.getGoodCross(s,c,E,z),L.lengthSq()<.01){var V=this.getGoodCross(c,s,E,z);V!=null&&(L=V)}return L.lengthSq()<.01&&(L=z.clone(),Math.abs(L.x)>1e-4?L.y+=1:L.x+=1),L.cross(z),L.normalize(),L}addLine(s,c,w,x,T,l){s[w]=x.x,s[w+1]=x.y,s[w+2]=x.z,c[w]=l.r,c[w+1]=l.g,c[w+2]=l.b,s[w+3]=T.x,s[w+4]=T.y,s[w+5]=T.z,c[w+3]=l.r,c[w+4]=l.g,c[w+5]=l.b}drawBondLines(s,c,w){if(s.style.line){var x=s.style.line;if(!x.hidden){var T,l,h,C,E=x.linewidth||S.defaultlineWidth;w[E]||(w[E]=new u.Geometry);for(var D=w[E].updateGeoGroup(6*s.bonds.length),z=D.vertexArray,L=D.colorArray,V=0;V<s.bonds.length;V++){var O=s.bonds[V],W=c[O];if(W.style.line&&!(s.index>=W.index)){var H=new _.Vector3(s.x,s.y,s.z),q=new _.Vector3(W.x,W.y,W.z),U=H.clone().add(q).multiplyScalar(.5),B=!1,Y=s.clickable||s.hoverable,X=W.clickable||W.hoverable;(Y||X)&&(Y&&(s.intersectionShape===void 0&&(s.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),s.intersectionShape.line.push(H),s.intersectionShape.line.push(U)),X&&(W.intersectionShape===void 0&&(W.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),W.intersectionShape.line.push(U),W.intersectionShape.line.push(q)));var j=(0,k.getColorFromStyle)(s,s.style.line),J=(0,k.getColorFromStyle)(W,W.style.line);if(s.bondStyles&&s.bondStyles[V]){var le=s.bondStyles[V];if(!le.iswire)continue;le.singleBond&&(B=!0),typeof le.color1<"u"&&(j=b.CC.color(le.color1)),typeof le.color2<"u"&&(J=b.CC.color(le.color2))}var se=D.vertices*3,he,pe;if(s.bondOrder[V]>1&&s.bondOrder[V]<4&&!B){var ve=this.getSideBondV(s,W,V),ce=q.clone();ce.sub(H),s.bondOrder[V]==2?(ve.multiplyScalar(.1),T=H.clone(),T.add(ve),l=H.clone(),l.sub(ve),h=T.clone(),h.add(ce),C=l.clone(),C.add(ce),j==J?(D.vertices+=4,this.addLine(z,L,se,T,h,j),this.addLine(z,L,se+6,l,C,j)):(D.vertices+=8,ce.multiplyScalar(.5),he=T.clone(),he.add(ce),pe=l.clone(),pe.add(ce),this.addLine(z,L,se,T,he,j),this.addLine(z,L,se+6,he,h,J),this.addLine(z,L,se+12,l,pe,j),this.addLine(z,L,se+18,pe,C,J))):s.bondOrder[V]==3&&(ve.multiplyScalar(.1),T=H.clone(),T.add(ve),l=H.clone(),l.sub(ve),h=T.clone(),h.add(ce),C=l.clone(),C.add(ce),j==J?(D.vertices+=6,this.addLine(z,L,se,H,q,j),this.addLine(z,L,se+6,T,h,j),this.addLine(z,L,se+12,l,C,j)):(D.vertices+=12,ce.multiplyScalar(.5),he=T.clone(),he.add(ce),pe=l.clone(),pe.add(ce),this.addLine(z,L,se,H,U,j),this.addLine(z,L,se+6,U,q,J),this.addLine(z,L,se+12,T,he,j),this.addLine(z,L,se+18,he,h,J),this.addLine(z,L,se+24,l,pe,j),this.addLine(z,L,se+30,pe,C,J)))}else j==J?(D.vertices+=2,this.addLine(z,L,se,H,q,j)):(D.vertices+=4,this.addLine(z,L,se,H,U,j),this.addLine(z,L,se+6,U,q,J))}}}}}drawAtomSphere(s,c){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var x=(0,k.getColorFromStyle)(s,w),T=this.getRadiusFromStyle(s,w);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var l=new _.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new v.Sphere(l,T))}p.GLDraw.drawSphere(c,s,T,x)}}}drawAtomClickSphere(s){if(s.style.clicksphere){var c=s.style.clicksphere;if(!c.hidden){var w=this.getRadiusFromStyle(s,c);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var x=new _.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new v.Sphere(x,w))}}}}drawAtomInstanced(s,c){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var x=this.getRadiusFromStyle(s,w),T=(0,k.getColorFromStyle)(s,w),l=c.updateGeoGroup(1),h=l.vertices,C=h*3,E=l.vertexArray,D=l.colorArray,z=l.radiusArray;if(E[C]=s.x,E[C+1]=s.y,E[C+2]=s.z,D[C]=T.r,D[C+1]=T.g,D[C+2]=T.b,z[h]=x,(s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var L=new _.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new v.Sphere(L,x))}l.vertices+=1}}}drawSphereImposter(s,c,w,x){var T=s.updateGeoGroup(4),l,h=T.vertices,C=h*3,E=T.vertexArray,D=T.colorArray;for(l=0;l<4;l++)E[C+3*l]=c.x,E[C+3*l+1]=c.y,E[C+3*l+2]=c.z;var z=T.normalArray;for(l=0;l<4;l++)D[C+3*l]=x.r,D[C+3*l+1]=x.g,D[C+3*l+2]=x.b;z[C+0]=-w,z[C+1]=w,z[C+2]=0,z[C+3]=-w,z[C+4]=-w,z[C+5]=0,z[C+6]=w,z[C+7]=-w,z[C+8]=0,z[C+9]=w,z[C+10]=w,z[C+11]=0,T.vertices+=4;var L=T.faceArray,V=T.faceidx;L[V+0]=h,L[V+1]=h+1,L[V+2]=h+2,L[V+3]=h+2,L[V+4]=h+3,L[V+5]=h,T.faceidx+=6}drawAtomImposter(s,c){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var x=this.getRadiusFromStyle(s,w),T=(0,k.getColorFromStyle)(s,w);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var l=new _.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new v.Sphere(l,x))}this.drawSphereImposter(c,s,x,T)}}}calculateDashes(s,c,w,x,T){var l=Math.sqrt(Math.pow(s.x-c.x,2)+Math.pow(s.y-c.y,2)+Math.pow(s.z-c.z,2));w=Math.max(w,0),T=Math.max(T,0)+2*w,x=Math.max(x,.001),x+T>l&&(x=l,T=0);var h=Math.floor((l-x)/(x+T))+1,C=h*x;T=(l-C)/h;for(var E,D=new _.Vector3(s.x,s.y,s.z),z=new _.Vector3((c.x-s.x)/(l/T),(c.y-s.y)/(l/T),(c.z-s.z)/(l/T)),L=new _.Vector3((c.x-s.x)/(l/x),(c.y-s.y)/(l/x),(c.z-s.z)/(l/x)),V=[],O=0;O<h;O++)E=new _.Vector3(D.x+L.x,D.y+L.y,D.z+L.z),V.push({from:D,to:E}),D=new _.Vector3(E.x+z.x,E.y+z.y,E.z+z.z);return V}static drawStickImposter(s,c,w,x,T,l=0,h=0){for(var C=s.updateGeoGroup(4),E=C.vertices,D=E*3,z=C.vertexArray,L=C.colorArray,V=C.radiusArray,O=C.normalArray,W=T.r,H=T.g,q=T.b,U=function(J){var le=-J;return le==0&&(le=-1e-4),le},B=D,Y=0;Y<4;Y++)z[B]=c.x,O[B]=w.x,L[B]=W,B++,z[B]=c.y,O[B]=w.y,L[B]=H,B++,z[B]=c.z,O[B]=w.z,Y<2?L[B]=q:L[B]=U(q),B++;C.vertices+=4,V[E]=-x,V[E+1]=x,V[E+2]=-x,V[E+3]=x;var X=C.faceArray,j=C.faceidx;X[j+0]=E,X[j+1]=E+1,X[j+2]=E+2,X[j+3]=E+2,X[j+4]=E+3,X[j+5]=E,C.faceidx+=6}drawBondSticks(s,c,w){var x,T;if(s.style.stick){var l=s.style.stick;if(!l.hidden){var h=l.radius||this.defaultStickRadius,C=l.doubleBondScaling||.4,E=l.tripleBondScaling||.25,D=((x=l.dashedBondConfig)===null||x===void 0?void 0:x.dashLength)||.1,z=((T=l.dashedBondConfig)===null||T===void 0?void 0:T.gapLength)||.25,L=h,V=l.singleBonds||!1,O=l.dashedBonds||!1,W=0,H=0,q,U,B,Y,X,j,J,le,se,he,pe,ve=(0,k.getColorFromStyle)(s,l),ce,me,Re;!s.capDrawn&&s.bonds.length<4&&(W=2);var Ge=_e=>{var Me=w.imposter?S.drawStickImposter:p.GLDraw.drawCylinder;return!O&&_e>=1?Me:($e,ye,Ne,Z,ze,rt=0,G=0,Te=.1,Ee=.25)=>{var re=this.calculateDashes(ye,Ne,Z,Te,Ee);re.forEach(ge=>{Me($e,ge.from,ge.to,Z,ze,rt,G)})}};for(B=0;B<s.bonds.length;B++){var We=Ge(s.bondOrder[B]),Oe=s.bonds[B],fe=c[Oe];if(ce=me=Re=null,s.index<fe.index){var De=fe.style;if(!De.stick||De.stick.hidden)continue;var qe=(0,k.getColorFromStyle)(fe,De.stick);if(L=h,Y=V,s.bondStyles&&s.bondStyles[B]){if(X=s.bondStyles[B],X.iswire)continue;X.radius&&(L=X.radius),X.singleBond&&(Y=!0),typeof X.color1<"u"&&(ve=b.CC.color(X.color1)),typeof X.color2<"u"&&(qe=b.CC.color(X.color2))}var Qe=new _.Vector3(s.x,s.y,s.z),st=new _.Vector3(fe.x,fe.y,fe.z);if(s.bondOrder[B]<=1||Y||s.bondOrder[B]>3){if(s.bondOrder[B]<1&&(L*=s.bondOrder[B]),!fe.capDrawn&&fe.bonds.length<4&&(H=2),ve!=qe?(ce=new _.Vector3().addVectors(Qe,st).multiplyScalar(.5),We(w,Qe,ce,L,ve,W,0,D,z),We(w,ce,st,L,qe,0,H,D,z)):We(w,Qe,st,L,ve,W,H,D,z),q=s.clickable||s.hoverable,U=fe.clickable||fe.hoverable,q||U){if(ce||(ce=new _.Vector3().addVectors(Qe,st).multiplyScalar(.5)),q){var ot=new v.Cylinder(Qe,ce,L),Ke=new v.Sphere(Qe,L);s.intersectionShape.cylinder.push(ot),s.intersectionShape.sphere.push(Ke)}if(U){var Je=new v.Cylinder(st,ce,L),Xe=new v.Sphere(st,L);fe.intersectionShape.cylinder.push(Je),fe.intersectionShape.sphere.push(Xe)}}}else if(s.bondOrder[B]>1){var je=0,Ue=0;L!=h&&(je=2,Ue=2);var ft=st.clone(),ut=null;ft.sub(Qe);var ee,ie,oe,we,Se;ut=this.getSideBondV(s,fe,B),s.bondOrder[B]==2?(ee=L*C,ut.multiplyScalar(ee*1.5),ie=Qe.clone(),ie.add(ut),oe=Qe.clone(),oe.sub(ut),we=ie.clone(),we.add(ft),Se=oe.clone(),Se.add(ft),ve!=qe?(ce=new _.Vector3().addVectors(ie,we).multiplyScalar(.5),me=new _.Vector3().addVectors(oe,Se).multiplyScalar(.5),We(w,ie,ce,ee,ve,je,0),We(w,ce,we,ee,qe,0,Ue),We(w,oe,me,ee,ve,je,0),We(w,me,Se,ee,qe,0,Ue)):(We(w,ie,we,ee,ve,je,Ue),We(w,oe,Se,ee,ve,je,Ue)),q=s.clickable||s.hoverable,U=fe.clickable||fe.hoverable,(q||U)&&(ce||(ce=new _.Vector3().addVectors(ie,we).multiplyScalar(.5)),me||(me=new _.Vector3().addVectors(oe,Se).multiplyScalar(.5)),q&&(j=new v.Cylinder(ie,ce,ee),J=new v.Cylinder(oe,me,ee),s.intersectionShape.cylinder.push(j),s.intersectionShape.cylinder.push(J)),U&&(se=new v.Cylinder(we,ce,ee),he=new v.Cylinder(Se,me,ee),fe.intersectionShape.cylinder.push(se),fe.intersectionShape.cylinder.push(he)))):s.bondOrder[B]==3&&(ee=L*E,ut.cross(ft),ut.normalize(),ut.multiplyScalar(ee*3),ie=Qe.clone(),ie.add(ut),oe=Qe.clone(),oe.sub(ut),we=ie.clone(),we.add(ft),Se=oe.clone(),Se.add(ft),ve!=qe?(ce=new _.Vector3().addVectors(ie,we).multiplyScalar(.5),me=new _.Vector3().addVectors(oe,Se).multiplyScalar(.5),Re=new _.Vector3().addVectors(Qe,st).multiplyScalar(.5),We(w,ie,ce,ee,ve,je,0),We(w,ce,we,ee,qe,0,Ue),We(w,Qe,Re,ee,ve,W,0),We(w,Re,st,ee,qe,0,H),We(w,oe,me,ee,ve,je,0),We(w,me,Se,ee,qe,0,Ue)):(We(w,ie,we,ee,ve,je,Ue),We(w,Qe,st,ee,ve,W,H),We(w,oe,Se,ee,ve,je,Ue)),q=s.clickable||s.hoverable,U=fe.clickable||fe.hoverable,(q||U)&&(ce||(ce=new _.Vector3().addVectors(ie,we).multiplyScalar(.5)),me||(me=new _.Vector3().addVectors(oe,Se).multiplyScalar(.5)),Re||(Re=new _.Vector3().addVectors(Qe,st).multiplyScalar(.5)),q&&(j=new v.Cylinder(ie.clone(),ce.clone(),ee),J=new v.Cylinder(oe.clone(),me.clone(),ee),le=new v.Cylinder(Qe.clone(),Re.clone(),ee),s.intersectionShape.cylinder.push(j),s.intersectionShape.cylinder.push(J),s.intersectionShape.cylinder.push(le)),U&&(se=new v.Cylinder(we.clone(),ce.clone(),ee),he=new v.Cylinder(Se.clone(),me.clone(),ee),pe=new v.Cylinder(st.clone(),Re.clone(),ee),fe.intersectionShape.cylinder.push(se),fe.intersectionShape.cylinder.push(he),fe.intersectionShape.cylinder.push(pe))))}}}var He=!1,Be=0,K=!1;for(B=0;B<s.bonds.length;B++)Y=V,s.bondStyles&&s.bondStyles[B]&&(X=s.bondStyles[B],X.singleBond&&(Y=!0),X.radius&&X.radius!=h&&(K=!0)),(Y||s.bondOrder[B]==1)&&Be++;K?Be>0&&(He=!0):Be==0&&(s.bonds.length>0||l.showNonBonded)&&(He=!0),He&&(L=h,w.imposter?this.drawSphereImposter(w.sphereGeometry,s,L,ve):p.GLDraw.drawSphere(w,s,L,ve))}}}createMolObj(s,c){c=c||{};var w=new u.Object3D,x=[],T={},l={},h=this.drawAtomSphere,C=null,E=null;c.supportsImposters?(h=this.drawAtomImposter,C=new u.Geometry(!0),C.imposter=!0,E=new u.Geometry(!0,!0),E.imposter=!0,E.sphereGeometry=new u.Geometry(!0),E.sphereGeometry.imposter=!0,E.drawnCaps={}):c.supportsAIA?(h=this.drawAtomInstanced,C=new u.Geometry(!1,!0,!0),C.instanced=!0,E=new u.Geometry(!0)):(C=new u.Geometry(!0),E=new u.Geometry(!0));var D,z,L,V,O={},W=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(D=0,L=s.length;D<L;D++){var H=s[D];if(H&&H.style){(H.clickable||H.hoverable)&&H.intersectionShape===void 0&&(H.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),V={line:void 0,cross:void 0,stick:void 0,sphere:void 0};for(z in V)H.style[z]?H.style[z].opacity?V[z]=parseFloat(H.style[z].opacity):V[z]=1:V[z]=void 0,O[z]?V[z]!=null&&O[z]!=V[z]&&(console.log("Warning: "+z+" opacity is ambiguous"),O[z]=1):O[z]=V[z];h.call(this,H,C),this.drawAtomClickSphere(H),this.drawAtomCross(H,l),this.drawBondLines(H,s,T),this.drawBondSticks(H,s,E),typeof H.style.cartoon<"u"&&!H.style.cartoon.hidden&&(H.style.cartoon.color==="spectrum"&&typeof H.resi=="number"&&!H.hetflag&&(H.resi<W[0]&&(W[0]=H.resi),H.resi>W[1]&&(W[1]=H.resi)),x.push(H))}}if(x.length>0&&(0,y.drawCartoon)(w,x,W,this.defaultCartoonQuality),C&&C.vertices>0){C.initTypedArrays();var q=null,U=null;C.imposter?q=new u.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):C.instanced?(U=new u.Geometry(!0),p.GLDraw.drawSphere(U,{x:0,y:0,z:0},1,new b.Color(.5,.5,.5)),U.initTypedArrays(),q=new u.InstancedMaterial({sphereMaterial:new u.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:U})):q=new u.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),O.sphere<1&&O.sphere>=0&&(q.transparent=!0,q.opacity=O.sphere),U=new u.Mesh(C,q),w.add(U)}if(E.vertices>0){var B=null,Y=null,X=E.sphereGeometry;(!X||typeof X.vertices>"u"||X.vertices==0)&&(X=null),E.initTypedArrays(),X&&X.initTypedArrays();var j={ambient:0,vertexColors:!0,reflectivity:0};E.imposter?(B=new u.StickImposterMaterial(j),Y=new u.SphereImposterMaterial(j)):(B=new u.MeshLambertMaterial(j),Y=new u.MeshLambertMaterial(j),B.wireframe&&(E.setUpWireframe(),X&&X.setUpWireframe())),O.stick<1&&O.stick>=0&&(B.transparent=!0,B.opacity=O.stick,Y.transparent=!0,Y.opacity=O.stick);var J=new u.Mesh(E,B);if(w.add(J),X){var le=new u.Mesh(X,Y);w.add(le)}}var se;for(D in T)if(T.hasOwnProperty(D)){se=D;var he=new u.LineBasicMaterial({linewidth:se,vertexColors:!0});O.line<1&&O.line>=0&&(he.transparent=!0,he.opacity=O.line),T[D].initTypedArrays();var pe=new u.Line(T[D],he,u.LineStyle.LinePieces);w.add(pe)}for(D in l)if(l.hasOwnProperty(D)){se=D;var ve=new u.LineBasicMaterial({linewidth:se,vertexColors:!0});O.cross<1&&O.cross>=0&&(ve.transparent=!0,ve.opacity=O.cross),l[D].initTypedArrays();var ce=new u.Line(l[D],ve,u.LineStyle.LinePieces);w.add(ce)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var me=new u.Object3D,Re;for(Re=0;Re<this.modelData.symmetries.length;Re++){var Ge=new u.Object3D;Ge=w.clone(),Ge.matrix.copy(this.modelData.symmetries[Re]),Ge.matrixAutoUpdate=!1,me.add(Ge)}return me}return w}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(s){this.atoms=s.atoms,this.frames=s.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const s=this.modelData.cryst;this.modelData.cryst.matrix=(0,_.conversionMatrix3)(s.a,s.b,s.c,s.alpha,s.beta,s.gamma)}return this.modelData.cryst}else return null}setCrystData(s,c,w,x,T,l){s=s||1,c=c||1,w=w||1,x=x||90,T=T||90,l=l||90;const h=(0,_.conversionMatrix3)(s,c,w,x,T,l);this.modelData.cryst={a:s,b:c,c:w,alpha:x,beta:T,gamma:l,matrix:h}}setCrystMatrix(s){s=s||new _.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:s}}getSymmetries(){return typeof this.modelData.symmetries>"u"&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(s){typeof s>"u"?this.modelData.symmetries=[this.idMatrix]:this.modelData.symmetries=s}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(s,c,w,x){var T=c-s;return T<-w?c+x:T>w?c-x:c}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var s=this.box[0],c=this.box[1],w=this.box[2],x=s*.9,T=c*.9,l=w*.9,h=0;h<this.atomdfs.length;h++)for(var C=this.atomdfs[h],E=1;E<C.length;E++){var D=this.atoms[C[E][0]],z=this.atoms[C[E][1]];D.x=this.adjustCoord(z.x,D.x,x,s),D.y=this.adjustCoord(z.y,D.y,T,c),D.z=this.adjustCoord(z.z,D.z,l,w)}}setFrame(s,c){var w=this.getNumFrames();let x=this;return new Promise(function(T,l){if(w==0&&T(),(s<0||s>=w)&&(s=w-1),x.frames.url!=null){var h=x.frames.url;(0,k.getbin)(h+"/traj/frame/"+s+"/"+x.frames.path,void 0,"POST",void 0).then(function(C){for(var E=new Float32Array(C,44),D=0,z=0;z<x.atoms.length;z++)x.atoms[z].x=E[D++],x.atoms[z].y=E[D++],x.atoms[z].z=E[D++];x.box&&x.atomdfs&&x.adjustCoordinatesToBox(),T()}).catch(l)}else x.atoms=x.frames[s],T();x.molObj=null,x.modelDatas&&s<x.modelDatas.length&&(x.modelData=x.modelDatas[s],x.unitCellObjects&&c&&(c.removeUnitCell(x),c.addUnitCell(x)))})}addFrame(s){this.frames.push(s)}vibrate(s=10,c=1,w=!1,x,T){var l=0,h=s;w&&(l=-s,h=s),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),l<h&&(this.frames=[]),w&&(this.frames.origIndex=s);for(var C=l;C<h;C++){var E=[],D=this.frames.length;if(C==0&&!T){this.frames.push(this.atoms);continue}for(var z=0;z<this.atoms.length;z++){var L=(0,k.getAtomProperty)(this.atoms[z],"dx"),V=(0,k.getAtomProperty)(this.atoms[z],"dy"),O=(0,k.getAtomProperty)(this.atoms[z],"dz"),W=new _.Vector3(L,V,O),H=new _.Vector3(this.atoms[z].x,this.atoms[z].y,this.atoms[z].z),q=C*c/s;W.multiplyScalar(q),H.add(W);var U={};for(var B in this.atoms[z])U[B]=this.atoms[z][B];if(U.x=H.x,U.y=H.y,U.z=H.z,E.push(U),x&&T){var Y=(0,k.extend)({},T),X=new _.Vector3(L,V,O);if(X.multiplyScalar(c),X.add(H),Y.start=H,Y.end=X,Y.frame=D,!Y.color){var j=U.style.sphere;j||(j=U.style.stick),j||(j=U.style.line),Y.color=(0,k.getColorFromStyle)(U,j)}x.addArrow(Y)}}this.frames.push(E)}}setAtomDefaults(s){for(let c=0;c<s.length;c++){let w=s[c];w&&(w.style=w.style||(0,k.deepCopy)(S.defaultAtomStyle),w.color=w.color||this.ElementColors[w.elem]||this.defaultColor,w.model=this.id,(w.clickable||w.hoverable)&&(w.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(s,c,w={}){var x=S.parseMolData(s,c,w);this.dontDuplicateAtoms=!w.duplicateAssemblyAtoms;var T=x.modelData;if(T&&(Array.isArray(T)?(this.modelData=T[0],w.frames&&(this.modelDatas=T)):this.modelData=T),x.box?this.box=x.box:this.box=null,this.frames.length==0){for(let h=0;h<x.length;h++)x[h].length!=0&&this.frames.push(x[h]);this.frames[0]&&(this.atoms=this.frames[0])}else if(w.frames)for(let h=0;h<x.length;h++)this.frames.push(x[h]);else for(var l=0;l<x.length;l++)this.addAtoms(x[l]);for(let h=0;h<this.frames.length;h++)this.setAtomDefaults(this.frames[h]);w.vibrate&&w.vibrate.frames&&w.vibrate.amplitude&&this.vibrate(w.vibrate.frames,w.vibrate.amplitude),w.style&&this.setStyle({},w.style)}setDontDuplicateAtoms(s){this.dontDuplicateAtoms=s}setModelData(s){this.modelData=s}propertyMatches(s,c){if(s==c)return!0;if(typeof c=="string"&&typeof s=="number"){var w=c.match(/(-?\d+)\s*-\s*(-?\d+)/);if(w){var x=parseInt(w[1]),T=parseInt(w[2]);if(w&&s>=x&&s<=T)return!0}}return!1}static deepCopyAndCache(s,c){if(typeof s!="object"||s==null||s.__cache_created)return s;const w={};for(const x in s){const T=s[x];if(Array.isArray(T)){w[x]=[];for(let l=0;l<T.length;l++)w[x].push(S.deepCopyAndCache(T[l],c))}else typeof T=="object"&&x!="properties"&&x!="model"?w[x]=S.deepCopyAndCache(T,c):w[x]=T;if(x=="and"||x=="or"){const l=[];for(const h of w[x]){const C=new Set;for(const E of c.selectedAtoms(h))C.add(E.index);l.push(C)}if(x=="and"){const h=function(E,D){const z=new Set;for(const L of D)E.has(L)&&z.add(L);return z};let C=new Set(l[0]);for(const E of l.splice(1))C=h(C,E);w[x].__cached_results=C}else if(x=="or"){const h=new Set;for(const C of l)for(const E of C)h.add(E);w[x].__cached_results=h}}}return w.__cache_created=!0,w}atomIsSelected(s,c){if(typeof c>"u")return!0;var w=!!c.invert,x=!0;for(var T in c)if(T=="and"||T=="or"||T=="not"){if(T=="not"){if(this.atomIsSelected(s,c[T])){x=!1;break}}else if(c[T].__cached_results===void 0&&(c=S.deepCopyAndCache(c,this)),x=c[T].__cached_results.has(s.index),!x)break}else if(T==="predicate"){if(!c.predicate(s)){x=!1;break}}else if(T=="properties"&&s[T]){for(var l in c.properties)if(!l.startsWith("__cache")){if(typeof s.properties[l]>"u"){x=!1;break}if(s.properties[l]!=c.properties[l]){x=!1;break}}}else if(c.hasOwnProperty(T)&&!S.ignoredKeys.has(T)&&!T.startsWith("__cache")){if(typeof s[T]>"u"){x=!1;break}var h=!1;if(T==="bonds"){var C=c[T];if(C!=s.bonds.length){x=!1;break}}else if(Array.isArray(c[T])){var E=c[T],D=s[T];for(let z=0;z<E.length;z++)if(this.propertyMatches(D,E[z])){h=!0;break}if(!h){x=!1;break}}else{let z=c[T];if(!this.propertyMatches(s[T],z)){x=!1;break}}}return w?!x:x}static squaredDistance(s,c){var w=c.x-s.x,x=c.y-s.y,T=c.z-s.z;return w*w+x*x+T*T}expandAtomList(s,c){if(c<=0)return s;for(var w=(0,k.getExtent)(s,void 0),x=[[],[],[]],T=0;T<3;T++)x[0][T]=w[0][T]-c,x[1][T]=w[1][T]+c,x[2][T]=w[2][T];var l=[];for(let D=0;D<this.atoms.length;D++){var h=this.atoms[D].x,C=this.atoms[D].y,E=this.atoms[D].z;h>=x[0][0]&&h<=x[1][0]&&C>=x[0][1]&&C<=x[1][1]&&E>=x[0][2]&&E<=x[1][2]&&(h>=w[0][0]&&h<=w[1][0]&&C>=w[0][1]&&C<=w[1][1]&&E>=w[0][2]&&E<=w[1][2]||l.push(this.atoms[D]))}return l}static getFloat(s){return typeof s=="number"?s:parseFloat(s)}selectedAtoms(s,c){var w=[];s=S.deepCopyAndCache(s||{},this),c||(c=this.atoms);for(var x=c.length,T=0;T<x;T++){var l=c[T];l&&this.atomIsSelected(l,s)&&w.push(l)}if(s.hasOwnProperty("expand")){const U=S.getFloat(s.expand);let B=this.expandAtomList(w,U),Y=w.length;const X=U*U;for(let j=0;j<B.length;j++)for(let J=0;J<Y;J++){var h=S.squaredDistance(B[j],w[J]);h<X&&h>0&&w.push(B[j])}}if(s.hasOwnProperty("within")&&s.within.hasOwnProperty("sel")&&s.within.hasOwnProperty("distance")){var C=this.selectedAtoms(s.within.sel,this.atoms),E={};const U=S.getFloat(s.within.distance),B=U*U;for(let Y=0;Y<C.length;Y++)for(let X=0;X<w.length;X++){let j=S.squaredDistance(C[Y],w[X]);j<B&&j>0&&(E[X]=1)}var D=[];if(s.within.invert)for(let Y=0;Y<w.length;Y++)E[Y]||D.push(w[Y]);else for(let Y in E)D.push(w[Y]);w=D}if(s.hasOwnProperty("byres")){var z={},L=[],V=[];for(let U=0;U<w.length;U++){let B=w[U];var O=B.chain,W=B.resi;if(z[O]===void 0&&(z[O]={}),B.hasOwnProperty("resi")&&z[O][W]===void 0){for(z[O][W]=!0,V.push(B);V.length>0;)if(B=V.pop(),O=B.chain,W=B.resi,L[B.index]===void 0){L[B.index]=!0;for(var H=0;H<B.bonds.length;H++){var q=this.atoms[B.bonds[H]];L[q.index]===void 0&&q.hasOwnProperty("resi")&&q.chain==O&&q.resi==W&&(V.push(q),w.push(q))}}}}}return w}addAtoms(s){this.molObj=null;var c=this.atoms.length,w=[],x;for(x=0;x<s.length;x++)typeof s[x].index>"u"&&(s[x].index=x),typeof s[x].serial>"u"&&(s[x].serial=x),w[s[x].index]=c+x;for(x=0;x<s.length;x++){var T=s[x],l=w[T.index],h=(0,k.extend)({},T);h.index=l,h.bonds=[],h.bondOrder=[],h.model=this.id,h.style=h.style||(0,k.deepCopy)(S.defaultAtomStyle),typeof h.color>"u"&&(h.color=this.ElementColors[h.elem]||this.defaultColor);for(var C=T.bonds?T.bonds.length:0,E=0;E<C;E++){var D=w[T.bonds[E]];typeof D<"u"&&(h.bonds.push(D),h.bondOrder.push(T.bondOrder?T.bondOrder[E]:1))}this.atoms.push(h)}}assignBonds(){(0,R.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(s){this.molObj=null;var c=[],w;for(w=0;w<s.length;w++)c[s[w].index]=!0;var x=[];for(w=0;w<this.atoms.length;w++){var T=this.atoms[w];c[T.index]||x.push(T)}this.atoms=[],this.addAtoms(x)}setStyle(s,c,w){typeof c>"u"&&typeof w>"u"&&(c=s,s={}),s=s,typeof c=="string"&&(c=(0,k.specStringToObject)(c));var x=!1,T=this,l=function(C){var E=T.selectedAtoms(s,C);for(let D=0;D<C.length;D++)C[D]&&(C[D].capDrawn=!1);for(let D=0;D<E.length;D++){x=!0,(E[D].clickable||E[D].hoverable)&&(E[D].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),w||(E[D].style={});for(let z in c)c.hasOwnProperty(z)&&(E[D].style[z]=E[D].style[z]||{},Object.assign(E[D].style[z],c[z]))}};if(s.frame!==void 0&&s.frame<this.frames.length){let C=s.frame;C<0&&(C=this.frames.length+C),l(this.frames[C])}else{l(this.atoms);for(var h=0;h<this.frames.length;h++)this.frames[h]!==this.atoms&&l(this.frames[h])}x&&(this.molObj=null)}setClickable(s,c,w){if(c=!!c,w=(0,k.makeFunction)(w),w===null){console.log("Callback is not a function");return}var x=this.selectedAtoms(s,this.atoms),T=x.length;for(let l=0;l<T;l++)x[l].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},x[l].clickable=c,w&&(x[l].callback=w);T>0&&(this.molObj=null)}setHoverable(s,c,w,x){if(c=!!c,w=(0,k.makeFunction)(w),x=(0,k.makeFunction)(x),w===null){console.log("Hover_callback is not a function");return}if(x===null){console.log("Unhover_callback is not a function");return}var T=this.selectedAtoms(s,this.atoms),l=T.length;for(let h=0;h<l;h++)T[h].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},T[h].hoverable=c,w&&(T[h].hover_callback=w),x&&(T[h].unhover_callback=x);l>0&&(this.molObj=null)}enableContextMenu(s,c){c=!!c;var w,x=this.selectedAtoms(s,this.atoms),T=x.length;for(w=0;w<T;w++)x[w].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},x[w].contextMenuEnabled=c;T>0&&(this.molObj=null)}setColorByElement(s,c){if(!(this.molObj!==null&&S.sameObj(c,this.lastColors))){this.lastColors=c;var w=this.selectedAtoms(s,w);w.length>0&&(this.molObj=null);for(var x=0;x<w.length;x++){var T=w[x];typeof c[T.elem]<"u"&&(T.color=c[T.elem])}}}setColorByProperty(s,c,w,x){var T,l,h=this.selectedAtoms(s,h);for(this.lastColors=null,h.length>0&&(this.molObj=null),typeof w=="string"&&typeof g.Gradient.builtinGradients[w]<"u"&&(w=new g.Gradient.builtinGradients[w]),w=w,x||(x=w.range()),x||(x=(0,k.getPropertyRange)(h,c)),T=0;T<h.length;T++){l=h[T];var C=(0,k.getAtomProperty)(l,c);C!=null&&(l.color=w.valueToHex(parseFloat(l.properties[c]),x))}}setColorByFunction(s,c){var w=this.selectedAtoms(s,w);if(typeof c=="function"){this.lastColors=null,w.length>0&&(this.molObj=null);for(let x=0;x<w.length;x++){let T=w[x];T.color=c(T)}}}toCDObject(s=!1){var c={a:[],b:[]};s&&(c.s=[]);for(let x=0;x<this.atoms.length;x++){let T={},l=this.atoms[x];if(T.x=l.x,T.y=l.y,T.z=l.z,l.elem!="C"&&(T.l=l.elem),s){for(var w=0;w<c.s.length&&JSON.stringify(l.style)!==JSON.stringify(c.s[w]);)w++;w===c.s.length&&c.s.push(l.style),w!==0&&(T.s=w)}c.a.push(T);for(let h=0;h<l.bonds.length;h++){let C=x,E=l.bonds[h];if(C>=E)continue;let D={b:C,e:E},z=l.bondOrder[h];z!=1&&(D.o=z),c.b.push(D)}}return c}globj(s,c){(this.molObj===null||c.regen)&&(this.molObj=this.createMolObj(this.atoms,c),this.renderedMolObj&&(s.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),s.add(this.renderedMolObj))}exportVRML(){var s=this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1});return s.vrml()}removegl(s){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),s.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(s,c,w,x){for(var T=this.selectedAtoms(c,T),l=(0,k.deepCopy)(x),h=0;h<T.length;h++){var C=T[h],E=null;typeof C[s]<"u"?E=String(C[s]):typeof C.properties[s]<"u"&&(E=String(C.properties[s])),E!=null&&(l.position=C,w.addLabel(E,l))}}addResLabels(s,c,w,x=!1){var T=[],l=function(C,E){for(var D=C.selectedAtoms(s,D),z={},L=0;L<D.length;L++){var V=D[L],O=V.chain,W=V.resn,H=V.resi,q=W+""+H;z[O]||(z[O]={}),z[O][q]||(z[O][q]=[]),z[O][q].push(V)}var U=(0,k.deepCopy)(w);for(let Y in z)if(z.hasOwnProperty(Y)){var B=z[Y];for(let X in B)if(B.hasOwnProperty(X)){let j=B[X],J=new _.Vector3(0,0,0);for(let se=0;se<j.length;se++){let he=j[se];J.x+=he.x,J.y+=he.y,J.z+=he.z}J.divideScalar(j.length),U.position=J,U.frame=E;let le=c.addLabel(X,U,void 0,!0);T.push(le)}}};if(x){var h=this.getNumFrames();let C=this.atoms;for(let E=0;E<h;E++)this.frames[E]&&(this.atoms=this.frames[E],l(this,E));this.atoms=C}else l(this);return T}setupDFS(){this.atomdfs=[];var s=this,c=new Int8Array(this.atoms.length);c.fill(0);for(var w=function(h,C,E){E.push([h,C]);var D=s.atoms[h];c[h]=1;for(var z=0;z<D.bonds.length;z++){var L=D.bonds[z];s.atoms[L]&&!c[L]&&w(L,h,E)}},x=0;x<this.atoms.length;x++){var T=this.atoms[x];if(T&&!c[x]){var l=[];w(x,-1,l),this.atomdfs.push(l)}}}setCoordinatesFromURL(s,c){this.frames=[];var w=this;return this.box&&this.setupDFS(),s.startsWith("http")||(s="http://"+s),(0,k.get)(s+"/traj/numframes/"+c,function(x){if(!isNaN(parseInt(x)))return w.frames.push(w.atoms),w.frames.numFrames=x,w.frames.url=s,w.frames.path=c,w.setFrame(0)})}setCoordinates(s,c){if(c=c||"",!s)return[];if(/\.gz$/.test(c)){c=c.replace(/\.gz$/,"");try{s=(0,k.inflateString)(s)}catch(z){console.log(z)}}var w={mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""};if(w.hasOwnProperty(c)){this.frames=[];for(var x=this.atoms.length,T=S.parseCrd(s,c),l=0;l<T.length;){for(var h=[],C=0;C<x;C++){var E={};for(var D in this.atoms[C])E[D]=this.atoms[C][D];h[C]=E,h[C].x=T[l++],h[C].y=T[l++],h[C].z=T[l++]}this.frames.push(h)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(s){}static parseCrd(s,c){var w=[],x=0;if(c=="pdb")for(var T=s.indexOf(`
ATOM`);T!=-1;){for(;s.slice(T,T+5)==`
ATOM`||s.slice(T,T+7)==`
HETATM`;)w[x++]=parseFloat(s.slice(T+31,T+39)),w[x++]=parseFloat(s.slice(T+39,T+47)),w[x++]=parseFloat(s.slice(T+47,T+55)),T=s.indexOf(`
`,T+54),s.slice(T,T+4)==`
TER`&&(T=s.indexOf(`
`,T+5));T=s.indexOf(`
ATOM`,T)}else if(c=="netcdf"){var l=new P.NetCDFReader(s);w=[].concat.apply([],l.getDataVariable("coordinates"))}else{if(c=="array"||Array.isArray(s))return s.flat(2);{let h=s.indexOf(`
`);c=="inpcrd"&&(h=s.indexOf(`
`,h+1)),s=s.slice(h+1),w=s.match(/\S+/g).map(parseFloat)}}return w}static parseMolData(s,c="",w){if(!s)return[];if(/\.gz$/.test(c)){c=c.replace(/\.gz$/,"");try{c.match(/bcif/i)?s=(0,k.inflateString)(s,!1):s=(0,k.inflateString)(s)}catch(l){console.log(l)}}typeof M.Parsers[c]>"u"&&(c=c.split(".").pop(),typeof M.Parsers[c]>"u"&&(console.log("Unknown format: "+c),s instanceof Uint8Array?c="bcif":s.match(/^@<TRIPOS>MOLECULE/gm)?c="mol2":s.match(/^data_/gm)&&s.match(/^loop_/gm)?c="cif":s.match(/^HETATM/gm)||s.match(/^ATOM/gm)?c="pdb":s.match(/ITEM: TIMESTEP/gm)?c="lammpstrj":s.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?c="sdf":s.match(/^%VERSION\s+VERSION_STAMP/gm)?c="prmtop":c="xyz",console.log("Best guess: "+c)));var x=M.Parsers[c],T=x(s,w);return T}}S.defaultAtomStyle={line:{}},S.defaultlineWidth=1,S.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},S.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"])}),"./src/GLShape.ts":((n,t,r)=>{r.r(t),r.d(t,{GLShape:()=>P,splitMesh:()=>R});var u=r("./src/WebGL/index.ts"),v=r("./src/WebGL/shapes/index.ts"),_=r("./src/WebGL/math/index.ts"),b=r("./src/colors.ts"),p=r("./src/ProteinSurface4.ts"),y=r("./src/VolumeData.ts"),k=r("./src/GLDraw.ts"),g=r("./src/glcartoon.ts"),M=r("./src/utilities.ts");class P{static finalizeGeo(a){var s=a.updateGeoGroup(0);s.vertices>0&&s.truncateArrayBuffers(!0,!0)}static updateColor(a,s){s=s||b.CC.color(s),a.colorsNeedUpdate=!0;var c,w,x;s.constructor!==Array&&(c=s.r,w=s.g,x=s.b);for(let T in a.geometryGroups){let l=a.geometryGroups[T],h=l.colorArray;for(let C=0,E=l.vertices;C<E;++C){if(s.constructor===Array){let D=s[C];c=D.r,w=D.g,x=D.b}h[C*3]=c,h[C*3+1]=w,h[C*3+2]=x}}}static drawArrow(a,s,c){var w=c.start,x=c.end,T=c.radius,l=c.radiusRatio,h=c.mid,C=c.midpos;if(!(w&&x))return;var E=s.updateGeoGroup(51),D=new _.Vector3(x.x,x.y,x.z).sub(w);if(C){let ye=D.length();C>0?h=C/ye:h=(ye+C)/ye}D.multiplyScalar(h);var z=new _.Vector3(w.x,w.y,w.z).add(D),L=D.clone().negate();let V=new _.Vector3(w.x,w.y,w.z);a.intersectionShape.cylinder.push(new v.Cylinder(V,z.clone(),T)),a.intersectionShape.sphere.push(new v.Sphere(V,T));var O=[];O[0]=D.clone(),Math.abs(O[0].x)>1e-4?O[0].y+=1:O[0].x+=1,O[0].cross(D),O[0].normalize(),O[4]=O[0].clone(),O[4].crossVectors(O[0],D),O[4].normalize(),O[8]=O[0].clone().negate(),O[12]=O[4].clone().negate(),O[2]=O[0].clone().add(O[4]).normalize(),O[6]=O[4].clone().add(O[8]).normalize(),O[10]=O[8].clone().add(O[12]).normalize(),O[14]=O[12].clone().add(O[0]).normalize(),O[1]=O[0].clone().add(O[2]).normalize(),O[3]=O[2].clone().add(O[4]).normalize(),O[5]=O[4].clone().add(O[6]).normalize(),O[7]=O[6].clone().add(O[8]).normalize(),O[9]=O[8].clone().add(O[10]).normalize(),O[11]=O[10].clone().add(O[12]).normalize(),O[13]=O[12].clone().add(O[14]).normalize(),O[15]=O[14].clone().add(O[0]).normalize();var W=E.vertices,H=E.vertexArray,q=E.faceArray,U=E.normalArray,B=E.lineArray,Y,X,j;for(X=0,j=O.length;X<j;++X){Y=3*(W+3*X);var J=O[X].clone().multiplyScalar(T).add(w),le=O[X].clone().multiplyScalar(T).add(z),se=O[X].clone().multiplyScalar(T*l).add(z);if(H[Y]=J.x,H[Y+1]=J.y,H[Y+2]=J.z,H[Y+3]=le.x,H[Y+4]=le.y,H[Y+5]=le.z,H[Y+6]=se.x,H[Y+7]=se.y,H[Y+8]=se.z,X>0){var he=H[Y-3],pe=H[Y-2],ve=H[Y-1],ce=new _.Vector3(he,pe,ve),me=new _.Vector3(x.x,x.y,x.z),Re=z.clone(),Ge=new _.Vector3(se.x,se.y,se.z);a.intersectionShape.triangle.push(new v.Triangle(Ge,me,ce)),a.intersectionShape.triangle.push(new v.Triangle(ce.clone(),Re,Ge.clone()))}}E.vertices+=48,Y=E.vertices*3,H[Y]=w.x,H[Y+1]=w.y,H[Y+2]=w.z,H[Y+3]=z.x,H[Y+4]=z.y,H[Y+5]=z.z,H[Y+6]=x.x,H[Y+7]=x.y,H[Y+8]=x.z,E.vertices+=3;var We,Oe,fe,De,qe,Qe,st,ot,Ke,Je,Xe,je,Ue,ft,ut,ee,ie,oe,we,Se=E.vertices-3,He=E.vertices-2,Be=E.vertices-1,K=Se*3,_e=He*3,Me=Be*3;for(X=0,j=O.length-1;X<j;++X){var $e=W+3*X;Y=$e*3,Oe=E.faceidx,fe=E.lineidx,De=$e,Je=De*3,qe=$e+1,Xe=qe*3,Qe=$e+2,je=Qe*3,st=$e+4,Ue=st*3,ot=$e+5,ft=ot*3,Ke=$e+3,ut=Ke*3,ee=ie=O[X],oe=we=O[X+1],U[Je]=ee.x,U[Xe]=ie.x,U[ut]=we.x,U[Je+1]=ee.y,U[Xe+1]=ie.y,U[ut+1]=we.y,U[Je+2]=ee.z,U[Xe+2]=ie.z,U[ut+2]=we.z,U[Xe]=ie.x,U[Ue]=oe.x,U[ut]=we.x,U[Xe+1]=ie.y,U[Ue+1]=oe.y,U[ut+1]=we.y,U[Xe+2]=ie.z,U[Ue+2]=oe.z,U[ut+2]=we.z,U[je]=ie.x,U[ft]=oe.x,U[je+1]=ie.y,U[ft+1]=oe.y,U[je+2]=ie.z,U[ft+2]=oe.z,q[Oe]=De,q[Oe+1]=qe,q[Oe+2]=Ke,q[Oe+3]=qe,q[Oe+4]=st,q[Oe+5]=Ke,q[Oe+6]=De,q[Oe+7]=Ke,q[Oe+8]=Se,q[Oe+9]=Qe,q[Oe+10]=He,q[Oe+11]=ot,q[Oe+12]=Qe,q[Oe+13]=Be,q[Oe+14]=ot,B[fe]=De,B[fe+1]=qe,B[fe+2]=De,B[fe+3]=Ke,B[fe+4]=st,B[fe+5]=Ke,B[fe+6]=De,B[fe+7]=Ke,B[fe+8]=Qe,B[fe+9]=qe,B[fe+10]=Qe,B[fe+11]=ot,B[fe+12]=st,B[fe+13]=ot,B[fe+14]=Qe,B[fe+15]=Be,B[fe+16]=Qe,B[fe+17]=ot,B[fe+18]=Be,B[fe+19]=ot,E.faceidx+=15,E.lineidx+=20}We=[W+45,W+46,W+1,W,W+47,W+2],Oe=E.faceidx,fe=E.lineidx,De=We[0],Je=De*3,qe=We[1],Xe=qe*3,Qe=We[4],je=Qe*3,st=We[2],Ue=st*3,ot=We[5],ft=ot*3,Ke=We[3],ut=Ke*3,ee=ie=O[15],oe=we=O[0],U[Je]=ee.x,U[Xe]=ie.x,U[ut]=we.x,U[Je+1]=ee.y,U[Xe+1]=ie.y,U[ut+1]=we.y,U[Je+2]=ee.z,U[Xe+2]=ie.z,U[ut+2]=we.z,U[Xe]=ie.x,U[Ue]=oe.x,U[ut]=we.x,U[Xe+1]=ie.y,U[Ue+1]=oe.y,U[ut+1]=we.y,U[Xe+2]=ie.z,U[Ue+2]=oe.z,U[ut+2]=we.z,U[je]=ie.x,U[ft]=oe.x,U[je+1]=ie.y,U[ft+1]=oe.y,U[je+2]=ie.z,U[ft+2]=oe.z,D.normalize(),L.normalize(),U[K]=L.x,U[_e]=U[Me]=D.x,U[K+1]=L.y,U[_e+1]=U[Me+1]=D.y,U[K+2]=L.z,U[_e+2]=U[Me+2]=D.z,q[Oe]=De,q[Oe+1]=qe,q[Oe+2]=Ke,q[Oe+3]=qe,q[Oe+4]=st,q[Oe+5]=Ke,q[Oe+6]=De,q[Oe+7]=Ke,q[Oe+8]=Se,q[Oe+9]=Qe,q[Oe+10]=He,q[Oe+11]=ot,q[Oe+12]=Qe,q[Oe+13]=Be,q[Oe+14]=ot,B[fe]=De,B[fe+1]=qe,B[fe+2]=De,B[fe+3]=Ke,B[fe+4]=st,B[fe+5]=Ke,B[fe+6]=De,B[fe+7]=Ke,B[fe+8]=Qe,B[fe+9]=qe,B[fe+10]=Qe,B[fe+11]=ot,B[fe+12]=st,B[fe+13]=ot,B[fe+14]=Qe,B[fe+15]=Be,B[fe+16]=Qe,B[fe+17]=ot,B[fe+18]=Be,B[fe+19]=ot,E.faceidx+=15,E.lineidx+=20}static updateBoundingFromPoints(a,s,c,w){a.center.set(0,0,0);let x=1/0,T=1/0,l=1/0,h=-1/0,C=-1/0,E=-1/0;a.box&&(x=a.box.min.x,h=a.box.max.x,T=a.box.min.y,C=a.box.max.y,l=a.box.min.z,E=a.box.max.z);for(let V=0,O=w;V<O;V++){var D=c[V*3],z=c[V*3+1],L=c[V*3+2];D<x&&(x=D),z<T&&(T=z),L<l&&(l=L),D>h&&(h=D),z>C&&(C=z),L>E&&(E=L)}a.center.set((h+x)/2,(C+T)/2,(E+l)/2),a.radius=a.center.distanceTo({x:h,y:C,z:E}),a.box={min:{x,y:T,z:l},max:{x:h,y:C,z:E}}}static addCustomGeo(a,s,c,w,x){var T=s.addGeoGroup(),l=c.vertexArr,h=c.normalArr,C=c.faceArr;T.vertices=l.length,T.faceidx=C.length;var E,D,z,L,V,O,W,H,q,U=T.vertexArray,B=T.colorArray;for(w.constructor!==Array&&(H=w.r,q=w.g,L=w.b),O=0,W=T.vertices;O<W;++O)E=O*3,D=l[O],U[E]=D.x,U[E+1]=D.y,U[E+2]=D.z,w.constructor===Array&&(V=w[O],H=V.r,q=V.g,L=V.b),B[E]=H,B[E+1]=q,B[E+2]=L;if(x)for(O=0,W=T.faceidx/3;O<W;++O){E=O*3,z=C[E],L=C[E+1],V=C[E+2];var Y=new _.Vector3,X=new _.Vector3,j=new _.Vector3;a.intersectionShape.triangle.push(new v.Triangle(Y.copy(l[z]),X.copy(l[L]),j.copy(l[V])))}if(x){var J=new _.Vector3(0,0,0),le=0;for(let pe=0;pe<s.geometryGroups.length;pe++)J.add(s.geometryGroups[pe].getCentroid()),le++;J.divideScalar(le),P.updateBoundingFromPoints(a.boundingSphere,{centroid:J},U,T.vertices)}if(T.faceArray=new Uint16Array(C),T.truncateArrayBuffers(!0,!0),h.length<T.vertices)T.setNormals();else{var se=T.normalArray=new Float32Array(T.vertices*3),he;for(O=0,W=T.vertices;O<W;++O)E=O*3,he=h[O],se[E]=he.x,se[E+1]=he.y,se[E+2]=he.z}T.setLineIndices(),T.lineidx=T.lineArray.length}static updateFromStyle(a,s){typeof s.color<"u"?(a.color=s.color||new b.Color,s.color instanceof b.Color||(a.color=b.CC.color(s.color))):a.color=b.CC.color(0),a.wireframe=!!s.wireframe,a.opacity=s.alpha?(0,_.clamp)(s.alpha,0,1):1,typeof s.opacity<"u"&&(a.opacity=(0,_.clamp)(s.opacity,0,1)),a.side=s.side!==void 0?s.side:u.DoubleSide,a.linewidth=typeof s.linewidth>"u"?1:s.linewidth,a.clickable=!!s.clickable,a.callback=(0,M.makeFunction)(s.callback),a.hoverable=!!s.hoverable,a.hover_callback=(0,M.makeFunction)(s.hover_callback),a.unhover_callback=(0,M.makeFunction)(s.unhover_callback),a.contextMenuEnabled=!!s.contextMenuEnabled,a.hidden=s.hidden,a.frame=s.frame}constructor(a){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=u.DoubleSide,this.stylespec=a||{},this.boundingSphere=new v.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},P.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new u.Geometry(!0),this.linegeo=new u.Geometry(!0)}updateStyle(a){for(var s in a)this.stylespec[s]=a[s];if(P.updateFromStyle(this,this.stylespec),a.voldata&&a.volscheme){(0,M.adjustVolumeStyle)(a);const c=a.volscheme,w=a.voldata,x=b.CC,T=c.range()||[-1,1];this.geo.setColors(function(l,h,C){let E=w.getVal(l,h,C);return x.color(c.valueToHex(E,T))}),delete this.color}}addCustom(a){a.vertexArr=a.vertexArr||[],a.faceArr=a.faceArr||[],a.normalArr=a.normalArr||[],P.drawCustom(this,this.geo,a)}addSphere(a){a.center||(a.center=new _.Vector3(0,0,0)),a.radius=a.radius?(0,_.clamp)(a.radius,0,1/0):1.5,a.color=b.CC.color(a.color),this.intersectionShape.sphere.push(new v.Sphere(a.center,a.radius)),k.GLDraw.drawSphere(this.geo,a.center,a.radius,a.color,a.quality),this.components.push({centroid:new _.Vector3(a.center.x,a.center.y,a.center.z)});var s=this.geo.updateGeoGroup(0);P.updateBoundingFromPoints(this.boundingSphere,this.components,s.vertexArray,s.vertices)}addBox(a){var s=a.dimensions||{w:1,h:1,d:1},c;typeof s.w=="number"?c={x:s.w,y:0,z:0}:c=s.w;var w;typeof s.h=="number"?w={x:0,y:s.h,z:0}:w=s.h;var x;typeof s.d=="number"?x={x:0,y:0,z:s.d}:x=s.d;var T=a.corner;T==null&&(a.center!==void 0?T={x:a.center.x-.5*(c.x+w.x+x.x),y:a.center.y-.5*(c.y+w.y+x.y),z:a.center.z-.5*(c.z+w.z+x.z)}:T={x:0,y:0,z:0});var l=[{x:T.x,y:T.y,z:T.z},{x:T.x+c.x,y:T.y+c.y,z:T.z+c.z},{x:T.x+w.x,y:T.y+w.y,z:T.z+w.z},{x:T.x+c.x+w.x,y:T.y+c.y+w.y,z:T.z+c.z+w.z},{x:T.x+x.x,y:T.y+x.y,z:T.z+x.z},{x:T.x+c.x+x.x,y:T.y+c.y+x.y,z:T.z+c.z+x.z},{x:T.x+w.x+x.x,y:T.y+w.y+x.y,z:T.z+w.z+x.z},{x:T.x+c.x+w.x+x.x,y:T.y+c.y+w.y+x.y,z:T.z+c.z+w.z+x.z}],h=[],C=[];h.splice(h.length,0,l[0],l[1],l[2],l[3]),C.splice(C.length,0,0,2,1,1,2,3);var E=4;h.splice(h.length,0,l[2],l[3],l[6],l[7]),C.splice(C.length,0,E+0,E+2,E+1,E+1,E+2,E+3),E+=4,h.splice(h.length,0,l[4],l[5],l[0],l[1]),C.splice(C.length,0,E+0,E+2,E+1,E+1,E+2,E+3),E+=4,h.splice(h.length,0,l[6],l[7],l[4],l[5]),C.splice(C.length,0,E+0,E+2,E+1,E+1,E+2,E+3),E+=4,h.splice(h.length,0,l[3],l[1],l[7],l[5]),C.splice(C.length,0,E+0,E+2,E+1,E+1,E+2,E+3),E+=4,h.splice(h.length,0,l[2],l[6],l[0],l[4]),C.splice(C.length,0,E+0,E+2,E+1,E+1,E+2,E+3),E+=4;var D=(0,M.extend)({},a);D.vertexArr=h,D.faceArr=C,D.normalArr=[],P.drawCustom(this,this.geo,D);var z=new _.Vector3;this.components.push({centroid:z.addVectors(l[0],l[7]).multiplyScalar(.5)});var L=this.geo.updateGeoGroup(0);P.updateBoundingFromPoints(this.boundingSphere,this.components,L.vertexArray,L.vertices)}addCylinder(a){var s,c;a.start?s=new _.Vector3(a.start.x||0,a.start.y||0,a.start.z||0):s=new _.Vector3(0,0,0),a.end?(c=new _.Vector3(a.end.x,a.end.y||0,a.end.z||0),typeof c.x>"u"&&(c.x=3)):c=new _.Vector3(0,0,0);var w=a.radius||.1,x=b.CC.color(a.color);this.intersectionShape.cylinder.push(new v.Cylinder(s,c,w)),k.GLDraw.drawCylinder(this.geo,s,c,w,x,a.fromCap,a.toCap);var T=new _.Vector3;this.components.push({centroid:T.addVectors(s,c).multiplyScalar(.5)});var l=this.geo.updateGeoGroup(0);P.updateBoundingFromPoints(this.boundingSphere,this.components,l.vertexArray,l.vertices)}addDashedCylinder(a){a.dashLength=a.dashLength||.25,a.gapLength=a.gapLength||.25;var s;a.start?s=new _.Vector3(a.start.x||0,a.start.y||0,a.start.z||0):s=new _.Vector3(0,0,0);var c;a.end?(c=new _.Vector3(a.end.x,a.end.y||0,a.end.z||0),typeof c.x>"u"&&(c.x=3)):c=new _.Vector3(3,0,0);for(var w=a.radius||.1,x=b.CC.color(a.color),T=Math.sqrt(Math.pow(s.x-c.x,2)+Math.pow(s.y-c.y,2)+Math.pow(s.z-c.z,2)),l=T/(a.gapLength+a.dashLength),h=new _.Vector3(a.start.x||0,a.start.y||0,a.start.z||0),C=new _.Vector3(a.end.x,a.end.y||0,a.end.z||0),E=new _.Vector3((c.x-s.x)/(T/a.gapLength),(c.y-s.y)/(T/a.gapLength),(c.z-s.z)/(T/a.gapLength)),D=new _.Vector3((c.x-s.x)/(T/a.dashLength),(c.y-s.y)/(T/a.dashLength),(c.z-s.z)/(T/a.dashLength)),z=0;z<l;z++)C=new _.Vector3(h.x+D.x,h.y+D.y,h.z+D.z),this.intersectionShape.cylinder.push(new v.Cylinder(h,C,w)),k.GLDraw.drawCylinder(this.geo,h,C,w,x,a.fromCap,a.toCap),h=new _.Vector3(C.x+E.x,C.y+E.y,C.z+E.z);var L=new _.Vector3;this.components.push({centroid:L.addVectors(s,c).multiplyScalar(.5)});var V=this.geo.updateGeoGroup(0);P.updateBoundingFromPoints(this.boundingSphere,this.components,V.vertexArray,V.vertices)}addCurve(a){a.points=a.points||[],a.smooth=a.smooth||10,typeof a.fromCap>"u"&&(a.fromCap=2),typeof a.toCap>"u"&&(a.toCap=2);var s=(0,g.subdivide_spline)(a.points,a.smooth);if(s.length<3){console.log("Too few points in addCurve");return}var c=a.radius||.1,w=b.CC.color(a.color),x=0,T=s.length-1,l=s[0].distanceTo(s[1]),h=Math.ceil(2*c/l);if(a.toArrow){T-=h;let z={start:s[T],end:s[s.length-1],radius:c,color:w,mid:1e-4};this.addArrow(z)}if(a.fromArrow){x+=h;let z={start:s[x],end:s[0],radius:c,color:w,mid:1e-4};this.addArrow(z)}for(var C=Math.ceil(s.length/2),E={radius:c,color:w,fromCap:2,toCap:2},D=x;D<T;D++)E.start=s[D],E.end=s[D+1],E.fromCap=2,E.toCap=2,D<C?(E.fromCap=2,E.toCap=0):D>C?(E.fromCap=0,E.toCap=2):(E.fromCap=2,E.toCap=2),this.addCylinder(E)}addLine(a){var s,c;a.start?s=new _.Vector3(a.start.x||0,a.start.y||0,a.start.z||0):s=new _.Vector3(0,0,0),a.end?(c=new _.Vector3(a.end.x,a.end.y||0,a.end.z||0),typeof c.x>"u"&&(c.x=3)):c=new _.Vector3(3,0,0);var w=this.geo.updateGeoGroup(2),x=w.vertices,T=x*3,l=w.vertexArray;l[T]=s.x,l[T+1]=s.y,l[T+2]=s.z,l[T+3]=c.x,l[T+4]=c.y,l[T+5]=c.z,w.vertices+=2;var h=w.lineArray,C=w.lineidx;h[C]=x,h[C+1]=x+1,w.lineidx+=2;var E=new _.Vector3;this.components.push({centroid:E.addVectors(s,c).multiplyScalar(.5)}),w=this.geo.updateGeoGroup(0),P.updateBoundingFromPoints(this.boundingSphere,this.components,w.vertexArray,w.vertices)}addArrow(a){if(a.start?a.start=new _.Vector3(a.start.x||0,a.start.y||0,a.start.z||0):a.start=new _.Vector3(0,0,0),a.dir instanceof _.Vector3&&typeof a.length=="number"){var s=a.dir.clone().multiplyScalar(a.length).add(a.start);a.end=s}else a.end?(a.end=new _.Vector3(a.end.x,a.end.y||0,a.end.z||0),typeof a.end.x>"u"&&(a.end.x=3)):a.end=new _.Vector3(3,0,0);a.radius=a.radius||.1,a.radiusRatio=a.radiusRatio||1.618034,a.mid=0<a.mid&&a.mid<1?a.mid:.618034,P.drawArrow(this,this.geo,a);var c=new _.Vector3;this.components.push({centroid:c.addVectors(a.start,a.end).multiplyScalar(.5)});var w=this.geo.updateGeoGroup(0);P.updateBoundingFromPoints(this.boundingSphere,this.components,w.vertexArray,w.vertices)}static distance_from(a,s){return Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2)+Math.pow(a.z-s.z,2))}static inSelectedRegion(a,s,c){for(var w=0;w<s.length;w++)if(P.distance_from(s[w],a)<=c)return!0;return!1}addIsosurface(a,s,c,w){var x=s.isoval!==void 0&&typeof s.isoval=="number"?s.isoval:0,T=!!s.voxel,l=s.smoothness===void 0?1:s.smoothness,h=a.size.x,C=a.size.y,E=a.size.z,D=new Int16Array(h*C*E),z=a.data,L,V;for(L=0,V=D.length;L<V;++L)D[L]=-1;var O=new Uint8Array(h*C*E);for(L=0,V=z.length;L<V;++L){var W=x>=0?z[L]-x:x-z[L];W>0&&(O[L]|=P.ISDONE)}var H=[],q=[];p.MarchingCube.march(O,H,q,{fulltable:!0,voxel:T,unitCube:a.unit,origin:a.origin,matrix:a.matrix,nX:h,nY:C,nZ:E}),!T&&l>0&&p.MarchingCube.laplacianSmooth(l,H,q);var U=[],B=[],Y=[];if(s.selectedRegion&&s.coords===void 0&&(s.coords=s.selectedRegion),s.coords===void 0&&s.selection!==void 0&&(w?s.coords=w.selectedAtoms(s.selection):console.log("addIsosurface needs viewer is selection provided.")),s.coords!==void 0){var X=s.coords[0].x,j=s.coords[0].y,J=s.coords[0].z,le=s.coords[0].x,se=s.coords[0].y,he=s.coords[0].z;for(let fe=0;fe<s.coords.length;fe++)s.coords[fe].x>X?X=s.coords[fe].x:s.coords[fe].x<le&&(le=s.coords[fe].x),s.coords[fe].y>j?j=s.coords[fe].y:s.coords[fe].y<se&&(se=s.coords[fe].y),s.coords[fe].z>J?J=s.coords[fe].z:s.coords[fe].z<he&&(he=s.coords[fe].z);var pe=2;s.radius!==void 0&&(pe=s.radius),s.selectedOffset!==void 0&&(pe=s.selectedOffset),s.seldist!==void 0&&(pe=s.seldist),le-=pe,X+=pe,se-=pe,j+=pe,he-=pe,J+=pe;for(let fe=0;fe<H.length;fe++)H[fe].x>le&&H[fe].x<X&&H[fe].y>se&&H[fe].y<j&&H[fe].z>he&&H[fe].z<J&&P.inSelectedRegion(H[fe],s.coords,pe)?(U.push(B.length),B.push(H[fe])):U.push(-1);for(let fe=0;fe+2<q.length;fe+=3)U[q[fe]]!==-1&&U[q[fe+1]]!==-1&&U[q[fe+2]]!==-1&&(Y.push(q[fe]-(q[fe]-U[q[fe]])),Y.push(q[fe+1]-(q[fe+1]-U[q[fe+1]])),Y.push(q[fe+2]-(q[fe+2]-U[q[fe+2]])));H=B,q=Y}P.drawCustom(this,this.geo,{vertexArr:H,faceArr:q,normalArr:[],clickable:s.clickable,hoverable:s.hoverable}),this.updateStyle(s);var ve=new _.Vector3(a.origin.x,a.origin.y,a.origin.z),ce=new _.Vector3(a.size.x*a.unit.x,a.size.y*a.unit.y,a.size.z*a.unit.z),me=new _.Vector3(0,0,0),Re=ve.clone(),Ge=ve.clone().add(ce);for(let fe=0;fe<H.length;fe++)me.add(H[fe]),Re.max(H[fe]),Ge.min(H[fe]);me.divideScalar(H.length);var We=me.distanceTo(Ge),Oe=me.distanceTo(Re);this.boundingSphere.center=me,this.boundingSphere.radius=Math.max(We,Oe),typeof c=="function"&&c()}addVolumetricData(a,s,c){a=new y.VolumeData(a,s),this.addIsosurface(a,c)}finalize(){return P.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj(a){if(this.renderedShapeObj&&(a.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){P.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),typeof this.color<"u"&&P.updateColor(this.geo,this.color),this.shapeObj=new u.Object3D;var s=null;this.side==u.DoubleSide?s=new u.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:u.Coloring.VertexColors}):s=new u.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:u.Coloring.VertexColors});var c=new u.Mesh(this.geo,s);if(this.shapeObj.add(c),this.linegeo&&this.linegeo.vertices>0){var w=new u.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),x=new u.Line(this.linegeo,w,u.LineStyle.LinePieces);this.shapeObj.add(x)}this.renderedShapeObj=this.shapeObj.clone(),a.add(this.renderedShapeObj)}}removegl(a){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),a.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}P.ISDONE=2,P.drawCustom=function(S,a,s){var c=s,w=c.vertexArr,x=c.faceArr;(w.length===0||x.length===0)&&console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var T=s.color;typeof T>"u"&&(T=S.color),T=b.CC.color(T);for(var l=R(c),h=0,C=l.length;h<C;h++)P.addCustomGeo(S,a,l[h],l[h].colorArr?l[h].colorArr:T,s.clickable)};function R(S){var a=64e3;if(S.vertexArr.length<a)return[S];var s=[{vertexArr:[],normalArr:[],faceArr:[]}];S.colorArr&&(s.colorArr=[]);var c=[],w=[],x=0,T=S.faceArr;for(let h=0,C=T.length;h<C;h+=3){let E=s[x];for(let D=0;D<3;D++){var l=T[h+D];c[l]!==x&&(c[l]=x,w[l]=E.vertexArr.length,E.vertexArr.push(S.vertexArr[l]),S.normalArr&&S.normalArr[l]&&E.normalArr.push(S.normalArr[l]),S.colorArr&&S.colorArr[l]&&E.colorArr.push(S.colorArr[l])),E.faceArr.push(w[l])}E.vertexArr.length>=a&&(s.push({vertexArr:[],normalArr:[],faceArr:[]}),S.colorArr&&(s.colorArr=[]),x++)}return s}}),"./src/GLViewer.ts":((n,t,r)=>{r.r(t),r.d(t,{CONTEXTS_PER_VIEWPORT:()=>a,GLViewer:()=>s,createStereoViewer:()=>x,createViewer:()=>c,createViewerGrid:()=>w});var u=r("./src/WebGL/index.ts"),v=r("./src/WebGL/math/index.ts"),_=r("./src/colors.ts"),b=r("./src/utilities.ts"),p=r("./src/Gradient.ts"),y=r("./src/GLModel.ts"),k=r("./src/Label.ts"),g=r("./src/GLShape.ts"),M=r("./src/VolumeData.ts"),P=r("./src/ProteinSurface4.ts"),R=r("./src/VolumetricRender.ts"),S=r("./node_modules/upng-js/UPNG.js");const a=16;class s{getWidth(){let l=this.container,h=l.offsetWidth;if(h==0&&l.style.display==="none"){let C=l.style.position,E=l.style.visibility;l.style.display="block",l.style.visibility="hidden",l.style.position="absolute",h=l.offsetWidth,l.style.display="none",l.style.visibility=E,l.style.position=C}return h}getHeight(){let l=this.container,h=l.offsetHeight;if(h==0&&l.style.display==="none"){let C=l.style.position,E=l.style.visibility;l.style.display="block",l.style.visibility="hidden",l.style.position="absolute",h=l.offsetHeight,l.style.display="none",l.style.visibility=E,l.style.position=C}return h}setupRenderer(){this.renderer=new u.Renderer({antialias:this.config.antialias,preserveDrawingBuffer:!0,premultipliedAlpha:!1,id:this.config.id,row:this.config.row,col:this.config.col,rows:this.config.rows,cols:this.config.cols,canvas:this.config.canvas,containerWidth:this.WIDTH,containerHeight:this.HEIGHT,ambientOcclusion:this.config.ambientOcclusion,outline:this.config.outline}),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new u.Scene,this.scene.fog=new u.Fog(this.bgColor,100,200),this.modelGroup=new u.Object3D,this.rotationGroup=new u.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new v.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var l=new u.Light(16777215);l.position=new v.Vector3(.2,.2,1).normalize(),l.intensity=1,this.scene.add(l)}_handleLostContext(l){const h=function(C){const E=C.getBoundingClientRect();return!(E.right<0||E.bottom<0||E.top>(window.innerHeight||document.documentElement.clientHeight)||E.left>(window.innerWidth||document.documentElement.clientWidth))};if(h(this.container)){let C=0;for(let E of document.getElementsByTagName("canvas"))if(h(E)&&E._3dmol_viewer!=null&&(E._3dmol_viewer.resize(),C+=1,C>=a))break}}initContainer(l){this.container=l,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var l=0;for(let C in this.surfaces)if(this.surfaces.hasOwnProperty(C)){var h=parseInt(C);isNaN(h)||h>l&&(l=h)}return l+1}setSlabAndFog(){let l=this.camera.position.z-this.rotationGroup.position.z;l<1&&(l=1),this.camera.near=l+this.slabNear,this.camera.near<1&&(this.camera.near=1),this.camera.far=l+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=l*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.far,this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(l){if(this.renderer.setViewport(),!!this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!l&&this.linkedViewers.length>0))for(var h=this._viewer.getView(),C=0;C<this.linkedViewers.length;C++){var E=this.linkedViewers[C];E.setView(h,!0)}}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let l=0,h=this.models.length;l<h;l++){let C=this.models[l];if(C){let E=C.selectedAtoms({clickable:!0}),D=C.selectedAtoms({hoverable:!0}),z=C.selectedAtoms({contextMenuEnabled:!0});for(let L=0;L<D.length;L++)this.hoverables.push(D[L]);for(let L=0;L<E.length;L++)this.clickables.push(E[L]);for(let L=0;L<z.length;L++)this.contextMenuEnabledObjects.push(z[L])}}for(let l=0,h=this.shapes.length;l<h;l++){let C=this.shapes[l];C&&C.clickable&&this.clickables.push(C),C&&C.hoverable&&this.hoverables.push(C),C&&C.contextMenuEnabled&&this.contextMenuEnabledObjects.push(C)}}handleClickSelection(l,h,C){let E=this.targetedObjects(l,h,this.clickables);if(E.length){var D=E[0].clickable;D.callback!==void 0&&(typeof D.callback!="function"&&(D.callback=(0,b.makeFunction)(D.callback)),typeof D.callback=="function"&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(D)&&this.userContextMenuHandler||D.callback(D,this._viewer,C,this.container,E)))}}canvasOffset(){let l=this.glDOM,h=l.getBoundingClientRect(),C=l.ownerDocument,E=C.documentElement,D=C.defaultView;return{top:h.top+D.pageYOffset-E.clientTop,left:h.left+D.pageXOffset-E.clientLeft}}setHover(l,h,C){this.current_hover!=l&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,b.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,h,this.container,C)),this.current_hover=l,l&&l.hover_callback!==void 0&&(typeof l.hover_callback!="function"&&(l.hover_callback=(0,b.makeFunction)(l.hover_callback)),typeof l.hover_callback=="function"&&l.hover_callback(l,this._viewer,h,this.container,C)))}handleHoverSelection(l,h,C){if(this.hoverables.length==0)return;let E=this.targetedObjects(l,h,this.hoverables);if(E.length){var D=E[0].clickable;this.setHover(D,C,E),this.current_hover=D}else this.setHover(null)}handleHoverContinue(l,h){let C=this.targetedObjects(l,h,this.hoverables);(C.length==0||C[0]===void 0)&&this.setHover(null),C[0]!==void 0&&C[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(l,{allowTolerance:h=l.targetTouches,tolerance:C=5}={}){const E=this.getX(l),D=this.getY(l);if(h){const z=Math.abs(E-this.mouseStartX),L=Math.abs(D-this.mouseStartY);return z<=C&&L<=C}else return E===this.mouseStartX&&D===this.mouseStartY}calcTouchDistance(l){var h=l.targetTouches[0].pageX-l.targetTouches[1].pageX,C=l.targetTouches[0].pageY-l.targetTouches[1].pageY;return Math.hypot(h,C)}getX(l){var h=l.pageX;return h==null&&(h=l.pageX),l.targetTouches&&l.targetTouches[0]?h=l.targetTouches[0].pageX:l.changedTouches&&l.changedTouches[0]&&(h=l.changedTouches[0].pageX),h}getY(l){var h=l.pageY;return h==null&&(h=l.pageY),l.targetTouches&&l.targetTouches[0]?h=l.targetTouches[0].pageY:l.changedTouches&&l.changedTouches[0]&&(h=l.changedTouches[0].pageY),h}isInViewer(l,h){if(this.viewers!=null){var C=this.WIDTH/this.cols,E=this.HEIGHT/this.rows,D=this.canvasOffset(),z=l-D.left,L=h-D.top,V=this.rows-Math.floor(L/E)-1,O=Math.floor(z/C);if(V!=this.row||O!=this.col)return!1}return!0}adjustZoomToLimits(l){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let h=this.CAMERA_Z-this.config.lowerZoomLimit;l>h&&(l=h)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let h=this.CAMERA_Z-this.config.upperZoomLimit;l<h&&(l=h)}return l>this.CAMERA_Z-1&&(l=this.CAMERA_Z-1),l}static slerp(l,h,C){if(C==1)return h.clone();if(C==0)return l.clone();let E=l.x*h.x+l.y*h.y+l.z*h.z+l.w*h.w;if(E>.9995){let H=new v.Quaternion(l.x+C*(h.x-l.x),l.y+C*(h.y-l.y),l.z+C*(h.z-l.z),l.w+C*(h.w-l.w));return H.normalize(),H}E<0&&(h=h.clone().multiplyScalar(-1),E=-E),E>1?E=1:E<-1&&(E=-1);var D=Math.acos(E),z=D*C,L=h.clone();L.sub(l.clone().multiplyScalar(E)),L.normalize();var V=Math.cos(z),O=Math.sin(z),W=new v.Quaternion(l.x*V+L.x*O,l.y*V+L.y*O,l.z*V+L.z*O,l.w*V+L.w*O);return W.normalize(),W}constructor(l,h={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.slabNear=-50,this.slabFar=50,this.cq=new v.Quaternion(0,0,0,1),this.dq=new v.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=h,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=_.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",typeof this.config.backgroundColor<"u"&&(this.bgColor=_.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,typeof this.config.camerax<"u"&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=l,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new u.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new v.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new v.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new u.Raycaster(new v.Vector3(0,0,0),new v.Vector3(0,0,0)),this.projector=new u.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=_.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),typeof window.ResizeObserver<"u"&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),typeof window.IntersectionObserver<"u"){let C=(E,D)=>{E.forEach(z=>{z.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(C),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(C){console.log("error with glviewer callback: "+C)}}targetedObjects(l,h,C){var E={x:l,y:h,z:-1};return Array.isArray(C)||(C=this.selectedAtoms(C)),C.length==0?[]:(this.raycaster.setFromCamera(E,this.camera),this.raycaster.intersectObjects(this.modelGroup,C))}modelToScreen(l){let h=!1;Array.isArray(l)||(l=[l],h=!0);let C=this.renderer.getXRatio(),E=this.renderer.getYRatio(),D=this.col,z=this.row,L=D*(this.WIDTH/C),V=(E-z-1)*(this.HEIGHT/E),O=[],W=this.canvasOffset();return l.forEach(H=>{let q=new v.Vector3(H.x,H.y,H.z);q.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector(q,this.camera);let U=this.WIDTH/C*(q.x+1)/2+W.left+L,B=-(this.HEIGHT/E)*(q.y-1)/2+W.top+V;O.push({x:U,y:B})}),h&&(O=O[0]),O}screenOffsetToModel(l,h,C){var E=l/this.WIDTH,D=h/this.HEIGHT,z=C===void 0?this.rotationGroup.position.z:C,L=this.rotationGroup.quaternion,V=new v.Vector3(0,0,z);return this.projector.projectVector(V,this.camera),V.x+=E*2,V.y-=D*2,this.projector.unprojectVector(V,this.camera),V.z=0,V.applyQuaternion(L),V}screenToModelDistance(l,h){let C=this.canvasOffset(),E=new v.Vector3(h.x,h.y,h.z);E.applyMatrix4(this.modelGroup.matrixWorld);let D=E.clone();this.projector.projectVector(E,this.camera);let z=new v.Vector3((l.x-C.left)*2/this.WIDTH-1,(l.y-C.top)*2/-this.HEIGHT+1,E.z);return this.projector.unprojectVector(z,this.camera),z.distanceTo(D)}setViewChangeCallback(l){(typeof l=="function"||l==null)&&(this.viewChangeCallback=l)}setStateChangeCallback(l){(typeof l=="function"||l==null)&&(this.stateChangeCallback=l)}getConfig(){return this.config}setConfig(l){this.config=l,l.ambientOcclusion&&this.renderer.enableAmbientOcclusion(l.ambientOcclusion)}getInternalState(){var l={models:[],surfaces:[],shapes:[],labels:[]};for(let h=0;h<this.models.length;h++)this.models[h]&&(l.models[h]=this.models[h].getInternalState());return l}setInternalState(l){this.clear();var h=l.models;for(let C=0;C<h.length;C++)h[C]&&(this.models[C]=new y.GLModel(C),this.models[C].setInternalState(h[C]));this.render()}setZoomLimits(l,h){typeof l<"u"&&(this.config.lowerZoomLimit=l),h&&(this.config.upperZoomLimit=h),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(l){l.fov!==void 0&&(this.fov=l.fov,this.camera.fov=this.fov),l.z!==void 0&&(this.CAMERA_Z=l.z,this.camera.z=this.CAMERA_Z),l.orthographic!==void 0&&(this.camera.ortho=l.orthographic)}_handleMouseDown(l){if(l.preventDefault(),!this.scene)return;var h=this.getX(l),C=this.getY(l);if(h===void 0)return;this.isDragging=!0,this.mouseButton=l.which,this.mouseStartX=h,this.mouseStartY=C,this.touchHold=!0,this.touchDistanceStart=0,l.targetTouches&&l.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(l)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let E=this;l.targetTouches&&l.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(E.touchHold==!0){E.glDOM=E.renderer.domElement;const D=l.targetTouches[0],z=new PointerEvent("contextmenu",Object.assign(Object.assign({},l),{pageX:D.pageX,pageY:D.pageY,screenX:D.screenX,screenY:D.screenY,clientX:D.clientX,clientY:D.clientY}));E.glDOM.dispatchEvent(z)}},this.longTouchDuration))}_handleMouseUp(l){if(this.touchHold=!1,this.isDragging&&this.scene){var h=this.getX(l),C=this.getY(l);if(this.closeEnoughForClick(l)&&this.isInViewer(h,C)){let E=this.mouseXY(h,C);this.handleClickSelection(E.x,E.y,l)}}this.isDragging=!1}_handleMouseScroll(l){if(l.preventDefault(),!!this.scene){var h=this.getX(l),C=this.getY(l);if(h!==void 0&&!(!this.control_all&&!this.isInViewer(h,C))){var E=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,D=1;if(l.ctrlKey&&(D=-1),l.detail)this.rotationGroup.position.z+=D*E*l.detail/10;else if(l.wheelDelta){let z=l.wheelDelta*600/(l.wheelDelta+600);this.rotationGroup.position.z-=D*E*z/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(l){let h=this;return l=l||1,new Promise(function(C){let E=0,D=h.viewChangeCallback,z=[],L=[],V=Date.now();h.viewChangeCallback=function(){L.push(Date.now()-V),V=Date.now(),z.push(new Promise(O=>{h.getCanvas().toBlob(function(W){W.arrayBuffer().then(O)},"image/png")})),E+=1,E==l&&(h.viewChangeCallback=D,Promise.all(z).then(O=>{let W=[];for(let X=0;X<O.length;X++){let j=(0,S.decode)(O[X]);W.push((0,S.toRGBA8)(j)[0])}let H=h.getCanvas().width,q=h.getCanvas().height,U=(0,S.encode)(W,H,q,0,L),B=new Blob([U],{type:"image/png"}),Y=new FileReader;Y.onload=function(X){C(X.target.result)},Y.readAsDataURL(B)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(l){this.hoverDuration=l}mouseXY(l,h){let C=this.canvasOffset(),E=this.renderer.getXRatio(),D=this.renderer.getYRatio(),z=this.col,L=this.row,V=z*(this.WIDTH/E),O=(D-L-1)*(this.HEIGHT/D),W=(l-C.left-V)/(this.WIDTH/E)*2-1,H=-((h-C.top-O)/(this.HEIGHT/D))*2+1;return{x:W,y:H}}_handleMouseMove(l){clearTimeout(this.hoverTimeout),l.preventDefault();let h=this.getX(l),C=this.getY(l);if(h===void 0)return;let E=this.renderer.getXRatio(),D=this.renderer.getYRatio(),z=this.mouseXY(h,C),L=this;this.current_hover!==null&&this.handleHoverContinue(z.x,z.y);var V=0;if(!(!this.control_all&&!this.isInViewer(h,C))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){L.handleHoverSelection(z.x,z.y,l)},this.hoverDuration)),!!this.isDragging)){l.targetTouches&&(l.targetTouches.length>1||l.targetTouches.length===1&&!this.closeEnoughForClick(l))&&clearTimeout(this.longTouchTimeout);var O=(h-this.mouseStartX)/this.WIDTH,W=(C-this.mouseStartY)/this.HEIGHT;if(this.touchDistanceStart!=0&&l.targetTouches&&l.targetTouches.length==2){var H=this.calcTouchDistance(l);V=2,W=(H-this.touchDistanceStart)*2/(this.WIDTH+this.HEIGHT)}else l.targetTouches&&l.targetTouches.length==3&&(V=1);O*=E,W*=D;var q=Math.hypot(O,W),U;if(V==3||this.mouseButton==3&&l.ctrlKey)this.slabNear=this.cslabNear+O*100,this.slabFar=this.cslabFar-W*100;else if(V==2||this.mouseButton==3||l.shiftKey)U=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,U<80&&(U=80),this.rotationGroup.position.z=this.cz+W*U,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(V==1||this.mouseButton==2||l.ctrlKey){var B=this.screenOffsetToModel(E*(h-this.mouseStartX),D*(C-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,B)}else if((V===0||this.mouseButton==1)&&q!==0){var Y=Math.sin(q*Math.PI)/q;this.dq.x=Math.cos(q*Math.PI),this.dq.y=0,this.dq.z=Y*O,this.dq.w=-Y*W,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(l){if(l.preventDefault(),this.closeEnoughForClick(l)){var E=this.mouseStartX,D=this.mouseStartY,C=this.canvasOffset();let z=this.mouseXY(E,D),L=z.x,V=z.y,O=this.targetedObjects(L,V,this.contextMenuEnabledObjects);var h=null;O.length&&(h=O[0].clickable);var C=this.canvasOffset(),E=this.mouseStartX-C.left,D=this.mouseStartY-C.top;this.userContextMenuHandler&&(this.userContextMenuHandler(h,E,D,O,l),this.isDragging=!1)}}setContainer(l){let h=(0,b.getElement)(l)||this.container;return this.initContainer(h),this}setBackgroundColor(l,h){(typeof h>"u"||h<0||h>1)&&(h=1);var C=_.CC.color(l);return this.scene.fog.color=C,this.bgColor=C.getHex(),this.renderer.setClearColorHex(C.getHex(),h),this.show(),this}setProjection(l){this.camera.ortho=l==="orthographic",this.setSlabAndFog()}setViewStyle(l){if(l=l||{},l.style=l.style||"",l.style.includes("outline")){var h={};l.color&&(h.color=_.CC.color(l.color)),l.width&&(h.width=l.width),this.renderer.enableOutline(h)}else this.renderer.disableOutline();if(l.style.includes("ambientOcclusion")){var h={};l.strength&&(h.strength=l.strength),l.radius&&(h.radius=l.radius),this.renderer.enableAmbientOcclusion(h)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(l){return this.WIDTH=l||this.WIDTH,this.updateSize(),this}setHeight(l){return this.HEIGHT=l||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let l=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let h=!1,C=this.container.querySelector("canvas");C&&C!=this.renderer.getCanvas()?this.config.canvas=C:(C.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,h=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),l=!0,h&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),l){let h=this.renderer.supportedExtensions();if(h.regen=!0,this.viewers)for(let C=0,E=this.viewers.length;C<E;C++)for(let D=0,z=this.viewers[C].length;D<z;D++)this.viewers[C][D].render(null,h);this._viewer.render(null,h)}else this.show();return this}getModel(l){return l===void 0?this.models.length==0?null:this.models[this.models.length-1]:l instanceof y.GLModel?l:l in this.models?this.models[l]:this.models.length==0?null:this.models[this.models.length-1]}spin(l,h=1){if(clearInterval(this.spinInterval),typeof l>"u"&&(l="y"),typeof l=="boolean")if(l)l="y";else return;Array.isArray(l)&&(l={x:l[0],y:l[1],z:l[2]});var C=this;this.spinInterval=setInterval(function(){!C.getCanvas().isConnected&&C.renderer.isLost()&&clearInterval(C.spinInterval),C.rotate(1*h,l)},25)}animateMotion(l,h,C,E,D,z){var L=20,V=Math.ceil(l/L);V<1&&(V=1),this.incAnim();var O={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(h){let q=new Array(V);for(let X=0;X<V;X++){let j=(X+1)/V,J={mpos:O.mpos,rz:O.rz,rot:O.rot};J.mpos=C.clone().sub(O.mpos).multiplyScalar(j).add(O.mpos),J.rz=O.rz+j*(E-O.rz),J.rot=s.slerp(O.rot,D,j),J.cam=z.clone().sub(O.cam).multiplyScalar(j).add(O.cam),q[X]=J}let U=0,B=this,Y=function(){var X=q[U];U+=1,B.modelGroup.position=X.mpos,B.rotationGroup.position.z=X.rz,B.rotationGroup.quaternion=X.rot,B.camera.lookAt(X.cam),U<q.length?setTimeout(Y,L):B.decAnim(),B.show()};setTimeout(Y,L)}else{var W={};let q=1/V;if(C&&(W.mpos=C.clone().sub(O.mpos).multiplyScalar(q)),typeof E<"u"&&E!=null&&(W.rz=q*(E-O.rz)),D){var H=s.slerp(O.rot,D,q);W.rot=O.rot.clone().inverse().multiply(H)}z&&(W.cam=z.clone().sub(O.cam).multiplyScalar(q));let U=0,B=this,Y=function(){U+=1,W.mpos&&B.modelGroup.position.add(W.mpos),W.rz&&(B.rotationGroup.position.z+=W.rz),W.rot&&B.rotationGroup.quaternion.multiply(W.rot),W.cam&&(B.lookingAt.add(W.cam),B.camera.lookAt(B.lookingAt)),U<V?setTimeout(Y,L):B.decAnim(),B.show()};setTimeout(Y,L)}}rotate(l,h="y",C=0,E=!1){if(h=="x"?h={x:1,y:0,z:0}:h=="y"?h={x:0,y:1,z:0}:h=="z"&&(h={x:0,y:0,z:1}),h=="vx"?h={vx:1,vy:0,vz:0}:h=="vy"?h={vx:0,vy:1,vz:0}:h=="vz"&&(h={vx:0,vy:0,vz:1}),typeof h.vx<"u"){var D=new v.Vector3(h.vx,h.vy,h.vz);D.applyQuaternion(this.rotationGroup.quaternion),h={x:D.x,y:D.y,z:D.z}}var z=function(W){var H=Math.sin(W/2),q=Math.cos(W/2),U=0,B=0,Y=0;return U=h.x*H,B=h.y*H,Y=h.z*H,new v.Quaternion(U,B,Y,q).normalize()},L=Math.PI*l/180,V=z(L);if(C){var O=new v.Quaternion().copy(this.rotationGroup.quaternion).multiply(V);this.animateMotion(C,E,this.modelGroup.position,this.rotationGroup.position.z,O,this.lookingAt)}else this.rotationGroup.quaternion.multiply(V),this.show();return this}surfacesFinished(){for(var l in this.surfaces)if(!this.surfaces[l][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var l=this.modelGroup.position,h=this.rotationGroup.quaternion;return[l.x,l.y,l.z,this.rotationGroup.position.z,h.x,h.y,h.z,h.w]}setView(l,h){return l===void 0||!(l instanceof Array||l.length!==8)?this:!this.modelGroup||!this.rotationGroup?this:(this.modelGroup.position.x=l[0],this.modelGroup.position.y=l[1],this.modelGroup.position.z=l[2],this.rotationGroup.position.z=l[3],this.rotationGroup.quaternion.x=l[4],this.rotationGroup.quaternion.y=l[5],this.rotationGroup.quaternion.z=l[6],this.rotationGroup.quaternion.w=l[7],typeof l[8]<"u"&&(this.rotationGroup.position.x=l[8],this.rotationGroup.position.y=l[9]),this.show(h),this)}render(l,h){this.renderer.setViewport(),this.updateClickables();var C=this.getView();this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState());var E,D;for(h||(h=this.renderer.supportedExtensions()),E=0;E<this.models.length;E++)this.models[E]&&this.models[E].globj(this.modelGroup,h);for(E=0;E<this.shapes.length;E++)this.shapes[E]&&(typeof this.shapes[E].frame>"u"||this.viewer_frame<0||this.shapes[E].frame<0||this.shapes[E].frame==this.viewer_frame?this.shapes[E].globj(this.modelGroup,h):this.shapes[E].removegl(this.modelGroup));for(E=0;E<this.labels.length;E++)h.regen&&(this.labels[E].dispose(),this.modelGroup.remove(this.labels[E].sprite),this.labels[E].setContext(),this.modelGroup.add(this.labels[E].sprite)),this.labels[E]&&typeof this.labels[E].frame<"u"&&this.labels[E].frame>=0&&(this.modelGroup.remove(this.labels[E].sprite),(this.viewer_frame<0||this.labels[E].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[E].sprite));for(E in this.surfaces)if(this.surfaces.hasOwnProperty(E)){var z=this.surfaces[E];for(D=0;D<z.length;D++)if(z.hasOwnProperty(D)){var L=z[D].geo;if(!z[D].finished||h.regen){L.verticesNeedUpdate=!0,L.elementsNeedUpdate=!0,L.normalsNeedUpdate=!0,L.colorsNeedUpdate=!0,L.buffersNeedUpdate=!0,L.boundingSphere=null,z[D].mat.needsUpdate=!0,z[D].done&&(z[D].finished=!0),z[D].lastGL&&this.modelGroup.remove(z[D].lastGL);var V=null;if(z[D].mat instanceof u.LineBasicMaterial?V=new u.Line(L,z[D].mat):V=new u.Mesh(L,z[D].mat),z[D].mat.transparent&&z[D].mat.opacity==0?V.visible=!1:V.visible=!0,z[D].symmetries.length>1||z[D].symmetries.length==1&&!z[D].symmetries[D].isIdentity()){var O,W=new u.Object3D;for(O=0;O<z[D].symmetries.length;O++){var H=V.clone();H.matrix=z[D].symmetries[O],H.matrixAutoUpdate=!1,W.add(H)}z[D].lastGL=W,this.modelGroup.add(W)}else z[D].lastGL=V,this.modelGroup.add(V)}}}return this.setView(C),typeof l=="function"&&l(this),this}getModelList(l){let h=[];if(typeof l>"u"||typeof l.model>"u")for(let E=0;E<this.models.length;E++)this.models[E]&&h.push(this.models[E]);else{let E=l.model;Array.isArray(E)||(E=[E]);for(let D=0;D<E.length;D++)if(typeof E[D]=="number"){var C=E[D];C<0&&(C+=this.models.length),h.push(this.models[C])}else h.push(E[D])}return h}getAtomsFromSel(l){var h=[];typeof l>"u"&&(l={});var C=this.getModelList(l);for(let E=0;E<C.length;E++)h=h.concat(C[E].selectedAtoms(l));return h}atomIsSelected(l,h){typeof h>"u"&&(h={});for(var C=this.getModelList(h),E=0;E<C.length;E++)if(C[E].atomIsSelected(l,h))return!0;return!1}selectedAtoms(l){return this.getAtomsFromSel(l)}getUniqueValues(l,h){typeof h>"u"&&(h={});var C=this.getAtomsFromSel(h),E={};for(var D in C)if(C[D].hasOwnProperty(l)){var z=C[D][l];E[z]=!0}return Object.keys(E)}pdbData(l){for(var h=this.getAtomsFromSel(l),C="",E=0,D=h.length;E<D;++E)C+=h[E].pdbline+`
`;return C}zoom(l=2,h=0,C=!1){var E=(this.CAMERA_Z-this.rotationGroup.position.z)/l,D=this.CAMERA_Z-E;return h>0?this.animateMotion(h,C,this.modelGroup.position,this.adjustZoomToLimits(D),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(D),this.show()),this}translate(l,h,C=0,E=!1){var D=l/this.WIDTH,z=h/this.HEIGHT,L=new v.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(L,this.camera),L.x-=D,L.y-=z,this.projector.unprojectVector(L,this.camera),L.z=0;var V=this.lookingAt.clone().add(L);return C>0?this.animateMotion(C,E,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,V):(this.lookingAt=V,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(l,h,C=0,E=!1){var D=this.screenOffsetToModel(l,h),z=this.modelGroup.position.clone().add(D);return C>0?this.animateMotion(C,E,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=z,this.show()),this}fitSlab(l){l=l||{};var h=this.getAtomsFromSel(l),C=(0,b.getExtent)(h),E=C[1][0]-C[0][0],D=C[1][1]-C[0][1],z=C[1][2]-C[0][2],L=Math.hypot(E,D,z);return L<5&&(L=5),this.slabNear=-L/1.9,this.slabFar=L/2,this}center(l={},h=0,C=!1){var E,D,z=this.getAtomsFromSel(l),L=(0,b.getExtent)(z);(0,b.isEmptyObject)(l)?(this.shapes.forEach(j=>{if(j&&j.boundingSphere&&j.boundingSphere.center){var J=j.boundingSphere.center,le=j.boundingSphere.radius;le>0?(z.push(new v.Vector3(J.x+le,J.y,J.z)),z.push(new v.Vector3(J.x-le,J.y,J.z)),z.push(new v.Vector3(J.x,J.y+le,J.z)),z.push(new v.Vector3(J.x,J.y-le,J.z)),z.push(new v.Vector3(J.x,J.y,J.z+le)),z.push(new v.Vector3(J.x,J.y,J.z-le))):z.push(J)}}),L=(0,b.getExtent)(z),E=z,D=L):(E=this.getAtomsFromSel({}),D=(0,b.getExtent)(E));var V=new v.Vector3(L[2][0],L[2][1],L[2][2]),O=D[1][0]-D[0][0],W=D[1][1]-D[0][1],H=D[1][2]-D[0][2],q=Math.hypot(O,W,H);q<5&&(q=5),this.slabNear=-q/1.9,this.slabFar=q/2,O=L[1][0]-L[0][0],W=L[1][1]-L[0][1],H=L[1][2]-L[0][2],q=Math.hypot(O,W,H),q<5&&(q=5);for(var U=25,B=0;B<z.length;B++)if(z[B]){var Y=V.distanceToSquared(z[B]);Y>U&&(U=Y)}q=Math.sqrt(U)*2;var X=V.clone().multiplyScalar(-1);return h>0?this.animateMotion(h,C,X,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=X,this.show()),this}zoomTo(l={},h=0,C=!1){let E=this.getAtomsFromSel(l),D=(0,b.getExtent)(E),z=D;if((0,b.isEmptyObject)(l)){let J=E&&E.length;if(this.shapes.forEach(le=>{if(le&&le.boundingSphere){if(le.boundingSphere.box){let pe=le.boundingSphere.box;E.push(new v.Vector3(pe.min.x,pe.min.y,pe.min.z)),E.push(new v.Vector3(pe.max.x,pe.max.y,pe.max.z))}else if(le.boundingSphere.center){var se=le.boundingSphere.center,he=le.boundingSphere.radius;he>0?(E.push(new v.Vector3(se.x+he,se.y,se.z)),E.push(new v.Vector3(se.x-he,se.y,se.z)),E.push(new v.Vector3(se.x,se.y+he,se.z)),E.push(new v.Vector3(se.x,se.y-he,se.z)),E.push(new v.Vector3(se.x,se.y,se.z+he)),E.push(new v.Vector3(se.x,se.y,se.z-he))):E.push(se)}}}),z=(0,b.getExtent)(E),!J)for(let le=0;le<3;le++)D[2][le]=(z[0][le]+z[1][le])/2}else{let J=this.getAtomsFromSel({});z=(0,b.getExtent)(J)}var L=new v.Vector3(D[2][0],D[2][1],D[2][2]),V=z[1][0]-z[0][0],O=z[1][1]-z[0][1],W=z[1][2]-z[0][2],H=Math.hypot(V,O,W);H<5&&(H=5),this.slabNear=-H/1.9,this.slabFar=H/2,Object.keys(l).length===0&&(this.slabNear=Math.min(-H*2,-50),this.slabFar=Math.max(H*2,50));var q=this.config.minimumZoomToDistance||5;V=D[1][0]-D[0][0],O=D[1][1]-D[0][1],W=D[1][2]-D[0][2],H=Math.hypot(V,O,W),H<q&&(H=q);for(var U=q*q,B=0;B<E.length;B++)if(E[B]){var Y=L.distanceToSquared(E[B]);Y>U&&(U=Y)}H=Math.sqrt(U)*2;var X=L.clone().multiplyScalar(-1),j=-(H*.5/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return j=this.adjustZoomToLimits(j),h>0?this.animateMotion(h,C,X,j,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=X,this.rotationGroup.position.z=j,this.show()),this}setSlab(l,h){this.slabNear=l,this.slabFar=h}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(l,h={},C,E=!1){if(C){var D=(0,b.getExtent)(this.getAtomsFromSel(C));h.position={x:D[2][0],y:D[2][1],z:D[2][2]}}var z=new k.Label(l,h);return z.setContext(),this.modelGroup.add(z.sprite),this.labels.push(z),E||this.show(),z}addResLabels(l,h,C=!1){let E=this.labels.length;return this.applyToModels("addResLabels",l,this,h,C),this.show(),this.labels.slice(E)}addPropertyLabels(l,h,C){return this.applyToModels("addPropertyLabels",l,h,this,C),this.show(),this}removeLabel(l){for(var h=0;h<this.labels.length;h++)if(this.labels[h]==l){this.labels.splice(h,1),l.dispose(),this.modelGroup.remove(l.sprite);break}return this.show(),this}removeAllLabels(){for(var l=0;l<this.labels.length;l++)this.labels[l]&&this.labels[l].sprite&&this.modelGroup.remove(this.labels[l].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}setLabelStyle(l,h){return this.modelGroup.remove(l.sprite),l.dispose(),l.stylespec=h,l.setContext(),this.modelGroup.add(l.sprite),this.show(),l}setLabelText(l,h){return this.modelGroup.remove(l.sprite),l.dispose(),l.text=h,l.setContext(),this.modelGroup.add(l.sprite),this.show(),l}addShape(l){l=l||{};var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,this.shapes.push(h),h}removeShape(l){if(!l)return this;for(l.removegl(this.modelGroup),delete this.shapes[l.shapePosition];this.shapes.length>0&&typeof this.shapes[this.shapes.length-1]>"u";)this.shapes.pop();return this}removeAllShapes(){for(var l=0;l<this.shapes.length;l++){var h=this.shapes[l];h&&h.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(l){if(l.hasOwnProperty("x")&&l.hasOwnProperty("y")&&l.hasOwnProperty("z"))return l;var h=this.getAtomsFromSel(l);if(h.length==0)return{x:0,y:0,z:0};var C=(0,b.getExtent)(h);return{x:C[0][0]+(C[1][0]-C[0][0])/2,y:C[0][1]+(C[1][1]-C[0][1])/2,z:C[0][2]+(C[1][2]-C[0][2])/2}}addSphere(l){l=l||{},l.center=this.getSelectionCenter(l.center);var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,h.addSphere(l),this.shapes.push(h),h.finalize(),h}addBox(l={}){l.corner!=null&&(l.corner=this.getSelectionCenter(l.corner)),l.center!=null&&(l.center=this.getSelectionCenter(l.center));var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,h.addBox(l),this.shapes.push(h),h.finalize(),h}addArrow(l={}){l.start=this.getSelectionCenter(l.start),l.end=this.getSelectionCenter(l.end);var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,h.addArrow(l),this.shapes.push(h),h.finalize(),h}addCylinder(l={}){l.start=this.getSelectionCenter(l.start),l.end=this.getSelectionCenter(l.end);var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,l.dashed?h.addDashedCylinder(l):h.addCylinder(l),this.shapes.push(h),h.finalize(),h}addCurve(l={}){var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,h.addCurve(l),this.shapes.push(h),h.finalize(),h}addLine(l={}){l.start=this.getSelectionCenter(l.start),l.end=this.getSelectionCenter(l.end),l.wireframe=!0;var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,l.dashed?h=this.addLineDashed(l,h):h.addLine(l),this.shapes.push(h),h.finalize(),h}addUnitCell(l,h){l=this.getModel(l),h=h||{alabel:"a",blabel:"b",clabel:"c"},h.box=h.box||{},h.astyle=h.astyle||{color:"red",radius:.1,midpos:-1},h.bstyle=h.bstyle||{color:"green",radius:.1,midpos:-1},h.cstyle=h.cstyle||{color:"blue",radius:.1,midpos:-1},h.alabelstyle=h.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},h.blabelstyle=h.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},h.clabelstyle=h.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},l.unitCellObjects&&this.removeUnitCell(l),l.unitCellObjects={shapes:[],labels:[]};var C=l.getCrystData(),E=null;if(C){if(C.matrix)E=C.matrix;else{var D=C.a,z=C.b,L=C.c,V=C.alpha,O=C.beta,W=C.gamma;V=V*Math.PI/180,O=O*Math.PI/180,W=W*Math.PI/180;var H,q,U;H=Math.cos(O),q=(Math.cos(V)-Math.cos(O)*Math.cos(W))/Math.sin(W),U=Math.sqrt(Math.max(0,1-H*H-q*q)),E=new v.Matrix3(D,z*Math.cos(W),L*H,0,z*Math.sin(W),L*q,0,0,L*U)}var B=[new v.Vector3(0,0,0),new v.Vector3(1,0,0),new v.Vector3(0,1,0),new v.Vector3(0,0,1),new v.Vector3(1,1,0),new v.Vector3(0,1,1),new v.Vector3(1,0,1),new v.Vector3(1,1,1)];if(C.matrix4)for(let X=0;X<B.length;X++)C.size&&B[X].multiplyVectors(B[X],C.size),B[X]=B[X].applyMatrix4(C.matrix4);else for(let X=0;X<B.length;X++)B[X]=B[X].applyMatrix3(E);if(h.box&&!h.box.hidden){h.box.wireframe=!0;var Y=new g.GLShape(h.box);Y.shapePosition=this.shapes.length,Y.addLine({start:B[0],end:B[1]}),Y.addLine({start:B[0],end:B[2]}),Y.addLine({start:B[1],end:B[4]}),Y.addLine({start:B[2],end:B[4]}),Y.addLine({start:B[0],end:B[3]}),Y.addLine({start:B[3],end:B[5]}),Y.addLine({start:B[2],end:B[5]}),Y.addLine({start:B[1],end:B[6]}),Y.addLine({start:B[4],end:B[7]}),Y.addLine({start:B[6],end:B[7]}),Y.addLine({start:B[3],end:B[6]}),Y.addLine({start:B[5],end:B[7]}),this.shapes.push(Y),l.unitCellObjects.shapes.push(Y),Y.finalize()}if(!h.astyle.hidden){h.astyle.start=B[0],h.astyle.end=B[1];let X=this.addArrow(h.astyle);l.unitCellObjects.shapes.push(X)}if(!h.bstyle.hidden){h.bstyle.start=B[0],h.bstyle.end=B[2];let X=this.addArrow(h.bstyle);l.unitCellObjects.shapes.push(X)}if(!h.cstyle.hidden){h.cstyle.start=B[0],h.cstyle.end=B[3];let X=this.addArrow(h.cstyle);l.unitCellObjects.shapes.push(X)}if(h.alabel){h.alabelstyle.position=B[1];let X=this.addLabel(h.alabel,h.alabelstyle);l.unitCellObjects.labels.push(X)}if(h.blabel){h.blabelstyle.position=B[2];let X=this.addLabel(h.blabel,h.blabelstyle);l.unitCellObjects.labels.push(X)}if(h.clabel){h.clabelstyle.position=B[3];let X=this.addLabel(h.clabel,h.clabelstyle);l.unitCellObjects.labels.push(X)}}}removeUnitCell(l){if(l=this.getModel(l),l.unitCellObjects){let h=this;l.unitCellObjects.shapes.forEach(function(C){h.removeShape(C)}),l.unitCellObjects.labels.forEach(function(C){h.removeLabel(C)})}delete l.unitCellObjects}replicateUnitCell(l=3,h=l,C=h,E,D,z){E=this.getModel(E);let L=E.getCrystData();if(L){const V=E.selectedAtoms({}),O=L.matrix;let W=function(q){return q%2==0?-q/2:Math.ceil(q/2)};l<=1&&h<=1&&C<=1&&(z=!0,l=h=C=3);let H=function(q,U,B){return!1};if(z){const q=new v.Matrix3().getInverse3(O);H=function(U,B,Y){let X=new v.Vector3(U,B,Y).applyMatrix3(q);return!(X.x>-1e-4&&X.x<1.0001&&X.y>-1e-4&&X.y<1.0001&&X.z>-1e-4&&X.z<1.0001)}}for(let q=0;q<l;q++)for(let U=0;U<h;U++)for(let B=0;B<C;B++){if(q==0&&U==0&&B==0)continue;let Y=new v.Vector3(W(q),W(U),W(B));Y.applyMatrix3(O);let X=[];for(let j=0;j<V.length;j++){let J=V[j].x+Y.x,le=V[j].y+Y.y,se=V[j].z+Y.z;if(H(J,le,se))continue;let he={};for(let pe in V[j])he[pe]=V[j][pe];he.x=J,he.y=le,he.z=se,X.push(he)}E.addAtoms(X)}D&&E.assignBonds()}}addLineDashed(l,h){l.dashLength=l.dashLength||.5,l.gapLength=l.gapLength||.5;var C;l.start?C=new v.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):C=new v.Vector3(0,0,0);var E;l.end?E=new v.Vector3(l.end.x,l.end.y||0,l.end.z||0):E=new v.Vector3(0,0,0);var D=new v.Vector3,z=new v.Vector3,L=new v.Vector3,V,O,W,H=C.clone(),q=0;for(D.subVectors(E,C),V=D.length(),D.normalize(),z=D.clone(),L=D.clone(),z.multiplyScalar(l.dashLength),L.multiplyScalar(l.gapLength),O=z.length(),W=L.length();q<V;){if(q+O>V){l.start=C,l.end=E,h.addLine(l);break}H.addVectors(C,z),l.start=C,l.end=H,h.addLine(l),C=H.clone(),q+=O,H.addVectors(C,L),C=H.clone(),q+=W}return h.finalize(),h}addCustom(l){l=l||{};var h=new g.GLShape(l);return h.shapePosition=this.shapes.length,h.addCustom(l),this.shapes.push(h),h.finalize(),h}addVolumetricData(l,h,C={}){var E=new M.VolumeData(l,h);return C.hasOwnProperty("transferfn")?this.addVolumetricRender(E,C):this.addIsosurface(E,C)}addIsosurface(l,h={},C){var E=new g.GLShape(h);return E.shapePosition=this.shapes.length,E.addIsosurface(l,h,C,this),this.shapes.push(E),E}addVolumetricRender(l,h){h=h||{};var C=new R.GLVolumetricRender(l,h,this);return C.shapePosition=this.shapes.length,this.shapes.push(C),C}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(l){l?this.scene.fog=new u.Fog(this.bgColor,100,200):(this.config.disableFog=!0,this.show())}setFrame(l){this.viewer_frame=l;let h=this;return new Promise(function(C){var E=h.models.map(function(D){return D.setFrame(l,h)});Promise.all(E).then(function(){C()})})}getFrame(){return this.viewer_frame}getNumFrames(){var l=0;for(let h=0;h<this.models.length;h++)this.models[h].getNumFrames()>l&&(l=this.models[h].getNumFrames());for(let h=0;h<this.shapes.length;h++)this.shapes[h].frame&&this.shapes[h].frame>=l&&(l=this.shapes[h].frame+1);for(let h=0;h<this.labels.length;h++)this.labels[h].frame&&this.labels[h].frame>=l&&(l=this.labels[h].frame+1);return l}animate(l){this.incAnim();var h=100,C="forward",E=1/0;l=l||{},l.interval&&(h=l.interval),l.loop&&(C=l.loop),l.reps&&(E=l.reps);var D=this.getNumFrames(),z=this,L=0;l.startFrame&&(L=l.startFrame%D);var V=1;l.step&&(V=l.step,E/=V);var O=0,W=D*E,H=new Date,q,U,B=function(Y){H=new Date,Y=="forward"?z.setFrame(L).then(function(){L=(L+V)%D,q()}):Y=="backward"?z.setFrame(D-1-L).then(function(){L=(L+V)%D,q()}):z.setFrame(L).then(function(){L+=V,V*=L%(D-1)==0?-1:1,q()})};return q=function(){if(z.render(),!z.getCanvas().isConnected)z.stopAnimate();else if(++O>=W||!z.isAnimated())U.cancel(),z.animationTimers.delete(U),z.decAnim();else{var Y=h-(new Date().getTime()-H.getTime());Y=Y>0?Y:0,z.animationTimers.delete(U),U=new b.PausableTimer(B,Y,C),z.animationTimers.add(U)}},U=new b.PausableTimer(B,0,C),this.animationTimers.add(U),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(l){l.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(l){l.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(l){l.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(l){return l&&!l.defaultcolors?(l.defaultcolors=this.defaultcolors,l.cartoonQuality=l.cartoonQuality||this.config.cartoonQuality):typeof l>"u"&&(l={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),l}addModel(l,h="",C){C=this.getModelOpt(C);var E=new y.GLModel(this.models.length,C);return E.addMolData(l,h,C),this.models.push(E),E}addModels(l,h,C){C=this.getModelOpt(C),C.multimodel=!0,C.frames=!0;for(var E=y.GLModel.parseMolData(l,h,C),D=0;D<E.length;D++){var z=new y.GLModel(this.models.length,C);z.setAtomDefaults(E[D]),z.addFrame(E[D]),z.setFrame(0),E.modelData&&z.setModelData(E.modelData[D]),z.setDontDuplicateAtoms(!C.duplicateAssemblyAtoms),this.models.push(z)}return this.models}addModelsAsFrames(l,h,C){C=this.getModelOpt(C),C.multimodel=!0,C.frames=!0;var E=new y.GLModel(this.models.length,C);return E.addMolData(l,h,C),this.models.push(E),E}addAsOneMolecule(l,h,C){C=this.getModelOpt(C),C.multimodel=!0,C.onemol=!0;var E=new y.GLModel(this.models.length,C);return E.addMolData(l,h,C),this.models.push(E),E}removeModel(l){if(l=this.getModel(l),!!l){for(l.removegl(this.modelGroup),delete this.models[l.getID()];this.models.length>0&&typeof this.models[this.models.length-1]>"u";)this.models.pop();return this}}removeAllModels(){for(var l=0;l<this.models.length;l++){var h=this.models[l];h&&h.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(l,h){var C={};return h===void 0?C.m=this.models.map(function(E){return E.toCDObject(l)}):C.m=[this.models[h].toCDObject()],JSON.stringify(C)}exportVRML(){var l=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new u.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var h=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=l,h}createModelFrom(l,h=!1){for(var C=new y.GLModel(this.models.length,this.defaultcolors),E=0;E<this.models.length;E++)if(this.models[E]){var D=this.models[E].selectedAtoms(l);C.addAtoms(D),h&&this.models[E].removeAtoms(D)}return this.models.push(C),C}applyToModels(l,h,C,E,D,z,L){for(var V=this.getModelList(h),O=0;O<V.length;O++)V[O][l](h,C,E,D,z,L)}setStyle(l,h){return typeof h>"u"&&(h=l,l={}),this.applyToModels("setStyle",l,h,!1),this}addStyle(l,h){return typeof h>"u"&&(h=l,l={}),this.applyToModels("setStyle",l,h,!0),this}setClickable(l,h,C){return this.applyToModels("setClickable",l,h,C),this}setHoverable(l,h,C,E){return this.applyToModels("setHoverable",l,h,C,E),this}enableContextMenu(l,h){return this.applyToModels("enableContextMenu",l,h),this}vibrate(l,h,C,E){return this.applyToModels("vibrate",l,h,C,this,E),this}setColorByProperty(l,h,C,E){return this.applyToModels("setColorByProperty",l,h,C,E),this}setColorByElement(l,h){return this.applyToModels("setColorByElement",l,h),this}static getAtomsWithin(l,h){var C=[];for(let D=0;D<l.length;D++){var E=l[D];typeof E>"u"||E.x<h[0][0]||E.x>h[1][0]||E.y<h[0][1]||E.y>h[1][1]||E.z<h[0][2]||E.z>h[1][2]||C.push(E)}return C}static volume(l){var h=l[1][0]-l[0][0],C=l[1][1]-l[0][1],E=l[1][2]-l[0][2];return h*C*E}carveUpExtent(l,h,C){let E=[],D={};for(let H=0,q=h.length;H<q;H++)D[h[H].index]=H;let z=function(H){let q=[];for(let U=0,B=H.length;U<B;U++)H[U].index in D&&q.push(D[H[U].index]);return q},L=function(H){let q=[];return q[0]=[H[0][0],H[0][1],H[0][2]],q[1]=[H[1][0],H[1][1],H[1][2]],q},V=function(H){if(s.volume(H)<s.maxVolume)return[H];var q=H[1][0]-H[0][0],U=H[1][1]-H[0][1],B=H[1][2]-H[0][2],Y;q>U&&q>B?Y=0:U>q&&U>B?Y=1:Y=2;var X=L(H),j=L(H),J=(H[1][Y]-H[0][Y])/2+H[0][Y];X[1][Y]=J,j[0][Y]=J;var le=V(X),se=V(j);return le.concat(se)},O=V(l),W=6;for(let H=0,q=O.length;H<q;H++){let U=L(O[H]);U[0][0]-=W,U[0][1]-=W,U[0][2]-=W,U[1][0]+=W,U[1][1]+=W,U[1][2]+=W;let B=s.getAtomsWithin(h,U),Y=s.getAtomsWithin(C,O[H]);E.push({extent:O[H],atoms:z(B),toshow:z(Y)})}return E}static generateSurfaceMesh(l,h,C){var E=new u.Geometry(!0),D=E.updateGeoGroup(0),z=[];for(let We=0,Oe=l.length;We<Oe;We++){var L=l[We];L&&(typeof L.surfaceColor<"u"?z[We]=L.surfaceColor:L.color&&(z[We]=_.CC.color(L.color)))}var V=D.vertexArray,O=h.vertices;for(let We=0,Oe=O.length;We<Oe;We++){let fe=D.vertices*3;V[fe]=O[We].x,V[fe+1]=O[We].y,V[fe+2]=O[We].z,D.vertices++}var W=D.colorArray;if(C.voldata&&C.volscheme){var H=C.volscheme,q=C.voldata,U=H.range()||[-1,1];for(let We=0,Oe=O.length;We<Oe;We++){let fe=q.getVal(O[We].x,O[We].y,O[We].z),De=_.CC.color(H.valueToHex(fe,U)),qe=We*3;W[qe]=De.r,W[qe+1]=De.g,W[qe+2]=De.b}}else if(z.length>0)for(let We=0,Oe=O.length;We<Oe;We++){let fe=O[We].atomid,De=We*3;W[De]=z[fe].r,W[De+1]=z[fe].g,W[De+2]=z[fe].b}var B=h.faces;D.faceidx=B.length,E.initTypedArrays();var Y=D.vertexArray,X=D.normalArray,j,J,le,se;for(let We=0,Oe=B.length;We<Oe;We+=3){var he=B[We],pe=B[We+1],ve=B[We+2],ce=he*3,me=pe*3,Re=ve*3;j=new v.Vector3(Y[ce],Y[ce+1],Y[ce+2]),J=new v.Vector3(Y[me],Y[me+1],Y[me+2]),le=new v.Vector3(Y[Re],Y[Re+1],Y[Re+2]),le.subVectors(le,J),j.subVectors(j,J),le.cross(j),se=le,se.normalize(),X[ce]+=se.x,X[me]+=se.x,X[Re]+=se.x,X[ce+1]+=se.y,X[me+1]+=se.y,X[Re+1]+=se.y,X[ce+2]+=se.z,X[me+2]+=se.z,X[Re+2]+=se.z}D.faceArray=new Uint16Array(B);var Ge=new u.Mesh(E,C);return Ge}static generateMeshSyncHelper(l,h,C,E,D,z){var L=new P.ProteinSurface;return L.initparm(h,l!==1,z),L.fillvoxels(D,C),L.buildboundary(),(l==P.SurfaceType.SES||l==P.SurfaceType.MS)&&(L.fastdistancemap(),L.boundingatom(!1),L.fillvoxelswaals(D,C)),L.marchingcube(l),L.getFacesAndVertices(E)}static getMatWithStyle(l){let h=null;l.onesided?h=new u.MeshLambertMaterial:h=new u.MeshDoubleLambertMaterial,h.vertexColors=u.Coloring.VertexColors;for(var C in l)C==="color"||C==="map"||l.hasOwnProperty(C)&&(h[C]=l[C]);return l.opacity!==void 0&&(l.opacity===1?h.transparent=!1:h.transparent=!0),h}addMesh(l){var h={geo:l.geometry,mat:l.material,done:!0,finished:!1},C=this.nextSurfID();return this.surfaces[C]=h,C}static shallowCopy(l){var h=[];let C=l.length;for(let E=0;E<C;E++)h[E]=(0,b.extend)({},l[E]);return h}addSurface(l,h={},C={},E,D,z){let L=this.nextSurfID(),V=null,O=this,W=P.SurfaceType.VDW;typeof l=="string"?s.surfaceTypeMap[l.toUpperCase()]!==void 0?W=s.surfaceTypeMap[l]:console.log("Surface type : "+l+" is not recognized"):typeof l=="number"&&(W=l);var H=null,q=null,U=s.shallowCopy(this.getAtomsFromSel(C));E?H=s.shallowCopy(this.getAtomsFromSel(E)):H=U,(0,b.adjustVolumeStyle)(h);var B=!1,Y;for(Y=0;Y<this.models.length;Y++)if(this.models[Y]){var X=this.models[Y].getSymmetries();if(X.length>1||X.length==1&&!X[0].isIdentity()){B=!0;break}}var j=function(ve,ce,me){D?q=s.shallowCopy(O.getAtomsFromSel(D)):q=me;var Re,Ge=(0,b.getExtent)(me,!0);if(h.map&&h.map.prop){var We=h.map.prop;let je=(0,p.getGradient)(h.map.scheme||h.map.gradient||new p.Gradient.RWB),Ue=je.range();Ue||(Ue=(0,b.getPropertyRange)(me,We)),h.colorscheme={prop:We,gradient:je}}for(let je=0,Ue=ce.length;je<Ue;je++)Re=ce[je],Re.surfaceColor=(0,b.getColorFromStyle)(Re,h);var Oe=s.volume(Ge),fe=O.carveUpExtent(Ge,ce,me);if(q&&q.length&&q.length>0){var De=(0,b.getExtent)(q,!0),qe=function(je,Ue){var ft=function(ie,oe){var we=ie.extent,Se=we[1][0]-we[0][0],He=we[1][1]-we[0][1],Be=we[1][2]-we[0][2],K=Se-oe[2][0];K*=K;var _e=He-oe[2][1];_e*=_e;var Me=Be-oe[2][2];return Me*=Me,K+_e+Me},ut=ft(je,De),ee=ft(Ue,De);return ut-ee};fe.sort(qe)}var Qe=[];for(let je=0,Ue=ce.length;je<Ue;je++)Re=ce[je],Qe[je]={x:Re.x,y:Re.y,z:Re.z,serial:je,elem:Re.elem};var st=!!P.syncSurface;if(st){var ot=function(je){return new Promise(function(Ue){for(var ft=s.generateMeshSyncHelper(W,fe[je].extent,fe[je].atoms,fe[je].toshow,Qe,Oe),ut=(0,g.splitMesh)({vertexArr:ft.vertices,faceArr:ft.faces}),ee=0,ie=ut.length;ee<ie;ee++){ft={vertices:ut[ee].vertexArr,faces:ut[ee].faceArr};var oe=s.generateSurfaceMesh(ce,ft,V);(0,b.mergeGeos)(ve.geo,oe)}O.render(),Ue()})},Ke=[];for(let je=0;je<fe.length;je++)Ke.push(ot(je));return Promise.all(Ke).then(function(){return ve.done=!0,Promise.resolve(L)})}else{var Je=[];W<0&&(W=0);for(let je=0,Ue=s.numWorkers;je<Ue;je++){var Xe=new Worker($3Dmol.SurfaceWorker);Je.push(Xe),Xe.postMessage({type:-1,atoms:Qe,volume:Oe})}return new Promise(function(je,Ue){var ft=0,ut=function(){!Je||!Je.length||Je.forEach(function(we){we&&we.terminate&&we.terminate()})},ee=function(we){for(var Se=(0,g.splitMesh)({vertexArr:we.data.vertices,faceArr:we.data.faces}),He=0,Be=Se.length;He<Be;He++){var K={vertices:Se[He].vertexArr,faces:Se[He].faceArr},_e=s.generateSurfaceMesh(ce,K,V);(0,b.mergeGeos)(ve.geo,_e)}O.render(),ft++,ft==fe.length&&(ve.done=!0,ut(),je(L))},ie=function(we){ut(),console.log(we.message+" ("+we.filename+":"+we.lineno+")"),Ue(we)};for(let we=0;we<fe.length;we++){var oe=Je[we%Je.length];oe.onmessage=ee,oe.onerror=ie,oe.postMessage({type:W,expandedExtent:fe[we].extent,extendedAtoms:fe[we].atoms,atomsToShow:fe[we].toshow})}})}};h=h||{},V=s.getMatWithStyle(h);var J=[];J.style=h,J.atomsel=C,J.allsel=E,J.focus=D;var le=null;if(B){var se={},he={};for(Y=0;Y<this.models.length;Y++)se[Y]=[],he[Y]=[];for(Y=0;Y<H.length;Y++)se[H[Y].model].push(H[Y]);for(Y=0;Y<U.length;Y++)he[U[Y].model].push(U[Y]);var pe=[];for(Y=0;Y<this.models.length;Y++)he[Y].length>0&&(J.push({geo:new u.Geometry(!0),mat:V,done:!1,finished:!1,symmetries:this.models[Y].getSymmetries()}),pe.push(j(J[J.length-1],se[Y],he[Y])));le=Promise.all(pe)}else J.push({geo:new u.Geometry(!0),mat:V,done:!1,finished:!1,symmetries:[new v.Matrix4]}),le=j(J[J.length-1],H,U);return this.surfaces[L]=J,le.surfid=L,z&&typeof z=="function"?(le.then(function(ve){z(ve)}),L):le}setSurfaceMaterialStyle(l,h){if((0,b.adjustVolumeStyle)(h),this.surfaces[l]){var C=this.surfaces[l];C.style=h;for(var E=0;E<C.length;E++){var D=C[E].mat=s.getMatWithStyle(h);if(C[E].mat.side=u.FrontSide,h.color){C[E].mat.color=h.color,C[E].geo.colorsNeedUpdate=!0;const z=_.CC.color(h.color);C[E].geo.setColors(function(){return z})}else if(D.voldata&&D.volscheme){const z=D.volscheme,L=D.voldata,V=_.CC,O=z.range()||[-1,1];C[E].geo.setColors(function(W,H,q){let U=L.getVal(W,H,q);return V.color(z.valueToHex(U,O))})}C[E].finished=!1}}return this}getSurface(l){return this.surfaces[l]}removeSurface(l){for(var h=this.surfaces[l],C=0;C<h.length;C++)h[C]&&h[C].lastGL&&(h[C].geo!==void 0&&h[C].geo.dispose(),h[C].mat!==void 0&&h[C].mat.dispose(),this.modelGroup.remove(h[C].lastGL));return delete this.surfaces[l],this.show(),this}removeAllSurfaces(){for(var l in this.surfaces)if(this.surfaces.hasOwnProperty(l)){for(var h=this.surfaces[l],C=0;C<h.length;C++)h[C]&&h[C].lastGL&&(h[C].geo!==void 0&&h[C].geo.dispose(),h[C].mat!==void 0&&h[C].mat.dispose(),this.modelGroup.remove(h[C].lastGL));delete this.surfaces[l]}return this.show(),this}jmolMoveTo(){var l=this.modelGroup.position,h="center { "+-l.x+" "+-l.y+" "+-l.z+" }; ",C=this.rotationGroup.quaternion;return h+="moveto .5 quaternion { "+C.x+" "+C.y+" "+C.z+" "+C.w+" };",h}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(l,h){h=h||{};var C=this.getAtomsFromSel(h);if(typeof l=="function")for(let z=0,L=C.length;z<L;z++){let V=C[z];l(V)}else for(let z=0,L=C.length;z<L;z++){var E=C[z];for(let V=0,O=l.length;V<O;V++){let W=l[V];if(W.props)for(var D in W.props)W.props.hasOwnProperty(D)&&this.atomIsSelected(E,W)&&(E.properties||(E.properties={}),E.properties[D]=W.props[D])}}return this}linkViewer(l){return this.linkedViewers.push(l),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(l){this.rotationGroup.position.z=this.CAMERA_Z-l}setAutoEyeSeparation(l,h){var C=this.getPerceivedDistance();return h||(h=5),l||this.camera.position.x>0?this.camera.position.x=C*Math.tan(Math.PI/180*h):this.camera.position.x=-C*Math.tan(Math.PI/180*h),this.camera.lookAt(new v.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(l){this.config.cartoonQuality=l}}s.numWorkers=4,s.maxVolume=64e3,s.surfaceTypeMap={VDW:P.SurfaceType.VDW,MS:P.SurfaceType.MS,SAS:P.SurfaceType.SAS,SES:P.SurfaceType.SES};function c(T,l){if(T=(0,b.getElement)(T),!!T){l=l||{};try{var h=new s(T,l);return h}catch(C){throw"error creating viewer: "+C}}}function w(T,l={},h={}){if(T=(0,b.getElement)(T),!!T){var C=[],E=document.createElement("canvas");h.rows=l.rows,h.cols=l.cols,h.control_all=l.control_all!=null?l.control_all:!1,T.appendChild(E);try{for(var D=0;D<l.rows;D++){for(var z=[],L=0;L<l.cols;L++){h.row=D,h.col=L,h.canvas=E,h.viewers=C,h.control_all=l.control_all;var V=c(T,(0,b.extend)({},h));z.push(V)}C.unshift(z)}}catch(O){throw"error creating viewer grid: "+O}return C}}function x(T){var l=this;if(T=(0,b.getElement)(T),!!T){var h=w(T,{rows:1,cols:2,control_all:!0});this.glviewer1=h[0][0],this.glviewer2=h[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var C=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(D){return typeof l.glviewer1[D]=="function"}),E=0;E<C.length;E++)this[C[E]]=(function(D){return function(){var z=this.glviewer1[D].apply(this.glviewer1,arguments),L=this.glviewer2[D].apply(this.glviewer2,arguments);return[z,L]}})(C[E]);this.setCoordinates=function(D,z,L){for(var V=0;V<D.length;V++)D[V].setCoordinates(z,L)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(D){this.glviewer1.render(),this.glviewer2.render(),D&&D(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}}),"./src/Gradient.ts":((n,t,r)=>{r.r(t),r.d(t,{CustomLinear:()=>g,Gradient:()=>P,GradientType:()=>v,ROYGB:()=>y,RWB:()=>p,Sinebow:()=>k,builtinGradients:()=>M,getGradient:()=>b,normalizeValue:()=>_});var u=r("./src/colors.ts");class v{}function _(R,S,a){return S>=R?(a<R&&(a=R),a>S&&(a=S),{lo:R,hi:S,val:a}):(a>R&&(a=R),a<S&&(a=S),a=R-a+S,{lo:S,hi:R,val:a})}function b(R){if(R instanceof v)return R;if(R.gradient!==void 0&&M[R.gradient]){let S=R.min===void 0?-1:R.min,a=R.max===void 0?1:R.max;return R.mid===void 0?R.colors===void 0?new M[R.gradient](S,a):new M[R.gradient](S,a,R.colors):new M[R.gradient](S,a,R.mid)}else if(typeof R.gradient=="string"&&R.gradient.startsWith("linear_")){let S=R.gradient.split("_");S.shift();let a=R.min===void 0?-1:R.min,s=R.max===void 0?1:R.max;return new g(a,s,S)}return R}class p extends v{constructor(S,a,s){super(),this.gradient="RWB",this.mult=1,this.mid=s,this.min=S,this.max=a,typeof a>"u"&&Array.isArray(S)&&S.length>=2?(this.max=S[1],this.min=S[0]):S&&a&&!Array.isArray(S)&&(this.min=S,this.max=a)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(S,a){var s,c;if(S=this.mult*S,a?(s=a[0],c=a[1]):(s=this.min,c=this.max),S===void 0)return 16777215;var w=_(s,c,S);s=w.lo,c=w.hi,S=w.val;var x=(c+s)/2;a&&typeof a[2]<"u"?x=a[2]:typeof this.mid<"u"?x=this.mid:x=(s+c)/2;var T,l;return S<x?(T=Math.floor(255*Math.sqrt((S-s)/(x-s))),l=16711680+256*T+T,l):S>x?(T=Math.floor(255*Math.sqrt(1-(S-x)/(c-x))),l=65536*T+256*T+255,l):16777215}}class y extends v{constructor(S,a){super(),this.gradient="ROYGB",this.mult=1,this.min=S,this.max=a,typeof a>"u"&&Array.isArray(S)&&S.length>=2?(this.max=S[1],this.min=S[0]):S&&a&&!Array.isArray(S)&&(this.min=S,this.max=a)}valueToHex(S,a){var s,c;if(S=this.mult*S,a?(s=a[0],c=a[1]):(s=this.min,c=this.max),typeof S>"u")return 16777215;var w=_(s,c,S);s=w.lo,c=w.hi,S=w.val;var x=(s+c)/2,T=(s+x)/2,l=(x+c)/2,h,C;return S<T?(h=Math.floor(255*Math.sqrt((S-s)/(T-s))),C=16711680+256*h+0,C):S<x?(h=Math.floor(255*Math.sqrt(1-(S-T)/(x-T))),C=65536*h+65280+0,C):S<l?(h=Math.floor(255*Math.sqrt((S-x)/(l-x))),C=65280+1*h,C):(h=Math.floor(255*Math.sqrt(1-(S-l)/(c-l))),C=0+256*h+255,C)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class k extends v{constructor(S,a){super(),this.gradient="Sinebow",this.mult=1,this.min=S,this.max=a,typeof a>"u"&&Array.isArray(S)&&S.length>=2&&(this.max=S[1],this.min=S[0]),a<S&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(S,a){var s,c;if(S=this.mult*S,a?(s=a[0],c=a[1]):(s=this.min,c=this.max),typeof S>"u")return 16777215;var w=P.normalizeValue(s,c,S);s=w.lo,c=w.hi,S=w.val;var x=(S-s)/(c-s),T=5*x/6+.5,l=Math.sin(Math.PI*T);l*=l*255;var h=Math.sin(Math.PI*(T+1/3));h*=h*255;var C=Math.sin(Math.PI*(T+2/3));return C*=C*255,65536*Math.floor(l)+256*Math.floor(C)+1*Math.floor(h)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class g extends v{constructor(S,a,s){super(),this.gradient="linear",this.colors=new Array;var c;if(Array.isArray(S)&&S.length>=2?(this.max=S[1],this.min=S[0],c=a):(this.min=S,this.max=a,c=s),c)for(let w of c)this.colors.push(u.CC.color(w));else this.colors.push(u.CC.color(0))}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(S,a){var s,c;if(a?(s=a[0],c=a[1]):(s=this.min,c=this.max),S===void 0)return 16777215;var w=_(s,c,S);s=w.lo,c=w.hi,S=w.val;let x=this.colors.length,T=(c-s)/x,l=Math.min(Math.floor((S-s)/T),x-1),h=Math.min(l+1,x-1),C=(S-s-l*T)/T,E=this.colors[l],D=this.colors[h];return new u.Color(E.r+C*(D.r-E.r),E.g+C*(D.g-E.g),E.b+C*(D.b-E.b)).getHex()}}const M={rwb:p,RWB:p,roygb:y,ROYGB:y,sinebow:k,linear:g};class P extends v{valueToHex(S,a){return 0}range(){return null}}P.RWB=p,P.ROYGB=y,P.Sinebow=k,P.CustomLinear=g,P.builtinGradients=M,P.normalizeValue=_,P.getGradient=b}),"./src/Label.ts":((n,t,r)=>{r.r(t),r.d(t,{Label:()=>k,LabelCount:()=>b});var u=r("./src/WebGL/index.ts"),v=r("./src/Gradient.ts"),_=r("./src/colors.ts");let b=0;function p(g,M,P,R,S,a,s){g.beginPath(),g.moveTo(M+a,P),g.lineTo(M+R-a,P),g.quadraticCurveTo(M+R,P,M+R,P+a),g.lineTo(M+R,P+S-a),g.quadraticCurveTo(M+R,P+S,M+R-a,P+S),g.lineTo(M+a,P+S),g.quadraticCurveTo(M,P+S,M,P+S-a),g.lineTo(M,P+a),g.quadraticCurveTo(M,P,M+a,P),g.closePath(),g.fill(),s&&g.stroke()}function y(g,M,P){var R=P;return typeof g<"u"&&(g instanceof _.Color?R=g.scaled():(R=_.CC.color(g),typeof R.scaled<"u"&&(R=R.scaled()))),typeof M<"u"&&(R.a=parseFloat(M)),R}class k{constructor(M,P){this.id=b++,this.stylespec=P||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new u.Sprite,this.text=M,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}setContext(){var M=this.stylespec,P=typeof M.useScreen>"u"?!1:M.useScreen,R=M.showBackground;(R==="0"||R==="false")&&(R=!1),typeof R>"u"&&(R=!0);var S=M.font?M.font:"sans-serif",a=parseInt(M.fontSize)?parseInt(M.fontSize):18,s=y(M.fontColor,M.fontOpacity,{r:255,g:255,b:255,a:1}),c=M.padding?M.padding:4,w=M.borderThickness?M.borderThickness:0,x=y(M.backgroundColor,M.backgroundOpacity,{r:0,g:0,b:0,a:1}),T=y(M.borderColor,M.borderOpacity,x),l=M.position?M.position:{x:-10,y:1,z:1},h=M.inFront!==void 0?M.inFront:!0;(h==="false"||h==="0")&&(h=!1);var C=M.alignment||u.SpriteAlignment.topLeft;typeof C=="string"&&C in u.SpriteAlignment&&(C=u.SpriteAlignment[C]);var E="";M.bold&&(E="bold "),this.context.font=E+a+"px  "+S;var D=this.context.measureText(this.text),z=D.width;R||(w=0);var L=z+2.5*w+2*c,V=a*1.25+2*w+2*c;if(M.backgroundImage){var O=M.backgroundImage,W=M.backgroundWidth?M.backgroundWidth:O.width,H=M.backgroundHeight?M.backgroundHeight:O.height;W>L&&(L=W),H>V&&(V=H)}if(this.canvas.width=L,this.canvas.height=V,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),E="",M.bold&&(E="bold "),this.context.font=E+a+"px  "+S,this.context.fillStyle="rgba("+x.r+","+x.g+","+x.b+","+x.a+")",this.context.strokeStyle="rgba("+T.r+","+T.g+","+T.b+","+T.a+")",M.backgroundGradient){let U=this.context.createLinearGradient(0,V/2,L,V/2),B=v.Gradient.getGradient(M.backgroundGradient),Y=B.range(),X=-1,j=1;Y&&(X=Y[0],j=Y[1]);let J=j-X;for(let le=0;le<1.01;le+=.1){let se=y(B.valueToHex(X+J*le)),he="rgba("+se.r+","+se.g+","+se.b+","+se.a+")";U.addColorStop(le,he)}this.context.fillStyle=U}this.context.lineWidth=w,R&&p(this.context,w,w,L-2*w,V-2*w,6,w>0),M.backgroundImage&&this.context.drawImage(O,0,0,L,V),this.context.fillStyle="rgba("+s.r+","+s.g+","+s.b+","+s.a+")",this.context.fillText(this.text,w+c,a+w+c,z);var q=new u.Texture(this.canvas);q.needsUpdate=!0,this.sprite.material=new u.SpriteMaterial({map:q,useScreenCoordinates:P,alignment:C,depthTest:!h,screenOffset:M.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(l.x,l.y,l.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}}),"./src/ProteinSurface4.ts":((n,t,r)=>{r.r(t),r.d(t,{MarchingCube:()=>y,MarchingCubeInitializer:()=>p,PointGrid:()=>k,ProteinSurface:()=>g,SurfaceType:()=>v,setSyncSurface:()=>b,syncSurface:()=>_});var u=r("./src/WebGL/math/index.ts"),v;(function(M){M[M.VDW=1]="VDW",M[M.MS=2]="MS",M[M.SAS=3]="SAS",M[M.SES=4]="SES"})(v||(v={}));var _=!1;function b(M){_=M}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&(_=!0);class p{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(P,R,S,a){let s=!!a.fulltable,c=a.hasOwnProperty("origin")&&a.origin.hasOwnProperty("x")?a.origin:{x:0,y:0,z:0},w=!!a.voxel,x=a.matrix,T=a.nX||0,l=a.nY||0,h=a.nZ||0,C=a.scale||1,E=null;a.unitCube?E=a.unitCube:E={x:C,y:C,z:C};let D=new Int32Array(T*l*h),z,L;for(z=0,L=D.length;z<L;++z)D[z]=-1;let V=function(q,U,B,Y,X,j){let J={x:0,y:0,z:0},le=!!(Y&1<<X),se=!!(Y&1<<j),he=X;if(!le&&se&&(he=j),he&1&&B++,he&2&&U++,he&4&&q++,x){let ve=new u.Vector3(q,U,B);ve=ve.applyMatrix4(x),J={x:ve.x,y:ve.y,z:ve.z}}else J.x=c.x+E.x*q,J.y=c.y+E.y*U,J.z=c.z+E.z*B;let pe=(l*q+U)*h+B;return w?(R.push(J),R.length-1):(D[pe]<0&&(D[pe]=R.length,R.push(J)),D[pe])},O=new Int32Array(12),W=s?this.edgeTable2:this.edgeTable,H=s?this.triTable2:this.triTable;for(z=0;z<T-1;++z)for(let q=0;q<l-1;++q)for(let U=0;U<h-1;++U){let B=0;for(let j=0;j<8;++j){let J=(l*(z+((j&4)>>2))+q+((j&2)>>1))*h+U+(j&1),le=!!(P[J]&this.ISDONE);B|=le<<j}if(B===0||B===255)continue;let Y=W[B];if(Y===0)continue;let X=H[B];Y&1&&(O[0]=V(z,q,U,B,0,1)),Y&2&&(O[1]=V(z,q,U,B,1,3)),Y&4&&(O[2]=V(z,q,U,B,3,2)),Y&8&&(O[3]=V(z,q,U,B,2,0)),Y&16&&(O[4]=V(z,q,U,B,4,5)),Y&32&&(O[5]=V(z,q,U,B,5,7)),Y&64&&(O[6]=V(z,q,U,B,7,6)),Y&128&&(O[7]=V(z,q,U,B,6,4)),Y&256&&(O[8]=V(z,q,U,B,0,4)),Y&512&&(O[9]=V(z,q,U,B,1,5)),Y&1024&&(O[10]=V(z,q,U,B,3,7)),Y&2048&&(O[11]=V(z,q,U,B,2,6));for(let j=0;j<X.length;j+=3){let J=O[X[j]],le=O[X[j+1]],se=O[X[j+2]];w&&j>=3&&(R.push(R[J]),J=R.length-1,R.push(R[le]),le=R.length-1,R.push(R[se]),se=R.length-1),S.push(J),S.push(le),S.push(se)}}}laplacianSmooth(P,R,S){let a=new Array(R.length),s,c,w,x,T;for(s=0,c=R.length;s<c;s++)a[s]={x:0,y:0,z:0};let l=new Array(20),h;for(s=0;s<20;s++)l[s]=new Array(R.length);for(s=0,c=R.length;s<c;s++)l[0][s]=0;for(s=0,c=S.length/3;s<c;s++){let D=s*3,z=s*3+1,L=s*3+2;for(h=!0,w=0,x=l[0][S[D]];w<x;w++)if(S[z]==l[w+1][S[D]]){h=!1;break}for(h&&(l[0][S[D]]++,l[l[0][S[D]]][S[D]]=S[z]),h=!0,w=0,x=l[0][S[D]];w<x;w++)if(S[L]==l[w+1][S[D]]){h=!1;break}for(h&&(l[0][S[D]]++,l[l[0][S[D]]][S[D]]=S[L]),h=!0,w=0,x=l[0][S[z]];w<x;w++)if(S[D]==l[w+1][S[z]]){h=!1;break}for(h&&(l[0][S[z]]++,l[l[0][S[z]]][S[z]]=S[D]),h=!0,w=0,x=l[0][S[z]];w<x;w++)if(S[L]==l[w+1][S[z]]){h=!1;break}for(h&&(l[0][S[z]]++,l[l[0][S[z]]][S[z]]=S[L]),h=!0,w=0;w<l[0][S[L]];w++)if(S[D]==l[w+1][S[L]]){h=!1;break}for(h&&(l[0][S[L]]++,l[l[0][S[L]]][S[L]]=S[D]),h=!0,w=0,x=l[0][S[L]];w<x;w++)if(S[z]==l[w+1][S[L]]){h=!1;break}h&&(l[0][S[L]]++,l[l[0][S[L]]][S[L]]=S[z])}let C=1,E=.5;for(T=0;T<P;T++){for(s=0,c=R.length;s<c;s++)if(l[0][s]<3)a[s].x=R[s].x,a[s].y=R[s].y,a[s].z=R[s].z;else if(l[0][s]==3||l[0][s]==4){for(a[s].x=0,a[s].y=0,a[s].z=0,w=0,x=l[0][s];w<x;w++)a[s].x+=R[l[w+1][s]].x,a[s].y+=R[l[w+1][s]].y,a[s].z+=R[l[w+1][s]].z;a[s].x+=E*R[s].x,a[s].y+=E*R[s].y,a[s].z+=E*R[s].z,a[s].x/=E+l[0][s],a[s].y/=E+l[0][s],a[s].z/=E+l[0][s]}else{for(a[s].x=0,a[s].y=0,a[s].z=0,w=0,x=l[0][s];w<x;w++)a[s].x+=R[l[w+1][s]].x,a[s].y+=R[l[w+1][s]].y,a[s].z+=R[l[w+1][s]].z;a[s].x+=C*R[s].x,a[s].y+=C*R[s].y,a[s].z+=C*R[s].z,a[s].x/=C+l[0][s],a[s].y/=C+l[0][s],a[s].z/=C+l[0][s]}for(s=0,c=R.length;s<c;s++)R[s].x=a[s].x,R[s].y=a[s].y,R[s].z=a[s].z}}}let y=new p;class k{constructor(P,R,S){this.data=new Int32Array(P*R*S*3),this.width=R,this.height=S}set(P,R,S,a){let s=((P*this.width+R)*this.height+S)*3;this.data[s]=a.ix,this.data[s+1]=a.iy,this.data[s+2]=a.iz}get(P,R,S){let a=((P*this.width+R)*this.height+S)*3;return{ix:this.data[a],iy:this.data[a+1],iz:this.data[a+2]}}}class g{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],g.MarchingCube||(g.MarchingCube=new p)}getVDWIndex(P){return!P.elem||typeof this.vdwRadii[P.elem]>"u"?"X":P.elem}getFacesAndVertices(P){let R={};for(let s=0,c=P.length;s<c;s++)R[P[s]]=!0;let S=this.verts;for(let s=0,c=S.length;s<c;s++)S[s].x=S[s].x/this.scaleFactor-this.ptranx,S[s].y=S[s].y/this.scaleFactor-this.ptrany,S[s].z=S[s].z/this.scaleFactor-this.ptranz;let a=[];for(let s=0,c=this.faces.length;s<c;s+=3){let w=this.faces[s],x=this.faces[s+1],T=this.faces[s+2],l=S[w].atomid,h=S[x].atomid,C=S[T].atomid,E=l;h<E&&(E=h),C<E&&(E=C),R[E]&&w!==x&&x!==T&&w!==T&&(a.push(w),a.push(x),a.push(T))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:S,faces:a}}initparm(P,R,S){S>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let a=1/this.scaleFactor*5.5;this.pminx=P[0][0],this.pmaxx=P[1][0],this.pminy=P[0][1],this.pmaxy=P[1][1],this.pminz=P[0][2],this.pmaxz=P[1][2],R?(this.pminx-=this.probeRadius+a,this.pminy-=this.probeRadius+a,this.pminz-=this.probeRadius+a,this.pmaxx+=this.probeRadius+a,this.pmaxy+=this.probeRadius+a,this.pmaxz+=this.probeRadius+a):(this.pminx-=a,this.pminy-=a,this.pminz-=a,this.pmaxx+=a,this.pmaxy+=a,this.pmaxz+=a),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(R),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(P){let R={};for(const S in this.vdwRadii){let a=this.vdwRadii[S];P?R[S]=(a+this.probeRadius)*this.scaleFactor+.5:R[S]=a*this.scaleFactor+.5;let s=R[S]*R[S];this.widxz[S]=Math.floor(R[S])+1,this.depty[S]=new Int32Array(this.widxz[S]*this.widxz[S]);let c=0;for(let w=0;w<this.widxz[S];w++)for(let x=0;x<this.widxz[S];x++){let T=w*w+x*x;if(T>s)this.depty[S][c]=-1;else{let l=Math.sqrt(s-T);this.depty[S][c]=Math.floor(l)}c++}}}fillvoxels(P,R){for(let S=0,a=this.vpBits.length;S<a;S++)this.vpBits[S]=0,this.vpDistance[S]=-1,this.vpAtomID[S]=-1;for(let S in R){let a=P[R[S]];a!==void 0&&this.fillAtom(a,P)}for(let S=0,a=this.vpBits.length;S<a;S++)this.vpBits[S]&this.INOUT&&(this.vpBits[S]|=this.ISDONE)}fillAtom(P,R){let S=Math.floor(.5+this.scaleFactor*(P.x+this.ptranx)),a=Math.floor(.5+this.scaleFactor*(P.y+this.ptrany)),s=Math.floor(.5+this.scaleFactor*(P.z+this.ptranz)),c=this.getVDWIndex(P),w=0,x=this.pWidth*this.pHeight;for(let T=0,l=this.widxz[c];T<l;T++)for(let h=0;h<l;h++){if(this.depty[c][w]!=-1){for(let C=-1;C<2;C++)for(let E=-1;E<2;E++)for(let D=-1;D<2;D++)if(C!==0&&E!==0&&D!==0){let z=C*T,L=D*h;for(let V=0;V<=this.depty[c][w];V++){let O=V*E,W=S+z,H=a+O,q=s+L;if(W<0||H<0||q<0||W>=this.pLength||H>=this.pWidth||q>=this.pHeight)continue;let U=W*x+H*this.pHeight+q;if(!(this.vpBits[U]&this.INOUT))this.vpBits[U]|=this.INOUT,this.vpAtomID[U]=P.serial;else{let B=R[this.vpAtomID[U]];if(B.serial!=P.serial){let Y=S+z-Math.floor(.5+this.scaleFactor*(B.x+this.ptranx)),X=a+O-Math.floor(.5+this.scaleFactor*(B.y+this.ptrany)),j=s+L-Math.floor(.5+this.scaleFactor*(B.z+this.ptranz));z*z+O*O+L*L<Y*Y+X*X+j*j&&(this.vpAtomID[U]=P.serial)}}}}}w++}}fillvoxelswaals(P,R){for(let S=0,a=this.vpBits.length;S<a;S++)this.vpBits[S]&=~this.ISDONE;for(let S in R){let a=P[R[S]];a!==void 0&&this.fillAtomWaals(a,P)}}fillAtomWaals(P,R){let S=0,a=Math.floor(.5+this.scaleFactor*(P.x+this.ptranx)),s=Math.floor(.5+this.scaleFactor*(P.y+this.ptrany)),c=Math.floor(.5+this.scaleFactor*(P.z+this.ptranz)),w=this.getVDWIndex(P),x=this.pWidth*this.pHeight;for(let T=0,l=this.widxz[w];T<l;T++)for(let h=0;h<l;h++){if(this.depty[w][S]!=-1){for(let C=-1;C<2;C++)for(let E=-1;E<2;E++)for(let D=-1;D<2;D++)if(C!==0&&E!==0&&D!==0){let z=C*T,L=D*h;for(let V=0;V<=this.depty[w][S];V++){let O=V*E,W=a+z,H=s+O,q=c+L;if(W<0||H<0||q<0||W>=this.pLength||H>=this.pWidth||q>=this.pHeight)continue;let U=W*x+H*this.pHeight+q;if(!(this.vpBits[U]&this.ISDONE))this.vpBits[U]|=this.ISDONE,this.vpAtomID[U]=P.serial;else{let B=R[this.vpAtomID[U]];if(B.serial!=P.serial){let Y=a+z-Math.floor(.5+this.scaleFactor*(B.x+this.ptranx)),X=s+O-Math.floor(.5+this.scaleFactor*(B.y+this.ptrany)),j=c+L-Math.floor(.5+this.scaleFactor*(B.z+this.ptranz));z*z+O*O+L*L<Y*Y+X*X+j*j&&(this.vpAtomID[U]=P.serial)}}}}}S++}}buildboundary(){let P=this.pWidth*this.pHeight;for(let R=0;R<this.pLength;R++)for(let S=0;S<this.pHeight;S++)for(let a=0;a<this.pWidth;a++){let s=R*P+a*this.pHeight+S;if(this.vpBits[s]&this.INOUT){let c=0;for(;c<26;){let w=R+this.nb[c][0],x=S+this.nb[c][2],T=a+this.nb[c][1];if(w>-1&&w<this.pLength&&T>-1&&T<this.pWidth&&x>-1&&x<this.pHeight&&!(this.vpBits[w*P+T*this.pHeight+x]&this.INOUT)){this.vpBits[s]|=this.ISBOUND;break}else c++}}}}fastdistancemap(){let P=new k(this.pLength,this.pWidth,this.pHeight),R=this.pWidth*this.pHeight,S=this.cutRadius*this.cutRadius,a=[],s=[],c;for(let T=0;T<this.pLength;T++)for(let l=0;l<this.pWidth;l++)for(let h=0;h<this.pHeight;h++)if(c=T*R+l*this.pHeight+h,this.vpBits[c]&=~this.ISDONE,this.vpBits[c]&this.INOUT&&this.vpBits[c]&this.ISBOUND){let C={ix:T,iy:l,iz:h};P.set(T,l,h,C),a.push(C),this.vpDistance[c]=0,this.vpBits[c]|=this.ISDONE,this.vpBits[c]&=~this.ISBOUND}do{s=this.fastoneshell(a,P),a=[];for(let T=0,l=s.length;T<l;T++)c=R*s[T].ix+this.pHeight*s[T].iy+s[T].iz,this.vpBits[c]&=~this.ISBOUND,this.vpDistance[c]<=1.0404*S&&a.push({ix:s[T].ix,iy:s[T].iy,iz:s[T].iz})}while(a.length!==0);a=[],s=[],P=null;let w=this.scaleFactor-.5;w<0&&(w=0);let x=S-.5/(.1+w);for(let T=0;T<this.pLength;T++)for(let l=0;l<this.pWidth;l++)for(let h=0;h<this.pHeight;h++)c=T*R+l*this.pHeight+h,this.vpBits[c]&=~this.ISBOUND,this.vpBits[c]&this.INOUT&&(!(this.vpBits[c]&this.ISDONE)||this.vpBits[c]&this.ISDONE&&this.vpDistance[c]>=x)&&(this.vpBits[c]|=this.ISBOUND)}fastoneshell(P,R){let S,a,s,c,w,x,T,l,h,C=[];if(P.length===0)return C;let E={ix:-1,iy:-1,iz:-1},D=this.pWidth*this.pHeight;for(let z=0,L=P.length;z<L;z++){S=P[z].ix,a=P[z].iy,s=P[z].iz,l=R.get(S,a,s);for(let V=0;V<6;V++)E.ix=S+this.nb[V][0],E.iy=a+this.nb[V][1],E.iz=s+this.nb[V][2],E.ix<this.pLength&&E.ix>-1&&E.iy<this.pWidth&&E.iy>-1&&E.iz<this.pHeight&&E.iz>-1&&(h=E.ix*D+this.pHeight*E.iy+E.iz,this.vpBits[h]&this.INOUT&&!(this.vpBits[h]&this.ISDONE)?(R.set(E.ix,E.iy,s+this.nb[V][2],l),c=E.ix-l.ix,w=E.iy-l.iy,x=E.iz-l.iz,T=c*c+w*w+x*x,this.vpDistance[h]=T,this.vpBits[h]|=this.ISDONE,this.vpBits[h]|=this.ISBOUND,C.push({ix:E.ix,iy:E.iy,iz:E.iz})):this.vpBits[h]&this.INOUT&&this.vpBits[h]&this.ISDONE&&(c=E.ix-l.ix,w=E.iy-l.iy,x=E.iz-l.iz,T=c*c+w*w+x*x,T<this.vpDistance[h]&&(R.set(E.ix,E.iy,E.iz,l),this.vpDistance[h]=T,this.vpBits[h]&this.ISBOUND||(this.vpBits[h]|=this.ISBOUND,C.push({ix:E.ix,iy:E.iy,iz:E.iz})))))}for(let z=0,L=P.length;z<L;z++){S=P[z].ix,a=P[z].iy,s=P[z].iz,l=R.get(S,a,s);for(let V=6;V<18;V++)E.ix=S+this.nb[V][0],E.iy=a+this.nb[V][1],E.iz=s+this.nb[V][2],E.ix<this.pLength&&E.ix>-1&&E.iy<this.pWidth&&E.iy>-1&&E.iz<this.pHeight&&E.iz>-1&&(h=E.ix*D+this.pHeight*E.iy+E.iz,this.vpBits[h]&this.INOUT&&!(this.vpBits[h]&this.ISDONE)?(R.set(E.ix,E.iy,s+this.nb[V][2],l),c=E.ix-l.ix,w=E.iy-l.iy,x=E.iz-l.iz,T=c*c+w*w+x*x,this.vpDistance[h]=T,this.vpBits[h]|=this.ISDONE,this.vpBits[h]|=this.ISBOUND,C.push({ix:E.ix,iy:E.iy,iz:E.iz})):this.vpBits[h]&this.INOUT&&this.vpBits[h]&this.ISDONE&&(c=E.ix-l.ix,w=E.iy-l.iy,x=E.iz-l.iz,T=c*c+w*w+x*x,T<this.vpDistance[h]&&(R.set(E.ix,E.iy,E.iz,l),this.vpDistance[h]=T,this.vpBits[h]&this.ISBOUND||(this.vpBits[h]|=this.ISBOUND,C.push({ix:E.ix,iy:E.iy,iz:E.iz})))))}for(let z=0,L=P.length;z<L;z++){S=P[z].ix,a=P[z].iy,s=P[z].iz,l=R.get(S,a,s);for(let V=18;V<26;V++)E.ix=S+this.nb[V][0],E.iy=a+this.nb[V][1],E.iz=s+this.nb[V][2],E.ix<this.pLength&&E.ix>-1&&E.iy<this.pWidth&&E.iy>-1&&E.iz<this.pHeight&&E.iz>-1&&(h=E.ix*D+this.pHeight*E.iy+E.iz,this.vpBits[h]&this.INOUT&&!(this.vpBits[h]&this.ISDONE)?(R.set(E.ix,E.iy,s+this.nb[V][2],l),c=E.ix-l.ix,w=E.iy-l.iy,x=E.iz-l.iz,T=c*c+w*w+x*x,this.vpDistance[h]=T,this.vpBits[h]|=this.ISDONE,this.vpBits[h]|=this.ISBOUND,C.push({ix:E.ix,iy:E.iy,iz:E.iz})):this.vpBits[h]&this.INOUT&&this.vpBits[h]&this.ISDONE&&(c=E.ix-l.ix,w=E.iy-l.iy,x=E.iz-l.iz,T=c*c+w*w+x*x,T<this.vpDistance[h]&&(R.set(E.ix,E.iy,E.iz,l),this.vpDistance[h]=T,this.vpBits[h]&this.ISBOUND||(this.vpBits[h]|=this.ISBOUND,C.push({ix:E.ix,iy:E.iy,iz:E.iz})))))}return C}marchingcubeinit(P){for(let R=0,S=this.vpBits.length;R<S;R++)P==1?this.vpBits[R]&=~this.ISBOUND:P==4?(this.vpBits[R]&=~this.ISDONE,this.vpBits[R]&this.ISBOUND&&(this.vpBits[R]|=this.ISDONE),this.vpBits[R]&=~this.ISBOUND):P==2?this.vpBits[R]&this.ISBOUND&&this.vpBits[R]&this.ISDONE?this.vpBits[R]&=~this.ISBOUND:this.vpBits[R]&this.ISBOUND&&!(this.vpBits[R]&this.ISDONE)&&(this.vpBits[R]|=this.ISDONE):P==3&&(this.vpBits[R]&=~this.ISBOUND)}marchingcube(P){this.marchingcubeinit(P),this.verts=[],this.faces=[],g.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let R=this.pWidth*this.pHeight;for(let S=0,a=this.verts.length;S<a;S++)this.verts[S].atomid=this.vpAtomID[this.verts[S].x*R+this.pHeight*this.verts[S].y+this.verts[S].z];g.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}g.MarchingCube=new p}),"./src/VolumeData.ts":((n,t,r)=>{r.r(t),r.d(t,{VolumeData:()=>y});var u=r("./src/utilities.ts"),v=r("./src/WebGL/math/index.ts"),_=r("./src/parsers/VASP.ts"),b=r("./src/parsers/CUBE.ts"),p=r("./node_modules/pako/dist/pako.esm.mjs");class y{constructor(g,M,P){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(c){var w=c/(this.size.y*this.size.z),x=c%(this.size.y*this.size.z),T=c%this.size.z;return w*=this.unit.x,x*=this.unit.y,T*=this.unit.z,w+=this.origin.x,x+=this.origin.y,T+=this.origin.z,{x:w,y:x,z:T}},this.vasp=function(c){var w=c.replace(/^\s+/,"").split(/[\n\r]/),x=(0,_.VASP)(c)[0],T=x.length;if(T==0){console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),this.data=[];return}var l=1.889725992,h=.036749309,C=parseFloat(w[1]),E;E=w[2].replace(/^\s+/,"").split(/\s+/);var D=new v.Vector3(parseFloat(E[0]),parseFloat(E[1]),parseFloat(E[2])).multiplyScalar(C*l);E=w[3].replace(/^\s+/,"").split(/\s+/);var z=new v.Vector3(parseFloat(E[0]),parseFloat(E[1]),parseFloat(E[2])).multiplyScalar(C*l);E=w[4].replace(/^\s+/,"").split(/\s+/);var L=new v.Vector3(parseFloat(E[0]),parseFloat(E[1]),parseFloat(E[2])).multiplyScalar(C*l),V=D.x*(z.y*L.z-L.y*z.z)-z.x*(D.y*L.z-L.y*D.z)+L.x*(D.y*z.z-z.y*D.z);V=Math.abs(V)/Math.pow(l,3);var O=1/V;w.splice(0,8+T+1);var W=w[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),H=Math.abs(parseFloat(W[0])),q=Math.abs(parseFloat(W[1])),U=Math.abs(parseFloat(W[2])),B=this.origin=new v.Vector3(0,0,0);this.size={x:H,y:q,z:U},this.unit=new v.Vector3(D.x,z.y,L.z),D=D.multiplyScalar(1/(l*H)),z=z.multiplyScalar(1/(l*q)),L=L.multiplyScalar(1/(l*U)),(D.y!=0||D.z!=0||z.x!=0||z.z!=0||L.x!=0||L.y!=0)&&(this.matrix=new v.Matrix4(D.x,z.x,L.x,0,D.y,z.y,L.y,0,D.z,z.z,L.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new v.Matrix4().makeTranslation(B.x,B.y,B.z)),this.origin=new v.Vector3(0,0,0),this.unit=new v.Vector3(1,1,1)),w.splice(0,1);var Y=w.join(" ");Y=Y.replace(/^\s+/,"");var X=Y.split(/[\s\r]+/);X.splice(H*q*U+1);for(var j=Float32Array.from(X,parseFloat),J=0;J<j.length;J++)j[J]=j[J]*O*h;this.data=j},this.dx=function(c){var w=c.split(/[\n\r]+/),x,T=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,l=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,h=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,C=/data follows/,E=0;for(E=0;E<w.length;E++){var D=w[E];if(x=T.exec(D)){var z=parseInt(x[1]),L=parseInt(x[2]),V=parseInt(x[3]);this.size={x:z,y:L,z:V}}else if(x=h.exec(D)){var O=parseFloat(x[1]);if((parseFloat(x[2])!=0||parseFloat(x[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),E+=1,D=w[E],x=h.exec(D),x==null){console.error("Parse error in dx delta matrix");return}var W=parseFloat(x[2]);if((parseFloat(x[1])!=0||parseFloat(x[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),E+=1,D=w[E],x=h.exec(D),x==null){console.error("Parse error in dx delta matrix");return}var H=parseFloat(x[3]);(parseFloat(x[1])!=0||parseFloat(x[2])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new v.Vector3(O,W,H)}else if(x=l.exec(D)){var q=parseFloat(x[1]),U=parseFloat(x[2]),B=parseFloat(x[3]);this.origin=new v.Vector3(q,U,B)}else if(x=C.exec(D))break}if(E+=1,!this.size||!this.origin||!this.unit||!this.size){console.error("Error parsing dx format");return}var Y=w.splice(E).join(" "),X=Y.split(/[\s\r]+/);this.data=Float32Array.from(X,parseFloat)},M=M.toLowerCase(),/\.gz$/.test(M)){M=M.replace(/\.gz$/,"");try{this[M]&&this.isbinary.has(M)?(typeof g=="string"&&(g=(0,u.base64ToArray)(g)),g=(0,p.inflate)(g)):g=new TextDecoder("utf-8").decode((0,p.inflate)(g))}catch(c){console.error(c)}}if(this[M]&&(this.isbinary.has(M)&&typeof g=="string"&&(g=(0,u.base64ToArray)(g)),this[M](g)),P){if(P.negate)for(let c=0,w=this.data.length;c<w;c++)this.data[c]=-this.data[c];if(P.normalize){var R=0;for(let c=0,w=this.data.length;c<w;c++)R+=this.data[c];var S=R/this.data.length;R=0;for(let c=0,w=this.data.length;c<w;c++){var a=this.data[c]-S;R+=a*a}var s=R/this.data.length;for(let c=0,w=this.data.length;c<w;c++)this.data[c]=(this.data[c]-S)/s}}}getIndex(g,M,P){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new v.Matrix4().getInverse(this.matrix));var R=new v.Vector3(g,M,P);R=R.applyMatrix4(this.inversematrix),g=R.x,M=R.y,P=R.z}else g-=this.origin.x,M-=this.origin.y,P-=this.origin.z,g/=this.unit.x,M/=this.unit.y,P/=this.unit.z;return g=Math.round(g),M=Math.round(M),P=Math.round(P),g<0||g>=this.size.x||M<0||M>=this.size.y||P<0||P>=this.size.z?-1:g*this.size.y*this.size.z+M*this.size.z+P}getVal(g,M,P){let R=this.getIndex(g,M,P);return R<0?0:this.data[R]}cube(g){var M=g.split(/\r?\n/);if(!(M.length<6)){var P=(0,b.CUBE)(g,{}).modelData[0].cryst,R=M[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),S=parseFloat(R[0]),a=Math.abs(S);this.origin=P.origin,this.size=P.size,this.unit=P.unit,this.matrix=P.matrix4;var s=6;S<0&&s++;var c=M.splice(a+s).join(" ");c=c.replace(/^\s+/,"");var w=c.split(/[\s\r]+/);this.data=Float32Array.from(w,parseFloat)}}ccp4(g){var M={};g=new Int8Array(g);var P=new Int32Array(g.buffer,0,56),R=new Float32Array(g.buffer,0,56),S=new DataView(g.buffer);if(M.MAP=String.fromCharCode(S.getUint8(208),S.getUint8(209),S.getUint8(210),S.getUint8(211)),M.MACHST=[S.getUint8(212),S.getUint8(213)],M.MACHST[0]===17&&M.MACHST[1]===17)for(var a=g.byteLength,s=0;s<a;s+=4)S.setFloat32(s,S.getFloat32(s),!0);M.NX=P[0],M.NY=P[1],M.NZ=P[2],M.MODE=P[3],M.NXSTART=P[4],M.NYSTART=P[5],M.NZSTART=P[6],M.MX=P[7],M.MY=P[8],M.MZ=P[9],M.xlen=R[10],M.ylen=R[11],M.zlen=R[12],M.alpha=R[13],M.beta=R[14],M.gamma=R[15],M.MAPC=P[16],M.MAPR=P[17],M.MAPS=P[18],M.DMIN=R[19],M.DMAX=R[20],M.DMEAN=R[21],M.ISPG=P[22],M.NSYMBT=P[23],M.LSKFLG=P[24],M.originX=R[49],M.originY=R[50],M.originZ=R[51],M.ARMS=R[54];var c=M,w=[c.xlen,0,0],x=[c.ylen*Math.cos(Math.PI/180*c.gamma),c.ylen*Math.sin(Math.PI/180*c.gamma),0],T=[c.zlen*Math.cos(Math.PI/180*c.beta),c.zlen*(Math.cos(Math.PI/180*c.alpha)-Math.cos(Math.PI/180*c.gamma)*Math.cos(Math.PI/180*c.beta))/Math.sin(Math.PI/180*c.gamma),0];T[2]=Math.sqrt(c.zlen*c.zlen*Math.sin(Math.PI/180*c.beta)*Math.sin(Math.PI/180*c.beta)-T[1]*T[1]);var l=[0,w,x,T],h=[0,c.MX,c.MY,c.MZ],C=[0,c.MAPC,c.MAPR,c.MAPS];this.matrix=new v.Matrix4,this.matrix.set(l[C[1]][0]/h[C[1]],l[C[2]][0]/h[C[2]],l[C[3]][0]/h[C[3]],0,l[C[1]][1]/h[C[1]],l[C[2]][1]/h[C[2]],l[C[3]][1]/h[C[3]],0,l[C[1]][2]/h[C[1]],l[C[2]][2]/h[C[2]],l[C[3]][2]/h[C[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new v.Matrix4().makeTranslation(c.NXSTART+c.originX,c.NYSTART+c.originY,c.NZSTART+c.originZ)),this.origin=new v.Vector3(0,0,0),this.unit=new v.Vector3(1,1,1),this.size={x:M.NX,y:M.NY,z:M.NZ},this.dimensionorder=[M.MAPC,M.MAPR,M.MAPS];var E=new Float32Array(g.buffer,1024+M.NSYMBT),D=M.NX,z=M.NY,L=M.NZ;this.data=new Float32Array(D*z*L);for(let V=0;V<D;V++)for(let O=0;O<z;O++)for(let W=0;W<L;W++)this.data[(V*z+O)*L+W]=E[(W*z+O)*D+V]}}}),"./src/VolumetricRender.ts":((n,t,r)=>{r.r(t),r.d(t,{GLVolumetricRender:()=>y});var u=r("./src/WebGL/shapes/index.ts"),v=r("./src/WebGL/math/index.ts"),_=r("./src/WebGL/index.ts"),b=r("./src/colors.ts"),p=r("./src/GLShape.ts");class y{static interpolateArray(g,M){function P(T,l,h){return T+(l-T)*h}var R=[],S=(g.length-1)/(M-1);R[0]=g[0];for(var a=1;a<M-1;a++){var s=a*S,c=Math.floor(s),w=Math.ceil(s),x=s-c;R[a]=P(g[c],g[w],x)}return R[M-1]=g[g.length-1],R}constructor(g,M,P){this.hidden=!1,this.boundingSphere=new u.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,M=M||{};var R=Object.assign([],M.transferfn);this.subsamples=M.subsamples||5;let S=256;R.forEach(function(z){z.value=parseFloat(z.value)}),R.sort(function(z,L){return z.value-L.value}),this.min=R[0].value,R.length==0&&R.push(R[0]),this.max=R[R.length-1].value;var a,s,c,w,x,T,l,h,C,E;for(let z=0;z<R.length-1;z++)if(c=b.CC.color(R[z].color),w=b.CC.color(R[z+1].color),C=R[z].opacity,E=R[z+1].opacity,a=Math.floor((R[z].value-this.min)*S/(this.max-this.min)),s=Math.floor((R[z+1].value-this.min)*S/(this.max-this.min)),a!=s){x=y.interpolateArray([c.r*255,w.r*255],s-a),T=y.interpolateArray([c.g*255,w.g*255],s-a),l=y.interpolateArray([c.b*255,w.b*255],s-a),h=y.interpolateArray([C*255,E*255],s-a);for(let L=0;L<x.length;L++)this.transferfunctionbuffer.push(x[L]),this.transferfunctionbuffer.push(T[L]),this.transferfunctionbuffer.push(l[L]),this.transferfunctionbuffer.push(h[L])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),g.matrix){let z=new v.Vector3(0,0,0),L=new v.Vector3(g.size.x,g.size.y,g.size.z),V=new v.Vector3(1,1,1);z.applyMatrix4(g.matrix),L.applyMatrix4(g.matrix),V.applyMatrix4(g.matrix).sub(z),this.extent=[[z.x,z.y,z.z],[L.x,L.y,L.z]];for(let q=1;q<7;q++)L.x=q&1?g.size.x:0,L.y=q&2?g.size.y:0,L.z=q&4?g.size.z:0,L.applyMatrix4(g.matrix),this.extent[0][0]=Math.min(this.extent[0][0],L.x),this.extent[0][1]=Math.min(this.extent[0][1],L.y),this.extent[0][2]=Math.min(this.extent[0][2],L.z),this.extent[1][0]=Math.max(this.extent[1][0],L.x),this.extent[1][1]=Math.max(this.extent[1][1],L.y),this.extent[1][2]=Math.max(this.extent[1][2],L.z);let O=L.x-z.x,W=L.y-z.y,H=L.z-z.z;this.maxdepth=Math.sqrt(O*O+W*W+H*H),this.minunit=Math.min(Math.min(V.x,V.y),V.z),this.texmatrix=new v.Matrix4().identity().scale({x:g.size.x,y:g.size.y,z:g.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(g.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new v.Matrix4().identity();let z=g.unit.x*g.size.x,L=g.unit.y*g.size.y,V=g.unit.z*g.size.z;this.texmatrix.makeTranslation(-g.origin.x/z,-g.origin.y/L,-g.origin.z/V),this.texmatrix.scale({x:1/z,y:1/L,z:1/V}),this.minunit=Math.min(Math.min(g.unit.x,g.unit.y),g.unit.z),this.extent=[[g.origin.x,g.origin.y,g.origin.z],[g.origin.x+z,g.origin.y+L,g.origin.z+V]],this.maxdepth=Math.sqrt(z*z+L*L+V*V)}var D=new p.GLShape({});if(D.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=D.finalize(),this.boundingSphere.center=new v.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,M.coords===void 0&&M.selection!==void 0&&(P?M.coords=P.selectedAtoms(M.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),M.coords!==void 0&&M.seldist!==void 0){let z=new Uint8Array(g.data.length),L=M.seldist,V=L*L;for(let O=0,W=M.coords.length;O<W;O++){let H=M.coords[O],q=H.x-L,U=H.y-L,B=H.z-L,Y=H.x+L,X=H.y+L,j=H.z+L;if(g.getIndex(q,U,B)>=0||g.getIndex(Y,X,j)>=0)for(let J=q;J<Y;J+=this.minunit)for(let le=U;le<X;le+=this.minunit)for(let se=B;se<j;se+=this.minunit){let he=g.getIndex(J,le,se);he>=0&&!z[he]&&(J-H.x)*(J-H.x)+(le-H.y)*(le-H.y)+(se-H.z)*(se-H.z)<V&&(z[he]=1)}}for(let O=0,W=g.data.length;O<W;O++)z[O]==0&&(g.data[O]=1/0)}this.data=g}globj(g){if(this.renderedShapeObj&&(g.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new _.Object3D;var M=null,P=new _.Texture(this.data,!0),R=new _.Texture(this.transferfunctionbuffer,!1);P.needsUpdate=!0,R.needsUpdate=!0,R.flipY=!1,M=new _.VolumetricMaterial({transferfn:R,transfermin:this.min,transfermax:this.max,map:P,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var S=new _.Mesh(this.geo,M);this.shapeObj.add(S),this.renderedShapeObj=this.shapeObj.clone(),g.add(this.renderedShapeObj)}}removegl(g){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),g.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}}),"./src/WebGL/Camera.ts":((n,t,r)=>{r.r(t),r.d(t,{Camera:()=>_});var u=r("./src/WebGL/core/index.ts"),v=r("./src/WebGL/math/index.ts");class _ extends u.Object3D{constructor(p=50,y=1,k=.1,g=2e3,M=!1){super(),this.projectionMatrix=new v.Matrix4,this.projectionMatrixInverse=new v.Matrix4,this.matrixWorldInverse=new v.Matrix4,this.fov=p,this.aspect=y,this.near=k,this.far=g;var P=this.position.z;this.right=P*Math.tan(Math.PI/180*p),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!M,this.updateProjectionMatrix()}lookAt(p){this.matrix.lookAt(this.position,p,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof v.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}}),"./src/WebGL/Fog.ts":((n,t,r)=>{r.r(t),r.d(t,{Fog:()=>v});var u=r("./src/colors.ts");class v{constructor(b,p=1,y=1e3){this.name="",this.color=new u.Color(b),this.near=p,this.far=y}clone(){return new v(this.color.getHex(),this.near,this.far)}}}),"./src/WebGL/Renderer.ts":((n,t,r)=>{r.r(t),r.d(t,{Renderer:()=>R});var u=r("./src/WebGL/Camera.ts"),v=r("./src/WebGL/constants/Sides.ts"),_=r("./src/WebGL/constants/TextureConstants.ts"),b=r("./src/WebGL/core/index.ts"),p=r("./src/colors.ts"),y=r("./src/WebGL/materials/index.ts"),k=r("./src/WebGL/math/index.ts"),g=r("./src/WebGL/objects/index.ts"),M=r("./src/WebGL/shaders/index.ts"),P=r("./src/WebGL/SpritePlugin.ts");class R{constructor(a){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new k.Vector3,this._worldInverse=new k.Matrix4,this._projInverse=new k.Matrix4,this._textureMatrix=new k.Matrix4,this._fullProjModelMatrix=new k.Matrix4,this._fullProjModelMatrixInv=new k.Matrix4,this._direction=new k.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new P.SpritePlugin,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,a=a||{},this.row=a.row,this.col=a.col,this.rows=a.rows,this.cols=a.cols,this._canvas=a.canvas!==void 0?a.canvas:document.createElement("canvas"),this._precision=a.precision!==void 0?a.precision:"highp",this._alpha=a.alpha!==void 0?a.alpha:!0,this._premultipliedAlpha=a.premultipliedAlpha!==void 0?a.premultipliedAlpha:!0,this._antialias=a.antialias!==void 0?a.antialias:!1,this._preserveDrawingBuffer=a.preserveDrawingBuffer!==void 0?a.preserveDrawingBuffer:!1,this._clearColor=a.clearColor!==void 0?new p.Color(a.clearColor):new p.Color(0),this._clearAlpha=a.clearAlpha!==void 0?a.clearAlpha:0,this._outlineMaterial=new y.MeshOutlineMaterial(a.outline),this._outlineSphereImposterMaterial=new y.SphereImposterOutlineMaterial(a.outline),this._outlineStickImposterMaterial=new y.StickImposterOutlineMaterial(a.outline),this._outlineEnabled=!!a.outline,this._AOEnabled=!!a.ambientOcclusion,a.ambientOcclusion&&typeof a.ambientOcclusion.strength<"u"&&(this._AOstrength=parseFloat(a.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),a.ambientOcclusion&&typeof a.ambientOcclusion.radius<"u"&&(this._AOradius=parseFloat(a.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=a.id,!(a.containerWidth==0||a.containerHeight==0)&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(a,s){this._clearColor.setHex(a),this._clearAlpha=s,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(a){this._outlineMaterial=new y.MeshOutlineMaterial(a),this._outlineSphereImposterMaterial=new y.SphereImposterOutlineMaterial(a),this._outlineStickImposterMaterial=new y.StickImposterOutlineMaterial(a),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(a){a&&(a.strength&&(this._AOstrength=a.strength),a.scale&&(this._AOradius=a.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var a=this._canvas.width/this.cols,s=this._canvas.height/this.rows;this._viewportWidth=a,this._viewportHeight=s,this.isLost()||(this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(a*this.col,s*this.row,a,s),this._gl.viewport(a*this.col,s*this.row,a,s))}}setSize(a,s){if(this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._antialias&&this.devicePixelRatio<2&&(this.devicePixelRatio*=2),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var c=a/this.cols,w=s/this.rows;this._canvas.width=a*this.devicePixelRatio,this._canvas.height=s*this.devicePixelRatio,this._viewportWidth=c*this.devicePixelRatio,this._viewportHeight=w*this.devicePixelRatio,this._canvas.style.width=a+"px",this._canvas.style.height=s+"px",this.setViewport()}else this._viewportWidth=this._canvas.width=a*this.devicePixelRatio,this._viewportHeight=this._canvas.height=s*this.devicePixelRatio,this._canvas.style.width=a+"px",this._canvas.style.height=s+"px",this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight);this.initFrameBuffer()}clear(a,s,c){var w=0;(a===void 0||a)&&(w|=this._gl.COLOR_BUFFER_BIT),(s===void 0||s)&&(w|=this._gl.DEPTH_BUFFER_BIT),(c===void 0||c)&&(w|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(w)}setMaterialFaces(a,s){var c=a.side===v.DoubleSide,w=a.side===v.BackSide;a.imposter||(w=s?!w:w),this._oldDoubleSided!==c&&(c?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=c),this._oldFlipSided!==w&&(w?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=w),this._gl.cullFace(this._gl.BACK)}setDepthTest(a){this._oldDepthTest!==a&&(a?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=a)}setDepthWrite(a){this._oldDepthWrite!==a&&(this._gl.depthMask(a),this._oldDepthWrite=a)}setBlending(a){a?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(a,s,c,w){a.addEventListener("dispose",this.onMaterialDispose.bind(this));var x,T;if(T=a.shaderID,T){var l=M.ShaderLib[T];a.vertexShader=l.vertexShader,a.fragmentShader=l.fragmentShader,a.uniforms=M.ShaderUtils.clone(l.uniforms),a.shaded&&a.makeShaded(this.SHADE_TEXTURE)}x={wireframe:a.wireframe,fragdepth:a.imposter,volumetric:a.volumetric,shaded:a.shaded},a.program=this.buildProgram(a.fragmentShader,a.vertexShader,a.uniforms,x)}renderBuffer(a,s,c,w,x,T){if(w.visible){var l,h;if(l=this.setProgram(a,s,c,w,T,this),!!l){h=l.attributes;var C=!1,E=w.wireframe?1:0,D=x.id*16777215+l.id*2+E;D!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=D,C=!0),C&&(this.disableAttributes(),h.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglVertexBuffer),this.enableAttribute(h.position),this._gl.vertexAttribPointer(h.position,3,this._gl.FLOAT,!1,0,0)),h.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglColorBuffer),this.enableAttribute(h.color),this._gl.vertexAttribPointer(h.color,3,this._gl.FLOAT,!1,0,0)),h.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglNormalBuffer),this.enableAttribute(h.normal),this._gl.vertexAttribPointer(h.normal,3,this._gl.FLOAT,!1,0,0)),h.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglOffsetBuffer),this.enableAttribute(h.offset),this._gl.vertexAttribPointer(h.offset,3,this._gl.FLOAT,!1,0,0)),h.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglRadiusBuffer),this.enableAttribute(h.radius),this._gl.vertexAttribPointer(h.radius,1,this._gl.FLOAT,!1,0,0)));var z,L;if(T instanceof g.Mesh){if(w.shaderID==="instanced"){var V=w.sphere.geometryGroups[0];C&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,V.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,V.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,x.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,V.faceArray,this._gl.STATIC_DRAW)),z=V.faceidx,this._extInstanced.vertexAttribDivisorANGLE(h.offset,1),this._extInstanced.vertexAttribDivisorANGLE(h.radius,1),this._extInstanced.vertexAttribDivisorANGLE(h.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,z,this._gl.UNSIGNED_SHORT,0,x.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(h.offset,0),this._extInstanced.vertexAttribDivisorANGLE(h.radius,0),this._extInstanced.vertexAttribDivisorANGLE(h.color,0)}else w.wireframe?(L=x.lineidx,this.setLineWidth(w.wireframeLinewidth),C&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,x.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,L,this._gl.UNSIGNED_SHORT,0)):(z=x.faceidx,C&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,x.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,z,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=z,this.info.render.faces+=z/3}else T instanceof g.Line&&(L=x.vertices,this.setLineWidth(w.linewidth),this._gl.drawArrays(this._gl.LINES,0,L),this.info.render.calls++)}}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(a,s,c){let w=a.__lights,x=a.fog,T=[];for(let C=0,E=a.__webglObjects.length;C<E;C++){let D=a.__webglObjects[C];D.render&&D[c]&&T.push(D)}if(T.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(a.__webglObjects,!0,c+"Depth",s,w,x,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let l=this._AOshader.uniforms;this._gl.uniform1f(l.total_strength,this._AOstrength),this._gl.uniform1f(l.radius,this._AOradius),this._fullProjModelMatrix=new k.Matrix4,this._fullProjModelMatrixInv=new k.Matrix4;let h=T[0].object;this._fullProjModelMatrix.multiplyMatrices(s.projectionMatrix,h._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(l.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(l.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(a,s){if(!(s instanceof u.Camera)){console.error("Renderer.render: camera is not an instance of Camera.");return}var c,w,x,T,l,h=a.__lights,C=a.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&a.updateMatrixWorld(),s.parent===void 0&&s.updateMatrixWorld(),s.matrixWorldInverse.getInverse(s.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(a),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),l=a.__webglObjects;let E=!1,D=this._AOEnabled;for(c=0,w=l.length;c<w;c++)x=l[c],T=x.object,x.render=!1,T.visible&&(this.setupMatrices(T,s),this.unrollBufferMaterial(x),x.render=!0,x.volumetric&&(E=!0),x.hasAO&&(D=!0));this.setBlending(!1),D&&this.setShading(a,s,"opaque"),this.renderObjects(a.__webglObjects,!0,"opaque",s,h,C,!1),D&&this.clearShading(),this.renderSprites(a,s,!1),this.renderObjects(a.__webglObjects,!0,"transparentDepth",s,h,C,!0),this.renderObjects(a.__webglObjects,!1,"transparent",s,h,C,!0),E&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(a.__webglObjects,!1,"volumetric",s,h,C,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(a,s,!0)}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let a=this._viewportWidth,s=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,a,s),this._gl.viewport(0,0,a,s),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,a,s,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,a,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,a,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,a,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let a=this._viewportWidth,s=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,a,s),this._gl.viewport(0,0,a,s),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var c=this._antialias?M.ShaderLib.screenaa:M.ShaderLib.screen;this._screenshader=this.buildProgram(c.fragmentShader,c.vertexShader,c.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition");var w=[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1];this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(w),this._gl.STATIC_DRAW);let x=M.ShaderLib.ssao;this._AOshader=this.buildProgram(x.fragmentShader,x.vertexShader,x.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let T=M.ShaderLib.blur;this._blurshader=this.buildProgram(T.fragmentShader,T.vertexShader,T.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(a){if(a.__webglObjects||(a.__webglObjects=[],a.__webglObjectsImmediate=[],a.__webglSprites=[],a.__webglFlares=[]),a.__objectsAdded.length){for(;a.__objectsAdded.length;)this.addObject(a.__objectsAdded[0],a),a.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;a.__objectsRemoved.length;)this.removeObject(a.__objectsRemoved[0],a),a.__objectsRemoved.splice(0,1);for(var s=0,c=a.__webglObjects.length;s<c;s++)this.updateObject(a.__webglObjects[s].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(a,s){(a==null||s==null)&&(a=this._canvas.width,s=this._canvas.height);var c=a/s;if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var w=a/this.cols,x=s/this.rows;c=w/x}return c}setTexture(a,s,c){if(a.needsUpdate){a.__webglInit||(a.__webglInit=!0,a.addEventListener("dispose",this.onTextureDispose.bind(this)),a.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+s);var w=c?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(w,a.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,a.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,a.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,a.unpackAlignment);var x=this.paramToGL(a.format),T=this.paramToGL(a.type);if(c)this.setTextureParameters(this._gl.TEXTURE_3D,a),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,a.image.size.z,a.image.size.y,a.image.size.x,0,this._gl.RED,this._gl.FLOAT,a.image.data);else{var l=a.image,h=l.width,C=l.height;typeof h>"u"&&(h=l.length,x==this._gl.RGBA&&(h/=4),C=1),this.setTextureParameters(this._gl.TEXTURE_2D,a),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,x,x,T,a.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,x,h,C,0,x,T,a.image)}a.needsUpdate=!1,a.onUpdate&&a.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+s),c?this._gl.bindTexture(this._gl.TEXTURE_3D,a.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,a.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(a){this._enabledAttributes[a]||(this._gl.enableVertexAttribArray(a),this._enabledAttributes[a]=!0)}disableAttributes(){for(let a in this._enabledAttributes)this._enabledAttributes[a]&&(this._gl.disableVertexAttribArray(a),this._enabledAttributes[a]=!1)}setPolygonOffset(a,s,c){this._oldPolygonOffset!==a&&(a?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(a){a!==this._oldLineWidth&&(this._gl.lineWidth(a),this._oldLineWidth=a)}deallocateGeometry(a){if(a.__webglInit=void 0,a.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(a.__webglVertexBuffer),a.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(a.__webglColorBuffer),a.geometryGroups!==void 0)for(var s=0,c=a.groups;s<c;s++){var w=a.geometryGroups[s];w.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(w.__webglVertexBuffer),w.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(w.__webglColorBuffer),w.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(w.__webglNormalBuffer),w.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(w.__webglFaceBuffer),w.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(w.__webglLineBuffer)}}deallocateMaterial(a){var s=a.program;if(s!==void 0){a.program=void 0;var c,w,x,T=!1;for(c=0,w=this._programs.length;c<w;c++)if(x=this._programs[c],x.program===s){x.usedTimes--,x.usedTimes===0&&(T=!0);break}if(T===!0){var l=[];for(c=0,w=this._programs.length;c<w;c++)x=this._programs[c],x.program!==s&&l.push(x);this._programs=l,this._gl.deleteProgram(s),this.info.memory.programs--}}}deallocateTexture(a){if(a.image&&a.image.__webglTextureCube)this._gl.deleteTexture(a.image.__webglTextureCube);else{if(!a.__webglInit)return;a.__webglInit=!1,this._gl.deleteTexture(a.__webglTexture)}}onGeometryDispose(a){var s=a.target;s.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(s),this.info.memory.geometries--}onTextureDispose(a){var s=a.target;s.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(s),this.info.memory.textures--}onMaterialDispose(a){var s=a.target;s.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(s)}getShader(a,s){var c;return!this.isWebGL1()&&!s.startsWith("#version")&&(s=s.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),a=="fragment"?s=s.replace(/varying/g,"in"):s=s.replace(/varying/g,"out"),s=s.replace(/attribute/g,"in"),s=s.replace(/texture2D/g,"texture"),s=s.replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;"),s=s.replace(/gl_FragColor/g,"glFragColor"),s=`#version 300 es
`+s),a==="fragment"?c=this._gl.createShader(this._gl.FRAGMENT_SHADER):a==="vertex"&&(c=this._gl.createShader(this._gl.VERTEX_SHADER)),c==null?null:(this._gl.shaderSource(c,s),this._gl.compileShader(c),this._gl.getShaderParameter(c,this._gl.COMPILE_STATUS)?c:(console.error(this._gl.getShaderInfoLog(c)),console.error("could not initialize shader"),null))}buildProgram(a,s,c,w){var x,T,l,h,C=[];C.push(a),C.push(s);for(x in w)C.push(x),C.push(w[x]);for(h=C.join(),x=0,T=this._programs.length;x<T;x++){var E=this._programs[x];if(E.code===h)return E.usedTimes++,E.program}if(this.isWebGL1()&&w.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if(l=this._gl.createProgram(),l==null)return null;var D=this._precision,z="precision "+D+" float;",L=[w.volumetric?"#version 300 es":"",z].join(`
`),V=[w.volumetric?"#version 300 es":"",w.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",w.shaded?"#define SHADED 1":"",w.wireframe?"#define WIREFRAME 1":"",z].join(`
`),O=this.getShader("fragment",V+a),W=this.getShader("vertex",L+s);W!=null&&this._gl.attachShader(l,W),O!=null&&this._gl.attachShader(l,O),this._gl.linkProgram(l),this._gl.getProgramParameter(l,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),l.uniforms={},l.attributes={};var H,q,U;H=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix"];for(q in c)H.push(q);for(U=0;U<H.length;U++){var B=H[U];l.uniforms[B]=this._gl.getUniformLocation(l,B)}for(H=["position","normal","color","lineDistance","offset","radius"],U=0;U<H.length;U++){var Y=H[U];l.attributes[Y]=this._gl.getAttribLocation(l,Y)}return l.id=this._programs_counter++,this._programs.push({program:l,code:h,usedTimes:1}),this.info.memory.programs=this._programs.length,l}setProgram(a,s,c,w,x,T){if(w.needsUpdate&&(w.program&&this.deallocateMaterial(w),this.initMaterial(w,s,c,x),w.needsUpdate=!1),w.program==null)return null;var l=!1,h=w.program,C=h.uniforms,E=w.uniforms;if(h!=this._currentProgram&&(this._gl.useProgram(h),this._currentProgram=h,l=!0),w.id!=this._currentMaterialId&&(this._currentMaterialId=w.id,l=!0),a!=this._currentCamera&&(this._currentCamera=a,l=!0),C.projectionMatrix&&this._gl.uniformMatrix4fv(C.projectionMatrix,!1,a.projectionMatrix.elements),C.modelViewMatrix&&this._gl.uniformMatrix4fv(C.modelViewMatrix,!1,x._modelViewMatrix.elements),C.normalMatrix&&this._gl.uniformMatrix3fv(C.normalMatrix,!1,x._normalMatrix.elements),C.projinv&&(this._projInverse.getInverse(a.projectionMatrix),this._gl.uniformMatrix4fv(C.projinv,!1,this._projInverse.elements)),C.viewMatrix&&this._gl.uniformMatrix4fv(C.viewMatrix,!1,a.matrixWorldInverse.elements),l){if(E.fogColor.value=c.color,E.fogNear.value=c.near,E.fogFar.value=c.far,w.shaderID.startsWith("lambert")||w.shaderID==="instanced"||w.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(h,s),this._lightsNeedUpdate=!1),E.directionalLightColor.value=this._lights.directional.colors,E.directionalLightDirection.value=this._lights.directional.positions;else if(w.shaderID.endsWith("outline"))E.outlineColor.value=w.outlineColor,E.outlineWidth.value=w.outlineWidth,E.outlinePushback.value=w.outlinePushback;else if(w.shaderID==="volumetric"){x._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(x._modelViewMatrix),this._projInverse.getInverse(a.projectionMatrix),this._textureMatrix.multiplyMatrices(x.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(C.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(C.projinv,!1,this._projInverse.elements);let D=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);E.step.value=x.material.unit*D,E.maxdepth.value=x.material.maxdepth*D,E.transfermax.value=x.material.transfermax,E.transfermin.value=x.material.transfermin,E.subsamples.value=x.material.subsamples,T.setTexture(x.material.transferfn,4,!1),T.setTexture(x.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}E.opacity.value=w.opacity,this.loadMaterialUniforms(C,E)}return E.shading&&(E.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),h}loadMaterialUniforms(a,s){var c,w,x,T;for(c in s)a[c]&&(w=s[c].type,x=s[c].value,T=a[c],w==="f"?this._gl.uniform1f(T,x):w==="i"?this._gl.uniform1i(T,x):w==="fv"?this._gl.uniform3fv(T,x):w==="c"?this._gl.uniform3f(T,x.r,x.g,x.b):w==="f4"&&this._gl.uniform4f(T,x[0],x[1],x[2],x[3]))}addObject(a,s){var c,w,x,T;if(!a.__webglInit&&(a.__webglInit=!0,a._modelViewMatrix=new k.Matrix4,a._normalMatrix=new k.Matrix3,a.geometry!==void 0&&a.geometry.__webglInit===void 0&&(a.geometry.__webglInit=!0,a.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),a instanceof g.Mesh||a instanceof g.Line))for(x=a.geometry,c=0,w=x.geometryGroups.length;c<w;c++)T=x.geometryGroups[c],T.id=this._geometryGroupCounter++,T.__webglVertexBuffer||(a instanceof g.Mesh?(this.createMeshBuffers(T),x.elementsNeedUpdate=!0,x.normalsNeedUpdate=!0):a instanceof g.Line&&this.createLineBuffers(T),x.verticesNeedUpdate=!0,x.colorsNeedUpdate=!0);if(!a.__webglActive){if(a instanceof g.Mesh||a instanceof g.Line)for(x=a.geometry,c=0,w=x.geometryGroups.length;c<w;c++)T=x.geometryGroups[c],this.addBuffer(s.__webglObjects,T,a);else a instanceof g.Sprite&&s.__webglSprites.push(a);a.__webglActive=!0}}updateObject(a){var s=a.geometry,c;if(a instanceof g.Mesh||a instanceof g.Line){for(var w=0,x=s.geometryGroups.length;w<x;w++)c=s.geometryGroups[w],(s.verticesNeedUpdate||s.elementsNeedUpdate||s.colorsNeedUpdate||s.normalsNeedUpdate)&&this.setBuffers(c,this._gl.STATIC_DRAW);s.verticesNeedUpdate=!1,s.elementsNeedUpdate=!1,s.normalsNeedUpdate=!1,s.colorsNeedUpdate=!1,s.buffersNeedUpdate=!1}}removeObject(a,s){a instanceof g.Mesh||a instanceof g.Line?this.removeInstances(s.__webglObjects,a):a instanceof g.Sprite&&this.removeInstancesDirect(s.__webglSprites,a),a.__webglActive=!1}removeInstances(a,s){for(var c=a.length-1;c>=0;--c)a[c].object===s&&a.splice(c,1)}removeInstancesDirect(a,s){for(var c=a.length-1;c>=0;--c)a[c]===s&&a.splice(c,1)}unrollBufferMaterial(a){var s=a.object,c=s.material;if(c.volumetric)a.opaque=null,a.transparent=null,a.volumetric=c;else if(c.transparent){if(a.opaque=null,a.volumetric=null,a.transparent=c,!c.wireframe){let w=c.clone();w.opacity=0,a.transparentDepth=w}}else{if(a.opaque=c,a.transparent=null,a.volumetric=null,!c.wireframe){let w=c.clone();w.opacity=0,a.opaqueDepth=w}c.hasAO&&(a.hasAO=!0),(this._AOEnabled||a.hasAO)&&(a.opaqueShaded=c.clone(),a.opaqueShaded.shaded=!0)}}setBuffers(a,s){var c=a.vertexArray,w=a.colorArray;if(a.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,a.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,c,s)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,a.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,c,s)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,a.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,w,s),a.normalArray&&a.__webglNormalBuffer!==void 0){var x=a.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,a.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,x,s)}if(a.radiusArray&&a.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,a.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,a.radiusArray,s)),a.faceArray&&a.__webglFaceBuffer!==void 0){var T=a.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,a.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,T,s)}if(a.lineArray&&a.__webglLineBuffer!==void 0){var l=a.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,a.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,l,s)}}createMeshBuffers(a){a.radiusArray&&(a.__webglRadiusBuffer=this._gl.createBuffer()),a.useOffset&&(a.__webglOffsetBuffer=this._gl.createBuffer()),a.__webglVertexBuffer=this._gl.createBuffer(),a.__webglNormalBuffer=this._gl.createBuffer(),a.__webglColorBuffer=this._gl.createBuffer(),a.__webglFaceBuffer=this._gl.createBuffer(),a.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(a){a.__webglVertexBuffer=this._gl.createBuffer(),a.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(a,s,c){a.push({buffer:s,object:c,opaque:null,transparent:null})}setupMatrices(a,s){a._modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,a.matrixWorld),a._normalMatrix.getInverse(a._modelViewMatrix),a._normalMatrix.transpose()}filterFallback(a){return this._gl.LINEAR}setTextureParameters(a,s){a==this._gl.TEXTURE_2D?(this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(a,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(s.magFilter)),this._gl.texParameteri(a,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(s.minFilter))):(this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(a,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(a,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(a,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(a,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(a){return a===_.UnsignedByteType?this._gl.UNSIGNED_BYTE:a===_.RGBAFormat?this._gl.RGBA:a===_.NearestFilter?this._gl.NEAREST:0}setupLights(a,s){var c,w,x,T=0,l=0,h=0,C,E,D=this._lights,z=D.directional.colors,L=D.directional.positions,V=0,O=0;for(c=0,w=s.length;c<w;c++)if(x=s[c],C=x.color,E=x.intensity,x instanceof b.Light){if(this._direction.getPositionFromMatrix(x.matrixWorld),this._vector3.getPositionFromMatrix(x.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;L[O]=this._direction.x,L[O+1]=this._direction.y,L[O+2]=this._direction.z,z[O]=C.r*E,z[O+1]=C.g*E,z[O+2]=C.b*E,O+=3,V++}D.ambient[0]=T,D.ambient[1]=l,D.ambient[2]=h,D.directional.length=V}initGL(){try{if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context.";var a=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(a[6])}catch(s){console.error(s)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearColor(0,0,0,1),this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(a,s,c,w,x,T,l){var h,C,E,D,z,L,V;s?(z=a.length-1,L=-1,V=-1):(z=0,L=a.length,V=1);for(var O=z;O!==L;O+=V)if(h=a[O],h.render){if(C=h.object,E=h.buffer,D=h[c],(h.hasAO||this._AOEnabled)&&h[c+"Shaded"]&&(D=h[c+"Shaded"]),!D)continue;l&&this.setBlending(!0),this.setDepthTest(D.depthTest),this.setDepthWrite(D.depthWrite),this.setPolygonOffset(D.polygonOffset,D.polygonOffsetFactor,D.polygonOffsetUnits);var W=C._modelViewMatrix.isReflected();if(this.setMaterialFaces(D,W),this.renderBuffer(w,x,T,D,E,C),(this._outlineEnabled||D.outline)&&!D.wireframe&&D.shaderID!=="basic"&&D.opacity!==0){let H=this._outlineMaterial;D.shaderID=="sphereimposter"?H=this._outlineSphereImposterMaterial:D.shaderID=="stickimposter"&&(H=this._outlineStickImposterMaterial),this.renderBuffer(w,x,T,H,E,C)}}}renderSprites(a,s,c){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(a,s,this._currentWidth,this._currentHeight,c),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}}),"./src/WebGL/SpritePlugin.ts":((n,t,r)=>{r.r(t),r.d(t,{SpritePlugin:()=>v});var u=r("./src/WebGL/shaders/index.ts");class v{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(p){this.gl=p.context,this.renderer=p,this.precision=p.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var y=0;this.sprite.vertices[y++]=-1,this.sprite.vertices[y++]=-1,this.sprite.vertices[y++]=0,this.sprite.vertices[y++]=0,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=-1,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=0,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=-1,this.sprite.vertices[y++]=1,this.sprite.vertices[y++]=0,this.sprite.vertices[y++]=1,y=0,this.sprite.faces[y++]=0,this.sprite.faces[y++]=1,this.sprite.faces[y++]=2,this.sprite.faces[y++]=0,this.sprite.faces[y++]=2,this.sprite.faces[y++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(u.ShaderLib.sprite,this.precision||1),this.sprite.attributes={};const k={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),k.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),k.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),k.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),k.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),k.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),k.color=this.gl.getUniformLocation(this.sprite.program,"color"),k.map=this.gl.getUniformLocation(this.sprite.program,"map"),k.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),k.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),k.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),k.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),k.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),k.fogType=this.gl.getUniformLocation(this.sprite.program,"fogType"),k.fogDensity=this.gl.getUniformLocation(this.sprite.program,"fogDensity"),k.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),k.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),k.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),k.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=k}render(p,y,k,g,M){var P,R,S,a,s,c,w,x,T,l;if(!this.gl)throw new Error("WebGLRenderer not initialized");let h=[];(P=p?.__webglSprites)===null||P===void 0||P.forEach(le=>{(M&&le.material.depthTest==!1||!M&&le.material.depthTest)&&h.push(le)});let C=h.length;if(!C)return;const E=this.sprite.attributes,D=this.sprite.uniforms;if(!D)throw new Error("Uniforms not defined");var z=k*.5,L=g*.5;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(E.position),this.gl.enableVertexAttribArray(E.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(E.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(E.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(D.projectionMatrix,!1,y.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(D.map,0);var V=0,O=0,W=p.fog;W?(this.gl.uniform3f(D.fogColor,W.color.r,W.color.g,W.color.b),this.gl.uniform1f(D.fogNear,W.near),this.gl.uniform1f(D.fogFar,W.far),this.gl.uniform1i(D.fogType,1),V=1,O=1):(this.gl.uniform1i(D.fogType,0),V=0,O=0);var H;let q,U,B,Y,X=[];for(H=0;H<C;H++)q=h[H],U=q.material,U&&(U.depthTest==!1&&!M||!q.visible||U.opacity===0||(U.useScreenCoordinates?q.z=-q.position.z:(q._modelViewMatrix.multiplyMatrices(y.matrixWorldInverse,q.matrixWorld),q.z=-q._modelViewMatrix.elements[14])));for(h.sort(_),H=0;H<C;H++)if(q=h[H],U=q.material,!!U&&!(!q.visible||U.opacity===0)&&U.map&&U.map.image&&U.map.image.width){this.gl.uniform1f(D?.alphaTest||null,U.alphaTest);var j=U.map.image.width,J=U.map.image.height;X[0]=j*this.renderer.devicePixelRatio/k,X[1]=J*this.renderer.devicePixelRatio/g,U.useScreenCoordinates===!0?(this.gl.uniform1i(D.useScreenCoordinates,1),this.gl.uniform3f(D.screenPosition,(q.position.x*this.renderer.devicePixelRatio-z)/z,(L-q.position.y*this.renderer.devicePixelRatio)/L,Math.max(0,Math.min(1,q.position.z)))):(this.gl.uniform1i(D.useScreenCoordinates,0),this.gl.uniformMatrix4fv(D.modelViewMatrix,!1,q._modelViewMatrix.elements)),p.fog&&U.fog?Y=O:Y=0,V!==Y&&(this.gl.uniform1i(D.fogType,Y),V=Y),B=1/(U.scaleByViewport?g:1),X[0]*=B*q.scale.x,X[1]*=B*q.scale.y;let le=(R=U?.alignment)===null||R===void 0?void 0:R.x,se=(S=U?.alignment)===null||S===void 0?void 0:S.y;U.screenOffset&&(le=(le||0)+2*U.screenOffset.x/j,se=(se||0)+2*U.screenOffset.y/J),this.gl.uniform2f(D.uvScale,((a=U?.uvScale)===null||a===void 0?void 0:a.x)||1,((s=U?.uvScale)===null||s===void 0?void 0:s.y)||1),this.gl.uniform2f(D.uvOffset,((c=U?.uvOffset)===null||c===void 0?void 0:c.x)||0,((w=U?.uvOffset)===null||w===void 0?void 0:w.y)||0),this.gl.uniform2f(D.alignment,le||0,se||0),this.gl.uniform1f(D.opacity,U.opacity),this.gl.uniform3f(D.color,((x=U?.color)===null||x===void 0?void 0:x.r)||0,((T=U?.color)===null||T===void 0?void 0:T.g)||0,((l=U?.color)===null||l===void 0?void 0:l.b)||0),this.gl.uniform1f(D.rotation,q.rotation),this.gl.uniform2fv(D.scale,X),this.renderer.setDepthTest(U.depthTest),this.renderer.setDepthWrite(U.depthWrite),this.renderer.setTexture(U.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(p,y){if(!this.gl)throw new Error("WebGL Rendering context not found");var k=this.gl.createProgram();if(!k)throw new Error("Error creating webgl program");var g=this.gl.createShader(this.gl.FRAGMENT_SHADER),M=this.gl.createShader(this.gl.VERTEX_SHADER);if(!g)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!M)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var P="precision "+y+` float;
`;if(this.gl.shaderSource(g,P+p.fragmentShader),this.gl.shaderSource(M,P+p.vertexShader),this.gl.compileShader(g),this.gl.compileShader(M),!this.gl.getShaderParameter(g,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(M,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(g)} 
      ${this.gl.getShaderInfoLog(M)}`);return this.gl.attachShader(k,g),this.gl.attachShader(k,M),this.gl.linkProgram(k),this.gl.getProgramParameter(k,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),k}}function _(b,p){return b.z!==p.z?p.z-b.z:p.id-b.id}}),"./src/WebGL/constants/Coloring.ts":((n,t,r)=>{r.r(t),r.d(t,{Coloring:()=>u});var u;(function(v){v[v.NoColors=0]="NoColors",v[v.FaceColors=1]="FaceColors",v[v.VertexColors=2]="VertexColors"})(u||(u={}))}),"./src/WebGL/constants/Shading.ts":((n,t,r)=>{r.r(t),r.d(t,{Shading:()=>u});var u;(function(v){v[v.NoShading=0]="NoShading",v[v.FlatShading=1]="FlatShading",v[v.SmoothShading=2]="SmoothShading"})(u||(u={}))}),"./src/WebGL/constants/Sides.ts":((n,t,r)=>{r.r(t),r.d(t,{BackSide:()=>v,DoubleSide:()=>_,FrontSide:()=>u});const u=0,v=1,_=2}),"./src/WebGL/constants/SpriteAlignment.ts":((n,t,r)=>{r.r(t),r.d(t,{SpriteAlignment:()=>v});var u=r("./src/WebGL/math/index.ts");const v={topLeft:new u.Vector2(1,-1),topCenter:new u.Vector2(0,-1),topRight:new u.Vector2(-1,-1),centerLeft:new u.Vector2(1,0),center:new u.Vector2(0,0),centerRight:new u.Vector2(-1,0),bottomLeft:new u.Vector2(1,1),bottomCenter:new u.Vector2(0,1),bottomRight:new u.Vector2(-1,1)}}),"./src/WebGL/constants/TextureConstants.ts":((n,t,r)=>{r.r(t),r.d(t,{ClampToEdgeWrapping:()=>u,FloatType:()=>y,LinearFilter:()=>v,LinearMipMapLinearFilter:()=>b,NearestFilter:()=>_,R32Format:()=>M,RFormat:()=>g,RGBAFormat:()=>k,UnsignedByteType:()=>p});const u=1001,v=1006,_=1007,b=1008,p=1009,y=1010,k=1021,g=1022,M=1023}),"./src/WebGL/constants/TextureOperations.ts":((n,t,r)=>{r.r(t),r.d(t,{TextureOperations:()=>u});var u;(function(v){v[v.MultiplyOperation=0]="MultiplyOperation",v[v.MixOperation=1]="MixOperation",v[v.AddOperation=2]="AddOperation"})(u||(u={}))}),"./src/WebGL/constants/index.ts":((n,t,r)=>{r.r(t),r.d(t,{BackSide:()=>v.BackSide,ClampToEdgeWrapping:()=>p.ClampToEdgeWrapping,Coloring:()=>u.Coloring,DoubleSide:()=>v.DoubleSide,FloatType:()=>p.FloatType,FrontSide:()=>v.FrontSide,LinearFilter:()=>p.LinearFilter,LinearMipMapLinearFilter:()=>p.LinearMipMapLinearFilter,NearestFilter:()=>p.NearestFilter,R32Format:()=>p.R32Format,RFormat:()=>p.RFormat,RGBAFormat:()=>p.RGBAFormat,Shading:()=>_.Shading,SpriteAlignment:()=>b.SpriteAlignment,TextureOperations:()=>y.TextureOperations,UnsignedByteType:()=>p.UnsignedByteType});var u=r("./src/WebGL/constants/Coloring.ts"),v=r("./src/WebGL/constants/Sides.ts"),_=r("./src/WebGL/constants/Shading.ts"),b=r("./src/WebGL/constants/SpriteAlignment.ts"),p=r("./src/WebGL/constants/TextureConstants.ts"),y=r("./src/WebGL/constants/TextureOperations.ts")}),"./src/WebGL/core/EventDispatcher.ts":((n,t,r)=>{r.r(t),r.d(t,{EventDispatcher:()=>u});class u{constructor(){this.listeners={}}dispatchEvent(_){var b=this.listeners[_.type];if(b!==void 0){_.target=this;for(var p=0,y=b.length;p<y;p++)b[p].call(this,_)}}removeEventListener(_,b){if(!b)this.listeners[_]=[];else{var p=this.listeners[_].indexOf(b);p!==-1&&this.listeners[_].splice(p,1)}}addEventListener(_,b){this.listeners[_]===void 0&&(this.listeners[_]=[]),this.listeners[_].indexOf(b)===-1&&this.listeners[_].push(b)}}}),"./src/WebGL/core/Geometry.ts":((n,t,r)=>{r.r(t),r.d(t,{Geometry:()=>k,GeometryGroup:()=>y,GeometryIDCount:()=>g});var u=r("./src/WebGL/materials/LineBasicMaterial.ts"),v=r("./src/WebGL/core/EventDispatcher.ts"),_=r("./src/WebGL/math/index.ts"),b=r("./src/colors.ts");const p=65535;class y{constructor(P=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=P}setColors(P){var R=this.vertexArray,S=this.colorArray;if(!R)throw new Error("vertex array not initialized");if(!S)throw new Error("color array not initialized");if(R.length!=S.length){console.log("Cannot re-color geometry group due to mismatched lengths.");return}for(var a=0;a<R.length;a+=3){var s=P(R[a],R[a+1],R[a+2]);s instanceof b.Color||(s=b.CC.color(s)),S[a]=s.r,S[a+1]=s.g,S[a+2]=s.b}}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var P=new _.Vector3,R,S,a,s,c=0;c<this.vertices;++c)R=c*3,S=this.vertexArray[R],a=this.vertexArray[R+1],s=this.vertexArray[R+2],P.x+=S,P.y+=a,P.z+=s;return P.divideScalar(this.vertices),P}setNormals(){var P=this.faceArray,R=this.vertexArray,S=this.normalArray;if(!(!this.vertices||!this.faceidx)){if(!P)throw new Error("face array not initialized");if(!R)throw new Error("vertex array not initialized");if(!S)throw new Error("normal array not initialized");for(var a,s,c,w,x,T,l,h=0;h<P.length/3;++h)a=P[h*3]*3,s=P[h*3+1]*3,c=P[h*3+2]*3,w=new _.Vector3(R[a],R[a+1],R[a+2]),x=new _.Vector3(R[s],R[s+1],R[s+2]),T=new _.Vector3(R[c],R[c+1],R[c+2]),w.subVectors(w,x),T.subVectors(T,x),T.cross(w),l=T,l.normalize(),S[a]+=l.x,S[s]+=l.x,S[c]+=l.x,S[a+1]+=l.y,S[s+1]+=l.y,S[c+1]+=l.y,S[a+2]+=l.z,S[s+2]+=l.z,S[c+2]+=l.z}}setLineIndices(){if(this.faceidx&&!(this.lineArray&&this.lineArray.length==this.faceidx*2&&this.lineidx==this.faceidx*2)){var P=this.faceArray,R=this.lineArray=new Uint16Array(this.faceidx*2);if(this.lineidx=this.faceidx*2,!P)throw new Error("face array not initialized");for(var S=0;S<this.faceidx/3;++S){var a=S*3,s=a*2,c=P[a],w=P[a+1],x=P[a+2];R[s]=c,R[s+1]=w,R[s+2]=c,R[s+3]=x,R[s+4]=w,R[s+5]=x}}}vrml(P,R){var S,a,s,c,w,x,T,l,h,C,E,D,z,L,V,O,W,H,q="";if(q+=P+`Shape {
`+P+` appearance Appearance {
`+P+`  material Material {
`+P+"   diffuseColor "+((S=R?.color)===null||S===void 0?void 0:S.r)+" "+((a=R?.color)===null||a===void 0?void 0:a.g)+" "+((s=R?.color)===null||s===void 0?void 0:s.b)+`
`,R.wireframe&&this.colorArray){let B=this.colorArray;q+=P+"    emissiveColor "+B[0]+" "+B[1]+" "+B[2]+`
`}R!=null&&R.transparent&&(q+=P+"   transparency "+(1-R.opacity)+`
`),q+=P+`  }
`,q+=P+` }
`;var U=P;if(P+=" ",R instanceof u.LineBasicMaterial||R.wireframe){q+=P+`geometry IndexedLineSet {
`+P+` colorPerVertex TRUE
`+P+` coord Coordinate {
`+P+`  point [
`;let B,Y,X;for(let j=0;j<this.vertices;++j){let J=j*3;B=(c=this.vertexArray)===null||c===void 0?void 0:c[J],Y=(w=this.vertexArray)===null||w===void 0?void 0:w[J+1],X=(x=this.vertexArray)===null||x===void 0?void 0:x[J+2],q+=P+"   "+B+" "+Y+" "+X+`,
`}if(q+=P+`  ]
`,q+=P+` }
`,this.colorArray&&!R.wireframe){q+=P+` color Color {
`+P+`  color [
`;for(let j=0;j<this.vertices;++j){let J=j*3;B=this.colorArray[J],Y=this.colorArray[J+1],X=this.colorArray[J+2],q+=P+"   "+B+" "+Y+" "+X+`,
`}q+=P+`  ]
`,q+=P+` }
`}if(q+=P+` coordIndex [
`,R.wireframe&&this.faceArray)for(let j=0;j<this.faceidx;j+=3)B=(T=this.faceArray)===null||T===void 0?void 0:T[j],Y=(l=this.faceArray)===null||l===void 0?void 0:l[j+1],X=(h=this.faceArray)===null||h===void 0?void 0:h[j+2],q+=P+"  "+B+", "+Y+", "+X+`, -1,
`;else for(let j=0;j<this.vertices-1;j+=2)q+=P+"  "+j+", "+(j+1)+`, -1,
`;q+=P+` ]
`,q+=P+`}
`}else{q+=P+`geometry IndexedFaceSet {
`+P+` colorPerVertex TRUE
`+P+` normalPerVertex TRUE
`+P+` solid FALSE
`,q+=P+` coord Coordinate {
`+P+`  point [
`;let B,Y,X;for(let j=0;j<this.vertices;++j){let J=j*3;B=(C=this.vertexArray)===null||C===void 0?void 0:C[J],Y=(E=this.vertexArray)===null||E===void 0?void 0:E[J+1],X=(D=this.vertexArray)===null||D===void 0?void 0:D[J+2],q+=P+"   "+B+" "+Y+" "+X+`,
`}q+=P+`  ]
`,q+=P+` }
`,q+=P+` normal Normal {
`+P+`  vector [
`;for(let j=0;j<this.vertices;++j){let J=j*3;B=(z=this.normalArray)===null||z===void 0?void 0:z[J],Y=(L=this.normalArray)===null||L===void 0?void 0:L[J+1],X=(V=this.normalArray)===null||V===void 0?void 0:V[J+2],q+=P+"   "+B+" "+Y+" "+X+`,
`}if(q+=P+`  ]
`,q+=P+` }
`,this.colorArray){q+=P+` color Color {
`+P+`  color [
`;for(let j=0;j<this.vertices;++j){let J=j*3;B=this.colorArray[J],Y=this.colorArray[J+1],X=this.colorArray[J+2],q+=P+"   "+B+" "+Y+" "+X+`,
`}q+=P+`  ]
`,q+=P+` }
`}q+=P+` coordIndex [
`;for(let j=0;j<this.faceidx;j+=3)B=(O=this.faceArray)===null||O===void 0?void 0:O[j],Y=(W=this.faceArray)===null||W===void 0?void 0:W[j+1],X=(H=this.faceArray)===null||H===void 0?void 0:H[j+2],q+=P+"  "+B+", "+Y+", "+X+`, -1,
`;q+=P+` ]
`,q+=P+`}
`}return q+=U+"}",q}truncateArrayBuffers(P=!0,R=!1){var S=this.vertexArray,a=this.colorArray,s=this.normalArray,c=this.faceArray,w=this.lineArray,x=this.radiusArray;this.vertexArray=S?.subarray(0,this.vertices*3)||null,this.colorArray=a?.subarray(0,this.vertices*3)||null,P?(this.normalArray=s?.subarray(0,this.vertices*3)||null,this.faceArray=c?.subarray(0,this.faceidx)||null,this.lineidx>0?this.lineArray=w?.subarray(0,this.lineidx)||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),x&&(this.radiusArray=x.subarray(0,this.vertices)),R&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class k extends v.EventDispatcher{constructor(P=!1,R=!1,S=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=g++,this.mesh=P,this.radii=R,this.offset=S}updateGeoGroup(P=0){var R,S=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!S||S.vertices+P>(((R=S?.vertexArray)===null||R===void 0?void 0:R.length)||0)/3)&&(S=this.addGeoGroup()),S}vrml(P,R){for(var S="",a=this.geometryGroups.length,s=0;s<a;s++){var c=this.geometryGroups[s];S+=c.vrml(P,R)+`,
`}return S}addGeoGroup(){var P=new y(this.geometryGroups.length);return this.geometryGroups.push(P),this.groups=this.geometryGroups.length,P.vertexArray=new Float32Array(p*3),P.colorArray=new Float32Array(p*3),this.mesh&&(P.normalArray=new Float32Array(p*3),P.faceArray=new Uint16Array(p*6),P.lineArray=new Uint16Array(p*6)),this.radii&&(P.radiusArray=new Float32Array(p)),P.useOffset=this.offset,P}setUpNormals(...P){for(var R=0;R<this.groups;R++){var S=this.geometryGroups[R];S.setNormals(...P)}}setColors(...P){for(var R=this.geometryGroups.length,S=0;S<R;S++){var a=this.geometryGroups[S];a.setColors(...P)}}setUpWireframe(...P){for(var R=0;R<this.groups;R++){var S=this.geometryGroups[R];S.setLineIndices(...P)}}initTypedArrays(){for(var P=0;P<this.groups;P++){var R=this.geometryGroups[P];R.__inittedArrays!==!0&&R.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var P=0,R=0;R<this.groups;R++)P+=this.geometryGroups[R].vertices;return P}}let g=0}),"./src/WebGL/core/Object3D.ts":((n,t,r)=>{r.r(t),r.d(t,{Light:()=>y,Object3D:()=>b,Object3DIDCount:()=>_,Scene:()=>p});var u=r("./src/WebGL/math/index.ts"),v=r("./src/colors.ts");let _=0;class b{constructor(){this.id=_++,this.name="",this.children=[],this.position=new u.Vector3,this.rotation=new u.Vector3,this.matrix=new u.Matrix4,this.matrixWorld=new u.Matrix4,this.quaternion=new u.Quaternion,this.eulerOrder="XYZ",this.up=new u.Vector3(0,1,0),this.scale=new u.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(g){this.matrix.lookAt(g,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof u.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(g){if(g===this){console.error("Can't add $3Dmol.Object3D to itself");return}g.parent=this,this.children.push(g);for(var M=this;M.parent!==void 0;)M=M.parent;M!==void 0&&M instanceof p&&M.__addObject(g)}remove(g){var M=this.children.indexOf(g);if(M!==-1){g.parent=void 0,this.children.splice(M,1);for(var P=this;P.parent!==void 0;)P=P.parent;P!==void 0&&P instanceof p&&P.__removeObject(g)}}vrml(g){g||(g=" ");var M=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),P=0,R=0,S=0;if(M!=0){let c=Math.sin(M/2);P=this.quaternion.x/c,R=this.quaternion.y/c,S=this.quaternion.z/c}var a=g+`Transform {
`+g+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+g+" rotation "+P+" "+R+" "+S+" "+M+`
`+g+` children [
`;this.geometry&&(a+=this.geometry.vrml(g,this.material));for(var s=0;s<this.children.length;s++)a+=this.children[s].vrml(g+" ")+`,
`;return a+=` ]
`,a+="}",a}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof u.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),(this.scale.x!==1||this.scale.y!==1||this.scale.z!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(g){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||g===!0)&&(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var M=0;M<this.children.length;M++)this.children[M].updateMatrixWorld(!0)}clone(g){g===void 0&&(g=new b),g.name=this.name,g.up.copy(this.up),g.position.copy(this.position),g.rotation instanceof u.Vector3&&this.rotation instanceof u.Vector3?g.rotation.copy(this.rotation):g.rotation=this.rotation,g.eulerOrder=this.eulerOrder,g.scale.copy(this.scale),g.rotationAutoUpdate=this.rotationAutoUpdate,g.matrix.copy(this.matrix),g.matrixWorld.copy(this.matrixWorld),g.quaternion.copy(this.quaternion),g.matrixAutoUpdate=this.matrixAutoUpdate,g.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,g.useQuaternion=this.useQuaternion,g.visible=this.visible;for(var M=0;M<this.children.length;M++){var P=this.children[M];g.add(P.clone())}return g}setVisible(g){this.visible=g;for(var M=0;M<this.children.length;M++){var P=this.children[M];P.setVisible(g)}}}class p extends b{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(g){if(g instanceof y)this.__lights.indexOf(g)===-1&&this.__lights.push(g),g.target&&g.target.parent===void 0&&this.add(g.target);else if(this.__objects.indexOf(g)===-1){this.__objects.push(g),this.__objectsAdded.push(g);var M=this.__objectsRemoved.indexOf(g);M!==-1&&this.__objectsRemoved.splice(M,1)}for(var P=0;P<g.children.length;P++)this.__addObject(g.children[P])}__removeObject(g){var M;if(g instanceof y)M=this.__lights.indexOf(g),M!==-1&&this.__lights.splice(M,1);else if(M=this.__objects.indexOf(g),M!==-1){this.__objects.splice(M,1),this.__objectsRemoved.push(g);var P=this.__objectsAdded.indexOf(g);P!==-1&&this.__objectsAdded.splice(M,1)}for(var R=0;R<g.children.length;R++)this.__removeObject(g.children[R])}}class y extends b{constructor(g,M=1){super(),this.position=new u.Vector3(0,1,0),this.target=new b,this.castShadow=!1,this.onlyShadow=!1,this.color=new v.Color(g),this.intensity=M}}}),"./src/WebGL/core/Projector.ts":((n,t,r)=>{r.r(t),r.d(t,{Projector:()=>_});var u=r("./src/WebGL/math/index.ts");const v=new u.Matrix4;class _{static unprojectVector(p,y){return y.projectionMatrixInverse.getInverse(y.projectionMatrix),v.multiplyMatrices(y.matrixWorld,y.projectionMatrixInverse),p.applyProjection(v)}static projectVector(p,y){return y.matrixWorldInverse.getInverse(y.matrixWorld),v.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),p.applyProjection(v)}projectVector(p,y){return _.projectVector(p,y)}unprojectVector(p,y){return _.unprojectVector(p,y)}}}),"./src/WebGL/core/Raycaster.ts":((n,t,r)=>{r.r(t),r.d(t,{Raycaster:()=>p,intersectObject:()=>c});var u=r("./src/WebGL/math/index.ts"),v=r("./src/WebGL/shapes/index.ts");const _=(w,x)=>w.distance-x.distance,b=new u.Matrix4;class p{constructor(x,T,l,h){this.precision=1e-4,this.linePrecision=.2,this.ray=new u.Ray(x,T),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=h||0,this.far=l||1/0}set(x,T){this.ray.set(x,T)}setFromCamera(x,T){T.ortho?(this.ray.origin.set(x.x,x.y,(T.near+T.far)/(T.near-T.far)).unproject(T),this.ray.direction.set(0,0,-1).transformDirection(T.matrixWorld)):(this.ray.origin.setFromMatrixPosition(T.matrixWorld),this.ray.direction.set(x.x,x.y,x.z),T.projectionMatrixInverse.getInverse(T.projectionMatrix),b.multiplyMatrices(T.matrixWorld,T.projectionMatrixInverse),this.ray.direction.applyProjection(b),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(x,T){for(var l=[],h=0,C=T.length;h<C;h++)c(x,T[h],this,l);return l.sort(_),l}}const y=w=>Math.min(Math.max(w,-1),1);var k=new v.Sphere,g=new v.Cylinder,M=new v.Triangle,P=new u.Vector3,R=new u.Vector3,S=new u.Vector3,a=new u.Vector3,s=new u.Vector3;function c(w,x,T,l){if(s.getPositionFromMatrix(w.matrixWorld),x.intersectionShape===void 0)return l;var h=x.intersectionShape,C=T.linePrecision;C*=w.matrixWorld.getMaxScaleOnAxis();var E=C*C;if(x.boundingSphere!==void 0&&x.boundingSphere instanceof v.Sphere&&(k.copy(x.boundingSphere),k.applyMatrix4(w.matrixWorld),!T.ray.isIntersectionSphere(k)))return l;var D,z,L,V,O,W,H,q,U,B,Y,X,j,J;for(D=0,z=h.triangle.length;D<z;D++)if(h.triangle[D]instanceof v.Triangle){if(M.copy(h.triangle[D]),M.applyMatrix4(w.matrixWorld),L=M.getNormal(),V=T.ray.direction.dot(L),V>=0||(P.subVectors(M.a,T.ray.origin),H=L.dot(P)/V,H<0))continue;R.copy(T.ray.direction).multiplyScalar(H).add(T.ray.origin),R.sub(M.a),S.copy(M.b).sub(M.a),a.copy(M.c).sub(M.a);var le=S.dot(a),se=S.lengthSq(),he=a.lengthSq();if(X=(se*R.dot(a)-le*R.dot(S))/(se*he-le*le),X<0||X>1||(Y=(R.dot(S)-X*le)/se,Y<0||Y>1||Y+X>1))continue;l.push({clickable:x,distance:H})}for(D=0,z=h.cylinder.length;D<z;D++)if(h.cylinder[D]instanceof v.Cylinder){if(g.copy(h.cylinder[D]),g.applyMatrix4(w.matrixWorld),P.subVectors(g.c1,T.ray.origin),O=P.dot(g.direction),W=P.dot(T.ray.direction),V=y(T.ray.direction.dot(g.direction)),U=1-V*V,U===0)continue;j=(V*W-O)/U,J=(W-V*O)/U,R.copy(g.direction).multiplyScalar(j).add(g.c1),S.copy(T.ray.direction).multiplyScalar(J).add(T.ray.origin),q=a.subVectors(R,S).lengthSq();var pe=g.radius*g.radius;if(q<=pe){if(B=(V*O-W)*(V*O-W)-U*(P.lengthSq()-O*O-pe),B<=0?X=H=Math.sqrt(q):X=H=(W-V*O-Math.sqrt(B))/U,Y=V*X-O,Y<0||Y*Y>g.lengthSq()||X<0)continue;l.push({clickable:x,distance:H})}}for(D=0,z=h.line.length;D<z;D+=2){R.copy(h.line[D]),R.applyMatrix4(w.matrixWorld),S.copy(h.line[D+1]),S.applyMatrix4(w.matrixWorld),a.subVectors(S,R);var ve=a.lengthSq();a.normalize(),P.subVectors(R,T.ray.origin);var ce=P.dot(a);W=P.dot(T.ray.direction),V=y(T.ray.direction.dot(a)),U=1-V*V,U!==0&&(j=(V*W-ce)/U,J=(W-V*ce)/U,R.add(a.multiplyScalar(j)),S.copy(T.ray.direction).multiplyScalar(J).add(T.ray.origin),q=a.subVectors(S,R).lengthSq(),q<E&&j*j<ve&&l.push({clickable:x,distance:J}))}for(D=0,z=h.sphere.length;D<z;D++)if(h.sphere[D]instanceof v.Sphere&&(k.copy(h.sphere[D]),k.applyMatrix4(w.matrixWorld),T.ray.isIntersectionSphere(k))){R.subVectors(k.center,T.ray.origin);var me=R.dot(T.ray.direction);if(B=me*me-(R.lengthSq()-k.radius*k.radius),me<0)return l;B<=0?H=me:H=me-Math.sqrt(B),l.push({clickable:x,distance:H})}return l}}),"./src/WebGL/core/Texture.ts":((n,t,r)=>{r.r(t),r.d(t,{Texture:()=>p,TextureIdCount:()=>y});var u=r("./src/WebGL/constants/TextureConstants.ts"),v=r("./src/WebGL/math/index.ts"),_=r("./src/WebGL/core/EventDispatcher.ts"),b=r("./src/WebGL/core/UVMapping.ts");class p extends _.EventDispatcher{constructor(g,M){super(),this.id=y++,this.name="",this.image=g,this.mapping=new b.UVMapping,this.wrapS=u.ClampToEdgeWrapping,this.wrapT=u.ClampToEdgeWrapping,this.anisotropy=1,M?(this.format=u.RFormat,this.type=u.FloatType,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=u.NearestFilter,this.minFilter=u.NearestFilter):(this.format=u.RGBAFormat,this.type=u.UnsignedByteType,this.offset=new v.Vector2(0,0),this.repeat=new v.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=u.LinearFilter,this.minFilter=u.LinearMipMapLinearFilter),this.needsUpdate=!1,this.onUpdate=null}clone(g=new p){return g.image=this.image,g.mapping=this.mapping,g.wrapS=this.wrapS,g.wrapT=this.wrapT,g.magFilter=this.magFilter,g.minFilter=this.minFilter,g.anisotropy=this.anisotropy,g.format=this.format,g.type=this.type,g.offset.copy(this.offset),g.repeat.copy(this.repeat),g.premultiplyAlpha=this.premultiplyAlpha,g.flipY=this.flipY,g.unpackAlignment=this.unpackAlignment,g}dispose(){this.dispatchEvent({type:"dispose"})}}let y=0}),"./src/WebGL/core/UVMapping.ts":((n,t,r)=>{r.r(t),r.d(t,{UVMapping:()=>u});class u{}}),"./src/WebGL/core/index.ts":((n,t,r)=>{r.r(t),r.d(t,{EventDispatcher:()=>u.EventDispatcher,Geometry:()=>v.Geometry,GeometryGroup:()=>v.GeometryGroup,GeometryIDCount:()=>v.GeometryIDCount,Light:()=>_.Light,Object3D:()=>_.Object3D,Object3DIDCount:()=>_.Object3DIDCount,Projector:()=>b.Projector,Raycaster:()=>p.Raycaster,Scene:()=>_.Scene,Texture:()=>y.Texture,TextureIdCount:()=>y.TextureIdCount,UVMapping:()=>k.UVMapping,intersectObject:()=>p.intersectObject});var u=r("./src/WebGL/core/EventDispatcher.ts"),v=r("./src/WebGL/core/Geometry.ts"),_=r("./src/WebGL/core/Object3D.ts"),b=r("./src/WebGL/core/Projector.ts"),p=r("./src/WebGL/core/Raycaster.ts"),y=r("./src/WebGL/core/Texture.ts"),k=r("./src/WebGL/core/UVMapping.ts")}),"./src/WebGL/index.ts":((n,t,r)=>{r.r(t),r.d(t,{BackSide:()=>u.BackSide,Camera:()=>g.Camera,ClampToEdgeWrapping:()=>u.ClampToEdgeWrapping,Coloring:()=>u.Coloring,Cylinder:()=>k.Cylinder,DoubleSide:()=>u.DoubleSide,EventDispatcher:()=>v.EventDispatcher,FloatType:()=>u.FloatType,Fog:()=>M.Fog,FrontSide:()=>u.FrontSide,Geometry:()=>v.Geometry,GeometryGroup:()=>v.GeometryGroup,GeometryIDCount:()=>v.GeometryIDCount,ImposterMaterial:()=>_.ImposterMaterial,InstancedMaterial:()=>_.InstancedMaterial,Light:()=>v.Light,Line:()=>p.Line,LineBasicMaterial:()=>_.LineBasicMaterial,LineStyle:()=>p.LineStyle,LinearFilter:()=>u.LinearFilter,LinearMipMapLinearFilter:()=>u.LinearMipMapLinearFilter,Material:()=>_.Material,MaterialIdCount:()=>_.MaterialIdCount,Matrix3:()=>b.Matrix3,Matrix4:()=>b.Matrix4,Mesh:()=>p.Mesh,MeshDoubleLambertMaterial:()=>_.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>_.MeshLambertMaterial,MeshOutlineMaterial:()=>_.MeshOutlineMaterial,NearestFilter:()=>u.NearestFilter,Object3D:()=>v.Object3D,Object3DIDCount:()=>v.Object3DIDCount,Projector:()=>v.Projector,Quaternion:()=>b.Quaternion,R32Format:()=>u.R32Format,RFormat:()=>u.RFormat,RGBAFormat:()=>u.RGBAFormat,Ray:()=>b.Ray,Raycaster:()=>v.Raycaster,Renderer:()=>P.Renderer,Scene:()=>v.Scene,ShaderLib:()=>y.ShaderLib,ShaderUtils:()=>y.ShaderUtils,Shading:()=>u.Shading,Sphere:()=>k.Sphere,SphereImposterMaterial:()=>_.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>_.SphereImposterOutlineMaterial,Sprite:()=>p.Sprite,SpriteAlignment:()=>u.SpriteAlignment,SpriteMaterial:()=>_.SpriteMaterial,SpritePlugin:()=>R.SpritePlugin,StickImposterMaterial:()=>_.StickImposterMaterial,StickImposterOutlineMaterial:()=>_.StickImposterOutlineMaterial,Texture:()=>v.Texture,TextureIdCount:()=>v.TextureIdCount,TextureOperations:()=>u.TextureOperations,Triangle:()=>k.Triangle,UVMapping:()=>v.UVMapping,UnsignedByteType:()=>u.UnsignedByteType,Vector2:()=>b.Vector2,Vector3:()=>b.Vector3,VolumetricMaterial:()=>_.VolumetricMaterial,basic:()=>y.basic,clamp:()=>b.clamp,clone:()=>y.clone,conversionMatrix3:()=>b.conversionMatrix3,degToRad:()=>b.degToRad,instanced:()=>y.instanced,intersectObject:()=>v.intersectObject,lambert:()=>y.lambert,lambertdouble:()=>y.lambertdouble,outline:()=>y.outline,screen:()=>y.screen,screenaa:()=>y.screenaa,sphereimposter:()=>y.sphereimposter,sphereimposteroutline:()=>y.sphereimposteroutline,sprite:()=>y.sprite,stickimposter:()=>y.stickimposter,stickimposteroutline:()=>y.stickimposteroutline,volumetric:()=>y.volumetric});var u=r("./src/WebGL/constants/index.ts"),v=r("./src/WebGL/core/index.ts"),_=r("./src/WebGL/materials/index.ts"),b=r("./src/WebGL/math/index.ts"),p=r("./src/WebGL/objects/index.ts"),y=r("./src/WebGL/shaders/index.ts"),k=r("./src/WebGL/shapes/index.ts"),g=r("./src/WebGL/Camera.ts"),M=r("./src/WebGL/Fog.ts"),P=r("./src/WebGL/Renderer.ts"),R=r("./src/WebGL/SpritePlugin.ts")}),"./src/WebGL/materials/ImposterMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{ImposterMaterial:()=>y});var u=r("./src/WebGL/constants/Coloring.ts"),v=r("./src/WebGL/constants/Shading.ts"),_=r("./src/colors.ts"),b=r("./src/WebGL/math/index.ts"),p=r("./src/WebGL/materials/Material.ts");class y extends p.Material{constructor(g){super(),this.color=new _.Color(16777215),this.ambient=new _.Color(1048575),this.emissive=new _.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new b.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=v.Shading.SmoothShading,this.shaderID=null,this.vertexColors=u.Coloring.NoColors,this.skinning=!1,this.setValues(g)}clone(g=new y){return super.clone.call(this,g),g.color.copy(this.color),g.ambient.copy(this.ambient),g.emissive.copy(this.emissive),g.wrapAround=this.wrapAround,g.wrapRGB.copy(this.wrapRGB),g.map=this.map,g.lightMap=this.lightMap,g.specularMap=this.specularMap,g.envMap=this.envMap,g.combine=this.combine,g.reflectivity=this.reflectivity,g.refractionRatio=this.refractionRatio,g.fog=this.fog,g.shading=this.shading,g.shaderID=this.shaderID,g.vertexColors=this.vertexColors,g.skinning=this.skinning,g.morphTargets=this.morphTargets,g.morphNormals=this.morphNormals,g}}}),"./src/WebGL/materials/InstancedMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{InstancedMaterial:()=>y});var u=r("./src/WebGL/constants/Coloring.ts"),v=r("./src/WebGL/constants/Shading.ts"),_=r("./src/colors.ts"),b=r("./src/WebGL/math/index.ts"),p=r("./src/WebGL/materials/Material.ts");class y extends p.Material{constructor(g){super(),this.color=new _.Color(16777215),this.ambient=new _.Color(1048575),this.emissive=new _.Color(0),this.wrapAround=!1,this.wrapRGB=new b.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=v.Shading.SmoothShading,this.shaderID="instanced",this.vertexColors=u.Coloring.NoColors,this.skinning=!1,this.sphere=null,this.setValues(g)}clone(g=new y){return super.clone.call(this,g),g.color.copy(this.color),g.ambient.copy(this.ambient),g.emissive.copy(this.emissive),g.wrapAround=this.wrapAround,g.wrapRGB.copy(this.wrapRGB),g.map=this.map,g.lightMap=this.lightMap,g.specularMap=this.specularMap,g.envMap=this.envMap,g.combine=this.combine,g.reflectivity=this.reflectivity,g.refractionRatio=this.refractionRatio,g.fog=this.fog,g.shading=this.shading,g.shaderID=this.shaderID,g.vertexColors=this.vertexColors,g.skinning=this.skinning,g.morphTargets=this.morphTargets,g.morphNormals=this.morphNormals,g.sphere=this.sphere,g}}}),"./src/WebGL/materials/LineBasicMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{LineBasicMaterial:()=>_});var u=r("./src/colors.ts"),v=r("./src/WebGL/materials/Material.ts");class _ extends v.Material{constructor(p){super(),this.color=new u.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(p)}clone(p=new _){return super.clone.call(this,p),p.color.copy(this.color),p}}}),"./src/WebGL/materials/Material.ts":((n,t,r)=>{r.r(t),r.d(t,{Material:()=>p,MaterialIdCount:()=>y});var u=r("./src/WebGL/constants/Sides.ts"),v=r("./src/WebGL/core/index.ts"),_=r("./src/WebGL/math/index.ts"),b=r("./src/colors.ts");class p extends v.EventDispatcher{constructor(){super(...arguments),this.id=y++,this.name="",this.side=u.FrontSide,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(g={}){if(g!==void 0)for(var M in g){var P=g[M];if(P===void 0){console.warn("$3Dmol.Material: '"+M+"' parameter is undefined.");continue}if(M in this){var R=this[M];R instanceof b.Color&&P instanceof b.Color?R.copy(P):R instanceof b.Color?R.set(P):R instanceof _.Vector3&&P instanceof _.Vector3?R.copy(P):this[M]=P}}}clone(g=new p){return g.name=this.name,g.side=this.side,g.opacity=this.opacity,g.transparent=this.transparent,g.depthTest=this.depthTest,g.depthWrite=this.depthWrite,g.polygonOffset=this.polygonOffset,g.polygonOffsetFactor=this.polygonOffsetFactor,g.polygonOffsetUnits=this.polygonOffsetUnits,g.alphaTest=this.alphaTest,g.overdraw=this.overdraw,g.visible=this.visible,g}makeShaded(g){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:g},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let y=0}),"./src/WebGL/materials/MeshDoubleLambertMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{MeshDoubleLambertMaterial:()=>_});var u=r("./src/WebGL/constants/Sides.ts"),v=r("./src/WebGL/materials/MeshLambertMaterial.ts");class _ extends v.MeshLambertMaterial{constructor(p){super(p),this.shaderID="lambertdouble",this.side=u.DoubleSide,this.outline=!1}clone(p=new _){return super.clone.call(this,p),p}}}),"./src/WebGL/materials/MeshLambertMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{MeshLambertMaterial:()=>y});var u=r("./src/WebGL/constants/Coloring.ts"),v=r("./src/WebGL/constants/Shading.ts"),_=r("./src/WebGL/materials/Material.ts"),b=r("./src/colors.ts"),p=r("./src/WebGL/math/index.ts");class y extends _.Material{constructor(g){super(),this.color=new b.Color(16777215),this.ambient=new b.Color(1048575),this.emissive=new b.Color(0),this.wrapAround=!1,this.wrapRGB=new p.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=v.Shading.SmoothShading,this.shaderID="lambert",this.vertexColors=u.Coloring.NoColors,this.skinning=!1,this.setValues(g)}clone(g=new y){return super.clone.call(this,g),g.color.copy(this.color),g.ambient.copy(this.ambient),g.emissive.copy(this.emissive),g.wrapAround=this.wrapAround,g.wrapRGB.copy(this.wrapRGB),g.map=this.map,g.lightMap=this.lightMap,g.specularMap=this.specularMap,g.envMap=this.envMap,g.combine=this.combine,g.reflectivity=this.reflectivity,g.refractionRatio=this.refractionRatio,g.fog=this.fog,g.shading=this.shading,g.shaderID=this.shaderID,g.vertexColors=this.vertexColors,g.skinning=this.skinning,g.morphTargets=this.morphTargets,g.morphNormals=this.morphNormals,g}}}),"./src/WebGL/materials/MeshOutlineMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{MeshOutlineMaterial:()=>_});var u=r("./src/colors.ts"),v=r("./src/WebGL/materials/Material.ts");class _ extends v.Material{constructor(p){super(),p=p||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=p.color||new u.Color(0,0,0),this.outlineWidth=p.width||.1,this.outlinePushback=p.pushback||1}clone(p=new _){return super.clone.call(this,p),p.fog=this.fog,p.shaderID=this.shaderID,p.wireframe=this.wireframe,p}}}),"./src/WebGL/materials/SphereImposterMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{SphereImposterMaterial:()=>v});var u=r("./src/WebGL/materials/ImposterMaterial.ts");class v extends u.ImposterMaterial{constructor(b){super(b),this.shaderID="sphereimposter",this.setValues(b)}clone(b=new v){return super.clone.call(this,b),b}}}),"./src/WebGL/materials/SphereImposterOutlineMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{SphereImposterOutlineMaterial:()=>_});var u=r("./src/colors.ts"),v=r("./src/WebGL/materials/ImposterMaterial.ts");class _ extends v.ImposterMaterial{constructor(p){super(p),p=p||{},this.shaderID="sphereimposteroutline",this.outlineColor=p.color||new u.Color(0,0,0),this.outlineWidth=p.width||.1,this.outlinePushback=p.pushback||1,this.setValues(p)}clone(p=new _){return super.clone.call(this,p),p.outlineColor=this.outlineColor,p.outlineWidth=this.outlineWidth,p.outlinePushback=this.outlinePushback,p}}}),"./src/WebGL/materials/SpriteMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{SpriteMaterial:()=>y});var u=r("./src/WebGL/constants/SpriteAlignment.ts"),v=r("./src/WebGL/core/Texture.ts"),_=r("./src/colors.ts"),b=r("./src/WebGL/math/index.ts"),p=r("./src/WebGL/materials/Material.ts");class y extends p.Material{constructor(g){super(),this.color=new _.Color(16777215),this.map=new v.Texture,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new b.Vector2(0,0),this.uvScale=new b.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=u.SpriteAlignment.center.clone(),this.setValues(g),g=g||{},g.depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),g.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),g.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(g=new y){return super.clone.call(this,g),g.color.copy(this.color),g.map=this.map,g.useScreenCoordinates=this.useScreenCoordinates,g.screenOffset=this.screenOffset,g.sizeAttenuation=this.sizeAttenuation,g.scaleByViewport=this.scaleByViewPort,g.alignment.copy(this.alignment),g.uvOffset.copy(this.uvOffset),g}}}),"./src/WebGL/materials/StickImposterMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{StickImposterMaterial:()=>v});var u=r("./src/WebGL/materials/ImposterMaterial.ts");class v extends u.ImposterMaterial{constructor(b){super(b),this.shaderID="stickimposter",this.setValues(b)}clone(b=new v){return super.clone.call(this,b),b}}}),"./src/WebGL/materials/StickImposterOutlineMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{StickImposterOutlineMaterial:()=>_});var u=r("./src/colors.ts"),v=r("./src/WebGL/materials/ImposterMaterial.ts");class _ extends v.ImposterMaterial{constructor(p={}){super(p),this.shaderID="stickimposteroutline",this.outlineColor=new u.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,p.color&&(this.outlineColor=p.color),p.width&&(this.outlineWidth=p.width),p.pushback&&(this.outlinePushback=p.pushback),this.setValues(p)}clone(p=new _){return super.clone.call(this,p),p.outlineColor=this.outlineColor,p.outlineWidth=this.outlineWidth,p.outlinePushback=this.outlinePushback,p}}}),"./src/WebGL/materials/VolumetricMaterial.ts":((n,t,r)=>{r.r(t),r.d(t,{VolumetricMaterial:()=>b});var u=r("./src/WebGL/constants/Sides.ts"),v=r("./src/colors.ts"),_=r("./src/WebGL/materials/Material.ts");class b extends _.Material{constructor(y){super(),this.transparent=!1,this.volumetric=!0,this.color=new v.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=u.FrontSide,this.setValues(y)}clone(y=new b){return super.clone.call(this,y),y.transparent=this.transparent,y.volumetric=this.volumetric,y.color=this.color,y.transferfn=this.transferfn,y.map=this.map,y.extent=this.extent,y.maxdepth=this.maxdepth,y.unit=this.unit,y.texmatrix=this.texmatrix,y.transfermin=this.transfermin,y.transfermax=this.transfermax,y.subsamples=this.subsamples,y.shaderID=this.shaderID,y.side=this.side,y}}}),"./src/WebGL/materials/index.ts":((n,t,r)=>{r.r(t),r.d(t,{ImposterMaterial:()=>u.ImposterMaterial,InstancedMaterial:()=>v.InstancedMaterial,LineBasicMaterial:()=>_.LineBasicMaterial,Material:()=>b.Material,MaterialIdCount:()=>b.MaterialIdCount,MeshDoubleLambertMaterial:()=>p.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>y.MeshLambertMaterial,MeshOutlineMaterial:()=>k.MeshOutlineMaterial,SphereImposterMaterial:()=>g.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>M.SphereImposterOutlineMaterial,SpriteMaterial:()=>P.SpriteMaterial,StickImposterMaterial:()=>R.StickImposterMaterial,StickImposterOutlineMaterial:()=>S.StickImposterOutlineMaterial,VolumetricMaterial:()=>a.VolumetricMaterial});var u=r("./src/WebGL/materials/ImposterMaterial.ts"),v=r("./src/WebGL/materials/InstancedMaterial.ts"),_=r("./src/WebGL/materials/LineBasicMaterial.ts"),b=r("./src/WebGL/materials/Material.ts"),p=r("./src/WebGL/materials/MeshDoubleLambertMaterial.ts"),y=r("./src/WebGL/materials/MeshLambertMaterial.ts"),k=r("./src/WebGL/materials/MeshOutlineMaterial.ts"),g=r("./src/WebGL/materials/SphereImposterMaterial.ts"),M=r("./src/WebGL/materials/SphereImposterOutlineMaterial.ts"),P=r("./src/WebGL/materials/SpriteMaterial.ts"),R=r("./src/WebGL/materials/StickImposterMaterial.ts"),S=r("./src/WebGL/materials/StickImposterOutlineMaterial.ts"),a=r("./src/WebGL/materials/VolumetricMaterial.ts")}),"./src/WebGL/math/Quaternion.ts":((n,t,r)=>{r.r(t),r.d(t,{Quaternion:()=>u});class u{constructor(_,b,p,y){this.x=_||0,this.y=b||0,this.z=p||0,this.w=y!==void 0?y:1}set(_,b,p,y){return this.x=_,this.y=b,this.z=p,this.w=y,this}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this.w=_.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let _=this.length();return _===0?(this.x=0,this.y=0,this.z=0,this.w=1):(_=1/_,this.x*=_,this.y*=_,this.z*=_,this.w*=_),this}multiply(_){return this.multiplyQuaternions(this,_)}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this.w*=_,this}multiplyQuaternions(_,b){const p=_.x,y=_.y,k=_.z,g=_.w,M=b.x,P=b.y,R=b.z,S=b.w;return this.x=p*S+g*M+y*R-k*P,this.y=y*S+g*P+k*M-p*R,this.z=k*S+g*R+p*P-y*M,this.w=g*S-p*M-y*P-k*R,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this.w-=_.w,this}clone(){return new u(this.x,this.y,this.z,this.w)}setFromEuler(_){const b=Math.cos(_.x/2),p=Math.cos(_.y/2),y=Math.cos(_.z/2),k=Math.sin(_.x/2),g=Math.sin(_.y/2),M=Math.sin(_.z/2);return this.x=k*p*y+b*g*M,this.y=b*g*y-k*p*M,this.z=b*p*M+k*g*y,this.w=b*p*y-k*g*M,this}}}),"./src/WebGL/math/Vector2.ts":((n,t,r)=>{r.r(t),r.d(t,{Vector2:()=>u});class u{constructor(_,b){this.x=_||0,this.y=b||0}set(_,b){return this.x=_,this.y=b,this}subVectors(_,b){return this.x=_.x-b.x,this.y=_.y-b.y,this}copy(_){return this.x=_.x,this.y=_.y,this}clone(){return new u(this.x,this.y)}}}),"./src/WebGL/math/index.ts":((n,t,r)=>{r.r(t),r.d(t,{Matrix3:()=>y.Matrix3,Matrix4:()=>y.Matrix4,Quaternion:()=>u.Quaternion,Ray:()=>y.Ray,Vector2:()=>v.Vector2,Vector3:()=>y.Vector3,clamp:()=>_.clamp,conversionMatrix3:()=>b.conversionMatrix3,degToRad:()=>p.degToRad});var u=r("./src/WebGL/math/Quaternion.ts"),v=r("./src/WebGL/math/Vector2.ts"),_=r("./src/WebGL/math/utils/clamp.ts"),b=r("./src/WebGL/math/utils/conversionMatrix3.ts"),p=r("./src/WebGL/math/utils/degToRad.ts"),y=r("./src/WebGL/math/math.ts")}),"./src/WebGL/math/math.ts":((n,t,r)=>{r.r(t),r.d(t,{Matrix3:()=>P,Matrix4:()=>g,Ray:()=>R,Vector3:()=>M});var u=r("./src/WebGL/math/utils/degToRad.ts"),v=r("./src/WebGL/math/utils/clamp.ts"),_,b,p,y,k;class g{constructor(a=1,s=0,c=0,w=0,x=0,T=1,l=0,h=0,C=0,E=0,D=1,z=0,L=0,V=0,O=0,W=1){typeof a<"u"&&typeof a!="number"?this.elements=new Float32Array(a):(this.elements=new Float32Array(16),this.elements[0]=a,this.elements[4]=s,this.elements[8]=c,this.elements[12]=w,this.elements[1]=x,this.elements[5]=T,this.elements[9]=l,this.elements[13]=h,this.elements[2]=C,this.elements[6]=E,this.elements[10]=D,this.elements[14]=z,this.elements[3]=L,this.elements[7]=V,this.elements[11]=O,this.elements[15]=W)}makeScale(a,s,c){throw new Error("Method not implemented.")}set(a,s,c,w,x,T,l,h,C,E,D,z,L,V,O,W){const H=this.elements;return H[0]=a,H[4]=s,H[8]=c,H[12]=w,H[1]=x,H[5]=T,H[9]=l,H[13]=h,H[2]=C,H[6]=E,H[10]=D,H[14]=z,H[3]=L,H[7]=V,H[11]=O,H[15]=W,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(a){const s=a.elements;return this.set(s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14],s[3],s[7],s[11],s[15]),this}matrix3FromTopLeft(){const a=this.elements;return new P(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10])}setRotationFromEuler(a,s){const c=this.elements,{x:w,y:x,z:T}=a,l=Math.cos(w),h=Math.sin(w),C=Math.cos(x),E=Math.sin(x),D=Math.cos(T),z=Math.sin(T);if(s===void 0||s==="XYZ"){const L=l*D,V=l*z,O=h*D,W=h*z;c[0]=C*D,c[4]=-C*z,c[8]=E,c[1]=V+O*E,c[5]=L-W*E,c[9]=-h*C,c[2]=W-L*E,c[6]=O+V*E,c[10]=l*C}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${s}`);return this}setRotationFromQuaternion(a){const s=this.elements,{x:c,y:w,z:x,w:T}=a,l=c+c,h=w+w,C=x+x,E=c*l,D=c*h,z=c*C,L=w*h,V=w*C,O=x*C,W=T*l,H=T*h,q=T*C;return s[0]=1-(L+O),s[4]=D-q,s[8]=z+H,s[1]=D+q,s[5]=1-(E+O),s[9]=V-W,s[2]=z-H,s[6]=V+W,s[10]=1-(E+L),this}multiplyMatrices(a,s){const c=a.elements,w=s.elements,x=this.elements,T=c[0],l=c[4],h=c[8],C=c[12],E=c[1],D=c[5],z=c[9],L=c[13],V=c[2],O=c[6],W=c[10],H=c[14],q=c[3],U=c[7],B=c[11],Y=c[15],X=w[0],j=w[4],J=w[8],le=w[12],se=w[1],he=w[5],pe=w[9],ve=w[13],ce=w[2],me=w[6],Re=w[10],Ge=w[14],We=w[3],Oe=w[7],fe=w[11],De=w[15];return x[0]=T*X+l*se+h*ce+C*We,x[4]=T*j+l*he+h*me+C*Oe,x[8]=T*J+l*pe+h*Re+C*fe,x[12]=T*le+l*ve+h*Ge+C*De,x[1]=E*X+D*se+z*ce+L*We,x[5]=E*j+D*he+z*me+L*Oe,x[9]=E*J+D*pe+z*Re+L*fe,x[13]=E*le+D*ve+z*Ge+L*De,x[2]=V*X+O*se+W*ce+H*We,x[6]=V*j+O*he+W*me+H*Oe,x[10]=V*J+O*pe+W*Re+H*fe,x[14]=V*le+O*ve+W*Ge+H*De,x[3]=q*X+U*se+B*ce+Y*We,x[7]=q*j+U*he+B*me+Y*Oe,x[11]=q*J+U*pe+B*Re+Y*fe,x[15]=q*le+U*ve+B*Ge+Y*De,this}multiplyScalar(a){const s=this.elements;return s[0]*=a,s[4]*=a,s[8]*=a,s[12]*=a,s[1]*=a,s[5]*=a,s[9]*=a,s[13]*=a,s[2]*=a,s[6]*=a,s[10]*=a,s[14]*=a,s[3]*=a,s[7]*=a,s[11]*=a,s[15]*=a,this}makeTranslation(a,s,c){return this.set(1,0,0,a,0,1,0,s,0,0,1,c,0,0,0,1),this}snap(a){const s=Math.pow(10,4),c=this.elements;for(let w=0;w<16;w++){const x=Math.round(c[w]);x===Math.round(c[w]*s)/s&&(c[w]=x)}return this}transpose(){const a=this.elements;let s;return s=a[1],a[1]=a[4],a[4]=s,s=a[2],a[2]=a[8],a[8]=s,s=a[6],a[6]=a[9],a[9]=s,s=a[3],a[3]=a[12],a[12]=s,s=a[7],a[7]=a[13],a[13]=s,s=a[11],a[11]=a[14],a[14]=s,this}setPosition(a){const s=this.elements;return s[12]=a.x,s[13]=a.y,s[14]=a.z,this}translate(a){const s=this.elements;return s[12]+=a.x,s[13]+=a.y,s[14]+=a.z,this}getInverse(a,s){const c=this.elements,w=a.elements,x=w[0],T=w[4],l=w[8],h=w[12],C=w[1],E=w[5],D=w[9],z=w[13],L=w[2],V=w[6],O=w[10],W=w[14],H=w[3],q=w[7],U=w[11],B=w[15];c[0]=D*W*q-z*O*q+z*V*U-E*W*U-D*V*B+E*O*B,c[4]=h*O*q-l*W*q-h*V*U+T*W*U+l*V*B-T*O*B,c[8]=l*z*q-h*D*q+h*E*U-T*z*U-l*E*B+T*D*B,c[12]=h*D*V-l*z*V-h*E*O+T*z*O+l*E*W-T*D*W,c[1]=z*O*H-D*W*H-z*L*U+C*W*U+D*L*B-C*O*B,c[5]=l*W*H-h*O*H+h*L*U-x*W*U-l*L*B+x*O*B,c[9]=h*D*H-l*z*H-h*C*U+x*z*U+l*C*B-x*D*B,c[13]=l*z*L-h*D*L+h*C*O-x*z*O-l*C*W+x*D*W,c[2]=E*W*H-z*V*H+z*L*q-C*W*q-E*L*B+C*V*B,c[6]=h*V*H-T*W*H-h*L*q+x*W*q+T*L*B-x*V*B,c[10]=T*z*H-h*E*H+h*C*q-x*z*q-T*C*B+x*E*B,c[14]=h*E*L-T*z*L-h*C*V+x*z*V+T*C*W-x*E*W,c[3]=D*V*H-E*O*H-D*L*q+C*O*q+E*L*U-C*V*U,c[7]=T*O*H-l*V*H+l*L*q-x*O*q-T*L*U+x*V*U,c[11]=l*E*H-T*D*H-l*C*q+x*D*q+T*C*U-x*E*U,c[15]=T*D*L-l*E*L+l*C*V-x*D*V-T*C*O+x*E*O;const Y=x*c[0]+C*c[4]+L*c[8]+H*c[12];if(Y===0){const X="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(s)throw new Error(X);return console.warn(X),this.identity(),this}return this.multiplyScalar(1/Y),this}isReflected(){const a=this.elements,s=a[0],c=a[4],w=a[8],x=a[1],T=a[5],l=a[9],h=a[2],C=a[6],E=a[10];return s*T*E+x*C*w+h*c*l-h*T*w-x*c*E-s*C*l<0}scale(a){const s=this.elements,{x:c}=a,{y:w}=a,{z:x}=a;return s[0]*=c,s[4]*=w,s[8]*=x,s[1]*=c,s[5]*=w,s[9]*=x,s[2]*=c,s[6]*=w,s[10]*=x,s[3]*=c,s[7]*=w,s[11]*=x,this}getMaxScaleOnAxis(){const a=this.elements,s=a[0]*a[0]+a[1]*a[1]+a[2]*a[2],c=a[4]*a[4]+a[5]*a[5]+a[6]*a[6],w=a[8]*a[8]+a[9]*a[9]+a[10]*a[10];return Math.sqrt(Math.max(s,Math.max(c,w)))}makeFrustum(a,s,c,w,x,T){const l=this.elements,h=2*x/(s-a),C=2*x/(w-c),E=(s+a)/(s-a),D=(w+c)/(w-c),z=-(T+x)/(T-x),L=-2*T*x/(T-x);return l[0]=h,l[4]=0,l[8]=E,l[12]=0,l[1]=0,l[5]=C,l[9]=D,l[13]=0,l[2]=0,l[6]=0,l[10]=z,l[14]=L,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makePerspective(a,s,c,w){const x=c*Math.tan((0,u.degToRad)(a*.5)),T=-x,l=T*s,h=x*s;return this.makeFrustum(l,h,T,x,c,w)}makeOrthographic(a,s,c,w,x,T){const l=this.elements,h=1/(s-a),C=1/(c-w),E=1/(T-x),D=(s+a)*h,z=(c+w)*C,L=(T+x)*E;return l[0]=2*h,l[4]=0,l[8]=0,l[12]=-D,l[1]=0,l[5]=2*C,l[9]=0,l[13]=-z,l[2]=0,l[6]=0,l[10]=-2*E,l[14]=-L,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}isEqual(a){const s=a.elements,c=this.elements;return c[0]===s[0]&&c[4]===s[4]&&c[8]===s[8]&&c[12]===s[12]&&c[1]===s[1]&&c[5]===s[5]&&c[9]===s[9]&&c[13]===s[13]&&c[2]===s[2]&&c[6]===s[6]&&c[10]===s[10]&&c[14]===s[14]&&c[3]===s[3]&&c[7]===s[7]&&c[11]===s[11]&&c[15]===s[15]}clone(){const a=this.elements;return new g(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}isIdentity(){const a=this.elements;return a[0]===1&&a[4]===0&&a[8]===0&&a[12]===0&&a[1]===0&&a[5]===1&&a[9]===0&&a[13]===0&&a[2]===0&&a[6]===0&&a[10]===1&&a[14]===0&&a[3]===0&&a[7]===0&&a[11]===0&&a[15]===1}isNearlyIdentity(a){return this.clone().snap(a).isIdentity()}getScale(a){const s=this.elements;return a=a||new M,p.set(s[0],s[1],s[2]),y.set(s[4],s[5],s[6]),k.set(s[8],s[9],s[10]),a.x=p.length(),a.y=y.length(),a.z=k.length(),a}lookAt(a,s,c){const w=this.elements;return k.subVectors(a,s).normalize(),k.length()===0&&(k.z=1),p.crossVectors(c,k).normalize(),p.length()===0&&(k.x+=1e-4,p.crossVectors(c,k).normalize()),y.crossVectors(k,p),w[0]=p.x,w[4]=y.x,w[8]=k.x,w[1]=p.y,w[5]=y.y,w[9]=k.y,w[2]=p.z,w[6]=y.z,w[10]=k.z,this}compose(a,s,c){const w=this.elements;return _.identity(),_.setRotationFromQuaternion(s),b.makeScale(c.x,c.y,c.z),this.multiplyMatrices(_,b),w[12]=a.x,w[13]=a.y,w[14]=a.z,this}}_=new g,b=new g;class M{constructor(a,s,c){this.x=a||0,this.y=s||0,this.z=c||0,this.atomid=void 0}set(a,s,c){return this.x=a,this.y=s,this.z=c,this}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this}addVectors(a,s){return this.x=a.x+s.x,this.y=a.y+s.y,this.z=a.z+s.z,this}multiplyVectors(a,s){return this.x=a.x*s.x,this.y=a.y*s.y,this.z=a.z*s.z,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this}subVectors(a,s){return this.x=a.x-s.x,this.y=a.y-s.y,this.z=a.z-s.z,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this}divideScalar(a){return a!==0?(this.x/=a,this.y/=a,this.z/=a):(this.x=0,this.y=0,this.z=0),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const s=this.x-a.x,c=this.y-a.y,w=this.z-a.z;return s*s+c*c+w*w}applyMatrix3(a){const{x:s}=this,{y:c}=this,{z:w}=this,x=a.elements;return this.x=x[0]*s+x[3]*c+x[6]*w,this.y=x[1]*s+x[4]*c+x[7]*w,this.z=x[2]*s+x[5]*c+x[8]*w,this}applyMatrix4(a){const{x:s}=this,{y:c}=this,{z:w}=this,x=a.elements;return this.x=x[0]*s+x[4]*c+x[8]*w+x[12],this.y=x[1]*s+x[5]*c+x[9]*w+x[13],this.z=x[2]*s+x[6]*c+x[10]*w+x[14],this}applyProjection(a){const{x:s}=this,{y:c}=this,{z:w}=this,x=a.elements,T=x[3]*s+x[7]*c+x[11]*w+x[15];return this.x=(x[0]*s+x[4]*c+x[8]*w+x[12])/T,this.y=(x[1]*s+x[5]*c+x[9]*w+x[13])/T,this.z=(x[2]*s+x[6]*c+x[10]*w+x[14])/T,this}applyQuaternion(a){const{x:s}=this,{y:c}=this,{z:w}=this,x=a.x,T=a.y,l=a.z,h=a.w,C={};C.x=2*(c*l-w*T),C.y=2*(w*x-s*l),C.z=2*(s*T-c*x);const E={};return E.x=C.y*l-C.z*T,E.y=C.z*x-C.x*l,E.z=C.x*T-C.y*x,this.x=s+h*C.x+E.x,this.y=c+h*C.y+E.y,this.z=w+h*C.z+E.z,this}negate(){return this.multiplyScalar(-1)}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross(a){const{x:s}=this,{y:c}=this,{z:w}=this;return this.x=c*a.z-w*a.y,this.y=w*a.x-s*a.z,this.z=s*a.y-c*a.x,this}crossVectors(a,s){return this.x=a.y*s.z-a.z*s.y,this.y=a.z*s.x-a.x*s.z,this.z=a.x*s.y-a.y*s.x,this}equals(a){return this.x==a.x&&this.y==a.y&&this.z==a.z}getPositionFromMatrix(a){return this.x=a.elements[12],this.y=a.elements[13],this.z=a.elements[14],this}setEulerFromRotationMatrix(a,s){const c=a.elements,w=c[0],x=c[4],T=c[8],l=c[5],h=c[9],C=c[6],E=c[10];return s===void 0||s==="XYZ"?(this.y=Math.asin((0,v.clamp)(T,-1,1)),Math.abs(T)<.99999?(this.x=Math.atan2(-h,E),this.z=Math.atan2(-x,w)):(this.x=Math.atan2(C,l),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${s}`),this}rotateAboutVector(a,s){a.normalize();const c=Math.cos(s),w=Math.sin(s),x=this.clone().multiplyScalar(c),T=a.clone().cross(this).multiplyScalar(w),l=a.clone().multiplyScalar(a.clone().dot(this)).multiplyScalar(1-c),h=x.add(T).add(l);return this.x=h.x,this.y=h.y,this.z=h.z,this}setFromMatrixPosition(a){const s=a.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}transformDirection(a){const{x:s}=this,{y:c}=this,{z:w}=this,x=a.elements;return this.x=x[0]*s+x[4]*c+x[8]*w,this.y=x[1]*s+x[5]*c+x[9]*w,this.z=x[2]*s+x[6]*c+x[10]*w,this.normalize()}clone(){return new M(this.x,this.y,this.z)}unproject(a){const s=_;return s.multiplyMatrices(a.matrixWorld,s.getInverse(a.projectionMatrix)),this.applyMatrix4(s)}}p=new M,y=new M,k=new M;class P{constructor(a=1,s=0,c=0,w=0,x=1,T=0,l=0,h=0,C=1){this.elements=new Float32Array(9),this.set(a,s,c,w,x,T,l,h,C)}set(a,s,c,w,x,T,l,h,C){const E=this.elements;return E[0]=a,E[3]=s,E[6]=c,E[1]=w,E[4]=x,E[7]=T,E[2]=l,E[5]=h,E[8]=C,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(a){const s=a.elements;this.set(s[0],s[3],s[6],s[1],s[4],s[7],s[2],s[5],s[8])}multiplyScalar(a){const s=this.elements;return s[0]*=a,s[3]*=a,s[6]*=a,s[1]*=a,s[4]*=a,s[7]*=a,s[2]*=a,s[5]*=a,s[8]*=a,this}getInverse3(a){const s=a.elements,c=this.elements;c[0]=s[4]*s[8]-s[5]*s[7],c[3]=s[6]*s[5]-s[3]*s[8],c[6]=s[3]*s[7]-s[6]*s[4],c[1]=s[7]*s[2]-s[1]*s[8],c[4]=s[0]*s[8]-s[6]*s[2],c[7]=s[1]*s[6]-s[0]*s[7],c[2]=s[1]*s[5]-s[2]*s[4],c[5]=s[2]*s[3]-s[0]*s[5],c[8]=s[0]*s[4]-s[1]*s[3];const w=s[0]*c[0]+s[3]*c[1]+s[6]*c[2];return this.multiplyScalar(1/w),this}getInverse(a,s){const c=a.elements,w=this.elements;w[0]=c[10]*c[5]-c[6]*c[9],w[1]=-c[10]*c[1]+c[2]*c[9],w[2]=c[6]*c[1]-c[2]*c[5],w[3]=-c[10]*c[4]+c[6]*c[8],w[4]=c[10]*c[0]-c[2]*c[8],w[5]=-c[6]*c[0]+c[2]*c[4],w[6]=c[9]*c[4]-c[5]*c[8],w[7]=-c[9]*c[0]+c[1]*c[8],w[8]=c[5]*c[0]-c[1]*c[4];const x=c[0]*w[0]+c[1]*w[3]+c[2]*w[6];if(x===0){const T="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(s)throw new Error(T);return console.warn(T),this.identity(),this}return this.multiplyScalar(1/x),this}getDeterminant(){const a=this.elements;return a[0]*a[4]*a[8]+a[1]*a[5]*a[6]+a[2]*a[3]*a[7]-a[2]*a[4]*a[6]-a[1]*a[3]*a[8]-a[0]*a[5]*a[7]}transpose(){let a;const s=this.elements;return a=s[1],s[1]=s[3],s[3]=a,a=s[2],s[2]=s[6],s[6]=a,a=s[5],s[5]=s[7],s[7]=a,this}clone(){const a=this.elements;return new P(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}getMatrix4(){const a=this.elements;return new g(a[0],a[3],a[6],0,a[1],a[4],a[7],0,a[2],a[5],a[8],0)}}class R{constructor(a,s){this.origin=a!==void 0?a:new M,this.direction=s!==void 0?s:new M}set(a,s){return this.origin.copy(a),this.direction.copy(s),this}copy(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this}at(a,s){return(s||new M).copy(this.direction).multiplyScalar(a).add(this.origin)}recast(a){const s=p;return this.origin.copy(this.at(a,s)),this}closestPointToPoint(a,s){const c=s||new M;c.subVectors(a,this.origin);const w=c.dot(this.direction);return c.copy(this.direction).multiplyScalar(w).add(this.origin)}distanceToPoint(a){const s=p,c=s.subVectors(a,this.origin).dot(this.direction);return s.copy(this.direction).multiplyScalar(c).add(this.origin),s.distanceTo(a)}isIntersectionCylinder(){}isIntersectionSphere(a){return this.distanceToPoint(a.center)<=a.radius}isIntersectionPlane(a){return a.normal.dot(this.direction)!==0||a.distanceToPoint(this.origin)===0}distanceToPlane(a){const s=a.normal.dot(this.direction);return s===0?a.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot(a.normal)+a.constant)/s}intersectPlane(a,s){const c=this.distanceToPlane(a);if(c!==void 0)return this.at(c,s)}applyMatrix4(a){return this.direction.add(this.origin).applyMatrix4(a),this.origin.applyMatrix4(a),this.direction.sub(this.origin),this}clone(){return new R().copy(this)}}}),"./src/WebGL/math/utils/clamp.ts":((n,t,r)=>{r.r(t),r.d(t,{clamp:()=>u});function u(v,_,b){return Math.min(Math.max(v,_),b)}}),"./src/WebGL/math/utils/conversionMatrix3.ts":((n,t,r)=>{r.r(t),r.d(t,{conversionMatrix3:()=>v});var u=r("./src/WebGL/math/math.ts");function v(_,b,p,y,k,g){y=y*Math.PI/180,k=k*Math.PI/180,g=g*Math.PI/180;const M=s=>s*s,P=Math.cos(y),R=Math.cos(k),S=Math.cos(g),a=Math.sin(g);return new u.Matrix3(_,b*S,p*R,0,b*a,p*(P-R*S)/a,0,0,p*Math.sqrt(1-M(P)-M(R)-M(S)+2*P*R*S)/a)}}),"./src/WebGL/math/utils/degToRad.ts":((n,t,r)=>{r.r(t),r.d(t,{degToRad:()=>v});const u=Math.PI/180;function v(_){return _*u}}),"./src/WebGL/objects/Line.ts":((n,t,r)=>{r.r(t),r.d(t,{Line:()=>b,LineStyle:()=>_});var u=r("./src/WebGL/materials/index.ts"),v=r("./src/WebGL/core/index.ts"),_;(function(p){p[p.LineStrip=0]="LineStrip",p[p.LinePieces=1]="LinePieces"})(_||(_={}));class b extends v.Object3D{constructor(y,k=new u.LineBasicMaterial({color:Math.random()*16777215}),g=_.LineStrip){super(),this.geometry=y,this.material=k,this.type=g}clone(y=new b(this.geometry,this.material,this.type)){return super.clone.call(this,y),y}}}),"./src/WebGL/objects/Mesh.ts":((n,t,r)=>{r.r(t),r.d(t,{Mesh:()=>v});var u=r("./src/WebGL/core/index.ts");class v extends u.Object3D{constructor(b,p){super(),this.geometry=b,this.material=p}clone(b){return b===void 0&&(b=new v(this.geometry,this.material)),super.clone.call(this,b),b}}}),"./src/WebGL/objects/Sprite.ts":((n,t,r)=>{r.r(t),r.d(t,{Sprite:()=>_});var u=r("./src/WebGL/materials/index.ts"),v=r("./src/WebGL/core/index.ts");class _ extends v.Object3D{constructor(p=new u.SpriteMaterial){super(),this.material=p,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),(this.scale.x!==1||this.scale.y!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(p=new _(this.material)){return v.Object3D.prototype.clone.call(this,p),p}}}),"./src/WebGL/objects/index.ts":((n,t,r)=>{r.r(t),r.d(t,{Line:()=>u.Line,LineStyle:()=>u.LineStyle,Mesh:()=>v.Mesh,Sprite:()=>_.Sprite});var u=r("./src/WebGL/objects/Line.ts"),v=r("./src/WebGL/objects/Mesh.ts"),_=r("./src/WebGL/objects/Sprite.ts")}),"./src/WebGL/shaders/ShaderType.ts":((n,t,r)=>{r.r(t)}),"./src/WebGL/shaders/index.ts":((n,t,r)=>{r.r(t),r.d(t,{ShaderLib:()=>u.ShaderLib,ShaderUtils:()=>v.ShaderUtils,basic:()=>u.basic,clone:()=>v.clone,instanced:()=>u.instanced,lambert:()=>u.lambert,lambertdouble:()=>u.lambertdouble,outline:()=>u.outline,screen:()=>u.screen,screenaa:()=>u.screenaa,sphereimposter:()=>u.sphereimposter,sphereimposteroutline:()=>u.sphereimposteroutline,sprite:()=>u.sprite,stickimposter:()=>u.stickimposter,stickimposteroutline:()=>u.stickimposteroutline,volumetric:()=>u.volumetric});var u=r("./src/WebGL/shaders/lib/index.ts"),v=r("./src/WebGL/shaders/utils/index.ts");r("./src/WebGL/shaders/ShaderType.ts")}),"./src/WebGL/shaders/lib/basic/index.ts":((n,t,r)=>{r.r(t),r.d(t,{basic:()=>b});var u=r("./src/WebGL/shaders/lib/basic/uniforms.ts"),v=r("./src/WebGL/shaders/lib/basic/basic.frag"),_=r("./src/WebGL/shaders/lib/basic/basic.vert");const b={vertexShader:_.default.replace("#define GLSLIFY 1",""),fragmentShader:v.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/basic/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}}}),"./src/WebGL/shaders/lib/blur/index.ts":((n,t,r)=>{r.r(t),r.d(t,{blur:()=>b});var u=r("./src/WebGL/shaders/lib/blur/uniforms.ts"),v=r("./src/WebGL/shaders/lib/blur/blur.frag"),_=r("./src/WebGL/shaders/lib/blur/blur.vert");const b={fragmentShader:v.default,vertexShader:_.default,uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/blur/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>u});const u={}}),"./src/WebGL/shaders/lib/index.ts":((n,t,r)=>{r.r(t),r.d(t,{ShaderLib:()=>w,basic:()=>u.basic,instanced:()=>v.instanced,lambert:()=>_.lambert,lambertdouble:()=>b.lambertdouble,outline:()=>p.outline,screen:()=>y.screen,screenaa:()=>k.screenaa,sphereimposter:()=>g.sphereimposter,sphereimposteroutline:()=>M.sphereimposteroutline,sprite:()=>P.sprite,stickimposter:()=>R.stickimposter,stickimposteroutline:()=>S.stickimposteroutline,volumetric:()=>a.volumetric});var u=r("./src/WebGL/shaders/lib/basic/index.ts"),v=r("./src/WebGL/shaders/lib/instanced/index.ts"),_=r("./src/WebGL/shaders/lib/lambert/index.ts"),b=r("./src/WebGL/shaders/lib/lambertdouble/index.ts"),p=r("./src/WebGL/shaders/lib/outline/index.ts"),y=r("./src/WebGL/shaders/lib/screen/index.ts"),k=r("./src/WebGL/shaders/lib/screenaa/index.ts"),g=r("./src/WebGL/shaders/lib/sphereimposter/index.ts"),M=r("./src/WebGL/shaders/lib/sphereimposteroutline/index.ts"),P=r("./src/WebGL/shaders/lib/sprite/index.ts"),R=r("./src/WebGL/shaders/lib/stickimposter/index.ts"),S=r("./src/WebGL/shaders/lib/stickimposteroutline/index.ts"),a=r("./src/WebGL/shaders/lib/volumetric/index.ts"),s=r("./src/WebGL/shaders/lib/ssao/index.ts"),c=r("./src/WebGL/shaders/lib/blur/index.ts");const w={basic:u.basic,blur:c.blur,instanced:v.instanced,lambert:_.lambert,lambertdouble:b.lambertdouble,outline:p.outline,screen:y.screen,screenaa:k.screenaa,ssao:s.ssao,sphereimposter:g.sphereimposter,sphereimposteroutline:M.sphereimposteroutline,sprite:P.sprite,stickimposter:R.stickimposter,stickimposteroutline:S.stickimposteroutline,volumetric:a.volumetric}}),"./src/WebGL/shaders/lib/instanced/index.ts":((n,t,r)=>{r.r(t),r.d(t,{instanced:()=>b});var u=r("./src/WebGL/shaders/lib/instanced/uniforms.ts"),v=r("./src/WebGL/shaders/lib/instanced/instanced.frag"),_=r("./src/WebGL/shaders/lib/instanced/instanced.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:_.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/instanced/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/lambert/index.ts":((n,t,r)=>{r.r(t),r.d(t,{lambert:()=>b});var u=r("./src/WebGL/shaders/lib/lambert/uniforms.ts"),v=r("./src/WebGL/shaders/lib/lambert/lambert.frag"),_=r("./src/WebGL/shaders/lib/lambert/lambert.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:_.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/lambert/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/lambertdouble/index.ts":((n,t,r)=>{r.r(t),r.d(t,{lambertdouble:()=>b});var u=r("./src/WebGL/shaders/lib/lambertdouble/uniforms.ts"),v=r("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag"),_=r("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:_.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/lambertdouble/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/outline/index.ts":((n,t,r)=>{r.r(t),r.d(t,{outline:()=>b});var u=r("./src/WebGL/shaders/lib/outline/uniforms.ts"),v=r("./src/WebGL/shaders/lib/outline/outline.frag"),_=r("./src/WebGL/shaders/lib/outline/outline.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:_.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/outline/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new u.Color(0,0,0)},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/screen/index.ts":((n,t,r)=>{r.r(t),r.d(t,{screen:()=>b});var u=r("./src/WebGL/shaders/lib/screen/uniforms.ts"),v=r("./src/WebGL/shaders/lib/screen/screen.frag"),_=r("./src/WebGL/shaders/lib/screen/screen.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:_.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/screen/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>u});const u={}}),"./src/WebGL/shaders/lib/screenaa/index.ts":((n,t,r)=>{r.r(t),r.d(t,{screenaa:()=>b});var u=r("./src/WebGL/shaders/lib/screenaa/uniforms.ts"),v=r("./src/WebGL/shaders/lib/screenaa/screenaa.frag"),_=r("./src/WebGL/shaders/lib/screenaa/screenaa.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:_.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/screenaa/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>u});const u={}}),"./src/WebGL/shaders/lib/sphereimposter/index.ts":((n,t,r)=>{r.r(t),r.d(t,{sphereimposter:()=>b});var u=r("./src/WebGL/shaders/lib/sphereimposter/uniforms.ts"),v=r("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag"),_=r("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert");const b={vertexShader:_.default.replace("#define GLSLIFY 1",""),fragmentShader:v.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/sphereimposter/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/sphereimposteroutline/index.ts":((n,t,r)=>{r.r(t),r.d(t,{sphereimposteroutline:()=>b});var u=r("./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts"),v=r("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag"),_=r("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:_.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new u.Color(0,0,0)},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/sprite/index.ts":((n,t,r)=>{r.r(t),r.d(t,{sprite:()=>b});var u=r("./src/WebGL/shaders/lib/sprite/uniforms.ts"),v=r("./src/WebGL/shaders/lib/sprite/sprite.frag"),_=r("./src/WebGL/shaders/lib/sprite/sprite.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:_.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/sprite/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>u});const u={}}),"./src/WebGL/shaders/lib/ssao/index.ts":((n,t,r)=>{r.r(t),r.d(t,{ssao:()=>b});var u=r("./src/WebGL/shaders/lib/ssao/uniforms.ts"),v=r("./src/WebGL/shaders/lib/ssao/ssao.frag"),_=r("./src/WebGL/shaders/lib/ssao/ssao.vert");const b={fragmentShader:v.default,vertexShader:_.default,uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/ssao/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>u});const u={total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}}),"./src/WebGL/shaders/lib/stickimposter/index.ts":((n,t,r)=>{r.r(t),r.d(t,{stickimposter:()=>p});var u=r("./src/WebGL/shaders/lib/stickimposter/uniforms.ts"),v=r("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),_=r("./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag"),b=r("./src/WebGL/shaders/lib/stickimposter/stickimposter.vert");const p={fragmentShader:[v.default,_.default].join(`
`),vertexShader:b.default,uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/stickimposter/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/stickimposteroutline/index.ts":((n,t,r)=>{r.r(t),r.d(t,{stickimposteroutline:()=>b});var u=r("./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts"),v=r("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),_=r("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert");const b={fragmentShader:v.default+"gl_FragColor = vec4(color,1.0);}",vertexShader:_.default,uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new u.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/volumetric/index.ts":((n,t,r)=>{r.r(t),r.d(t,{volumetric:()=>b});var u=r("./src/WebGL/shaders/lib/volumetric/uniforms.ts"),v=r("./src/WebGL/shaders/lib/volumetric/volumetric.frag"),_=r("./src/WebGL/shaders/lib/volumetric/volumetric.vert");const b={fragmentShader:v.default.replace("#define GLSLIFY 1",""),vertexShader:_.default.replace("#define GLSLIFY 1",""),uniforms:u.uniforms}}),"./src/WebGL/shaders/lib/volumetric/uniforms.ts":((n,t,r)=>{r.r(t),r.d(t,{uniforms:()=>v});var u=r("./src/colors.ts");const v={opacity:{type:"f",value:1},fogColor:{type:"c",value:new u.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}}}),"./src/WebGL/shaders/utils/clone.ts":((n,t,r)=>{r.r(t),r.d(t,{clone:()=>v});var u=r("./src/colors.ts");function v(_){let b={};for(const y in _){b[y]={},b[y].type=_[y].type;var p=_[y].value;p instanceof u.Color?b[y].value=p.clone():typeof p=="number"?b[y].value=p:p instanceof Array?b[y].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return b}}),"./src/WebGL/shaders/utils/index.ts":((n,t,r)=>{r.r(t),r.d(t,{ShaderUtils:()=>v,clone:()=>u.clone});var u=r("./src/WebGL/shaders/utils/clone.ts");const v={clone:u.clone}}),"./src/WebGL/shapes/Cylinder.ts":((n,t,r)=>{r.r(t),r.d(t,{Cylinder:()=>_});var u=r("./src/WebGL/math/index.ts");let v=new u.Vector3;class _{constructor(p=new u.Vector3,y=new u.Vector3,k=0){this.c1=p,this.c2=y,this.radius=k,this.direction=new u.Vector3().subVectors(this.c2,this.c1).normalize()}copy(p){return this.c1.copy(p.c1),this.c2.copy(p.c2),this.direction.copy(p.direction),this.radius=p.radius,this}lengthSq(){return v.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(p){return this.direction.add(this.c1).applyMatrix4(p),this.c1.applyMatrix4(p),this.c2.applyMatrix4(p),this.direction.sub(this.c1).normalize(),this.radius=this.radius*p.getMaxScaleOnAxis(),this}}}),"./src/WebGL/shapes/Sphere.ts":((n,t,r)=>{r.r(t),r.d(t,{Sphere:()=>v});var u=r("./src/WebGL/math/index.ts");class v{constructor(b={x:0,y:0,z:0},p=0){this.center=new u.Vector3(b.x,b.y,b.z),this.radius=p}set(b,p){return this.center.copy(b),this.radius=p,this}copy(b){return this.center.copy(b.center),this.radius=b.radius,this}applyMatrix4(b){return this.center.applyMatrix4(b),this.radius=this.radius*b.getMaxScaleOnAxis(),this}translate(b){return this.center.add(b),this}equals(b){return b.center.equals(this.center)&&b.radius===this.radius}clone(){return new v().copy(this)}}}),"./src/WebGL/shapes/Triangle.ts":((n,t,r)=>{r.r(t),r.d(t,{Triangle:()=>_});var u=r("./src/WebGL/math/index.ts");const v=new u.Vector3;class _{constructor(p=new u.Vector3,y=new u.Vector3,k=new u.Vector3){this.a=p,this.b=y,this.c=k}copy(p){return this.a.copy(p.a),this.b.copy(p.b),this.c.copy(p.c),this}applyMatrix4(p){return this.a.applyMatrix4(p),this.b.applyMatrix4(p),this.c.applyMatrix4(p),this}getNormal(){var p=this.a.clone();return p.sub(this.b),v.subVectors(this.c,this.b),p.cross(v),p.normalize(),p}}}),"./src/WebGL/shapes/index.ts":((n,t,r)=>{r.r(t),r.d(t,{Cylinder:()=>v.Cylinder,Sphere:()=>u.Sphere,Triangle:()=>_.Triangle});var u=r("./src/WebGL/shapes/Sphere.ts"),v=r("./src/WebGL/shapes/Cylinder.ts"),_=r("./src/WebGL/shapes/Triangle.ts")}),"./src/autoload.ts":((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{autoinit:()=>autoinit,autoload:()=>autoload,processing_autoinit:()=>processing_autoinit,viewers:()=>viewers});var _GLViewer__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/GLViewer.ts"),_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/ProteinSurface4.ts"),_utilities__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utilities.ts"),_colors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/colors.ts"),autoinit=!1,processing_autoinit=!1,viewers={};function autoload(viewer,callback){var i,dataname,type;if(document.querySelector(".viewer_3Dmoljs")!=null&&(autoinit=!0),autoinit){processing_autoinit=!0,viewer=viewer??null;var nviewers=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(viewerdiv=>{var datauri=[],datatypes=[],uri="";viewerdiv.style.position=="static"&&(viewerdiv.style.position="relative");var UI=null;if(type=null,viewerdiv.dataset.pdb)datauri.push("https://files.rcsb.org/view/"+viewerdiv.dataset.pdb+".pdb"),datatypes.push("pdb");else if(viewerdiv.dataset.cid)datatypes.push("sdf"),datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+viewerdiv.dataset.cid+"/SDF?record_type=3d");else if(viewerdiv.dataset.href||viewerdiv.dataset.url){if(viewerdiv.dataset.href?uri=viewerdiv.dataset.href:uri=viewerdiv.dataset.url,datauri.push(uri),type=uri.substring(uri.lastIndexOf(".")+1),type=="gz"){let n=uri.substring(0,uri.lastIndexOf(".")).lastIndexOf(".");type=uri.substring(n+1)}datatypes.push(type);var molName=uri.substring(uri.lastIndexOf("/")+1,uri.lastIndexOf("."));molName=="/"&&(molName=uri.substring(uri.lastIndexOf("/")+1)),viewerdiv.dataset[datatypes[datatypes.length-1]]=molName}let divdata=viewerdiv.dataset;for(i in divdata)i.substring(0,3)==="pdb"&&i!=="pdb"?(datauri.push("https://files.rcsb.org/view/"+divdata[i]+".pdb"),datatypes.push("pdb")):i.substring(0,4)==="href"&&i!=="href"?(uri=divdata[i],datauri.push(uri),datatypes.push(uri.substring(uri.lastIndexOf(".")+1))):i.substring(0,3)==="cid"&&i!=="cid"&&(datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+divdata[i]+"/SDF?record_type=3d"),datatypes.push("sdf"));var options={};viewerdiv.dataset.options&&(options=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.options));var bgcolor=_colors__WEBPACK_IMPORTED_MODULE_3__.CC.color(viewerdiv.dataset.backgroundcolor),bgalpha=viewerdiv.dataset.backgroundalpha;bgalpha=bgalpha==null?1:parseFloat(bgalpha);var style={line:{}};viewerdiv.dataset.style&&(style=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.style));var select={};viewerdiv.dataset.select&&(select=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.select));var selectstylelist=[],surfaces=[],labels=[],zoomto={},spin=null,d=viewerdiv.dataset,stylere=/style(.+)/,surfre=/surface(.*)/,reslabre=/labelres(.*)/,keys=[];for(dataname in d)Object.prototype.hasOwnProperty.call(d,dataname)&&keys.push(dataname);for(keys.sort(),i=0;i<keys.length;i++){dataname=keys[i];var m=stylere.exec(dataname),selname,newsel,styleobj;m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),selectstylelist.push([newsel,styleobj])),m=surfre.exec(dataname),m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),surfaces.push([newsel,styleobj])),m=reslabre.exec(dataname),m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),labels.push([newsel,styleobj])),dataname=="zoomto"&&(zoomto=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname])),dataname=="spin"&&(spin=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]))}var applyStyles=function(n){for(n.setStyle(select,style),UI&&UI.createSelectionAndStyle(select,style),i=0;i<selectstylelist.length;i++){let t=selectstylelist[i][0]||{},r=selectstylelist[i][1]||{line:{}};n.setStyle(t,r),UI&&UI.createSelectionAndStyle(select,style)}for(i=0;i<surfaces.length;i++){let t=surfaces[i][0]||{},r=surfaces[i][1]||{};UI?n.addSurface(_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__.SurfaceType.VDW,r,t,t).then(u=>{UI.loadSurface("VDW",t,r,u)}):n.addSurface(_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__.SurfaceType.VDW,r,t,t)}for(i=0;i<labels.length;i++){let t=labels[i][0]||{},r=labels[i][1]||{};n.addResLabels(t,r)}n.render(),n.zoomTo(zoomto),spin&&n.spin(spin.axis,spin.speed)};let glviewer=viewer;try{var config=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.config)||{};config.backgroundColor===void 0&&(config.backgroundColor=bgcolor),config.backgroundAlpha===void 0&&(config.backgroundAlpha=bgalpha),glviewer==null?glviewer=viewers[viewerdiv.id||nviewers++]=(0,_GLViewer__WEBPACK_IMPORTED_MODULE_0__.createViewer)(viewerdiv,config):(glviewer.setBackgroundColor(bgcolor,bgalpha),glviewer.setConfig(config),UI&&UI.initiateUI()),viewerdiv.dataset.ui&&$3Dmol.StateManager&&(UI=new $3Dmol.StateManager(glviewer))}catch(n){console.log(n),viewerdiv.textContent="WebGL appears to be disabled."}if(datauri.length!=0){let i=0,process=((viewerdiv,glviewer)=>function(moldata){uri=datauri[i];var type=viewerdiv.dataset.type||viewerdiv.dataset.datatype||datatypes[i];if(glviewer.addModel(moldata,type,options),UI){var modelName=viewerdiv.dataset[datatypes[i]];UI.setModelTitle(modelName)}if(i+=1,i<datauri.length)(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.get)(datauri[i]).then(process);else{if(applyStyles(glviewer),viewerdiv.dataset.callback){var runres=eval(viewerdiv.dataset.callback);typeof runres=="function"&&runres(glviewer)}processing_autoinit=!1,callback&&callback(glviewer)}})(viewerdiv,glviewer);type&&type.endsWith("gz")?(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.getbin)(datauri[0]).then(process):(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.get)(datauri[0]).then(process)}else{if(viewerdiv.dataset.element){var moldataid="#"+viewerdiv.dataset.element,molelem=document.querySelector(moldataid),moldata=molelem?molelem.textContent:"";type=viewerdiv.dataset.type||viewerdiv.dataset.datatype,glviewer.addModel(moldata,type,options)}if(applyStyles(glviewer),viewerdiv.dataset.callback){var runres=eval(viewerdiv.dataset.callback);typeof runres=="function"&&runres(glviewer)}processing_autoinit=!1,callback&&callback(glviewer)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&autoload()}}),"./src/colors.ts":((n,t,r)=>{r.r(t),r.d(t,{CC:()=>v,Color:()=>u,builtinColorSchemes:()=>M,chains:()=>g,elementColors:()=>y,htmlColors:()=>_,residues:()=>k,ssColors:()=>b});class u{constructor(R,S,a){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof R=="number"?(this.r=R||0,this.g=S||0,this.b=a||0,this):this.set(R||0)}set(R){return R instanceof u?R.clone():(typeof R=="number"?this.setHex(R):typeof R=="object"&&(this.r=R?.r||0,this.g=R?.g||0,this.b=R?.b||0),this)}setHex(R){return R=Math.floor(R),this.r=(R>>16&255)/255,this.g=(R>>8&255)/255,this.b=(R&255)/255,this}getHex(){var R=Math.round(this.r*255),S=Math.round(this.g*255),a=Math.round(this.b*255);return R<<16|S<<8|a}clone(){return new u(this.r,this.g,this.b)}copy(R){return this.r=R.r,this.g=R.g,this.b=R.b,this}scaled(){var R={};return R.r=Math.round(this.r*255),R.g=Math.round(this.g*255),R.b=Math.round(this.b*255),R.a=1,R}}class v{static color(R){if(!R)return v.cache[0];if(R instanceof u)return R;if(typeof R=="number"&&typeof v.cache[R]<"u")return v.cache[R];if(R&&Array.isArray(R))return R.map(v.color);let S=v.getHex(R),a=new u(S);return v.cache[S]=a,a}static getHex(R){var S;if(Array.isArray(R))return R.map(v.getHex);if(typeof R=="string"){let a=R;if(!isNaN(parseInt(a)))return parseInt(a);if(a=a.trim(),a.length==4&&a[0]=="#"&&(a="#"+a[1]+a[1]+a[2]+a[2]+a[3]+a[3]),a.length==7&&a[0]=="#")return parseInt(a.substring(1),16);let s=v.rgbRegEx.exec(a);if(s){s[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let c=0;for(let w=2;w<5;w++){c*=256;let x=s[w].endsWith("%")?255*parseFloat(s[w])/100:parseFloat(s[w]);c+=Math.round(x)}return c}return((S=window?.$3Dmol)===null||S===void 0?void 0:S.htmlColors[R.toLowerCase()])||0}return R}}v.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,v.cache={0:new u(0)};const _={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},b={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},p={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},y={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:p,defaultColors:Object.assign({},p),greenCarbon:Object.assign(Object.assign({},p),{C:65280}),cyanCarbon:Object.assign(Object.assign({},p),{C:65535}),magentaCarbon:Object.assign(Object.assign({},p),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},p),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},p),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},p),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},p),{C:8388736}),blueCarbon:Object.assign(Object.assign({},p),{C:255})},k={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},g={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},M={ssPyMol:{prop:"ss",map:b.pyMol},ssJmol:{prop:"ss",map:b.Jmol},Jmol:{prop:"elem",map:y.Jmol},amino:{prop:"resn",map:k.amino},shapely:{prop:"resn",map:k.shapely},nucleic:{prop:"resn",map:k.nucleic},chain:{prop:"chain",map:g.atom},rasmol:{prop:"elem",map:y.rasmol},default:{prop:"elem",map:y.defaultColors},greenCarbon:{prop:"elem",map:y.greenCarbon},chainHetatm:{prop:"chain",map:g.hetatm},cyanCarbon:{prop:"elem",map:y.cyanCarbon},magentaCarbon:{prop:"elem",map:y.magentaCarbon},purpleCarbon:{prop:"elem",map:y.purpleCarbon},whiteCarbon:{prop:"elem",map:y.whiteCarbon},orangeCarbon:{prop:"elem",map:y.orangeCarbon},yellowCarbon:{prop:"elem",map:y.yellowCarbon},blueCarbon:{prop:"elem",map:y.blueCarbon}}}),"./src/glcartoon.ts":((n,t,r)=>{r.r(t),r.d(t,{drawCartoon:()=>V,subdivide_spline:()=>g});var u=r("./src/WebGL/math/index.ts"),v=r("./src/WebGL/shapes/index.ts"),_=r("./src/WebGL/index.ts"),b=r("./src/Gradient.ts"),p=r("./src/colors.ts"),y=r("./src/GLDraw.ts"),k=r("./src/utilities.ts");function g(O,W){var H=[],q=O;q=[],q.push(O[0]);var U,B,Y,X,j,J,le,se,he;for(U=1,B=O.length-1;U<B;U++)if(j=O[U],J=O[U+1],j.smoothen){var pe=new u.Vector3((j.x+J.x)/2,(j.y+J.y)/2,(j.z+J.z)/2);pe.atom=j.atom,q.push(pe)}else q.push(j);for(q.push(O[O.length-1]),U=-1,Y=q.length;U<=Y-3;U++)if(X=q[U===-1?0:U],j=q[U+1],J=q[U+2],le=q[U===Y-3?Y-1:U+3],se=new u.Vector3().subVectors(J,X).multiplyScalar(.5),he=new u.Vector3().subVectors(le,j).multiplyScalar(.5),!J.skip)for(var ve=0;ve<W;ve++){var ce=1/W*ve,me=j.x+ce*se.x+ce*ce*(-3*j.x+3*J.x-2*se.x-he.x)+ce*ce*ce*(2*j.x-2*J.x+se.x+he.x),Re=j.y+ce*se.y+ce*ce*(-3*j.y+3*J.y-2*se.y-he.y)+ce*ce*ce*(2*j.y-2*J.y+se.y+he.y),Ge=j.z+ce*se.z+ce*ce*(-3*j.z+3*J.z-2*se.z-he.z)+ce*ce*ce*(2*j.z-2*J.z+se.z+he.z),We=new u.Vector3(me,Re,Ge);ve<W/2?We.atom=j.atom:We.atom=J.atom,H.push(We)}return H.push(q[q.length-1]),H}const M=.5,P=1.3,R=.8,S=.4,a=.4;function s(O,W,H,q){for(var U,B,Y,X,j=0,J=W.length;j<J;j++){X=Math.round(j*(q.length-1)/J),Y=p.CC.color(q[X]);var le=O.updateGeoGroup(2),se=le.vertexArray,he=le.colorArray,pe=le.faceArray;U=le.vertices,B=U*3,se[B]=W[j].x,se[B+1]=W[j].y,se[B+2]=W[j].z,se[B+3]=H[j].x,se[B+4]=H[j].y,se[B+5]=H[j].z;for(var ve=0;ve<6;++ve)he[B+3*ve]=Y.r,he[B+1+3*ve]=Y.g,he[B+2+3*ve]=Y.b;if(j>0){var ce=[U,U+1,U-1,U-2],me=le.faceidx;pe[me]=ce[0],pe[me+1]=ce[1],pe[me+2]=ce[3],pe[me+3]=ce[1],pe[me+4]=ce[2],pe[me+5]=ce[3],le.faceidx+=6}le.vertices+=2}}function c(O,W,H,q,U,B,Y){var X,j,J,le;if(J=W.length,J<2||W[0].length<2)return;for(X=0;X<J;X++)W[X]=g(W[X],q);if(le=W[0].length,!U)return s(O,W[0],W[J-1],H);var se,he,pe,ve,ce,me,Re=[],Ge=[],We=[];for(j=0;j<J;j++)Re.push(.25+1.5*Math.sqrt((J-1)*j-Math.pow(j,2))/(J-1)),Ge.push(.5),We.push(2*(Math.pow(j/J,2)-j/J)+.6);var Oe=[];for(j=0;j<J*2-1;j++)Oe[j]=[j,j+1,j+1-2*J,j-2*J];Oe[J*2-1]=[j,j+1-2*J,j+1-4*J,j-2*J];var fe,De,qe,Qe,st,ot,Ke,Je,Xe,je;let Ue=O.updateGeoGroup();for(X=0;X<le;X++){let ie=O.groups,oe=!1;Ue=O.updateGeoGroup(2*J),ie!=O.groups&&X>0&&(X=X-1,oe=!0),ot=Math.round(X*(H.length-1)/le),st=p.CC.color(H[ot]),ce=pe,me=ve,pe=[],ve=[],se=[],W[0][X].atom!==void 0&&(Qe=W[0][X].atom,Y==="oval"?he=Re:Y==="rectangle"?he=Ge:Y==="parabola"&&(he=We)),he||(he=Ge);var ft,ut;for(j=0;j<J;j++)X<le-1?ft=W[j][X+1].clone().sub(W[j][X]):ft=W[j][X-1].clone().sub(W[j][X]).negate(),j<J-1?ut=W[j+1][X].clone().sub(W[j][X]):ut=W[j-1][X].clone().sub(W[j][X]).negate(),se[j]=ut.cross(ft).normalize().multiplyScalar(U*he[j]);for(j=0;j<J;j++)pe[j]=W[j][X].clone().add(se[j].clone().negate());for(j=0;j<J;j++)ve[j]=W[j][X].clone().add(se[j]);for(Ke=Ue.vertexArray,Je=Ue.colorArray,Xe=Ue.faceArray,fe=Ue.vertices,De=fe*3,j=0;j<J;j++)Ke[De+3*j+0]=pe[j].x,Ke[De+3*j+1]=pe[j].y,Ke[De+3*j+2]=pe[j].z;for(j=0;j<J;j++)Ke[De+3*j+0+3*J]=ve[J-1-j].x,Ke[De+3*j+1+3*J]=ve[J-1-j].y,Ke[De+3*j+2+3*J]=ve[J-1-j].z;for(j=0;j<2*J;++j)Je[De+3*j+0]=st.r,Je[De+3*j+1]=st.g,Je[De+3*j+2]=st.b;if(X>0&&!oe){for(j=0;j<J*2;j++)je=[fe+Oe[j][0],fe+Oe[j][1],fe+Oe[j][2],fe+Oe[j][3]],qe=Ue.faceidx,Xe[qe]=je[0],Xe[qe+1]=je[1],Xe[qe+2]=je[3],Xe[qe+3]=je[1],Xe[qe+4]=je[2],Xe[qe+5]=je[3],Ue.faceidx+=6;if(Qe.clickable||Qe.hoverable){var ee=[];ee.push(new v.Triangle(ce[0],pe[0],pe[J-1])),ee.push(new v.Triangle(ce[0],pe[J-1],ce[J-1])),ee.push(new v.Triangle(ce[J-1],pe[J-1],ve[J-1])),ee.push(new v.Triangle(ce[J-1],ve[J-1],me[J-1])),ee.push(new v.Triangle(ve[0],me[0],me[J-1])),ee.push(new v.Triangle(ve[J-1],ve[0],me[J-1])),ee.push(new v.Triangle(pe[0],ce[0],me[0])),ee.push(new v.Triangle(ve[0],pe[0],me[0]));for(j in ee)Qe.intersectionShape.triangle.push(ee[j])}}Ue.vertices+=2*J}for(Ke=Ue.vertexArray,Je=Ue.colorArray,Xe=Ue.faceArray,fe=Ue.vertices,De=fe*3,qe=Ue.faceidx,X=0;X<J-1;X++)je=[X,X+1,2*J-2-X,2*J-1-X],qe=Ue.faceidx,Xe[qe]=je[0],Xe[qe+1]=je[1],Xe[qe+2]=je[3],Xe[qe+3]=je[1],Xe[qe+4]=je[2],Xe[qe+5]=je[3],Ue.faceidx+=6;for(X=0;X<J-1;X++)je=[fe-1-X,fe-2-X,fe-2*J+X+1,fe-2*J+X],qe=Ue.faceidx,Xe[qe]=je[0],Xe[qe+1]=je[1],Xe[qe+2]=je[3],Xe[qe+3]=je[1],Xe[qe+4]=je[2],Xe[qe+5]=je[3],Ue.faceidx+=6}function w(O,W,H,q,U,B){if(!(W.length<2)){var Y,X;if(Y=W[0],X=W[W.length-1],Y=g(Y,q),X=g(X,q),!U)return s(O,Y,X,H);var j=[],J,le,se,he,pe,ve=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],ce,me,Re,Ge,We,Oe,fe,De,qe,Qe,st,ot,Ke,Je,Xe,je,Ue;for(De=0,qe=Y.length;De<qe;De++){if(We=Math.round(De*(H.length-1)/qe),Ge=p.CC.color(H[We]),j.push(le=Y[De]),j.push(le),j.push(se=X[De]),j.push(se),De<qe-1){var ft=Y[De+1].clone().sub(Y[De]),ut=X[De].clone().sub(Y[De]);J=ut.cross(ft).normalize().multiplyScalar(U)}for(j.push(he=Y[De].clone().add(J)),j.push(he),j.push(pe=X[De].clone().add(J)),j.push(pe),le.atom!==void 0&&(Oe=le.atom),Je=O.updateGeoGroup(8),Xe=Je.vertexArray,je=Je.colorArray,Ue=Je.faceArray,ce=Je.vertices,me=ce*3,Xe[me]=le.x,Xe[me+1]=le.y,Xe[me+2]=le.z,Xe[me+3]=le.x,Xe[me+4]=le.y,Xe[me+5]=le.z,Xe[me+6]=se.x,Xe[me+7]=se.y,Xe[me+8]=se.z,Xe[me+9]=se.x,Xe[me+10]=se.y,Xe[me+11]=se.z,Xe[me+12]=he.x,Xe[me+13]=he.y,Xe[me+14]=he.z,Xe[me+15]=he.x,Xe[me+16]=he.y,Xe[me+17]=he.z,Xe[me+18]=pe.x,Xe[me+19]=pe.y,Xe[me+20]=pe.z,Xe[me+21]=pe.x,Xe[me+22]=pe.y,Xe[me+23]=pe.z,Qe=0;Qe<8;++Qe)je[me+3*Qe]=Ge.r,je[me+1+3*Qe]=Ge.g,je[me+2+3*Qe]=Ge.b;if(De>0){var ee=fe!==void 0&&Oe!==void 0&&fe.serial!==Oe.serial;for(Qe=0;Qe<4;Qe++){var ie=[ce+ve[Qe][0],ce+ve[Qe][1],ce+ve[Qe][2],ce+ve[Qe][3]];if(Re=Je.faceidx,Ue[Re]=ie[0],Ue[Re+1]=ie[1],Ue[Re+2]=ie[3],Ue[Re+3]=ie[1],Ue[Re+4]=ie[2],Ue[Re+5]=ie[3],Je.faceidx+=6,Oe.clickable||fe.clickable||Oe.hoverable||fe.hoverable){var oe=j[ie[3]].clone(),we=j[ie[0]].clone(),Se=j[ie[2]].clone(),He=j[ie[1]].clone();if(oe.atom=j[ie[3]].atom||null,Se.atom=j[ie[2]].atom||null,we.atom=j[ie[0]].atom||null,He.atom=j[ie[1]].atom||null,ee){var Be=oe.clone().add(we).multiplyScalar(.5),K=Se.clone().add(He).multiplyScalar(.5),_e=oe.clone().add(He).multiplyScalar(.5);Qe%2===0?((fe.clickable||fe.hoverable)&&(st=new v.Triangle(Be,_e,oe),ot=new v.Triangle(K,Se,_e),Ke=new v.Triangle(_e,Se,oe),fe.intersectionShape.triangle.push(st),fe.intersectionShape.triangle.push(ot),fe.intersectionShape.triangle.push(Ke)),(Oe.clickable||Oe.hoverable)&&(st=new v.Triangle(we,He,_e),ot=new v.Triangle(He,K,_e),Ke=new v.Triangle(we,_e,Be),Oe.intersectionShape.triangle.push(st),Oe.intersectionShape.triangle.push(ot),Oe.intersectionShape.triangle.push(Ke))):((Oe.clickable||Oe.hoverable)&&(st=new v.Triangle(Be,_e,oe),ot=new v.Triangle(K,Se,_e),Ke=new v.Triangle(_e,Se,oe),Oe.intersectionShape.triangle.push(st),Oe.intersectionShape.triangle.push(ot),Oe.intersectionShape.triangle.push(Ke)),(fe.clickable||fe.hoverable)&&(st=new v.Triangle(we,He,_e),ot=new v.Triangle(He,K,_e),Ke=new v.Triangle(we,_e,Be),fe.intersectionShape.triangle.push(st),fe.intersectionShape.triangle.push(ot),fe.intersectionShape.triangle.push(Ke)))}else(Oe.clickable||Oe.hoverable)&&(st=new v.Triangle(we,He,oe),ot=new v.Triangle(He,Se,oe),Oe.intersectionShape.triangle.push(st),Oe.intersectionShape.triangle.push(ot))}}}Je.vertices+=8,fe=Oe}var Me=j.length-8;for(Je=O.updateGeoGroup(8),Xe=Je.vertexArray,je=Je.colorArray,Ue=Je.faceArray,ce=Je.vertices,me=ce*3,Re=Je.faceidx,De=0;De<4;De++){j.push(j[De*2]),j.push(j[Me+De*2]);var $e=j[De*2],ye=j[Me+De*2];Xe[me+6*De]=$e.x,Xe[me+1+6*De]=$e.y,Xe[me+2+6*De]=$e.z,Xe[me+3+6*De]=ye.x,Xe[me+4+6*De]=ye.y,Xe[me+5+6*De]=ye.z,je[me+6*De]=Ge.r,je[me+1+6*De]=Ge.g,je[me+2+6*De]=Ge.b,je[me+3+6*De]=Ge.r,je[me+4+6*De]=Ge.g,je[me+5+6*De]=Ge.b}Me+=8,st=[ce,ce+2,ce+6,ce+4],ot=[ce+1,ce+5,ce+7,ce+3],Ue[Re]=st[0],Ue[Re+1]=st[1],Ue[Re+2]=st[3],Ue[Re+3]=st[1],Ue[Re+4]=st[2],Ue[Re+5]=st[3],Ue[Re+6]=ot[0],Ue[Re+7]=ot[1],Ue[Re+8]=ot[3],Ue[Re+9]=ot[1],Ue[Re+10]=ot[2],Ue[Re+11]=ot[3],Je.faceidx+=12,Je.vertices+=8}}function x(O,W,H,q,U,B,Y){(!Y||Y==="default")&&(Y="rectangle"),Y==="edged"?w(O,W,H,q,U):(Y==="rectangle"||Y==="oval"||Y==="parabola")&&c(O,W,H,q,U,B,Y)}function T(O){return O&&O.elem==="C"&&O.atom==="CA"}function l(O,W){if(O&&W&&O.chain===W.chain){if(!O.hetflag&&!W.hetflag&&O.reschain===W.reschain&&(O.resi===W.resi||O.resi===W.resi-1))return!0;if(O.resi<W.resi){var H=O.x-W.x,q=O.y-W.y,U=O.z-W.z,B=H*H+q*q+U*U;if(O.atom=="CA"&&W.atom=="CA"&&B<16||(O.atom=="P"||W.atom=="P")&&B<64)return!0}}return!1}function h(O,W,H,q,U){if(!(W==null||W.vertices==0)){U&&(W.initTypedArrays(),W.setUpNormals());var B=new _.MeshDoubleLambertMaterial;B.vertexColors=_.Coloring.FaceColors,typeof H=="number"&&H>=0&&H<1&&(B.transparent=!0,B.opacity=H),B.outline=q;var Y=new _.Mesh(W,B);O.add(Y)}}function C(O,W,H,q,U,B,Y,X,j){var J,le,se,he,pe,ve;if(!(!q||!U||!Y)){var ce=U.sub(q);ce.normalize();var me=X[j];for(le=j+1;le<X.length&&(me=X[le],me.atom!=Y.atom);le++);if(me=me?new u.Vector3(me.x,me.y,me.z):new u.Vector3(0,0,0),me.sub(q),Y.ss==="arrow start"){var Re=me.clone().multiplyScalar(.3).cross(U);q.add(Re);var Ge=me.clone().cross(ce).normalize();ce.rotateAboutVector(Ge,.43)}for(Y.style.cartoon.ribbon?J=Y.style.cartoon.thickness||S:Y.style.cartoon.width?J=Y.style.cartoon.width:Y.ss==="c"?Y.atom==="P"?J=R:J=M:Y.ss==="arrow start"?(J=P,pe=!0):Y.ss==="arrow end"||Y.ss==="h"&&Y.style.cartoon.tubes||Y.ss==="tube start"?J=M:J=P,B!=null&&ce.dot(B)<0&&ce.negate(),ce.multiplyScalar(J),le=0;le<W;le++)se=-1+le*2/(W-1),he=new u.Vector3(q.x+se*ce.x,q.y+se*ce.y,q.z+se*ce.z),he.atom=Y,Y.ss==="s"&&(he.smoothen=!0),O[le].push(he);if(pe)for(ce.multiplyScalar(2),le=0;le<W;le++)se=-1+le*2/(W-1),he=new u.Vector3(q.x+se*ce.x,q.y+se*ce.y,q.z+se*ce.z),he.atom=Y,he.smoothen=!1,he.skip=!0,O[le].push(he);return ve=Y.style.cartoon.style||"default",O.style?O.style!=ve&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),O.style="default"):O.style=ve,(Y.ss==="arrow start"||Y.ss==="arrow end")&&(Y.ss="s"),pe}}const E={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},D={DA:!0,DG:!0,A:!0,G:!0},z={DT:!0,DC:!0,U:!0,C:!0,T:!0},L={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function V(O,W,H,q=10){let U=q,B=q;var Y,X,j,J,le,se,he,pe,ve,ce,me,Re,Ge,We,Oe,fe,De,qe,Qe=new _.Geometry(!0),st=new _.Geometry(!0),ot=[],Ke=[],Je=1,Xe=!1,je={};for(var Ue in b.Gradient.builtinGradients)b.Gradient.builtinGradients.hasOwnProperty(Ue)&&(je[Ue]=new b.Gradient.builtinGradients[Ue](H[1],H[0]));var ft=function(Z,ze){return H&&ze.color==="spectrum"?ze.colorscheme in je?je[ze.colorscheme].valueToHex(Z.resi):je.sinebow.valueToHex(Z.resi):(0,k.getColorFromStyle)(Z,ze).getHex()};for(pe=0;pe<U;pe++)Ke[pe]=[];var ut=!1,ee=!1,ie=[];for(pe in W){if(J=W[pe],J.elem==="C"&&J.atom==="CA"){var oe=l(j,J);oe&&J.ss==="s"?ut=!0:ut&&(j&&X&&j.style.cartoon.arrows&&X.style.cartoon.arrows&&(j.ss="arrow end",X.ss="arrow start"),ut=!1),oe&&(j.ss==="h"||j.ss=="tube start")&&j.style.cartoon.tubes?!ee&&j.ss!="tube start"&&J.style.cartoon.tubes&&(J.ss="tube start",ee=!0):ee&&(j.ss==="tube start"?j.ss="tube end":X&&X.style.cartoon.tubes&&(X.ss="tube end"),ee=!1),X=j,j=J}J&&J.atom in E&&ie.push(J)}ee&&j.style.cartoon.tubes&&(j.ss="tube end",ee=!1);var we=function(Z){Ke[0].length>0&&x(st,Ke,ot,B,he,Je,Ke.style);var ze=[],rt=null;if(Z){for(pe=0;pe<U;pe++)ze[pe]=Ke[pe][Ke[pe].length-1];rt=ot[ot.length-1]}for(Ke=[],pe=0;pe<U;pe++)Ke[pe]=[];if(ot=[],Z){for(pe=0;pe<U;pe++)Ke[pe].push(ze[pe]);ot.push(rt)}h(O,st,Je,Xe,!0),h(O,Qe,Je,Xe,!1),st=new _.Geometry(!0),Qe=new _.Geometry(!0)};j=void 0;for(var Se=0;Se<ie.length;Se++){J=ie[Se];var He=J.resn.trim(),Be=He in L;if(Je=1,Y=J.style.cartoon,j&&j.style.cartoon&&(Je=j.style.cartoon.opacity),j&&j.style.cartoon&&j.style.cartoon.outline&&(Xe=j.style.cartoon.outline),j&&j.style.cartoon&&(!J.style.cartoon||j.style.cartoon.opacity!=J.style.cartoon.opacity)&&we(j.chain==J.chain),Y.style==="trace"){if(!J.hetflag&&(J.elem==="C"&&J.atom==="CA"||Be&&J.atom==="P"||J.atom==="BB")){if(se=ft(J,Y),(0,k.isNumeric)(Y.thickness)?he=Y.thickness:he=S,l(j,J))if(se==le){var K=p.CC.color(se);y.GLDraw.drawCylinder(Qe,j,J,he,K,2,2)}else{var _e=new u.Vector3().addVectors(j,J).multiplyScalar(.5),Me=p.CC.color(le),$e=p.CC.color(se);y.GLDraw.drawCylinder(Qe,j,_e,he,Me,2,0),y.GLDraw.drawCylinder(Qe,_e,J,he,$e,0,2)}if((J.clickable===!0||J.hoverable)&&J.intersectionShape!==void 0){var ye=new u.Vector3(J.x,J.y,J.z);J.intersectionShape.sphere.push(new v.Sphere(ye,he))}j=J,le=se}}else{if(T(J)||Be&&(J.atom==="P"||J.atom.indexOf("O5")==0)){if(qe)if(J.ss==="tube end")qe=!1,De=new u.Vector3(J.x,J.y,J.z),y.GLDraw.drawCylinder(Qe,fe,De,2,p.CC.color(le),1,1),J.ss="h";else if(j.chain!=J.chain||j.ss==="tube end")qe=!1,j.ss="h",De=new u.Vector3(j.x,j.y,j.z),y.GLDraw.drawCylinder(Qe,fe,De,2,p.CC.color(le),1,1);else continue;if(j&&(!l(j,J)||j.ss==="tube start")){for(j.ss==="tube start"&&(qe=!0,fe=new u.Vector3(j.x,j.y,j.z),j.ss="h"),Oe&&(Re?We=new u.Vector3().addVectors(j,Re).multiplyScalar(.5):We=new u.Vector3(j.x,j.y,j.z),y.GLDraw.drawCylinder(Qe,We,Oe,a,p.CC.color(Oe.color),0,2),C(Ke,U,!0,Re,Ge,me,j,ie,Se),ot.push(se),We=null,Oe=null),Ke[0].length>0&&x(st,Ke,ot,B,he,Je,Ke.style),Ke=[],pe=0;pe<U;pe++)Ke[pe]=[];ot=[]}if(j===void 0||j.rescode!=J.rescode||j.resi!=J.resi){if(Oe&&j!=null){We=new u.Vector3().addVectors(j,J).multiplyScalar(.5);var Ne=We.clone().sub(Oe).multiplyScalar(.02);We.add(Ne),y.GLDraw.drawCylinder(Qe,We,Oe,a,p.CC.color(Oe.color),0,2),We=null,Oe=null}se=ft(J,Y),ot.push(se),(0,k.isNumeric)(Y.thickness)?he=Y.thickness:he=S,j=J,ve=new u.Vector3(j.x,j.y,j.z),ve.resi=j.resi,le=se}(J.clickable===!0||J.hoverable===!0)&&(J.intersectionShape===void 0||J.intersectionShape.triangle===void 0)&&(J.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else j!=null&&(T(j)&&J.atom==="O"||Be&&j.atom==="P"&&(J.atom==="OP2"||J.atom==="O2P")||Be&&j.atom.indexOf("O5")==0&&J.atom.indexOf("C5")==0)?(ce=new u.Vector3(J.x,J.y,J.z),ce.resi=J.resi,(J.atom==="OP2"||J.atom==="O2P")&&(Ge=new u.Vector3(J.x,J.y,J.z))):Be&&J.atom.indexOf("O3")==0?Re=new u.Vector3(J.x,J.y,J.z):(J.atom==="N1"&&He in D||J.atom==="N3"&&He in z)&&(Oe=new u.Vector3(J.x,J.y,J.z),Oe.color=(0,k.getColorFromStyle)(J,Y).getHex());ce&&ve&&ce.resi===ve.resi&&(C(Ke,U,!0,ve,ce,me,j,ie,Se),me=ce,ve=null,ce=null,ot.push(se))}}Oe&&(Re?We=new u.Vector3().addVectors(j,Re).multiplyScalar(.5):We=new u.Vector3(j.x,j.y,j.z),y.GLDraw.drawCylinder(Qe,We,Oe,a,p.CC.color(Oe.color),0,2),C(Ke,U,!0,Re,Ge,me,j,ie,Se),ot.push(se)),we(!1)}}),"./src/index.ts":((n,t,r)=>{r.r(t),r.d(t,{CAP:()=>a.CAP,CC:()=>v.CC,CONTEXTS_PER_VIEWPORT:()=>w.CONTEXTS_PER_VIEWPORT,Color:()=>v.Color,CustomLinear:()=>u.CustomLinear,Cylinder:()=>k.Cylinder,GLDraw:()=>a.GLDraw,GLModel:()=>c.GLModel,GLShape:()=>S.GLShape,GLViewer:()=>w.GLViewer,GLVolumetricRender:()=>R.GLVolumetricRender,Gradient:()=>u.Gradient,GradientType:()=>u.GradientType,Label:()=>_.Label,LabelCount:()=>_.LabelCount,MarchingCube:()=>M.MarchingCube,MarchingCubeInitializer:()=>M.MarchingCubeInitializer,Matrix3:()=>y.Matrix3,Matrix4:()=>y.Matrix4,Parsers:()=>p.Parsers,PausableTimer:()=>g.PausableTimer,PointGrid:()=>M.PointGrid,ProteinSurface:()=>M.ProteinSurface,Quaternion:()=>y.Quaternion,ROYGB:()=>u.ROYGB,RWB:()=>u.RWB,Ray:()=>y.Ray,Sinebow:()=>u.Sinebow,Sphere:()=>k.Sphere,SurfaceType:()=>M.SurfaceType,Triangle:()=>k.Triangle,Vector2:()=>y.Vector2,Vector3:()=>y.Vector3,VolumeData:()=>P.VolumeData,adjustVolumeStyle:()=>g.adjustVolumeStyle,applyPartialCharges:()=>b.applyPartialCharges,autoinit:()=>x.autoinit,autoload:()=>x.autoload,base64ToArray:()=>g.base64ToArray,bondLength:()=>p.bondLength,builtinColorSchemes:()=>v.builtinColorSchemes,builtinGradients:()=>u.builtinGradients,chains:()=>v.chains,clamp:()=>y.clamp,conversionMatrix3:()=>y.conversionMatrix3,createStereoViewer:()=>w.createStereoViewer,createViewer:()=>w.createViewer,createViewerGrid:()=>w.createViewerGrid,deepCopy:()=>g.deepCopy,degToRad:()=>y.degToRad,download:()=>g.download,drawCartoon:()=>s.drawCartoon,elementColors:()=>v.elementColors,extend:()=>g.extend,get:()=>g.get,getAtomProperty:()=>g.getAtomProperty,getColorFromStyle:()=>g.getColorFromStyle,getElement:()=>g.getElement,getExtent:()=>g.getExtent,getGradient:()=>u.getGradient,getPropertyRange:()=>g.getPropertyRange,getbin:()=>g.getbin,htmlColors:()=>v.htmlColors,inflateString:()=>g.inflateString,isEmptyObject:()=>g.isEmptyObject,isNumeric:()=>g.isNumeric,makeFunction:()=>g.makeFunction,mergeGeos:()=>g.mergeGeos,normalizeValue:()=>u.normalizeValue,partialCharges:()=>b.partialCharges,processing_autoinit:()=>x.processing_autoinit,residues:()=>v.residues,setBondLength:()=>p.setBondLength,setSyncSurface:()=>M.setSyncSurface,specStringToObject:()=>g.specStringToObject,splitMesh:()=>S.splitMesh,ssColors:()=>v.ssColors,subdivide_spline:()=>s.subdivide_spline,syncSurface:()=>M.syncSurface,viewers:()=>x.viewers});var u=r("./src/Gradient.ts"),v=r("./src/colors.ts"),_=r("./src/Label.ts"),b=r("./src/partialCharges.ts"),p=r("./src/parsers/index.ts"),y=r("./src/WebGL/math/index.ts"),k=r("./src/WebGL/shapes/index.ts"),g=r("./src/utilities.ts"),M=r("./src/ProteinSurface4.ts"),P=r("./src/VolumeData.ts"),R=r("./src/VolumetricRender.ts"),S=r("./src/GLShape.ts"),a=r("./src/GLDraw.ts"),s=r("./src/glcartoon.ts"),c=r("./src/GLModel.ts"),w=r("./src/GLViewer.ts"),x=r("./src/autoload.ts");r("./src/specs.ts"),window&&(window.$3Dmol=t)}),"./src/parsers/BCIF.ts":((n,t,r)=>{r.r(t),r.d(t,{BCIF:()=>S});var u=r("./src/utilities.ts"),v=r("./src/parsers/utils/computeSecondaryStructure.ts"),_=r("./src/parsers/utils/processSymmetries.ts"),b=r("./src/parsers/cifutils/category.ts"),p=r("./src/parsers/utils/assignPDBBonds.ts"),y=r("./src/WebGL/index.ts"),k=r("./src/parsers/utils/isEmpty.ts"),g=r("./src/vendor/mmtf.js");class M{constructor(s){if(this.C={},s){let c=s.getField("comp_id"),w=s.getField("atom_id_1"),x=s.getField("atom_id_2"),T=s.getField("value_order");for(let l=0;l<c.length;l++){let h=c[l],C=w[l],E=x[l],D=T[l],z=1;D=="doub"?z=2:D=="trip"&&(z=3),this.C[h]==null&&(this.C[h]={}),this.C[h][C]==null&&(this.C[h][C]={}),this.C[h][E]==null&&(this.C[h][E]={}),this.C[h][C][E]=z,this.C[h][E][C]=z}}}order(s,c,w){return this.C[s]!==void 0&&this.C[s][c]!==void 0&&this.C[s][c][w]!==void 0?this.C[s][c][w]:0}}class P{constructor(s){if(this.C=[],s){let c=s.getField("conn_type_id"),w=s.getField("ptnr1_label_asym_id"),x=s.getField("ptnr1_label_seq_id"),T=s.getField("ptnr1_label_comp_id"),l=s.getField("ptnr1_label_atom_id"),h=s.getField("ptnr2_label_asym_id"),C=s.getField("ptnr2_label_seq_id"),E=s.getField("ptnr2_label_comp_id"),D=s.getField("ptnr2_label_atom_id"),z=s.getField("pdbx_value_order");for(let L=0;L<c.length;L++)if(c[L]=="disulf"||c[L]=="covale"){let V=z?z[L]==""?1:parseInt(z[L]):1;this.C.push([[w[L],x[L],T[L],l[L]],[h[L],C[L],E[L],D[L]],V])}}}}class R{constructor(){this.R={}}add(s){this.R[s.lchain]==null&&(this.R[s.lchain]={}),this.R[s.lchain][s.lresi]==null&&(this.R[s.lchain][s.lresi]={}),this.R[s.lchain][s.lresi][s.lresn]==null&&(this.R[s.lchain][s.lresi][s.lresn]=[]),this.R[s.lchain][s.lresi][s.lresn].push(s),this.R[s.lchain][s.lresi][s.lresn][s.atom]=s}geta([s,c,w,x]){if(this.R[s]!==void 0&&this.R[s][c]!==void 0&&this.R[s][c][w]!==void 0)return this.R[s][c][w][x]}setBonds(s,c){for(let w in this.R)for(let x in this.R[w])for(let T in this.R[w][x]){let l=this.R[w][x][T];for(let h=0;h<l.length;h++)for(let C=h+1;C<l.length;C++){let E=l[h],D=l[C],z=s.order(T,E.atom,D.atom);z>0&&(E.bonds.push(D.index),D.bonds.push(E.index),E.bondOrder.push(z),D.bondOrder.push(z))}}for(let w of c.C){let x=w[0],T=w[1],l=w[2],h=this.geta(x),C=this.geta(T);h!=null&&C!=null&&(h.bonds.push(C.index),C.bonds.push(h.index),h.bondOrder.push(l),C.bondOrder.push(l))}}}function S(a,s){var c=!s.keepH,w=s.altLoc?s.altLoc:"A",x=!s.noComputeSecondaryStructure;const T=!s.doAssembly,l=s.assignBonds===void 0?!0:s.assignBonds;if(typeof a=="string")try{a=(0,u.base64ToArray)(a)}catch{a=new TextEncoder().encode(a)}else a=new Uint8Array(a);var h=g.decodeMsgpack(a);h==31&&(a=(0,u.inflateString)(a,!1),h=g.decodeMsgpack(a));var C=[],E=C.modelData=[],D=h.dataBlocks.length;if(D==0)return C;s.multimodel||(D=1);for(let z=0;z<D;z++){let L=C.length;const V=[];E.push({symmetries:[]}),C.push([]);const O=h.dataBlocks[z],W=Object.create(null);for(const je of O.categories)W[je.name.substr(1)]=(0,b.Category)(je);let H={},q=W.struct_conf;if(q){let je=q.getField("conf_type_id"),Ue=q.getField("beg_label_asym_id"),ft=q.getField("beg_label_seq_id"),ut=q.getField("end_label_seq_id");for(let ee=0;ee<je.length;ee++)if(je[ee].startsWith("H")){let ie=Ue[ee],oe=ft[ee],we=ut[ee];ie in H||(H[ie]={}),H[ie][oe]="h1";for(let Se=oe+1;Se<we;Se++)H[ie][Se]="h";H[ie][we]="h2"}}let U=W.struct_sheet_range;if(U){let je=U.getField("id"),Ue=U.getField("beg_label_asym_id"),ft=U.getField("beg_label_seq_id"),ut=U.getField("end_label_seq_id");for(let ee=0;ee<je.length;ee++){let ie=Ue[ee],oe=ft[ee],we=ut[ee];ie in H||(H[ie]={}),H[ie][oe]="s1";for(let Se=oe+1;Se<we;Se++)H[ie][Se]="s";H[ie][we]="s2"}}let B=W.pdbx_struct_oper_list,Y=B.getField("id");if(Y&&!T){let je=B.getField("matrix[1][1]"),Ue=B.getField("matrix[1][2]"),ft=B.getField("matrix[1][3]"),ut=B.getField("matrix[2][1]"),ee=B.getField("matrix[2][2]"),ie=B.getField("matrix[2][3]"),oe=B.getField("matrix[3][1]"),we=B.getField("matrix[3][2]"),Se=B.getField("matrix[3][3]"),He=B.getField("vector[1]"),Be=B.getField("vector[2]"),K=B.getField("vector[3]");for(let _e=0;_e<Y.length;_e++){const Me=new y.Matrix4(je[_e],Ue[_e],ft[_e],He[_e],ut[_e],ee[_e],ie[_e],Be[_e],oe[_e],we[_e],Se[_e],K[_e]);E[E.length-1].symmetries.push(Me)}}let X=new M(W.chem_comp_bond),j=new R,J=new P(W.struct_conn),le=W.atom_site,se=le.rowCount,he=le.getField("group_PDB"),pe=le.getField("Cartn_x"),ve=le.getField("Cartn_y"),ce=le.getField("Cartn_z"),me=le.getField("auth_asym_id"),Re=le.getField("label_asym_id"),Ge=le.getField("auth_seq_id"),We=le.getField("label_seq_id"),Oe=le.getField("auth_comp_id"),fe=le.getField("label_comp_id"),De=le.getField("auth_atom_id"),qe=le.getField("label_atom_id"),Qe=le.getField("type_symbol"),st=le.getField("B_iso_or_equiv"),ot=le.getField("id"),Ke=le.getField("label_alt_id"),Je=le.getField("pdbx_PDB_model_num"),Xe=Je?Je[0]:0;for(let je=0;je<se;je++){if(he!==void 0&&he[je]==="TER")continue;if(Je&&Je[je]!=Xe)if(Xe=Je[je],s.multimodel)s.onemol||(C.push([]),E.push(E[E.length-1]),Xe=Je[je],j.setBonds(X,J),j=new R);else break;const Ue={};Ue.x=pe[je],Ue.y=ve[je],Ue.z=ce[je],Ue.chain=me?me[je]:Re?Re[je]:void 0,Ue.lchain=Re?Re[je]:void 0,Ue.resi=Ge?Ge[je]:We?We[je]:void 0,Ue.lresi=We?We[je]:void 0,Ue.resn=Oe?Oe[je].trim():fe?fe[je].trim():void 0,Ue.lresn=fe?fe[je].trim():void 0,Ue.atom=De?De[je].replace(/"/gm,""):qe?qe[je].replace(/"/gm,""):void 0,Ue.icode=Ke?Ke[je]:void 0,Ue.altLoc=Ue.icode,Ue.hetflag=!he||he[je]==="HETA"||he[je]==="HETATM";let ft="X";Qe&&(ft=Qe[je].replace(/\(?\+?\d+.*/,"")),Ue.elem=ft[0].toUpperCase()+ft.substring(1,2).toLowerCase(),st&&(Ue.b=st[je]),!(c&&Ue.elem=="H")&&(Ue.altLoc!=""&&Ue.altLoc!=w&&w!="*"||(Ue.bonds=[],Ue.ss="c",Ue.serial=ot[je],Ue.model=Xe,Ue.bondOrder=[],Ue.properties={},Ue.index=C[C.length-1].length,V[Ue.serial]=[C.length,Ue.index],C[C.length-1].push(Ue),j.add(Ue)))}if(j.setBonds(X,J),!(0,k.isEmpty)(H))for(let je=L;je<C.length;je++){let Ue=C[je];for(let ft=0;ft<Ue.length;ft++){const ut=Ue[ft];if(ut!==void 0&&ut.lchain in H&&ut.lresi in H[ut.lchain]){const ee=H[ut.lchain][ut.lresi];ut.ss=ee[0],ee.length>1&&(ee[1]=="1"?ut.ssbegin=!0:ee[1]=="2"&&(ut.ssend=!0))}}}s.multimodel&&z<D-1&&(s.onemol||(C.push([]),E.push({symmetries:[]})))}for(let z=0;z<C.length;z++)l&&!(s.duplicateAssemblyAtoms&&!s.dontConnectDuplicatedAtoms)&&(0,p.assignPDBBonds)(C[z],s),x&&(0,v.computeSecondaryStructure)(C[z],s.hbondCutoff),(0,_.processSymmetries)(E[z].symmetries,C[z],s,E[z].cryst),s.duplicateAssemblyAtoms&&!s.dontConnectDuplicatedAtoms&&l&&(0,p.assignPDBBonds)(C[z],s);return C}}),"./src/parsers/CDJSON.ts":((n,t,r)=>{r.r(t),r.d(t,{CDJSON:()=>u});function u(v,_){var b=[[]];typeof v=="string"&&(v=JSON.parse(v));for(var p=v.m,y=p[0].a,k=p[0].b,g=p[0].s,M=_!==void 0&&_.parseStyle!==void 0?_.parseStyle:g!==void 0,P=b[b.length-1].length,R=0;R<y.length;R++){var S=y[R],a={};a.id=S.i,a.x=S.x,a.y=S.y,a.z=S.z||0,a.bonds=[],a.bondOrder=[];var s=S.l||"C";a.elem=s[0].toUpperCase()+s.substring(1).toLowerCase(),a.serial=b[b.length-1].length,M&&(a.style=g[S.s||0]),b[b.length-1].push(a)}for(let c=0;c<k.length;c++){let w=k[c],x=w.b+P,T=w.e+P,l=w.o||1,h=b[b.length-1][x],C=b[b.length-1][T];h.bonds.push(T),h.bondOrder.push(l),C.bonds.push(x),C.bondOrder.push(l)}return b}}),"./src/parsers/CIF.ts":((n,t,r)=>{r.r(t),r.d(t,{CIF:()=>y});var u=r("./src/parsers/utils/computeSecondaryStructure.ts"),v=r("./src/parsers/utils/processSymmetries.ts"),_=r("./src/WebGL/index.ts"),b=r("./src/parsers/utils/assignPDBBonds.ts");const p=function(k,g,M,P){return new _.Vector3(g,M,P).applyMatrix3(k)};function y(k,g={}){const M=[],P=!g.doAssembly,R=M.modelData=[],S=g.assignBonds===void 0?!0:g.assignBonds;function a(l,h){const C=[];let E=0,D=0;for(;D<l.length;){for(;l.substring(D,D+h.length)!==h&&D<l.length;)if(l[D]==="'"){for(D++;D<l.length&&l[D]!=="'";)D++;for(;l.substring(D,D+h.length)!==h&&D<l.length;)D++}else if(l[D]==='"'){for(D++;D<l.length&&l[D]!=='"';)D++;D++}else D++;C.push(l.substring(E,D)),E=D=D+h.length}return C}const s=k.split(/\r?\n|\r/),c=[];let w=!1;for(let l=0;l<s.length;l++){var x=s[l].split("#")[0];if(w?x[0]===";"&&(w=!1):x[0]===";"&&(w=!0),w||x!==""){if(!w&&(x=x.trim(),x[0]==="_")){const h=x.split(/\s/)[0].indexOf(".");if(h>-1){let C=x.split("");C[h]="_",x=C.join(""),x=x.substring(0,h)+"_"+x.substring(h+1)}}c.push(x)}}let T=0;for(;T<c.length;){for(;!c[T].startsWith("data_")||c[T]==="data_global";)T++;T++;const l={};for(;T<c.length&&!c[T].startsWith("data_");)if(c[T][0]===void 0)T++;else if(c[T][0]==="_"){const D=c[T].split(/\s/)[0].toLowerCase(),z=l[D]=l[D]||[],L=c[T].substring(c[T].indexOf(D)+D.length);if(L==="")if(T++,c[T][0]===";"){let V=c[T].substring(1);for(T++;c[T]!==";";)V=V+`
`+c[T],T++;z.push(V)}else z.push(c[T]);else z.push(L.trim());T++}else if(c[T].substring(0,5)==="loop_"){T++;const D=[];for(;c[T]===""||c[T][0]==="_";){if(c[T]!==""){let L=c[T].split(/\s/)[0].toLowerCase(),V=l[L]=l[L]||[];D.push(V)}T++}let z=0;for(;T<c.length&&c[T][0]!=="_"&&!c[T].startsWith("loop_")&&!c[T].startsWith("data_");){let L=a(c[T]," ");for(let V=0;V<L.length;V++)L[V]!==""&&(D[z].push(L[V]),z=(z+1)%D.length);T++}}else T++;R.push({symmetries:[]}),M.push([]);const h=l._atom_site_id!==void 0?l._atom_site_id.length:l._atom_site_label.length;let C;if(l._cell_length_a!==void 0){const D=parseFloat(l._cell_length_a),z=parseFloat(l._cell_length_b),L=parseFloat(l._cell_length_c),V=parseFloat(l._cell_angle_alpha)||90,O=parseFloat(l._cell_angle_beta)||90,W=parseFloat(l._cell_angle_gamma)||90;C=(0,_.conversionMatrix3)(D,z,L,V,O,W),R[R.length-1].cryst={a:D,b:z,c:L,alpha:V,beta:O,gamma:W}}for(let D=0;D<h;D++){if(l._atom_site_group_pdb!==void 0&&l._atom_site_group_pdb[D]==="TER")continue;const z={};if(l._atom_site_cartn_x!==void 0)z.x=parseFloat(l._atom_site_cartn_x[D]),z.y=parseFloat(l._atom_site_cartn_y[D]),z.z=parseFloat(l._atom_site_cartn_z[D]);else{const V=p(C,parseFloat(l._atom_site_fract_x[D]),parseFloat(l._atom_site_fract_y[D]),parseFloat(l._atom_site_fract_z[D]));z.x=V.x,z.y=V.y,z.z=V.z}z.chain=l._atom_site_auth_asym_id?l._atom_site_auth_asym_id[D]:l._atom_site_label_asym_id?l._atom_site_label_asym_id[D]:void 0,z.resi=l._atom_site_auth_seq_id?parseInt(l._atom_site_auth_seq_id[D]):l._atom_site_label_seq_id?l._atom_site_label_seq_id[D]:void 0,z.resn=l._atom_site_auth_comp_id?l._atom_site_auth_comp_id[D].trim():l._atom_site_label_comp_id?l._atom_site_label_comp_id[D].trim():void 0,z.atom=l._atom_site_auth_atom_id?l._atom_site_auth_atom_id[D].replace(/"/gm,""):l._atom_site_label_atom_id?l._atom_site_label_atom_id[D].replace(/"/gm,""):void 0,z.hetflag=!l._atom_site_group_pdb||l._atom_site_group_pdb[D]==="HETA"||l._atom_site_group_pdb[D]==="HETATM",l._atom_site_b_iso_or_equiv&&(z.b=parseFloat(l._atom_site_b_iso_or_equiv[D]));let L="X";l._atom_site_type_symbol?L=l._atom_site_type_symbol[D].replace(/\(?\+?\d+.*/,""):l._atom_site_label&&(L=l._atom_site_label[D].split("_")[0].replace(/\(?\d+.*/,"")),z.elem=L[0].toUpperCase()+L.substring(1,2).toLowerCase(),z.bonds=[],z.ss="c",z.serial=D,z.bondOrder=[],z.properties={},M[M.length-1].push(z)}if(l._pdbx_struct_oper_list_id!==void 0&&!P)for(let D=0;D<l._pdbx_struct_oper_list_id.length;D++){const z=parseFloat(l["_pdbx_struct_oper_list_matrix[1][1]"][D]),L=parseFloat(l["_pdbx_struct_oper_list_matrix[1][2]"][D]),V=parseFloat(l["_pdbx_struct_oper_list_matrix[1][3]"][D]),O=parseFloat(l["_pdbx_struct_oper_list_vector[1]"][D]),W=parseFloat(l["_pdbx_struct_oper_list_matrix[2][1]"][D]),H=parseFloat(l["_pdbx_struct_oper_list_matrix[2][2]"][D]),q=parseFloat(l["_pdbx_struct_oper_list_matrix[2][3]"][D]),U=parseFloat(l["_pdbx_struct_oper_list_vector[2]"][D]),B=parseFloat(l["_pdbx_struct_oper_list_matrix[3][1]"][D]),Y=parseFloat(l["_pdbx_struct_oper_list_matrix[3][2]"][D]),X=parseFloat(l["_pdbx_struct_oper_list_matrix[3][3]"][D]),j=parseFloat(l["_pdbx_struct_oper_list_vector[3]"][D]),J=new _.Matrix4(z,L,V,O,W,H,q,U,B,Y,X,j);R[R.length-1].symmetries.push(J)}const E=function(D){const z=D.match("-");D=D.replace(/[-xyz]/g,"");const L=D.split("/");let V,O;return L[1]===void 0?O=1:O=parseInt(L[1]),L[0]===""?V=1:V=parseInt(L[0]),V/O*(z?-1:1)};if(l._symmetry_equiv_pos_as_xyz!==void 0&&!P)for(let D=0;D<l._symmetry_equiv_pos_as_xyz.length;D++){const z=l._symmetry_equiv_pos_as_xyz[D].replace(/["' ]/g,"").split(",").map(function(W){return W.replace(/-/g,"+-")});let L=new _.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let W=0;W<3;W++){const H=z[W].split("+");for(let q=0;q<H.length;q++){const U=H[q];if(U==="")continue;const B=E(U);U.match("x")?L.elements[W+0]=B:U.match("y")?L.elements[W+4]=B:U.match("z")?L.elements[W+8]=B:L.elements[W+12]=B}}const V=C.getMatrix4(),O=new _.Matrix4().getInverse(V,!0);L=new _.Matrix4().multiplyMatrices(L,O),L=new _.Matrix4().multiplyMatrices(V,L),R[R.length-1].symmetries.push(L)}}for(let l=0;l<M.length;l++)S&&!(g.duplicateAssemblyAtoms&&!g.dontConnectDuplicatedAtoms)&&(0,b.assignPDBBonds)(M[l],g),(0,u.computeSecondaryStructure)(M[l],g.hbondCutoff),(0,v.processSymmetries)(R[l].symmetries,M[l],g,R[l].cryst),g.duplicateAssemblyAtoms&&!g.dontConnectDuplicatedAtoms&&S&&(0,b.assignPDBBonds)(M[l],g);return M}}),"./src/parsers/CUBE.ts":((n,t,r)=>{r.r(t),r.d(t,{CUBE:()=>b});var u=r("./src/WebGL/index.ts"),v=r("./src/parsers/utils/assignBonds.ts"),_=r("./src/parsers/utils/anumToSymbol.ts");function b(p,y){y=y||{};const k=[[]];let g=p.split(/\r?\n/);const M=y.assignBonds===void 0?!0:y.assignBonds;if(g.length<6)return k;let P=g[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const R=Math.abs(parseFloat(P[0]));let S={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const a=S.origin=new u.Vector3(parseFloat(P[1]),parseFloat(P[2]),parseFloat(P[3]));P=g[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),P=g[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const s=P[0]>0?.529177:1;a.multiplyScalar(s);const c=Math.abs(P[0]),w=new u.Vector3(parseFloat(P[1]),parseFloat(P[2]),parseFloat(P[3])).multiplyScalar(s);P=g[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const x=Math.abs(P[0]),T=new u.Vector3(parseFloat(P[1]),parseFloat(P[2]),parseFloat(P[3])).multiplyScalar(s);P=g[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const l=Math.abs(P[0]),h=new u.Vector3(parseFloat(P[1]),parseFloat(P[2]),parseFloat(P[3])).multiplyScalar(s);if(S.size={x:c,y:x,z:l},S.unit=new u.Vector3(w.x,T.y,h.z),w.y!=0||w.z!=0||T.x!=0||T.z!=0||h.x!=0||h.y!=0){S.matrix4=new u.Matrix4(w.x,T.x,h.x,0,w.y,T.y,h.y,0,w.z,T.z,h.z,0,0,0,0,1);let O=new u.Matrix4().makeTranslation(a.x,a.y,a.z);S.matrix4=S.matrix4.multiplyMatrices(O,S.matrix4),S.matrix=S.matrix4.matrix3FromTopLeft(),S.origin=new u.Vector3(0,0,0),S.unit=new u.Vector3(1,1,1)}k.modelData=[{cryst:S}],g=g.splice(6,R);for(var C=k[k.length-1].length,E=C+g.length,D=C;D<E;++D){var z={};z.serial=D;var L=g[D-C],V=L.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");z.elem=_.anumToSymbol[V[0]],z.x=parseFloat(V[2])*s,z.y=parseFloat(V[3])*s,z.z=parseFloat(V[4])*s,z.hetflag=!0,z.bonds=[],z.bondOrder=[],z.properties={},k[k.length-1].push(z)}if(M)for(let O=0;O<k.length;O++)(0,v.assignBonds)(k[O],y);return k}}),"./src/parsers/GRO.ts":((n,t,r)=>{r.r(t),r.d(t,{GRO:()=>_});var u=r("./src/parsers/utils/assignPDBBonds.ts"),v=r("./src/parsers/utils/atomNameToElem.ts");function _(b,p){const y=[],k=b.split(/\r?\n|\r/);for(;k.length>0;){const g=parseInt(k[1]);if(k.length<3||isNaN(g)||g<=0||k.length<g+3)break;const M=[];y.push(M);let P=2;const R=M.length,S=R+g;for(let a=R;a<S;a++){const s=k[P++],c={};c.serial=a,c.atom=s.slice(10,15).trim(),c.elem=(0,v.atomNameToElem)(c.atom,!0),c.x=10*parseFloat(s.slice(20,28)),c.y=10*parseFloat(s.slice(28,36)),c.z=10*parseFloat(s.slice(36,44)),c.resi=parseInt(s.slice(0,5)),c.resn=s.slice(5,10).trim(),c.bonds=[],c.bondOrder=[],c.properties={},s.length>44&&(c.dx=10*parseFloat(s.slice(44,52)),c.dy=10*parseFloat(s.slice(52,60)),c.dz=10*parseFloat(s.slice(60,68))),M[a]=c}if(k.length<=P+3){const a=k[P++].trim().split(/\s+/);if(a.length===3){for(let s=0;s<3;s++)a[s]=(parseFloat(a[s])*10).toString();y.box=a}}k.splice(0,++P)}for(let g=0;g<y.length;g++)(0,u.assignPDBBonds)(y[g],p);return y}}),"./src/parsers/LAMMPSTRJ.ts":((n,t,r)=>{r.r(t),r.d(t,{LAMMPSTRJ:()=>_});var u=r("./src/parsers/utils/assignBonds.ts");const v={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function _(b,p){const y=[],k=b.split(/\r?\n|\r/);let g=0,M=0,P=0;for(;P<k.length-9;){for(var R=P;R<k.length;R++)if(k[R].match(/ITEM: NUMBER OF ATOMS/)&&(M=parseInt(k[R+1])),k[R].match(/ITEM: ATOMS/)){g=R+1;break}const S=k[g-1].replace("ITEM: ATOMS ","").split(" ");y.push([]);for(let a=g;a<g+M;a++){const s={},c={},w=k[a].split(" ");for(let x=0;x<w.length;x++){const T=v[S[x]];T!==void 0&&(T==="serial"?s[T]=parseInt(w[x]):T==="x"||T==="y"||T==="z"?s[T]=parseFloat(w[x]):T==="charge"||T==="radius"?c[T]=parseFloat(w[x]):s[T]=w[x]),s.properties=c,s.bonds=[],s.bondOrder=[]}y[y.length-1][a-g]=s}P=g+M-1}if(p.assignBonds)for(let S=0;S<y.length;S++)(0,u.assignBonds)(y[S],p);return y}}),"./src/parsers/MMTF.ts":((n,t,r)=>{r.r(t),r.d(t,{MMTFparser:()=>M});var u=r("./src/utilities.ts"),v=r("./src/WebGL/index.ts"),_=r("./src/parsers/utils/computeSecondaryStructure.ts"),b=r("./src/parsers/utils/processSymmetries.ts"),p=r("./src/vendor/mmtf.js"),y=function(P){return String.fromCharCode.apply(null,P).replace(/\0/g,"")},k=function(P){return P==0||P==2||P==4?"h":P==3?"s":"c"};let g=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function M(P,R){var S=!R.keepH,a=R.altLoc?R.altLoc:"A",s=!!R.noSecondaryStructure,c=!R.noComputeSecondaryStructure,w=!R.doAssembly,x=R.assemblyIndex?R.assemblyIndex:0;typeof P=="string"?P=(0,u.base64ToArray)(P):P=new Uint8Array(P);var T=p.decode(P),l=[[]],h=l.modelData=[],C=0,E=0,D=0,z=T.secStructList,L=T.bFactorList,V=T.altLocList,O=T.occupancyList,W=T.bondAtomList,H=T.bondOrderList,q=T.numModels;if(q==0)return l;R.multimodel||(q=1);var U,B,Y,X,j,J,le=[];if(!w&&T.bioAssemblyList&&T.bioAssemblyList.length>0){var se=T.bioAssemblyList[x].transformList;for(U=0,J=se.length;U<J;U++){var he=new v.Matrix4(se[U].matrix);he.transpose(),le.push(he)}}var pe=null;if(T.unitCell){var ve=T.unitCell;pe={a:ve[0],b:ve[1],c:ve[2],alpha:ve[3],beta:ve[4],gamma:ve[5]}}let ce=[];T.entityList.forEach(Ee=>{Ee.chainIndexList.forEach(re=>{ce[re]=Ee.type=="polymer"})});var me=0;for(j=0;j<q;j++){var Re=T.chainsPerModel[j],Ge=l[l.length-1],We=[];for(h.push({symmetries:le,cryst:pe}),U=0;U<Re;++U){var Oe=T.groupsPerChain[C],fe=y(T.chainIdList.subarray(C*4,C*4+4));T.chainNameList&&(fe=y(T.chainNameList.subarray(C*4,C*4+4)));var De=E,qe="";for(B=0;B<Oe;++B){var Qe=T.groupList[T.groupTypeList[E]],st=Qe.atomNameList.length,ot=0,Ke=!1,Je=!1;if(z){ot=z[E];var Xe=k(ot);(E==0||Xe!=qe)&&(Ke=!0),qe=Xe;var je=E+1;(je>=z.length||k(z[je]!=Xe))&&(Je=!0)}var Ue=T.groupIdList[E],ft=Qe.groupName;let Ee=Qe.chemCompType;var ut=D;let re=g.has(Ee)||!ce[C];for(Y=0;Y<st;++Y){var ee=Qe.elementList[Y];if(S&&ee=="H"){D+=1;continue}var ie="";L&&(ie=L[D]);var oe="";V&&V[D]&&(oe=String.fromCharCode(V[D]));var we="";if(O&&(we=O[D]),oe!=""&&oe!=a&&a!="*"){D+=1;continue}var Se=T.atomIdList[D],He=Qe.atomNameList[Y],Be=0;Qe.atomChargeList&&(Be=Qe.atomChargeList[Y]);var K=T.xCoordList[D],_e=T.yCoordList[D],Me=T.zCoordList[D];We[D]=Ge.length,Ge.push({resn:ft,x:K,y:_e,z:Me,elem:ee,hetflag:re,chain:fe,resi:Ue,icode:oe,rescode:Ue+(oe!=" "?"^"+oe:""),serial:Se,altLoc:oe,index:D,atom:He,bonds:[],ss:k(ot),ssbegin:Ke,ssend:Je,bondOrder:[],properties:{charge:Be,occupancy:we},b:ie}),D+=1}var $e=Qe.bondAtomList;for(Y=0,X=Qe.bondOrderList.length;Y<X;++Y){var ye=ut+$e[Y*2],Ne=ut+$e[Y*2+1],Z=Qe.bondOrderList[Y],ze=We[ye],rt=We[Ne],G=Ge[ze],Te=Ge[rt];G&&Te&&(G.bonds.push(rt),G.bondOrder.push(Z),Te.bonds.push(ze),Te.bondOrder.push(Z))}E+=1}for(E=De,B=0;B<Oe;++B)E+=1;C+=1}if(W)for(let Ee=me,re=W.length;Ee<re;Ee+=2){let ge=W[Ee],ke=W[Ee+1],ct=H?H[Ee/2]:1;if(ge>=D){me=Ee;break}let lt=We[ge],dt=We[ke],yt=Ge[lt],ir=Ge[dt];yt&&ir&&(yt.bonds.push(dt),yt.bondOrder.push(ct),ir.bonds.push(lt),ir.bondOrder.push(ct))}R.multimodel&&(R.onemol||l.push([]))}if(!w)for(let Ee=0;Ee<l.length;Ee++)(0,b.processSymmetries)(h[Ee].symmetries,l[Ee],R,h[Ee].cryst);return c&&!s&&(0,_.computeSecondaryStructure)(l,R.hbondCutoff),l}}),"./src/parsers/MOL2.ts":((n,t,r)=>{r.r(t),r.d(t,{MOL2:()=>v});let u={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function v(_,b){var p=[[]],y=!1;typeof b.keepH<"u"&&(y=!b.keepH);var k=_.search(/@<TRIPOS>MOLECULE/),g=_.search(/@<TRIPOS>ATOM/);if(k==-1||g==-1)return p;for(var M=_.substring(k).split(/\r?\n|\r/);M.length>0;){var P=[],R=M[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),S=parseInt(R[0]),a=0;R.length>1&&(a=parseInt(R[1]));var s=4,c;for(c=3;c<M.length;c++)if(M[c]=="@<TRIPOS>ATOM"){s=c+1;break}var w=p[p.length-1].length,x=w+S,T;for(c=w;c<x;c++){T=M[s++],R=T.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var l={},h=R[5];if(u[h]!==void 0?h=u[h]:(h=h.split(".")[0],h=h[0].toUpperCase()+h.substring(1).toLowerCase()),l.atom=R[1],l.elem=h,!(l.elem=="H"&&y)){var C=p[p.length-1].length,E=parseInt(R[0]);l.serial=E,l.x=parseFloat(R[2]),l.y=parseFloat(R[3]),l.z=parseFloat(R[4]),l.atom=R[5];var D=parseFloat(R[8]);l.index=C,l.bonds=[],l.bondOrder=[],l.properties={charge:D,partialCharge:D},P[E]=C,p[p.length-1].push(l)}}for(var z=!1;s<M.length;)if(M[s++]=="@<TRIPOS>BOND"){z=!0;break}if(z&&a)for(c=0;c<a;c++){T=M[s++],R=T.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var L=parseInt(R[1]),V=p[p.length-1][P[L]],O=parseInt(R[2]),W=p[p.length-1][P[O]],H=parseInt(R[3]);isNaN(H)&&(H=1),V!==void 0&&W!==void 0&&(V.bonds.push(P[O]),V.bondOrder.push(H),W.bonds.push(P[L]),W.bondOrder.push(H))}if(b.multimodel){b.onemol||p.push([]),M.splice(0,s),_=M.join(`
`);continue}else break}return p}}),"./src/parsers/PDB.ts":((n,t,r)=>{r.r(t),r.d(t,{PDB:()=>v});var u=r("./src/parsers/utils/getSinglePDB.ts");function v(_,b){b=b||{};var p=[],y={};p.modelData=[];for(var k=_.split(/\r?\n|\r/);k.length>0;){var g=(0,u.getSinglePDB)(k,b,y),M=g[0],P=g[1];if(k=g[2],M.length!=0){if(b.multimodel&&b.onemol&&p.length>0)for(var R=p[0].length,S=0;S<M.length;S++){var a=M[S];a.index=S;for(var s=0;s<a.bonds.length;s++)a.bonds[s]+=R;p[0].push(a)}else p.modelData.push(P),p.push(M);if(!b.multimodel)break}}return p}}),"./src/parsers/PQR.ts":((n,t,r)=>{r.r(t),r.d(t,{PQR:()=>_});var u=r("./src/parsers/utils/assignPDBBonds.ts"),v=r("./src/parsers/utils/computeSecondaryStructure.ts");function _(b,p){var y=[[]],k=!p.noSecondaryStructure;y.modelData=[{symmetries:[]}];var g=[],M=b.split(/\r?\n|\r/),P;for(let z=0;z<M.length;z++){P=M[z].replace(/^\s*/,"");var R=P.substring(0,6);if(R.indexOf("END")==0)if(p.multimodel){p.onemol||y.push([]);continue}else break;else if(R=="ATOM  "||R=="HETATM"){var S;let L=parseInt(P.substring(6,11)),V=P.substring(12,16).replace(/ /g,""),O=P.substring(17,20).trim(),W=P.substring(21,22),H=parseInt(P.substring(22,26));var a=P.substring(30).trim().split(/\s+/),s=parseFloat(a[0]),c=parseFloat(a[1]),w=parseFloat(a[2]),x=parseFloat(a[3]),T=parseFloat(a[4]),l=V[0];V.length>1&&V[1].toUpperCase()!=V[1]&&(l=V.substring(0,2)),P[0]=="H"?S=!0:S=!1,g[L]=y[y.length-1].length,y[y.length-1].push({resn:O,x:s,y:c,z:w,elem:l,hetflag:S,chain:W,resi:H,serial:L,atom:V,bonds:[],ss:"c",bondOrder:[],properties:{charge:x,partialCharge:x,radius:T},pdbline:P})}else if(R=="CONECT"){var h=parseInt(P.substring(6,11)),C=y[y.length-1][g[h]];for(let L=0;L<4;L++){var E=parseInt(P.substring([11,16,21,26][L],[11,16,21,26][L]+5)),D=y[y.length-1][g[E]];C!==void 0&&D!==void 0&&(C.bonds.push(g[E]),C.bondOrder.push(1))}}}for(let z=0;z<y.length;z++)(0,u.assignPDBBonds)(y[z],p),k&&(0,v.computeSecondaryStructure)(y[z],p.hbondCutoff);return y}}),"./src/parsers/PRMTOP.ts":((n,t,r)=>{r.r(t),r.d(t,{PRMTOP:()=>u});function u(v){var _=[],b,p=0,y=v.split(/\r?\n|\r/);if(y.length>0&&y[0].includes("VERSION")){var k=y.filter(function(s){return s.includes("POINTERS")||s.includes("ATOM_NAME")||s.includes("CHARGE")||s.includes("RADII")||s.includes("BONDS_INC_HYDROGEN")||s.includes("BONDS_WITHOUT_HYDROGEN")}),g=S("POINTERS");if(g==-1)return[];var M=a(g),P=parseInt(y[g+1].slice(0,M[1]));if(isNaN(P)||P<=0)return[];if(g=S("ATOM_NAME"),g==-1)return[];M=a(g);var R=M[0];for(let s=0;s<P/M[0];s++){s==parseInt(P/M[0])&&(R=P%M[0]);for(let c=0;c<R;c++){let w={},x={charge:"",radii:""};w.serial=p,w.x=0,w.y=0,w.z=0,w.atom=y[g+1].slice(M[1]*c,M[1]*(c+1)).trim(),w.elem=y[g+1].slice(M[1]*c,M[1]*c+1).trim(),w.properties=x,w.bonds=[],w.bondOrder=[],_.push(w),p++}g++}if(g=S("CHARGE"),g!=-1){M=a(g),p=0,R=M[0];for(let s=0;s<P/M[0];s++){s==parseInt(P/M[0])&&(R=P%M[0]);for(let c=0;c<R;c++)_[p].properties.charge=parseFloat(y[g+1].slice(M[1]*c,M[1]*(c+1))),p++;g++}}if(g=S("RADII"),g!=-1){M=a(g),p=0,R=M[0];for(let s=0;s<P/M[0];s++){s==parseInt(P/M[0])&&(R=P%M[0]);for(let c=0;c<R;c++)_[p].properties.radii=parseFloat(y[g+1].slice(M[1]*c,M[1]*(c+1))),p++;g++}}if(g=S("BONDS_WITHOUT_HYDROGEN"),g!=-1)for(M=a(g),p=0,R=M[0],g=g+1;!y[g].match(/^%FLAG/);){y[g+1].match(/^%FLAG/)&&(R=P%M[0]);for(let s=0;s<R;s++)p%3==0?b=parseInt(y[g].slice(M[1]*s,M[1]*(s+1))/3):p%3==1&&_[b].bonds.push(parseInt(y[g].slice(M[1]*s,M[1]*(s+1))/3)),p++;g++}if(g=S("BONDS_INC_HYDROGEN"),g!=-1)for(M=a(g),p=0,R=M[0],g=g+1;!y[g].match(/^%FLAG/);){y[g+1].match(/^%FLAG/)&&(R=P%M[0]);for(let s=0;s<R;s++)p%3==0?b=parseInt(y[g].slice(M[1]*s,M[1]*(s+1))/3):p%3==1&&_[b].bonds.push(parseInt(y[g].slice(M[1]*s,M[1]*(s+1))/3)),p++;g++}}else return[];function S(s){var c=y.indexOf(k.filter(function(w){return w.includes(s)})[0]);if(Number.isInteger(c)&&c>0){for(;!y[c].includes("FORMAT");)c++;return c}else return-1}function a(s){var c=y[s].match(/\((\d*)\S*/),w=y[s].match(/[a-zA-Z](\d*)\)\s*/);return w==null&&(w=y[s].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[c[1],w[1]]}return[_]}}),"./src/parsers/SDF.ts":((n,t,r)=>{r.r(t),r.d(t,{SDF:()=>_});var u=function(b,p){var y=[[]],k=!1;for(typeof p.keepH<"u"&&(k=!p.keepH);b.length>0&&!(b.length<4);){var g=parseInt(b[3].substring(0,3));if(isNaN(g)||g<=0)break;var M=parseInt(b[3].substring(3,6)),P=4;if(b.length<4+g+M)break;var R=[],S=y[y.length-1].length,a=S+g,s,c;for(s=S;s<a;s++,P++){c=b[P];var w={},x=c.substring(31,34).replace(/ /g,"");w.atom=w.elem=x[0].toUpperCase()+x.substring(1).toLowerCase(),(w.elem!=="H"||!k)&&(w.serial=s,R[s]=y[y.length-1].length,w.x=parseFloat(c.substring(0,10)),w.y=parseFloat(c.substring(10,20)),w.z=parseFloat(c.substring(20,30)),w.hetflag=!0,w.bonds=[],w.bondOrder=[],w.properties={},w.index=y[y.length-1].length,y[y.length-1].push(w))}for(s=0;s<M;s++,P++){c=b[P];var T=R[parseInt(c.substring(0,3))-1+S],l=R[parseInt(c.substring(3,6))-1+S],h=parseFloat(c.substring(6));typeof T<"u"&&typeof l<"u"&&(y[y.length-1][T].bonds.push(l),y[y.length-1][T].bondOrder.push(h),y[y.length-1][l].bonds.push(T),y[y.length-1][l].bondOrder.push(h))}if(p.multimodel){for(p.onemol||y.push([]);b[P]!=="$$$$"&&P<b.length;)P++;b.splice(0,++P)}else break}return y},v=function(b,p){var y=[[]],k=!1;for(typeof p.keepH<"u"&&(k=!p.keepH);b.length>0&&!(b.length<8||!b[4].startsWith("M  V30 BEGIN CTAB")||!b[5].startsWith("M  V30 COUNTS")||b[5].length<14);){var g=b[5].substring(13).match(/\S+/g);if(g.length<2)break;var M=parseInt(g[0]);if(isNaN(M)||M<=0)break;var P=parseInt(g[1]),R=7;if(b.length<8+M+P)break;var S=[],a=y[y.length-1].length,s=a+M,c,w;for(c=a;c<s;c++,R++){w=b[R];var x=w.substring(6).match(/\S+/g);if(x.length>4){var T={},l=x[1].replace(/ /g,"");T.atom=T.elem=l[0].toUpperCase()+l.substring(1).toLowerCase(),(T.elem!=="H"||!k)&&(T.serial=c,S[c]=y[y.length-1].length,T.x=parseFloat(x[2]),T.y=parseFloat(x[3]),T.z=parseFloat(x[4]),T.hetflag=!0,T.bonds=[],T.bondOrder=[],T.properties={},T.index=y[y.length-1].length,y[y.length-1].push(T))}}if(b[R]==="M  V30 END ATOM")R++;else break;if(P!==0&&b[R]==="M  V30 BEGIN BOND")R++;else break;for(c=0;c<P;c++,R++){w=b[R];var h=w.substring(6).match(/\S+/g);if(h.length>3){var C=S[parseInt(h[2])-1+a],E=S[parseInt(h[3])-1+a],D=parseFloat(h[1]);typeof C<"u"&&typeof E<"u"&&(y[y.length-1][C].bonds.push(E),y[y.length-1][C].bondOrder.push(D),y[y.length-1][E].bonds.push(C),y[y.length-1][E].bondOrder.push(D))}}if(p.multimodel){for(p.onemol||y.push([]);b[R]!=="$$$$"&&R<b.length;)R++;b.splice(0,++R)}else break}return y};function _(b,p){var y="V2000",k=b.split(/\r?\n|\r/);return k.length>3&&k[3].length>38&&(y=k[3].substring(34,39)),y==="V2000"?u(k,p):y==="V3000"?v(k,p):[[""]]}}),"./src/parsers/VASP.ts":((n,t,r)=>{r.r(t),r.d(t,{VASP:()=>_});var u=r("./src/WebGL/index.ts"),v=r("./src/parsers/utils/assignBonds.ts");function _(b,p={}){var y=[[]],k={};const g=p.assignBonds===void 0?!0:p.assignBonds;var M=b.replace(/^\s+/,"").split(/\r?\n/);if(M.length<3)return y;if(M[1].match(/\d+/))k.length=parseFloat(M[1]);else return console.log("Warning: second line of the vasp structure file must be a number"),y;if(k.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),y;k.xVec=new Float32Array(M[2].replace(/^\s+/,"").split(/\s+/)),k.yVec=new Float32Array(M[3].replace(/^\s+/,"").split(/\s+/)),k.zVec=new Float32Array(M[4].replace(/^\s+/,"").split(/\s+/));var P=new u.Matrix3(k.xVec[0],k.xVec[1],k.xVec[2],k.yVec[0],k.yVec[1],k.yVec[2],k.zVec[0],k.zVec[1],k.zVec[2]);P.multiplyScalar(k.length),y.modelData=[{symmetries:[],cryst:{matrix:P}}];var R=M[5].replace(/\s+/,"").replace(/\s+$/,"").split(/\s+/),S=new Int16Array(M[6].replace(/^\s+/,"").split(/\s+/)),a=M[7].replace(/\s+/,""),s=!1;if(a.match(/S/)&&(s=!0,a=M[8].replace(/\s+/,"")),a.match(/C/))a="cartesian";else if(a.match(/D/))a="direct";else return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),y;if(R.length!=S.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(R),console.log(S),y;s?M.splice(0,9):M.splice(0,8);for(var c=0,w=0,x=R.length;w<x;w++){for(var T=R[w],l=0,h=S[w];l<h;l++){var C=new Float32Array(M[c+l].replace(/^\s+/,"").split(/\s+/)),E={};E.elem=T,a=="cartesian"?(E.x=k.length*C[0],E.y=k.length*C[1],E.z=k.length*C[2]):(E.x=k.length*(C[0]*k.xVec[0]+C[1]*k.yVec[0]+C[2]*k.zVec[0]),E.y=k.length*(C[0]*k.xVec[1]+C[1]*k.yVec[1]+C[2]*k.zVec[1]),E.z=k.length*(C[0]*k.xVec[2]+C[1]*k.yVec[2]+C[2]*k.zVec[2])),E.bonds=[],E.bondOrder=[],y[0].push(E)}c+=S[w]}if(g)for(let D=0;D<y.length;D++)(0,v.assignBonds)(y[D],p);return y}}),"./src/parsers/XYZ.ts":((n,t,r)=>{r.r(t),r.d(t,{XYZ:()=>_});var u=r("./src/WebGL/index.ts"),v=r("./src/parsers/utils/assignBonds.ts");function _(b,p){p=p||{};for(var y=[[]],k=p.assignBonds===void 0?!0:p.assignBonds,g=b.split(/\r?\n|\r/);g.length>0&&!(g.length<3);){var M=parseInt(g[0]);if(isNaN(M)||M<=0||g.length<M+2)break;var P=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi,R=P.exec(g[1]);if(R!=null&&R.length>1){var S=new Float32Array(R[1].split(/\s+/)),a=new u.Matrix3(S[0],S[3],S[6],S[1],S[4],S[7],S[2],S[5],S[8]);y.modelData=[{cryst:{matrix:a}}]}for(var s=2,c=y[y.length-1].length,w=c+M,x=c;x<w;x++){var T=g[s++],l=T.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),h={};h.serial=x;var C=l[0];h.atom=h.elem=C[0].toUpperCase()+C.substring(1,2).toLowerCase(),h.x=parseFloat(l[1]),h.y=parseFloat(l[2]),h.z=parseFloat(l[3]),h.hetflag=!0,h.bonds=[],h.bondOrder=[],h.properties={},y[y.length-1][x]=h,l.length>=7&&(h.dx=parseFloat(l[4]),h.dy=parseFloat(l[5]),h.dz=parseFloat(l[6]))}if(p.multimodel)y.push([]),g.splice(0,s);else break}if(k)for(let D=0;D<y.length;D++)(0,v.assignBonds)(y[D],p);if(p.onemol){var E=y;y=[],y.push(E[0]);for(let D=1;D<E.length;D++){let z=y[0].length;for(let L=0;L<E[D].length;L++){let V=E[D][L];for(let O=0;O<V.bonds.length;O++)V.bonds[O]=V.bonds[O]+z;V.index=y[0].length,V.serial=y[0].length,y[0].push(V)}}}return y}}),"./src/parsers/cifutils/category.ts":((n,t,r)=>{r.r(t),r.d(t,{Category:()=>v});var u=r("./src/parsers/cifutils/decoder.ts");function v(_){const b=Object.create(null),p=Object.create(null);for(const y of _.columns)b[y.name]=y;return{rowCount:_.rowCount,name:_.name.substring(1),fieldNames:_.columns.map(y=>y.name),getField(y){const k=b[y];if(k)return p[y]||(p[y]=(0,u.decode)(k.data)),p[y]}}}}),"./src/parsers/cifutils/decoder.ts":((n,t,r)=>{r.r(t),r.d(t,{decode:()=>b});var u=r("./src/parsers/cifutils/encoding.ts");const v=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function _(z,L){const V=new ArrayBuffer(z.length),O=new Uint8Array(V);for(let W=0,H=z.length;W<H;W+=L)for(let q=0;q<L;q++)O[W+L-q-1]=z[W+q];return V}function b(z){let L=z.data;for(let V=z.encoding.length-1;V>=0;V--)L=p(L,z.encoding[V]);return L}function p(z,L){switch(L.kind){case"ByteArray":switch(L.type){case u.Encoding.IntDataType.Uint8:return z;case u.Encoding.IntDataType.Int8:return g(z);case u.Encoding.IntDataType.Int16:return P(z);case u.Encoding.IntDataType.Uint16:return R(z);case u.Encoding.IntDataType.Int32:return S(z);case u.Encoding.IntDataType.Uint32:return a(z);case u.Encoding.FloatDataType.Float32:return s(z);case u.Encoding.FloatDataType.Float64:return c(z);default:throw new Error("unreachable")}case"FixedPoint":return w(z,L);case"IntervalQuantization":return x(z,L);case"RunLength":return T(z,L);case"Delta":return l(z,L);case"IntegerPacking":return E(z,L);case"StringArray":return D(z,L)}}function y(z,L){switch(z){case u.Encoding.IntDataType.Int8:return new Int8Array(L);case u.Encoding.IntDataType.Int16:return new Int16Array(L);case u.Encoding.IntDataType.Int32:return new Int32Array(L);case u.Encoding.IntDataType.Uint8:return new Uint8Array(L);case u.Encoding.IntDataType.Uint16:return new Uint16Array(L);case u.Encoding.IntDataType.Uint32:return new Uint32Array(L);default:return new Int32Array(L)}}function k(z,L){switch(z){case u.Encoding.FloatDataType.Float32:return new Float32Array(L);case u.Encoding.FloatDataType.Float64:return new Float64Array(L);default:return new Float64Array(L)}}function g(z){return new Int8Array(z.buffer,z.byteOffset)}function M(z,L,V){return(z.byteOffset!=0||z.byteLength!=z.buffer.byteLength)&&(z=new Uint8Array(z)),v?new V(z.buffer):new V(_(z,L))}function P(z){return M(z,2,Int16Array)}function R(z){return M(z,2,Uint16Array)}function S(z){return M(z,4,Int32Array)}function a(z){return M(z,4,Uint32Array)}function s(z){return M(z,4,Float32Array)}function c(z){return M(z,8,Float64Array)}function w(z,L){const V=z.length,O=k(L.srcType,V),W=1/L.factor;for(let H=0;H<V;H++)O[H]=W*z[H];return O}function x(z,L){const V=z.length,O=k(L.srcType,V),W=(L.max-L.min)/(L.numSteps-1),H=L.min;for(let q=0;q<V;q++)O[q]=H+W*z[q];return O}function T(z,L){const V=y(L.srcType,L.srcSize);let O=0;for(let W=0,H=z.length;W<H;W+=2){const q=z[W],U=z[W+1];for(let B=0;B<U;++B)V[O++]=q}return V}function l(z,L){const V=z.length,O=y(L.srcType,V);if(!V)return z;O[0]=z[0]+(L.origin|0);for(let W=1;W<V;++W)O[W]=z[W]+O[W-1];return O}function h(z,L){const V=L.byteCount===1?127:32767,O=-V-1,W=z.length,H=new Int32Array(L.srcSize);let q=0,U=0;for(;q<W;){let B=0,Y=z[q];for(;Y===V||Y===O;)B+=Y,q++,Y=z[q];B+=Y,H[U]=B,q++,U++}return H}function C(z,L){const V=L.byteCount===1?255:65535,O=z.length,W=new Int32Array(L.srcSize);let H=0,q=0;for(;H<O;){let U=0,B=z[H];for(;B===V;)U+=B,H++,B=z[H];U+=B,W[q]=U,H++,q++}return W}function E(z,L){return z.length===L.srcSize?z:L.isUnsigned?C(z,L):h(z,L)}function D(z,L){const V=b({encoding:L.offsetEncoding,data:L.offsets}),O=b({encoding:L.dataEncoding,data:z}),W=L.stringData,H=new Array(V.length);H[0]="";for(let B=1,Y=V.length;B<Y;B++)H[B]=W.substring(V[B-1],V[B]);let q=0;const U=new Array(O.length);for(let B=0,Y=O.length;B<Y;B++)U[q++]=H[O[B]+1];return U}}),"./src/parsers/cifutils/encoding.ts":((n,t,r)=>{r.r(t),r.d(t,{Encoding:()=>v,VERSION:()=>u});const u="0.3.0";var v;(function(_){(function(y){y[y.Int8=1]="Int8",y[y.Int16=2]="Int16",y[y.Int32=3]="Int32",y[y.Uint8=4]="Uint8",y[y.Uint16=5]="Uint16",y[y.Uint32=6]="Uint32"})(_.IntDataType||(_.IntDataType={})),(function(y){y[y.Float32=32]="Float32",y[y.Float64=33]="Float64"})(_.FloatDataType||(_.FloatDataType={}));function b(y){let k;return y instanceof Int8Array?k=_.IntDataType.Int8:y instanceof Int16Array?k=_.IntDataType.Int16:y instanceof Int32Array?k=_.IntDataType.Int32:y instanceof Uint8Array?k=_.IntDataType.Uint8:y instanceof Uint16Array?k=_.IntDataType.Uint16:y instanceof Uint32Array?k=_.IntDataType.Uint32:y instanceof Float32Array?k=_.FloatDataType.Float32:y instanceof Float64Array?k=_.FloatDataType.Float64:k=_.IntDataType.Int32,k}_.getDataType=b;function p(y){if(y instanceof Int8Array||y instanceof Int16Array||y instanceof Int32Array)return!0;for(let k=0,g=y.length;k<g;k++)if(k<0)return!1;return!0}_.isSignedIntegerDataType=p})(v||(v={}))}),"./src/parsers/index.ts":((n,t,r)=>{r.r(t),r.d(t,{Parsers:()=>w,bondLength:()=>c.bondLength,setBondLength:()=>c.setBondLength});var u=r("./src/parsers/VASP.ts"),v=r("./src/parsers/CUBE.ts"),_=r("./src/parsers/XYZ.ts"),b=r("./src/parsers/SDF.ts"),p=r("./src/parsers/CDJSON.ts"),y=r("./src/parsers/CIF.ts"),k=r("./src/parsers/MOL2.ts"),g=r("./src/parsers/PDB.ts"),M=r("./src/parsers/PQR.ts"),P=r("./src/parsers/MMTF.ts"),R=r("./src/parsers/PRMTOP.ts"),S=r("./src/parsers/GRO.ts"),a=r("./src/parsers/LAMMPSTRJ.ts"),s=r("./src/parsers/BCIF.ts"),c=r("./src/parsers/utils/bondLength.ts");const w={vasp:u.VASP,VASP:u.VASP,cube:v.CUBE,CUBE:v.CUBE,xyz:_.XYZ,XYZ:_.XYZ,sdf:b.SDF,SDF:b.SDF,json:p.CDJSON,cdjson:p.CDJSON,CDJSON:p.CDJSON,mcif:y.CIF,cif:y.CIF,CIF:y.CIF,mol2:k.MOL2,MOL2:k.MOL2,pdb:g.PDB,PDB:g.PDB,pdbqt:g.PDB,PDBQT:g.PDB,pqr:M.PQR,PQR:M.PQR,mmtf:P.MMTFparser,MMTF:P.MMTFparser,prmtop:R.PRMTOP,PRMTOP:R.PRMTOP,gro:S.GRO,GRO:S.GRO,lammpstrj:a.LAMMPSTRJ,LAMMPSTRJ:a.LAMMPSTRJ,bcif:s.BCIF,BCIF:s.BCIF}}),"./src/parsers/utils/anumToSymbol.ts":((n,t,r)=>{r.r(t),r.d(t,{anumToSymbol:()=>u});const u={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"}}),"./src/parsers/utils/areConnected.ts":((n,t,r)=>{r.r(t),r.d(t,{areConnected:()=>_});var u=r("./src/parsers/utils/bondLength.ts");const v=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function _(b,p,y){if(y&&y.unboundCations&&(v.has(b.elem)||v.has(p.elem)))return!1;let k=(0,u.bondLength)(b.elem)+(0,u.bondLength)(p.elem);k+=.25,k*=k;let g=b.x-p.x;if(g*=g,g>k)return!1;let M=b.y-p.y;if(M*=M,M>k)return!1;let P=b.z-p.z;if(P*=P,P>k)return!1;const R=g+M+P;return!(isNaN(R)||R<.5||R>k||b.altLoc!==p.altLoc&&b.altLoc.trim()!==""&&p.altLoc.trim()!=="")}}),"./src/parsers/utils/assignBackboneHBonds.ts":((n,t,r)=>{r.r(t),r.d(t,{assignBackboneHBonds:()=>u});function u(v,_){const b=_||3.2,p=b*b,y=[];for(let k=0,g=v.length;k<g;k++){v[k].index=k;const M=v[k];!M.hetflag&&(M.atom==="N"||M.atom==="O")&&(y.push(M),M.hbondOther=null,M.hbondDistanceSq=Number.POSITIVE_INFINITY)}y.sort(function(k,g){return k.z-g.z});for(let k=0,g=y.length;k<g;k++){const M=y[k];for(let P=k+1;P<g;P++){const R=y[P],S=R.z-M.z;if(S>b)break;if(R.atom==M.atom)continue;const a=Math.abs(R.y-M.y);if(a>b)continue;const s=Math.abs(R.x-M.x);if(s>b)continue;const c=s*s+a*a+S*S;c>p||R.chain==M.chain&&Math.abs(R.resi-M.resi)<4||(c<M.hbondDistanceSq&&(M.hbondOther=R,M.hbondDistanceSq=c),c<R.hbondDistanceSq&&(R.hbondOther=M,R.hbondDistanceSq=c))}}}}),"./src/parsers/utils/assignBonds.ts":((n,t,r)=>{r.r(t),r.d(t,{assignBonds:()=>b});var u=r("./src/parsers/utils/areConnected.ts");const v=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],_=4.95;function b(p,y){for(let M=0,P=p.length;M<P;M++)p[M].index||(p[M].index=M);const k={x:{y:{z:[]}}};for(let M=0;M<p.length;M++){const P=p[M],R=Math.floor(P.x/_),S=Math.floor(P.y/_),a=Math.floor(P.z/_);k[R]||(k[R]={}),k[R][S]||(k[R][S]={}),k[R][S][a]||(k[R][S][a]=[]),k[R][S][a].push(P)}function g(M,P){for(let R=0;R<M.length;R++){const S=M[R];for(let a=0;a<P.length;a++){const s=P[a];if((0,u.areConnected)(S,s,y)){const c=S.bonds.indexOf(s.index),w=s.bonds.indexOf(S.index);c===-1&&w===-1?(S.bonds.push(s.index),S.bondOrder.push(1),s.bonds.push(S.index),s.bondOrder.push(1)):c===-1?(S.bonds.push(s.index),S.bondOrder.push(s.bondOrder[w])):w===-1&&(s.bonds.push(S.index),s.bondOrder.push(S.bondOrder[c]))}}}}for(let M in k){const P=parseInt(M);for(let R in k[P]){const S=parseInt(R);for(let a in k[P][S]){const s=parseInt(a),c=k[P][S][s];for(let w=0;w<c.length;w++){const x=c[w];for(let T=w+1;T<c.length;T++){const l=c[T];(0,u.areConnected)(x,l,y)&&x.bonds.indexOf(l.index)==-1&&(x.bonds.push(l.index),x.bondOrder.push(1),l.bonds.push(x.index),l.bondOrder.push(1))}}for(let w=0;w<v.length;w++){const x=v[w];if(!k[P+x.x]||!k[P+x.x][S+x.y]||!k[P+x.x][S+x.y][s+x.z])continue;const T=k[P+x.x][S+x.y][s+x.z];g(c,T)}}}}}}),"./src/parsers/utils/assignPDBBonds.ts":((n,t,r)=>{r.r(t),r.d(t,{assignPDBBonds:()=>b});var u=r("./src/parsers/utils/areConnected.ts"),v=r("./src/parsers/utils/assignBonds.ts"),_=r("./src/parsers/utils/standardResidues.ts");function b(p,y){const k=[],g=[];for(let S=0,a=p.length;S<a;S++){const s=p[S];s.index=S,s.hetflag||!_.standardResidues.has(s.resn)?g.push(s):k.push(s)}(0,v.assignBonds)(g,y),k.sort(function(S,a){return S.chain!==a.chain?S.chain<a.chain?-1:1:S.resi-a.resi});let M=-1,P=-1,R;for(let S=0,a=k.length;S<a;S++){const s=k[S];s.resi!==M&&(M=s.resi,R||P++,R=!1),s.reschain=P;for(let c=S+1;c<k.length;c++){const w=k[c];if(w.chain!==s.chain||w.resi-s.resi>1)break;(0,u.areConnected)(s,w,y)&&(s.bonds.indexOf(w.index)===-1&&(s.bonds.push(w.index),s.bondOrder.push(1),w.bonds.push(s.index),w.bondOrder.push(1)),s.resi!==w.resi&&(R=!0))}}}}),"./src/parsers/utils/atomNameToElem.ts":((n,t,r)=>{r.r(t),r.d(t,{atomNameToElem:()=>v});var u=r("./src/parsers/utils/bondLength.ts");function v(_,b){let p=_.replace(/ /g,"");return p.length>0&&p[0]==="H"&&p!=="Hg"&&p!=="He"&&p!=="Hf"&&p!=="Hs"&&p!=="Ho"&&(p="H"),p.length>1&&(p=p[0].toUpperCase()+p.substring(1).toLowerCase(),u.bondTable[p]===void 0?p=p[0]:b&&(p==="Ca"||p==="Cd")&&(p="C")),p}}),"./src/parsers/utils/bondLength.ts":((n,t,r)=>{r.r(t),r.d(t,{bondLength:()=>v,bondTable:()=>u,setBondLength:()=>_});let u={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function v(b){return u[b]||1.6}function _(b,p){p<0&&(p=0),u[b]=p}}),"./src/parsers/utils/computeSecondaryStructure.ts":((n,t,r)=>{r.r(t),r.d(t,{computeSecondaryStructure:()=>v});var u=r("./src/parsers/utils/assignBackboneHBonds.ts");function v(_,b){(0,u.assignBackboneHBonds)(_,b);const p={};let y,k,g,M,P,R;for(y=0,k=_.length;y<k;y++)if(P=_[y],p[P.chain]===void 0&&(p[P.chain]=[]),isFinite(P.hbondDistanceSq)){const S=P.hbondOther;p[S.chain]===void 0&&(p[S.chain]=[]),Math.abs(S.resi-P.resi)===4&&(p[P.chain][P.resi]="h")}for(g in p)for(M=1;M<p[g].length-1;M++){const S=p[g][M-1],a=p[g][M+1];R=p[g][M],S=="h"&&S==a&&R!=S&&(p[g][M]=S)}for(y=0,k=_.length;y<k;y++)P=_[y],isFinite(P.hbondDistanceSq)&&p[P.chain][P.resi]!="h"&&P.ss!=="h"&&(p[P.chain][P.resi]="maybesheet");for(let S=0,a=_.length;S<a;S++)if(P=_[S],isFinite(P.hbondDistanceSq)&&p[P.chain][P.resi]=="maybesheet"){let s=P.hbondOther,c=p[s.chain][s.resi];(c=="maybesheet"||c=="s")&&(p[P.chain][P.resi]="s",p[s.chain][s.resi]="s")}for(let S in p){for(let a=1;a<p[S].length-1;a++){const s=p[S][a-1],c=p[S][a+1];R=p[S][a],s=="s"&&s==c&&R!=s&&(p[S][a]=s)}for(let a=0;a<p[S].length;a++){const s=p[S][a];(s=="h"||s=="s")&&p[S][a-1]!=s&&p[S][a+1]!=s&&delete p[S][a]}}for(y=0,k=_.length;y<k;y++)P=_[y],R=p[P.chain][P.resi],delete P.hbondOther,delete P.hbondDistanceSq,!(R===void 0||R==="maybesheet")&&(P.ss=R,p[P.chain][P.resi-1]!=R&&(P.ssbegin=!0),p[P.chain][P.resi+1]!=R&&(P.ssend=!0))}}),"./src/parsers/utils/getSinglePDB.ts":((n,t,r)=>{r.r(t),r.d(t,{getSinglePDB:()=>M});var u=r("./src/WebGL/index.ts"),v=r("./src/parsers/utils/atomNameToElem.ts"),_=r("./src/parsers/utils/bondLength.ts"),b=r("./src/parsers/utils/computeSecondaryStructure.ts"),p=r("./src/parsers/utils/isEmpty.ts"),y=r("./src/parsers/utils/processSymmetries.ts"),k=r("./src/parsers/utils/assignPDBBonds.ts"),g=r("./src/parsers/utils/validateBonds.ts");function M(P,R,S){const a=[],s=R.assignBonds===void 0?!0:R.assignBonds,c=!R.keepH,w=!!R.noSecondaryStructure,x=!R.noComputeSecondaryStructure,T=!R.doAssembly,l=R.altLoc?R.altLoc:"A",h={symmetries:[],cryst:void 0};let C,E=[];const D=[];let z;const L={};for(let V=0;V<P.length;V++){z=P[V].replace(/^\s*/,"");const O=z.substring(0,6);let W,H,q;if(O.indexOf("END")===0){if(E=P.slice(V+1),O==="END")for(const U in S)S.hasOwnProperty(U)&&delete S[U];break}else if(O==="ATOM  "||O==="HETATM"){let U,B,Y,X,j,J,le,se,he,pe,ve,ce;if(ve=z.substring(16,17),ve!==" "&&ve!==l&&l!=="*"||(pe=parseInt(z.substring(6,11)),C=z.substring(12,16).replace(/ /g,""),U=z.substring(17,20).replace(/ /g,""),B=z.substring(21,22),Y=parseInt(z.substring(22,26)),X=z.substring(26,27),j=parseFloat(z.substring(30,38)),J=parseFloat(z.substring(38,46)),le=parseFloat(z.substring(46,54)),ce=parseFloat(z.substring(60,68)),he=z.substring(76,78).replace(/ /g,""),he===""||_.bondTable[he]===void 0?he=(0,v.atomNameToElem)(z.substring(12,14),z[0]=="A"):he=he[0].toUpperCase()+he.substring(1).toLowerCase(),he==="H"&&c))continue;O[0]=="H"?se=!0:se=!1,D[pe]=a.length,a.push({resn:U,x:j,y:J,z:le,elem:he,hetflag:se,altLoc:ve,chain:B,resi:Y,icode:X,rescode:Y+(X!==" "?"^"+X:""),serial:pe,atom:C,bonds:[],ss:"c",bondOrder:[],properties:{},b:ce,pdbline:z})}else if(O==="SHEET "){W=z.substring(21,22),H=parseInt(z.substring(22,26)),q=parseInt(z.substring(33,37)),W in S||(S[W]={}),S[W][H]="s1";for(let U=H+1;U<q;U++)S[W][U]="s";S[W][q]="s2"}else if(O==="CONECT"){const U=parseInt(z.substring(6,11)),B=D[U],Y=a[B],X=[11,16,21,26];for(let j=0;j<4;j++){const J=parseInt(z.substring(X[j],X[j]+5)),le=D[J];let se=B+":"+le;const he=a[le];if(Y!==void 0&&he!==void 0)if(!L[se])L[se]=1,(Y.bonds.length==0||Y.bonds[Y.bonds.length-1]!==le)&&(Y.bonds.push(le),Y.bondOrder.push(1));else{L[se]+=1;for(let pe=0;pe<Y.bonds.length;pe++)if(Y.bonds[pe]==le){const ve=L[se];ve>=4?Y.bondOrder[pe]=1:Y.bondOrder[pe]=ve}}}}else if(O==="HELIX "){W=z.substring(19,20),H=parseInt(z.substring(21,25)),q=parseInt(z.substring(33,37)),W in S||(S[W]={}),S[W][H]="h1";for(let U=H+1;U<q;U++)S[W][U]="h";S[W][q]="h2"}else if(!T&&O==="REMARK"&&z.substring(13,18)==="BIOMT"){let U,B=new u.Matrix4;for(U=1;U<=3;U++)if(z=P[V].replace(/^\s*/,""),parseInt(z.substring(18,19))==U)B.elements[U-1]=parseFloat(z.substring(23,33)),B.elements[U-1+4]=parseFloat(z.substring(33,43)),B.elements[U-1+8]=parseFloat(z.substring(43,53)),B.elements[U-1+12]=parseFloat(z.substring(53)),V++;else for(;z.substring(13,18)==="BIOMT";)V++,z=P[V].replace(/^\s*/,"");B.elements[3]=0,B.elements[7]=0,B.elements[11]=0,B.elements[15]=1,h.symmetries.push(B),V--}else if(O==="CRYST1"){let U,B,Y,X,j,J;U=parseFloat(z.substring(7,15)),B=parseFloat(z.substring(16,24)),Y=parseFloat(z.substring(25,33)),X=parseFloat(z.substring(34,40)),j=parseFloat(z.substring(41,47)),J=parseFloat(z.substring(48,54)),h.cryst={a:U,b:B,c:Y,alpha:X,beta:j,gamma:J}}else if(O==="ANISOU"){const U=parseInt(z.substring(6,11)),B=D[U],Y=a[B];if(Y){const X=z.substring(30).trim().split(/\s+/),j={u11:parseInt(X[0]),u22:parseInt(X[1]),u33:parseInt(X[2]),u12:parseInt(X[3]),u13:parseInt(X[4]),u23:parseInt(X[5])};Y.uMat=j}}}if((0,g.validateBonds)(a,D),s&&(0,k.assignPDBBonds)(a,R),T||(0,y.processSymmetries)(h.symmetries,a,R,h.cryst),x&&!w&&(0,b.computeSecondaryStructure)(a,R.hbondCutoff),!(0,p.isEmpty)(S))for(let V=0;V<a.length;V++){const O=a[V];if(O!==void 0&&O.chain in S&&O.resi in S[O.chain]){const W=S[O.chain][O.resi];O.ss=W[0],W.length>1&&(W[1]=="1"?O.ssbegin=!0:W[1]=="2"&&(O.ssend=!0))}}return[a,h,E]}}),"./src/parsers/utils/isEmpty.ts":((n,t,r)=>{r.r(t),r.d(t,{isEmpty:()=>u});function u(v){for(const _ in v)return!1;return!0}}),"./src/parsers/utils/processSymmetries.ts":((n,t,r)=>{r.r(t),r.d(t,{processSymmetries:()=>v});var u=r("./src/WebGL/index.ts");function v(_,b,p,y){const k=!p.duplicateAssemblyAtoms,g=b.length;let M=g,P=-1,R=null,S=null;(p.normalizeAssembly||p.wrapAtoms)&&y&&(R=(0,u.conversionMatrix3)(y.a,y.b,y.c,y.alpha,y.beta,y.gamma),S=new u.Matrix3,S.getInverse3(R));let a=function(w){let x=w.clone().applyMatrix3(S);const T=[x.x,x.y,x.z],l=[0,0,0];for(let C=0;C<3;C++){for(;T[C]<-.001;)T[C]+=1,l[C]+=1;for(;T[C]>1.001;)T[C]-=1,l[C]-=1}const h=new u.Vector3(l[0],l[1],l[2]);return h.applyMatrix3(R),h};if(p.normalizeAssembly&&y)for(let w=0;w<_.length;w++){const x=new u.Vector3(0,0,0);for(let l=0;l<g;l++){const h=new u.Vector3(b[l].x,b[l].y,b[l].z);h.applyMatrix4(_[w]),x.add(h)}x.divideScalar(g);const T=a(x);_[w].isNearlyIdentity()&&T.lengthSq()>.001&&(P=w),_[w].translate(T)}if(k){if(_.length>1)for(let w=0;w<b.length;w++){var s=[];for(let x=0;x<_.length;x++)if(!_[x].isNearlyIdentity()){var c=new u.Vector3;c.set(b[w].x,b[w].y,b[w].z),c.applyMatrix4(_[x]),s.push(c)}b[w].symmetries=s}}else{for(let w=0;w<g;w++)b[w].sym=-1;for(let w=0;w<_.length;w++)if(!_[w].isNearlyIdentity()&&P!=w){let x=new u.Vector3;for(let T=0;T<g;T++){const l=[];for(let C=0;C<b[T].bonds.length;C++)l.push(b[T].bonds[C]+M);if(x.set(b[T].x,b[T].y,b[T].z),x.applyMatrix4(_[w]),p.wrapAtoms&&y){let C=a(x);x.add(C)}const h={};for(const C in b[T])h[C]=b[T][C];h.x=x.x,h.y=x.y,h.z=x.z,h.bonds=l,h.sym=w,h.index=b.length,b.push(h)}M=b.length}else for(let x=0;x<g;x++)b[x].sym=w;if(p.wrapAtoms&&y){let w=new u.Vector3;for(let x=0;x<g;x++){w.set(b[x].x,b[x].y,b[x].z);let T=a(w);w.add(T),b[x].x=w.x,b[x].y=w.y,b[x].z=w.z}}if(P>=0){const w=new u.Vector3;for(let x=0;x<g;x++)w.set(b[x].x,b[x].y,b[x].z),w.applyMatrix4(_[P]),b[x].x=w.x,b[x].y=w.y,b[x].z=w.z}_.length=0}}}),"./src/parsers/utils/standardResidues.ts":((n,t,r)=>{r.r(t),r.d(t,{standardResidues:()=>u});const u=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"])}),"./src/parsers/utils/validateBonds.ts":((n,t,r)=>{r.r(t),r.d(t,{validateBonds:()=>u});function u(v,_){for(let b=0,p=v.length;b<p;b++){const y=v[b];for(let k=0;k<y.bonds.length;k++){const g=y.bonds[k],M=v[g],P=_[y.serial];M&&P&&M.bonds.indexOf(P)<0&&(M.bonds.push(P),M.bondOrder.push(y.bondOrder[k]))}}}}),"./src/partialCharges.ts":((n,t,r)=>{r.r(t),r.d(t,{applyPartialCharges:()=>v,partialCharges:()=>u});const u={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function v(_,b){if((!b||typeof _.partialCharge>"u")&&_.resn&&_.atom){var p=_.resn+":"+_.atom;_.properties.partialCharge=u[p]}}}),"./src/specs.ts":((n,t,r)=>{r.r(t)}),"./src/utilities.ts":((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/Gradient.ts"),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/VolumeData.ts"),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/colors.ts"),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/pako/dist/pako.esm.mjs");function extend(n,t){for(var r in t)t.hasOwnProperty(r)&&t[r]!==void 0&&(n[r]=t[r]);return n}function deepCopy(n){let t,r,u;if(n==null)return{};if(typeof n!="object"||n===null)return n;t=Array.isArray(n)?[]:{};for(u in n)r=n[u],t[u]=deepCopy(r);return t}function isNumeric(n){var t=typeof n;return(t==="number"||t==="string")&&!isNaN(n-parseFloat(n))}function isEmptyObject(n){var t;for(t in n)return!1;return!0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?null:callback}function adjustVolumeStyle(n){n&&(n.volformat&&!(n.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData)&&(n.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(n.voldata,n.volformat)),n.volscheme&&(n.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(n.volscheme)))}function getExtent(n,t){var r,u,v,_,b,p,y,k,g,M,P=!t;if(r=u=v=9999,_=b=p=-9999,y=k=g=M=0,n.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var R=0;R<n.length;R++){var S=n[R];if(!(typeof S>"u"||!isFinite(S.x)||!isFinite(S.y)||!isFinite(S.z))&&(M++,y+=S.x,k+=S.y,g+=S.z,r=r<S.x?r:S.x,u=u<S.y?u:S.y,v=v<S.z?v:S.z,_=_>S.x?_:S.x,b=b>S.y?b:S.y,p=p>S.z?p:S.z,S.symmetries&&P))for(var a=0;a<S.symmetries.length;a++)M++,y+=S.symmetries[a].x,k+=S.symmetries[a].y,g+=S.symmetries[a].z,r=r<S.symmetries[a].x?r:S.symmetries[a].x,u=u<S.symmetries[a].y?u:S.symmetries[a].y,v=v<S.symmetries[a].z?v:S.symmetries[a].z,_=_>S.symmetries[a].x?_:S.symmetries[a].x,b=b>S.symmetries[a].y?b:S.symmetries[a].y,p=p>S.symmetries[a].z?p:S.symmetries[a].z}return[[r,u,v],[_,b,p],[y/M,k/M,g/M]]}function getPropertyRange(n,t){for(var r=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,v=0,_=n.length;v<_;v++){var b=n[v],p=getAtomProperty(b,t);p!=null&&(p<r&&(r=p),p>u&&(u=p))}return!isFinite(r)&&!isFinite(u)?r=u=0:isFinite(r)?isFinite(u)||(u=r):r=u,[r,u]}class PausableTimer{constructor(t,r,u){this.total_time_run=0,this.fn=t,this.arg=u,this.countdown=r,this.start_time=new Date().getTime(),this.ident=setTimeout(t,r,u)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(n){for(var t=window.atob(n),r=t.length,u=new Uint8Array(r),v=0;v<r;v++)u[v]=t.charCodeAt(v);return u}function getAtomProperty(n,t){var r=null;return n.properties&&typeof n.properties[t]<"u"?r=n.properties[t]:typeof n[t]<"u"&&(r=n[t]),r}function mergeGeos(n,t){var r=t.geometry;r!==void 0&&n.geometryGroups.push(r.geometryGroups[0])}function specStringToObject(n){if(typeof n=="object"||typeof n>"u"||n==null)return n;try{return JSON.parse(n)}catch{}n=n.replace(/%7E/g,"~");var t=function(P){return isNumeric(P)?Math.floor(parseFloat(P))==parseInt(P)||P.indexOf(".")>=0?parseFloat(P):parseInt(P):P==="true"?!0:P==="false"?!1:P},r={};if(n==="all")return r;for(var u=n.split(";"),v=0;v<u.length;v++){var _=u[v].split(":"),b=_[0],p={},y=_[1];if(y)if(y=y.replace(/~/g,"="),y.indexOf("=")!==-1)for(var k=y.split(","),g=0;g<k.length;g++){var M=k[g].split("=",2);p[M[0]]=t(M[1])}else y.indexOf(",")!==-1?p=y.split(","):p=t(y);r[b]=p}return r}function checkStatus(n){if(!n.ok)throw new Error(`HTTP ${n.status} - ${n.statusText}`);return n}function get(n,t){var r=fetch(n).then(checkStatus).then(u=>u.text());return t?r.then(t):r}function getbin(n,t,r,u){var v;return r=="POST"?v=fetch(n,{method:"POST",body:u}).then(_=>checkStatus(_)).then(_=>_.arrayBuffer()):v=fetch(n).then(_=>checkStatus(_)).then(_=>_.arrayBuffer()),t?v.then(t):v}function download(n,t,r,u){var v="",_="",b="",p=null,y=t.addModel();if(n.indexOf(":")<0&&(n.length==4?n="pdb:"+n:isNaN(n)?n="url:"+n:n="cid:"+n),n.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),n="bcif:"+n.slice(5)),n.substring(0,5)==="bcif:")n=n.substring(5).toUpperCase(),b="https://models.rcsb.org/"+n+".bcif.gz",r&&typeof r.noComputeSecondaryStructure>"u"&&(r.noComputeSecondaryStructure=!0),p=new Promise(function(g){getbin(b).then(function(M){y.addMolData(M,"bcif.gz",r),t.zoomTo(),t.render(),g(y)},function(){console.error("fetch of "+b+" failed.")})});else{if(n.substring(0,4)==="pdb:"){if(v="bcif",r&&r.format&&(v=r.format),r&&typeof r.noComputeSecondaryStructure>"u"&&(r.noComputeSecondaryStructure=!0),n=n.substring(4).toUpperCase(),!n.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}v=="bcif"?b="https://models.rcsb.org/"+n.toUpperCase()+".bcif.gz":(_=r&&r.pdbUri?r.pdbUri:"https://files.rcsb.org/view/",b=_+n+"."+v)}else if(n.substring(0,4)=="cid:"){if(v="sdf",n=n.substring(4),!n.match(/^[0-9]+$/)){alert("Wrong Compound ID");return}b="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+n+"/SDF?record_type=3d"}else n.substring(0,4)=="url:"&&(b=n.substring(4),v=b);var k=function(g){y.addMolData(g,v,r),t.zoomTo(),t.render()};p=new Promise(function(g){v=="bcif"?getbin(b).then(function(M){k(M),g(y)}).catch(function(){_=r&&r.pdbUri?r.pdbUri:"https://files.rcsb.org/view/",b=_+n+".pdb",v="pdb",console.warn("falling back to pdb format"),get(b).then(function(M){k(M),g(y)}).catch(function(M){k(""),g(y),console.error("fetch of "+b+" failed: "+M.statusText)})}):get(b).then(function(M){k(M),g(y)}).catch(function(M){k(""),g(y),console.error("fetch of "+b+" failed: "+M.statusText)})})}return u?(p.then(function(g){u(g)}),y):p}function getColorFromStyle(n,t){let r=t.colorscheme;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[r]<"u")r=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[r];else if(typeof r=="string"&&r.endsWith("Carbon")){let _=r.substring(0,r.lastIndexOf("Carbon")).toLowerCase();if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[_]<"u"){let b=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);b.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[_],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[r]={prop:"elem",map:b},r=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[r]}}let u=n.color;if(typeof t.color<"u"&&t.color!="spectrum"&&(u=t.color),typeof r<"u"){let _,b;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[r]<"u")r=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[r],typeof r[n[r.prop]]<"u"&&(u=r.map[n[r.prop]]);else if(typeof r[n[r.prop]]<"u")u=r.map[n[r.prop]];else if(typeof r.prop<"u"&&typeof r.gradient<"u"){_=r.prop;var v=r.gradient;v instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(v=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(r));let p=v.range()||[-1,1];b=getAtomProperty(n,_),b!=null&&(u=v.valueToHex(b,p))}else typeof r.prop<"u"&&typeof r.map<"u"?(_=r.prop,b=getAtomProperty(n,_),typeof r.map[b]<"u"&&(u=r.map[b])):typeof t.colorscheme[n.elem]<"u"?u=t.colorscheme[n.elem]:console.warn("Could not interpret colorscheme "+r)}else typeof t.colorfunc<"u"&&(u=t.colorfunc(n));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(u)}function getElement(n){let t=n;return typeof n=="string"?t=document.querySelector("#"+n):typeof n=="object"&&n.get&&(t=n.get(0)),t}function inflateString(n,t=!0){let r;return typeof n=="string"?r=new TextEncoder().encode(n):r=new Uint8Array(n),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(r,{to:t?"string":null})}}),"./node_modules/upng-js/UPNG.js":((n,t,r)=>{(function(){var u={},v;n.exports=u,v=r("./node_modules/upng-js/node_modules/pako/index.js"),(function(_,b){_.toRGBA8=function(p){var y=p.width,k=p.height;if(p.tabs.acTL==null)return[_.toRGBA8.decodeImage(p.data,y,k,p).buffer];var g=[];p.frames[0].data==null&&(p.frames[0].data=p.data);for(var M,P=new Uint8Array(y*k*4),R=0;R<p.frames.length;R++){var S=p.frames[R],a=S.rect.x,s=S.rect.y,c=S.rect.width,w=S.rect.height,x=_.toRGBA8.decodeImage(S.data,c,w,p);if(R==0?M=x:S.blend==0?_._copyTile(x,c,w,M,y,k,a,s,0):S.blend==1&&_._copyTile(x,c,w,M,y,k,a,s,1),g.push(M.buffer),M=M.slice(0),S.dispose!=0){if(S.dispose==1)_._copyTile(P,c,w,M,y,k,a,s,0);else if(S.dispose==2){for(var T=R-1;p.frames[T].dispose==2;)T--;M=new Uint8Array(g[T]).slice(0)}}}return g},_.toRGBA8.decodeImage=function(p,y,k,g){var M=y*k,P=_.decode._getBPP(g),R=Math.ceil(y*P/8),S=new Uint8Array(M*4),a=new Uint32Array(S.buffer),s=g.ctype,c=g.depth,w=_._bin.readUshort;if(s==6){var x=M<<2;if(c==8)for(var T=0;T<x;T++)S[T]=p[T];if(c==16)for(var T=0;T<x;T++)S[T]=p[T<<1]}else if(s==2){var l=g.tabs.tRNS,h=-1,C=-1,E=-1;if(l&&(h=l[0],C=l[1],E=l[2]),c==8)for(var T=0;T<M;T++){var D=T<<2,z=T*3;S[D]=p[z],S[D+1]=p[z+1],S[D+2]=p[z+2],S[D+3]=255,h!=-1&&p[z]==h&&p[z+1]==C&&p[z+2]==E&&(S[D+3]=0)}if(c==16)for(var T=0;T<M;T++){var D=T<<2,z=T*6;S[D]=p[z],S[D+1]=p[z+2],S[D+2]=p[z+4],S[D+3]=255,h!=-1&&w(p,z)==h&&w(p,z+2)==C&&w(p,z+4)==E&&(S[D+3]=0)}}else if(s==3){var L=g.tabs.PLTE,V=g.tabs.tRNS,O=V?V.length:0;if(c==1)for(var W=0;W<k;W++)for(var H=W*R,q=W*y,T=0;T<y;T++){var D=q+T<<2,U=p[H+(T>>3)]>>7-((T&7)<<0)&1,B=3*U;S[D]=L[B],S[D+1]=L[B+1],S[D+2]=L[B+2],S[D+3]=U<O?V[U]:255}if(c==2)for(var W=0;W<k;W++)for(var H=W*R,q=W*y,T=0;T<y;T++){var D=q+T<<2,U=p[H+(T>>2)]>>6-((T&3)<<1)&3,B=3*U;S[D]=L[B],S[D+1]=L[B+1],S[D+2]=L[B+2],S[D+3]=U<O?V[U]:255}if(c==4)for(var W=0;W<k;W++)for(var H=W*R,q=W*y,T=0;T<y;T++){var D=q+T<<2,U=p[H+(T>>1)]>>4-((T&1)<<2)&15,B=3*U;S[D]=L[B],S[D+1]=L[B+1],S[D+2]=L[B+2],S[D+3]=U<O?V[U]:255}if(c==8)for(var T=0;T<M;T++){var D=T<<2,U=p[T],B=3*U;S[D]=L[B],S[D+1]=L[B+1],S[D+2]=L[B+2],S[D+3]=U<O?V[U]:255}}else if(s==4){if(c==8)for(var T=0;T<M;T++){var D=T<<2,Y=T<<1,X=p[Y];S[D]=X,S[D+1]=X,S[D+2]=X,S[D+3]=p[Y+1]}if(c==16)for(var T=0;T<M;T++){var D=T<<2,Y=T<<2,X=p[Y];S[D]=X,S[D+1]=X,S[D+2]=X,S[D+3]=p[Y+2]}}else if(s==0){var h=g.tabs.tRNS?g.tabs.tRNS:-1;if(c==1)for(var T=0;T<M;T++){var X=255*(p[T>>3]>>7-(T&7)&1),j=X==h*255?0:255;a[T]=j<<24|X<<16|X<<8|X}if(c==2)for(var T=0;T<M;T++){var X=85*(p[T>>2]>>6-((T&3)<<1)&3),j=X==h*85?0:255;a[T]=j<<24|X<<16|X<<8|X}if(c==4)for(var T=0;T<M;T++){var X=17*(p[T>>1]>>4-((T&1)<<2)&15),j=X==h*17?0:255;a[T]=j<<24|X<<16|X<<8|X}if(c==8)for(var T=0;T<M;T++){var X=p[T],j=X==h?0:255;a[T]=j<<24|X<<16|X<<8|X}if(c==16)for(var T=0;T<M;T++){var X=p[T<<1],j=w(p,T<<1)==h?0:255;a[T]=j<<24|X<<16|X<<8|X}}return S},_.decode=function(p){for(var y=new Uint8Array(p),k=8,g=_._bin,M=g.readUshort,P=g.readUint,R={tabs:{},frames:[]},S=new Uint8Array(y.length),a=0,s,c=0,w=[137,80,78,71,13,10,26,10],x=0;x<8;x++)if(y[x]!=w[x])throw"The input is not a PNG file!";for(;k<y.length;){var T=g.readUint(y,k);k+=4;var l=g.readASCII(y,k,4);if(k+=4,l=="IHDR")_.decode._IHDR(y,k,R);else if(l=="IDAT"){for(var x=0;x<T;x++)S[a+x]=y[k+x];a+=T}else if(l=="acTL")R.tabs[l]={num_frames:P(y,k),num_plays:P(y,k+4)},s=new Uint8Array(y.length);else if(l=="fcTL"){if(c!=0){var h=R.frames[R.frames.length-1];h.data=_.decode._decompress(R,s.slice(0,c),h.rect.width,h.rect.height),c=0}var C={x:P(y,k+12),y:P(y,k+16),width:P(y,k+4),height:P(y,k+8)},E=M(y,k+22);E=M(y,k+20)/(E==0?100:E);var D={rect:C,delay:Math.round(E*1e3),dispose:y[k+24],blend:y[k+25]};R.frames.push(D)}else if(l=="fdAT"){for(var x=0;x<T-4;x++)s[c+x]=y[k+x+4];c+=T-4}else if(l=="pHYs")R.tabs[l]=[g.readUint(y,k),g.readUint(y,k+4),y[k+8]];else if(l=="cHRM"){R.tabs[l]=[];for(var x=0;x<8;x++)R.tabs[l].push(g.readUint(y,k+x*4))}else if(l=="tEXt"){R.tabs[l]==null&&(R.tabs[l]={});var z=g.nextZero(y,k),L=g.readASCII(y,k,z-k),V=g.readASCII(y,z+1,k+T-z-1);R.tabs[l][L]=V}else if(l=="iTXt"){R.tabs[l]==null&&(R.tabs[l]={});var z=0,O=k;z=g.nextZero(y,O);var L=g.readASCII(y,O,z-O);O=z+1,y[O],y[O+1],O+=2,z=g.nextZero(y,O),g.readASCII(y,O,z-O),O=z+1,z=g.nextZero(y,O),g.readUTF8(y,O,z-O),O=z+1;var V=g.readUTF8(y,O,T-(O-k));R.tabs[l][L]=V}else if(l=="PLTE")R.tabs[l]=g.readBytes(y,k,T);else if(l=="hIST"){var W=R.tabs.PLTE.length/3;R.tabs[l]=[];for(var x=0;x<W;x++)R.tabs[l].push(M(y,k+x*2))}else if(l=="tRNS")R.ctype==3?R.tabs[l]=g.readBytes(y,k,T):R.ctype==0?R.tabs[l]=M(y,k):R.ctype==2&&(R.tabs[l]=[M(y,k),M(y,k+2),M(y,k+4)]);else if(l=="gAMA")R.tabs[l]=g.readUint(y,k)/1e5;else if(l=="sRGB")R.tabs[l]=y[k];else if(l=="bKGD")R.ctype==0||R.ctype==4?R.tabs[l]=[M(y,k)]:R.ctype==2||R.ctype==6?R.tabs[l]=[M(y,k),M(y,k+2),M(y,k+4)]:R.ctype==3&&(R.tabs[l]=y[k]);else if(l=="IEND"){if(c!=0){var h=R.frames[R.frames.length-1];h.data=_.decode._decompress(R,s.slice(0,c),h.rect.width,h.rect.height),c=0}R.data=_.decode._decompress(R,S,R.width,R.height);break}k+=T,g.readUint(y,k),k+=4}return delete R.compress,delete R.interlace,delete R.filter,R},_.decode._decompress=function(p,y,k,g){return p.compress==0&&(y=_.decode._inflate(y)),p.interlace==0?y=_.decode._filterZero(y,p,0,k,g):p.interlace==1&&(y=_.decode._readInterlace(y,p)),y},_.decode._inflate=function(p){return b.inflate(p)},_.decode._readInterlace=function(p,y){for(var k=y.width,g=y.height,M=_.decode._getBPP(y),P=M>>3,R=Math.ceil(k*M/8),S=new Uint8Array(g*R),a=0,s=[0,0,4,0,2,0,1],c=[0,4,0,2,0,1,0],w=[8,8,8,4,4,2,2],x=[8,8,4,4,2,2,1],T=0;T<7;){for(var l=w[T],h=x[T],C=0,E=0,D=s[T];D<g;)D+=l,E++;for(var z=c[T];z<k;)z+=h,C++;var L=Math.ceil(C*M/8);_.decode._filterZero(p,y,a,C,E);for(var V=0,O=s[T];O<g;){for(var W=c[T],H=a+V*L<<3;W<k;){if(M==1){var q=p[H>>3];q=q>>7-(H&7)&1,S[O*R+(W>>3)]|=q<<7-((W&3)<<0)}if(M==2){var q=p[H>>3];q=q>>6-(H&7)&3,S[O*R+(W>>2)]|=q<<6-((W&3)<<1)}if(M==4){var q=p[H>>3];q=q>>4-(H&7)&15,S[O*R+(W>>1)]|=q<<4-((W&1)<<2)}if(M>=8)for(var U=O*R+W*P,B=0;B<P;B++)S[U+B]=p[(H>>3)+B];H+=M,W+=h}V++,O+=l}C*E!=0&&(a+=E*(1+L)),T=T+1}return S},_.decode._getBPP=function(p){var y=[1,null,3,1,2,null,4][p.ctype];return y*p.depth},_.decode._filterZero=function(p,y,k,g,M){var P=_.decode._getBPP(y),R=Math.ceil(g*P/8),S=_.decode._paeth;P=Math.ceil(P/8);for(var a=0;a<M;a++){var s=k+a*R,c=s+a+1,w=p[c-1];if(w==0)for(var x=0;x<R;x++)p[s+x]=p[c+x];else if(w==1){for(var x=0;x<P;x++)p[s+x]=p[c+x];for(var x=P;x<R;x++)p[s+x]=p[c+x]+p[s+x-P]&255}else if(a==0){for(var x=0;x<P;x++)p[s+x]=p[c+x];if(w==2)for(var x=P;x<R;x++)p[s+x]=p[c+x]&255;if(w==3)for(var x=P;x<R;x++)p[s+x]=p[c+x]+(p[s+x-P]>>1)&255;if(w==4)for(var x=P;x<R;x++)p[s+x]=p[c+x]+S(p[s+x-P],0,0)&255}else{if(w==2)for(var x=0;x<R;x++)p[s+x]=p[c+x]+p[s+x-R]&255;if(w==3){for(var x=0;x<P;x++)p[s+x]=p[c+x]+(p[s+x-R]>>1)&255;for(var x=P;x<R;x++)p[s+x]=p[c+x]+(p[s+x-R]+p[s+x-P]>>1)&255}if(w==4){for(var x=0;x<P;x++)p[s+x]=p[c+x]+S(0,p[s+x-R],0)&255;for(var x=P;x<R;x++)p[s+x]=p[c+x]+S(p[s+x-P],p[s+x-R],p[s+x-P-R])&255}}}return p},_.decode._paeth=function(p,y,k){var g=p+y-k,M=Math.abs(g-p),P=Math.abs(g-y),R=Math.abs(g-k);return M<=P&&M<=R?p:P<=R?y:k},_.decode._IHDR=function(p,y,k){var g=_._bin;k.width=g.readUint(p,y),y+=4,k.height=g.readUint(p,y),y+=4,k.depth=p[y],y++,k.ctype=p[y],y++,k.compress=p[y],y++,k.filter=p[y],y++,k.interlace=p[y],y++},_._bin={nextZero:function(p,y){for(;p[y]!=0;)y++;return y},readUshort:function(p,y){return p[y]<<8|p[y+1]},writeUshort:function(p,y,k){p[y]=k>>8&255,p[y+1]=k&255},readUint:function(p,y){return p[y]*16777216+(p[y+1]<<16|p[y+2]<<8|p[y+3])},writeUint:function(p,y,k){p[y]=k>>24&255,p[y+1]=k>>16&255,p[y+2]=k>>8&255,p[y+3]=k&255},readASCII:function(p,y,k){for(var g="",M=0;M<k;M++)g+=String.fromCharCode(p[y+M]);return g},writeASCII:function(p,y,k){for(var g=0;g<k.length;g++)p[y+g]=k.charCodeAt(g)},readBytes:function(p,y,k){for(var g=[],M=0;M<k;M++)g.push(p[y+M]);return g},pad:function(p){return p.length<2?"0"+p:p},readUTF8:function(p,y,k){for(var g="",M,P=0;P<k;P++)g+="%"+_._bin.pad(p[y+P].toString(16));try{M=decodeURIComponent(g)}catch{return _._bin.readASCII(p,y,k)}return M}},_._copyTile=function(p,y,k,g,M,P,R,S,a){for(var s=Math.min(y,M),c=Math.min(k,P),w=0,x=0,T=0;T<c;T++)for(var l=0;l<s;l++)if(R>=0&&S>=0?(w=T*y+l<<2,x=(S+T)*M+R+l<<2):(w=(-S+T)*y-R+l<<2,x=T*M+l<<2),a==0)g[x]=p[w],g[x+1]=p[w+1],g[x+2]=p[w+2],g[x+3]=p[w+3];else if(a==1){var h=p[w+3]*.00392156862745098,C=p[w]*h,E=p[w+1]*h,D=p[w+2]*h,z=g[x+3]*(1/255),L=g[x]*z,V=g[x+1]*z,O=g[x+2]*z,W=1-h,H=h+z*W,q=H==0?0:1/H;g[x+3]=255*H,g[x+0]=(C+L*W)*q,g[x+1]=(E+V*W)*q,g[x+2]=(D+O*W)*q}else if(a==2){var h=p[w+3],C=p[w],E=p[w+1],D=p[w+2],z=g[x+3],L=g[x],V=g[x+1],O=g[x+2];h==z&&C==L&&E==V&&D==O?(g[x]=0,g[x+1]=0,g[x+2]=0,g[x+3]=0):(g[x]=C,g[x+1]=E,g[x+2]=D,g[x+3]=h)}else if(a==3){var h=p[w+3],C=p[w],E=p[w+1],D=p[w+2],z=g[x+3],L=g[x],V=g[x+1],O=g[x+2];if(h==z&&C==L&&E==V&&D==O)continue;if(h<220&&z>20)return!1}return!0},_.encode=function(p,y,k,g,M,P){g==null&&(g=0),P==null&&(P=!1);for(var R=new Uint8Array(p[0].byteLength*p.length+100),S=[137,80,78,71,13,10,26,10],a=0;a<8;a++)R[a]=S[a];var s=8,c=_._bin,w=_.crc.crc,x=c.writeUint,T=c.writeUshort,l=c.writeASCII,h=_.encode.compressPNG(p,y,k,g,P);x(R,s,13),s+=4,l(R,s,"IHDR"),s+=4,x(R,s,y),s+=4,x(R,s,k),s+=4,R[s]=h.depth,s++,R[s]=h.ctype,s++,R[s]=0,s++,R[s]=0,s++,R[s]=0,s++,x(R,s,w(R,s-17,17)),s+=4,x(R,s,1),s+=4,l(R,s,"sRGB"),s+=4,R[s]=1,s++,x(R,s,w(R,s-5,5)),s+=4;var C=p.length>1;if(C&&(x(R,s,8),s+=4,l(R,s,"acTL"),s+=4,x(R,s,p.length),s+=4,x(R,s,0),s+=4,x(R,s,w(R,s-12,12)),s+=4),h.ctype==3){var E=h.plte.length;x(R,s,E*3),s+=4,l(R,s,"PLTE"),s+=4;for(var a=0;a<E;a++){var D=a*3,z=h.plte[a],L=z&255,V=z>>8&255,O=z>>16&255;R[s+D+0]=L,R[s+D+1]=V,R[s+D+2]=O}if(s+=E*3,x(R,s,w(R,s-E*3-4,E*3+4)),s+=4,h.gotAlpha){x(R,s,E),s+=4,l(R,s,"tRNS"),s+=4;for(var a=0;a<E;a++)R[s+a]=h.plte[a]>>24&255;s+=E,x(R,s,w(R,s-E-4,E+4)),s+=4}}for(var W=0,H=0;H<h.frames.length;H++){var q=h.frames[H];C&&(x(R,s,26),s+=4,l(R,s,"fcTL"),s+=4,x(R,s,W++),s+=4,x(R,s,q.rect.width),s+=4,x(R,s,q.rect.height),s+=4,x(R,s,q.rect.x),s+=4,x(R,s,q.rect.y),s+=4,T(R,s,M[H]),s+=2,T(R,s,1e3),s+=2,R[s]=q.dispose,s++,R[s]=q.blend,s++,x(R,s,w(R,s-30,30)),s+=4);var U=q.cimg,E=U.length;x(R,s,E+(H==0?0:4)),s+=4;var B=s;l(R,s,H==0?"IDAT":"fdAT"),s+=4,H!=0&&(x(R,s,W++),s+=4);for(var a=0;a<E;a++)R[s+a]=U[a];s+=E,x(R,s,w(R,B,s-B)),s+=4}return x(R,s,0),s+=4,l(R,s,"IEND"),s+=4,x(R,s,w(R,s-4,4)),s+=4,R.buffer.slice(0,s)},_.encode.compressPNG=function(p,y,k,g,M){for(var P=_.encode.compress(p,y,k,g,!1,M),R=0;R<p.length;R++){var S=P.frames[R];S.rect.width;var a=S.rect.height,s=S.bpl,c=S.bpp,w=new Uint8Array(a*s+a);S.cimg=_.encode._filterZero(S.img,a,c,s,w)}return P},_.encode.compress=function(p,y,k,g,M,P){P==null&&(P=!1);for(var R=6,S=8,a=4,s=255,c=0;c<p.length;c++)for(var w=new Uint8Array(p[c]),x=w.length,T=0;T<x;T+=4)s&=w[T+3];var l=s!=255,h={},C=[];if(p.length!=0&&(h[0]=0,C.push(0),g!=0&&g--),g!=0){var E=_.quantize(p,g,M);p=E.bufs;for(var T=0;T<E.plte.length;T++){var D=E.plte[T].est.rgba;h[D]==null&&(h[D]=C.length,C.push(D))}}else for(var c=0;c<p.length;c++)for(var z=new Uint32Array(p[c]),x=z.length,T=0;T<x;T++){var D=z[T];if((T<y||D!=z[T-1]&&D!=z[T-y])&&h[D]==null&&(h[D]=C.length,C.push(D),C.length>=300))break}var L=l?M:!1,V=C.length;V<=256&&P==!1&&(V<=2?S=1:V<=4?S=2:V<=16?S=4:S=8,M&&(S=8),l=!0);for(var O=[],c=0;c<p.length;c++){var W=new Uint8Array(p[c]),H=new Uint32Array(W.buffer),q=0,U=0,B=y,Y=k,X=0;if(c!=0&&!L){for(var j=M||c==1||O[O.length-2].dispose==2?1:2,J=0,le=1e9,se=0;se<j;se++){for(var Oe=new Uint8Array(p[c-1-se]),he=new Uint32Array(p[c-1-se]),pe=y,ve=k,ce=-1,me=-1,Re=0;Re<k;Re++)for(var Ge=0;Ge<y;Ge++){var T=Re*y+Ge;H[T]!=he[T]&&(Ge<pe&&(pe=Ge),Ge>ce&&(ce=Ge),Re<ve&&(ve=Re),Re>me&&(me=Re))}var We=ce==-1?1:(ce-pe+1)*(me-ve+1);We<le&&(le=We,J=se,ce==-1?(q=U=0,B=Y=1):(q=pe,U=ve,B=ce-pe+1,Y=me-ve+1))}var Oe=new Uint8Array(p[c-1-J]);J==1&&(O[O.length-1].dispose=2);var fe=new Uint8Array(B*Y*4);new Uint32Array(fe.buffer),_._copyTile(Oe,y,k,fe,B,Y,-q,-U,0),_._copyTile(W,y,k,fe,B,Y,-q,-U,3)?(_._copyTile(W,y,k,fe,B,Y,-q,-U,2),X=1):(_._copyTile(W,y,k,fe,B,Y,-q,-U,0),X=0),W=fe,H=new Uint32Array(W.buffer)}var De=4*B;if(V<=256&&P==!1){De=Math.ceil(S*B/8);for(var fe=new Uint8Array(De*Y),Re=0;Re<Y;Re++){var T=Re*De,qe=Re*B;if(S==8)for(var Ge=0;Ge<B;Ge++)fe[T+Ge]=h[H[qe+Ge]];else if(S==4)for(var Ge=0;Ge<B;Ge++)fe[T+(Ge>>1)]|=h[H[qe+Ge]]<<4-(Ge&1)*4;else if(S==2)for(var Ge=0;Ge<B;Ge++)fe[T+(Ge>>2)]|=h[H[qe+Ge]]<<6-(Ge&3)*2;else if(S==1)for(var Ge=0;Ge<B;Ge++)fe[T+(Ge>>3)]|=h[H[qe+Ge]]<<7-(Ge&7)*1}W=fe,R=3,a=1}else if(l==!1&&p.length==1){for(var fe=new Uint8Array(B*Y*3),Qe=B*Y,T=0;T<Qe;T++){var st=T*3,ot=T*4;fe[st]=W[ot],fe[st+1]=W[ot+1],fe[st+2]=W[ot+2]}W=fe,R=2,a=3,De=3*B}O.push({rect:{x:q,y:U,width:B,height:Y},img:W,bpl:De,bpp:a,blend:X,dispose:L?1:0})}return{ctype:R,depth:S,plte:C,gotAlpha:l,frames:O}},_.encode._filterZero=function(p,y,k,g,M){for(var P=[],R=0;R<5;R++)if(!(y*g>5e5&&(R==2||R==3||R==4))){for(var S=0;S<y;S++)_.encode._filterLine(M,p,S,g,k,R);if(P.push(b.deflate(M)),k==1)break}for(var a,s=1e9,c=0;c<P.length;c++)P[c].length<s&&(a=c,s=P[c].length);return P[a]},_.encode._filterLine=function(p,y,k,g,M,P){var R=k*g,S=R+k,a=_.decode._paeth;if(p[S]=P,S++,P==0)for(var s=0;s<g;s++)p[S+s]=y[R+s];else if(P==1){for(var s=0;s<M;s++)p[S+s]=y[R+s];for(var s=M;s<g;s++)p[S+s]=y[R+s]-y[R+s-M]+256&255}else if(k==0){for(var s=0;s<M;s++)p[S+s]=y[R+s];if(P==2)for(var s=M;s<g;s++)p[S+s]=y[R+s];if(P==3)for(var s=M;s<g;s++)p[S+s]=y[R+s]-(y[R+s-M]>>1)+256&255;if(P==4)for(var s=M;s<g;s++)p[S+s]=y[R+s]-a(y[R+s-M],0,0)+256&255}else{if(P==2)for(var s=0;s<g;s++)p[S+s]=y[R+s]+256-y[R+s-g]&255;if(P==3){for(var s=0;s<M;s++)p[S+s]=y[R+s]+256-(y[R+s-g]>>1)&255;for(var s=M;s<g;s++)p[S+s]=y[R+s]+256-(y[R+s-g]+y[R+s-M]>>1)&255}if(P==4){for(var s=0;s<M;s++)p[S+s]=y[R+s]+256-a(0,y[R+s-g],0)&255;for(var s=M;s<g;s++)p[S+s]=y[R+s]+256-a(y[R+s-M],y[R+s-g],y[R+s-M-g])&255}}},_.crc={table:(function(){for(var p=new Uint32Array(256),y=0;y<256;y++){for(var k=y,g=0;g<8;g++)k&1?k=3988292384^k>>>1:k=k>>>1;p[y]=k}return p})(),update:function(p,y,k,g){for(var M=0;M<g;M++)p=_.crc.table[(p^y[k+M])&255]^p>>>8;return p},crc:function(p,y,k){return _.crc.update(4294967295,p,y,k)^4294967295}},_.quantize=function(p,y,k){for(var g=[],M=0,P=0;P<p.length;P++)g.push(_.encode.alphaMul(new Uint8Array(p[P]),k)),M+=p[P].byteLength;for(var R=new Uint8Array(M),S=new Uint32Array(R.buffer),a=0,P=0;P<g.length;P++){for(var s=g[P],c=s.length,w=0;w<c;w++)R[a+w]=s[w];a+=c}var x={i0:0,i1:R.length,bst:null,est:null,tdst:0,left:null,right:null};x.bst=_.quantize.stats(R,x.i0,x.i1),x.est=_.quantize.estats(x.bst);for(var T=[x];T.length<y;){for(var l=0,h=0,P=0;P<T.length;P++)T[P].est.L>l&&(l=T[P].est.L,h=P);if(l<.001)break;var C=T[h],E=_.quantize.splitPixels(R,S,C.i0,C.i1,C.est.e,C.est.eMq255),D={i0:C.i0,i1:E,bst:null,est:null,tdst:0,left:null,right:null};D.bst=_.quantize.stats(R,D.i0,D.i1),D.est=_.quantize.estats(D.bst);var z={i0:E,i1:C.i1,bst:null,est:null,tdst:0,left:null,right:null};z.bst={R:[],m:[],N:C.bst.N-D.bst.N};for(var P=0;P<16;P++)z.bst.R[P]=C.bst.R[P]-D.bst.R[P];for(var P=0;P<4;P++)z.bst.m[P]=C.bst.m[P]-D.bst.m[P];z.est=_.quantize.estats(z.bst),C.left=D,C.right=z,T[h]=D,T.push(z)}T.sort(function(j,J){return J.bst.N-j.bst.N});for(var L=0;L<g.length;L++){for(var V=_.quantize.planeDst,O=new Uint8Array(g[L].buffer),W=new Uint32Array(g[L].buffer),H=O.length,P=0;P<H;P+=4){for(var q=O[P]*.00392156862745098,U=O[P+1]*.00392156862745098,B=O[P+2]*.00392156862745098,Y=O[P+3]*.00392156862745098,X=x;X.left;)X=V(X.est,q,U,B,Y)<=0?X.left:X.right;W[P>>2]=X.est.rgba}g[L]=W.buffer}return{bufs:g,plte:T}},_.quantize.getNearest=function(p,y,k,g,M){if(p.left==null)return p.tdst=_.quantize.dist(p.est.q,y,k,g,M),p;var P=_.quantize.planeDst(p.est,y,k,g,M),R=p.left,S=p.right;P>0&&(R=p.right,S=p.left);var a=_.quantize.getNearest(R,y,k,g,M);if(a.tdst<=P*P)return a;var s=_.quantize.getNearest(S,y,k,g,M);return s.tdst<a.tdst?s:a},_.quantize.planeDst=function(p,y,k,g,M){var P=p.e;return P[0]*y+P[1]*k+P[2]*g+P[3]*M-p.eMq},_.quantize.dist=function(p,y,k,g,M){var P=y-p[0],R=k-p[1],S=g-p[2],a=M-p[3];return P*P+R*R+S*S+a*a},_.quantize.splitPixels=function(p,y,k,g,M,P){var R=_.quantize.vecDot;for(g-=4;k<g;){for(;R(p,k,M)<=P;)k+=4;for(;R(p,g,M)>P;)g-=4;if(k>=g)break;var S=y[k>>2];y[k>>2]=y[g>>2],y[g>>2]=S,k+=4,g-=4}for(;R(p,k,M)>P;)k-=4;return k+4},_.quantize.vecDot=function(p,y,k){return p[y]*k[0]+p[y+1]*k[1]+p[y+2]*k[2]+p[y+3]*k[3]},_.quantize.stats=function(p,y,k){for(var g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],M=[0,0,0,0],P=k-y>>2,R=y;R<k;R+=4){var S=p[R]*.00392156862745098,a=p[R+1]*(1/255),s=p[R+2]*(1/255),c=p[R+3]*(1/255);M[0]+=S,M[1]+=a,M[2]+=s,M[3]+=c,g[0]+=S*S,g[1]+=S*a,g[2]+=S*s,g[3]+=S*c,g[5]+=a*a,g[6]+=a*s,g[7]+=a*c,g[10]+=s*s,g[11]+=s*c,g[15]+=c*c}return g[4]=g[1],g[8]=g[2],g[12]=g[3],g[9]=g[6],g[13]=g[7],g[14]=g[11],{R:g,m:M,N:P}},_.quantize.estats=function(p){var y=p.R,k=p.m,g=p.N,M=k[0],P=k[1],R=k[2],S=k[3],a=g==0?0:1/g,s=[y[0]-M*M*a,y[1]-M*P*a,y[2]-M*R*a,y[3]-M*S*a,y[4]-P*M*a,y[5]-P*P*a,y[6]-P*R*a,y[7]-P*S*a,y[8]-R*M*a,y[9]-R*P*a,y[10]-R*R*a,y[11]-R*S*a,y[12]-S*M*a,y[13]-S*P*a,y[14]-S*R*a,y[15]-S*S*a],c=s,w=_.M4,x=[.5,.5,.5,.5],T=0,l=0;if(g!=0)for(var h=0;h<10&&(x=w.multVec(c,x),l=Math.sqrt(w.dot(x,x)),x=w.sml(1/l,x),!(Math.abs(l-T)<1e-9));h++)T=l;var C=[M*a,P*a,R*a,S*a],E=w.dot(w.sml(255,C),x),D=C[3]<.001?0:1/C[3];return{Cov:s,q:C,e:x,L:T,eMq255:E,eMq:w.dot(x,C),rgba:(Math.round(255*C[3])<<24|Math.round(255*C[2]*D)<<16|Math.round(255*C[1]*D)<<8|Math.round(255*C[0]*D)<<0)>>>0}},_.M4={multVec:function(p,y){return[p[0]*y[0]+p[1]*y[1]+p[2]*y[2]+p[3]*y[3],p[4]*y[0]+p[5]*y[1]+p[6]*y[2]+p[7]*y[3],p[8]*y[0]+p[9]*y[1]+p[10]*y[2]+p[11]*y[3],p[12]*y[0]+p[13]*y[1]+p[14]*y[2]+p[15]*y[3]]},dot:function(p,y){return p[0]*y[0]+p[1]*y[1]+p[2]*y[2]+p[3]*y[3]},sml:function(p,y){return[p*y[0],p*y[1],p*y[2],p*y[3]]}},_.encode.alphaMul=function(p,y){for(var k=new Uint8Array(p.length),g=p.length>>2,M=0;M<g;M++){var P=M<<2,R=p[P+3];y&&(R=R<128?0:255);var S=R*(1/255);k[P+0]=p[P+0]*S,k[P+1]=p[P+1]*S,k[P+2]=p[P+2]*S,k[P+3]=R}return k}})(u,v)})()}),"./node_modules/upng-js/node_modules/pako/index.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js").assign,v=r("./node_modules/upng-js/node_modules/pako/lib/deflate.js"),_=r("./node_modules/upng-js/node_modules/pako/lib/inflate.js"),b=r("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),p={};u(p,v,_,b),n.exports=p}),"./node_modules/upng-js/node_modules/pako/lib/deflate.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js"),v=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),_=r("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),b=r("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),p=r("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),y=Object.prototype.toString,k=0,g=4,M=0,P=1,R=2,S=-1,a=0,s=8;function c(l){if(!(this instanceof c))return new c(l);this.options=v.assign({level:S,method:s,chunkSize:16384,windowBits:15,memLevel:8,strategy:a,to:""},l||{});var h=this.options;h.raw&&h.windowBits>0?h.windowBits=-h.windowBits:h.gzip&&h.windowBits>0&&h.windowBits<16&&(h.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var C=u.deflateInit2(this.strm,h.level,h.method,h.windowBits,h.memLevel,h.strategy);if(C!==M)throw new Error(b[C]);if(h.header&&u.deflateSetHeader(this.strm,h.header),h.dictionary){var E;if(typeof h.dictionary=="string"?E=_.string2buf(h.dictionary):y.call(h.dictionary)==="[object ArrayBuffer]"?E=new Uint8Array(h.dictionary):E=h.dictionary,C=u.deflateSetDictionary(this.strm,E),C!==M)throw new Error(b[C]);this._dict_set=!0}}c.prototype.push=function(l,h){var C=this.strm,E=this.options.chunkSize,D,z;if(this.ended)return!1;z=h===~~h?h:h===!0?g:k,typeof l=="string"?C.input=_.string2buf(l):y.call(l)==="[object ArrayBuffer]"?C.input=new Uint8Array(l):C.input=l,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new v.Buf8(E),C.next_out=0,C.avail_out=E),D=u.deflate(C,z),D!==P&&D!==M)return this.onEnd(D),this.ended=!0,!1;(C.avail_out===0||C.avail_in===0&&(z===g||z===R))&&(this.options.to==="string"?this.onData(_.buf2binstring(v.shrinkBuf(C.output,C.next_out))):this.onData(v.shrinkBuf(C.output,C.next_out)))}while((C.avail_in>0||C.avail_out===0)&&D!==P);return z===g?(D=u.deflateEnd(this.strm),this.onEnd(D),this.ended=!0,D===M):(z===R&&(this.onEnd(M),C.avail_out=0),!0)},c.prototype.onData=function(l){this.chunks.push(l)},c.prototype.onEnd=function(l){l===M&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg};function w(l,h){var C=new c(h);if(C.push(l,!0),C.err)throw C.msg||b[C.err];return C.result}function x(l,h){return h=h||{},h.raw=!0,w(l,h)}function T(l,h){return h=h||{},h.gzip=!0,w(l,h)}t.Deflate=c,t.deflate=w,t.deflateRaw=x,t.gzip=T}),"./node_modules/upng-js/node_modules/pako/lib/inflate.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js"),v=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),_=r("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),b=r("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),p=r("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),y=r("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),k=r("./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js"),g=Object.prototype.toString;function M(S){if(!(this instanceof M))return new M(S);this.options=v.assign({chunkSize:16384,windowBits:0,to:""},S||{});var a=this.options;a.raw&&a.windowBits>=0&&a.windowBits<16&&(a.windowBits=-a.windowBits,a.windowBits===0&&(a.windowBits=-15)),a.windowBits>=0&&a.windowBits<16&&!(S&&S.windowBits)&&(a.windowBits+=32),a.windowBits>15&&a.windowBits<48&&(a.windowBits&15||(a.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var s=u.inflateInit2(this.strm,a.windowBits);if(s!==b.Z_OK)throw new Error(p[s]);if(this.header=new k,u.inflateGetHeader(this.strm,this.header),a.dictionary&&(typeof a.dictionary=="string"?a.dictionary=_.string2buf(a.dictionary):g.call(a.dictionary)==="[object ArrayBuffer]"&&(a.dictionary=new Uint8Array(a.dictionary)),a.raw&&(s=u.inflateSetDictionary(this.strm,a.dictionary),s!==b.Z_OK)))throw new Error(p[s])}M.prototype.push=function(S,a){var s=this.strm,c=this.options.chunkSize,w=this.options.dictionary,x,T,l,h,C,E=!1;if(this.ended)return!1;T=a===~~a?a:a===!0?b.Z_FINISH:b.Z_NO_FLUSH,typeof S=="string"?s.input=_.binstring2buf(S):g.call(S)==="[object ArrayBuffer]"?s.input=new Uint8Array(S):s.input=S,s.next_in=0,s.avail_in=s.input.length;do{if(s.avail_out===0&&(s.output=new v.Buf8(c),s.next_out=0,s.avail_out=c),x=u.inflate(s,b.Z_NO_FLUSH),x===b.Z_NEED_DICT&&w&&(x=u.inflateSetDictionary(this.strm,w)),x===b.Z_BUF_ERROR&&E===!0&&(x=b.Z_OK,E=!1),x!==b.Z_STREAM_END&&x!==b.Z_OK)return this.onEnd(x),this.ended=!0,!1;s.next_out&&(s.avail_out===0||x===b.Z_STREAM_END||s.avail_in===0&&(T===b.Z_FINISH||T===b.Z_SYNC_FLUSH))&&(this.options.to==="string"?(l=_.utf8border(s.output,s.next_out),h=s.next_out-l,C=_.buf2string(s.output,l),s.next_out=h,s.avail_out=c-h,h&&v.arraySet(s.output,s.output,l,h,0),this.onData(C)):this.onData(v.shrinkBuf(s.output,s.next_out))),s.avail_in===0&&s.avail_out===0&&(E=!0)}while((s.avail_in>0||s.avail_out===0)&&x!==b.Z_STREAM_END);return x===b.Z_STREAM_END&&(T=b.Z_FINISH),T===b.Z_FINISH?(x=u.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===b.Z_OK):(T===b.Z_SYNC_FLUSH&&(this.onEnd(b.Z_OK),s.avail_out=0),!0)},M.prototype.onData=function(S){this.chunks.push(S)},M.prototype.onEnd=function(S){S===b.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg};function P(S,a){var s=new M(a);if(s.push(S,!0),s.err)throw s.msg||p[s.err];return s.result}function R(S,a){return a=a||{},a.raw=!0,P(S,a)}t.Inflate=M,t.inflate=P,t.inflateRaw=R,t.ungzip=P}),"./node_modules/upng-js/node_modules/pako/lib/utils/common.js":((n,t)=>{var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function u(b,p){return Object.prototype.hasOwnProperty.call(b,p)}t.assign=function(b){for(var p=Array.prototype.slice.call(arguments,1);p.length;){var y=p.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(var k in y)u(y,k)&&(b[k]=y[k])}}return b},t.shrinkBuf=function(b,p){return b.length===p?b:b.subarray?b.subarray(0,p):(b.length=p,b)};var v={arraySet:function(b,p,y,k,g){if(p.subarray&&b.subarray){b.set(p.subarray(y,y+k),g);return}for(var M=0;M<k;M++)b[g+M]=p[y+M]},flattenChunks:function(b){var p,y,k,g,M,P;for(k=0,p=0,y=b.length;p<y;p++)k+=b[p].length;for(P=new Uint8Array(k),g=0,p=0,y=b.length;p<y;p++)M=b[p],P.set(M,g),g+=M.length;return P}},_={arraySet:function(b,p,y,k,g){for(var M=0;M<k;M++)b[g+M]=p[y+M]},flattenChunks:function(b){return[].concat.apply([],b)}};t.setTyped=function(b){b?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,v)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,_))},t.setTyped(r)}),"./node_modules/upng-js/node_modules/pako/lib/utils/strings.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),v=!0,_=!0;try{String.fromCharCode.apply(null,[0])}catch{v=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{_=!1}for(var b=new u.Buf8(256),p=0;p<256;p++)b[p]=p>=252?6:p>=248?5:p>=240?4:p>=224?3:p>=192?2:1;b[254]=b[254]=1,t.string2buf=function(k){var g,M,P,R,S,a=k.length,s=0;for(R=0;R<a;R++)M=k.charCodeAt(R),(M&64512)===55296&&R+1<a&&(P=k.charCodeAt(R+1),(P&64512)===56320&&(M=65536+(M-55296<<10)+(P-56320),R++)),s+=M<128?1:M<2048?2:M<65536?3:4;for(g=new u.Buf8(s),S=0,R=0;S<s;R++)M=k.charCodeAt(R),(M&64512)===55296&&R+1<a&&(P=k.charCodeAt(R+1),(P&64512)===56320&&(M=65536+(M-55296<<10)+(P-56320),R++)),M<128?g[S++]=M:M<2048?(g[S++]=192|M>>>6,g[S++]=128|M&63):M<65536?(g[S++]=224|M>>>12,g[S++]=128|M>>>6&63,g[S++]=128|M&63):(g[S++]=240|M>>>18,g[S++]=128|M>>>12&63,g[S++]=128|M>>>6&63,g[S++]=128|M&63);return g};function y(k,g){if(g<65534&&(k.subarray&&_||!k.subarray&&v))return String.fromCharCode.apply(null,u.shrinkBuf(k,g));for(var M="",P=0;P<g;P++)M+=String.fromCharCode(k[P]);return M}t.buf2binstring=function(k){return y(k,k.length)},t.binstring2buf=function(k){for(var g=new u.Buf8(k.length),M=0,P=g.length;M<P;M++)g[M]=k.charCodeAt(M);return g},t.buf2string=function(k,g){var M,P,R,S,a=g||k.length,s=new Array(a*2);for(P=0,M=0;M<a;){if(R=k[M++],R<128){s[P++]=R;continue}if(S=b[R],S>4){s[P++]=65533,M+=S-1;continue}for(R&=S===2?31:S===3?15:7;S>1&&M<a;)R=R<<6|k[M++]&63,S--;if(S>1){s[P++]=65533;continue}R<65536?s[P++]=R:(R-=65536,s[P++]=55296|R>>10&1023,s[P++]=56320|R&1023)}return y(s,P)},t.utf8border=function(k,g){var M;for(g=g||k.length,g>k.length&&(g=k.length),M=g-1;M>=0&&(k[M]&192)===128;)M--;return M<0||M===0?g:M+b[k[M]]>g?M:g}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js":(n=>{function t(r,u,v,_){for(var b=r&65535|0,p=r>>>16&65535|0,y=0;v!==0;){y=v>2e3?2e3:v,v-=y;do b=b+u[_++]|0,p=p+b|0;while(--y);b%=65521,p%=65521}return b|p<<16|0}n.exports=t}),"./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js":(n=>{n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js":(n=>{function t(){for(var v,_=[],b=0;b<256;b++){v=b;for(var p=0;p<8;p++)v=v&1?3988292384^v>>>1:v>>>1;_[b]=v}return _}var r=t();function u(v,_,b,p){var y=r,k=p+b;v^=-1;for(var g=p;g<k;g++)v=v>>>8^y[(v^_[g])&255];return v^-1}n.exports=u}),"./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),v=r("./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js"),_=r("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),b=r("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),p=r("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),y=0,k=1,g=3,M=4,P=5,R=0,S=1,a=-2,s=-3,c=-5,w=-1,x=1,T=2,l=3,h=4,C=0,E=2,D=8,z=9,L=15,V=8,O=29,W=256,H=W+1+O,q=30,U=19,B=2*H+1,Y=15,X=3,j=258,J=j+X+1,le=32,se=42,he=69,pe=73,ve=91,ce=103,me=113,Re=666,Ge=1,We=2,Oe=3,fe=4,De=3;function qe(G,Te){return G.msg=p[Te],Te}function Qe(G){return(G<<1)-(G>4?9:0)}function st(G){for(var Te=G.length;--Te>=0;)G[Te]=0}function ot(G){var Te=G.state,Ee=Te.pending;Ee>G.avail_out&&(Ee=G.avail_out),Ee!==0&&(u.arraySet(G.output,Te.pending_buf,Te.pending_out,Ee,G.next_out),G.next_out+=Ee,Te.pending_out+=Ee,G.total_out+=Ee,G.avail_out-=Ee,Te.pending-=Ee,Te.pending===0&&(Te.pending_out=0))}function Ke(G,Te){v._tr_flush_block(G,G.block_start>=0?G.block_start:-1,G.strstart-G.block_start,Te),G.block_start=G.strstart,ot(G.strm)}function Je(G,Te){G.pending_buf[G.pending++]=Te}function Xe(G,Te){G.pending_buf[G.pending++]=Te>>>8&255,G.pending_buf[G.pending++]=Te&255}function je(G,Te,Ee,re){var ge=G.avail_in;return ge>re&&(ge=re),ge===0?0:(G.avail_in-=ge,u.arraySet(Te,G.input,G.next_in,ge,Ee),G.state.wrap===1?G.adler=_(G.adler,Te,ge,Ee):G.state.wrap===2&&(G.adler=b(G.adler,Te,ge,Ee)),G.next_in+=ge,G.total_in+=ge,ge)}function Ue(G,Te){var Ee=G.max_chain_length,re=G.strstart,ge,ke,ct=G.prev_length,lt=G.nice_match,dt=G.strstart>G.w_size-J?G.strstart-(G.w_size-J):0,yt=G.window,ir=G.w_mask,At=G.prev,Mt=G.strstart+j,Pt=yt[re+ct-1],Qt=yt[re+ct];G.prev_length>=G.good_match&&(Ee>>=2),lt>G.lookahead&&(lt=G.lookahead);do if(ge=Te,!(yt[ge+ct]!==Qt||yt[ge+ct-1]!==Pt||yt[ge]!==yt[re]||yt[++ge]!==yt[re+1])){re+=2,ge++;do;while(yt[++re]===yt[++ge]&&yt[++re]===yt[++ge]&&yt[++re]===yt[++ge]&&yt[++re]===yt[++ge]&&yt[++re]===yt[++ge]&&yt[++re]===yt[++ge]&&yt[++re]===yt[++ge]&&yt[++re]===yt[++ge]&&re<Mt);if(ke=j-(Mt-re),re=Mt-j,ke>ct){if(G.match_start=Te,ct=ke,ke>=lt)break;Pt=yt[re+ct-1],Qt=yt[re+ct]}}while((Te=At[Te&ir])>dt&&--Ee!==0);return ct<=G.lookahead?ct:G.lookahead}function ft(G){var Te=G.w_size,Ee,re,ge,ke,ct;do{if(ke=G.window_size-G.lookahead-G.strstart,G.strstart>=Te+(Te-J)){u.arraySet(G.window,G.window,Te,Te,0),G.match_start-=Te,G.strstart-=Te,G.block_start-=Te,re=G.hash_size,Ee=re;do ge=G.head[--Ee],G.head[Ee]=ge>=Te?ge-Te:0;while(--re);re=Te,Ee=re;do ge=G.prev[--Ee],G.prev[Ee]=ge>=Te?ge-Te:0;while(--re);ke+=Te}if(G.strm.avail_in===0)break;if(re=je(G.strm,G.window,G.strstart+G.lookahead,ke),G.lookahead+=re,G.lookahead+G.insert>=X)for(ct=G.strstart-G.insert,G.ins_h=G.window[ct],G.ins_h=(G.ins_h<<G.hash_shift^G.window[ct+1])&G.hash_mask;G.insert&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[ct+X-1])&G.hash_mask,G.prev[ct&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=ct,ct++,G.insert--,!(G.lookahead+G.insert<X)););}while(G.lookahead<J&&G.strm.avail_in!==0)}function ut(G,Te){var Ee=65535;for(Ee>G.pending_buf_size-5&&(Ee=G.pending_buf_size-5);;){if(G.lookahead<=1){if(ft(G),G.lookahead===0&&Te===y)return Ge;if(G.lookahead===0)break}G.strstart+=G.lookahead,G.lookahead=0;var re=G.block_start+Ee;if((G.strstart===0||G.strstart>=re)&&(G.lookahead=G.strstart-re,G.strstart=re,Ke(G,!1),G.strm.avail_out===0)||G.strstart-G.block_start>=G.w_size-J&&(Ke(G,!1),G.strm.avail_out===0))return Ge}return G.insert=0,Te===M?(Ke(G,!0),G.strm.avail_out===0?Oe:fe):(G.strstart>G.block_start&&(Ke(G,!1),G.strm.avail_out),Ge)}function ee(G,Te){for(var Ee,re;;){if(G.lookahead<J){if(ft(G),G.lookahead<J&&Te===y)return Ge;if(G.lookahead===0)break}if(Ee=0,G.lookahead>=X&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+X-1])&G.hash_mask,Ee=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),Ee!==0&&G.strstart-Ee<=G.w_size-J&&(G.match_length=Ue(G,Ee)),G.match_length>=X)if(re=v._tr_tally(G,G.strstart-G.match_start,G.match_length-X),G.lookahead-=G.match_length,G.match_length<=G.max_lazy_match&&G.lookahead>=X){G.match_length--;do G.strstart++,G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+X-1])&G.hash_mask,Ee=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart;while(--G.match_length!==0);G.strstart++}else G.strstart+=G.match_length,G.match_length=0,G.ins_h=G.window[G.strstart],G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+1])&G.hash_mask;else re=v._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++;if(re&&(Ke(G,!1),G.strm.avail_out===0))return Ge}return G.insert=G.strstart<X-1?G.strstart:X-1,Te===M?(Ke(G,!0),G.strm.avail_out===0?Oe:fe):G.last_lit&&(Ke(G,!1),G.strm.avail_out===0)?Ge:We}function ie(G,Te){for(var Ee,re,ge;;){if(G.lookahead<J){if(ft(G),G.lookahead<J&&Te===y)return Ge;if(G.lookahead===0)break}if(Ee=0,G.lookahead>=X&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+X-1])&G.hash_mask,Ee=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),G.prev_length=G.match_length,G.prev_match=G.match_start,G.match_length=X-1,Ee!==0&&G.prev_length<G.max_lazy_match&&G.strstart-Ee<=G.w_size-J&&(G.match_length=Ue(G,Ee),G.match_length<=5&&(G.strategy===x||G.match_length===X&&G.strstart-G.match_start>4096)&&(G.match_length=X-1)),G.prev_length>=X&&G.match_length<=G.prev_length){ge=G.strstart+G.lookahead-X,re=v._tr_tally(G,G.strstart-1-G.prev_match,G.prev_length-X),G.lookahead-=G.prev_length-1,G.prev_length-=2;do++G.strstart<=ge&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+X-1])&G.hash_mask,Ee=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart);while(--G.prev_length!==0);if(G.match_available=0,G.match_length=X-1,G.strstart++,re&&(Ke(G,!1),G.strm.avail_out===0))return Ge}else if(G.match_available){if(re=v._tr_tally(G,0,G.window[G.strstart-1]),re&&Ke(G,!1),G.strstart++,G.lookahead--,G.strm.avail_out===0)return Ge}else G.match_available=1,G.strstart++,G.lookahead--}return G.match_available&&(re=v._tr_tally(G,0,G.window[G.strstart-1]),G.match_available=0),G.insert=G.strstart<X-1?G.strstart:X-1,Te===M?(Ke(G,!0),G.strm.avail_out===0?Oe:fe):G.last_lit&&(Ke(G,!1),G.strm.avail_out===0)?Ge:We}function oe(G,Te){for(var Ee,re,ge,ke,ct=G.window;;){if(G.lookahead<=j){if(ft(G),G.lookahead<=j&&Te===y)return Ge;if(G.lookahead===0)break}if(G.match_length=0,G.lookahead>=X&&G.strstart>0&&(ge=G.strstart-1,re=ct[ge],re===ct[++ge]&&re===ct[++ge]&&re===ct[++ge])){ke=G.strstart+j;do;while(re===ct[++ge]&&re===ct[++ge]&&re===ct[++ge]&&re===ct[++ge]&&re===ct[++ge]&&re===ct[++ge]&&re===ct[++ge]&&re===ct[++ge]&&ge<ke);G.match_length=j-(ke-ge),G.match_length>G.lookahead&&(G.match_length=G.lookahead)}if(G.match_length>=X?(Ee=v._tr_tally(G,1,G.match_length-X),G.lookahead-=G.match_length,G.strstart+=G.match_length,G.match_length=0):(Ee=v._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++),Ee&&(Ke(G,!1),G.strm.avail_out===0))return Ge}return G.insert=0,Te===M?(Ke(G,!0),G.strm.avail_out===0?Oe:fe):G.last_lit&&(Ke(G,!1),G.strm.avail_out===0)?Ge:We}function we(G,Te){for(var Ee;;){if(G.lookahead===0&&(ft(G),G.lookahead===0)){if(Te===y)return Ge;break}if(G.match_length=0,Ee=v._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++,Ee&&(Ke(G,!1),G.strm.avail_out===0))return Ge}return G.insert=0,Te===M?(Ke(G,!0),G.strm.avail_out===0?Oe:fe):G.last_lit&&(Ke(G,!1),G.strm.avail_out===0)?Ge:We}function Se(G,Te,Ee,re,ge){this.good_length=G,this.max_lazy=Te,this.nice_length=Ee,this.max_chain=re,this.func=ge}var He;He=[new Se(0,0,0,0,ut),new Se(4,4,8,4,ee),new Se(4,5,16,8,ee),new Se(4,6,32,32,ee),new Se(4,4,16,16,ie),new Se(8,16,32,32,ie),new Se(8,16,128,128,ie),new Se(8,32,128,256,ie),new Se(32,128,258,1024,ie),new Se(32,258,258,4096,ie)];function Be(G){G.window_size=2*G.w_size,st(G.head),G.max_lazy_match=He[G.level].max_lazy,G.good_match=He[G.level].good_length,G.nice_match=He[G.level].nice_length,G.max_chain_length=He[G.level].max_chain,G.strstart=0,G.block_start=0,G.lookahead=0,G.insert=0,G.match_length=G.prev_length=X-1,G.match_available=0,G.ins_h=0}function K(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=D,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new u.Buf16(B*2),this.dyn_dtree=new u.Buf16((2*q+1)*2),this.bl_tree=new u.Buf16((2*U+1)*2),st(this.dyn_ltree),st(this.dyn_dtree),st(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new u.Buf16(Y+1),this.heap=new u.Buf16(2*H+1),st(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new u.Buf16(2*H+1),st(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _e(G){var Te;return!G||!G.state?qe(G,a):(G.total_in=G.total_out=0,G.data_type=E,Te=G.state,Te.pending=0,Te.pending_out=0,Te.wrap<0&&(Te.wrap=-Te.wrap),Te.status=Te.wrap?se:me,G.adler=Te.wrap===2?0:1,Te.last_flush=y,v._tr_init(Te),R)}function Me(G){var Te=_e(G);return Te===R&&Be(G.state),Te}function $e(G,Te){return!G||!G.state||G.state.wrap!==2?a:(G.state.gzhead=Te,R)}function ye(G,Te,Ee,re,ge,ke){if(!G)return a;var ct=1;if(Te===w&&(Te=6),re<0?(ct=0,re=-re):re>15&&(ct=2,re-=16),ge<1||ge>z||Ee!==D||re<8||re>15||Te<0||Te>9||ke<0||ke>h)return qe(G,a);re===8&&(re=9);var lt=new K;return G.state=lt,lt.strm=G,lt.wrap=ct,lt.gzhead=null,lt.w_bits=re,lt.w_size=1<<lt.w_bits,lt.w_mask=lt.w_size-1,lt.hash_bits=ge+7,lt.hash_size=1<<lt.hash_bits,lt.hash_mask=lt.hash_size-1,lt.hash_shift=~~((lt.hash_bits+X-1)/X),lt.window=new u.Buf8(lt.w_size*2),lt.head=new u.Buf16(lt.hash_size),lt.prev=new u.Buf16(lt.w_size),lt.lit_bufsize=1<<ge+6,lt.pending_buf_size=lt.lit_bufsize*4,lt.pending_buf=new u.Buf8(lt.pending_buf_size),lt.d_buf=1*lt.lit_bufsize,lt.l_buf=3*lt.lit_bufsize,lt.level=Te,lt.strategy=ke,lt.method=Ee,Me(G)}function Ne(G,Te){return ye(G,Te,D,L,V,C)}function Z(G,Te){var Ee,re,ge,ke;if(!G||!G.state||Te>P||Te<0)return G?qe(G,a):a;if(re=G.state,!G.output||!G.input&&G.avail_in!==0||re.status===Re&&Te!==M)return qe(G,G.avail_out===0?c:a);if(re.strm=G,Ee=re.last_flush,re.last_flush=Te,re.status===se)if(re.wrap===2)G.adler=0,Je(re,31),Je(re,139),Je(re,8),re.gzhead?(Je(re,(re.gzhead.text?1:0)+(re.gzhead.hcrc?2:0)+(re.gzhead.extra?4:0)+(re.gzhead.name?8:0)+(re.gzhead.comment?16:0)),Je(re,re.gzhead.time&255),Je(re,re.gzhead.time>>8&255),Je(re,re.gzhead.time>>16&255),Je(re,re.gzhead.time>>24&255),Je(re,re.level===9?2:re.strategy>=T||re.level<2?4:0),Je(re,re.gzhead.os&255),re.gzhead.extra&&re.gzhead.extra.length&&(Je(re,re.gzhead.extra.length&255),Je(re,re.gzhead.extra.length>>8&255)),re.gzhead.hcrc&&(G.adler=b(G.adler,re.pending_buf,re.pending,0)),re.gzindex=0,re.status=he):(Je(re,0),Je(re,0),Je(re,0),Je(re,0),Je(re,0),Je(re,re.level===9?2:re.strategy>=T||re.level<2?4:0),Je(re,De),re.status=me);else{var ct=D+(re.w_bits-8<<4)<<8,lt=-1;re.strategy>=T||re.level<2?lt=0:re.level<6?lt=1:re.level===6?lt=2:lt=3,ct|=lt<<6,re.strstart!==0&&(ct|=le),ct+=31-ct%31,re.status=me,Xe(re,ct),re.strstart!==0&&(Xe(re,G.adler>>>16),Xe(re,G.adler&65535)),G.adler=1}if(re.status===he)if(re.gzhead.extra){for(ge=re.pending;re.gzindex<(re.gzhead.extra.length&65535)&&!(re.pending===re.pending_buf_size&&(re.gzhead.hcrc&&re.pending>ge&&(G.adler=b(G.adler,re.pending_buf,re.pending-ge,ge)),ot(G),ge=re.pending,re.pending===re.pending_buf_size));)Je(re,re.gzhead.extra[re.gzindex]&255),re.gzindex++;re.gzhead.hcrc&&re.pending>ge&&(G.adler=b(G.adler,re.pending_buf,re.pending-ge,ge)),re.gzindex===re.gzhead.extra.length&&(re.gzindex=0,re.status=pe)}else re.status=pe;if(re.status===pe)if(re.gzhead.name){ge=re.pending;do{if(re.pending===re.pending_buf_size&&(re.gzhead.hcrc&&re.pending>ge&&(G.adler=b(G.adler,re.pending_buf,re.pending-ge,ge)),ot(G),ge=re.pending,re.pending===re.pending_buf_size)){ke=1;break}re.gzindex<re.gzhead.name.length?ke=re.gzhead.name.charCodeAt(re.gzindex++)&255:ke=0,Je(re,ke)}while(ke!==0);re.gzhead.hcrc&&re.pending>ge&&(G.adler=b(G.adler,re.pending_buf,re.pending-ge,ge)),ke===0&&(re.gzindex=0,re.status=ve)}else re.status=ve;if(re.status===ve)if(re.gzhead.comment){ge=re.pending;do{if(re.pending===re.pending_buf_size&&(re.gzhead.hcrc&&re.pending>ge&&(G.adler=b(G.adler,re.pending_buf,re.pending-ge,ge)),ot(G),ge=re.pending,re.pending===re.pending_buf_size)){ke=1;break}re.gzindex<re.gzhead.comment.length?ke=re.gzhead.comment.charCodeAt(re.gzindex++)&255:ke=0,Je(re,ke)}while(ke!==0);re.gzhead.hcrc&&re.pending>ge&&(G.adler=b(G.adler,re.pending_buf,re.pending-ge,ge)),ke===0&&(re.status=ce)}else re.status=ce;if(re.status===ce&&(re.gzhead.hcrc?(re.pending+2>re.pending_buf_size&&ot(G),re.pending+2<=re.pending_buf_size&&(Je(re,G.adler&255),Je(re,G.adler>>8&255),G.adler=0,re.status=me)):re.status=me),re.pending!==0){if(ot(G),G.avail_out===0)return re.last_flush=-1,R}else if(G.avail_in===0&&Qe(Te)<=Qe(Ee)&&Te!==M)return qe(G,c);if(re.status===Re&&G.avail_in!==0)return qe(G,c);if(G.avail_in!==0||re.lookahead!==0||Te!==y&&re.status!==Re){var dt=re.strategy===T?we(re,Te):re.strategy===l?oe(re,Te):He[re.level].func(re,Te);if((dt===Oe||dt===fe)&&(re.status=Re),dt===Ge||dt===Oe)return G.avail_out===0&&(re.last_flush=-1),R;if(dt===We&&(Te===k?v._tr_align(re):Te!==P&&(v._tr_stored_block(re,0,0,!1),Te===g&&(st(re.head),re.lookahead===0&&(re.strstart=0,re.block_start=0,re.insert=0))),ot(G),G.avail_out===0))return re.last_flush=-1,R}return Te!==M?R:re.wrap<=0?S:(re.wrap===2?(Je(re,G.adler&255),Je(re,G.adler>>8&255),Je(re,G.adler>>16&255),Je(re,G.adler>>24&255),Je(re,G.total_in&255),Je(re,G.total_in>>8&255),Je(re,G.total_in>>16&255),Je(re,G.total_in>>24&255)):(Xe(re,G.adler>>>16),Xe(re,G.adler&65535)),ot(G),re.wrap>0&&(re.wrap=-re.wrap),re.pending!==0?R:S)}function ze(G){var Te;return!G||!G.state?a:(Te=G.state.status,Te!==se&&Te!==he&&Te!==pe&&Te!==ve&&Te!==ce&&Te!==me&&Te!==Re?qe(G,a):(G.state=null,Te===me?qe(G,s):R))}function rt(G,Te){var Ee=Te.length,re,ge,ke,ct,lt,dt,yt,ir;if(!G||!G.state||(re=G.state,ct=re.wrap,ct===2||ct===1&&re.status!==se||re.lookahead))return a;for(ct===1&&(G.adler=_(G.adler,Te,Ee,0)),re.wrap=0,Ee>=re.w_size&&(ct===0&&(st(re.head),re.strstart=0,re.block_start=0,re.insert=0),ir=new u.Buf8(re.w_size),u.arraySet(ir,Te,Ee-re.w_size,re.w_size,0),Te=ir,Ee=re.w_size),lt=G.avail_in,dt=G.next_in,yt=G.input,G.avail_in=Ee,G.next_in=0,G.input=Te,ft(re);re.lookahead>=X;){ge=re.strstart,ke=re.lookahead-(X-1);do re.ins_h=(re.ins_h<<re.hash_shift^re.window[ge+X-1])&re.hash_mask,re.prev[ge&re.w_mask]=re.head[re.ins_h],re.head[re.ins_h]=ge,ge++;while(--ke);re.strstart=ge,re.lookahead=X-1,ft(re)}return re.strstart+=re.lookahead,re.block_start=re.strstart,re.insert=re.lookahead,re.lookahead=0,re.match_length=re.prev_length=X-1,re.match_available=0,G.next_in=dt,G.input=yt,G.avail_in=lt,re.wrap=ct,R}t.deflateInit=Ne,t.deflateInit2=ye,t.deflateReset=Me,t.deflateResetKeep=_e,t.deflateSetHeader=$e,t.deflate=Z,t.deflateEnd=ze,t.deflateSetDictionary=rt,t.deflateInfo="pako deflate (from Nodeca project)"}),"./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js":(n=>{function t(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}n.exports=t}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js":(n=>{var t=30,r=12;n.exports=function(u,v){var _,b,p,y,k,g,M,P,R,S,a,s,c,w,x,T,l,h,C,E,D,z,L,V,O;_=u.state,b=u.next_in,V=u.input,p=b+(u.avail_in-5),y=u.next_out,O=u.output,k=y-(v-u.avail_out),g=y+(u.avail_out-257),M=_.dmax,P=_.wsize,R=_.whave,S=_.wnext,a=_.window,s=_.hold,c=_.bits,w=_.lencode,x=_.distcode,T=(1<<_.lenbits)-1,l=(1<<_.distbits)-1;e:do{c<15&&(s+=V[b++]<<c,c+=8,s+=V[b++]<<c,c+=8),h=w[s&T];t:for(;;){if(C=h>>>24,s>>>=C,c-=C,C=h>>>16&255,C===0)O[y++]=h&65535;else if(C&16){E=h&65535,C&=15,C&&(c<C&&(s+=V[b++]<<c,c+=8),E+=s&(1<<C)-1,s>>>=C,c-=C),c<15&&(s+=V[b++]<<c,c+=8,s+=V[b++]<<c,c+=8),h=x[s&l];r:for(;;){if(C=h>>>24,s>>>=C,c-=C,C=h>>>16&255,C&16){if(D=h&65535,C&=15,c<C&&(s+=V[b++]<<c,c+=8,c<C&&(s+=V[b++]<<c,c+=8)),D+=s&(1<<C)-1,D>M){u.msg="invalid distance too far back",_.mode=t;break e}if(s>>>=C,c-=C,C=y-k,D>C){if(C=D-C,C>R&&_.sane){u.msg="invalid distance too far back",_.mode=t;break e}if(z=0,L=a,S===0){if(z+=P-C,C<E){E-=C;do O[y++]=a[z++];while(--C);z=y-D,L=O}}else if(S<C){if(z+=P+S-C,C-=S,C<E){E-=C;do O[y++]=a[z++];while(--C);if(z=0,S<E){C=S,E-=C;do O[y++]=a[z++];while(--C);z=y-D,L=O}}}else if(z+=S-C,C<E){E-=C;do O[y++]=a[z++];while(--C);z=y-D,L=O}for(;E>2;)O[y++]=L[z++],O[y++]=L[z++],O[y++]=L[z++],E-=3;E&&(O[y++]=L[z++],E>1&&(O[y++]=L[z++]))}else{z=y-D;do O[y++]=O[z++],O[y++]=O[z++],O[y++]=O[z++],E-=3;while(E>2);E&&(O[y++]=O[z++],E>1&&(O[y++]=O[z++]))}}else if(C&64){u.msg="invalid distance code",_.mode=t;break e}else{h=x[(h&65535)+(s&(1<<C)-1)];continue r}break}}else if(C&64)if(C&32){_.mode=r;break e}else{u.msg="invalid literal/length code",_.mode=t;break e}else{h=w[(h&65535)+(s&(1<<C)-1)];continue t}break}}while(b<p&&y<g);E=c>>3,b-=E,c-=E<<3,s&=(1<<c)-1,u.next_in=b,u.next_out=y,u.avail_in=b<p?5+(p-b):5-(b-p),u.avail_out=y<g?257+(g-y):257-(y-g),_.hold=s,_.bits=c}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),v=r("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),_=r("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),b=r("./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js"),p=r("./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js"),y=0,k=1,g=2,M=4,P=5,R=6,S=0,a=1,s=2,c=-2,w=-3,x=-4,T=-5,l=8,h=1,C=2,E=3,D=4,z=5,L=6,V=7,O=8,W=9,H=10,q=11,U=12,B=13,Y=14,X=15,j=16,J=17,le=18,se=19,he=20,pe=21,ve=22,ce=23,me=24,Re=25,Ge=26,We=27,Oe=28,fe=29,De=30,qe=31,Qe=32,st=852,ot=592,Ke=15,Je=Ke;function Xe(ye){return(ye>>>24&255)+(ye>>>8&65280)+((ye&65280)<<8)+((ye&255)<<24)}function je(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new u.Buf16(320),this.work=new u.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Ue(ye){var Ne;return!ye||!ye.state?c:(Ne=ye.state,ye.total_in=ye.total_out=Ne.total=0,ye.msg="",Ne.wrap&&(ye.adler=Ne.wrap&1),Ne.mode=h,Ne.last=0,Ne.havedict=0,Ne.dmax=32768,Ne.head=null,Ne.hold=0,Ne.bits=0,Ne.lencode=Ne.lendyn=new u.Buf32(st),Ne.distcode=Ne.distdyn=new u.Buf32(ot),Ne.sane=1,Ne.back=-1,S)}function ft(ye){var Ne;return!ye||!ye.state?c:(Ne=ye.state,Ne.wsize=0,Ne.whave=0,Ne.wnext=0,Ue(ye))}function ut(ye,Ne){var Z,ze;return!ye||!ye.state||(ze=ye.state,Ne<0?(Z=0,Ne=-Ne):(Z=(Ne>>4)+1,Ne<48&&(Ne&=15)),Ne&&(Ne<8||Ne>15))?c:(ze.window!==null&&ze.wbits!==Ne&&(ze.window=null),ze.wrap=Z,ze.wbits=Ne,ft(ye))}function ee(ye,Ne){var Z,ze;return ye?(ze=new je,ye.state=ze,ze.window=null,Z=ut(ye,Ne),Z!==S&&(ye.state=null),Z):c}function ie(ye){return ee(ye,Je)}var oe=!0,we,Se;function He(ye){if(oe){var Ne;for(we=new u.Buf32(512),Se=new u.Buf32(32),Ne=0;Ne<144;)ye.lens[Ne++]=8;for(;Ne<256;)ye.lens[Ne++]=9;for(;Ne<280;)ye.lens[Ne++]=7;for(;Ne<288;)ye.lens[Ne++]=8;for(p(k,ye.lens,0,288,we,0,ye.work,{bits:9}),Ne=0;Ne<32;)ye.lens[Ne++]=5;p(g,ye.lens,0,32,Se,0,ye.work,{bits:5}),oe=!1}ye.lencode=we,ye.lenbits=9,ye.distcode=Se,ye.distbits=5}function Be(ye,Ne,Z,ze){var rt,G=ye.state;return G.window===null&&(G.wsize=1<<G.wbits,G.wnext=0,G.whave=0,G.window=new u.Buf8(G.wsize)),ze>=G.wsize?(u.arraySet(G.window,Ne,Z-G.wsize,G.wsize,0),G.wnext=0,G.whave=G.wsize):(rt=G.wsize-G.wnext,rt>ze&&(rt=ze),u.arraySet(G.window,Ne,Z-ze,rt,G.wnext),ze-=rt,ze?(u.arraySet(G.window,Ne,Z-ze,ze,0),G.wnext=ze,G.whave=G.wsize):(G.wnext+=rt,G.wnext===G.wsize&&(G.wnext=0),G.whave<G.wsize&&(G.whave+=rt))),0}function K(ye,Ne){var Z,ze,rt,G,Te,Ee,re,ge,ke,ct,lt,dt,yt,ir,At=0,Mt,Pt,Qt,Kt,Kr,ai,Lt,Wt,qt=new u.Buf8(4),wr,dr,jr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ye||!ye.state||!ye.output||!ye.input&&ye.avail_in!==0)return c;Z=ye.state,Z.mode===U&&(Z.mode=B),Te=ye.next_out,rt=ye.output,re=ye.avail_out,G=ye.next_in,ze=ye.input,Ee=ye.avail_in,ge=Z.hold,ke=Z.bits,ct=Ee,lt=re,Wt=S;e:for(;;)switch(Z.mode){case h:if(Z.wrap===0){Z.mode=B;break}for(;ke<16;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}if(Z.wrap&2&&ge===35615){Z.check=0,qt[0]=ge&255,qt[1]=ge>>>8&255,Z.check=_(Z.check,qt,2,0),ge=0,ke=0,Z.mode=C;break}if(Z.flags=0,Z.head&&(Z.head.done=!1),!(Z.wrap&1)||(((ge&255)<<8)+(ge>>8))%31){ye.msg="incorrect header check",Z.mode=De;break}if((ge&15)!==l){ye.msg="unknown compression method",Z.mode=De;break}if(ge>>>=4,ke-=4,Lt=(ge&15)+8,Z.wbits===0)Z.wbits=Lt;else if(Lt>Z.wbits){ye.msg="invalid window size",Z.mode=De;break}Z.dmax=1<<Lt,ye.adler=Z.check=1,Z.mode=ge&512?H:U,ge=0,ke=0;break;case C:for(;ke<16;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}if(Z.flags=ge,(Z.flags&255)!==l){ye.msg="unknown compression method",Z.mode=De;break}if(Z.flags&57344){ye.msg="unknown header flags set",Z.mode=De;break}Z.head&&(Z.head.text=ge>>8&1),Z.flags&512&&(qt[0]=ge&255,qt[1]=ge>>>8&255,Z.check=_(Z.check,qt,2,0)),ge=0,ke=0,Z.mode=E;case E:for(;ke<32;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}Z.head&&(Z.head.time=ge),Z.flags&512&&(qt[0]=ge&255,qt[1]=ge>>>8&255,qt[2]=ge>>>16&255,qt[3]=ge>>>24&255,Z.check=_(Z.check,qt,4,0)),ge=0,ke=0,Z.mode=D;case D:for(;ke<16;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}Z.head&&(Z.head.xflags=ge&255,Z.head.os=ge>>8),Z.flags&512&&(qt[0]=ge&255,qt[1]=ge>>>8&255,Z.check=_(Z.check,qt,2,0)),ge=0,ke=0,Z.mode=z;case z:if(Z.flags&1024){for(;ke<16;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}Z.length=ge,Z.head&&(Z.head.extra_len=ge),Z.flags&512&&(qt[0]=ge&255,qt[1]=ge>>>8&255,Z.check=_(Z.check,qt,2,0)),ge=0,ke=0}else Z.head&&(Z.head.extra=null);Z.mode=L;case L:if(Z.flags&1024&&(dt=Z.length,dt>Ee&&(dt=Ee),dt&&(Z.head&&(Lt=Z.head.extra_len-Z.length,Z.head.extra||(Z.head.extra=new Array(Z.head.extra_len)),u.arraySet(Z.head.extra,ze,G,dt,Lt)),Z.flags&512&&(Z.check=_(Z.check,ze,dt,G)),Ee-=dt,G+=dt,Z.length-=dt),Z.length))break e;Z.length=0,Z.mode=V;case V:if(Z.flags&2048){if(Ee===0)break e;dt=0;do Lt=ze[G+dt++],Z.head&&Lt&&Z.length<65536&&(Z.head.name+=String.fromCharCode(Lt));while(Lt&&dt<Ee);if(Z.flags&512&&(Z.check=_(Z.check,ze,dt,G)),Ee-=dt,G+=dt,Lt)break e}else Z.head&&(Z.head.name=null);Z.length=0,Z.mode=O;case O:if(Z.flags&4096){if(Ee===0)break e;dt=0;do Lt=ze[G+dt++],Z.head&&Lt&&Z.length<65536&&(Z.head.comment+=String.fromCharCode(Lt));while(Lt&&dt<Ee);if(Z.flags&512&&(Z.check=_(Z.check,ze,dt,G)),Ee-=dt,G+=dt,Lt)break e}else Z.head&&(Z.head.comment=null);Z.mode=W;case W:if(Z.flags&512){for(;ke<16;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}if(ge!==(Z.check&65535)){ye.msg="header crc mismatch",Z.mode=De;break}ge=0,ke=0}Z.head&&(Z.head.hcrc=Z.flags>>9&1,Z.head.done=!0),ye.adler=Z.check=0,Z.mode=U;break;case H:for(;ke<32;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}ye.adler=Z.check=Xe(ge),ge=0,ke=0,Z.mode=q;case q:if(Z.havedict===0)return ye.next_out=Te,ye.avail_out=re,ye.next_in=G,ye.avail_in=Ee,Z.hold=ge,Z.bits=ke,s;ye.adler=Z.check=1,Z.mode=U;case U:if(Ne===P||Ne===R)break e;case B:if(Z.last){ge>>>=ke&7,ke-=ke&7,Z.mode=We;break}for(;ke<3;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}switch(Z.last=ge&1,ge>>>=1,ke-=1,ge&3){case 0:Z.mode=Y;break;case 1:if(He(Z),Z.mode=he,Ne===R){ge>>>=2,ke-=2;break e}break;case 2:Z.mode=J;break;case 3:ye.msg="invalid block type",Z.mode=De}ge>>>=2,ke-=2;break;case Y:for(ge>>>=ke&7,ke-=ke&7;ke<32;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}if((ge&65535)!==(ge>>>16^65535)){ye.msg="invalid stored block lengths",Z.mode=De;break}if(Z.length=ge&65535,ge=0,ke=0,Z.mode=X,Ne===R)break e;case X:Z.mode=j;case j:if(dt=Z.length,dt){if(dt>Ee&&(dt=Ee),dt>re&&(dt=re),dt===0)break e;u.arraySet(rt,ze,G,dt,Te),Ee-=dt,G+=dt,re-=dt,Te+=dt,Z.length-=dt;break}Z.mode=U;break;case J:for(;ke<14;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}if(Z.nlen=(ge&31)+257,ge>>>=5,ke-=5,Z.ndist=(ge&31)+1,ge>>>=5,ke-=5,Z.ncode=(ge&15)+4,ge>>>=4,ke-=4,Z.nlen>286||Z.ndist>30){ye.msg="too many length or distance symbols",Z.mode=De;break}Z.have=0,Z.mode=le;case le:for(;Z.have<Z.ncode;){for(;ke<3;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}Z.lens[jr[Z.have++]]=ge&7,ge>>>=3,ke-=3}for(;Z.have<19;)Z.lens[jr[Z.have++]]=0;if(Z.lencode=Z.lendyn,Z.lenbits=7,wr={bits:Z.lenbits},Wt=p(y,Z.lens,0,19,Z.lencode,0,Z.work,wr),Z.lenbits=wr.bits,Wt){ye.msg="invalid code lengths set",Z.mode=De;break}Z.have=0,Z.mode=se;case se:for(;Z.have<Z.nlen+Z.ndist;){for(;At=Z.lencode[ge&(1<<Z.lenbits)-1],Mt=At>>>24,Pt=At>>>16&255,Qt=At&65535,!(Mt<=ke);){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}if(Qt<16)ge>>>=Mt,ke-=Mt,Z.lens[Z.have++]=Qt;else{if(Qt===16){for(dr=Mt+2;ke<dr;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}if(ge>>>=Mt,ke-=Mt,Z.have===0){ye.msg="invalid bit length repeat",Z.mode=De;break}Lt=Z.lens[Z.have-1],dt=3+(ge&3),ge>>>=2,ke-=2}else if(Qt===17){for(dr=Mt+3;ke<dr;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}ge>>>=Mt,ke-=Mt,Lt=0,dt=3+(ge&7),ge>>>=3,ke-=3}else{for(dr=Mt+7;ke<dr;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}ge>>>=Mt,ke-=Mt,Lt=0,dt=11+(ge&127),ge>>>=7,ke-=7}if(Z.have+dt>Z.nlen+Z.ndist){ye.msg="invalid bit length repeat",Z.mode=De;break}for(;dt--;)Z.lens[Z.have++]=Lt}}if(Z.mode===De)break;if(Z.lens[256]===0){ye.msg="invalid code -- missing end-of-block",Z.mode=De;break}if(Z.lenbits=9,wr={bits:Z.lenbits},Wt=p(k,Z.lens,0,Z.nlen,Z.lencode,0,Z.work,wr),Z.lenbits=wr.bits,Wt){ye.msg="invalid literal/lengths set",Z.mode=De;break}if(Z.distbits=6,Z.distcode=Z.distdyn,wr={bits:Z.distbits},Wt=p(g,Z.lens,Z.nlen,Z.ndist,Z.distcode,0,Z.work,wr),Z.distbits=wr.bits,Wt){ye.msg="invalid distances set",Z.mode=De;break}if(Z.mode=he,Ne===R)break e;case he:Z.mode=pe;case pe:if(Ee>=6&&re>=258){ye.next_out=Te,ye.avail_out=re,ye.next_in=G,ye.avail_in=Ee,Z.hold=ge,Z.bits=ke,b(ye,lt),Te=ye.next_out,rt=ye.output,re=ye.avail_out,G=ye.next_in,ze=ye.input,Ee=ye.avail_in,ge=Z.hold,ke=Z.bits,Z.mode===U&&(Z.back=-1);break}for(Z.back=0;At=Z.lencode[ge&(1<<Z.lenbits)-1],Mt=At>>>24,Pt=At>>>16&255,Qt=At&65535,!(Mt<=ke);){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}if(Pt&&!(Pt&240)){for(Kt=Mt,Kr=Pt,ai=Qt;At=Z.lencode[ai+((ge&(1<<Kt+Kr)-1)>>Kt)],Mt=At>>>24,Pt=At>>>16&255,Qt=At&65535,!(Kt+Mt<=ke);){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}ge>>>=Kt,ke-=Kt,Z.back+=Kt}if(ge>>>=Mt,ke-=Mt,Z.back+=Mt,Z.length=Qt,Pt===0){Z.mode=Ge;break}if(Pt&32){Z.back=-1,Z.mode=U;break}if(Pt&64){ye.msg="invalid literal/length code",Z.mode=De;break}Z.extra=Pt&15,Z.mode=ve;case ve:if(Z.extra){for(dr=Z.extra;ke<dr;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}Z.length+=ge&(1<<Z.extra)-1,ge>>>=Z.extra,ke-=Z.extra,Z.back+=Z.extra}Z.was=Z.length,Z.mode=ce;case ce:for(;At=Z.distcode[ge&(1<<Z.distbits)-1],Mt=At>>>24,Pt=At>>>16&255,Qt=At&65535,!(Mt<=ke);){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}if(!(Pt&240)){for(Kt=Mt,Kr=Pt,ai=Qt;At=Z.distcode[ai+((ge&(1<<Kt+Kr)-1)>>Kt)],Mt=At>>>24,Pt=At>>>16&255,Qt=At&65535,!(Kt+Mt<=ke);){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}ge>>>=Kt,ke-=Kt,Z.back+=Kt}if(ge>>>=Mt,ke-=Mt,Z.back+=Mt,Pt&64){ye.msg="invalid distance code",Z.mode=De;break}Z.offset=Qt,Z.extra=Pt&15,Z.mode=me;case me:if(Z.extra){for(dr=Z.extra;ke<dr;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}Z.offset+=ge&(1<<Z.extra)-1,ge>>>=Z.extra,ke-=Z.extra,Z.back+=Z.extra}if(Z.offset>Z.dmax){ye.msg="invalid distance too far back",Z.mode=De;break}Z.mode=Re;case Re:if(re===0)break e;if(dt=lt-re,Z.offset>dt){if(dt=Z.offset-dt,dt>Z.whave&&Z.sane){ye.msg="invalid distance too far back",Z.mode=De;break}dt>Z.wnext?(dt-=Z.wnext,yt=Z.wsize-dt):yt=Z.wnext-dt,dt>Z.length&&(dt=Z.length),ir=Z.window}else ir=rt,yt=Te-Z.offset,dt=Z.length;dt>re&&(dt=re),re-=dt,Z.length-=dt;do rt[Te++]=ir[yt++];while(--dt);Z.length===0&&(Z.mode=pe);break;case Ge:if(re===0)break e;rt[Te++]=Z.length,re--,Z.mode=pe;break;case We:if(Z.wrap){for(;ke<32;){if(Ee===0)break e;Ee--,ge|=ze[G++]<<ke,ke+=8}if(lt-=re,ye.total_out+=lt,Z.total+=lt,lt&&(ye.adler=Z.check=Z.flags?_(Z.check,rt,lt,Te-lt):v(Z.check,rt,lt,Te-lt)),lt=re,(Z.flags?ge:Xe(ge))!==Z.check){ye.msg="incorrect data check",Z.mode=De;break}ge=0,ke=0}Z.mode=Oe;case Oe:if(Z.wrap&&Z.flags){for(;ke<32;){if(Ee===0)break e;Ee--,ge+=ze[G++]<<ke,ke+=8}if(ge!==(Z.total&4294967295)){ye.msg="incorrect length check",Z.mode=De;break}ge=0,ke=0}Z.mode=fe;case fe:Wt=a;break e;case De:Wt=w;break e;case qe:return x;case Qe:default:return c}return ye.next_out=Te,ye.avail_out=re,ye.next_in=G,ye.avail_in=Ee,Z.hold=ge,Z.bits=ke,(Z.wsize||lt!==ye.avail_out&&Z.mode<De&&(Z.mode<We||Ne!==M))&&Be(ye,ye.output,ye.next_out,lt-ye.avail_out),ct-=ye.avail_in,lt-=ye.avail_out,ye.total_in+=ct,ye.total_out+=lt,Z.total+=lt,Z.wrap&&lt&&(ye.adler=Z.check=Z.flags?_(Z.check,rt,lt,ye.next_out-lt):v(Z.check,rt,lt,ye.next_out-lt)),ye.data_type=Z.bits+(Z.last?64:0)+(Z.mode===U?128:0)+(Z.mode===he||Z.mode===X?256:0),(ct===0&&lt===0||Ne===M)&&Wt===S&&(Wt=T),Wt}function _e(ye){if(!ye||!ye.state)return c;var Ne=ye.state;return Ne.window&&(Ne.window=null),ye.state=null,S}function Me(ye,Ne){var Z;return!ye||!ye.state||(Z=ye.state,!(Z.wrap&2))?c:(Z.head=Ne,Ne.done=!1,S)}function $e(ye,Ne){var Z=Ne.length,ze,rt,G;return!ye||!ye.state||(ze=ye.state,ze.wrap!==0&&ze.mode!==q)?c:ze.mode===q&&(rt=1,rt=v(rt,Ne,Z,0),rt!==ze.check)?w:(G=Be(ye,Ne,Z,Z),G?(ze.mode=qe,x):(ze.havedict=1,S))}t.inflateReset=ft,t.inflateReset2=ut,t.inflateResetKeep=Ue,t.inflateInit=ie,t.inflateInit2=ee,t.inflate=K,t.inflateEnd=_e,t.inflateGetHeader=Me,t.inflateSetDictionary=$e,t.inflateInfo="pako inflate (from Nodeca project)"}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),v=15,_=852,b=592,p=0,y=1,k=2,g=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],M=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],P=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],R=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(S,a,s,c,w,x,T,l){var h=l.bits,C=0,E=0,D=0,z=0,L=0,V=0,O=0,W=0,H=0,q=0,U,B,Y,X,j,J=null,le=0,se,he=new u.Buf16(v+1),pe=new u.Buf16(v+1),ve=null,ce=0,me,Re,Ge;for(C=0;C<=v;C++)he[C]=0;for(E=0;E<c;E++)he[a[s+E]]++;for(L=h,z=v;z>=1&&he[z]===0;z--);if(L>z&&(L=z),z===0)return w[x++]=20971520,w[x++]=20971520,l.bits=1,0;for(D=1;D<z&&he[D]===0;D++);for(L<D&&(L=D),W=1,C=1;C<=v;C++)if(W<<=1,W-=he[C],W<0)return-1;if(W>0&&(S===p||z!==1))return-1;for(pe[1]=0,C=1;C<v;C++)pe[C+1]=pe[C]+he[C];for(E=0;E<c;E++)a[s+E]!==0&&(T[pe[a[s+E]]++]=E);if(S===p?(J=ve=T,se=19):S===y?(J=g,le-=257,ve=M,ce-=257,se=256):(J=P,ve=R,se=-1),q=0,E=0,C=D,j=x,V=L,O=0,Y=-1,H=1<<L,X=H-1,S===y&&H>_||S===k&&H>b)return 1;for(;;){me=C-O,T[E]<se?(Re=0,Ge=T[E]):T[E]>se?(Re=ve[ce+T[E]],Ge=J[le+T[E]]):(Re=96,Ge=0),U=1<<C-O,B=1<<V,D=B;do B-=U,w[j+(q>>O)+B]=me<<24|Re<<16|Ge|0;while(B!==0);for(U=1<<C-1;q&U;)U>>=1;if(U!==0?(q&=U-1,q+=U):q=0,E++,--he[C]===0){if(C===z)break;C=a[s+T[E]]}if(C>L&&(q&X)!==Y){for(O===0&&(O=L),j+=D,V=C-O,W=1<<V;V+O<z&&(W-=he[V+O],!(W<=0));)V++,W<<=1;if(H+=1<<V,S===y&&H>_||S===k&&H>b)return 1;Y=q&X,w[Y]=L<<24|V<<16|j-x|0}}return q!==0&&(w[j+q]=C-O<<24|4194304|0),l.bits=L,0}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js":(n=>{n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js":((n,t,r)=>{var u=r("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),v=4,_=0,b=1,p=2;function y(K){for(var _e=K.length;--_e>=0;)K[_e]=0}var k=0,g=1,M=2,P=3,R=258,S=29,a=256,s=a+1+S,c=30,w=19,x=2*s+1,T=15,l=16,h=7,C=256,E=16,D=17,z=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=512,q=new Array((s+2)*2);y(q);var U=new Array(c*2);y(U);var B=new Array(H);y(B);var Y=new Array(R-P+1);y(Y);var X=new Array(S);y(X);var j=new Array(c);y(j);function J(K,_e,Me,$e,ye){this.static_tree=K,this.extra_bits=_e,this.extra_base=Me,this.elems=$e,this.max_length=ye,this.has_stree=K&&K.length}var le,se,he;function pe(K,_e){this.dyn_tree=K,this.max_code=0,this.stat_desc=_e}function ve(K){return K<256?B[K]:B[256+(K>>>7)]}function ce(K,_e){K.pending_buf[K.pending++]=_e&255,K.pending_buf[K.pending++]=_e>>>8&255}function me(K,_e,Me){K.bi_valid>l-Me?(K.bi_buf|=_e<<K.bi_valid&65535,ce(K,K.bi_buf),K.bi_buf=_e>>l-K.bi_valid,K.bi_valid+=Me-l):(K.bi_buf|=_e<<K.bi_valid&65535,K.bi_valid+=Me)}function Re(K,_e,Me){me(K,Me[_e*2],Me[_e*2+1])}function Ge(K,_e){var Me=0;do Me|=K&1,K>>>=1,Me<<=1;while(--_e>0);return Me>>>1}function We(K){K.bi_valid===16?(ce(K,K.bi_buf),K.bi_buf=0,K.bi_valid=0):K.bi_valid>=8&&(K.pending_buf[K.pending++]=K.bi_buf&255,K.bi_buf>>=8,K.bi_valid-=8)}function Oe(K,_e){var Me=_e.dyn_tree,$e=_e.max_code,ye=_e.stat_desc.static_tree,Ne=_e.stat_desc.has_stree,Z=_e.stat_desc.extra_bits,ze=_e.stat_desc.extra_base,rt=_e.stat_desc.max_length,G,Te,Ee,re,ge,ke,ct=0;for(re=0;re<=T;re++)K.bl_count[re]=0;for(Me[K.heap[K.heap_max]*2+1]=0,G=K.heap_max+1;G<x;G++)Te=K.heap[G],re=Me[Me[Te*2+1]*2+1]+1,re>rt&&(re=rt,ct++),Me[Te*2+1]=re,!(Te>$e)&&(K.bl_count[re]++,ge=0,Te>=ze&&(ge=Z[Te-ze]),ke=Me[Te*2],K.opt_len+=ke*(re+ge),Ne&&(K.static_len+=ke*(ye[Te*2+1]+ge)));if(ct!==0){do{for(re=rt-1;K.bl_count[re]===0;)re--;K.bl_count[re]--,K.bl_count[re+1]+=2,K.bl_count[rt]--,ct-=2}while(ct>0);for(re=rt;re!==0;re--)for(Te=K.bl_count[re];Te!==0;)Ee=K.heap[--G],!(Ee>$e)&&(Me[Ee*2+1]!==re&&(K.opt_len+=(re-Me[Ee*2+1])*Me[Ee*2],Me[Ee*2+1]=re),Te--)}}function fe(K,_e,Me){var $e=new Array(T+1),ye=0,Ne,Z;for(Ne=1;Ne<=T;Ne++)$e[Ne]=ye=ye+Me[Ne-1]<<1;for(Z=0;Z<=_e;Z++){var ze=K[Z*2+1];ze!==0&&(K[Z*2]=Ge($e[ze]++,ze))}}function De(){var K,_e,Me,$e,ye,Ne=new Array(T+1);for(Me=0,$e=0;$e<S-1;$e++)for(X[$e]=Me,K=0;K<1<<L[$e];K++)Y[Me++]=$e;for(Y[Me-1]=$e,ye=0,$e=0;$e<16;$e++)for(j[$e]=ye,K=0;K<1<<V[$e];K++)B[ye++]=$e;for(ye>>=7;$e<c;$e++)for(j[$e]=ye<<7,K=0;K<1<<V[$e]-7;K++)B[256+ye++]=$e;for(_e=0;_e<=T;_e++)Ne[_e]=0;for(K=0;K<=143;)q[K*2+1]=8,K++,Ne[8]++;for(;K<=255;)q[K*2+1]=9,K++,Ne[9]++;for(;K<=279;)q[K*2+1]=7,K++,Ne[7]++;for(;K<=287;)q[K*2+1]=8,K++,Ne[8]++;for(fe(q,s+1,Ne),K=0;K<c;K++)U[K*2+1]=5,U[K*2]=Ge(K,5);le=new J(q,L,a+1,s,T),se=new J(U,V,0,c,T),he=new J(new Array(0),O,0,w,h)}function qe(K){var _e;for(_e=0;_e<s;_e++)K.dyn_ltree[_e*2]=0;for(_e=0;_e<c;_e++)K.dyn_dtree[_e*2]=0;for(_e=0;_e<w;_e++)K.bl_tree[_e*2]=0;K.dyn_ltree[C*2]=1,K.opt_len=K.static_len=0,K.last_lit=K.matches=0}function Qe(K){K.bi_valid>8?ce(K,K.bi_buf):K.bi_valid>0&&(K.pending_buf[K.pending++]=K.bi_buf),K.bi_buf=0,K.bi_valid=0}function st(K,_e,Me,$e){Qe(K),ce(K,Me),ce(K,~Me),u.arraySet(K.pending_buf,K.window,_e,Me,K.pending),K.pending+=Me}function ot(K,_e,Me,$e){var ye=_e*2,Ne=Me*2;return K[ye]<K[Ne]||K[ye]===K[Ne]&&$e[_e]<=$e[Me]}function Ke(K,_e,Me){for(var $e=K.heap[Me],ye=Me<<1;ye<=K.heap_len&&(ye<K.heap_len&&ot(_e,K.heap[ye+1],K.heap[ye],K.depth)&&ye++,!ot(_e,$e,K.heap[ye],K.depth));)K.heap[Me]=K.heap[ye],Me=ye,ye<<=1;K.heap[Me]=$e}function Je(K,_e,Me){var $e,ye,Ne=0,Z,ze;if(K.last_lit!==0)do $e=K.pending_buf[K.d_buf+Ne*2]<<8|K.pending_buf[K.d_buf+Ne*2+1],ye=K.pending_buf[K.l_buf+Ne],Ne++,$e===0?Re(K,ye,_e):(Z=Y[ye],Re(K,Z+a+1,_e),ze=L[Z],ze!==0&&(ye-=X[Z],me(K,ye,ze)),$e--,Z=ve($e),Re(K,Z,Me),ze=V[Z],ze!==0&&($e-=j[Z],me(K,$e,ze)));while(Ne<K.last_lit);Re(K,C,_e)}function Xe(K,_e){var Me=_e.dyn_tree,$e=_e.stat_desc.static_tree,ye=_e.stat_desc.has_stree,Ne=_e.stat_desc.elems,Z,ze,rt=-1,G;for(K.heap_len=0,K.heap_max=x,Z=0;Z<Ne;Z++)Me[Z*2]!==0?(K.heap[++K.heap_len]=rt=Z,K.depth[Z]=0):Me[Z*2+1]=0;for(;K.heap_len<2;)G=K.heap[++K.heap_len]=rt<2?++rt:0,Me[G*2]=1,K.depth[G]=0,K.opt_len--,ye&&(K.static_len-=$e[G*2+1]);for(_e.max_code=rt,Z=K.heap_len>>1;Z>=1;Z--)Ke(K,Me,Z);G=Ne;do Z=K.heap[1],K.heap[1]=K.heap[K.heap_len--],Ke(K,Me,1),ze=K.heap[1],K.heap[--K.heap_max]=Z,K.heap[--K.heap_max]=ze,Me[G*2]=Me[Z*2]+Me[ze*2],K.depth[G]=(K.depth[Z]>=K.depth[ze]?K.depth[Z]:K.depth[ze])+1,Me[Z*2+1]=Me[ze*2+1]=G,K.heap[1]=G++,Ke(K,Me,1);while(K.heap_len>=2);K.heap[--K.heap_max]=K.heap[1],Oe(K,_e),fe(Me,rt,K.bl_count)}function je(K,_e,Me){var $e,ye=-1,Ne,Z=_e[1],ze=0,rt=7,G=4;for(Z===0&&(rt=138,G=3),_e[(Me+1)*2+1]=65535,$e=0;$e<=Me;$e++)Ne=Z,Z=_e[($e+1)*2+1],!(++ze<rt&&Ne===Z)&&(ze<G?K.bl_tree[Ne*2]+=ze:Ne!==0?(Ne!==ye&&K.bl_tree[Ne*2]++,K.bl_tree[E*2]++):ze<=10?K.bl_tree[D*2]++:K.bl_tree[z*2]++,ze=0,ye=Ne,Z===0?(rt=138,G=3):Ne===Z?(rt=6,G=3):(rt=7,G=4))}function Ue(K,_e,Me){var $e,ye=-1,Ne,Z=_e[1],ze=0,rt=7,G=4;for(Z===0&&(rt=138,G=3),$e=0;$e<=Me;$e++)if(Ne=Z,Z=_e[($e+1)*2+1],!(++ze<rt&&Ne===Z)){if(ze<G)do Re(K,Ne,K.bl_tree);while(--ze!==0);else Ne!==0?(Ne!==ye&&(Re(K,Ne,K.bl_tree),ze--),Re(K,E,K.bl_tree),me(K,ze-3,2)):ze<=10?(Re(K,D,K.bl_tree),me(K,ze-3,3)):(Re(K,z,K.bl_tree),me(K,ze-11,7));ze=0,ye=Ne,Z===0?(rt=138,G=3):Ne===Z?(rt=6,G=3):(rt=7,G=4)}}function ft(K){var _e;for(je(K,K.dyn_ltree,K.l_desc.max_code),je(K,K.dyn_dtree,K.d_desc.max_code),Xe(K,K.bl_desc),_e=w-1;_e>=3&&K.bl_tree[W[_e]*2+1]===0;_e--);return K.opt_len+=3*(_e+1)+5+5+4,_e}function ut(K,_e,Me,$e){var ye;for(me(K,_e-257,5),me(K,Me-1,5),me(K,$e-4,4),ye=0;ye<$e;ye++)me(K,K.bl_tree[W[ye]*2+1],3);Ue(K,K.dyn_ltree,_e-1),Ue(K,K.dyn_dtree,Me-1)}function ee(K){var _e=4093624447,Me;for(Me=0;Me<=31;Me++,_e>>>=1)if(_e&1&&K.dyn_ltree[Me*2]!==0)return _;if(K.dyn_ltree[18]!==0||K.dyn_ltree[20]!==0||K.dyn_ltree[26]!==0)return b;for(Me=32;Me<a;Me++)if(K.dyn_ltree[Me*2]!==0)return b;return _}var ie=!1;function oe(K){ie||(De(),ie=!0),K.l_desc=new pe(K.dyn_ltree,le),K.d_desc=new pe(K.dyn_dtree,se),K.bl_desc=new pe(K.bl_tree,he),K.bi_buf=0,K.bi_valid=0,qe(K)}function we(K,_e,Me,$e){me(K,(k<<1)+($e?1:0),3),st(K,_e,Me)}function Se(K){me(K,g<<1,3),Re(K,C,q),We(K)}function He(K,_e,Me,$e){var ye,Ne,Z=0;K.level>0?(K.strm.data_type===p&&(K.strm.data_type=ee(K)),Xe(K,K.l_desc),Xe(K,K.d_desc),Z=ft(K),ye=K.opt_len+3+7>>>3,Ne=K.static_len+3+7>>>3,Ne<=ye&&(ye=Ne)):ye=Ne=Me+5,Me+4<=ye&&_e!==-1?we(K,_e,Me,$e):K.strategy===v||Ne===ye?(me(K,(g<<1)+($e?1:0),3),Je(K,q,U)):(me(K,(M<<1)+($e?1:0),3),ut(K,K.l_desc.max_code+1,K.d_desc.max_code+1,Z+1),Je(K,K.dyn_ltree,K.dyn_dtree)),qe(K),$e&&Qe(K)}function Be(K,_e,Me){return K.pending_buf[K.d_buf+K.last_lit*2]=_e>>>8&255,K.pending_buf[K.d_buf+K.last_lit*2+1]=_e&255,K.pending_buf[K.l_buf+K.last_lit]=Me&255,K.last_lit++,_e===0?K.dyn_ltree[Me*2]++:(K.matches++,_e--,K.dyn_ltree[(Y[Me]+a+1)*2]++,K.dyn_dtree[ve(_e)*2]++),K.last_lit===K.lit_bufsize-1}t._tr_init=oe,t._tr_stored_block=we,t._tr_flush_block=He,t._tr_tally=Be,t._tr_align=Se}),"./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js":(n=>{function t(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}n.exports=t}),"./src/SurfaceWorker.js":(()=>{$3Dmol.workerString=(function(){self.onmessage=function(n){var t=n.data,r=t.type;if(r<0)self.atomData=t.atoms,self.volume=t.volume,self.ps=new ProteinSurface;else{var u=self.ps;u.initparm(t.expandedExtent,r!=1,self.volume),u.fillvoxels(self.atomData,t.extendedAtoms),u.buildboundary(),(r===4||r===2)&&(u.fastdistancemap(),u.boundingatom(!1),u.fillvoxelswaals(self.atomData,t.extendedAtoms)),u.marchingcube(r);var v=u.getFacesAndVertices(t.atomsToShow);self.postMessage(v)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0}),"./src/exporter.js":(n=>{typeof n.exports=="object"&&(n.exports=window.$3Dmol)}),"./src/vendor/mmtf.js":(function(n,t){(function(r,u){u(t)})(this,function(r){function u(ee,ie,oe){for(var we=(ee.byteLength,0),Se=oe.length;Se>we;we++){var He=oe.charCodeAt(we);if(128>He)ee.setUint8(ie++,He>>>0&127|0);else if(2048>He)ee.setUint8(ie++,He>>>6&31|192),ee.setUint8(ie++,He>>>0&63|128);else if(65536>He)ee.setUint8(ie++,He>>>12&15|224),ee.setUint8(ie++,He>>>6&63|128),ee.setUint8(ie++,He>>>0&63|128);else{if(!(1114112>He))throw new Error("bad codepoint "+He);ee.setUint8(ie++,He>>>18&7|240),ee.setUint8(ie++,He>>>12&63|128),ee.setUint8(ie++,He>>>6&63|128),ee.setUint8(ie++,He>>>0&63|128)}}}function v(ee){for(var ie=0,oe=0,we=ee.length;we>oe;oe++){var Se=ee.charCodeAt(oe);if(128>Se)ie+=1;else if(2048>Se)ie+=2;else if(65536>Se)ie+=3;else{if(!(1114112>Se))throw new Error("bad codepoint "+Se);ie+=4}}return ie}function _(ee,ie,oe){var we=typeof ee;if(we==="string"){var Se=v(ee);if(32>Se)return ie.setUint8(oe,160|Se),u(ie,oe+1,ee),1+Se;if(256>Se)return ie.setUint8(oe,217),ie.setUint8(oe+1,Se),u(ie,oe+2,ee),2+Se;if(65536>Se)return ie.setUint8(oe,218),ie.setUint16(oe+1,Se),u(ie,oe+3,ee),3+Se;if(4294967296>Se)return ie.setUint8(oe,219),ie.setUint32(oe+1,Se),u(ie,oe+5,ee),5+Se}if(ee instanceof Uint8Array){var Se=ee.byteLength,He=new Uint8Array(ie.buffer);if(256>Se)return ie.setUint8(oe,196),ie.setUint8(oe+1,Se),He.set(ee,oe+2),2+Se;if(65536>Se)return ie.setUint8(oe,197),ie.setUint16(oe+1,Se),He.set(ee,oe+3),3+Se;if(4294967296>Se)return ie.setUint8(oe,198),ie.setUint32(oe+1,Se),He.set(ee,oe+5),5+Se}if(we==="number"){if(!isFinite(ee))throw new Error("Number not finite: "+ee);if(Math.floor(ee)!==ee)return ie.setUint8(oe,203),ie.setFloat64(oe+1,ee),9;if(ee>=0){if(128>ee)return ie.setUint8(oe,ee),1;if(256>ee)return ie.setUint8(oe,204),ie.setUint8(oe+1,ee),2;if(65536>ee)return ie.setUint8(oe,205),ie.setUint16(oe+1,ee),3;if(4294967296>ee)return ie.setUint8(oe,206),ie.setUint32(oe+1,ee),5;throw new Error("Number too big 0x"+ee.toString(16))}if(ee>=-32)return ie.setInt8(oe,ee),1;if(ee>=-128)return ie.setUint8(oe,208),ie.setInt8(oe+1,ee),2;if(ee>=-32768)return ie.setUint8(oe,209),ie.setInt16(oe+1,ee),3;if(ee>=-2147483648)return ie.setUint8(oe,210),ie.setInt32(oe+1,ee),5;throw new Error("Number too small -0x"+(-ee).toString(16).substr(1))}if(ee===null)return ie.setUint8(oe,192),1;if(we==="boolean")return ie.setUint8(oe,ee?195:194),1;if(we==="object"){var Se,_e=0,Be=Array.isArray(ee);if(Be)Se=ee.length;else{var K=Object.keys(ee);Se=K.length}var _e;if(16>Se?(ie.setUint8(oe,Se|(Be?144:128)),_e=1):65536>Se?(ie.setUint8(oe,Be?220:222),ie.setUint16(oe+1,Se),_e=3):4294967296>Se&&(ie.setUint8(oe,Be?221:223),ie.setUint32(oe+1,Se),_e=5),Be)for(var Me=0;Se>Me;Me++)_e+=_(ee[Me],ie,oe+_e);else for(var Me=0;Se>Me;Me++){var $e=K[Me];_e+=_($e,ie,oe+_e),_e+=_(ee[$e],ie,oe+_e)}return _e}throw new Error("Unknown type "+we)}function b(ee){var ie=typeof ee;if(ie==="string"){var oe=v(ee);if(32>oe)return 1+oe;if(256>oe)return 2+oe;if(65536>oe)return 3+oe;if(4294967296>oe)return 5+oe}if(ee instanceof Uint8Array){var oe=ee.byteLength;if(256>oe)return 2+oe;if(65536>oe)return 3+oe;if(4294967296>oe)return 5+oe}if(ie==="number"){if(Math.floor(ee)!==ee)return 9;if(ee>=0){if(128>ee)return 1;if(256>ee)return 2;if(65536>ee)return 3;if(4294967296>ee)return 5;throw new Error("Number too big 0x"+ee.toString(16))}if(ee>=-32)return 1;if(ee>=-128)return 2;if(ee>=-32768)return 3;if(ee>=-2147483648)return 5;throw new Error("Number too small -0x"+ee.toString(16).substr(1))}if(ie==="boolean"||ee===null)return 1;if(ie==="object"){var oe,we=0;if(Array.isArray(ee)){oe=ee.length;for(var Se=0;oe>Se;Se++)we+=b(ee[Se])}else{var He=Object.keys(ee);oe=He.length;for(var Se=0;oe>Se;Se++){var Be=He[Se];we+=b(Be)+b(ee[Be])}}if(16>oe)return 1+we;if(65536>oe)return 3+we;if(4294967296>oe)return 5+we;throw new Error("Array or object too long 0x"+oe.toString(16))}throw new Error("Unknown type "+ie)}function p(ee){var ie=new ArrayBuffer(b(ee)),oe=new DataView(ie);return _(ee,oe,0),new Uint8Array(ie)}function y(ee,ie,oe){return ie?new ee(ie.buffer,ie.byteOffset,ie.byteLength/(oe||1)):void 0}function k(ee){return y(DataView,ee)}function g(ee){return y(Uint8Array,ee)}function M(ee){return y(Int8Array,ee)}function P(ee){return y(Int32Array,ee,4)}function R(ee){return y(Float32Array,ee,4)}function S(ee,ie){var oe=ee.length/2;ie||(ie=new Int16Array(oe));for(var we=0,Se=0;oe>we;++we,Se+=2)ie[we]=ee[Se]<<8^ee[Se+1]<<0;return ie}function a(ee,ie){var oe=ee.length;ie||(ie=new Uint8Array(2*oe));for(var we=k(ie),Se=0;oe>Se;++Se)we.setInt16(2*Se,ee[Se]);return g(ie)}function s(ee,ie){var oe=ee.length/4;ie||(ie=new Int32Array(oe));for(var we=0,Se=0;oe>we;++we,Se+=4)ie[we]=ee[Se]<<24^ee[Se+1]<<16^ee[Se+2]<<8^ee[Se+3]<<0;return ie}function c(ee,ie){var oe=ee.length;ie||(ie=new Uint8Array(4*oe));for(var we=k(ie),Se=0;oe>Se;++Se)we.setInt32(4*Se,ee[Se]);return g(ie)}function w(ee,ie){var oe=ee.length;ie||(ie=new Float32Array(oe/4));for(var we=k(ie),Se=k(ee),He=0,Be=0,K=oe/4;K>He;++He,Be+=4)we.setFloat32(Be,Se.getFloat32(Be),!0);return ie}function x(ee,ie,oe){var we=ee.length,Se=1/ie;oe||(oe=new Float32Array(we));for(var He=0;we>He;++He)oe[He]=ee[He]*Se;return oe}function T(ee,ie,oe){var we=ee.length;oe||(oe=new Int32Array(we));for(var Se=0;we>Se;++Se)oe[Se]=Math.round(ee[Se]*ie);return oe}function l(ee,ie){var oe,we;if(!ie){var Se=0;for(oe=0,we=ee.length;we>oe;oe+=2)Se+=ee[oe+1];ie=new ee.constructor(Se)}var He=0;for(oe=0,we=ee.length;we>oe;oe+=2)for(var Be=ee[oe],K=ee[oe+1],_e=0;K>_e;++_e)ie[He]=Be,++He;return ie}function h(ee){if(ee.length===0)return new Int32Array;var ie,oe,we=2;for(ie=1,oe=ee.length;oe>ie;++ie)ee[ie-1]!==ee[ie]&&(we+=2);var Se=new Int32Array(we),He=0,Be=1;for(ie=1,oe=ee.length;oe>ie;++ie)ee[ie-1]!==ee[ie]?(Se[He]=ee[ie-1],Se[He+1]=Be,Be=1,He+=2):++Be;return Se[He]=ee[ee.length-1],Se[He+1]=Be,Se}function C(ee,ie){var oe=ee.length;ie||(ie=new ee.constructor(oe)),oe&&(ie[0]=ee[0]);for(var we=1;oe>we;++we)ie[we]=ee[we]+ie[we-1];return ie}function E(ee,ie){var oe=ee.length;ie||(ie=new ee.constructor(oe)),ie[0]=ee[0];for(var we=1;oe>we;++we)ie[we]=ee[we]-ee[we-1];return ie}function D(ee,ie){var oe,we,Se=ee instanceof Int8Array?127:32767,He=-Se-1,Be=ee.length;if(!ie){var K=0;for(oe=0;Be>oe;++oe)ee[oe]<Se&&ee[oe]>He&&++K;ie=new Int32Array(K)}for(oe=0,we=0;Be>oe;){for(var _e=0;ee[oe]===Se||ee[oe]===He;)_e+=ee[oe],++oe;_e+=ee[oe],++oe,ie[we]=_e,++we}return ie}function z(ee,ie){var oe,we=32767,Se=-we-1,He=ee.length,Be=0;for(oe=0;He>oe;++oe){var K=ee[oe];K===0?++Be:K>0?(Be+=Math.ceil(K/we),K%we===0&&(Be+=1)):(Be+=Math.ceil(K/Se),K%Se===0&&(Be+=1))}var _e=new Int16Array(Be),Me=0;for(oe=0;He>oe;++oe){var K=ee[oe];if(K>=0)for(;K>=we;)_e[Me]=we,++Me,K-=we;else for(;Se>=K;)_e[Me]=Se,++Me,K-=Se;_e[Me]=K,++Me}return _e}function L(ee,ie){return C(l(ee),ie)}function V(ee){return h(E(ee))}function O(ee,ie,oe){return x(l(ee,P(oe)),ie,oe)}function W(ee,ie){return h(T(ee,ie))}function H(ee,ie,oe){return x(C(ee,P(oe)),ie,oe)}function q(ee,ie,oe){return E(T(ee,ie),oe)}function U(ee,ie,oe){return x(D(ee,P(oe)),ie,oe)}function B(ee,ie,oe){var we=D(ee,P(oe));return H(we,ie,R(we))}function Y(ee,ie,oe){return z(q(ee,ie))}function X(He){var ie=k(He),oe=ie.getInt32(0),we=ie.getInt32(4),Se=He.subarray(8,12),He=He.subarray(12);return[oe,He,we,Se]}function j(ee,ie,oe,we){var Se=new ArrayBuffer(12+we.byteLength),He=new Uint8Array(Se),Be=new DataView(Se);return Be.setInt32(0,ee),Be.setInt32(4,ie),oe&&He.set(oe,8),He.set(we,12),He}function J(ee){var ie=ee.length,oe=g(ee);return j(2,ie,void 0,oe)}function le(ee){var ie=ee.length,oe=c(ee);return j(4,ie,void 0,oe)}function se(ee,ie){var oe=ee.length/ie,we=c([ie]),Se=g(ee);return j(5,oe,we,Se)}function he(ee){var ie=ee.length,oe=c(h(ee));return j(6,ie,void 0,oe)}function pe(ee){var ie=ee.length,oe=c(V(ee));return j(8,ie,void 0,oe)}function ve(ee,ie){var oe=ee.length,we=c([ie]),Se=c(W(ee,ie));return j(9,oe,we,Se)}function ce(ee,ie){var oe=ee.length,we=c([ie]),Se=a(Y(ee,ie));return j(10,oe,we,Se)}function me(ee){var ie={};return Ke.forEach(function(oe){ee[oe]!==void 0&&(ie[oe]=ee[oe])}),ee.bondAtomList&&(ie.bondAtomList=le(ee.bondAtomList)),ee.bondOrderList&&(ie.bondOrderList=J(ee.bondOrderList)),ie.xCoordList=ce(ee.xCoordList,1e3),ie.yCoordList=ce(ee.yCoordList,1e3),ie.zCoordList=ce(ee.zCoordList,1e3),ee.bFactorList&&(ie.bFactorList=ce(ee.bFactorList,100)),ee.atomIdList&&(ie.atomIdList=pe(ee.atomIdList)),ee.altLocList&&(ie.altLocList=he(ee.altLocList)),ee.occupancyList&&(ie.occupancyList=ve(ee.occupancyList,100)),ie.groupIdList=pe(ee.groupIdList),ie.groupTypeList=le(ee.groupTypeList),ee.secStructList&&(ie.secStructList=J(ee.secStructList)),ee.insCodeList&&(ie.insCodeList=he(ee.insCodeList)),ee.sequenceIndexList&&(ie.sequenceIndexList=pe(ee.sequenceIndexList)),ie.chainIdList=se(ee.chainIdList,4),ee.chainNameList&&(ie.chainNameList=se(ee.chainNameList,4)),ie}function Re(ee){function ie(_e){for(var Me={},$e=0;_e>$e;$e++){var ye=He();Me[ye]=He()}return Me}function oe(_e){var Me=ee.subarray(Be,Be+_e);return Be+=_e,Me}function we(_e){var Me=ee.subarray(Be,Be+_e);Be+=_e;var $e=65535;if(_e>$e){for(var ye=[],Ne=0;Ne<Me.length;Ne+=$e)ye.push(String.fromCharCode.apply(null,Me.subarray(Ne,Ne+$e)));return ye.join("")}return String.fromCharCode.apply(null,Me)}function Se(_e){for(var Me=new Array(_e),$e=0;_e>$e;$e++)Me[$e]=He();return Me}function He(){var _e,Me,$e=ee[Be];if(!(128&$e))return Be++,$e;if((240&$e)===128)return Me=15&$e,Be++,ie(Me);if((240&$e)===144)return Me=15&$e,Be++,Se(Me);if((224&$e)===160)return Me=31&$e,Be++,we(Me);if((224&$e)===224)return _e=K.getInt8(Be),Be++,_e;switch($e){case 192:return Be++,null;case 194:return Be++,!1;case 195:return Be++,!0;case 196:return Me=K.getUint8(Be+1),Be+=2,oe(Me);case 197:return Me=K.getUint16(Be+1),Be+=3,oe(Me);case 198:return Me=K.getUint32(Be+1),Be+=5,oe(Me);case 202:return _e=K.getFloat32(Be+1),Be+=5,_e;case 203:return _e=K.getFloat64(Be+1),Be+=9,_e;case 204:return _e=ee[Be+1],Be+=2,_e;case 205:return _e=K.getUint16(Be+1),Be+=3,_e;case 206:return _e=K.getUint32(Be+1),Be+=5,_e;case 208:return _e=K.getInt8(Be+1),Be+=2,_e;case 209:return _e=K.getInt16(Be+1),Be+=3,_e;case 210:return _e=K.getInt32(Be+1),Be+=5,_e;case 217:return Me=K.getUint8(Be+1),Be+=2,we(Me);case 218:return Me=K.getUint16(Be+1),Be+=3,we(Me);case 219:return Me=K.getUint32(Be+1),Be+=5,we(Me);case 220:return Me=K.getUint16(Be+1),Be+=3,Se(Me);case 221:return Me=K.getUint32(Be+1),Be+=5,Se(Me);case 222:return Me=K.getUint16(Be+1),Be+=3,ie(Me);case 223:return Me=K.getUint32(Be+1),Be+=5,ie(Me)}throw new Error("Unknown type 0x"+$e.toString(16))}var Be=0,K=new DataView(ee.buffer);return He()}function Ge(ee,ie,oe,we){switch(ee){case 1:return w(ie);case 2:return M(ie);case 3:return S(ie);case 4:return s(ie);case 5:return g(ie);case 6:return l(s(ie),new Uint8Array(oe));case 7:return l(s(ie));case 8:return L(s(ie));case 9:return O(s(ie),s(we)[0]);case 10:return B(S(ie),s(we)[0]);case 11:return x(S(ie),s(we)[0]);case 12:return U(S(ie),s(we)[0]);case 13:return U(M(ie),s(we)[0]);case 14:return D(S(ie));case 15:return D(M(ie))}}function We(ee,ie){ie=ie||{};var oe=ie.ignoreFields,we={};return Xe.forEach(function(Se){var He=oe?oe.indexOf(Se)!==-1:!1,Be=ee[Se];He||Be===void 0||(Be instanceof Uint8Array?we[Se]=Ge.apply(null,X(Be)):we[Se]=Be)}),we}function Oe(ee){return String.fromCharCode.apply(null,ee).replace(/\0/g,"")}function fe(ee,ie,oe){oe=oe||{};var we,Se,He,Be,K,_e,Me=oe.firstModelOnly,$e=ie.onModel,ye=ie.onChain,Ne=ie.onGroup,Z=ie.onAtom,ze=ie.onBond,rt=0,G=0,Te=0,Ee=0,re=0,ge=-1,ke=ee.chainNameList,ct=ee.secStructList,lt=ee.insCodeList,dt=ee.sequenceIndexList,yt=ee.atomIdList,ir=ee.bFactorList,At=ee.altLocList,Mt=ee.occupancyList,Pt=ee.bondAtomList,Qt=ee.bondOrderList;for(we=0,Se=ee.chainsPerModel.length;Se>we&&!(Me&&rt>0);++we){var Kt=ee.chainsPerModel[rt];for($e&&$e({chainCount:Kt,modelIndex:rt}),He=0;Kt>He;++He){var Kr=ee.groupsPerChain[G];if(ye){var ai=Oe(ee.chainIdList.subarray(4*G,4*G+4)),Lt=null;ke&&(Lt=Oe(ke.subarray(4*G,4*G+4))),ye({groupCount:Kr,chainIndex:G,modelIndex:rt,chainId:ai,chainName:Lt})}for(Be=0;Kr>Be;++Be){var Wt=ee.groupList[ee.groupTypeList[Te]],qt=Wt.atomNameList.length;if(Ne){var wr=null;ct&&(wr=ct[Te]);var dr=null;ee.insCodeList&&(dr=String.fromCharCode(lt[Te]));var jr=null;dt&&(jr=dt[Te]),Ne({atomCount:qt,groupIndex:Te,chainIndex:G,modelIndex:rt,groupId:ee.groupIdList[Te],groupType:ee.groupTypeList[Te],groupName:Wt.groupName,singleLetterCode:Wt.singleLetterCode,chemCompType:Wt.chemCompType,secStruct:wr,insCode:dr,sequenceIndex:jr})}for(K=0;qt>K;++K){if(Z){var gn=null;yt&&(gn=yt[Ee]);var vn=null;ir&&(vn=ir[Ee]);var Wn=null;At&&(Wn=String.fromCharCode(At[Ee]));var Gi=null;Mt&&(Gi=Mt[Ee]),Z({atomIndex:Ee,groupIndex:Te,chainIndex:G,modelIndex:rt,atomId:gn,element:Wt.elementList[K],atomName:Wt.atomNameList[K],formalCharge:Wt.formalChargeList[K],xCoord:ee.xCoordList[Ee],yCoord:ee.yCoordList[Ee],zCoord:ee.zCoordList[Ee],bFactor:vn,altLoc:Wn,occupancy:Gi})}Ee+=1}if(ze){var Jt=Wt.bondAtomList;for(K=0,_e=Wt.bondOrderList.length;_e>K;++K)ze({atomIndex1:Ee-qt+Jt[2*K],atomIndex2:Ee-qt+Jt[2*K+1],bondOrder:Wt.bondOrderList[K]})}Te+=1}G+=1}if(re=ge+1,ge=Ee-1,ze&&Pt)for(K=0,_e=Pt.length;_e>K;K+=2){var yn=Pt[K],Ei=Pt[K+1];(yn>=re&&ge>=yn||Ei>=re&&ge>=Ei)&&ze({atomIndex1:yn,atomIndex2:Ei,bondOrder:Qt?Qt[K/2]:null})}rt+=1}}function De(ee){return p(me(ee))}function qe(ee,ie){ee instanceof ArrayBuffer&&(ee=new Uint8Array(ee));var oe;return oe=ee instanceof Uint8Array?Re(ee):ee,We(oe,ie)}function Qe(ee,ie,oe,we){function Se(){try{var Be=qe(He.response);oe(Be)}catch(K){we(K)}}var He=new XMLHttpRequest;He.addEventListener("load",Se,!0),He.addEventListener("error",we,!0),He.responseType="arraybuffer",He.open("GET",ie+ee.toUpperCase()),He.send()}function st(ee,ie,oe){Qe(ee,ft,ie,oe)}function ot(ee,ie,oe){Qe(ee,ut,ie,oe)}var Ke=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],Je=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],Xe=Ke.concat(Je),je="v1.0.1",Ue="//mmtf.rcsb.org/v1.0/",ft=Ue+"full/",ut=Ue+"reduced/";r.encode=De,r.decode=qe,r.traverse=fe,r.fetch=st,r.fetchReduced=ot,r.version=je,r.fetchUrl=ft,r.fetchReducedUrl=ut,r.encodeMsgpack=p,r.encodeMmtf=me,r.decodeMsgpack=Re,r.decodeMmtf=We})}),"./node_modules/pako/dist/pako.esm.mjs":((n,t,r)=>{r.r(t),r.d(t,{Deflate:()=>_i,Inflate:()=>mo,constants:()=>qr,default:()=>_s,deflate:()=>Oi,deflateRaw:()=>_r,gzip:()=>zn,inflate:()=>go,inflateRaw:()=>In,ungzip:()=>vo});/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const u=4,v=0,_=1,b=2;function p(A){let Q=A.length;for(;--Q>=0;)A[Q]=0}const y=0,k=1,g=2,M=3,P=258,R=29,S=256,a=S+1+R,s=30,c=19,w=2*a+1,x=15,T=16,l=7,h=256,C=16,E=17,D=18,z=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),L=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),V=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),W=512,H=new Array((a+2)*2);p(H);const q=new Array(s*2);p(q);const U=new Array(W);p(U);const B=new Array(P-M+1);p(B);const Y=new Array(R);p(Y);const X=new Array(s);p(X);function j(A,Q,I,ne,ae){this.static_tree=A,this.extra_bits=Q,this.extra_base=I,this.elems=ne,this.max_length=ae,this.has_stree=A&&A.length}let J,le,se;function he(A,Q){this.dyn_tree=A,this.max_code=0,this.stat_desc=Q}const pe=A=>A<256?U[A]:U[256+(A>>>7)],ve=(A,Q)=>{A.pending_buf[A.pending++]=Q&255,A.pending_buf[A.pending++]=Q>>>8&255},ce=(A,Q,I)=>{A.bi_valid>T-I?(A.bi_buf|=Q<<A.bi_valid&65535,ve(A,A.bi_buf),A.bi_buf=Q>>T-A.bi_valid,A.bi_valid+=I-T):(A.bi_buf|=Q<<A.bi_valid&65535,A.bi_valid+=I)},me=(A,Q,I)=>{ce(A,I[Q*2],I[Q*2+1])},Re=(A,Q)=>{let I=0;do I|=A&1,A>>>=1,I<<=1;while(--Q>0);return I>>>1},Ge=A=>{A.bi_valid===16?(ve(A,A.bi_buf),A.bi_buf=0,A.bi_valid=0):A.bi_valid>=8&&(A.pending_buf[A.pending++]=A.bi_buf&255,A.bi_buf>>=8,A.bi_valid-=8)},We=(A,Q)=>{const I=Q.dyn_tree,ne=Q.max_code,ae=Q.stat_desc.static_tree,ue=Q.stat_desc.has_stree,Ie=Q.stat_desc.extra_bits,Ae=Q.stat_desc.extra_base,ht=Q.stat_desc.max_length;let xe,Pe,Dt,nt,Ye,$t,Xt=0;for(nt=0;nt<=x;nt++)A.bl_count[nt]=0;for(I[A.heap[A.heap_max]*2+1]=0,xe=A.heap_max+1;xe<w;xe++)Pe=A.heap[xe],nt=I[I[Pe*2+1]*2+1]+1,nt>ht&&(nt=ht,Xt++),I[Pe*2+1]=nt,!(Pe>ne)&&(A.bl_count[nt]++,Ye=0,Pe>=Ae&&(Ye=Ie[Pe-Ae]),$t=I[Pe*2],A.opt_len+=$t*(nt+Ye),ue&&(A.static_len+=$t*(ae[Pe*2+1]+Ye)));if(Xt!==0){do{for(nt=ht-1;A.bl_count[nt]===0;)nt--;A.bl_count[nt]--,A.bl_count[nt+1]+=2,A.bl_count[ht]--,Xt-=2}while(Xt>0);for(nt=ht;nt!==0;nt--)for(Pe=A.bl_count[nt];Pe!==0;)Dt=A.heap[--xe],!(Dt>ne)&&(I[Dt*2+1]!==nt&&(A.opt_len+=(nt-I[Dt*2+1])*I[Dt*2],I[Dt*2+1]=nt),Pe--)}},Oe=(A,Q,I)=>{const ne=new Array(x+1);let ae=0,ue,Ie;for(ue=1;ue<=x;ue++)ae=ae+I[ue-1]<<1,ne[ue]=ae;for(Ie=0;Ie<=Q;Ie++){let Ae=A[Ie*2+1];Ae!==0&&(A[Ie*2]=Re(ne[Ae]++,Ae))}},fe=()=>{let A,Q,I,ne,ae;const ue=new Array(x+1);for(I=0,ne=0;ne<R-1;ne++)for(Y[ne]=I,A=0;A<1<<z[ne];A++)B[I++]=ne;for(B[I-1]=ne,ae=0,ne=0;ne<16;ne++)for(X[ne]=ae,A=0;A<1<<L[ne];A++)U[ae++]=ne;for(ae>>=7;ne<s;ne++)for(X[ne]=ae<<7,A=0;A<1<<L[ne]-7;A++)U[256+ae++]=ne;for(Q=0;Q<=x;Q++)ue[Q]=0;for(A=0;A<=143;)H[A*2+1]=8,A++,ue[8]++;for(;A<=255;)H[A*2+1]=9,A++,ue[9]++;for(;A<=279;)H[A*2+1]=7,A++,ue[7]++;for(;A<=287;)H[A*2+1]=8,A++,ue[8]++;for(Oe(H,a+1,ue),A=0;A<s;A++)q[A*2+1]=5,q[A*2]=Re(A,5);J=new j(H,z,S+1,a,x),le=new j(q,L,0,s,x),se=new j(new Array(0),V,0,c,l)},De=A=>{let Q;for(Q=0;Q<a;Q++)A.dyn_ltree[Q*2]=0;for(Q=0;Q<s;Q++)A.dyn_dtree[Q*2]=0;for(Q=0;Q<c;Q++)A.bl_tree[Q*2]=0;A.dyn_ltree[h*2]=1,A.opt_len=A.static_len=0,A.sym_next=A.matches=0},qe=A=>{A.bi_valid>8?ve(A,A.bi_buf):A.bi_valid>0&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0},Qe=(A,Q,I,ne)=>{const ae=Q*2,ue=I*2;return A[ae]<A[ue]||A[ae]===A[ue]&&ne[Q]<=ne[I]},st=(A,Q,I)=>{const ne=A.heap[I];let ae=I<<1;for(;ae<=A.heap_len&&(ae<A.heap_len&&Qe(Q,A.heap[ae+1],A.heap[ae],A.depth)&&ae++,!Qe(Q,ne,A.heap[ae],A.depth));)A.heap[I]=A.heap[ae],I=ae,ae<<=1;A.heap[I]=ne},ot=(A,Q,I)=>{let ne,ae,ue=0,Ie,Ae;if(A.sym_next!==0)do ne=A.pending_buf[A.sym_buf+ue++]&255,ne+=(A.pending_buf[A.sym_buf+ue++]&255)<<8,ae=A.pending_buf[A.sym_buf+ue++],ne===0?me(A,ae,Q):(Ie=B[ae],me(A,Ie+S+1,Q),Ae=z[Ie],Ae!==0&&(ae-=Y[Ie],ce(A,ae,Ae)),ne--,Ie=pe(ne),me(A,Ie,I),Ae=L[Ie],Ae!==0&&(ne-=X[Ie],ce(A,ne,Ae)));while(ue<A.sym_next);me(A,h,Q)},Ke=(A,Q)=>{const I=Q.dyn_tree,ne=Q.stat_desc.static_tree,ae=Q.stat_desc.has_stree,ue=Q.stat_desc.elems;let Ie,Ae,ht=-1,xe;for(A.heap_len=0,A.heap_max=w,Ie=0;Ie<ue;Ie++)I[Ie*2]!==0?(A.heap[++A.heap_len]=ht=Ie,A.depth[Ie]=0):I[Ie*2+1]=0;for(;A.heap_len<2;)xe=A.heap[++A.heap_len]=ht<2?++ht:0,I[xe*2]=1,A.depth[xe]=0,A.opt_len--,ae&&(A.static_len-=ne[xe*2+1]);for(Q.max_code=ht,Ie=A.heap_len>>1;Ie>=1;Ie--)st(A,I,Ie);xe=ue;do Ie=A.heap[1],A.heap[1]=A.heap[A.heap_len--],st(A,I,1),Ae=A.heap[1],A.heap[--A.heap_max]=Ie,A.heap[--A.heap_max]=Ae,I[xe*2]=I[Ie*2]+I[Ae*2],A.depth[xe]=(A.depth[Ie]>=A.depth[Ae]?A.depth[Ie]:A.depth[Ae])+1,I[Ie*2+1]=I[Ae*2+1]=xe,A.heap[1]=xe++,st(A,I,1);while(A.heap_len>=2);A.heap[--A.heap_max]=A.heap[1],We(A,Q),Oe(I,ht,A.bl_count)},Je=(A,Q,I)=>{let ne,ae=-1,ue,Ie=Q[1],Ae=0,ht=7,xe=4;for(Ie===0&&(ht=138,xe=3),Q[(I+1)*2+1]=65535,ne=0;ne<=I;ne++)ue=Ie,Ie=Q[(ne+1)*2+1],!(++Ae<ht&&ue===Ie)&&(Ae<xe?A.bl_tree[ue*2]+=Ae:ue!==0?(ue!==ae&&A.bl_tree[ue*2]++,A.bl_tree[C*2]++):Ae<=10?A.bl_tree[E*2]++:A.bl_tree[D*2]++,Ae=0,ae=ue,Ie===0?(ht=138,xe=3):ue===Ie?(ht=6,xe=3):(ht=7,xe=4))},Xe=(A,Q,I)=>{let ne,ae=-1,ue,Ie=Q[1],Ae=0,ht=7,xe=4;for(Ie===0&&(ht=138,xe=3),ne=0;ne<=I;ne++)if(ue=Ie,Ie=Q[(ne+1)*2+1],!(++Ae<ht&&ue===Ie)){if(Ae<xe)do me(A,ue,A.bl_tree);while(--Ae!==0);else ue!==0?(ue!==ae&&(me(A,ue,A.bl_tree),Ae--),me(A,C,A.bl_tree),ce(A,Ae-3,2)):Ae<=10?(me(A,E,A.bl_tree),ce(A,Ae-3,3)):(me(A,D,A.bl_tree),ce(A,Ae-11,7));Ae=0,ae=ue,Ie===0?(ht=138,xe=3):ue===Ie?(ht=6,xe=3):(ht=7,xe=4)}},je=A=>{let Q;for(Je(A,A.dyn_ltree,A.l_desc.max_code),Je(A,A.dyn_dtree,A.d_desc.max_code),Ke(A,A.bl_desc),Q=c-1;Q>=3&&A.bl_tree[O[Q]*2+1]===0;Q--);return A.opt_len+=3*(Q+1)+5+5+4,Q},Ue=(A,Q,I,ne)=>{let ae;for(ce(A,Q-257,5),ce(A,I-1,5),ce(A,ne-4,4),ae=0;ae<ne;ae++)ce(A,A.bl_tree[O[ae]*2+1],3);Xe(A,A.dyn_ltree,Q-1),Xe(A,A.dyn_dtree,I-1)},ft=A=>{let Q=4093624447,I;for(I=0;I<=31;I++,Q>>>=1)if(Q&1&&A.dyn_ltree[I*2]!==0)return v;if(A.dyn_ltree[18]!==0||A.dyn_ltree[20]!==0||A.dyn_ltree[26]!==0)return _;for(I=32;I<S;I++)if(A.dyn_ltree[I*2]!==0)return _;return v};let ut=!1;const ee=A=>{ut||(fe(),ut=!0),A.l_desc=new he(A.dyn_ltree,J),A.d_desc=new he(A.dyn_dtree,le),A.bl_desc=new he(A.bl_tree,se),A.bi_buf=0,A.bi_valid=0,De(A)},ie=(A,Q,I,ne)=>{ce(A,(y<<1)+(ne?1:0),3),qe(A),ve(A,I),ve(A,~I),I&&A.pending_buf.set(A.window.subarray(Q,Q+I),A.pending),A.pending+=I},oe=A=>{ce(A,k<<1,3),me(A,h,H),Ge(A)},we=(A,Q,I,ne)=>{let ae,ue,Ie=0;A.level>0?(A.strm.data_type===b&&(A.strm.data_type=ft(A)),Ke(A,A.l_desc),Ke(A,A.d_desc),Ie=je(A),ae=A.opt_len+3+7>>>3,ue=A.static_len+3+7>>>3,ue<=ae&&(ae=ue)):ae=ue=I+5,I+4<=ae&&Q!==-1?ie(A,Q,I,ne):A.strategy===u||ue===ae?(ce(A,(k<<1)+(ne?1:0),3),ot(A,H,q)):(ce(A,(g<<1)+(ne?1:0),3),Ue(A,A.l_desc.max_code+1,A.d_desc.max_code+1,Ie+1),ot(A,A.dyn_ltree,A.dyn_dtree)),De(A),ne&&qe(A)},Se=(A,Q,I)=>(A.pending_buf[A.sym_buf+A.sym_next++]=Q,A.pending_buf[A.sym_buf+A.sym_next++]=Q>>8,A.pending_buf[A.sym_buf+A.sym_next++]=I,Q===0?A.dyn_ltree[I*2]++:(A.matches++,Q--,A.dyn_ltree[(B[I]+S+1)*2]++,A.dyn_dtree[pe(Q)*2]++),A.sym_next===A.sym_end);var He=ee,Be=ie,K=we,_e=Se,Me=oe,$e={_tr_init:He,_tr_stored_block:Be,_tr_flush_block:K,_tr_tally:_e,_tr_align:Me},ye=(A,Q,I,ne)=>{let ae=A&65535|0,ue=A>>>16&65535|0,Ie=0;for(;I!==0;){Ie=I>2e3?2e3:I,I-=Ie;do ae=ae+Q[ne++]|0,ue=ue+ae|0;while(--Ie);ae%=65521,ue%=65521}return ae|ue<<16|0};const Ne=()=>{let A,Q=[];for(var I=0;I<256;I++){A=I;for(var ne=0;ne<8;ne++)A=A&1?3988292384^A>>>1:A>>>1;Q[I]=A}return Q},Z=new Uint32Array(Ne());var ze=(A,Q,I,ne)=>{const ae=Z,ue=ne+I;A^=-1;for(let Ie=ne;Ie<ue;Ie++)A=A>>>8^ae[(A^Q[Ie])&255];return A^-1},rt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},G={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Te,_tr_stored_block:Ee,_tr_flush_block:re,_tr_tally:ge,_tr_align:ke}=$e,{Z_NO_FLUSH:ct,Z_PARTIAL_FLUSH:lt,Z_FULL_FLUSH:dt,Z_FINISH:yt,Z_BLOCK:ir,Z_OK:At,Z_STREAM_END:Mt,Z_STREAM_ERROR:Pt,Z_DATA_ERROR:Qt,Z_BUF_ERROR:Kt,Z_DEFAULT_COMPRESSION:Kr,Z_FILTERED:ai,Z_HUFFMAN_ONLY:Lt,Z_RLE:Wt,Z_FIXED:qt,Z_DEFAULT_STRATEGY:wr,Z_UNKNOWN:dr,Z_DEFLATED:jr}=G,gn=9,vn=15,Wn=8,Gi=286,Jt=30,yn=19,Ei=2*Gi+1,Po=15,Ft=3,li=258,Vr=li+Ft+1,Hn=32,vr=42,Ps=57,Rr=69,Fs=73,Ds=91,zs=103,Wr=113,ui=666,nr=1,Zr=2,Ai=3,Ui=4,Is=3,ci=(A,Q)=>(A.msg=rt[Q],Q),$n=A=>A*2-(A>4?9:0),zr=A=>{let Q=A.length;for(;--Q>=0;)A[Q]=0},Va=A=>{let Q,I,ne,ae=A.w_size;Q=A.hash_size,ne=Q;do I=A.head[--ne],A.head[ne]=I>=ae?I-ae:0;while(--Q);Q=ae,ne=Q;do I=A.prev[--ne],A.prev[ne]=I>=ae?I-ae:0;while(--Q)};let Hr=(A,Q,I)=>(Q<<A.hash_shift^I)&A.hash_mask;const Rt=A=>{const Q=A.state;let I=Q.pending;I>A.avail_out&&(I=A.avail_out),I!==0&&(A.output.set(Q.pending_buf.subarray(Q.pending_out,Q.pending_out+I),A.next_out),A.next_out+=I,Q.pending_out+=I,A.total_out+=I,A.avail_out-=I,Q.pending-=I,Q.pending===0&&(Q.pending_out=0))},Sr=(A,Q)=>{re(A,A.block_start>=0?A.block_start:-1,A.strstart-A.block_start,Q),A.block_start=A.strstart,Rt(A.strm)},Nt=(A,Q)=>{A.pending_buf[A.pending++]=Q},Ti=(A,Q)=>{A.pending_buf[A.pending++]=Q>>>8&255,A.pending_buf[A.pending++]=Q&255},qn=(A,Q,I,ne)=>{let ae=A.avail_in;return ae>ne&&(ae=ne),ae===0?0:(A.avail_in-=ae,Q.set(A.input.subarray(A.next_in,A.next_in+ae),I),A.state.wrap===1?A.adler=ye(A.adler,Q,ae,I):A.state.wrap===2&&(A.adler=ze(A.adler,Q,ae,I)),A.next_in+=ae,A.total_in+=ae,ae)},Ls=(A,Q)=>{let I=A.max_chain_length,ne=A.strstart,ae,ue,Ie=A.prev_length,Ae=A.nice_match;const ht=A.strstart>A.w_size-Vr?A.strstart-(A.w_size-Vr):0,xe=A.window,Pe=A.w_mask,Dt=A.prev,nt=A.strstart+li;let Ye=xe[ne+Ie-1],$t=xe[ne+Ie];A.prev_length>=A.good_match&&(I>>=2),Ae>A.lookahead&&(Ae=A.lookahead);do if(ae=Q,!(xe[ae+Ie]!==$t||xe[ae+Ie-1]!==Ye||xe[ae]!==xe[ne]||xe[++ae]!==xe[ne+1])){ne+=2,ae++;do;while(xe[++ne]===xe[++ae]&&xe[++ne]===xe[++ae]&&xe[++ne]===xe[++ae]&&xe[++ne]===xe[++ae]&&xe[++ne]===xe[++ae]&&xe[++ne]===xe[++ae]&&xe[++ne]===xe[++ae]&&xe[++ne]===xe[++ae]&&ne<nt);if(ue=li-(nt-ne),ne=nt-li,ue>Ie){if(A.match_start=Q,Ie=ue,ue>=Ae)break;Ye=xe[ne+Ie-1],$t=xe[ne+Ie]}}while((Q=Dt[Q&Pe])>ht&&--I!==0);return Ie<=A.lookahead?Ie:A.lookahead},Mi=A=>{const Q=A.w_size;let I,ne,ae;do{if(ne=A.window_size-A.lookahead-A.strstart,A.strstart>=Q+(Q-Vr)&&(A.window.set(A.window.subarray(Q,Q+Q-ne),0),A.match_start-=Q,A.strstart-=Q,A.block_start-=Q,A.insert>A.strstart&&(A.insert=A.strstart),Va(A),ne+=Q),A.strm.avail_in===0)break;if(I=qn(A.strm,A.window,A.strstart+A.lookahead,ne),A.lookahead+=I,A.lookahead+A.insert>=Ft)for(ae=A.strstart-A.insert,A.ins_h=A.window[ae],A.ins_h=Hr(A,A.ins_h,A.window[ae+1]);A.insert&&(A.ins_h=Hr(A,A.ins_h,A.window[ae+Ft-1]),A.prev[ae&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=ae,ae++,A.insert--,!(A.lookahead+A.insert<Ft)););}while(A.lookahead<Vr&&A.strm.avail_in!==0)},Yn=(A,Q)=>{let I=A.pending_buf_size-5>A.w_size?A.w_size:A.pending_buf_size-5,ne,ae,ue,Ie=0,Ae=A.strm.avail_in;do{if(ne=65535,ue=A.bi_valid+42>>3,A.strm.avail_out<ue||(ue=A.strm.avail_out-ue,ae=A.strstart-A.block_start,ne>ae+A.strm.avail_in&&(ne=ae+A.strm.avail_in),ne>ue&&(ne=ue),ne<I&&(ne===0&&Q!==yt||Q===ct||ne!==ae+A.strm.avail_in)))break;Ie=Q===yt&&ne===ae+A.strm.avail_in?1:0,Ee(A,0,0,Ie),A.pending_buf[A.pending-4]=ne,A.pending_buf[A.pending-3]=ne>>8,A.pending_buf[A.pending-2]=~ne,A.pending_buf[A.pending-1]=~ne>>8,Rt(A.strm),ae&&(ae>ne&&(ae=ne),A.strm.output.set(A.window.subarray(A.block_start,A.block_start+ae),A.strm.next_out),A.strm.next_out+=ae,A.strm.avail_out-=ae,A.strm.total_out+=ae,A.block_start+=ae,ne-=ae),ne&&(qn(A.strm,A.strm.output,A.strm.next_out,ne),A.strm.next_out+=ne,A.strm.avail_out-=ne,A.strm.total_out+=ne)}while(Ie===0);return Ae-=A.strm.avail_in,Ae&&(Ae>=A.w_size?(A.matches=2,A.window.set(A.strm.input.subarray(A.strm.next_in-A.w_size,A.strm.next_in),0),A.strstart=A.w_size,A.insert=A.strstart):(A.window_size-A.strstart<=Ae&&(A.strstart-=A.w_size,A.window.set(A.window.subarray(A.w_size,A.w_size+A.strstart),0),A.matches<2&&A.matches++,A.insert>A.strstart&&(A.insert=A.strstart)),A.window.set(A.strm.input.subarray(A.strm.next_in-Ae,A.strm.next_in),A.strstart),A.strstart+=Ae,A.insert+=Ae>A.w_size-A.insert?A.w_size-A.insert:Ae),A.block_start=A.strstart),A.high_water<A.strstart&&(A.high_water=A.strstart),Ie?Ui:Q!==ct&&Q!==yt&&A.strm.avail_in===0&&A.strstart===A.block_start?Zr:(ue=A.window_size-A.strstart,A.strm.avail_in>ue&&A.block_start>=A.w_size&&(A.block_start-=A.w_size,A.strstart-=A.w_size,A.window.set(A.window.subarray(A.w_size,A.w_size+A.strstart),0),A.matches<2&&A.matches++,ue+=A.w_size,A.insert>A.strstart&&(A.insert=A.strstart)),ue>A.strm.avail_in&&(ue=A.strm.avail_in),ue&&(qn(A.strm,A.window,A.strstart,ue),A.strstart+=ue,A.insert+=ue>A.w_size-A.insert?A.w_size-A.insert:ue),A.high_water<A.strstart&&(A.high_water=A.strstart),ue=A.bi_valid+42>>3,ue=A.pending_buf_size-ue>65535?65535:A.pending_buf_size-ue,I=ue>A.w_size?A.w_size:ue,ae=A.strstart-A.block_start,(ae>=I||(ae||Q===yt)&&Q!==ct&&A.strm.avail_in===0&&ae<=ue)&&(ne=ae>ue?ue:ae,Ie=Q===yt&&A.strm.avail_in===0&&ne===ae?1:0,Ee(A,A.block_start,ne,Ie),A.block_start+=ne,Rt(A.strm)),Ie?Ai:nr)},Wi=(A,Q)=>{let I,ne;for(;;){if(A.lookahead<Vr){if(Mi(A),A.lookahead<Vr&&Q===ct)return nr;if(A.lookahead===0)break}if(I=0,A.lookahead>=Ft&&(A.ins_h=Hr(A,A.ins_h,A.window[A.strstart+Ft-1]),I=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),I!==0&&A.strstart-I<=A.w_size-Vr&&(A.match_length=Ls(A,I)),A.match_length>=Ft)if(ne=ge(A,A.strstart-A.match_start,A.match_length-Ft),A.lookahead-=A.match_length,A.match_length<=A.max_lazy_match&&A.lookahead>=Ft){A.match_length--;do A.strstart++,A.ins_h=Hr(A,A.ins_h,A.window[A.strstart+Ft-1]),I=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart;while(--A.match_length!==0);A.strstart++}else A.strstart+=A.match_length,A.match_length=0,A.ins_h=A.window[A.strstart],A.ins_h=Hr(A,A.ins_h,A.window[A.strstart+1]);else ne=ge(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++;if(ne&&(Sr(A,!1),A.strm.avail_out===0))return nr}return A.insert=A.strstart<Ft-1?A.strstart:Ft-1,Q===yt?(Sr(A,!0),A.strm.avail_out===0?Ai:Ui):A.sym_next&&(Sr(A,!1),A.strm.avail_out===0)?nr:Zr},kr=(A,Q)=>{let I,ne,ae;for(;;){if(A.lookahead<Vr){if(Mi(A),A.lookahead<Vr&&Q===ct)return nr;if(A.lookahead===0)break}if(I=0,A.lookahead>=Ft&&(A.ins_h=Hr(A,A.ins_h,A.window[A.strstart+Ft-1]),I=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),A.prev_length=A.match_length,A.prev_match=A.match_start,A.match_length=Ft-1,I!==0&&A.prev_length<A.max_lazy_match&&A.strstart-I<=A.w_size-Vr&&(A.match_length=Ls(A,I),A.match_length<=5&&(A.strategy===ai||A.match_length===Ft&&A.strstart-A.match_start>4096)&&(A.match_length=Ft-1)),A.prev_length>=Ft&&A.match_length<=A.prev_length){ae=A.strstart+A.lookahead-Ft,ne=ge(A,A.strstart-1-A.prev_match,A.prev_length-Ft),A.lookahead-=A.prev_length-1,A.prev_length-=2;do++A.strstart<=ae&&(A.ins_h=Hr(A,A.ins_h,A.window[A.strstart+Ft-1]),I=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart);while(--A.prev_length!==0);if(A.match_available=0,A.match_length=Ft-1,A.strstart++,ne&&(Sr(A,!1),A.strm.avail_out===0))return nr}else if(A.match_available){if(ne=ge(A,0,A.window[A.strstart-1]),ne&&Sr(A,!1),A.strstart++,A.lookahead--,A.strm.avail_out===0)return nr}else A.match_available=1,A.strstart++,A.lookahead--}return A.match_available&&(ne=ge(A,0,A.window[A.strstart-1]),A.match_available=0),A.insert=A.strstart<Ft-1?A.strstart:Ft-1,Q===yt?(Sr(A,!0),A.strm.avail_out===0?Ai:Ui):A.sym_next&&(Sr(A,!1),A.strm.avail_out===0)?nr:Zr},di=(A,Q)=>{let I,ne,ae,ue;const Ie=A.window;for(;;){if(A.lookahead<=li){if(Mi(A),A.lookahead<=li&&Q===ct)return nr;if(A.lookahead===0)break}if(A.match_length=0,A.lookahead>=Ft&&A.strstart>0&&(ae=A.strstart-1,ne=Ie[ae],ne===Ie[++ae]&&ne===Ie[++ae]&&ne===Ie[++ae])){ue=A.strstart+li;do;while(ne===Ie[++ae]&&ne===Ie[++ae]&&ne===Ie[++ae]&&ne===Ie[++ae]&&ne===Ie[++ae]&&ne===Ie[++ae]&&ne===Ie[++ae]&&ne===Ie[++ae]&&ae<ue);A.match_length=li-(ue-ae),A.match_length>A.lookahead&&(A.match_length=A.lookahead)}if(A.match_length>=Ft?(I=ge(A,1,A.match_length-Ft),A.lookahead-=A.match_length,A.strstart+=A.match_length,A.match_length=0):(I=ge(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++),I&&(Sr(A,!1),A.strm.avail_out===0))return nr}return A.insert=0,Q===yt?(Sr(A,!0),A.strm.avail_out===0?Ai:Ui):A.sym_next&&(Sr(A,!1),A.strm.avail_out===0)?nr:Zr},hi=(A,Q)=>{let I;for(;;){if(A.lookahead===0&&(Mi(A),A.lookahead===0)){if(Q===ct)return nr;break}if(A.match_length=0,I=ge(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++,I&&(Sr(A,!1),A.strm.avail_out===0))return nr}return A.insert=0,Q===yt?(Sr(A,!0),A.strm.avail_out===0?Ai:Ui):A.sym_next&&(Sr(A,!1),A.strm.avail_out===0)?nr:Zr};function Cr(A,Q,I,ne,ae){this.good_length=A,this.max_lazy=Q,this.nice_length=I,this.max_chain=ne,this.func=ae}const ei=[new Cr(0,0,0,0,Yn),new Cr(4,4,8,4,Wi),new Cr(4,5,16,8,Wi),new Cr(4,6,32,32,Wi),new Cr(4,4,16,16,kr),new Cr(8,16,32,32,kr),new Cr(8,16,128,128,kr),new Cr(8,32,128,256,kr),new Cr(32,128,258,1024,kr),new Cr(32,258,258,4096,kr)],fi=A=>{A.window_size=2*A.w_size,zr(A.head),A.max_lazy_match=ei[A.level].max_lazy,A.good_match=ei[A.level].good_length,A.nice_match=ei[A.level].nice_length,A.max_chain_length=ei[A.level].max_chain,A.strstart=0,A.block_start=0,A.lookahead=0,A.insert=0,A.match_length=A.prev_length=Ft-1,A.match_available=0,A.ins_h=0};function Ba(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=jr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Ei*2),this.dyn_dtree=new Uint16Array((2*Jt+1)*2),this.bl_tree=new Uint16Array((2*yn+1)*2),zr(this.dyn_ltree),zr(this.dyn_dtree),zr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Po+1),this.heap=new Uint16Array(2*Gi+1),zr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Gi+1),zr(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Hi=A=>{if(!A)return 1;const Q=A.state;return!Q||Q.strm!==A||Q.status!==vr&&Q.status!==Ps&&Q.status!==Rr&&Q.status!==Fs&&Q.status!==Ds&&Q.status!==zs&&Q.status!==Wr&&Q.status!==ui?1:0},$i=A=>{if(Hi(A))return ci(A,Pt);A.total_in=A.total_out=0,A.data_type=dr;const Q=A.state;return Q.pending=0,Q.pending_out=0,Q.wrap<0&&(Q.wrap=-Q.wrap),Q.status=Q.wrap===2?Ps:Q.wrap?vr:Wr,A.adler=Q.wrap===2?0:1,Q.last_flush=-2,Te(Q),At},Fo=A=>{const Q=$i(A);return Q===At&&fi(A.state),Q},Do=(A,Q)=>Hi(A)||A.state.wrap!==2?Pt:(A.state.gzhead=Q,At),_n=(A,Q,I,ne,ae,ue)=>{if(!A)return Pt;let Ie=1;if(Q===Kr&&(Q=6),ne<0?(Ie=0,ne=-ne):ne>15&&(Ie=2,ne-=16),ae<1||ae>gn||I!==jr||ne<8||ne>15||Q<0||Q>9||ue<0||ue>qt||ne===8&&Ie!==1)return ci(A,Pt);ne===8&&(ne=9);const Ae=new Ba;return A.state=Ae,Ae.strm=A,Ae.status=vr,Ae.wrap=Ie,Ae.gzhead=null,Ae.w_bits=ne,Ae.w_size=1<<Ae.w_bits,Ae.w_mask=Ae.w_size-1,Ae.hash_bits=ae+7,Ae.hash_size=1<<Ae.hash_bits,Ae.hash_mask=Ae.hash_size-1,Ae.hash_shift=~~((Ae.hash_bits+Ft-1)/Ft),Ae.window=new Uint8Array(Ae.w_size*2),Ae.head=new Uint16Array(Ae.hash_size),Ae.prev=new Uint16Array(Ae.w_size),Ae.lit_bufsize=1<<ae+6,Ae.pending_buf_size=Ae.lit_bufsize*4,Ae.pending_buf=new Uint8Array(Ae.pending_buf_size),Ae.sym_buf=Ae.lit_bufsize,Ae.sym_end=(Ae.lit_bufsize-1)*3,Ae.level=Q,Ae.strategy=ue,Ae.method=I,Fo(A)},zo=(A,Q)=>_n(A,Q,jr,vn,Wn,wr),Ga=(A,Q)=>{if(Hi(A)||Q>ir||Q<0)return A?ci(A,Pt):Pt;const I=A.state;if(!A.output||A.avail_in!==0&&!A.input||I.status===ui&&Q!==yt)return ci(A,A.avail_out===0?Kt:Pt);const ne=I.last_flush;if(I.last_flush=Q,I.pending!==0){if(Rt(A),A.avail_out===0)return I.last_flush=-1,At}else if(A.avail_in===0&&$n(Q)<=$n(ne)&&Q!==yt)return ci(A,Kt);if(I.status===ui&&A.avail_in!==0)return ci(A,Kt);if(I.status===vr&&I.wrap===0&&(I.status=Wr),I.status===vr){let ae=jr+(I.w_bits-8<<4)<<8,ue=-1;if(I.strategy>=Lt||I.level<2?ue=0:I.level<6?ue=1:I.level===6?ue=2:ue=3,ae|=ue<<6,I.strstart!==0&&(ae|=Hn),ae+=31-ae%31,Ti(I,ae),I.strstart!==0&&(Ti(I,A.adler>>>16),Ti(I,A.adler&65535)),A.adler=1,I.status=Wr,Rt(A),I.pending!==0)return I.last_flush=-1,At}if(I.status===Ps){if(A.adler=0,Nt(I,31),Nt(I,139),Nt(I,8),I.gzhead)Nt(I,(I.gzhead.text?1:0)+(I.gzhead.hcrc?2:0)+(I.gzhead.extra?4:0)+(I.gzhead.name?8:0)+(I.gzhead.comment?16:0)),Nt(I,I.gzhead.time&255),Nt(I,I.gzhead.time>>8&255),Nt(I,I.gzhead.time>>16&255),Nt(I,I.gzhead.time>>24&255),Nt(I,I.level===9?2:I.strategy>=Lt||I.level<2?4:0),Nt(I,I.gzhead.os&255),I.gzhead.extra&&I.gzhead.extra.length&&(Nt(I,I.gzhead.extra.length&255),Nt(I,I.gzhead.extra.length>>8&255)),I.gzhead.hcrc&&(A.adler=ze(A.adler,I.pending_buf,I.pending,0)),I.gzindex=0,I.status=Rr;else if(Nt(I,0),Nt(I,0),Nt(I,0),Nt(I,0),Nt(I,0),Nt(I,I.level===9?2:I.strategy>=Lt||I.level<2?4:0),Nt(I,Is),I.status=Wr,Rt(A),I.pending!==0)return I.last_flush=-1,At}if(I.status===Rr){if(I.gzhead.extra){let ae=I.pending,ue=(I.gzhead.extra.length&65535)-I.gzindex;for(;I.pending+ue>I.pending_buf_size;){let Ae=I.pending_buf_size-I.pending;if(I.pending_buf.set(I.gzhead.extra.subarray(I.gzindex,I.gzindex+Ae),I.pending),I.pending=I.pending_buf_size,I.gzhead.hcrc&&I.pending>ae&&(A.adler=ze(A.adler,I.pending_buf,I.pending-ae,ae)),I.gzindex+=Ae,Rt(A),I.pending!==0)return I.last_flush=-1,At;ae=0,ue-=Ae}let Ie=new Uint8Array(I.gzhead.extra);I.pending_buf.set(Ie.subarray(I.gzindex,I.gzindex+ue),I.pending),I.pending+=ue,I.gzhead.hcrc&&I.pending>ae&&(A.adler=ze(A.adler,I.pending_buf,I.pending-ae,ae)),I.gzindex=0}I.status=Fs}if(I.status===Fs){if(I.gzhead.name){let ae=I.pending,ue;do{if(I.pending===I.pending_buf_size){if(I.gzhead.hcrc&&I.pending>ae&&(A.adler=ze(A.adler,I.pending_buf,I.pending-ae,ae)),Rt(A),I.pending!==0)return I.last_flush=-1,At;ae=0}I.gzindex<I.gzhead.name.length?ue=I.gzhead.name.charCodeAt(I.gzindex++)&255:ue=0,Nt(I,ue)}while(ue!==0);I.gzhead.hcrc&&I.pending>ae&&(A.adler=ze(A.adler,I.pending_buf,I.pending-ae,ae)),I.gzindex=0}I.status=Ds}if(I.status===Ds){if(I.gzhead.comment){let ae=I.pending,ue;do{if(I.pending===I.pending_buf_size){if(I.gzhead.hcrc&&I.pending>ae&&(A.adler=ze(A.adler,I.pending_buf,I.pending-ae,ae)),Rt(A),I.pending!==0)return I.last_flush=-1,At;ae=0}I.gzindex<I.gzhead.comment.length?ue=I.gzhead.comment.charCodeAt(I.gzindex++)&255:ue=0,Nt(I,ue)}while(ue!==0);I.gzhead.hcrc&&I.pending>ae&&(A.adler=ze(A.adler,I.pending_buf,I.pending-ae,ae))}I.status=zs}if(I.status===zs){if(I.gzhead.hcrc){if(I.pending+2>I.pending_buf_size&&(Rt(A),I.pending!==0))return I.last_flush=-1,At;Nt(I,A.adler&255),Nt(I,A.adler>>8&255),A.adler=0}if(I.status=Wr,Rt(A),I.pending!==0)return I.last_flush=-1,At}if(A.avail_in!==0||I.lookahead!==0||Q!==ct&&I.status!==ui){let ae=I.level===0?Yn(I,Q):I.strategy===Lt?hi(I,Q):I.strategy===Wt?di(I,Q):ei[I.level].func(I,Q);if((ae===Ai||ae===Ui)&&(I.status=ui),ae===nr||ae===Ai)return A.avail_out===0&&(I.last_flush=-1),At;if(ae===Zr&&(Q===lt?ke(I):Q!==ir&&(Ee(I,0,0,!1),Q===dt&&(zr(I.head),I.lookahead===0&&(I.strstart=0,I.block_start=0,I.insert=0))),Rt(A),A.avail_out===0))return I.last_flush=-1,At}return Q!==yt?At:I.wrap<=0?Mt:(I.wrap===2?(Nt(I,A.adler&255),Nt(I,A.adler>>8&255),Nt(I,A.adler>>16&255),Nt(I,A.adler>>24&255),Nt(I,A.total_in&255),Nt(I,A.total_in>>8&255),Nt(I,A.total_in>>16&255),Nt(I,A.total_in>>24&255)):(Ti(I,A.adler>>>16),Ti(I,A.adler&65535)),Rt(A),I.wrap>0&&(I.wrap=-I.wrap),I.pending!==0?At:Mt)},xn=A=>{if(Hi(A))return Pt;const Q=A.state.status;return A.state=null,Q===Wr?ci(A,Qt):At},bn=(A,Q)=>{let I=Q.length;if(Hi(A))return Pt;const ne=A.state,ae=ne.wrap;if(ae===2||ae===1&&ne.status!==vr||ne.lookahead)return Pt;if(ae===1&&(A.adler=ye(A.adler,Q,I,0)),ne.wrap=0,I>=ne.w_size){ae===0&&(zr(ne.head),ne.strstart=0,ne.block_start=0,ne.insert=0);let ht=new Uint8Array(ne.w_size);ht.set(Q.subarray(I-ne.w_size,I),0),Q=ht,I=ne.w_size}const ue=A.avail_in,Ie=A.next_in,Ae=A.input;for(A.avail_in=I,A.next_in=0,A.input=Q,Mi(ne);ne.lookahead>=Ft;){let ht=ne.strstart,xe=ne.lookahead-(Ft-1);do ne.ins_h=Hr(ne,ne.ins_h,ne.window[ht+Ft-1]),ne.prev[ht&ne.w_mask]=ne.head[ne.ins_h],ne.head[ne.ins_h]=ht,ht++;while(--xe);ne.strstart=ht,ne.lookahead=Ft-1,Mi(ne)}return ne.strstart+=ne.lookahead,ne.block_start=ne.strstart,ne.insert=ne.lookahead,ne.lookahead=0,ne.match_length=ne.prev_length=Ft-1,ne.match_available=0,A.next_in=Ie,A.input=Ae,A.avail_in=ue,ne.wrap=ae,At};var qi=zo,Xn=_n,Ua=Fo,Wa=$i,Os=Do,Jn=Ga,Ns=xn,Io=bn,pi="pako deflate (from Nodeca project)",Ri={deflateInit:qi,deflateInit2:Xn,deflateReset:Ua,deflateResetKeep:Wa,deflateSetHeader:Os,deflate:Jn,deflateEnd:Ns,deflateSetDictionary:Io,deflateInfo:pi};const Qn=(A,Q)=>Object.prototype.hasOwnProperty.call(A,Q);var Lo=function(A){const Q=Array.prototype.slice.call(arguments,1);for(;Q.length;){const I=Q.shift();if(I){if(typeof I!="object")throw new TypeError(I+"must be non-object");for(const ne in I)Qn(I,ne)&&(A[ne]=I[ne])}}return A},Kn=A=>{let Q=0;for(let ne=0,ae=A.length;ne<ae;ne++)Q+=A[ne].length;const I=new Uint8Array(Q);for(let ne=0,ae=0,ue=A.length;ne<ue;ne++){let Ie=A[ne];I.set(Ie,ae),ae+=Ie.length}return I},ki={assign:Lo,flattenChunks:Kn};let js=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{js=!1}const lr=new Uint8Array(256);for(let A=0;A<256;A++)lr[A]=A>=252?6:A>=248?5:A>=240?4:A>=224?3:A>=192?2:1;lr[254]=lr[254]=1;var Yi=A=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(A);let Q,I,ne,ae,ue,Ie=A.length,Ae=0;for(ae=0;ae<Ie;ae++)I=A.charCodeAt(ae),(I&64512)===55296&&ae+1<Ie&&(ne=A.charCodeAt(ae+1),(ne&64512)===56320&&(I=65536+(I-55296<<10)+(ne-56320),ae++)),Ae+=I<128?1:I<2048?2:I<65536?3:4;for(Q=new Uint8Array(Ae),ue=0,ae=0;ue<Ae;ae++)I=A.charCodeAt(ae),(I&64512)===55296&&ae+1<Ie&&(ne=A.charCodeAt(ae+1),(ne&64512)===56320&&(I=65536+(I-55296<<10)+(ne-56320),ae++)),I<128?Q[ue++]=I:I<2048?(Q[ue++]=192|I>>>6,Q[ue++]=128|I&63):I<65536?(Q[ue++]=224|I>>>12,Q[ue++]=128|I>>>6&63,Q[ue++]=128|I&63):(Q[ue++]=240|I>>>18,Q[ue++]=128|I>>>12&63,Q[ue++]=128|I>>>6&63,Q[ue++]=128|I&63);return Q};const Vs=(A,Q)=>{if(Q<65534&&A.subarray&&js)return String.fromCharCode.apply(null,A.length===Q?A:A.subarray(0,Q));let I="";for(let ne=0;ne<Q;ne++)I+=String.fromCharCode(A[ne]);return I};var wn=(A,Q)=>{const I=Q||A.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(A.subarray(0,Q));let ne,ae;const ue=new Array(I*2);for(ae=0,ne=0;ne<I;){let Ie=A[ne++];if(Ie<128){ue[ae++]=Ie;continue}let Ae=lr[Ie];if(Ae>4){ue[ae++]=65533,ne+=Ae-1;continue}for(Ie&=Ae===2?31:Ae===3?15:7;Ae>1&&ne<I;)Ie=Ie<<6|A[ne++]&63,Ae--;if(Ae>1){ue[ae++]=65533;continue}Ie<65536?ue[ae++]=Ie:(Ie-=65536,ue[ae++]=55296|Ie>>10&1023,ue[ae++]=56320|Ie&1023)}return Vs(ue,ae)},Ha=(A,Q)=>{Q=Q||A.length,Q>A.length&&(Q=A.length);let I=Q-1;for(;I>=0&&(A[I]&192)===128;)I--;return I<0||I===0?Q:I+lr[A[I]]>Q?I:Q},Pi={string2buf:Yi,buf2string:wn,utf8border:Ha};function Bs(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Xi=Bs;const Sn=Object.prototype.toString,{Z_NO_FLUSH:Oo,Z_SYNC_FLUSH:$a,Z_FULL_FLUSH:qa,Z_FINISH:Ya,Z_OK:Ji,Z_STREAM_END:Xa,Z_DEFAULT_COMPRESSION:Ja,Z_DEFAULT_STRATEGY:Qa,Z_DEFLATED:Ka}=G;function Cn(A){this.options=ki.assign({level:Ja,method:Ka,chunkSize:16384,windowBits:15,memLevel:8,strategy:Qa},A||{});let Q=this.options;Q.raw&&Q.windowBits>0?Q.windowBits=-Q.windowBits:Q.gzip&&Q.windowBits>0&&Q.windowBits<16&&(Q.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Xi,this.strm.avail_out=0;let I=Ri.deflateInit2(this.strm,Q.level,Q.method,Q.windowBits,Q.memLevel,Q.strategy);if(I!==Ji)throw new Error(rt[I]);if(Q.header&&Ri.deflateSetHeader(this.strm,Q.header),Q.dictionary){let ne;if(typeof Q.dictionary=="string"?ne=Pi.string2buf(Q.dictionary):Sn.call(Q.dictionary)==="[object ArrayBuffer]"?ne=new Uint8Array(Q.dictionary):ne=Q.dictionary,I=Ri.deflateSetDictionary(this.strm,ne),I!==Ji)throw new Error(rt[I]);this._dict_set=!0}}Cn.prototype.push=function(A,Q){const I=this.strm,ne=this.options.chunkSize;let ae,ue;if(this.ended)return!1;for(Q===~~Q?ue=Q:ue=Q===!0?Ya:Oo,typeof A=="string"?I.input=Pi.string2buf(A):Sn.call(A)==="[object ArrayBuffer]"?I.input=new Uint8Array(A):I.input=A,I.next_in=0,I.avail_in=I.input.length;;){if(I.avail_out===0&&(I.output=new Uint8Array(ne),I.next_out=0,I.avail_out=ne),(ue===$a||ue===qa)&&I.avail_out<=6){this.onData(I.output.subarray(0,I.next_out)),I.avail_out=0;continue}if(ae=Ri.deflate(I,ue),ae===Xa)return I.next_out>0&&this.onData(I.output.subarray(0,I.next_out)),ae=Ri.deflateEnd(this.strm),this.onEnd(ae),this.ended=!0,ae===Ji;if(I.avail_out===0){this.onData(I.output);continue}if(ue>0&&I.next_out>0){this.onData(I.output.subarray(0,I.next_out)),I.avail_out=0;continue}if(I.avail_in===0)break}return!0},Cn.prototype.onData=function(A){this.chunks.push(A)},Cn.prototype.onEnd=function(A){A===Ji&&(this.result=ki.flattenChunks(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg};function Zn(A,Q){const I=new Cn(Q);if(I.push(A,!0),I.err)throw I.msg||rt[I.err];return I.result}function Za(A,Q){return Q=Q||{},Q.raw=!0,Zn(A,Q)}function el(A,Q){return Q=Q||{},Q.gzip=!0,Zn(A,Q)}var tl=Cn,rl=Zn,Gs=Za,il=el,nl={Deflate:tl,deflate:rl,deflateRaw:Gs,gzip:il};const es=16209,No=16191;var sl=function(A,Q){let I,ne,ae,ue,Ie,Ae,ht,xe,Pe,Dt,nt,Ye,$t,Xt,It,bt,xt,tt,wt,tr,Ot,zt,Bt,St;const kt=A.state;I=A.next_in,Bt=A.input,ne=I+(A.avail_in-5),ae=A.next_out,St=A.output,ue=ae-(Q-A.avail_out),Ie=ae+(A.avail_out-257),Ae=kt.dmax,ht=kt.wsize,xe=kt.whave,Pe=kt.wnext,Dt=kt.window,nt=kt.hold,Ye=kt.bits,$t=kt.lencode,Xt=kt.distcode,It=(1<<kt.lenbits)-1,bt=(1<<kt.distbits)-1;e:do{Ye<15&&(nt+=Bt[I++]<<Ye,Ye+=8,nt+=Bt[I++]<<Ye,Ye+=8),xt=$t[nt&It];t:for(;;){if(tt=xt>>>24,nt>>>=tt,Ye-=tt,tt=xt>>>16&255,tt===0)St[ae++]=xt&65535;else if(tt&16){wt=xt&65535,tt&=15,tt&&(Ye<tt&&(nt+=Bt[I++]<<Ye,Ye+=8),wt+=nt&(1<<tt)-1,nt>>>=tt,Ye-=tt),Ye<15&&(nt+=Bt[I++]<<Ye,Ye+=8,nt+=Bt[I++]<<Ye,Ye+=8),xt=Xt[nt&bt];r:for(;;){if(tt=xt>>>24,nt>>>=tt,Ye-=tt,tt=xt>>>16&255,tt&16){if(tr=xt&65535,tt&=15,Ye<tt&&(nt+=Bt[I++]<<Ye,Ye+=8,Ye<tt&&(nt+=Bt[I++]<<Ye,Ye+=8)),tr+=nt&(1<<tt)-1,tr>Ae){A.msg="invalid distance too far back",kt.mode=es;break e}if(nt>>>=tt,Ye-=tt,tt=ae-ue,tr>tt){if(tt=tr-tt,tt>xe&&kt.sane){A.msg="invalid distance too far back",kt.mode=es;break e}if(Ot=0,zt=Dt,Pe===0){if(Ot+=ht-tt,tt<wt){wt-=tt;do St[ae++]=Dt[Ot++];while(--tt);Ot=ae-tr,zt=St}}else if(Pe<tt){if(Ot+=ht+Pe-tt,tt-=Pe,tt<wt){wt-=tt;do St[ae++]=Dt[Ot++];while(--tt);if(Ot=0,Pe<wt){tt=Pe,wt-=tt;do St[ae++]=Dt[Ot++];while(--tt);Ot=ae-tr,zt=St}}}else if(Ot+=Pe-tt,tt<wt){wt-=tt;do St[ae++]=Dt[Ot++];while(--tt);Ot=ae-tr,zt=St}for(;wt>2;)St[ae++]=zt[Ot++],St[ae++]=zt[Ot++],St[ae++]=zt[Ot++],wt-=3;wt&&(St[ae++]=zt[Ot++],wt>1&&(St[ae++]=zt[Ot++]))}else{Ot=ae-tr;do St[ae++]=St[Ot++],St[ae++]=St[Ot++],St[ae++]=St[Ot++],wt-=3;while(wt>2);wt&&(St[ae++]=St[Ot++],wt>1&&(St[ae++]=St[Ot++]))}}else if(tt&64){A.msg="invalid distance code",kt.mode=es;break e}else{xt=Xt[(xt&65535)+(nt&(1<<tt)-1)];continue r}break}}else if(tt&64)if(tt&32){kt.mode=No;break e}else{A.msg="invalid literal/length code",kt.mode=es;break e}else{xt=$t[(xt&65535)+(nt&(1<<tt)-1)];continue t}break}}while(I<ne&&ae<Ie);wt=Ye>>3,I-=wt,Ye-=wt<<3,nt&=(1<<Ye)-1,A.next_in=I,A.next_out=ae,A.avail_in=I<ne?5+(ne-I):5-(I-ne),A.avail_out=ae<Ie?257+(Ie-ae):257-(ae-Ie),kt.hold=nt,kt.bits=Ye};const Qi=15,jo=852,Vo=592,Bo=0,Us=1,Go=2,Ws=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),En=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ol=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Uo=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Ki=(A,Q,I,ne,ae,ue,Ie,Ae)=>{const ht=Ae.bits;let xe=0,Pe=0,Dt=0,nt=0,Ye=0,$t=0,Xt=0,It=0,bt=0,xt=0,tt,wt,tr,Ot,zt,Bt=null,St;const kt=new Uint16Array(Qi+1),fr=new Uint16Array(Qi+1);let Ir=null,xs,bs,xi;for(xe=0;xe<=Qi;xe++)kt[xe]=0;for(Pe=0;Pe<ne;Pe++)kt[Q[I+Pe]]++;for(Ye=ht,nt=Qi;nt>=1&&kt[nt]===0;nt--);if(Ye>nt&&(Ye=nt),nt===0)return ae[ue++]=1<<24|64<<16|0,ae[ue++]=1<<24|64<<16|0,Ae.bits=1,0;for(Dt=1;Dt<nt&&kt[Dt]===0;Dt++);for(Ye<Dt&&(Ye=Dt),It=1,xe=1;xe<=Qi;xe++)if(It<<=1,It-=kt[xe],It<0)return-1;if(It>0&&(A===Bo||nt!==1))return-1;for(fr[1]=0,xe=1;xe<Qi;xe++)fr[xe+1]=fr[xe]+kt[xe];for(Pe=0;Pe<ne;Pe++)Q[I+Pe]!==0&&(Ie[fr[Q[I+Pe]]++]=Pe);if(A===Bo?(Bt=Ir=Ie,St=20):A===Us?(Bt=Ws,Ir=En,St=257):(Bt=ol,Ir=Uo,St=0),xt=0,Pe=0,xe=Dt,zt=ue,$t=Ye,Xt=0,tr=-1,bt=1<<Ye,Ot=bt-1,A===Us&&bt>jo||A===Go&&bt>Vo)return 1;for(;;){xs=xe-Xt,Ie[Pe]+1<St?(bs=0,xi=Ie[Pe]):Ie[Pe]>=St?(bs=Ir[Ie[Pe]-St],xi=Bt[Ie[Pe]-St]):(bs=96,xi=0),tt=1<<xe-Xt,wt=1<<$t,Dt=wt;do wt-=tt,ae[zt+(xt>>Xt)+wt]=xs<<24|bs<<16|xi|0;while(wt!==0);for(tt=1<<xe-1;xt&tt;)tt>>=1;if(tt!==0?(xt&=tt-1,xt+=tt):xt=0,Pe++,--kt[xe]===0){if(xe===nt)break;xe=Q[I+Ie[Pe]]}if(xe>Ye&&(xt&Ot)!==tr){for(Xt===0&&(Xt=Ye),zt+=Dt,$t=xe-Xt,It=1<<$t;$t+Xt<nt&&(It-=kt[$t+Xt],!(It<=0));)$t++,It<<=1;if(bt+=1<<$t,A===Us&&bt>jo||A===Go&&bt>Vo)return 1;tr=xt&Ot,ae[tr]=Ye<<24|$t<<16|zt-ue|0}}return xt!==0&&(ae[zt+xt]=xe-Xt<<24|64<<16|0),Ae.bits=Ye,0};const Wo=0,Hs=1,$s=2,{Z_FINISH:Fi,Z_BLOCK:al,Z_TREES:ts,Z_OK:Di,Z_STREAM_END:Ho,Z_NEED_DICT:$o,Z_STREAM_ERROR:yr,Z_DATA_ERROR:Zi,Z_MEM_ERROR:qo,Z_BUF_ERROR:rs,Z_DEFLATED:Yo}=G,An=16180,is=16181,ns=16182,qs=16183,Xs=16184,Js=16185,Xo=16186,Jo=16187,Qo=16188,Ko=16189,ss=16190,sr=16191,zi=16192,Qs=16193,os=16194,Ks=16195,eo=16196,as=16197,Zo=16198,ls=16199,ti=16200,us=16201,en=16202,cs=16203,to=16204,Tn=16205,mi=16206,ds=16207,ro=16208,Gt=16209,io=16210,no=16211,ea=852,ta=592,ra=15,so=A=>(A>>>24&255)+(A>>>8&65280)+((A&65280)<<8)+((A&255)<<24);function gi(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ri=A=>{if(!A)return 1;const Q=A.state;return!Q||Q.strm!==A||Q.mode<An||Q.mode>no?1:0},hs=A=>{if(ri(A))return yr;const Q=A.state;return A.total_in=A.total_out=Q.total=0,A.msg="",Q.wrap&&(A.adler=Q.wrap&1),Q.mode=An,Q.last=0,Q.havedict=0,Q.flags=-1,Q.dmax=32768,Q.head=null,Q.hold=0,Q.bits=0,Q.lencode=Q.lendyn=new Int32Array(ea),Q.distcode=Q.distdyn=new Int32Array(ta),Q.sane=1,Q.back=-1,Di},ia=A=>{if(ri(A))return yr;const Q=A.state;return Q.wsize=0,Q.whave=0,Q.wnext=0,hs(A)},na=(A,Q)=>{let I;if(ri(A))return yr;const ne=A.state;return Q<0?(I=0,Q=-Q):(I=(Q>>4)+5,Q<48&&(Q&=15)),Q&&(Q<8||Q>15)?yr:(ne.window!==null&&ne.wbits!==Q&&(ne.window=null),ne.wrap=I,ne.wbits=Q,ia(A))},tn=(A,Q)=>{if(!A)return yr;const I=new gi;A.state=I,I.strm=A,I.window=null,I.mode=An;const ne=na(A,Q);return ne!==Di&&(A.state=null),ne},ll=A=>tn(A,ra);let oo=!0,fs,Ut;const ao=A=>{if(oo){fs=new Int32Array(512),Ut=new Int32Array(32);let Q=0;for(;Q<144;)A.lens[Q++]=8;for(;Q<256;)A.lens[Q++]=9;for(;Q<280;)A.lens[Q++]=7;for(;Q<288;)A.lens[Q++]=8;for(Ki(Hs,A.lens,0,288,fs,0,A.work,{bits:9}),Q=0;Q<32;)A.lens[Q++]=5;Ki($s,A.lens,0,32,Ut,0,A.work,{bits:5}),oo=!1}A.lencode=fs,A.lenbits=9,A.distcode=Ut,A.distbits=5},Mn=(A,Q,I,ne)=>{let ae;const ue=A.state;return ue.window===null&&(ue.wsize=1<<ue.wbits,ue.wnext=0,ue.whave=0,ue.window=new Uint8Array(ue.wsize)),ne>=ue.wsize?(ue.window.set(Q.subarray(I-ue.wsize,I),0),ue.wnext=0,ue.whave=ue.wsize):(ae=ue.wsize-ue.wnext,ae>ne&&(ae=ne),ue.window.set(Q.subarray(I-ne,I-ne+ae),ue.wnext),ne-=ae,ne?(ue.window.set(Q.subarray(I-ne,I),0),ue.wnext=ne,ue.whave=ue.wsize):(ue.wnext+=ae,ue.wnext===ue.wsize&&(ue.wnext=0),ue.whave<ue.wsize&&(ue.whave+=ae))),0},Rn=(A,Q)=>{let I,ne,ae,ue,Ie,Ae,ht,xe,Pe,Dt,nt,Ye,$t,Xt,It=0,bt,xt,tt,wt,tr,Ot,zt,Bt;const St=new Uint8Array(4);let kt,fr;const Ir=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ri(A)||!A.output||!A.input&&A.avail_in!==0)return yr;I=A.state,I.mode===sr&&(I.mode=zi),Ie=A.next_out,ae=A.output,ht=A.avail_out,ue=A.next_in,ne=A.input,Ae=A.avail_in,xe=I.hold,Pe=I.bits,Dt=Ae,nt=ht,Bt=Di;e:for(;;)switch(I.mode){case An:if(I.wrap===0){I.mode=zi;break}for(;Pe<16;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}if(I.wrap&2&&xe===35615){I.wbits===0&&(I.wbits=15),I.check=0,St[0]=xe&255,St[1]=xe>>>8&255,I.check=ze(I.check,St,2,0),xe=0,Pe=0,I.mode=is;break}if(I.head&&(I.head.done=!1),!(I.wrap&1)||(((xe&255)<<8)+(xe>>8))%31){A.msg="incorrect header check",I.mode=Gt;break}if((xe&15)!==Yo){A.msg="unknown compression method",I.mode=Gt;break}if(xe>>>=4,Pe-=4,zt=(xe&15)+8,I.wbits===0&&(I.wbits=zt),zt>15||zt>I.wbits){A.msg="invalid window size",I.mode=Gt;break}I.dmax=1<<I.wbits,I.flags=0,A.adler=I.check=1,I.mode=xe&512?Ko:sr,xe=0,Pe=0;break;case is:for(;Pe<16;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}if(I.flags=xe,(I.flags&255)!==Yo){A.msg="unknown compression method",I.mode=Gt;break}if(I.flags&57344){A.msg="unknown header flags set",I.mode=Gt;break}I.head&&(I.head.text=xe>>8&1),I.flags&512&&I.wrap&4&&(St[0]=xe&255,St[1]=xe>>>8&255,I.check=ze(I.check,St,2,0)),xe=0,Pe=0,I.mode=ns;case ns:for(;Pe<32;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}I.head&&(I.head.time=xe),I.flags&512&&I.wrap&4&&(St[0]=xe&255,St[1]=xe>>>8&255,St[2]=xe>>>16&255,St[3]=xe>>>24&255,I.check=ze(I.check,St,4,0)),xe=0,Pe=0,I.mode=qs;case qs:for(;Pe<16;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}I.head&&(I.head.xflags=xe&255,I.head.os=xe>>8),I.flags&512&&I.wrap&4&&(St[0]=xe&255,St[1]=xe>>>8&255,I.check=ze(I.check,St,2,0)),xe=0,Pe=0,I.mode=Xs;case Xs:if(I.flags&1024){for(;Pe<16;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}I.length=xe,I.head&&(I.head.extra_len=xe),I.flags&512&&I.wrap&4&&(St[0]=xe&255,St[1]=xe>>>8&255,I.check=ze(I.check,St,2,0)),xe=0,Pe=0}else I.head&&(I.head.extra=null);I.mode=Js;case Js:if(I.flags&1024&&(Ye=I.length,Ye>Ae&&(Ye=Ae),Ye&&(I.head&&(zt=I.head.extra_len-I.length,I.head.extra||(I.head.extra=new Uint8Array(I.head.extra_len)),I.head.extra.set(ne.subarray(ue,ue+Ye),zt)),I.flags&512&&I.wrap&4&&(I.check=ze(I.check,ne,Ye,ue)),Ae-=Ye,ue+=Ye,I.length-=Ye),I.length))break e;I.length=0,I.mode=Xo;case Xo:if(I.flags&2048){if(Ae===0)break e;Ye=0;do zt=ne[ue+Ye++],I.head&&zt&&I.length<65536&&(I.head.name+=String.fromCharCode(zt));while(zt&&Ye<Ae);if(I.flags&512&&I.wrap&4&&(I.check=ze(I.check,ne,Ye,ue)),Ae-=Ye,ue+=Ye,zt)break e}else I.head&&(I.head.name=null);I.length=0,I.mode=Jo;case Jo:if(I.flags&4096){if(Ae===0)break e;Ye=0;do zt=ne[ue+Ye++],I.head&&zt&&I.length<65536&&(I.head.comment+=String.fromCharCode(zt));while(zt&&Ye<Ae);if(I.flags&512&&I.wrap&4&&(I.check=ze(I.check,ne,Ye,ue)),Ae-=Ye,ue+=Ye,zt)break e}else I.head&&(I.head.comment=null);I.mode=Qo;case Qo:if(I.flags&512){for(;Pe<16;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}if(I.wrap&4&&xe!==(I.check&65535)){A.msg="header crc mismatch",I.mode=Gt;break}xe=0,Pe=0}I.head&&(I.head.hcrc=I.flags>>9&1,I.head.done=!0),A.adler=I.check=0,I.mode=sr;break;case Ko:for(;Pe<32;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}A.adler=I.check=so(xe),xe=0,Pe=0,I.mode=ss;case ss:if(I.havedict===0)return A.next_out=Ie,A.avail_out=ht,A.next_in=ue,A.avail_in=Ae,I.hold=xe,I.bits=Pe,$o;A.adler=I.check=1,I.mode=sr;case sr:if(Q===al||Q===ts)break e;case zi:if(I.last){xe>>>=Pe&7,Pe-=Pe&7,I.mode=mi;break}for(;Pe<3;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}switch(I.last=xe&1,xe>>>=1,Pe-=1,xe&3){case 0:I.mode=Qs;break;case 1:if(ao(I),I.mode=ls,Q===ts){xe>>>=2,Pe-=2;break e}break;case 2:I.mode=eo;break;case 3:A.msg="invalid block type",I.mode=Gt}xe>>>=2,Pe-=2;break;case Qs:for(xe>>>=Pe&7,Pe-=Pe&7;Pe<32;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}if((xe&65535)!==(xe>>>16^65535)){A.msg="invalid stored block lengths",I.mode=Gt;break}if(I.length=xe&65535,xe=0,Pe=0,I.mode=os,Q===ts)break e;case os:I.mode=Ks;case Ks:if(Ye=I.length,Ye){if(Ye>Ae&&(Ye=Ae),Ye>ht&&(Ye=ht),Ye===0)break e;ae.set(ne.subarray(ue,ue+Ye),Ie),Ae-=Ye,ue+=Ye,ht-=Ye,Ie+=Ye,I.length-=Ye;break}I.mode=sr;break;case eo:for(;Pe<14;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}if(I.nlen=(xe&31)+257,xe>>>=5,Pe-=5,I.ndist=(xe&31)+1,xe>>>=5,Pe-=5,I.ncode=(xe&15)+4,xe>>>=4,Pe-=4,I.nlen>286||I.ndist>30){A.msg="too many length or distance symbols",I.mode=Gt;break}I.have=0,I.mode=as;case as:for(;I.have<I.ncode;){for(;Pe<3;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}I.lens[Ir[I.have++]]=xe&7,xe>>>=3,Pe-=3}for(;I.have<19;)I.lens[Ir[I.have++]]=0;if(I.lencode=I.lendyn,I.lenbits=7,kt={bits:I.lenbits},Bt=Ki(Wo,I.lens,0,19,I.lencode,0,I.work,kt),I.lenbits=kt.bits,Bt){A.msg="invalid code lengths set",I.mode=Gt;break}I.have=0,I.mode=Zo;case Zo:for(;I.have<I.nlen+I.ndist;){for(;It=I.lencode[xe&(1<<I.lenbits)-1],bt=It>>>24,xt=It>>>16&255,tt=It&65535,!(bt<=Pe);){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}if(tt<16)xe>>>=bt,Pe-=bt,I.lens[I.have++]=tt;else{if(tt===16){for(fr=bt+2;Pe<fr;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}if(xe>>>=bt,Pe-=bt,I.have===0){A.msg="invalid bit length repeat",I.mode=Gt;break}zt=I.lens[I.have-1],Ye=3+(xe&3),xe>>>=2,Pe-=2}else if(tt===17){for(fr=bt+3;Pe<fr;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}xe>>>=bt,Pe-=bt,zt=0,Ye=3+(xe&7),xe>>>=3,Pe-=3}else{for(fr=bt+7;Pe<fr;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}xe>>>=bt,Pe-=bt,zt=0,Ye=11+(xe&127),xe>>>=7,Pe-=7}if(I.have+Ye>I.nlen+I.ndist){A.msg="invalid bit length repeat",I.mode=Gt;break}for(;Ye--;)I.lens[I.have++]=zt}}if(I.mode===Gt)break;if(I.lens[256]===0){A.msg="invalid code -- missing end-of-block",I.mode=Gt;break}if(I.lenbits=9,kt={bits:I.lenbits},Bt=Ki(Hs,I.lens,0,I.nlen,I.lencode,0,I.work,kt),I.lenbits=kt.bits,Bt){A.msg="invalid literal/lengths set",I.mode=Gt;break}if(I.distbits=6,I.distcode=I.distdyn,kt={bits:I.distbits},Bt=Ki($s,I.lens,I.nlen,I.ndist,I.distcode,0,I.work,kt),I.distbits=kt.bits,Bt){A.msg="invalid distances set",I.mode=Gt;break}if(I.mode=ls,Q===ts)break e;case ls:I.mode=ti;case ti:if(Ae>=6&&ht>=258){A.next_out=Ie,A.avail_out=ht,A.next_in=ue,A.avail_in=Ae,I.hold=xe,I.bits=Pe,sl(A,nt),Ie=A.next_out,ae=A.output,ht=A.avail_out,ue=A.next_in,ne=A.input,Ae=A.avail_in,xe=I.hold,Pe=I.bits,I.mode===sr&&(I.back=-1);break}for(I.back=0;It=I.lencode[xe&(1<<I.lenbits)-1],bt=It>>>24,xt=It>>>16&255,tt=It&65535,!(bt<=Pe);){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}if(xt&&!(xt&240)){for(wt=bt,tr=xt,Ot=tt;It=I.lencode[Ot+((xe&(1<<wt+tr)-1)>>wt)],bt=It>>>24,xt=It>>>16&255,tt=It&65535,!(wt+bt<=Pe);){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}xe>>>=wt,Pe-=wt,I.back+=wt}if(xe>>>=bt,Pe-=bt,I.back+=bt,I.length=tt,xt===0){I.mode=Tn;break}if(xt&32){I.back=-1,I.mode=sr;break}if(xt&64){A.msg="invalid literal/length code",I.mode=Gt;break}I.extra=xt&15,I.mode=us;case us:if(I.extra){for(fr=I.extra;Pe<fr;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}I.length+=xe&(1<<I.extra)-1,xe>>>=I.extra,Pe-=I.extra,I.back+=I.extra}I.was=I.length,I.mode=en;case en:for(;It=I.distcode[xe&(1<<I.distbits)-1],bt=It>>>24,xt=It>>>16&255,tt=It&65535,!(bt<=Pe);){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}if(!(xt&240)){for(wt=bt,tr=xt,Ot=tt;It=I.distcode[Ot+((xe&(1<<wt+tr)-1)>>wt)],bt=It>>>24,xt=It>>>16&255,tt=It&65535,!(wt+bt<=Pe);){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}xe>>>=wt,Pe-=wt,I.back+=wt}if(xe>>>=bt,Pe-=bt,I.back+=bt,xt&64){A.msg="invalid distance code",I.mode=Gt;break}I.offset=tt,I.extra=xt&15,I.mode=cs;case cs:if(I.extra){for(fr=I.extra;Pe<fr;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}I.offset+=xe&(1<<I.extra)-1,xe>>>=I.extra,Pe-=I.extra,I.back+=I.extra}if(I.offset>I.dmax){A.msg="invalid distance too far back",I.mode=Gt;break}I.mode=to;case to:if(ht===0)break e;if(Ye=nt-ht,I.offset>Ye){if(Ye=I.offset-Ye,Ye>I.whave&&I.sane){A.msg="invalid distance too far back",I.mode=Gt;break}Ye>I.wnext?(Ye-=I.wnext,$t=I.wsize-Ye):$t=I.wnext-Ye,Ye>I.length&&(Ye=I.length),Xt=I.window}else Xt=ae,$t=Ie-I.offset,Ye=I.length;Ye>ht&&(Ye=ht),ht-=Ye,I.length-=Ye;do ae[Ie++]=Xt[$t++];while(--Ye);I.length===0&&(I.mode=ti);break;case Tn:if(ht===0)break e;ae[Ie++]=I.length,ht--,I.mode=ti;break;case mi:if(I.wrap){for(;Pe<32;){if(Ae===0)break e;Ae--,xe|=ne[ue++]<<Pe,Pe+=8}if(nt-=ht,A.total_out+=nt,I.total+=nt,I.wrap&4&&nt&&(A.adler=I.check=I.flags?ze(I.check,ae,nt,Ie-nt):ye(I.check,ae,nt,Ie-nt)),nt=ht,I.wrap&4&&(I.flags?xe:so(xe))!==I.check){A.msg="incorrect data check",I.mode=Gt;break}xe=0,Pe=0}I.mode=ds;case ds:if(I.wrap&&I.flags){for(;Pe<32;){if(Ae===0)break e;Ae--,xe+=ne[ue++]<<Pe,Pe+=8}if(I.wrap&4&&xe!==(I.total&4294967295)){A.msg="incorrect length check",I.mode=Gt;break}xe=0,Pe=0}I.mode=ro;case ro:Bt=Ho;break e;case Gt:Bt=Zi;break e;case io:return qo;case no:default:return yr}return A.next_out=Ie,A.avail_out=ht,A.next_in=ue,A.avail_in=Ae,I.hold=xe,I.bits=Pe,(I.wsize||nt!==A.avail_out&&I.mode<Gt&&(I.mode<mi||Q!==Fi))&&Mn(A,A.output,A.next_out,nt-A.avail_out),Dt-=A.avail_in,nt-=A.avail_out,A.total_in+=Dt,A.total_out+=nt,I.total+=nt,I.wrap&4&&nt&&(A.adler=I.check=I.flags?ze(I.check,ae,nt,A.next_out-nt):ye(I.check,ae,nt,A.next_out-nt)),A.data_type=I.bits+(I.last?64:0)+(I.mode===sr?128:0)+(I.mode===ls||I.mode===os?256:0),(Dt===0&&nt===0||Q===Fi)&&Bt===Di&&(Bt=rs),Bt},sa=A=>{if(ri(A))return yr;let Q=A.state;return Q.window&&(Q.window=null),A.state=null,Di},lo=(A,Q)=>{if(ri(A))return yr;const I=A.state;return I.wrap&2?(I.head=Q,Q.done=!1,Di):yr},kn=(A,Q)=>{const I=Q.length;let ne,ae,ue;return ri(A)||(ne=A.state,ne.wrap!==0&&ne.mode!==ss)?yr:ne.mode===ss&&(ae=1,ae=ye(ae,Q,I,0),ae!==ne.check)?Zi:(ue=Mn(A,Q,I,I),ue?(ne.mode=io,qo):(ne.havedict=1,Di))};var ps=ia,rn=na,oa=hs,ul=ll,cl=tn,aa=Rn,ms=sa,gs=lo,uo=kn,co="pako inflate (from Nodeca project)",Br={inflateReset:ps,inflateReset2:rn,inflateResetKeep:oa,inflateInit:ul,inflateInit2:cl,inflate:aa,inflateEnd:ms,inflateGetHeader:gs,inflateSetDictionary:uo,inflateInfo:co};function ho(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var dl=ho;const fo=Object.prototype.toString,{Z_NO_FLUSH:hl,Z_FINISH:fl,Z_OK:Ii,Z_STREAM_END:$r,Z_NEED_DICT:vs,Z_STREAM_ERROR:nn,Z_DATA_ERROR:Gr,Z_MEM_ERROR:Pn}=G;function Pr(A){this.options=ki.assign({chunkSize:65536,windowBits:15,to:""},A||{});const Q=this.options;Q.raw&&Q.windowBits>=0&&Q.windowBits<16&&(Q.windowBits=-Q.windowBits,Q.windowBits===0&&(Q.windowBits=-15)),Q.windowBits>=0&&Q.windowBits<16&&!(A&&A.windowBits)&&(Q.windowBits+=32),Q.windowBits>15&&Q.windowBits<48&&(Q.windowBits&15||(Q.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Xi,this.strm.avail_out=0;let I=Br.inflateInit2(this.strm,Q.windowBits);if(I!==Ii)throw new Error(rt[I]);if(this.header=new dl,Br.inflateGetHeader(this.strm,this.header),Q.dictionary&&(typeof Q.dictionary=="string"?Q.dictionary=Pi.string2buf(Q.dictionary):fo.call(Q.dictionary)==="[object ArrayBuffer]"&&(Q.dictionary=new Uint8Array(Q.dictionary)),Q.raw&&(I=Br.inflateSetDictionary(this.strm,Q.dictionary),I!==Ii)))throw new Error(rt[I])}Pr.prototype.push=function(A,Q){const I=this.strm,ne=this.options.chunkSize,ae=this.options.dictionary;let ue,Ie,Ae;if(this.ended)return!1;for(Q===~~Q?Ie=Q:Ie=Q===!0?fl:hl,fo.call(A)==="[object ArrayBuffer]"?I.input=new Uint8Array(A):I.input=A,I.next_in=0,I.avail_in=I.input.length;;){for(I.avail_out===0&&(I.output=new Uint8Array(ne),I.next_out=0,I.avail_out=ne),ue=Br.inflate(I,Ie),ue===vs&&ae&&(ue=Br.inflateSetDictionary(I,ae),ue===Ii?ue=Br.inflate(I,Ie):ue===Gr&&(ue=vs));I.avail_in>0&&ue===$r&&I.state.wrap>0&&A[I.next_in]!==0;)Br.inflateReset(I),ue=Br.inflate(I,Ie);switch(ue){case nn:case Gr:case vs:case Pn:return this.onEnd(ue),this.ended=!0,!1}if(Ae=I.avail_out,I.next_out&&(I.avail_out===0||ue===$r))if(this.options.to==="string"){let ht=Pi.utf8border(I.output,I.next_out),xe=I.next_out-ht,Pe=Pi.buf2string(I.output,ht);I.next_out=xe,I.avail_out=ne-xe,xe&&I.output.set(I.output.subarray(ht,ht+xe),0),this.onData(Pe)}else this.onData(I.output.length===I.next_out?I.output:I.output.subarray(0,I.next_out));if(!(ue===Ii&&Ae===0)){if(ue===$r)return ue=Br.inflateEnd(this.strm),this.onEnd(ue),this.ended=!0,!0;if(I.avail_in===0)break}}return!0},Pr.prototype.onData=function(A){this.chunks.push(A)},Pr.prototype.onEnd=function(A){A===Ii&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ki.flattenChunks(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg};function Fn(A,Q){const I=new Pr(Q);if(I.push(A),I.err)throw I.msg||rt[I.err];return I.result}function pl(A,Q){return Q=Q||{},Q.raw=!0,Fn(A,Q)}var ml=Pr,Li=Fn,Dn=pl,sn=Fn,ys={Inflate:ml,inflate:Li,inflateRaw:Dn,ungzip:sn};const{Deflate:po,deflate:on,deflateRaw:vi,gzip:Yt}=nl,{Inflate:Ht,inflate:yi,inflateRaw:hr,ungzip:Er}=ys;var _i=po,Oi=on,_r=vi,zn=Yt,mo=Ht,go=yi,In=hr,vo=Er,qr=G,_s={Deflate:_i,deflate:Oi,deflateRaw:_r,gzip:zn,Inflate:mo,inflate:go,inflateRaw:In,ungzip:vo,constants:qr}})},__webpack_module_cache__={};function __webpack_require__(n){var t=__webpack_module_cache__[n];if(t!==void 0)return t.exports;var r=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=n=>{var t=n&&n.__esModule?(()=>n.default):(()=>n);return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(n,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t),__webpack_require__.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},__webpack_require__("./src/index.ts"),__webpack_require__("./src/SurfaceWorker.js");var __webpack_exports__=__webpack_require__("./src/exporter.js");return __webpack_exports__})())})(_3Dmol);var _3DmolExports=_3Dmol.exports;const covalentRadii={H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.61,Fe:1.52,Co:1.5,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,Pd:1.39,Ag:1.45,Cd:1.44,In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.75,Hf:1.87,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69};function mod(n,t){return(n%t+t)%t}function setCustomBondLengths(){function n(t,r){_3DmolExports.setBondLength(t,r)}Object.keys(covalentRadii).forEach(t=>{n(t,1.05*covalentRadii[t])})}class Visualizer3dmol extends React.Component{constructor(t){super(t),setCustomBondLengths(),this.viewer=null,this.model=null,this.divId="gldiv-"+(Math.random()+1).toString(36).substring(7)}componentDidMount(){let t={backgroundColor:"white",orthographic:!0};this.viewer=_3DmolExports.createViewer(this.divId,t),this.updateView()}componentDidUpdate(t){(t.viewerParams!=this.props.viewerParams||t.cifText!=this.props.cifText)&&this.updateView()}custom3dmolSetup(){if(this.model=this.viewer.addModel(),this.props.cifText){let t=_3DmolExports.Parsers.CIF(this.props.cifText),r=t[0],u=t.modelData[0].cryst;this.model.setCrystData(u.a,u.b,u.c,u.alpha,u.beta,u.gamma);let v=this.model.modelData.cryst.matrix,_=new _3DmolExports.Matrix3().getInverse3(v),b=[],p=[];r.forEach(g=>{let M=new _3DmolExports.Vector3(g.x,g.y,g.z);if(this.props.viewerParams.packedCell){let P=M.clone().applyMatrix3(_);M=new _3DmolExports.Vector3(mod(P.x,1),mod(P.y,1),mod(P.z,1)).applyMatrix3(v)}p.push({elem:g.elem,x:M.x,y:M.y,z:M.z})});let y=.03,k=this.props.viewerParams.supercell;for(let g=-1;g<k[0]+1;g++)for(let M=-1;M<k[1]+1;M++)for(let P=-1;P<k[2]+1;P++){let R=new _3DmolExports.Vector3(g,M,P);if(R.applyMatrix3(v),g==-1||g==k[0]||M==-1||M==k[1]||P==-1||P==k[2])if(this.props.viewerParams.packedCell)p.forEach(S=>{let a=new _3DmolExports.Vector3(S.x,S.y,S.z);a.add(R);let s=a.clone().applyMatrix3(_);s.x>-y&&s.x<k[0]+y&&s.y>-y&&s.y<k[1]+y&&s.z>-y&&s.z<k[2]+y&&b.push({elem:S.elem,x:a.x,y:a.y,z:a.z})});else continue;else p.forEach(S=>{b.push({elem:S.elem,x:S.x+R.x,y:S.y+R.y,z:S.z+R.z})})}this.model.addAtoms(b)}}updateView(){this.viewer.removeAllModels(),this.custom3dmolSetup();let t={sphere:{scale:.3,colorscheme:"Jmol"}};this.props.viewerParams.vdwRadius&&(t.sphere.scale=1),this.props.viewerParams.bonds&&(t.stick={radius:.15,colorscheme:"Jmol"}),this.viewer.setStyle(t),this.viewer.addUnitCell(this.model),this.model.assignBonds(),this.viewer.removeAllLabels(),this.props.viewerParams.atomLabels&&this.model.atoms.forEach(r=>{this.viewer.addLabel(r.elem,{position:{x:r.x,y:r.y,z:r.z},fontColor:"black",bold:!0,fontSize:18,showBackground:!1,backgroundOpacity:1,inFront:!0},null,!0)}),this.viewer.zoomTo(),this.viewer.zoom(1.4),this.viewer.render()}handleEvent(t,r){t=="camera"&&(r=="x"&&this.viewer.setView([0,0,0,0,-.5,-.5,-.5,.5]),r=="y"&&this.viewer.setView([0,0,0,0,.5,.5,.5,.5]),r=="z"&&this.viewer.setView([0,0,0,0,0,0,0,1]),this.viewer.zoomTo(),this.viewer.zoom(1.4))}render(){return jsxRuntimeExports.jsx("div",{id:this.divId,className:"gldiv",children:"No data!"})}}class StructureWindow extends React.Component{constructor(t){super(t)}render(){let t="structure-window";this.props.mouseEnabled||(t+=" disable-mouse");let r="Click to interact",u="mouse-disabled-note";return this.props.mouseEnabled&&(u="mouse-disabled-note on"),jsxRuntimeExports.jsxs("div",{className:"structure-window-outer",children:[jsxRuntimeExports.jsx("div",{className:"structure-window-click-handler",onClick:()=>this.props.setMouseEnabledState(!0),children:jsxRuntimeExports.jsx("div",{className:t,children:jsxRuntimeExports.jsx(Visualizer3dmol,{ref:this.props.visualizerRef,viewerParams:this.props.viewerParams,cifText:this.props.cifText})})}),jsxRuntimeExports.jsx("div",{className:u,onClick:()=>this.props.setMouseEnabledState(!this.props.mouseEnabled),children:r})]})}}const StructureVisualizer=n=>{const[t,r]=reactExports.useState({supercell:n.initSupercell||[2,2,2],bonds:!0,packedCell:!0,atomLabels:!1,vdwRadius:!1}),[u,v]=reactExports.useState(!1),_=reactExports.useRef(null),b=reactExports.useRef(null);reactExports.useEffect(()=>{const g=M=>{b&&!b.current.contains(M.target)&&v(!1)};return document.addEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)}},[]);const p=g=>{v(g)},y=(g,M)=>{r(P=>({...P,[g]:M}))},k=(g,M)=>{_.current.handleEvent(g,M)};return jsxRuntimeExports.jsxs("div",{ref:b,className:"structure-visualizer",children:[jsxRuntimeExports.jsx(StructureWindow,{visualizerRef:_,viewerParams:t,cifText:n.cifText,mouseEnabled:u,setMouseEnabledState:p}),jsxRuntimeExports.jsx(ControlBox,{viewerParams:t,onViewerParamChange:y,onViewerEvent:k})]})};var ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array;function create$1(){var n=new ARRAY_TYPE(9);return ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function fromValues$1(n,t,r,u,v,_,b,p,y){var k=new ARRAY_TYPE(9);return k[0]=n,k[1]=t,k[2]=r,k[3]=u,k[4]=v,k[5]=_,k[6]=b,k[7]=p,k[8]=y,k}function invert(n,t){var r=t[0],u=t[1],v=t[2],_=t[3],b=t[4],p=t[5],y=t[6],k=t[7],g=t[8],M=g*b-p*k,P=-g*_+p*y,R=k*_-b*y,S=r*M+u*P+v*R;return S?(S=1/S,n[0]=M*S,n[1]=(-g*u+v*k)*S,n[2]=(p*u-v*b)*S,n[3]=P*S,n[4]=(g*r-v*y)*S,n[5]=(-p*r+v*_)*S,n[6]=R*S,n[7]=(-k*r+u*y)*S,n[8]=(b*r-u*_)*S,n):null}function create(){var n=new ARRAY_TYPE(3);return ARRAY_TYPE!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function length(n){var t=n[0],r=n[1],u=n[2];return Math.sqrt(t*t+r*r+u*u)}function fromValues(n,t,r){var u=new ARRAY_TYPE(3);return u[0]=n,u[1]=t,u[2]=r,u}function dot(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function transformMat3(n,t,r){var u=t[0],v=t[1],_=t[2];return n[0]=u*r[0]+v*r[3]+_*r[6],n[1]=u*r[1]+v*r[4]+_*r[7],n[2]=u*r[2]+v*r[5]+_*r[8],n}(function(){var n=create();return function(t,r,u,v,_,b){var p,y;for(r||(r=3),u||(u=0),v?y=Math.min(v*r+u,t.length):y=t.length,p=u;p<y;p+=r)n[0]=t[p],n[1]=t[p+1],n[2]=t[p+2],_(n,n,b),t[p]=n[0],t[p+1]=n[1],t[p+2]=n[2];return t}})();function vecLength(n){return length(n)}function radToDeg(n){return n*180/Math.PI}function cartesianToFractional(n,t){const r=fromValues$1(t[0][0],t[1][0],t[2][0],t[0][1],t[1][1],t[2][1],t[0][2],t[1][2],t[2][2]),u=create$1();if(!invert(u,r))throw new Error("Singular lattice matrix");return n.map(v=>{const _=fromValues(v.x,v.y,v.z),b=create();return transformMat3(b,_,u),{element:v.element,x:b[0],y:b[1],z:b[2]}})}function latticeMatrixToCIFParams(n){const t=fromValues(...n[0]),r=fromValues(...n[1]),u=fromValues(...n[2]),v=vecLength(t),_=vecLength(r),b=vecLength(u),p=radToDeg(Math.acos(dot(r,u)/(_*b))),y=radToDeg(Math.acos(dot(t,u)/(v*b))),k=radToDeg(Math.acos(dot(t,r)/(v*_)));return{a:v,b:_,c:b,alpha:p,beta:y,gamma:k}}function generateCIFfromMatrix(n){const{lattice:t,sites:r}=n,u=cartesianToFractional(r,t),{a:v,b:_,c:b,alpha:p,beta:y,gamma:k}=latticeMatrixToCIFParams(t);let g=`data_generated_structure
_symmetry_space_group_name_H-M   'P 1'
_cell_length_a   ${v.toFixed(6)}
_cell_length_b   ${_.toFixed(6)}
_cell_length_c   ${b.toFixed(6)}
_cell_angle_alpha   ${p.toFixed(6)}
_cell_angle_beta    ${y.toFixed(6)}
_cell_angle_gamma   ${k.toFixed(6)}

loop_
_atom_site_label
_atom_site_type_symbol
_atom_site_fract_x
_atom_site_fract_y
_atom_site_fract_z
`;return u.forEach((M,P)=>{g+=`${M.element}${P+1} ${M.element} ${M.x.toFixed(6)} ${M.y.toFixed(6)} ${M.z.toFixed(6)}
`}),g}function generateXYZ(n){const{lattice:t,sites:r}=n,u=r.length,v=t.flat().map(b=>b.toFixed(6)).join(" ");let _=`${u}
`;return _+=`Lattice="${v}" Properties=species:S:1:pos:R:3
`,r.forEach(b=>{_+=`${b.element} ${b.x.toFixed(6)} ${b.y.toFixed(6)} ${b.z.toFixed(6)}
`}),_}function generatePOSCAR(n){const{lattice:t,sites:r}=n,u=[...new Set(r.map(p=>p.element))],v=u.map(p=>r.filter(y=>y.element===p).length),_=t.map(p=>p.map(y=>y.toFixed(6)).join(" ")).join(`
`),b=u.flatMap(p=>r.filter(y=>y.element===p).map(y=>`${y.x.toFixed(6)} ${y.y.toFixed(6)} ${y.z.toFixed(6)}`));return["Generated structure from OPTIMADE CLIENT","1.0",_,u.join(" "),v.join(" "),"Cartesian",...b].join(`
`)}function generateXSF(n){const{lattice:t,sites:r}=n;let u=`CRYSTAL
PRIMVEC
`;return t.forEach(v=>{u+=v.map(_=>_.toFixed(6)).join(" ")+`
`}),u+=`PRIMCOORD
${r.length} 1
`,r.forEach(v=>{u+=`${v.element} ${v.x.toFixed(6)} ${v.y.toFixed(6)} ${v.z.toFixed(6)}
`}),u}const defaultFormats=[{format:"json",label:"JSON"},{format:"cif",label:"CIF"},{format:"xyz",label:"XYZ"},{format:"xsf",label:"XSF"},{format:"poscar",label:"VASP"}];function downloadFile(n,t){const r=new Blob([n],{type:"text/plain"}),u=URL.createObjectURL(r),v=document.createElement("a");v.href=u,v.download=t,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(u)}function StructureDownload({OptimadeStructure:n,download_formats:t}){const[r,u]=reactExports.useState(!1),v=reactExports.useRef(null),_=t||defaultFormats,b=n.attributes.lattice_vectors,p=n.attributes.cartesian_site_positions,y=n.attributes.species_at_sites,k=p.map((P,R)=>({element:y[R],x:P[0],y:P[1],z:P[2]})),g={lattice:b,sites:k},M=P=>{let R="",S="structure";P==="cif"?(R=generateCIFfromMatrix(g),S+=".cif"):P==="xyz"?(R=generateXYZ(g),S+=".xyz"):P==="poscar"?(R=generatePOSCAR(g),S+=".vasp"):P==="xsf"?(R=generateXSF(g),S+=".xsf"):P==="json"&&(R=JSON.stringify(n,null,2),S+=".json"),R&&downloadFile(R,S),u(!1)};return reactExports.useEffect(()=>{const P=R=>{v.current&&!v.current.contains(R.target)&&u(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]),jsxRuntimeExports$1.jsxs("div",{className:"relative inline-block",ref:v,children:[jsxRuntimeExports$1.jsx("div",{onClick:()=>u(P=>!P),className:"flex items-center gap-1 px-2 py-2 text-sm bg-blue-600 text-white rounded-md shadow hover:bg-blue-700 cursor-pointer",title:"Download",children:jsxRuntimeExports$1.jsx(DownloadIcon,{})}),r&&jsxRuntimeExports$1.jsx("div",{className:"absolute right-0 mt-1 bg-white rounded-md shadow-md ring-2 ring-black ring-opacity-5 z-10",children:jsxRuntimeExports$1.jsx("ul",{className:"list-none p-0 m-0",children:_.map(({format:P,label:R})=>jsxRuntimeExports$1.jsx("li",{children:jsxRuntimeExports$1.jsx("button",{onClick:()=>M(P),className:"block w-full text-left px-3 py-1.5 text-sm text-black hover:bg-gray-100",children:R})},P))})})]})}function QEInputButton({cifText:n}){const t="https://qeinputgenerator.materialscloud.io",r=async()=>{if(!n){alert("No CIF data available");return}try{const u=new FormData;u.append("fileformat","cif-ase"),u.append("structurefile",new Blob([n],{type:"text/plain;charset=utf-8"}),"structure.cif");const v=await fetch(`${t}/compute/upload_structure/`,{method:"POST",body:u});if(!v.ok)throw new Error(`Upload failed: ${v.statusText}`);const _=await v.json();_.redirect?window.open(`${t}${_.redirect}`,"_blank"):alert("Unexpected response from server")}catch(u){console.error(u),alert("Failed to upload structure.")}};return jsxRuntimeExports$1.jsx("button",{onClick:r,disabled:!n,title:"Use the chosen structure in the QE Input Generator Tool",className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:bg-gray-400",children:"Use in QE Input Generator"})}function StructureViewerWithDownload({OptimadeStructure:n,className:t=""}){const r=n.attributes.lattice_vectors,u=n.attributes.cartesian_site_positions,v=n.attributes.species_at_sites,_=u.map((y,k)=>({element:v[k],x:y[0],y:y[1],z:y[2]})),b={lattice:r,sites:_},p=reactExports.useMemo(()=>generateCIFfromMatrix(b),[b]);return jsxRuntimeExports$1.jsxs("div",{className:`relative rounded-lg w-full min-h-[450px] ${t}`,children:[jsxRuntimeExports$1.jsx("div",{className:"w-full h-[450px]",children:jsxRuntimeExports$1.jsx(StructureVisualizer,{cifText:p},p)}),jsxRuntimeExports$1.jsx("div",{className:"flex justify-center mt-4",children:jsxRuntimeExports$1.jsx(QEInputButton,{cifText:p,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 focus:outline-none"})}),jsxRuntimeExports$1.jsx("div",{className:"absolute top-2 right-2 z-10",children:jsxRuntimeExports$1.jsx(StructureDownload,{OptimadeStructure:n})})]})}function ResultDetails({selectedResult:n}){return n?jsxRuntimeExports$1.jsx("div",{className:"w-full flex flex-col space-y-4 items-center",children:jsxRuntimeExports$1.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-4",children:[jsxRuntimeExports$1.jsx("div",{className:"w-full lg:w-1/2",children:jsxRuntimeExports$1.jsx(StructureViewerWithDownload,{OptimadeStructure:n})}),jsxRuntimeExports$1.jsx("div",{className:"w-full lg:w-1/2 bg-slate-100 rounded shadow border p-4 min-h-[12rem] h-[450px] overflow-auto text-xs",children:jsxRuntimeExports$1.jsx(JsonView,{data:n,compactTopLevel:!0,shouldExpandNode:t=>t<2,style:{backgroundColor:""}})})]})}):null}function OptimadeClient(){const[n,t]=reactExports.useState([]),[r,u]=reactExports.useState(!0),[v,_]=reactExports.useState(null),[b,p]=reactExports.useState(null),[y,k]=reactExports.useState(""),[g,M]=reactExports.useState(""),[P,R]=reactExports.useState(null),[S,a]=reactExports.useState(null),[s,c]=reactExports.useState(!1),[w,x]=reactExports.useState(null),T=20,[l,h]=reactExports.useState(1),[C,E]=reactExports.useState({data_returned:0,data_available:0}),[D,z]=reactExports.useState(1);reactExports.useEffect(()=>{async function O(){try{const W=await getProvidersList();t(W.data)}catch(W){_(W)}finally{u(!1)}}O()},[]),reactExports.useEffect(()=>{S?.data?.length>0&&!w&&x(S.data[0])},[S]),reactExports.useEffect(()=>{h(1)},[b,y]);const L=(O,W=y,H=b)=>{a(O),x(O?.data?.[0]||null);const q=O?.meta??{};E(q);const U=q.data_returned??0;z(Math.max(1,Math.ceil(U/T))),M(W),R(H)},V=async O=>{if(b){c(!0);try{const W=await getStructures({providerUrl:b,filter:y,page:O,pageSize:T});L(W,y,b),h(O)}catch(W){console.error("Error fetching page:",W)}finally{c(!1)}}};return jsxRuntimeExports$1.jsxs("div",{className:"min-h-screen flex flex-col items-center",children:[jsxRuntimeExports$1.jsx(OptimadeHeader,{}),jsxRuntimeExports$1.jsxs("div",{className:"flex flex-col items-center w-full max-w-4xl",children:[jsxRuntimeExports$1.jsx(OptimadeProviderDropdown,{providers:n,loading:r,error:v,onSelectUrl:O=>p(O)}),jsxRuntimeExports$1.jsx(AnimatePresence,{children:b&&jsxRuntimeExports$1.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3,ease:"easeInOut"},className:"w-full pb-4",children:[jsxRuntimeExports$1.jsx("div",{className:"w-full pt-8",children:jsxRuntimeExports$1.jsx(OptimadeFilters,{providerUrl:b,onResults:L,onFilterChange:k})}),jsxRuntimeExports$1.jsx("div",{className:"border-t-2 pt-4 w-full text-center text-2xl",children:"Query Results"}),jsxRuntimeExports$1.jsx(QuerySummary,{lastQuery:g,lastProviderUrl:P}),jsxRuntimeExports$1.jsx(PaginationControls,{currentPage:l,totalPages:D,metaData:C,resultsLoading:s,fetchPage:V}),jsxRuntimeExports$1.jsx(ResultsDropdown,{results:S,resultsLoading:s,selectedResult:w,setSelectedResult:x,slateDropdown}),jsxRuntimeExports$1.jsx(ResultDetails,{selectedResult:w})]},"results-section")})]})]})}function App(){return jsxRuntimeExports$1.jsx(OptimadeClient,{})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports$1.jsx(reactExports.StrictMode,{children:jsxRuntimeExports$1.jsx(App,{})}));
